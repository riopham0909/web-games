/*!
 * SCG-gd-pixim - v1.10.16-2
 * 
 * @require Pixim.js - v1.14.0
 * @require howler.js - v2.2.2
 * @license MIT
 */
this.SCG=function(t,e){"use strict";function n(t){console.warn("view modal",t.type);for(var e=t.texts.body,n=t.texts.button,r=function(t){var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.backgroundColor="rgba(0, 0, 0, 0.6)",e.style.textAlign="center",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.zIndex=t,e.style.display="table",e.style.userSelect="none";var n=e.appendChild(document.createElement("div"));n.style.display="table-cell",n.style.verticalAlign="middle";var r=n.appendChild(document.createElement("div"));r.style.borderRadius="10px",r.style.width="min(90%, 330px)",r.style.backgroundColor="#FFF",r.style.color="#000",r.style.display="inline-block",r.style.fontSize="14px",r.style.boxShadow="#000 2px 2px 5px";var o=r.appendChild(document.createElement("div"));return o.style.margin="20px 10px",o.style.lineHeight="30px",{top:e,container:r,box:o}}(t.zIndex),o=r.top,i=r.box,a=0;a<e.length;a++)i.appendChild(document.createTextNode(e[a])),i.appendChild(document.createElement("br"));var s=i.appendChild(document.createElement("div"));return s.style.backgroundColor="#E99",s.style.color="#FFF",s.style.fontWeight="bold",s.style.cursor="pointer",s.style.fontSize="24px",s.style.display="inline-block",s.style.width="60%",s.style.lineHeight="50px",s.style.marginTop="30px",s.style.borderRadius="10px",s.style.boxShadow="#000 2px 2px 2px",s.appendChild(document.createTextNode(n)),o.addEventListener("click",(function(){t.onFinish()})),o}var r=function(t){this._options=t};r.prototype.addModal=function(t){this._addModal({type:t.type,texts:t.texts,createHandler:t.createHandler||n,onFinish:t.onFinish})},r.prototype.addCustomModal=function(t){this._addModal(t)},r.prototype._addModal=function(t){var e={type:t.type,texts:t.texts,onFinish:function(e){n&&n.parentNode&&n.parentNode.removeChild(n),t.onFinish(e)},zIndex:(this._options.zIndex||0).toString()},n=t.createHandler(e);n&&(this._options.container||document.body).appendChild(n)};var o=function(t){void 0===t&&(t={}),this._filterCount=0;var e=t.zIndex,n=t.container,r=document.createElement("div");r.style.width="100%",r.style.height="100%",r.style.backgroundColor="rgba(0, 0, 0, 0)",r.style.textAlign="center",r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.display="table",r.style.zIndex=(e||0).toString(),this._filter=r,this._container=n||document.body};o.prototype.view=function(t){this._filterCount++,this._filter.style.backgroundColor=t||"rgba(0, 0, 0, 0)",this._container.appendChild(this._filter)},o.prototype.hide=function(){this._filterCount--,this._filterCount<=0&&(this._filterCount=0,this._filter.parentNode&&this._filter.parentNode.removeChild(this._filter))};var i,a=function(t){var e={onFinish:function(){n&&n.element.parentNode&&n.element.parentNode.removeChild(n.element)},zIndex:(t.zIndex||0).toString()},n=t.createHandler?t.createHandler(e):function(t){var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.background="#000",e.style.textAlign="center",e.style.position="absolute",e.style.zIndex=t.zIndex,e.style.left=e.style.top="0";var n=e.appendChild(document.createElement("div"));n.style.width="min(90%, 330px)",n.style.height="100%",n.style.margin="auto";var r=n.appendChild(document.createElement("div"));r.style.width="100%",r.style.height="100%",r.style.display="table";var o=r.appendChild(document.createElement("div"));o.style.display="table-cell",o.style.verticalAlign="middle";var i=o.appendChild(document.createElement("div"));i.style.textAlign="right",i.style.color="#FFF";var a=i.appendChild(document.createTextNode("0%")),s=o.appendChild(document.createElement("div"));s.style.width="100%",s.style.height="10px",s.style.position="relative";var c=s.appendChild(document.createElement("div"));c.style.width="100%",c.style.height="100%",c.style.background="#FFF",c.style.position="absolute",c.style.top="0px";var p=s.appendChild(document.createElement("div"));return p.style.width="0%",p.style.height="100%",p.style.background="#EB6100",p.style.position="absolute",p.style.top="0px",{element:e,progress:function(e){var n=Math.floor(100*e);a.textContent=n+"%",p.style.width=n+"%",1===e&&setTimeout((function(){t.onFinish()}),500)}}}(e);n&&(t.container||document.body).appendChild(n.element),this._preloadViewData=n};a.prototype.progress=function(t){this._preloadViewData&&this._preloadViewData.progress(t)},function(t){var e,n=function(t){this.type=t.type,this.original=t.original||null,this.message=t.message||""};t.ErrorBase=n,(e=t.framework||(t.framework={})).Basic="error",e.ReInitialize="re-initialize",e.Uninitialized="uninitialized",e.Build="build-failed",e.ReBuild="re-build",e.DataGet="data-get-failed";var r,o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(n);t.FrameworkError=o,(r=t.api||(t.api={})).Basic="error",r.Uncallable="uncallable",r.Unauthorized="unauthorized",r.SendScore="send-score-failed",r.DataSet="data-set-failed",r.AdMissing="ad-missing",r.AdSkipped="ad-skipped",r.CycleTiming="cycle-timing",r.ContentLoad="content-load-failed",r.UndefinedLayer="layer-undefined",r.UsedContent="used-content",r.UnsupportedLanguage="unsupported-language",r.UnsupportedOperation="unsupported-operation";var i=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(n);t.ApiError=i}(i||(i={}));var s,c=i;!function(t){t.Error="error",t.BuildError="buildError",t.ApiError="apiError",t.RewardAdApiError="rewardAdApiError"}(s||(s={}));var p=s,u={};u[p.Error]={body:["エラーが発生しました","通信環境の良い場所で","再度お試しください"],button:"リトライ"},u[p.BuildError]={body:["ゲームの起動に失敗しました","ページの再読み込み、または","アプリの再起動をお試しください"],button:"OK"},u[p.ApiError]={body:["エラーが発生しました","通信環境の良い場所で","再度お試しください"],button:"リトライ"},u[p.RewardAdApiError]={body:["現在ご提供できる広告が無いか","広告をスキップされている可能性があるため","もう一度お試しいただくか","使用しないでゲームを続けてください"],button:"OK"};var l=function(){this._isInit=!1,this._isBuild=!1};l.prototype.init=function(t,e,n){if(this._isInit)throw new c.FrameworkError({type:c.framework.ReInitialize});this._isInit=!0,this._gameEngineOptions=t,this._coreOptions=e,this._extraOptions=n||{}},l.prototype._buildAsync=function(t,e){var n,i=this;return(n=this._extraOptions.languageOptions,n?"string"==typeof n?fetch(n).then((function(t){return t.json()})):Promise.resolve(n):Promise.resolve(null)).then((function(t){return t||{}})).then((function(t){return{languages:function(t){var e=[];if(t)if("string"==typeof t)e.push(t);else if(Array.isArray(t)){for(var n=0;n<t.length;n++)"string"==typeof t[n]&&e.push(t[n]);0===e.length&&e.push("ja")}else e.push("ja");else e.push("ja");return e}(i._extraOptions.languages),modalTexts:t.modalTexts||{}}})).then((function(n){if(!i._isInit)throw new c.FrameworkError({type:c.framework.Uninitialized});if(i._isBuild)throw new c.FrameworkError({type:c.framework.ReBuild});i._isBuild=!0;var s=new t({languages:n.languages},i._coreOptions),l=s.createReceiver(),d=Object.assign({},i._extraOptions.modalOptions||{});d.zIndex=void 0===d.zIndex?10:d.zIndex;var h=Object.assign({},i._extraOptions.filterOptions||{});h.zIndex=void 0===h.zIndex?9:h.zIndex;var y="boolean"==typeof i._extraOptions.preloadViewOptions?{}:Object.assign({},i._extraOptions.preloadViewOptions||{});y.zIndex=void 0===y.zIndex?1:y.zIndex;var f=new r({container:d.container,zIndex:d.zIndex}),_=new o(h);l.on("viewFilter",(function(t){_.view(t.data)})),l.on("hideFilter",(function(){_.hide()}));var m=function(t){_.view();return function(e){setTimeout((function(){_.hide(),t(e)}),500)}},v=function(t){var e=t.type,r=t.onFinish,o=s.getLanguage(),i=n.modalTexts[e]&&n.modalTexts[e][o]?n.modalTexts[e][o]:u[e]||u.error,a=m(r);f.addModal({type:e,texts:i,createHandler:d.createHandler,onFinish:a})},g=function(t){v(t.data)},w=function(t){var e,n,r,o,i,a;e=t.data,n=e.type,r=e.texts,o=e.createHandler,i=e.onFinish,a=m(i),f.addCustomModal({type:n,texts:r,createHandler:o,onFinish:a})};l.on("addModal",g),l.on("addCustomModal",w);var A=i._createGameEngine({core:s,languages:n.languages}),b=A.createReceiver();return b.on("addModal",g),b.on("addCustomModal",w),s.initializeAsync().then((function(){return s.loadDataAsync()})).then((function(t){return s.introAsync().then((function(){if(i._extraOptions.preloadViewOptions){var n=new a(y);b.on("preloadProgress",(function(t){n.progress(t.data)}))}return A.buildAsync(e,t)}))})).catch((function(t){throw i._isBuild=!1,i._destroyGameEngine(),d.skipBuildErrorModal||v({type:p.BuildError,onFinish:function(){}}),new c.FrameworkError({type:c.framework.Build,original:t})}))}))},l.prototype._destroyGameEngine=function(){};
/*!
     * @tawaship/transceiver - v1.0.0
     * 
     * @author tawaship (makazu.mori@gmail.com)
     * @license MIT
     */
/*!
     * @tawaship/emitter - v3.1.1
     * 
     * @author tawaship (makazu.mori@gmail.com)
     * @license MIT
     */
var d=function(){this._events={}};d.prototype._on=function(t,e,n){if(!t||!e)return this;for(var r=this._events[t]=this._events[t]||[],o=0;o<r.length;o++)if(r[o].callback===e)return this;return r.push({callback:e,once:n}),this},d.prototype.on=function(t,e){return this._on(t,e,!1)},d.prototype.once=function(t,e){return this._on(t,e,!0)},d.prototype.off=function(t,e){if(!t||!e)return this;for(var n=this._events[t]||[],r=0;r<n.length;r++)if(n[r].callback===e)return n.splice(r,1),this;return this},d.prototype._emit=function(t,e){for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];if(!t)return this;for(var o=this._events[t]||[],i=[],a=o.length-1;a>=0;a--){var s=o[a];s.once&&o.splice(a,1),i.push(s)}for(var c=i.length-1;c>=0;c--)i[c].callback.apply(e,n);return this},d.prototype.emit=function(t){for(var e,n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return(e=this)._emit.apply(e,[t,this].concat(n))},d.prototype.cemit=function(t,e){for(var n,r=[],o=arguments.length-2;o-- >0;)r[o]=arguments[o+2];return(n=this)._emit.apply(n,[t,e].concat(r))},d.prototype._emitAll=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];if(null==t)return this;var r=[];for(var o in this._events)for(var i=this._events[o]||[],a=i.length-1;a>=0;a--){var s=i[a];s.once&&i.splice(a,1),r.push(s)}for(var c=r.length-1;c>=0;c--)r[c].callback.apply(t,e);return this},d.prototype.emitAll=function(){for(var t,e=[],n=arguments.length;n--;)e[n]=arguments[n];return(t=this)._emitAll.apply(t,[this].concat(e))},d.prototype.cemitAll=function(t){for(var e,n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return(e=this)._emitAll.apply(e,[t].concat(n))},d.prototype.clear=function(t){return void 0===t&&(t=""),t?delete this._events[t]:this._events={},this};var h=function(t){function e(e){t.call(this),this._connectors=[],this._transceiver=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getConnectors=function(){return this._connectors.concat()},e.prototype.send=function(t,e){for(var n=this._connectors,r=0;r<n.length;r++)n[r].receive(t,{sender:this._transceiver,data:e})},e.prototype.receive=function(t,e){if(this._transceiver.enabled)return this.cemit(t,this._transceiver,e)},e.prototype.connect=function(t){if(t!==this)return-1===this._connectors.indexOf(t)&&this._connectors.push(t),this},e.prototype.disconnect=function(t){if(t!==this){var e=this._connectors.indexOf(t);return e>-1&&this._connectors.splice(e,1),this}},e.prototype.disconnectAll=function(){for(var t=this._connectors,e=t.length-1;e>=0;e--){var n=t[e];this.disconnect(n),n.disconnect(this)}return this},e}(d),y=function(){this.enabled=!0,this._connector=new h(this)};y.prototype.getConnector=function(){return this._connector},y.prototype.emit=function(t,e){if(this.enabled)return this._connector.send(t,e),this},y.prototype.on=function(t,e){return this._connector.on(t,e),this},y.prototype.once=function(t,e){return this._connector.once(t,e),this},y.prototype.off=function(t,e){return this._connector.off(t,e),this},y.prototype.clear=function(t){return void 0===t&&(t=""),this._connector.clear(t),this},y.prototype.connect=function(t){var e=t.getConnector();return this._connector.connect(e),e.connect(this._connector),this},y.prototype.disconnect=function(t){var e=t.getConnector();return this._connector.disconnect(e),e.disconnect(this._connector),this},y.prototype.disconnectAll=function(){return this._connector.disconnectAll(),this},y.create=function(t){for(var e=[],n=0;n<t;n++)e.push(new y);return y.connect(e),e},y.connect=function(t){for(var e=0;e<t.length;e++)for(var n=e+1;n<t.length;n++)t[e].connect(t[n])};var f=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(y),_=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.on=function(e,n){return t.prototype.on.call(this,e,n)},e.prototype.once=function(e,n){return t.prototype.once.call(this,e,n)},e}(y),m=function(t,e){this._isBuild=!1,this._progress=0,this._progressData={start:0,end:0,count:1};var n=t.core,r=t.languages;this._options=e,this._core=n,this._languages=r,this._transmitter=new f,this._coreReceiver=n.createReceiver()};m.prototype.createReceiver=function(){var t=new _;return this._transmitter.connect(t),t},m.prototype._addModalAsync=function(t){var e=this;return new Promise((function(n,r){e._transmitter.emit("addModal",{type:t,onFinish:n})}))},m.prototype._setProgressData=function(t){var e=Math.min(1,Math.max(this._progressData.end,0)),n=Math.min(1,Math.max(e,t.end));this._progress=e,this._progressData={start:e,end:n,count:Math.max(1,t.count)},this._transmitter.emit("preloadProgress",this._progress)},m.prototype._forwardProgress=function(){var t=this._progressData;this._progress+=(t.end-t.start)/t.count,this._progress=Math.min(this._progress,t.end,1),this._transmitter.emit("preloadProgress",this._progress)},m.prototype._finishProgress=function(){this._progress=1,this._transmitter.emit("preloadProgress",1)};var v=function(t){this._core=t},g=!1,w=!1,A=0;function b(){t.Howler&&t.Howler.mute(A>0||g)}var E=function(){},x={isMutedSound:{configurable:!0}};E.watchVisibility=function(){!w&&t.Howler&&(document.addEventListener("visibilitychange",(function(t){"visible"===document.visibilityState?E.forceMute(!1):E.forceMute(!0)})),w=!0)},E.forceMute=function(t){t?A++:--A<0&&(A=0),b()},E.mute=function(e){t.Howler&&(g=e,b())},E.stopAllSounds=function(){t.Howler&&t.Howler.stop()},x.isMutedSound.get=function(){return g},Object.defineProperties(E,x);var P=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(y),C=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.on=function(e,n){return t.prototype.on.call(this,e,n)},e.prototype.once=function(e,n){return t.prototype.once.call(this,e,n)},e}(y),S=function(t){function e(e,n){t.call(this,e),this._transmitter=n,E.watchVisibility()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.sendScoreAsync=function(t,e){return void 0===e&&(e={}),E.stopAllSounds(),this._core.sendScoreAsync(t,e).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.viewAdAsync=function(t){return void 0===t&&(t={}),E.forceMute(!0),this._core.viewAdAsync(t).then((function(){E.forceMute(!1)})).catch((function(t){if(E.forceMute(!1),t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.viewRewardAdAsync=function(t){return void 0===t&&(t={}),E.forceMute(!0),this._core.viewRewardAdAsync(t).then((function(){E.forceMute(!1)})).catch((function(t){if(E.forceMute(!1),t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.setDataAsync=function(t,e,n,r){return void 0===n&&(n="always"),void 0===r&&(r={}),this._core.setDataAsync(t,e,n,r).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.setDataAllAsync=function(t,e){return void 0===e&&(e={}),this._core.setDataAllAsync(t,e).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.flushDataAsync=function(t){return void 0===t&&(t={}),console.warn('[SCG] "flushDataAsync" is called'),this._core.flushDataAsync(t).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e.prototype.callAsync=function(t,e){return void 0===e&&(e={}),this._core.callAsync(t,e)},e.prototype.operateAsync=function(t,e){return void 0===e&&(e={}),this._core.operateAsync(t,e)},e.prototype.prepareContentAsync=function(t,e){var n=this;return void 0===e&&(e={}),new Promise((function(r,o){n._transmitter.emit("prepareContent",{Content:t.Content,onProgress:t.onProgress,isThrowError:e.isThrowError,onFinish:r,onError:o})})).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.ContentLoad,original:t})}))},e.prototype.muteSound=function(t){E.mute(t)},e.prototype.stopAllSounds=function(){E.stopAllSounds()},e.prototype.isMutedSound=function(){return E.isMutedSound},e.prototype.getLanguage=function(){return this._core.getLanguage()},e.prototype.changeLanguageAsync=function(t,e){return void 0===e&&(e={}),this._core.changeLanguageAsync(t,e).catch((function(t){if(t instanceof c.ApiError)throw t;throw new c.ApiError({type:c.api.Basic,original:t})}))},e}(v),k=/iPhone/i,D=/iPod/i,F=/iPad/i,O=/\biOS-universal(?:.+)Mac\b/i,M=/\bAndroid(?:.+)Mobile\b/i,I=/Android/i,T=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,G=/Silk/i,z=/Windows Phone/i,j=/\bWindows(?:.+)ARM\b/i,H=/BlackBerry/i,R=/BB10/i,B=/Opera Mini/i,L=/\b(CriOS|Chrome)(?:.+)Mobile/i,N=/Mobile(?:.+)Firefox\b/i,V=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};var U,W=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,r=n.split("[FBAN");void 0!==r[1]&&(n=r[0]),void 0!==(r=n.split("Twitter"))[1]&&(n=r[0]);var o=function(t){return function(e){return e.test(t)}}(n),i={apple:{phone:o(k)&&!o(z),ipod:o(D),tablet:!o(k)&&(o(F)||V(e))&&!o(z),universal:o(O),device:(o(k)||o(D)||o(F)||o(O)||V(e))&&!o(z)},amazon:{phone:o(T),tablet:!o(T)&&o(G),device:o(T)||o(G)},android:{phone:!o(z)&&o(T)||!o(z)&&o(M),tablet:!o(z)&&!o(T)&&!o(M)&&(o(G)||o(I)),device:!o(z)&&(o(T)||o(G)||o(M)||o(I))||o(/\bokhttp\b/i)},windows:{phone:o(z),tablet:o(j),device:o(z)||o(j)},other:{blackberry:o(H),blackberry10:o(R),opera:o(B),firefox:o(N),chrome:o(L),device:o(H)||o(R)||o(B)||o(N)||o(L)},any:!1,phone:!1,tablet:!1};return i.any=i.apple.device||i.android.device||i.windows.device||i.other.device,i.phone=i.apple.phone||i.android.phone||i.windows.phone,i.tablet=i.apple.tablet||i.android.tablet||i.windows.tablet,i}(navigator),Y=function(){};Y.isSPDevice=function(){return W.any},function(t){t.Standalone="Standalone",t.Yahoo="Yahoo",t.Gmo="Gmo",t.Simeji="Simeji",t.Au="Au",t.Gmode="Gmode",t.FBInstant="FBInstant",t.Lpm="Lpm",t._55bb="55bb",t.GameDistribution="GameDistribution",t.Fourm="Fourm",t.DeNA="DeNA",t.H5GP="H5GP",t.CrazyGames="CrazyGames"}(U||(U={}));var K,q=U;!function(t){t.StartGame="startGame",t.PlayGame="playGame",t.QuitGame="quitGame",t.FinishPlay="finishPlay"}(K||(K={}));var J,Q=K;!function(t){t.More="more",t.Less="less",t.Always="always"}(J||(J={}));var X=J,Z=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.buildAsync=function(t,n){var r=this,o=t.Content,i=t.width,a=t.height,s=t.addVarsAsync,u=t.definePlatformAssetsHandler,l=this._options.basepath||"./",d=this._options.version||"",h=this._options.xhr||!1,y=this._options.typeOptions,f=this._options.pixiOptions||{},_=this._options.addVarsAsync,m=i/a,v=this._options.canScroll||!1,g=t.layers||[];return this._setProgressData({end:.1,count:1}),this._core.startAsync(i,a).then((function(t){var w=t.adjuster,A=t.container||document.body,b=new e.Application(Object.assign(f,{width:i,height:a}),{container:A,autoAdjust:!!t.autoAdjust&&function(t){var e=w(m);t.fullScreen(e)}});b.view.style.position="relative",v&&(b.app.renderer.plugins.interaction.autoPreventDefault=!1,b.app.renderer.view.style.touchAction="auto");var E=void 0===d?"":"string"==typeof d||"number"==typeof d?d:"env"in d&&d.env||"",x={basepath:l,version:d,xhr:h,typeOptions:y},k=new o(x),D=new P,F=new C;D.connect(F);var O=new S(r._core,D),M=r._core.platform(),I={api:O,data:n,env:{hasRewardAd:r._core.hasRewardAd(),isAdPlatform:r._core.isAdPlatform(),isSPDevice:Y.isSPDevice(),platform:M,unuseSynkLogo:r._core.unuseSynkLogo(),basepath:l,languages:r._languages,version:E},enum:{errors:c.api,platforms:q,callTypes:Q,registerTypes:X},additional:{},app:b};u&&u({platform:M,platforms:q});var T=k.assetCount+(t.prepareAsync?1:0)+(s?1:0)+(_?1:0);r._setProgressData({end:.8,count:T}),k.on(e.EVENT_LOADER_ASSET_LOADED,(function(){r._forwardProgress()}));var G=[];G.push(k.prepareAsync()),t.prepareAsync&&G.push(t.prepareAsync());var z={};s&&G.push(s({basepath:l,platform:M,platforms:q}).then((function(t){for(var e in r._forwardProgress(),t)z[e]=t[e]})));var j={};_&&G.push(_({basepath:l,platform:M,platforms:q}).then((function(t){for(var e in r._forwardProgress(),t)j[e]=t[e]})));var H=function(t,n,r,o,i,a){var s=function(t){var n=new t.Content(r);n.addVars(i());var o=t.onProgress;if(o){var a=n.assetCount,s=0;n.on(e.EVENT_LOADER_ASSET_LOADED,(function(){o(++s,a)}))}return n.prepareAsync().then((function(){return n}))};o=o||[],o.indexOf("main")>-1&&o.splice(o.indexOf("main"),1);for(var p=["main"].concat(o),u=0;u<p.length;u++)t.addLayer(p[u]);var l=function(e,n){return void 0===n&&(n="main"),-1===p.indexOf(n)?Promise.reject(new c.ApiError({type:c.api.UndefinedLayer})):t.attachAsync(e,n)};return n.on("prepareContent",(function(e){var n=function(){e.data,s(e.data).then((function(n){e.data.onFinish((function(e){return l(n,e).then((function(e){return{root:e,detach:function(){t.detach(n)}}}))}))})).catch((function(t){e.data.isThrowError?e.data.onError(t):a().then((function(){n()}))}))};n()})),l}(b,F,x,g,(function(){var t=Object.assign({},I);return t.data=r._core.getMemoryData(),t}),(function(){return r._addModalAsync(p.ApiError)}));return Promise.all(G).then((function(){for(var e in z)I.additional[e]=z[e];for(var n in j)I.additional[n]=j[n];return r._setProgressData({end:.9,count:1}),t.onPreloaded?t.onPreloaded():Promise.resolve()})).then((function(){k.addVars(I);var e=w(m);return b.fullScreen(e),r._setProgressData({end:1,count:1}),H(k,"main").then((function(e){return t.onPrepared?t.onPrepared():Promise.resolve()}))})).then((function(){return r._finishProgress(),b.play(),b}))}))},n}(m);var $=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._createGameEngine=function(t){return new Z(t,this._gameEngineOptions)},e}(l),tt=function(t){this._data=t||{}};tt.prototype.updateData=function(t){this._data=t},tt.prototype.get=function(t){if(t in this._data)return this._data[t]},tt.prototype.set=function(t,e,n){switch(void 0===n&&(n="always"),n){case"more":if(this.get(t)>=e)return;break;case"less":if(this.get(t)<=e)return;break;case"always":break;default:return}this._data[t]=e},tt.prototype.json=function(){return JSON.stringify(this._data)},tt.prototype.copy=function(){return JSON.parse(JSON.stringify(this._data))};var et="___SYSTEM___",nt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emit=function(e,n){return t.prototype.emit.call(this,e,n)},e}(y),rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.on=function(e,n){return t.prototype.on.call(this,e,n)},e.prototype.once=function(e,n){return t.prototype.once.call(this,e,n)},e}(y),ot=function(t,e){this._autoFlushWithSendScore=!0,this._isGameStarted=!1,this._playCycle="wait",this._isInitialize=!1;var n=t.languages;this._options=e,this._languages=n,this._transmitter=new nt,this._dataManager=new tt};ot.prototype.createReceiver=function(){var t=new rt;return this._transmitter.connect(t),t},ot.prototype._viewFilter=function(){this._transmitter.emit("viewFilter")},ot.prototype._hideFilter=function(){this._transmitter.emit("hideFilter")},ot.prototype._addModalAsync=function(t,e,n){var r=this;return void 0===n&&(n=!1),n?Promise.reject(e):new Promise((function(e){r._transmitter.emit("addModal",{type:t,onFinish:e})}))},ot.prototype._addCustomModalAsync=function(t,e,n){var r=this;return new Promise((function(o){r._transmitter.emit("addCustomModal",{type:t,texts:e,createHandler:n,onFinish:o})}))},ot.prototype.initializeAsync=function(){var t=this;return this._initializeAsync().then((function(){t._isInitialize=!0}))},ot.prototype.loadDataAsync=function(){return this._isInitialize?this._loadDataAsync():Promise.reject()},ot.prototype.getMemoryData=function(){return this._dataManager.copy()},ot.prototype.introAsync=function(){return this._introAsync()},ot.prototype.startAsync=function(t,e){return this._isInitialize?this._startAsync(t,e):Promise.reject()},ot.prototype.sendScoreAsync=function(t,e){var n=this;if(!this._isInitialize)return Promise.reject();var r=e.isThrowError;return"playing"!==this._playCycle?Promise.reject(new c.ApiError({type:c.api.CycleTiming,message:'You must call the call API "playGame" in advance.'})):(this._viewFilter(),(this._autoFlushWithSendScore?this._processFlushDataAsync(!0,e):Promise.resolve()).then((function(){var o=function(){return n._sendScoreAsync(t,e).catch((function(t){return n._addModalAsync(p.ApiError,t,r).then(o)}))};return o()})).then((function(){n._playCycle="sended",n._hideFilter()})).catch((function(t){throw n._hideFilter(),t})))},ot.prototype.viewAdAsync=function(t){var e=this;return this._isInitialize?(this._viewFilter(),this._viewAdAsync(t).then((function(){e._hideFilter()})).catch((function(t){throw e._hideFilter(),t}))):Promise.reject()},ot.prototype.viewRewardAdAsync=function(t){var e=this;return this._isInitialize?(this._viewFilter(),this._viewRewardAdAsync(t).then((function(){e._hideFilter()})).catch((function(t){return e._hideFilter(),e._addModalAsync(p.RewardAdApiError,t).then((function(){throw t}))}))):Promise.reject()},ot.prototype.setDataAsync=function(t,e,n,r){var o=this;if(!this._isInitialize)return Promise.reject();var i=r.isThrowError,a=function(){return o._setDataAsync(t,e,n,r).catch((function(t){return o._addModalAsync(p.ApiError,t,i).then((function(){return a()}))}))};return a()},ot.prototype.setDataAllAsync=function(t,e){var n=this;return this._isInitialize?Promise.resolve().then((function(){for(var r=[],o=0;o<t.length;o++){var i=t[o];r.push(n.setDataAsync(i.key,i.value,i.registerType||"always",e))}return Promise.all(r)})).then((function(){})):Promise.reject()},ot.prototype._setDataAsync=function(t,e,n,r){return this._dataManager.set(t,e,n),Promise.resolve()},ot.prototype.flushDataAsync=function(t){return this._processFlushDataAsync(!1,t)},ot.prototype._processFlushDataAsync=function(t,e){var n=this;if(!this._isInitialize)return Promise.reject();var r=e.isThrowError,o=function(){return n._flushDataAsync(t,e).catch((function(t){return n._addModalAsync(p.ApiError,t,r).then((function(){return o()}))}))};return o().then((function(){n._transmitter.emit("dataFlushed",n._dataManager.copy())}))},ot.prototype.callAsync=function(t,e){var n=this;if(!this._isInitialize)return Promise.reject();var r=e.isThrowError,o=function(){return n._callAsync(t,e).catch((function(t){return n._addModalAsync(p.ApiError,t,r).then((function(){return o()}))}))};return o().then((function(){if(it[t])return it[t].call(n,e)}))},ot.prototype._callAsync=function(t,e){return Promise.resolve()},ot.prototype.getLanguage=function(){var t=this._getSystemData().language,e=this._languages;return t&&e.indexOf(t)>-1?t:e[0]},ot.prototype.changeLanguageAsync=function(t,e){var n=this;if(!this._isInitialize)return Promise.reject();if(-1===this._languages.indexOf(t))return Promise.reject(new c.ApiError({type:c.api.UnsupportedLanguage,original:null,message:t}));var r=this._getSystemData();return r.language=t,this._setSystemDataAsync(r,e).then((function(){return n._processFlushDataAsync(!1,e)}))},ot.prototype._getSystemData=function(){return this._dataManager.get(et)||{}},ot.prototype._setSystemDataAsync=function(t,e){return this.setDataAsync(et,t,"always",e)},ot.prototype.operateAsync=function(t,e){return Promise.reject(new c.ApiError({type:c.api.UnsupportedOperation,original:null,message:t.type}))};var it={startGame:function(){if(this._isGameStarted)throw new c.ApiError({type:c.api.CycleTiming,message:'The call API "startGame" must not be executed multiple times.'});return this._isGameStarted=!0,this._options.startGameHook?this._options.startGameHook():Promise.resolve()},playGame:function(){if(!this._isGameStarted)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "startGame" in advance.'});if("wait"!==this._playCycle)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "quitGame" or "finishPlay" in advance.'});return this._playCycle="playing",this._options.playGameHook?this._options.playGameHook():Promise.resolve()},quitGame:function(){if(!this._isGameStarted)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "startGame" in advance.'});if("playing"!==this._playCycle)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "playGame" in advance.'});return this._playCycle="wait",this._options.quitGameHook?this._options.quitGameHook():Promise.resolve()},finishPlay:function(){if(!this._isGameStarted)throw new c.ApiError({type:c.api.CycleTiming,message:'You must execute the call API "startGame" in advance.'});if("sended"!==this._playCycle)throw new c.ApiError({type:c.api.CycleTiming,message:"You must execute the send score API in advance."});return this._playCycle="wait",this._options.finishPlayHook?this._options.finishPlayHook():Promise.resolve()}};function at(){try{return!!window.localStorage}catch(t){return!1}}var st=function(t){this._key=t};st.prototype.get=function(){if(!at())return console.warn('[SCG]: "localStorage" is unsupported.'),{};try{var t=window.localStorage.getItem(this._key);return t?JSON.parse(t):{}}catch(t){return{}}},st.prototype.set=function(t){if(at())try{window.localStorage.setItem(this._key,JSON.stringify(t))}catch(t){return}else console.warn('[SCG]: "localStorage" is unsupported.')};var ct=window;function pt(t){var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.style.backgroundColor="#FFF",e.style.textAlign="center",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.display="table",e.style.zIndex="5",e.style.userSelect="none";var n=e.appendChild(document.createElement("div"));n.style.display="table-cell",n.style.verticalAlign="middle";var r=n.appendChild(document.createElement("div"));r.style.width="min(90%, 330px)",r.style.display="inline-block",r.style.fontSize="14px";var o=r.appendChild(document.createElement("div"));if(o.style.margin="20px 10px",o.style.lineHeight="30px",t.icon){var i=o.appendChild(document.createElement("img"));i.src=t.icon,i.style.borderRadius="20%",o.appendChild(document.createElement("br"))}var a=o.appendChild(document.createElement("div"));return a.style.backgroundColor="#E99",a.style.color="#FFF",a.style.fontWeight="bold",a.style.cursor="pointer",a.style.fontSize="24px",a.style.display="inline-block",a.style.width="60%",a.style.lineHeight="50px",a.style.marginTop="30px",a.style.borderRadius="10px",a.style.boxShadow="#000 2px 2px 2px",a.appendChild(document.createTextNode(t.buttonText)),a.addEventListener("click",(function(){t.onFinish()})),e}var ut=function(t){function e(e,n){if(t.call(this,e,n),this._adCallback=null,this._adResolver=null,this._adError=null,!n.gameId)throw new Error('[SCG-GameDistribution] Missing option "gameId"');if(!n.sdk)throw new Error('[SCG-GameDistribution] Missing option "sdk"');if(!n.contentKey)throw new Error('[SCG-GameDistribution] Missing option "contentKey"');n.introOptions=n.introOptions||{},this._storage=new st("snkgd-"+n.contentKey)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype._initializeAsync=function(){var t=this;return new Promise((function(e,n){var r,o,i,a,s;ct.GD_OPTIONS={gameId:t._options.gameId,prefix:"snk__",onEvent:function(r){switch(r.name){case"SDK_READY":return"undefined"!==ct.gdsdk&&ct.gdsdk.preloadAd,void e();case"SDK_ERROR":return void n(r);case"SDK_GAME_START":var o=t._adCallback;return t._adCallback=t._adResolver=t._adError=null,void(o&&o());case"SDK_REWARDED_WATCH_COMPLETE":return void(t._adCallback=t._adResolver);case"AD_ERROR":return void(t._adError=r)}}},t._options.enablePinchIn||(ct.addEventListener("touchmove",(function(t){t.touches.length>1&&t.preventDefault()}),{passive:!1}),document.getElementsByTagName("html")[0].style.touchAction="manipulation"),r=document,o="script",i="gamedistribution-jssdk",s=r.getElementsByTagName(o)[0],r.getElementById(i)||((a=r.createElement(o)).id=i,a.src=t._options.sdk,s.parentNode&&s.parentNode.insertBefore(a,s))}))},e.prototype._introAsync=function(){var t=this;return this._options.usePrerollAd?new Promise((function(e){var n=t.getLanguage(),r=t._options.introOptions,o=r&&r.buttonTexts&&r.buttonTexts[n]?r.buttonTexts[n]:"PLAY",i=(r&&r.createHandler?r.createHandler:pt)({onFinish:function(){e(i)},buttonText:o,icon:r&&r.icon||void 0});(r&&r.container||document.body).appendChild(i)})).then((function(e){return t.viewAdAsync({}).catch((function(t){return t})).then((function(){e.parentNode&&e.parentNode.removeChild(e)}))})):Promise.resolve()},e.prototype._startAsync=function(t,e){return Promise.resolve({adjuster:function(t){var e=ct.innerWidth/ct.innerHeight<t,n=e?ct.innerWidth:ct.innerHeight*t,r=e?ct.innerWidth/t:ct.innerHeight;return{x:(ct.innerWidth-n)/2,y:(ct.innerHeight-r)/2,width:n,height:r}},autoAdjust:!0})},e.prototype._showAd=function(t,e,n){var r=this;if("undefined"!==ct.gdsdk&&"undefined"!==ct.gdsdk.showAd)return this._transmitter.emit("viewFilter","rgba(0, 0, 0, 0.6)"),void("rewarded"===t?(this._adCallback=function(){r._transmitter.emit("hideFilter"),n&&n(new c.ApiError({type:c.api.AdSkipped,original:r._adError}))},this._adResolver=function(){r._transmitter.emit("hideFilter"),e()},ct.gdsdk.showAd("rewarded")):(this._adCallback=function(){r._transmitter.emit("hideFilter"),e()},ct.gdsdk.showAd()));n?n(new c.ApiError({type:c.api.AdMissing})):e()},e.prototype._loadDataAsync=function(){return this._dataManager.updateData(this._storage.get()),Promise.resolve(this._dataManager.copy())},e.prototype._sendScoreAsync=function(t,e){var n=this;return e.skipSubsequent?Promise.resolve():new Promise((function(t,e){n._showAd("",t,e)})).catch((function(t){return t}))},e.prototype._viewAdAsync=function(){var t=this;return new Promise((function(e,n){t._showAd("",e,n)})).catch((function(t){throw new c.ApiError({type:c.api.AdSkipped,original:t})}))},e.prototype._viewRewardAdAsync=function(){var t=this;return new Promise((function(e,n){t._showAd("rewarded",e,n)})).then((function(){console.warn("OK")})).catch((function(t){throw console.warn(t),new c.ApiError({type:c.api.AdSkipped,original:t})}))},e.prototype.hasRewardAd=function(){return!0},e.prototype.isAdPlatform=function(){return!0},e.prototype.platform=function(){return q.GameDistribution},e.prototype.unuseSynkLogo=function(){return!0},e.prototype._flushDataAsync=function(){return this._storage.set(this._dataManager.copy()),Promise.resolve()},e}(ot),lt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.startAsync=function(t){return this._buildAsync(ut,t)},e}($);return new lt}({Howl:"undefined"==typeof Howl?null:Howl,Howler:"undefined"==typeof Howler?null:Howler},Pixim);
