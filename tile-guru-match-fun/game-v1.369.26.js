(function () {
    Object.assign || (Object.assign = function (e) {
        for (var t = 1; t < arguments.length; t++)
            for (var s in arguments[t]) e[s] = arguments[t][s];
        return e
    }), String.prototype.endsWith || (String.prototype.endsWith = function (e, t) {
        var s = this.toString(),
            s = (("number" != typeof t || !isFinite(t) || Math.floor(t) !== t || t > s.length) && (t = s.length), t -= e.length, s.lastIndexOf(e, t));
        return -1 !== s && s === t
    }), void 0 === Array.prototype.at && [Array, String].forEach(function (e) {
        Object.defineProperty(e.prototype, "at", {
            writable: !0,
            enumerable: !1,
            configurable: !0,
            value: function (e) {
                if ((e = (e < 0 ? Math.ceil(e) : Math.floor(e)) || 0) < 0 && (e += this.length), !(e < 0 || e >= this.length)) return this[e]
            }
        })
    }), void 0 === Array.prototype.find && Object.defineProperty(Array.prototype, "find", {
        value: function (e) {
            if (null == this) throw TypeError('"this" is null or not defined');
            var t = Object(this),
                s = t.length >>> 0;
            if ("function" != typeof e) throw TypeError("predicate must be a function");
            for (var i = arguments[1], n = 0; n < s;) {
                var o = t[n];
                if (e.call(i, o, n, t)) return o;
                n++
            }
        },
        configurable: !0,
        writable: !0
    }), void 0 === Array.prototype.flat && Object.defineProperty(Array.prototype, "flat", {
        value: function s() {
            var i = isNaN(arguments[0]) ? 1 : Number(arguments[0]);
            return i ? Array.prototype.reduce.call(this, function (e, t) {
                return Array.isArray(t) ? e.push.apply(e, s.call(t, i - 1)) : e.push(t), e
            }, []) : Array.prototype.slice.call(this)
        },
        configurable: !0,
        writable: !0
    }), String.prototype.startsWith || Object.defineProperty(String.prototype, "startsWith", {
        enumerable: !1,
        configurable: !1,
        writable: !1,
        value: function (e, t) {
            return this.indexOf(e, t = t || 0) === t
        }
    }), String.prototype.includes || (String.prototype.includes = function (e, t) {
        return !((t = "number" != typeof t ? 0 : t) + e.length > this.length) && -1 !== this.indexOf(e, t)
    }), String.prototype.replaceAll || (String.prototype.replaceAll = function (e, t) {
        return "string" == typeof e && (e = e.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")), this.replace(new RegExp(e, "g"), t)
    }), Array.prototype.includes || Object.defineProperty(Array.prototype, "includes", {
        value: function (e, t) {
            if (null == this) throw new TypeError(
                '"this" is null or not defined');
            var s = Object(this),
                i = s.length >>> 0;
            if (0 == i) return !1;
            var n, o, t = 0 | t,
                a = Math.max(0 <= t ? t : i - Math.abs(t), 0);
            for (; a < i;) {
                if ((n = s[a]) === (o = e) || "number" == typeof n && "number" == typeof o && isNaN(n) && isNaN(o)) return !0;
                a++
            }
            return !1
        }
    }), "function" != typeof Object.assign && Object.defineProperty(Object, "assign", {
        value: function (e, t) {
            if (null == e) throw new TypeError("Cannot convert undefined or null to object");
            for (var s = Object(e), i = 1; i < arguments.length; i++) {
                var n = arguments[i];
                if (null != n)
                    for (var o in n) Object.prototype.hasOwnProperty.call(n, o) && (s[o] = n[o])
            }
            return s
        },
        writable: !0,
        configurable: !0
    }), Array.prototype.flat || (Array.prototype.flat = function (e) {
        function i(e, s) {
            return s < 1 ? e.slice() : e.reduce(function (e, t) {
                return e.concat(Array.isArray(t) ? i(t, s - 1) : t)
            }, [])
        }
        return i(this, e = void 0 === e ? 1 : e)
    }), "undefined" == typeof URLSearchParams && (URLSearchParams = function (e) {
        if (this.values = {}, this.size = 0, e)
            for (var t = (e = "?" === e.charAt(0) ? e.substr(1) : e).split("&"), s = 0; s < t.length; s++) {
                var i = t[s].split(
                    "="),
                    n = i[0],
                    i = decodeURIComponent(i[1].replace(/\+/g, " "));
                this.set(n, i)
            }
    }, URLSearchParams.prototype.get = function (e) {
        return this.values[e]
    }, URLSearchParams.prototype.set = function (e, t) {
        this.values[e] = t, this.size = Object.keys(this.values).length
    }, URLSearchParams.prototype.toString = function () {
        return Object.keys(this.values).map(function (e) {
            return e + "=" + this.values[e]
        }, this).join("&")
    });
    var Context, _p, MinimalDialogueDebug, cleverapps = {
        config: document.ccConfig || cc.game.config
    },
        OverridesContainer = ("undefined" == typeof cc && (Context = require("../common/context"), cleverapps = {
            config: JSON.parse(JSON.stringify(Context.getConfig() || {})) || {}
        }), cleverapps.CODE_SUCCEED = 0, cleverapps.CODE_FAILED = 1, cleverapps.CODE_CANCELLED = 2, cleverapps.CODE_PENDING = 3, cleverapps.CODE_CANCELLED_FACEBOOK_DIALOG = 4201, cleverapps.normalize = function (e, t) {
            t = t || 1;
            for (var s = 0, i = 0; i < e.length; i++) s += e[i];
            return e.map(function (e) {
                return e / s * t
            })
        }, cleverapps.getRequestParameters = function (e, t) {
            var s = {},
                e = e || window.location.search;
            if (e)
                for (
                    var i = (e = e.substr(1)).split("&"), n = 0; n < i.length; n++) {
                    var o = i[n].split("="),
                        a = o[0],
                        o = o[1] || "";
                    if (!t) try {
                        o = decodeURIComponent(o.replace(/\+/g, " "))
                    } catch (e) {
                        console.error("getRequestParameters decodeURIComponent - " + o)
                    }
                    s[a] = o
                }
            return s
        }, cleverapps.EventEmitter = function () {
            this.bindings = {}
        }, cleverapps.EventEmitter.prototype.once = function (e, t, s) {
            this.on(e, function () {
                this.off(e), t.apply(this, arguments)
            }.bind(this), s)
        }, cleverapps.EventEmitter.prototype.on = function (t, s, e) {
            this.bindings[t] || (this.bindings[t] = []), this.bindings[t].push(s);
            var i = {
                clear: function () {
                    var e;
                    !this.bindings[t] || 0 <= (e = this.bindings[t].indexOf(s)) && this.bindings[t].splice(e, 1)
                }.bind(this)
            };
            return addCleaner(e, i.clear), i
        }, cleverapps.EventEmitter.prototype.off = function (e) {
            this.bindings[e] = void 0
        }, cleverapps.EventEmitter.prototype.purge = function () {
            this.bindings = {}
        }, cleverapps.EventEmitter.prototype.trigger = function () {
            for (var t = [], e = 0; e < arguments.length; e++) t.push(arguments[e]);
            var s = t.shift();
            this.bindings[s] && this.bindings[s].slice().forEach(function (e) {
                e.apply(this, t)
            })
        }, addCleaner = function (e, t) {
            "object" == typeof e && (e._cleaners || (e._cleaners = []), e._cleaners.push(t))
        }, runCleaners = function (e) {
            e._cleaners && (e._cleaners.forEach(cleverapps.callFunc), delete e._cleaners)
        }, cleverapps.EventsQueue = function (e) {
            this.data = [], this.interval = cleverapps.parseInterval(e)
        }, cleverapps.EventsQueue.prototype.add = function (e) {
            this.data.push(e), this.data.sort(), this.shrink()
        }, cleverapps.EventsQueue.prototype.first = function () {
            if (this.shrink(), 0 < this.data.length) return this.data[0]
        }, cleverapps.EventsQueue.prototype.shrink = function () {
            for (; 0 < this.data.length && this.data[0] + this.interval <= Date.now();) this.data.shift()
        }, cleverapps.EventsQueue.prototype.getShrinkLeftTime = function () {
            if (0 < this.data.length) return this.data[0] + this.interval - Date.now()
        }, cleverapps.EventsQueue.prototype.size = function () {
            return this.shrink(), this.data.length
        }, cleverapps.Cache = function (e) {
            this.capacity = e || 100, this.data = {},
                this.queue = []
        }, cleverapps.Cache.prototype.set = function (e, t) {
            var s;
            this.data[e] || -1 !== (s = this.queue.indexOf(e)) && this.queue.splice(s, 1), this.data[e] = t, this.queue.push(e), this.queue.length > this.capacity && (e = this.queue.shift(), delete this.data[e])
        }, cleverapps.Cache.prototype.get = function (e) {
            return this.data[e]
        }, cleverapps.isRumble = function () {
            var e = cleverapps.meta.getMainObject().knockoutGame;
            return e && e.isRumble()
        }, cleverapps.isKnockoutGame = function () {
            return "knockout" === cleverapps.config.regime
        }, cleverapps.humanReadableNumber = function (e, t) {
            var s = e;
            if ("object" == typeof e) {
                e = e.floatLevel || 0;
                if ("merge" === cleverapps.config.type) return Math.ceil(e) + 1;
                cleverapps.isKnockoutGame() ? e /= 6 : e /= 2, s = Math.floor(e), t = Math.round(Episode.LEVELS_PER_EPISODE * (e - s))
            }
            return (parseInt(s) || 0) * Episode.LEVELS_PER_EPISODE + t + 1
        }, cleverapps.arrayFill = function (e, t) {
            for (var s = [], i = 0; i < e; i++) s.push(t);
            return s
        }, cleverapps.formatAmount = function (e) {
            if (e < 1e3) return e;
            var t = Math.floor(e / 1e3);
            (e -= 1e3 * t) < 10 ? e = "00" + e : e < 100 && (
                e = "0" + e);
            return t + " " + e
        }, cleverapps.cmp = function (e, t) {
            return (e = JSON.stringify(e)) === (t = JSON.stringify(t))
        }, cleverapps.loadSdk = function (e, t) {
            t.onSuccessOnce = t.onSuccessOnce || cleverapps.once(t.onSuccess), t.onFailureOnce = t.onFailureOnce || cleverapps.once(t.onFailure);

            function s() {
                clearTimeout(i), a.onload = void 0, a.onerror = void 0, 1 < t.attempt ? (document.body.contains(a) && document.body.removeChild(a), t.attempt--, cleverapps.loadSdk(e, t)) : o()
            }
            var i, n = t.onSuccessOnce,
                o = t.onFailureOnce,
                a = (void 0 === t.attempt && (t.attempt = 3), document.createElement("script"));
            !1 !== t.crossorigin && a.setAttribute("crossorigin", "anonymous"), a.setAttribute("type", "text/javascript"), a.setAttribute("src", e), t.attrs && Object.keys(t.attrs).forEach(function (e) {
                a.setAttribute(e, t.attrs[e])
            });
            a.onload = function () {
                clearTimeout(i), n()
            }, a.onerror = s, i = setTimeout(s, 3e4), document.body.appendChild(a)
        }, cleverapps.getFrameUserId = function (e, t) {
            var s = (t = t || {}).callback || function () { },
                i = t.key || cleverapps.config.name,
                t = t.timeout || 6e4,
                n = document.createElement("iframe"),
                o = (n.src = e + "cleverapps/res/getitem.html?key=" + i, n.style = "display: none;", document.body.appendChild(n), cleverapps.waitNoMore(t, function (t) {
                    if (console.log("Message received from the child: " + (t && t.data)), window.removeEventListener("message", o), document.body.removeChild(n), t && t.data) try {
                        s(JSON.parse(t && t.data).id)
                    } catch (e) {
                        console.log("parse userid error - " + t && t.data, e)
                    }
                }));
            window.addEventListener("message", o)
        }, cleverapps.setUrlHash = function (e) {
            var t, s = cleverapps.getRequestParameters(window.location.hash);
            for (t in e) {
                var i = e[t];
                void 0 === i ? delete s[t] : s[t] = i
            }
            window.location.hash = Object.keys(s).map(function (e) {
                return e + "=" + s[e]
            }).join("&")
        }, cleverapps.INTERVALS = {
            second: 1,
            minute: 60,
            hour: 3600,
            day: 86400,
            week: 604800,
            month: 2592e3
        }, cleverapps.padZeroes = function (e, t) {
            for (var s = e + ""; s.length < t;) s = "0" + s;
            return s
        }, cleverapps.compactTime = function (e, t) {
            if (!e) return e;
            t = t && t.seconds ? 1e3 : 6e4;
            return Math.max(Math.round((e - cleverapps.ZERO_DATE) / t), 0)
        },
            cleverapps.expandTime = function (e, t) {
                return !e || e > cleverapps.ZERO_DATE ? e : e * (t && t.seconds ? 1e3 : 6e4) + cleverapps.ZERO_DATE
            }, cleverapps.parseInterval = function (e) {
                var t, s = 1e3 * parseInt(e);
                for (t in cleverapps.INTERVALS)
                    if (-1 !== e.indexOf(t)) return s * cleverapps.INTERVALS[t];
                return s
            }, cleverapps.goalCollectSound = function () {
                cleverapps.audio.playSound(bundles.game.urls.goal_inc_effect, {
                    throttle: 100
                })
            }, cleverapps.once = function (t) {
                return function () {
                    var e;
                    if (t) return e = t, t = void 0, e.apply(this, arguments)
                }
            }, cleverapps.shuffle = function (e) {
                for (var t = 0; t < e.length; t++) {
                    var s = cleverapps.Random.random(e.length),
                        i = e[t];
                    e[t] = e[s], e[s] = i
                }
                return e
            }, cleverapps.extractDateFromDateTime = function (e) {
                return new Date(e).setHours(0, 0, 0, 0)
            }, cleverapps.extractNumber = function (e) {
                if (e) {
                    for (var t = "", s = 0; s < e.length; s++) {
                        var i = e.charAt(s);
                        i.match(/\d+/g) ? t += i : "," !== i && "." !== i || (t += ".")
                    }
                    return (-1 !== t.indexOf(".") ? parseFloat : parseInt)(t)
                }
            }, cleverapps.override = function (e, t) {
                for (var s in t) {
                    var i = e[s],
                        n = t[s];
                    !(
                        "undefined" != typeof cc && i instanceof cc.Color || Array.isArray(i) && Array.isArray(n) || "object" != typeof i || "object" != typeof n) ? cleverapps.override(i, n) : e[s] = n
                }
                return e
            }, cleverapps.increaseStylesByKoef = function (e, t) {
                for (var s in e) {
                    var i = e[s];
                    "number" == typeof i ? Array.isArray(e) || cleverapps.UI.needUpdateSizes(e, s, i) && (e[s] *= t, e[s] = Math.round(e[s])) : "object" == typeof i && cleverapps.UI.needUpdateSizes(e, s, i) && cleverapps.increaseStylesByKoef(i, t)
                }
            }, cleverapps.extendStyles = function (e, t) {
                if (t.extendStylesProcessed) return t;
                e = cleverapps.overrideStyles(e, t, !0);
                return e.extendStylesProcessed = !0, Object.assign(t, e), t
            }, cleverapps.overrideStyles = function (e, t, s) {
                for (var i in void 0 !== e && void 0 !== t || console.log(e, t), s && (e = cleverapps.clone(e, !0)), t) {
                    var n = e[i],
                        o = t[i];
                    !(n instanceof cc.Color || n && n.fnt || n && n.tmplt || Array.isArray(n) && Array.isArray(o) || "object" != typeof n || "object" != typeof o) ? cleverapps.overrideStyles(n, o) : e[i] = o
                }
                return e
            }, cleverapps.overrideColors = function (e, t) {
                function s(e) {
                    return e instanceof cc.Color || cc.sys.isNative && e && void 0 !== e.r && void 0 !== e.g && void 0 !== e.b && void 0 !== e.a
                }
                for (var i in t) {
                    var n = e[i],
                        o = t[i];
                    void 0 === n ? e[i] = o : s(n) && s(o) ? (n.r = o.r, n.g = o.g, n.b = o.b, n.a = o.a) : "object" == typeof n && "object" == typeof o ? cleverapps.overrideColors(n, o) : e[i] = o
                }
                return e
            }, cleverapps.overrideFonts = function (e, t) {
                for (var s in t) {
                    var i, n = e[s],
                        o = t[s];
                    if (void 0 === n) e[s] = o;
                    else if (cleverapps.config.debugMode && (i = JSON.stringify(n)), o.size && (n.size = o.size), o.color && (n.color = o.color), o.name && (n.name = o.name), o.lineHeight && (n.lineHeight = o.lineHeight), n.stroke = o.stroke, n.shadow = o.shadow, cleverapps.config.debugMode) {
                        o = JSON.stringify(n);
                        if (i === o) throw console.log("WAS BECOME override " + s), console.log(i, o), "Unnecessary overrideFonts: " + s
                    }
                    e[s].fnt = !0
                }
                return e
            }, cleverapps.overrideTemplates = function (e, t) {
                for (var s in t) {
                    var i = e[s],
                        n = t[s];
                    void 0 === n ? delete e[s] : void 0 === i ? e[s] = n : Object.assign(i, n), e[s] && (e[s].tmplt = !0)
                }
                return e
            }, cleverapps.clone = function (e, t) {
                if (null === e) return null;
                if (
                    "object" != typeof e) return e;
                if ("undefined" != typeof cc && e instanceof cc.Color) return cc.color(e);
                if (Array.isArray(e)) {
                    for (var s = [], i = 0; i < e.length; i++) t ? s.push(cleverapps.clone(e[i], !0)) : s.push(e[i]);
                    return s
                }
                for (var n in s = {}, e)
                    if (e[n] && e[n].fnt) s[n] = e[n];
                    else if (t) {
                        if (cleverapps.config.debugMode && "undefined" != typeof cc && e[n] instanceof cc.Node) throw "clone node object with name - " + n;
                        s[n] = cleverapps.clone(e[n], !0)
                    } else s[n] = e[n];
                return s
            }, cleverapps.accumulate = function (e, s) {
                var i, n, o = void 0;
                return function () {
                    i = this, n = arguments, void 0 === o && (o = setTimeout(function () {
                        clearTimeout(o);
                        var e = i,
                            t = n;
                        n = i = o = void 0, s.apply(e, t)
                    }, e))
                }
            }, cleverapps.async = function (s) {
                return function () {
                    var e = this,
                        t = arguments;
                    setTimeout(function () {
                        s.apply(e, t)
                    }, 0)
                }
            }, cleverapps.extendFunc = function (s, i) {
                return function () {
                    var e = this._super,
                        t = (this._super = s, i.apply(this, arguments));
                    return this._super = e, t
                }
            }, cleverapps.throttle = function (e, t) {
                var s;
                return function () {
                    s || (s = setTimeout(function () {
                        s = void 0
                    }, e), t.apply(this, arguments))
                }
            }, cleverapps.postpone = function (e, t) {
                var s, i, n;
                return function () {
                    s = this, i = arguments, clearTimeout(n), n = setTimeout(function () {
                        t.apply(s, i)
                    }, e)
                }
            }, cleverapps.timeredThrottle = function (s, i) {
                function n() {
                    var e, t;
                    !r && a && (r = setTimeout(function () {
                        r = void 0, n()
                    }, s), e = o, t = a, a = o = void 0, i.apply(e, t))
                }
                var o, a, r;
                return function () {
                    o = this, a = arguments, n()
                }
            }, cleverapps.oneOf = function (e, t) {
                for (var s = Array.isArray(t) ? t : Array.prototype.slice.call(arguments, 1), i = 0; i < s.length; i++)
                    if (e instanceof s[i]) return !0;
                return !1
            }, cleverapps.createSet = function (e) {
                var t = {};
                return e.forEach(function (e) {
                    t[e] = !0
                }), t
            }, cleverapps.contains = function (t, e, s) {
                return s = s || function (e) {
                    return e
                }, t = cleverapps.toArray(t || []).map(s), (e = cleverapps.toArray(e || []).map(s)).filter(function (e) {
                    return -1 !== t.indexOf(e)
                }).length === e.length
            }, cleverapps.substract = function (e, t, s) {
                s = s || function (e) {
                    return e
                }, e = e || [];
                var i = {};
                return (t = t || []).forEach(function (e) {
                    i[s(e)] = !0
                }), e.filter(function (e) {
                    return void 0 === i[s(e)]
                })
            }, cleverapps.intersect = function (e, t, s) {
                s = s || function (e) {
                    return e
                }, e = cleverapps.toArray(e || []), t = cleverapps.toArray(t || []).map(s);
                var i = {};
                return t.forEach(function (e) {
                    i[e] = !0
                }), e.filter(function (e) {
                    return void 0 !== i[s(e)]
                })
            }, cleverapps.unique = function (e, s) {
                if ("undefined" != typeof Set && "function" == typeof Array.from && !s) return Array.from(new Set(e));
                var i = {},
                    n = [];
                return e.forEach(function (e) {
                    var t = s ? s(e) : e;
                    !0 !== i[t] && (n.push(e), i[t] = !0)
                }), n
            }, cleverapps.values = function (e) {
                if (!e) return [];
                if (Object.values) return Object.values(e);
                var t, s = [];
                for (t in e) s.push(e[t]);
                return s
            }, cleverapps.callFunc = function (e) {
                e()
            }, cleverapps.intervalToString = function (e, t) {
                void 0 === t && (t = !0);
                var s, i = (e = Math.ceil(e / 1e3)) % 60,
                    n = (e = Math.floor(e / 60)) % 60,
                    e = Math.floor(e / 60);
                return i < 10 && (i = "0" + i), n < 10 && (n = "0" + n), 24 < e || 24 === e && (0 < n || 0 < i) ? (s = Math.floor(e / 24), Messages.get("dayTimeString", {
                    day: s,
                    hr: e %= 24
                })) : !t && e <= 24 && 0 < e ? Messages.get("hoursMinutesString", {
                    hr: e,
                    min: n
                }) : (e < 10 && (e = "0" + e), (t ? e + ":" : "") + n + ":" + i)
            }, cleverapps.isLevels = function () {
                return !([
                    Metha.NONE
                ].includes(cleverapps.meta.getType()) || ["blocks", "klondike"].includes(cleverapps.config.type))
            }, cleverapps.isStaging = function () {
                return !cc.sys.isNative && cleverapps.config.debugMode && (location.host.includes("labsystech.ru") || location.host.includes("-staging."))
            }, cleverapps.isLocalhost = function () {
                return !cc.sys.isNative && ("localhost" === location.host || "127.0.0.1" === location.host || 0 === location.host.indexOf("192.168."))
            }, cleverapps.isIFrame = function () {
                return window.top !== window.self
            }, cleverapps.checkStatus = function (e, t) {
                return Array.isArray(t) || (t = [t]), Array.isArray(e) ? 0 < e.filter(function (e) {
                    return cleverapps.checkStatus(e, t)
                }).length : -1 !== t.indexOf(e) || e && e.errorMessage && e.errorMessage.status && -1 !== t.indexOf(e.errorMessage.status)
            }, cleverapps.toArray = function (e) {
                return Array.isArray(e) || null == e ? e : [e]
            }, cleverapps.wait = function (e, t) {
                var s;
                {
                    if (0 !== e) return s = 0,
                        function () {
                            ++s === e && t()
                        };
                    t()
                }
            }, cleverapps.waitNoMore = function (e, t) {
                var s = setTimeout(function () {
                    console.log(
                        "waitNoMore timeout: " + e), s = void 0, t()
                }, e);
                return function () {
                    void 0 !== s && (clearTimeout(s), s = void 0, t.apply(this, arguments))
                }
            }, cleverapps.throwAsync = function (e, t) {
                e = "object" == typeof e && e.group ? "REPORT: " + e.group.toUpperCase() + " " + e.message : e + " " + JSON.stringify((t || new Error).stack), e = decodeURIComponent(e), cleverapps.platform && cleverapps.platform.oneOf(Wechat) ? window.onerror(e) : setTimeout(function () {
                    throw e
                }, 0)
            }, cleverapps.isNumber = function (e) {
                return "string" == typeof e && e && /^[0-9]+$/.test(e) || "number" == typeof e && !isNaN(e)
            }, cleverapps.castType = function (e) {
                return "string" == typeof e && cleverapps.isNumber(e) ? parseInt(e) : e
            }, cleverapps.rangeArray = function (e, t) {
                for (var s = [], i = e; i <= t; i++) s.push(i);
                return s
            }, cleverapps.splitToChunks = function (e, t) {
                for (var s = Math.ceil(e.length / t), i = []; 0 < e.length;) i.push(e.splice(0, s));
                return i
            }, cleverapps.splitToBatches = function (e, t) {
                for (var s = []; 0 < e.length;) s.push(e.splice(0, t));
                return s
            }, cleverapps.sign = function (e) {
                return e < 0 ? -1 : 0 < e ? 1 : 0
            }, cleverapps.clamp = function (e,
                t, s) {
                return Math.min(Math.max(t, e), s)
            }, cleverapps.splitHalfByWord = function (e) {
                for (var t = Math.floor(e.length / 2), s = -1, i = 0; i <= t && -1 === s; i++) " " === e.charAt(t - i) ? s = t - i : " " === e.charAt(t + i) && (s = t + i);
                return -1 === s ? [e] : [e.substr(0, s), e.substr(s + 1)]
            },
            function () {
                this.overrides = []
            }),
        WebViewLocalStorage = (OverridesContainer.prototype.override = function (e, t, s) {
            var i;
            e && (i = e[t], e[t] = s, this.overrides.push({
                target: e,
                key: t,
                value: s,
                oldValue: i
            }))
        }, OverridesContainer.prototype.unoverride = function () {
            var e = this.overrides;
            this.overrides = [], e.forEach(function (e) {
                e.target[e.key] = e.oldValue
            })
        }, cleverapps.RUB_DISCOUNTED_RATE = 20, cleverapps.RUB_YOOKASSA_RATE = 50, cleverapps.WECHAT_PAYMENTS_RATE = 5, cleverapps.EXCHANGE_RATES = {
            EUR: 1,
            RUB: 90,
            GBP: .85,
            DEM: 1.7,
            JPY: 132,
            INR: 80,
            FRF: 6.5,
            CAD: 1.3,
            AUD: 1.45,
            BEF: 40.6,
            CNY: 7.13,
            SGD: 1.34
        }, cleverapps.NO_ACTION = "no_action", cleverapps.ONE_HOUR = cleverapps.parseInterval("1 hour"), cleverapps.ONE_DAY = cleverapps.parseInterval("1 day"), cleverapps.colorToHex = function (e) {
            return (e.r << 16) + (e.g << 8) + (
                0 | e.b)
        }, cleverapps.hashCode = function (e) {
            if (null == e || "number" == typeof e && isNaN(e)) return 0;
            e += "";
            for (var t = 0, s = 0; s < e.length; s++) t = (t << 5) - t + e.charCodeAt(s);
            return t
        }, cleverapps.reverseObject = function (e) {
            var t, s = {};
            for (t in e) {
                var i = e[t];
                if (void 0 !== s[i]) throw "Not unique key - " + t;
                s[i] = t
            }
            return s
        }, cleverapps.validateEmail = function (e) {
            return /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)
        }, cleverapps.fromBit = function (e) {
            if (!e) return [];
            e = cleverapps.toArray(e);
            var s, i = [];
            return e.forEach(function (e, t) {
                for (s = cleverapps.SYNCED_BITS * t; e;) e % 2 && i.push(s), e = Math.floor(e / 2), s++
            }), i
        }, cleverapps.toBit = function (e, t) {
            t = t || cleverapps.SYNCED_BITS;
            var s, i, n = Math.ceil(t / cleverapps.SYNCED_BITS),
                o = cleverapps.arrayFill(n, 0),
                a = 0;
            return e.forEach(function (e) {
                t <= e ? cleverapps.throwAsync(e + " is bigger then " + t) : (i = e % cleverapps.SYNCED_BITS, s = (e - i) / cleverapps.SYNCED_BITS, o[s] += Math.pow(2, i), a = Math.max(s, a))
            }),
                1 === n || 0 === a ? o[0] : o.slice(0, a + 1)
        }, cleverapps.listToBit = function (e) {
            var t, s = {};
            for (t in e) {
                var i = cleverapps.toBit(Object.keys(e[t]));
                0 !== i && (s[t] = i)
            }
            return s
        }, cleverapps.listFromBit = function (e) {
            var t, s = {};
            for (t in e) "object" == typeof e[t] ? s[t] = e[t] : s[t] = cleverapps.createSet(cleverapps.fromBit(e[t]));
            return s
        }, cleverapps.countPendingRequests = function (e) {
            function t() {
                void 0 !== cleverapps.pendingRequestsFreezeTimeout && (clearTimeout(cleverapps.pendingRequestsFreezeTimeout), delete cleverapps.pendingRequestsFreezeTimeout)
            }

            function s() {
                cleverapps.pendingRequests--, cleverapps.pendingRequests <= 0 && (cleverapps.pendingRequests = 0, t())
            }
            cleverapps.pendingRequests || (t(), cleverapps.pendingRequestsFreezeTimeout = new cleverapps.LongTimeout(function () {
                cleverapps.pendingRequests && (cleverapps.pendingRequests = 0, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.PENDING_REQUESTS_FREEZE)), t()
            }, cleverapps.parseInterval("5 minutes"))), cleverapps.pendingRequests = (cleverapps.pendingRequests || 0) + 1;
            var i = {},
                n = (
                    e.then(function () {
                        s(), i.then && i.then.apply(this, arguments)
                    }).catch(function () {
                        s(), i.catch && i.catch.apply(this, arguments)
                    }), {
                        then: function (e) {
                            return i.then = e, n
                        },
                        catch: function (e) {
                            return i.catch = e, n
                        }
                    });
            return n
        }, cleverapps.fakePromise = function () {
            function e() {
                return e
            }
            return e.then = function () {
                return e
            }, e.catch = function () {
                return e
            }, e
        }, cleverapps.getCanvas = function () {
            return document.getElementById("GameCanvas")
        }, cleverapps.copyToClipboard = function (t, s) {
            s = s || function () {
                cleverapps.notification.create("Copied to clipboard")
            };

            function i() {
                setTimeout(function () {
                    var e = document.createElement("textArea");
                    e.value = t, e.style.hidden = !0, document.body.appendChild(e);
                    try {
                        e.select(), document.execCommand("copy"), s()
                    } catch (e) {
                        console.log("Couldn't copy text to clipboard:", t)
                    }
                    document.body.removeChild(e)
                }, 0)
            }
            try {
                cleverapps.platform.oneOf(Wechat) ? wx.setClipboardData({
                    data: t,
                    success: function () {
                        s()
                    },
                    fail: function (e) {
                        console.log("wx.setClipboardData fail", e)
                    }
                }) : window.navigator.clipboard.writeText(t).then(s).catch(i)
            } catch (e) {
                i()
            }
        }, cleverapps.isNodeOrElement = function (e) {
            return ("object" == typeof Node ? e instanceof Node : e && "object" == typeof e && "number" == typeof e.nodeType && "string" == typeof e.nodeName) || ("object" == typeof HTMLElement ? e instanceof HTMLElement : e && "object" == typeof e && null !== e && 1 === e.nodeType && "string" == typeof e.nodeName)
        }, cleverapps.whenGameActiveListener = function (s) {
            return function () {
                var e = this,
                    t = arguments;
                cleverapps.whenGameActive(function () {
                    s.apply(e, t)
                })
            }
        }, cleverapps.whenGameActive = function (e) {
            cc.game.isPaused() ? cleverapps.timeouts.setTimeout(e, 0) : e()
        }, cleverapps.cutStringsReplacer = function (e, t) {
            return t = "string" == typeof t && 50 < t.length ? t.slice(0, 50) + "..." : t
        }, cleverapps.ZERO_DATE = new Date("2020-01-01").getTime(), cleverapps.SYNCED_BITS = 52, cleverapps.EMPTY_FUNCTION = function () { }, "undefined" != typeof cc && cleverapps.config.debugMode && void 0 !== cleverapps.getRequestParameters(window.location.hash).dropDebugMode && (cleverapps.config.debugMode = !1), "undefined" == typeof cc && (
            module.exports = cleverapps), function () {
                this.data = {}
            }),
        WebViewConsole = (WebViewLocalStorage.prototype.initialize = function (s) {
            cleverapps.platform.callNative("LocalStoragePlugin.initialize", function (e, t) {
                this.data = t.data || {}, s()
            }.bind(this))
        }, WebViewLocalStorage.prototype.getItem = function (e) {
            return this.data[e]
        }, WebViewLocalStorage.prototype.setItem = function (e, t) {
            cleverapps.platform.callNative("LocalStoragePlugin.setItem", {
                key: e,
                value: t
            }), this.data[e] = t
        }, WebViewLocalStorage.prototype.removeItem = function (e) {
            cleverapps.platform.callNative("LocalStoragePlugin.removeItem", {
                key: e
            }), delete this.data[e]
        }, WebViewLocalStorage.prototype.clear = function () {
            cleverapps.platform.callNative("LocalStoragePlugin.clear"), this.data = {}
        }, WebViewLocalStorage.prototype.getData = function () {
            return this.data
        }, {
            init: function () {
                console.log = WebViewConsole.createMethod("ConsolePlugin.log"), console.warn = WebViewConsole.createMethod("ConsolePlugin.warn"), console.debug = WebViewConsole.createMethod("ConsolePlugin.debug"),
                    console.info = WebViewConsole.createMethod("ConsolePlugin.info"), console.error = WebViewConsole.createMethod("ConsolePlugin.error")
            },
            createMethod: function (t) {
                return function () {
                    for (var e = 0; e < arguments.length; e++)
                        if (cleverapps.isNodeOrElement(arguments[e])) return;
                    cleverapps.platform.callNative(t, {
                        message: arguments[0],
                        params: Array.from(arguments).slice(1)
                    })
                }
            }
        }),
        ResourceProcessor = {
            addStaticUrl: function () {
                function s(e) {
                    return "string" == typeof e && -1 !== [".plist", ".atlas"].indexOf(cc.path.extname(e))
                }

                function n(e, t) {
                    if ("string" == typeof e && "@" === e.charAt(0)) return e;
                    if ("string" == typeof e && -1 === e.indexOf(t)) return "undefined" != typeof unpackedMap && (unpackedMap[t + e] = unpackedMap[e]), t + e;
                    if ("font" === e.type) return e.srcs = e.srcs.map(function (e) {
                        return n(e, t)
                    }), e;
                    if ("object" != typeof e) return e;
                    var s, i = {};
                    for (s in e) i[s] = n(e[s], t);
                    return i
                }
                var e, t = Object.keys(bundles);
                for (e in t) {
                    var p = t[e],
                        i = bundles[p],
                        o = cleverapps.config.staticUrl,
                        a = cleverapps.config.externalStaticUrl || "";
                    if (o || a)
                        for (var r in i.urls) {
                            var c = i.urls[r],
                                l = i.external && ("string" == typeof (l = c) && -1 !== [".png", ".jpg"].indexOf(cc.path.extname(l))) && a || o;
                            l && (i.urls[r] = n(c, l))
                        }
                    o && Object.keys(i.jsons).forEach(function (e) {
                        var t;
                        (s(i.jsons[e]) || "string" == typeof (t = i.jsons[e]) && -1 !== [".json"].indexOf(cc.path.extname(t)) && "levels" === e && i.urls.levels) && (i.jsons[e] = n(i.jsons[e], o))
                    }), Object.keys(i.urls).forEach(function (e) {
                        s(i.urls[e]) && (i.jsons[e] = i.urls[e])
                    })
                }
            },
            calcAlwaysNeed: function () {
                var e = ["main"];
                return cleverapps.config.debugMode && e.push("dev_resources"), e
            },
            calcProbablyNeed: function () {
                if ("playable" === cleverapps.config.source) return [];
                var e = ResourceProcessor.calcAlwaysNeed(),
                    t = (cleverapps.settings && e.push("language_" + cleverapps.settings.language), cleverapps.Plot.onStartup(void 0, !0)),
                    s = [],
                    t = ("object" == typeof t && (s = t.options, t = t.scene), new t(s[0], s[1], s[2], s[3], s[4])),
                    e = e.concat(t.listBundles(), t.listBaseBundles());
                return e = (e = cleverapps.unique(e)).filter(function (e) {
                    return void 0 !== bundles[e]
                })
            }
        },
        bundles = {
            ads_bubble: {
                virtual: !0,
                injectTo: ["tile_shop", "main"],
                jsonIds: ["%n_json"]
            },
            attention: {
                virtual: !0,
                injectTo: ["game", "starter_pack", "daily_cup", "tile_shop", "periodic_sale", "chain_sale", "main", "dev_resources"],
                frameIds: ["%n_png"]
            },
            avatar: {
                virtual: !0,
                injectTo: ["game", "daily_cup", "main"],
                frameIds: ["%n_frame", "%n_frame2", "android_%n", "ios_%n", "user_%n", "default_%n"]
            },
            backgrounds_window_0: {
                urls: {
                    background: "@background_0-982bd4928c.jpg"
                }
            },
            backgrounds_window_1: {
                urls: {
                    background: "@background_1-f1409a3614.jpg"
                }
            },
            backgrounds_window_10: {
                urls: {
                    background: "@background_10-487f65787a.jpg"
                }
            },
            backgrounds_window_11: {
                urls: {
                    background: "@background_11-11db2ba54b.jpg"
                }
            },
            backgrounds_window_12: {
                urls: {
                    background: "@background_12-35a13b3b2d.jpg"
                }
            },
            backgrounds_window_13: {
                urls: {
                    background: "@background_13-79350bcd64.jpg"
                }
            },
            backgrounds_window_14: {
                urls: {
                    background: "@background_14-b8f7760d08.jpg"
                }
            },
            backgrounds_window_15: {
                urls: {
                    background: "@background_15-32264d3ade.jpg"
                }
            },
            backgrounds_window_16: {
                urls: {
                    background: "@background_16-d9188b9ad8.jpg"
                }
            },
            backgrounds_window_17: {
                urls: {
                    background: "@background_17-258ebcc530.jpg"
                }
            },
            backgrounds_window_18: {
                urls: {
                    background: "@background_18-2c7052e875.jpg"
                }
            },
            backgrounds_window_19: {
                urls: {
                    background: "@background_19-a41b8f7649.jpg"
                }
            },
            backgrounds_window_2: {
                urls: {
                    background: "@background_2-a5646ae68d.jpg"
                }
            },
            backgrounds_window_20: {
                urls: {
                    background: "@background_20-4d8b4f2367.jpg"
                }
            },
            backgrounds_window_21: {
                urls: {
                    background: "@background_21-cd3615dc2a.jpg"
                }
            },
            backgrounds_window_22: {
                urls: {
                    background: "@background_22-454f97aae1.jpg"
                }
            },
            backgrounds_window_23: {
                urls: {
                    background: "@background_23-6b249771f1.jpg"
                }
            },
            backgrounds_window_24: {
                urls: {
                    background: "@background_24-f5440c5311.jpg"
                }
            },
            backgrounds_window_25: {
                urls: {
                    background: "@background_25-ef8a8b4836.jpg"
                }
            },
            backgrounds_window_26: {
                urls: {
                    background: "@background_26-8fbbd91a15.jpg"
                }
            },
            backgrounds_window_27: {
                urls: {
                    background: "@background_27-6f86926b48.jpg"
                }
            },
            backgrounds_window_28: {
                urls: {
                    background: "@background_28-5027ed77e1.jpg"
                }
            },
            backgrounds_window_29: {
                urls: {
                    background: "@background_29-9f5f77f42e.jpg"
                }
            },
            backgrounds_window_3: {
                urls: {
                    background: "@background_3-6b668f2766.jpg"
                }
            },
            backgrounds_window_30: {
                urls: {
                    background: "@background_30-934b009b06.jpg"
                }
            },
            backgrounds_window_31: {
                urls: {
                    background: "@background_31-49856d6482.jpg"
                }
            },
            backgrounds_window_32: {
                urls: {
                    background: "@background_32-d9f968e8c6.jpg"
                }
            },
            backgrounds_window_33: {
                urls: {
                    background: "@background_33-822e222630.jpg"
                }
            },
            backgrounds_window_34: {
                urls: {
                    background: "@background_34-53ca96b895.jpg"
                }
            },
            backgrounds_window_35: {
                urls: {
                    background: "@background_35-7805979731.jpg"
                }
            },
            backgrounds_window_36: {
                urls: {
                    background: "@background_36-8d3a3dad44.jpg"
                }
            },
            backgrounds_window_37: {
                urls: {
                    background: "@background_37-f748d83974.jpg"
                }
            },
            backgrounds_window_38: {
                urls: {
                    background: "@background_38-9fd1ff1d58.jpg"
                }
            },
            backgrounds_window_39: {
                urls: {
                    background: "@background_39-0e41ac2945.jpg"
                }
            },
            backgrounds_window_4: {
                urls: {
                    background: "@background_4-80e03ed5b9.jpg"
                }
            },
            backgrounds_window_5: {
                urls: {
                    background: "@background_5-e5c2b93b18.jpg"
                }
            },
            backgrounds_window_6: {
                urls: {
                    background: "@background_6-9f92623351.jpg"
                }
            },
            backgrounds_window_7: {
                urls: {
                    background: "@background_7-3391aa080f.jpg"
                }
            },
            backgrounds_window_8: {
                urls: {
                    background: "@background_8-3a0a3fe3b2.jpg"
                }
            },
            backgrounds_window_9: {
                urls: {
                    background: "@background_9-5af19e74cc.jpg"
                }
            },
            backgrounds_window_vertical_0: {
                urls: {
                    background: "@background_vertical_0-d9cd127c77.jpg"
                }
            },
            backgrounds_window_vertical_1: {
                urls: {
                    background: "@background_vertical_1-d6972d07c6.jpg"
                }
            },
            backgrounds_window_vertical_10: {
                urls: {
                    background: "@background_vertical_10-0058438162.jpg"
                }
            },
            backgrounds_window_vertical_11: {
                urls: {
                    background: "@background_vertical_11-50426ce87e.jpg"
                }
            },
            backgrounds_window_vertical_12: {
                urls: {
                    background: "@background_vertical_12-d84b8374e6.jpg"
                }
            },
            backgrounds_window_vertical_13: {
                urls: {
                    background: "@background_vertical_13-90d5585f19.jpg"
                }
            },
            backgrounds_window_vertical_14: {
                urls: {
                    background: "@background_vertical_14-d1b43bbd67.jpg"
                }
            },
            backgrounds_window_vertical_15: {
                urls: {
                    background: "@background_vertical_15-34b21d121e.jpg"
                }
            },
            backgrounds_window_vertical_16: {
                urls: {
                    background: "@background_vertical_16-b6e95b301c.jpg"
                }
            },
            backgrounds_window_vertical_17: {
                urls: {
                    background: "@background_vertical_17-8092151671.jpg"
                }
            },
            backgrounds_window_vertical_18: {
                urls: {
                    background: "@background_vertical_18-f49d29a818.jpg"
                }
            },
            backgrounds_window_vertical_19: {
                urls: {
                    background: "@background_vertical_19-57cb56be83.jpg"
                }
            },
            backgrounds_window_vertical_2: {
                urls: {
                    background: "@background_vertical_2-b8294c37a7.jpg"
                }
            },
            backgrounds_window_vertical_20: {
                urls: {
                    background: "@background_vertical_20-7bcf57a51e.jpg"
                }
            },
            backgrounds_window_vertical_21: {
                urls: {
                    background: "@background_vertical_21-5032e34365.jpg"
                }
            },
            backgrounds_window_vertical_22: {
                urls: {
                    background: "@background_vertical_22-8e68fb0622.jpg"
                }
            },
            backgrounds_window_vertical_23: {
                urls: {
                    background: "@background_vertical_23-8273f5dc73.jpg"
                }
            },
            backgrounds_window_vertical_24: {
                urls: {
                    background: "@background_vertical_24-839ad8888c.jpg"
                }
            },
            backgrounds_window_vertical_25: {
                urls: {
                    background: "@background_vertical_25-296deac7a7.jpg"
                }
            },
            backgrounds_window_vertical_26: {
                urls: {
                    background: "@background_vertical_26-9fe2540f91.jpg"
                }
            },
            backgrounds_window_vertical_27: {
                urls: {
                    background: "@background_vertical_27-232bdd9d3d.jpg"
                }
            },
            backgrounds_window_vertical_28: {
                urls: {
                    background: "@background_vertical_28-840b218855.jpg"
                }
            },
            backgrounds_window_vertical_29: {
                urls: {
                    background: "@background_vertical_29-77c8a79cc2.jpg"
                }
            },
            backgrounds_window_vertical_3: {
                urls: {
                    background: "@background_vertical_3-7cedff540c.jpg"
                }
            },
            backgrounds_window_vertical_30: {
                urls: {
                    background: "@background_vertical_30-8c3e40af32.jpg"
                }
            },
            backgrounds_window_vertical_31: {
                urls: {
                    background: "@background_vertical_31-54d96b9200.jpg"
                }
            },
            backgrounds_window_vertical_32: {
                urls: {
                    background: "@background_vertical_32-8b684d9e56.jpg"
                }
            },
            backgrounds_window_vertical_33: {
                urls: {
                    background: "@background_vertical_33-3d7dab4c44.jpg"
                }
            },
            backgrounds_window_vertical_34: {
                urls: {
                    background: "@background_vertical_34-e1c8538fec.jpg"
                }
            },
            backgrounds_window_vertical_35: {
                urls: {
                    background: "@background_vertical_35-49fb84be40.jpg"
                }
            },
            backgrounds_window_vertical_36: {
                urls: {
                    background: "@background_vertical_36-a956dbb1e7.jpg"
                }
            },
            backgrounds_window_vertical_37: {
                urls: {
                    background: "@background_vertical_37-fc6f3ffa71.jpg"
                }
            },
            backgrounds_window_vertical_38: {
                urls: {
                    background: "@background_vertical_38-9bdeed2a43.jpg"
                }
            },
            backgrounds_window_vertical_39: {
                urls: {
                    background: "@background_vertical_39-39d21d8cfb.jpg"
                }
            },
            backgrounds_window_vertical_4: {
                urls: {
                    background: "@background_vertical_4-d2cca594dc.jpg"
                }
            },
            backgrounds_window_vertical_5: {
                urls: {
                    background: "@background_vertical_5-1827ea2a6f.jpg"
                }
            },
            backgrounds_window_vertical_6: {
                urls: {
                    background: "@background_vertical_6-3378f9be3c.jpg"
                }
            },
            backgrounds_window_vertical_7: {
                urls: {
                    background: "@background_vertical_7-01eaaff295.jpg"
                }
            },
            backgrounds_window_vertical_8: {
                urls: {
                    background: "@background_vertical_8-7fee6167f0.jpg"
                }
            },
            backgrounds_window_vertical_9: {
                urls: {
                    background: "@background_vertical_9-7cc2a371a6.jpg"
                }
            },
            badge: {
                virtual: !0,
                injectTo: ["tile_shop", "periodic_sale"],
                frameIds: ["%n_png", "%n_off_png"]
            },
            big_buttons: {
                urls: {}
            },
            big_digits: {
                virtual: !0,
                injectTo: ["game", "starter_pack"],
                frameIds: ["default72pt_0", "default72pt_1", "default72pt_2", "default72pt_3", "default72pt_4", "default72pt_5", "default72pt_6", "default72pt_7", "default72pt_8", "default72pt_9", "default72pt_colon", "default72pt_slash", "default72pt_plus", "default72pt_minus", "default72pt_x", "default72pt_space", "default72pt_asterisk", "default72pt_percent", "default97pt_0", "default97pt_1", "default97pt_2", "default97pt_3", "default97pt_4", "default97pt_5", "default97pt_6", "default97pt_7", "default97pt_8", "default97pt_9", "default97pt_colon", "default97pt_slash", "default97pt_plus", "default97pt_minus", "default97pt_x", "default97pt_space", "default97pt_asterisk", "default97pt_percent"]
            },
            big_timer: {
                virtual: !0,
                injectTo: ["chain_sale"],
                frameIds: ["%n_png", "%n_bg_png"]
            },
            bomb_moves_window: {
                urls: {}
            },
            booster_effects: {
                virtual: !0,
                injectTo: ["game"],
                jsonIds: ["vacuum_json", "vacuum_stick_json"],
                soundIds: ["vacuum_effect"]
            },
            boosters_before: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["booster_before_bg_png", "booster_before_bg_off_png", "booster_before_bg_on_png", "booster_before_green_button_png", "booster_before_purple_button_png", "booster_before_check_icon_png", "booster_before_lock_png", "booster_before_lantern_icon_png", "booster_before_level_bg"],
                soundIds: ["booster_before_selection_effect", "booster_before_cancel_effect", "appear_sfx"]
            },
            buttons: {
                virtual: !0,
                injectTo: ["game", "starter_pack", "daily_cup", "tile_shop", "periodic_sale", "chain_sale", "main", "dev_resources"],
                frameIds: ["button_png", "button_on_png", "button_disabled_png", "small_button", "small_button_on", "small_button_off", "blue_button_png", "blue_button_on_png", "small_blue_button", "small_blue_button_on", "red_button", "red_button_on", "help_button_png", "help_button_on_png", "help_button_off_png", "sign_in_button_png", "sign_in_button_on_png",
                    "vacuum_png"
                ],
                jsonIds: ["shuffle_json", "undo_json"]
            },
            buttons_inlined_icons: {
                virtual: !0,
                injectTo: ["game", "starter_pack", "daily_cup", "tile_shop", "periodic_sale", "chain_sale", "main", "dev_resources"],
                frameIds: ["gold_icon_png", "coin_icon_png", "ad_icon_png", "ok_icon_png", "yandex_icon_png", "playhop_icon_png", "kred_icon_png"]
            },
            buttons_main: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["window_close_png", "window_close_on_png", "close_band_icon", "scene_exit_button", "music_off_png", "music_on_png", "sound_off_png", "sound_on_png", "close_small", "close_small_on", "community_icon", "copyid_icon", "delete_icon", "exit_icon", "giveup_icon", "language_icon", "support_icon", "home_icon"]
            },
            card: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["tile", "open%ns_bg", "open%ns_fg", "skin_random", "skin_0", "skin_1", "skin_2", "skin_3", "skin_4", "skin_5", "skin_6", "skin_7", "skin_8", "skin_9", "skin_10", "skin_11", "skin_12", "skin_13", "skin_14", "skin_15", "skin_16", "skin_17", "skin_18", "skin_19", "skin_event_0", "skin_event_1", "skin_event_2",
                    "skin_event_3", "skin_event_4", "skin_event_5"
                ],
                jsonIds: ["explode_json", "starparticles_json", "open_warning_json", "plate_json", "bomb_json", "bomb_explosion_json", "effects_json", "curtain_json", "ice_json"],
                soundIds: ["plate_breaks_off_effect", "plate_collect_effect", "plate_click_effect"]
            },
            chain_sale: {
                urls: {
                    chain_sale_window_effect: "~sounds/%n_window-4b964d0676.mp3",
                    chain_sale_open_effect: "~sounds/%n_open-202f6470df.mp3",
                    png: "@%n-11e9cb62d0.png",
                    json: "@%n-97d6778ab9.json"
                },
                jsons: {
                    atlas: "@%n-11e9cb62d0.atlas",
                    button_light_json: "@button_light-868bd08049.json",
                    chain_sale_bg_json: "@chainsale_bg-5534564c9e.json",
                    checkmark_json: "@clear_w-61335d2d40.json",
                    lock_json: "@lock-df23c311c6.json",
                    plist: "@%n-11e9cb62d0.plist",
                    shuffle_json: "@replace-047fbf09bc.json",
                    undo_json: "@undo-d2995bab03.json"
                },
                frames: {
                    coins_png: "#%n-w_coin.png",
                    free_tile_bg: "#%n-free_tile_bg.png",
                    paid_tile_bg: "#%n-paid_tile_bg.png",
                    arrow_png: "#%n-arrow.png",
                    yellow_button: "#%n-button_yellow.png",
                    yellow_button_on: "#%n-button_yellow_on.png",
                    gold_small_png: "#%n-reward_icons-ruby_small.png",
                    coin_small_png: "#%n-reward_icons-coin_small.png",
                    reward_gold_png: "#%n-reward_icons-ruby.png",
                    reward_coin_png: "#%n-reward_icons-coin.png",
                    shop_gold_png: "#%n-reward_icons-ruby_shop.png",
                    shop_coin_png: "#%n-reward_icons-coin_shop.png",
                    bonussale_gift: "#%n-reward_icons-bonussale_gift.png",
                    life_png: "#%n-reward_icons-life.png",
                    life_small_png: "#%n-reward_icons-life_small.png",
                    life_unlim: "#%n-reward_icons-life_unlim.png",
                    life_unlim_small: "#%n-reward_icons-life_unlim_small.png",
                    simple_star_png: "#%n-reward_icons-simple_star.png",
                    booster_tile_shuffle_png: "#%n-reward_icons-booster_tile_shuffle.png",
                    booster_vacuum_png: "#%n-reward_icons-booster_vacuum.png",
                    booster_undo_png: "#%n-reward_icons-booster_undo.png",
                    underline_png: "#%n-underline-underline.png",
                    nostroke56pt_0: "#%n-marvin-round-nostroke-56pt-0.png",
                    nostroke56pt_1: "#%n-marvin-round-nostroke-56pt-1.png",
                    nostroke56pt_2: "#%n-marvin-round-nostroke-56pt-2.png",
                    nostroke56pt_3: "#%n-marvin-round-nostroke-56pt-3.png",
                    nostroke56pt_4: "#%n-marvin-round-nostroke-56pt-4.png",
                    nostroke56pt_5: "#%n-marvin-round-nostroke-56pt-5.png",
                    nostroke56pt_6: "#%n-marvin-round-nostroke-56pt-6.png",
                    nostroke56pt_7: "#%n-marvin-round-nostroke-56pt-7.png",
                    nostroke56pt_8: "#%n-marvin-round-nostroke-56pt-8.png",
                    nostroke56pt_9: "#%n-marvin-round-nostroke-56pt-9.png",
                    nostroke56pt_colon: "#%n-marvin-round-nostroke-56pt-colon.png",
                    nostroke56pt_slash: "#%n-marvin-round-nostroke-56pt-slash.png",
                    nostroke56pt_plus: "#%n-marvin-round-nostroke-56pt-plus.png",
                    nostroke56pt_minus: "#%n-marvin-round-nostroke-56pt-minus.png",
                    nostroke56pt_x: "#%n-marvin-round-nostroke-56pt-x.png",
                    nostroke56pt_space: "#%n-marvin-round-nostroke-56pt-space.png",
                    nostroke56pt_asterisk: "#%n-marvin-round-nostroke-56pt-asterisk.png",
                    nostroke56pt_percent: "#%n-marvin-round-nostroke-56pt-percent.png",
                    default41pt_0: "#%n-marvin-round-41pt-0.png",
                    default41pt_1: "#%n-marvin-round-41pt-1.png",
                    default41pt_2: "#%n-marvin-round-41pt-2.png",
                    default41pt_3: "#%n-marvin-round-41pt-3.png",
                    default41pt_4: "#%n-marvin-round-41pt-4.png",
                    default41pt_5: "#%n-marvin-round-41pt-5.png",
                    default41pt_6: "#%n-marvin-round-41pt-6.png",
                    default41pt_7: "#%n-marvin-round-41pt-7.png",
                    default41pt_8: "#%n-marvin-round-41pt-8.png",
                    default41pt_9: "#%n-marvin-round-41pt-9.png",
                    default41pt_colon: "#%n-marvin-round-41pt-colon.png",
                    default41pt_slash: "#%n-marvin-round-41pt-slash.png",
                    default41pt_plus: "#%n-marvin-round-41pt-plus.png",
                    default41pt_minus: "#%n-marvin-round-41pt-minus.png",
                    default41pt_x: "#%n-marvin-round-41pt-x.png",
                    default41pt_space: "#%n-marvin-round-41pt-space.png",
                    default41pt_asterisk: "#%n-marvin-round-41pt-asterisk.png",
                    default41pt_percent: "#%n-marvin-round-41pt-percent.png",
                    default56pt_0: "#%n-marvin-round-56pt-0.png",
                    default56pt_1: "#%n-marvin-round-56pt-1.png",
                    default56pt_2: "#%n-marvin-round-56pt-2.png",
                    default56pt_3: "#%n-marvin-round-56pt-3.png",
                    default56pt_4: "#%n-marvin-round-56pt-4.png",
                    default56pt_5: "#%n-marvin-round-56pt-5.png",
                    default56pt_6: "#%n-marvin-round-56pt-6.png",
                    default56pt_7: "#%n-marvin-round-56pt-7.png",
                    default56pt_8: "#%n-marvin-round-56pt-8.png",
                    default56pt_9: "#%n-marvin-round-56pt-9.png",
                    default56pt_colon: "#%n-marvin-round-56pt-colon.png",
                    default56pt_slash: "#%n-marvin-round-56pt-slash.png",
                    default56pt_plus: "#%n-marvin-round-56pt-plus.png",
                    default56pt_minus: "#%n-marvin-round-56pt-minus.png",
                    default56pt_x: "#%n-marvin-round-56pt-x.png",
                    default56pt_space: "#%n-marvin-round-56pt-space.png",
                    default56pt_asterisk: "#%n-marvin-round-56pt-asterisk.png",
                    default56pt_percent: "#%n-marvin-round-56pt-percent.png",
                    attention_png: "#%n-attention-attention.png",
                    button_png: "#%n-buttons-button.png",
                    button_on_png: "#%n-buttons-button_on.png",
                    button_disabled_png: "#%n-buttons-button_off.png",
                    small_button: "#%n-buttons-small_green_button.png",
                    small_button_on: "#%n-buttons-small_green_button_on.png",
                    small_button_off: "#%n-buttons-small_button_off.png",
                    blue_button_png: "#%n-buttons-button_blue.png",
                    blue_button_on_png: "#%n-buttons-button_blue_on.png",
                    small_blue_button: "#%n-buttons-small_blue_button.png",
                    small_blue_button_on: "#%n-buttons-small_blue_button_on.png",
                    red_button: "#%n-buttons-red_button.png",
                    red_button_on: "#%n-buttons-red_button_on.png",
                    help_button_png: "#%n-buttons-help_small.png",
                    help_button_on_png: "#%n-buttons-help_small_on.png",
                    help_button_off_png: "#%n-buttons-help_small_off.png",
                    sign_in_button_png: "#%n-buttons-sign_in_button.png",
                    sign_in_button_on_png: "#%n-buttons-sign_in_button_on.png",
                    vacuum_png: "#%n-buttons-vacuum.png",
                    gold_icon_png: "#%n-button_icons-ruby_icon.png",
                    coin_icon_png: "#%n-button_icons-coin_icon.png",
                    ad_icon_png: "#%n-button_icons-ad_icon.png",
                    ok_icon_png: "#%n-button_icons-ok_icon.png",
                    yandex_icon_png: "#%n-button_icons-yandex_icon.png",
                    playhop_icon_png: "#%n-button_icons-playhop_icon.png",
                    kred_icon_png: "#%n-button_icons-kred_icon.png",
                    big_timer_png: "#%n-dailytasks-timer_icon.png",
                    big_timer_bg_png: "#%n-dailytasks-timer_bg.png"
                },
                important: ["chain_sale_window_effect", "chain_sale_open_effect"]
            },
            chat: {
                urls: {
                    window_bg: "@window_bg-82fa04f9bd.jpg",
                    strict_font_ttf: {
                        type: "font",
                        name: "Rubic",
                        srcs: ["~fonts/font-355dc01047.ttf", "~fonts/font-355dc01047.eot"]
                    },
                    png: "@%n-4ecda40172.png",
                    json: "@%n-5e44a0fad1.json"
                },
                jsons: {
                    atlas: "@%n-4ecda40172.atlas",
                    plist: "@%n-4ecda40172.plist"
                },
                frames: {
                    dialog_box_green: "#%n-dialog_box.png",
                    dialog_box_white: "#%n-dialog_box_2.png",
                    icon_back: "#%n-icon_back.png",
                    panel_off: "#%n-panel_off.png",
                    panel_on: "#%n-panel_on.png",
                    panelup: "#%n-panelup.png",
                    paneldown: "#%n-paneldown.png",
                    textbox: "#%n-textbox.png",
                    checkmark_tmp: "#%n-checkmark_0.png",
                    checkmark_sent: "#%n-checkmark_1.png",
                    checkmark_read: "#%n-checkmark_2.png",
                    checkmark_gift: "#%n-checkmark_yes.png",
                    gift_bg: "#%n-gift_bg.png",
                    accept_button: "#%n-button_accept.png",
                    accept_button_on: "#%n-button_accept_press.png",
                    dialogue_separator: "#%n-dialogue_separator.png",
                    category_bg: "#%n-category_bg.png",
                    category_bg_on: "#%n-category_bg_press.png",
                    active_category_bg: "#%n-category_bg_select.png",
                    active_category_close: "#%n-close_small.png",
                    scrollbar_png: "#%n-scrollbar-scrollbar.png"
                }
            },
            checkbox: {
                virtual: !0,
                injectTo: ["game", "main"],
                frameIds: ["background_png", "check_mark_png"]
            },
            confirmexit_window: {
                urls: {}
            },
            controlbuttons: {
                virtual: !0,
                injectTo: ["game", "daily_cup", "main"],
                frameIds: ["menu_icon_png", "control_button_png", "control_button_on_png", "fullscreen_icon_png", "back_button_png", "back_button_on_png", "back_icon_png", "xmas_control_buttons"]
            },
            crosspromo_adventure_en: {
                urls: {
                    image: "@adventure-942f5bed1c.jpg"
                }
            },
            crosspromo_adventure_ru: {
                urls: {
                    image: "@adventure_ru-0b5b5f5af5.jpg"
                }
            },
            crosspromo_crocword_de: {
                urls: {
                    image: "@crocword_de-cb6c0a1a25.jpg"
                }
            },
            crosspromo_crocword_en: {
                urls: {
                    image: "@crocword-891b5fbb7b.jpg"
                }
            },
            crosspromo_crocword_es: {
                urls: {
                    image: "@crocword_es-57102be8f9.jpg"
                }
            },
            crosspromo_crocword_fr: {
                urls: {
                    image: "@crocword_fr-3929f7acb2.jpg"
                }
            },
            crosspromo_crocword_it: {
                urls: {
                    image: "@crocword_it-c32330f6d6.jpg"
                }
            },
            crosspromo_crocword_ru: {
                urls: {
                    image: "@crocword_ru-c6a26fc010.jpg"
                }
            },
            crosspromo_differences_en: {
                urls: {
                    image: "@differences-7fb4281f92.jpg"
                }
            },
            crosspromo_differences_ru: {
                urls: {
                    image: "@differences_ru-cba6b3106f.jpg"
                }
            },
            crosspromo_fairy_en: {
                urls: {
                    image: "@fairy-d7ecff221f.jpg"
                }
            },
            crosspromo_heroes_en: {
                urls: {
                    image: "@heroes-98b394f62a.jpg"
                }
            },
            crosspromo_heroes_ru: {
                urls: {
                    image: "@heroes_ru-112ff24c45.jpg"
                }
            },
            crosspromo_hustlemerge_en: {
                urls: {
                    image: "@hustlemerge-0ce90255f0.jpg"
                }
            },
            crosspromo_magicwords_de: {
                urls: {
                    image: "@magicwords_de-330d161377.jpg"
                }
            },
            crosspromo_magicwords_en: {
                urls: {
                    image: "@magicwords-5196ff56b6.jpg"
                }
            },
            crosspromo_magicwords_es: {
                urls: {
                    image: "@magicwords_es-db23af1222.jpg"
                }
            },
            crosspromo_magicwords_fr: {
                urls: {
                    image: "@magicwords_fr-9f6aa802bd.jpg"
                }
            },
            crosspromo_magicwords_it: {
                urls: {
                    image: "@magicwords_it-39f89dfb3c.jpg"
                }
            },
            crosspromo_magicwords_ru: {
                urls: {
                    image: "@magicwords_ru-335b789f88.jpg"
                }
            },
            crosspromo_mergecraft_en: {
                urls: {
                    image: "@mergecraft-1b1f76bbf9.jpg"
                }
            },
            crosspromo_mergecraft_ru: {
                urls: {
                    image: "@mergecraft_ru-ad18aa4695.jpg"
                }
            },
            crosspromo_olympics_de: {
                urls: {
                    image: "@olympics_de-50272d61b6.jpg"
                }
            },
            crosspromo_olympics_en: {
                urls: {
                    image: "@olympics-a6d1525987.jpg"
                }
            },
            crosspromo_olympics_es: {
                urls: {
                    image: "@olympics_es-dfd72ea224.jpg"
                }
            },
            crosspromo_olympics_fr: {
                urls: {
                    image: "@olympics_fr-668019de5b.jpg"
                }
            },
            crosspromo_olympics_it: {
                urls: {
                    image: "@olympics_it-27fc816d50.jpg"
                }
            },
            crosspromo_olympics_ru: {
                urls: {
                    image: "@olympics_ru-cb2e567aa2.jpg"
                }
            },
            crosspromo_riddles_en: {
                urls: {
                    image: "@riddles-f3cfae0719.jpg"
                }
            },
            crosspromo_riddles_ru: {
                urls: {
                    image: "@riddles_ru-2a7336fc48.jpg"
                }
            },
            crosspromo_runes_en: {
                urls: {
                    image: "@runes-281c56f068.jpg"
                }
            },
            crosspromo_runes_ru: {
                urls: {
                    image: "@runes_ru-2b1e993512.jpg"
                }
            },
            crosspromo_scramble_en: {
                urls: {
                    image: "@scramble-5eb4ea26ed.jpg"
                }
            },
            crosspromo_scramble_fr: {
                urls: {
                    image: "@scramble_fr-5764fcd1b3.jpg"
                }
            },
            crosspromo_scramble_ru: {
                urls: {
                    image: "@scramble_ru-3516002370.jpg"
                }
            },
            crosspromo_spades_en: {
                urls: {
                    image: "@spades-b37e2c680f.jpg"
                }
            },
            crosspromo_tripeaks_de: {
                urls: {
                    image: "@tripeaks_de-ec772ff6d1.jpg"
                }
            },
            crosspromo_tripeaks_en: {
                urls: {
                    image: "@tripeaks-f518273582.jpg"
                }
            },
            crosspromo_tripeaks_es: {
                urls: {
                    image: "@tripeaks_es-01f7449192.jpg"
                }
            },
            crosspromo_tripeaks_fr: {
                urls: {
                    image: "@tripeaks_fr-7e58e4a967.jpg"
                }
            },
            crosspromo_tripeaks_it: {
                urls: {
                    image: "@tripeaks_it-f438de5c0e.jpg"
                }
            },
            crosspromo_tripeaks_ru: {
                urls: {
                    image: "@tripeaks_ru-764836be61.jpg"
                }
            },
            crosspromo_window: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["badge"]
            },
            crosspromo_wondermerge_en: {
                urls: {
                    image: "@wondermerge-b97c52bdeb.jpg"
                }
            },
            crosspromo_woodenblock_en: {
                urls: {
                    image: "@woodenblock-1c2d4eb0a5.jpg"
                }
            },
            crosspromo_woodenblock_ru: {
                urls: {
                    image: "@woodenblock_ru-c685756c9d.jpg"
                }
            },
            crosspromo_wordsoup_de: {
                urls: {
                    image: "@wordsoup_de-b0729a6cae.jpg"
                }
            },
            crosspromo_wordsoup_en: {
                urls: {
                    image: "@wordsoup-5bc7266d66.jpg"
                }
            },
            crosspromo_wordsoup_es: {
                urls: {
                    image: "@wordsoup_es-3b08115596.jpg"
                }
            },
            crosspromo_wordsoup_fr: {
                urls: {
                    image: "@wordsoup_fr-49b0de92fe.jpg"
                }
            },
            crosspromo_wordsoup_it: {
                urls: {
                    image: "@wordsoup_it-6ac183c30f.jpg"
                }
            },
            crosspromo_wordsoup_ru: {
                urls: {
                    image: "@wordsoup_ru-ccdb2a9775.jpg"
                }
            },
            crosspromo_zenmatch_en: {
                urls: {
                    image: "@zenmatch-187b6accc8.jpg"
                }
            },
            crosspromo_zenmatch_ru: {
                urls: {
                    image: "@zenmatch_ru-7701458a6d.jpg"
                }
            },
            cryptex: {
                urls: {}
            },
            custom_digits: {
                urls: {
                    png: "@%n-be1f04fd94.png",
                    json: "@%n-338e99bdf5.json"
                },
                jsons: {
                    atlas: "@%n-be1f04fd94.atlas",
                    plist: "@%n-be1f04fd94.plist"
                },
                frames: {
                    custom_digits38pt_0: "#%n-%n-38pt-0.png",
                    custom_digits38pt_1: "#%n-%n-38pt-1.png",
                    custom_digits38pt_2: "#%n-%n-38pt-2.png",
                    custom_digits38pt_3: "#%n-%n-38pt-3.png",
                    custom_digits38pt_4: "#%n-%n-38pt-4.png",
                    custom_digits38pt_5: "#%n-%n-38pt-5.png",
                    custom_digits38pt_6: "#%n-%n-38pt-6.png",
                    custom_digits38pt_7: "#%n-%n-38pt-7.png",
                    custom_digits38pt_8: "#%n-%n-38pt-8.png",
                    custom_digits38pt_9: "#%n-%n-38pt-9.png",
                    custom_digits38pt_colon: "#%n-%n-38pt-colon.png",
                    custom_digits38pt_slash: "#%n-%n-38pt-slash.png",
                    custom_digits38pt_plus: "#%n-%n-38pt-plus.png",
                    custom_digits38pt_minus: "#%n-%n-38pt-minus.png",
                    custom_digits38pt_x: "#%n-%n-38pt-x.png",
                    custom_digits38pt_space: "#%n-%n-38pt-space.png",
                    custom_digits38pt_asterisk: "#%n-%n-38pt-asterisk.png",
                    custom_digits38pt_percent: "#%n-%n-38pt-percent.png"
                }
            },
            daily_cup: {
                urls: {
                    daily_cup_bg: "@%n_bg-bfb7da4bd5.jpg",
                    lives_fly_finish_effect: "~sounds/reward_heart-158e7e348d.mp3",
                    coins_effect: "~sounds/coins-f1a88f9724.mp3",
                    png: "@%n-f0ecddeb4a.png",
                    json: "@%n-9cd02bb835.json"
                },
                jsons: {
                    atlas: "@%n-f0ecddeb4a.atlas",
                    plist: "@%n-f0ecddeb4a.plist",
                    shuffle_json: "@replace-047fbf09bc.json",
                    sparks_json: "@sparks-02495497ad.json",
                    undo_json: "@undo-d2995bab03.json"
                },
                frames: {
                    daily_cup_leaders_icon_png: "#%n-bonus_cup.png",
                    daily_cup_title_bg_png: "#%n-%n_title_bg.png",
                    scrollbar_png: "#%n-scrollbar-scrollbar.png",
                    gold_small_png: "#%n-reward_icons-ruby_small.png",
                    coin_small_png: "#%n-reward_icons-coin_small.png",
                    reward_gold_png: "#%n-reward_icons-ruby.png",
                    reward_coin_png: "#%n-reward_icons-coin.png",
                    shop_gold_png: "#%n-reward_icons-ruby_shop.png",
                    shop_coin_png: "#%n-reward_icons-coin_shop.png",
                    bonussale_gift: "#%n-reward_icons-bonussale_gift.png",
                    life_png: "#%n-menubar-life.png",
                    life_small_png: "#%n-reward_icons-life_small.png",
                    life_unlim: "#%n-reward_icons-life_unlim.png",
                    life_unlim_small: "#%n-reward_icons-life_unlim_small.png",
                    simple_star_png: "#%n-reward_icons-simple_star.png",
                    booster_tile_shuffle_png: "#%n-reward_icons-booster_tile_shuffle.png",
                    booster_vacuum_png: "#%n-reward_icons-booster_vacuum.png",
                    booster_undo_png: "#%n-reward_icons-booster_undo.png",
                    underline_png: "#%n-underline-underline.png",
                    nostroke56pt_0: "#%n-marvin-round-nostroke-56pt-0.png",
                    nostroke56pt_1: "#%n-marvin-round-nostroke-56pt-1.png",
                    nostroke56pt_2: "#%n-marvin-round-nostroke-56pt-2.png",
                    nostroke56pt_3: "#%n-marvin-round-nostroke-56pt-3.png",
                    nostroke56pt_4: "#%n-marvin-round-nostroke-56pt-4.png",
                    nostroke56pt_5: "#%n-marvin-round-nostroke-56pt-5.png",
                    nostroke56pt_6: "#%n-marvin-round-nostroke-56pt-6.png",
                    nostroke56pt_7: "#%n-marvin-round-nostroke-56pt-7.png",
                    nostroke56pt_8: "#%n-marvin-round-nostroke-56pt-8.png",
                    nostroke56pt_9: "#%n-marvin-round-nostroke-56pt-9.png",
                    nostroke56pt_colon: "#%n-marvin-round-nostroke-56pt-colon.png",
                    nostroke56pt_slash: "#%n-marvin-round-nostroke-56pt-slash.png",
                    nostroke56pt_plus: "#%n-marvin-round-nostroke-56pt-plus.png",
                    nostroke56pt_minus: "#%n-marvin-round-nostroke-56pt-minus.png",
                    nostroke56pt_x: "#%n-marvin-round-nostroke-56pt-x.png",
                    nostroke56pt_space: "#%n-marvin-round-nostroke-56pt-space.png",
                    nostroke56pt_asterisk: "#%n-marvin-round-nostroke-56pt-asterisk.png",
                    nostroke56pt_percent: "#%n-marvin-round-nostroke-56pt-percent.png",
                    default41pt_0: "#%n-marvin-round-41pt-0.png",
                    default41pt_1: "#%n-marvin-round-41pt-1.png",
                    default41pt_2: "#%n-marvin-round-41pt-2.png",
                    default41pt_3: "#%n-marvin-round-41pt-3.png",
                    default41pt_4: "#%n-marvin-round-41pt-4.png",
                    default41pt_5: "#%n-marvin-round-41pt-5.png",
                    default41pt_6: "#%n-marvin-round-41pt-6.png",
                    default41pt_7: "#%n-marvin-round-41pt-7.png",
                    default41pt_8: "#%n-marvin-round-41pt-8.png",
                    default41pt_9: "#%n-marvin-round-41pt-9.png",
                    default41pt_colon: "#%n-marvin-round-41pt-colon.png",
                    default41pt_slash: "#%n-marvin-round-41pt-slash.png",
                    default41pt_plus: "#%n-marvin-round-41pt-plus.png",
                    default41pt_minus: "#%n-marvin-round-41pt-minus.png",
                    default41pt_x: "#%n-marvin-round-41pt-x.png",
                    default41pt_space: "#%n-marvin-round-41pt-space.png",
                    default41pt_asterisk: "#%n-marvin-round-41pt-asterisk.png",
                    default41pt_percent: "#%n-marvin-round-41pt-percent.png",
                    default56pt_0: "#%n-marvin-round-56pt-0.png",
                    default56pt_1: "#%n-marvin-round-56pt-1.png",
                    default56pt_2: "#%n-marvin-round-56pt-2.png",
                    default56pt_3: "#%n-marvin-round-56pt-3.png",
                    default56pt_4: "#%n-marvin-round-56pt-4.png",
                    default56pt_5: "#%n-marvin-round-56pt-5.png",
                    default56pt_6: "#%n-marvin-round-56pt-6.png",
                    default56pt_7: "#%n-marvin-round-56pt-7.png",
                    default56pt_8: "#%n-marvin-round-56pt-8.png",
                    default56pt_9: "#%n-marvin-round-56pt-9.png",
                    default56pt_colon: "#%n-marvin-round-56pt-colon.png",
                    default56pt_slash: "#%n-marvin-round-56pt-slash.png",
                    default56pt_plus: "#%n-marvin-round-56pt-plus.png",
                    default56pt_minus: "#%n-marvin-round-56pt-minus.png",
                    default56pt_x: "#%n-marvin-round-56pt-x.png",
                    default56pt_space: "#%n-marvin-round-56pt-space.png",
                    default56pt_asterisk: "#%n-marvin-round-56pt-asterisk.png",
                    default56pt_percent: "#%n-marvin-round-56pt-percent.png",
                    menu_icon_png: "#%n-controlbuttons-menu.png",
                    control_button_png: "#%n-controlbuttons-menu_button.png",
                    control_button_on_png: "#%n-controlbuttons-menu_button_on.png",
                    fullscreen_icon_png: "#%n-controlbuttons-fullscreen_icon.png",
                    back_button_png: "#%n-controlbuttons-back_button.png",
                    back_button_on_png: "#%n-controlbuttons-back_button_on.png",
                    back_icon_png: "#%n-controlbuttons-back.png",
                    xmas_control_buttons: "#%n-xmas-xmas_controlbuttons.png",
                    coin_png: "#%n-menubar-coin.png",
                    gold_png: "#%n-menubar-ruby.png",
                    menubar_bg_png: "#%n-menubar-bar_bg.png",
                    bar_timer_png: "#%n-menubar-bar_timer.png",
                    plus_button_png: "#%n-menubar-plus.png",
                    plus_button_on_png: "#%n-menubar-plus_on.png",
                    unlim_png: "#%n-menubar-unlim.png",
                    xmas_menubar: "#%n-xmas-xmas_menubar.png",
                    xmas_menubar_level: "#%n-xmas-xmas_menubar_level.png",
                    attention_png: "#%n-attention-attention.png",
                    button_png: "#%n-buttons-button.png",
                    button_on_png: "#%n-buttons-button_on.png",
                    button_disabled_png: "#%n-buttons-button_off.png",
                    small_button: "#%n-buttons-small_green_button.png",
                    small_button_on: "#%n-buttons-small_green_button_on.png",
                    small_button_off: "#%n-buttons-small_button_off.png",
                    blue_button_png: "#%n-buttons-button_blue.png",
                    blue_button_on_png: "#%n-buttons-button_blue_on.png",
                    small_blue_button: "#%n-buttons-small_blue_button.png",
                    small_blue_button_on: "#%n-buttons-small_blue_button_on.png",
                    red_button: "#%n-buttons-red_button.png",
                    red_button_on: "#%n-buttons-red_button_on.png",
                    help_button_png: "#%n-buttons-help_small.png",
                    help_button_on_png: "#%n-buttons-help_small_on.png",
                    help_button_off_png: "#%n-buttons-help_small_off.png",
                    sign_in_button_png: "#%n-buttons-sign_in_button.png",
                    sign_in_button_on_png: "#%n-buttons-sign_in_button_on.png",
                    vacuum_png: "#%n-buttons-vacuum.png",
                    gold_icon_png: "#%n-button_icons-ruby_icon.png",
                    coin_icon_png: "#%n-button_icons-coin_icon.png",
                    ad_icon_png: "#%n-button_icons-ad_icon.png",
                    ok_icon_png: "#%n-button_icons-ok_icon.png",
                    yandex_icon_png: "#%n-button_icons-yandex_icon.png",
                    playhop_icon_png: "#%n-button_icons-playhop_icon.png",
                    kred_icon_png: "#%n-button_icons-kred_icon.png",
                    table_bg_png: "#%n-table-table_bg.png",
                    amount_bg_png: "#%n-table-amount_bg.png",
                    amount_bg_you_png: "#%n-table-amount_bg_you.png",
                    row_player_png: "#%n-table-row_player.png",
                    row_you_png: "#%n-table-row_you.png",
                    badge_1: "#%n-table-badge_1.png",
                    badge_2: "#%n-table-badge_2.png",
                    badge_3: "#%n-table-badge_3.png",
                    prize_1: "#%n-table-prize_1.png",
                    prize_2: "#%n-table-prize_2.png",
                    prize_3: "#%n-table-prize_3.png",
                    prize_4: "#%n-table-prize_4.png",
                    prize_5: "#%n-table-prize_5.png",
                    timer_png: "#%n-timer-timer.png",
                    timer_bg_png: "#%n-timer-timer_bg.png",
                    letter_mission: "#%n-tablerowicons-row_mission_letter.png",
                    avatar_frame: "#%n-avatars-avatar_frame.png",
                    avatar_frame2: "#%n-avatars-avatar_frame2.png",
                    android_avatar: "#%n-avatars-android_avatar.png",
                    ios_avatar: "#%n-avatars-ios_avatar.png",
                    user_avatar: "#%n-avatars-user_avatar.png",
                    default_avatar: "#%n-avatars-default_avatar.png"
                }
            },
            dailycupruleswindow: {
                urls: {
                    png: "@%n-cc39ba2911.png",
                    json: "@%n-1a9c611571.json"
                },
                jsons: {
                    arrows: "@guide_arrows-4ff7d68ca2.json",
                    atlas: "@%n-cc39ba2911.atlas",
                    guide_stages: "@daily_cup-5a6fb87079.json"
                }
            },
            dev_buttons: {
                virtual: !0,
                injectTo: ["game", "main"],
                frameIds: ["plus", "orangery_bg_light", "orangery_bg_dark", "snapshot_rec", "snapshot_stop", "snapshots_create_clip", "snapshot", "label_rec", "label_playback", "icon_edit", "icon_error", "icon_report", "icon_stages"]
            },
            dialogues: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["dialogue_arrow_png", "bg_png", "dialogue_name"]
            },
            dialogues_minimal: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["bg_minimal_png",
                    "mini_arrow_bg_png"
                ],
                jsonIds: ["bg_person"]
            },
            digits: {
                virtual: !0,
                injectTo: ["admin", "game", "starter_pack", "daily_cup", "tile_shop", "periodic_sale", "chain_sale", "main"],
                frameIds: ["underline_png", "nostroke56pt_0", "nostroke56pt_1", "nostroke56pt_2", "nostroke56pt_3", "nostroke56pt_4", "nostroke56pt_5", "nostroke56pt_6", "nostroke56pt_7", "nostroke56pt_8", "nostroke56pt_9", "nostroke56pt_colon", "nostroke56pt_slash", "nostroke56pt_plus", "nostroke56pt_minus", "nostroke56pt_x", "nostroke56pt_space", "nostroke56pt_asterisk", "nostroke56pt_percent", "default41pt_0", "default41pt_1", "default41pt_2", "default41pt_3", "default41pt_4", "default41pt_5", "default41pt_6", "default41pt_7", "default41pt_8", "default41pt_9", "default41pt_colon", "default41pt_slash", "default41pt_plus", "default41pt_minus", "default41pt_x", "default41pt_space", "default41pt_asterisk", "default41pt_percent", "default56pt_0", "default56pt_1", "default56pt_2", "default56pt_3", "default56pt_4", "default56pt_5", "default56pt_6", "default56pt_7", "default56pt_8",
                    "default56pt_9", "default56pt_colon", "default56pt_slash", "default56pt_plus", "default56pt_minus", "default56pt_x", "default56pt_space", "default56pt_asterisk", "default56pt_percent"
                ]
            },
            episode_0: {
                urls: {
                    json: "~%n/%n-24e365dd1b.json"
                },
                jsons: {
                    levels: "~%n/0-bdcb0fc631.json"
                },
                episode: {
                    episodeNo: 0,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}]
                }
            },
            episode_1: {
                urls: {
                    json: "~%n/%n-40c2b85d2e.json"
                },
                jsons: {
                    levels: "~%n/1-9a047cd4ac.json"
                },
                episode: {
                    episodeNo: 1,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}]
                }
            },
            episode_10: {
                urls: {
                    json: "~%n/%n-7848590cec.json"
                },
                jsons: {
                    levels: "~%n/10-cc0e491aa5.json"
                },
                episode: {
                    episodeNo: 10,
                    levelsAmount: 15,
                    levels: [{}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }]
                }
            },
            episode_11: {
                urls: {
                    json: "~%n/%n-fa3943eae0.json"
                },
                jsons: {
                    levels: "~%n/11-de2b521b8b.json"
                },
                episode: {
                    episodeNo: 11,
                    levelsAmount: 15,
                    levels: [{}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}]
                }
            },
            episode_12: {
                urls: {
                    json: "~%n/%n-067e2099a2.json"
                },
                jsons: {
                    levels: "~%n/12-5bd3d5f8cf.json"
                },
                episode: {
                    episodeNo: 12,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {
                        tag: "hard"
                    }]
                }
            },
            episode_13: {
                urls: {
                    json: "~%n/%n-5aa544cc35.json"
                },
                jsons: {
                    levels: "~%n/13-3217a5b06e.json"
                },
                episode: {
                    episodeNo: 13,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }]
                }
            },
            episode_14: {
                urls: {
                    json: "~%n/%n-749f69355d.json"
                },
                jsons: {
                    levels: "~%n/14-2546845923.json"
                },
                episode: {
                    episodeNo: 14,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {
                        tag: "hard"
                    }, {}]
                }
            },
            episode_15: {
                urls: {
                    json: "~%n/%n-17e2fb4606.json"
                },
                jsons: {
                    levels: "~%n/15-6c7549a244.json"
                },
                episode: {
                    episodeNo: 15,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}, {}, {}]
                }
            },
            episode_16: {
                urls: {
                    json: "~%n/%n-642fa47517.json"
                },
                jsons: {
                    levels: "~%n/16-749125d10d.json"
                },
                episode: {
                    episodeNo: 16,
                    levelsAmount: 15,
                    levels: [{}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}]
                }
            },
            episode_17: {
                urls: {
                    json: "~%n/%n-b8acbd3431.json"
                },
                jsons: {
                    levels: "~%n/17-72a822b454.json"
                },
                episode: {
                    episodeNo: 17,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}]
                }
            },
            episode_2: {
                urls: {
                    json: "~%n/%n-87f3405fae.json"
                },
                jsons: {
                    levels: "~%n/2-5df6f9a102.json"
                },
                episode: {
                    episodeNo: 2,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}]
                }
            },
            episode_3: {
                urls: {
                    json: "~%n/%n-f13912e543.json"
                },
                jsons: {
                    levels: "~%n/3-e4f69b9370.json"
                },
                episode: {
                    episodeNo: 3,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {
                        tag: "hard"
                    }]
                }
            },
            episode_4: {
                urls: {
                    json: "~%n/%n-0aa4889946.json"
                },
                jsons: {
                    levels: "~%n/4-25f2fdb339.json"
                },
                episode: {
                    episodeNo: 4,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}]
                }
            },
            episode_5: {
                urls: {
                    json: "~%n/%n-9e19ff0b0b.json"
                },
                jsons: {
                    levels: "~%n/5-9791ba80c2.json"
                },
                episode: {
                    episodeNo: 5,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}, {}, {}]
                }
            },
            episode_6: {
                urls: {
                    json: "~%n/%n-6d2c01dee1.json"
                },
                jsons: {
                    levels: "~%n/6-e8f15e8a28.json"
                },
                episode: {
                    episodeNo: 6,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}]
                }
            },
            episode_7: {
                urls: {
                    json: "~%n/%n-ce391a75df.json"
                },
                jsons: {
                    levels: "~%n/7-8f5abdffba.json"
                },
                episode: {
                    episodeNo: 7,
                    levelsAmount: 15,
                    levels: [{}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}]
                }
            },
            episode_8: {
                urls: {
                    json: "~%n/%n-6e70c61d47.json"
                },
                jsons: {
                    levels: "~%n/8-d3dd413558.json"
                },
                episode: {
                    episodeNo: 8,
                    levelsAmount: 15,
                    levels: [{}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}, {}, {}]
                }
            },
            episode_9: {
                urls: {
                    json: "~%n/%n-071426e29c.json"
                },
                jsons: {
                    levels: "~%n/9-9c68229afe.json"
                },
                episode: {
                    episodeNo: 9,
                    levelsAmount: 15,
                    levels: [{}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {
                        tag: "hard"
                    }, {}, {}, {}, {}, {}]
                }
            },
            episode_test: {
                urls: {
                    json: "~%n/%n-ff6ed5a22b.json"
                },
                jsons: {
                    levels: "~%n/test-d212ba3916.json"
                },
                episode: {
                    episodeNo: "test",
                    levelsAmount: 23,
                    levels: [{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {},
                    {}, {}
                    ]
                }
            },
            exclamations: {
                virtual: !0,
                injectTo: ["game"],
                jsonIds: ["%n_json"]
            },
            extend_unlimited_lives_window: {
                urls: {
                    lives_effect: "~sounds/temp_good_finish-e92b7b809a.mp3",
                    png: "@%n-f8eacccb41.png",
                    json: "@%n-278763b6c8.json"
                },
                jsons: {
                    atlas: "@%n-f8eacccb41.atlas",
                    lives_json: "@temp_good_finish-a771b52f8e.json"
                },
                important: ["lives_effect"]
            },
            extra_prizes: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["icon_bg", "icon_text_bg"],
                jsonIds: ["star_json"]
            },
            extrawindow: {
                urls: {}
            },
            finger: {
                virtual: !0,
                injectTo: ["game", "main"],
                frameIds: ["tutorial_click_png", "tutorial_hand_png"],
                jsonIds: ["arrow_json"],
                soundIds: ["press_effect"]
            },
            fireworks: {
                urls: {
                    confetti_effect: "~sounds/confetti-5abb2317b8.mp3",
                    png: "@%n-ed50417392.png",
                    json: "@%n-e61981d57f.json"
                },
                jsons: {
                    atlas: "@%n-ed50417392.atlas",
                    confetti_json: "@confetti-51041cc3ef.json"
                },
                important: ["confetti_effect"]
            },
            flying_ad: {
                virtual: !0,
                injectTo: ["game", "main"],
                jsonIds: ["%n_json"],
                soundIds: ["fly_effect", "show_up_effect"]
            },
            flying_hint: {
                urls: {}
            },
            game: {
                urls: {
                    openlevel_effect: "~sounds/openlevel-bcd2bfaf29.mp3",
                    return_booster_effect: "~sounds/return_booster-27c1dc4d46.mp3",
                    undo_booster_effect: "~sounds/undo_booster-91d7fdd987.mp3",
                    shuffle_booster_effect: "~sounds/shuffle_booster-e06c1b5bf9.mp3",
                    play_tile_effect: "~sounds/tile_play-95c649e550.mp3",
                    collection_effect: "~sounds/collection-a9f53326cc.mp3",
                    card_1_effect: "~sounds/drop_1-f0db36fa34.mp3",
                    tile_flip_effect: "~sounds/tile_flip-96d9616be9.mp3",
                    blackout_effect: "~sounds/blackout-62c201a160.mp3",
                    tiles_unlock_effect: "~sounds/tiles_unlocked-d7e89be8c8.mp3",
                    next_screen_effect: "~sounds/next_screen-f4c282d7c5.mp3",
                    bomb_indication_effect: "~sounds/bomb_wick-766983b9f8.mp3",
                    explosion_effect: "~sounds/bomb_explosion-30cea7450d.mp3",
                    ice_break_effect: "~sounds/ice_1-c10a6024af.mp3",
                    ice_revert_effect: "~sounds/ice_2-95cda97d2d.mp3",
                    curtain_close_effect: "~sounds/tori_1-f549f5cfe1.mp3",
                    curtain_open_effect: "~sounds/tori_2-47f7cdf086.mp3",
                    press_effect: "~sounds/hand_hint-de043d48db.mp3",
                    task_done_sfx: "~sounds/done_jingle-c8ff12607c.mp3",
                    lives_fly_finish_effect: "~sounds/reward_heart-158e7e348d.mp3",
                    coins_effect: "~sounds/coins-f1a88f9724.mp3",
                    game_message_effect: "~sounds/%n_message-d6bfd65732.mp3",
                    game_message_hard_effect: "~sounds/openlevel_hard-18306ca8e7.mp3",
                    win_effect: "~sounds/win-85c53c307d.mp3",
                    lose_effect: "~sounds/lose-7758e9683e.mp3",
                    reward_gold_effect: "~sounds/reward_gold-4ee31e6446.mp3",
                    fly_effect: "~sounds/hint_fly-727b5c2529.mp3",
                    show_up_effect: "~sounds/hint_app-b8cbd76c17.mp3",
                    continue_effect: "~sounds/exit_%n-e7b1f0b061.mp3",
                    timer_tick: "~sounds/timer_tick-583e39617d.mp3",
                    timer_tick_zero: "~sounds/timer_tick_zero-f1e18143e9.mp3",
                    timer_start: "~sounds/timer_start-5640ec4b29.mp3",
                    bomb_timer_tick: "~sounds/bomb_timer_tick-cf4f0efdb3.mp3",
                    bomb_timer_tick_zero: "~sounds/bomb_timer_tick_zero-6d21c70159.mp3",
                    bomb_timer_explosion: "~sounds/bomb_timer_explosion-2f388041cf.mp3",
                    plate_breaks_off_effect: "~sounds/gold_stage-7f2a16acbd.mp3",
                    plate_collect_effect: "~sounds/gold_collection-b233335015.mp3",
                    plate_click_effect: "~sounds/gold_coins_collection-d73fd113b9.mp3",
                    vacuum_effect: "~sounds/buster_hoover-fb070f5fd2.mp3",
                    png: "@%n-0b1f3fe3f7.png",
                    json: "@%n-6bbf6995a1.json"
                },
                jsons: {
                    arrow_json: "@arrow-d19bc7192c.json",
                    atlas: "@%n-0b1f3fe3f7.atlas",
                    bomb_explosion_json: "@bomb_explosion-cb900f0850.json",
                    bomb_json: "@bomb-9beb740172.json",
                    bomb_timer_json: "@timer-c6bd9f98b0.json",
                    bonus_json: "@bonus-355dad8bf3.json",
                    coins_reward_json: "@coins_reward-9f92bd9090.json",
                    curtain_json: "@curtain-298e11802d.json",
                    effects_json: "@effects-c555e2fa3b.json",
                    exclamations_json: "@exclamations-8ba9dd5b05.json",
                    explode_json: "@explode-1ed12ada05.json",
                    flash_json: "@progress_bar_flash-db8d86b0ff.json",
                    flying_ad_json: "@flying_ad-a047a2e10d.json",
                    gold_chest_json: "@chest-c1e4b75f02.json",
                    ice_json: "@ice-170f0516f5.json",
                    label_moves_json: "@prolongation_window-2736444764.json",
                    level_failed_small_hearts_json: "@level_failed_small_heart-0b68f773d4.json",
                    lose_json: "@lose-5eaec97b8c.json",
                    multiscreen_json: "@multiscreen-50eb08bb1d.json",
                    open_warning_json: "@open_warning-4d217186ac.json",
                    pagination_2_json: "@pagination_double-9080ba7365.json",
                    pagination_3_json: "@pagination_triple-bafb557c41.json",
                    piggy_bank_reward_json: "@piggy_bank_reward-3695d310d5.json",
                    plate_json: "@plate-a30f219029.json",
                    plist: "@%n-0b1f3fe3f7.plist",
                    shuffle_json: "@replace-047fbf09bc.json",
                    sparks_json: "@sparks-02495497ad.json",
                    star_json: "@star-592ede93c3.json",
                    starparticles_json: "@starparticles-86a76cbed3.json",
                    timer_json: "@timer-ee271685db.json",
                    undo_button_json: "@undo_button-da10156366.json",
                    undo_json: "@undo-d2995bab03.json",
                    vacuum_json: "@vacuum-4ea2b74a9b.json",
                    vacuum_stick_json: "@vacuum_stick-9aeb226e3d.json"
                },
                frames: {
                    collected_gold_png: "#%n-marks-chest.png",
                    line_png: "#%n-path-line.png",
                    tooltip_bg_png: "#%n-tooltip-box.png",
                    tooltip_shadow_arrow_png: "#%n-tooltip-arrow.png",
                    tooltip_arrow_png: "#%n-tooltip-arrow2.png",
                    gold_small_png: "#%n-reward_icons-ruby_small.png",
                    coin_small_png: "#%n-reward_icons-coin_small.png",
                    reward_gold_png: "#%n-reward_icons-ruby.png",
                    reward_coin_png: "#%n-reward_icons-coin.png",
                    shop_gold_png: "#%n-reward_icons-ruby_shop.png",
                    shop_coin_png: "#%n-reward_icons-coin_shop.png",
                    bonussale_gift: "#%n-reward_icons-bonussale_gift.png",
                    life_png: "#%n-menubar-life.png",
                    life_small_png: "#%n-reward_icons-life_small.png",
                    life_unlim: "#%n-reward_icons-life_unlim.png",
                    life_unlim_small: "#%n-reward_icons-life_unlim_small.png",
                    simple_star_png: "#%n-reward_icons-simple_star.png",
                    booster_tile_shuffle_png: "#%n-reward_icons-booster_tile_shuffle.png",
                    booster_vacuum_png: "#%n-reward_icons-booster_vacuum.png",
                    booster_undo_png: "#%n-reward_icons-booster_undo.png",
                    tutorial_click_png: "#%n-tutorial-circle.png",
                    tutorial_hand_png: "#%n-tutorial-hand.png",
                    underline_png: "#%n-underline-underline.png",
                    nostroke56pt_0: "#%n-marvin-round-nostroke-56pt-0.png",
                    nostroke56pt_1: "#%n-marvin-round-nostroke-56pt-1.png",
                    nostroke56pt_2: "#%n-marvin-round-nostroke-56pt-2.png",
                    nostroke56pt_3: "#%n-marvin-round-nostroke-56pt-3.png",
                    nostroke56pt_4: "#%n-marvin-round-nostroke-56pt-4.png",
                    nostroke56pt_5: "#%n-marvin-round-nostroke-56pt-5.png",
                    nostroke56pt_6: "#%n-marvin-round-nostroke-56pt-6.png",
                    nostroke56pt_7: "#%n-marvin-round-nostroke-56pt-7.png",
                    nostroke56pt_8: "#%n-marvin-round-nostroke-56pt-8.png",
                    nostroke56pt_9: "#%n-marvin-round-nostroke-56pt-9.png",
                    nostroke56pt_colon: "#%n-marvin-round-nostroke-56pt-colon.png",
                    nostroke56pt_slash: "#%n-marvin-round-nostroke-56pt-slash.png",
                    nostroke56pt_plus: "#%n-marvin-round-nostroke-56pt-plus.png",
                    nostroke56pt_minus: "#%n-marvin-round-nostroke-56pt-minus.png",
                    nostroke56pt_x: "#%n-marvin-round-nostroke-56pt-x.png",
                    nostroke56pt_space: "#%n-marvin-round-nostroke-56pt-space.png",
                    nostroke56pt_asterisk: "#%n-marvin-round-nostroke-56pt-asterisk.png",
                    nostroke56pt_percent: "#%n-marvin-round-nostroke-56pt-percent.png",
                    default41pt_0: "#%n-marvin-round-41pt-0.png",
                    default41pt_1: "#%n-marvin-round-41pt-1.png",
                    default41pt_2: "#%n-marvin-round-41pt-2.png",
                    default41pt_3: "#%n-marvin-round-41pt-3.png",
                    default41pt_4: "#%n-marvin-round-41pt-4.png",
                    default41pt_5: "#%n-marvin-round-41pt-5.png",
                    default41pt_6: "#%n-marvin-round-41pt-6.png",
                    default41pt_7: "#%n-marvin-round-41pt-7.png",
                    default41pt_8: "#%n-marvin-round-41pt-8.png",
                    default41pt_9: "#%n-marvin-round-41pt-9.png",
                    default41pt_colon: "#%n-marvin-round-41pt-colon.png",
                    default41pt_slash: "#%n-marvin-round-41pt-slash.png",
                    default41pt_plus: "#%n-marvin-round-41pt-plus.png",
                    default41pt_minus: "#%n-marvin-round-41pt-minus.png",
                    default41pt_x: "#%n-marvin-round-41pt-x.png",
                    default41pt_space: "#%n-marvin-round-41pt-space.png",
                    default41pt_asterisk: "#%n-marvin-round-41pt-asterisk.png",
                    default41pt_percent: "#%n-marvin-round-41pt-percent.png",
                    default56pt_0: "#%n-marvin-round-56pt-0.png",
                    default56pt_1: "#%n-marvin-round-56pt-1.png",
                    default56pt_2: "#%n-marvin-round-56pt-2.png",
                    default56pt_3: "#%n-marvin-round-56pt-3.png",
                    default56pt_4: "#%n-marvin-round-56pt-4.png",
                    default56pt_5: "#%n-marvin-round-56pt-5.png",
                    default56pt_6: "#%n-marvin-round-56pt-6.png",
                    default56pt_7: "#%n-marvin-round-56pt-7.png",
                    default56pt_8: "#%n-marvin-round-56pt-8.png",
                    default56pt_9: "#%n-marvin-round-56pt-9.png",
                    default56pt_colon: "#%n-marvin-round-56pt-colon.png",
                    default56pt_slash: "#%n-marvin-round-56pt-slash.png",
                    default56pt_plus: "#%n-marvin-round-56pt-plus.png",
                    default56pt_minus: "#%n-marvin-round-56pt-minus.png",
                    default56pt_x: "#%n-marvin-round-56pt-x.png",
                    default56pt_space: "#%n-marvin-round-56pt-space.png",
                    default56pt_asterisk: "#%n-marvin-round-56pt-asterisk.png",
                    default56pt_percent: "#%n-marvin-round-56pt-percent.png",
                    icon: "#%n-dailytasks-daily_tasks.png",
                    notification_bg: "#%n-dailytasks-notification_bg.png",
                    menu_icon_png: "#%n-controlbuttons-menu.png",
                    control_button_png: "#%n-controlbuttons-menu_button.png",
                    control_button_on_png: "#%n-controlbuttons-menu_button_on.png",
                    fullscreen_icon_png: "#%n-controlbuttons-fullscreen_icon.png",
                    back_button_png: "#%n-controlbuttons-back_button.png",
                    back_button_on_png: "#%n-controlbuttons-back_button_on.png",
                    back_icon_png: "#%n-controlbuttons-back.png",
                    xmas_control_buttons: "#%n-xmas-xmas_controlbuttons.png",
                    coin_png: "#%n-menubar-coin.png",
                    gold_png: "#%n-menubar-ruby.png",
                    menubar_bg_png: "#%n-menubar-bar_bg.png",
                    bar_timer_png: "#%n-menubar-bar_timer.png",
                    plus_button_png: "#%n-menubar-plus.png",
                    plus_button_on_png: "#%n-menubar-plus_on.png",
                    unlim_png: "#%n-menubar-unlim.png",
                    xmas_menubar: "#%n-xmas-xmas_menubar.png",
                    xmas_menubar_level: "#%n-xmas-xmas_menubar_level.png",
                    attention_png: "#%n-attention-attention.png",
                    button_png: "#%n-buttons-button.png",
                    button_on_png: "#%n-buttons-button_on.png",
                    button_disabled_png: "#%n-buttons-button_off.png",
                    small_button: "#%n-buttons-small_green_button.png",
                    small_button_on: "#%n-buttons-small_green_button_on.png",
                    small_button_off: "#%n-buttons-small_button_off.png",
                    blue_button_png: "#%n-buttons-button_blue.png",
                    blue_button_on_png: "#%n-buttons-button_blue_on.png",
                    small_blue_button: "#%n-buttons-small_blue_button.png",
                    small_blue_button_on: "#%n-buttons-small_blue_button_on.png",
                    red_button: "#%n-buttons-red_button.png",
                    red_button_on: "#%n-buttons-red_button_on.png",
                    help_button_png: "#%n-buttons-help_small.png",
                    help_button_on_png: "#%n-buttons-help_small_on.png",
                    help_button_off_png: "#%n-buttons-help_small_off.png",
                    sign_in_button_png: "#%n-buttons-sign_in_button.png",
                    sign_in_button_on_png: "#%n-buttons-sign_in_button_on.png",
                    vacuum_png: "#%n-buttons-vacuum.png",
                    gold_icon_png: "#%n-button_icons-ruby_icon.png",
                    coin_icon_png: "#%n-button_icons-coin_icon.png",
                    ad_icon_png: "#%n-button_icons-ad_icon.png",
                    ok_icon_png: "#%n-button_icons-ok_icon.png",
                    yandex_icon_png: "#%n-button_icons-yandex_icon.png",
                    playhop_icon_png: "#%n-button_icons-playhop_icon.png",
                    kred_icon_png: "#%n-button_icons-kred_icon.png",
                    default72pt_0: "#%n-marvin-round-72pt-0.png",
                    default72pt_1: "#%n-marvin-round-72pt-1.png",
                    default72pt_2: "#%n-marvin-round-72pt-2.png",
                    default72pt_3: "#%n-marvin-round-72pt-3.png",
                    default72pt_4: "#%n-marvin-round-72pt-4.png",
                    default72pt_5: "#%n-marvin-round-72pt-5.png",
                    default72pt_6: "#%n-marvin-round-72pt-6.png",
                    default72pt_7: "#%n-marvin-round-72pt-7.png",
                    default72pt_8: "#%n-marvin-round-72pt-8.png",
                    default72pt_9: "#%n-marvin-round-72pt-9.png",
                    default72pt_colon: "#%n-marvin-round-72pt-colon.png",
                    default72pt_slash: "#%n-marvin-round-72pt-slash.png",
                    default72pt_plus: "#%n-marvin-round-72pt-plus.png",
                    default72pt_minus: "#%n-marvin-round-72pt-minus.png",
                    default72pt_x: "#%n-marvin-round-72pt-x.png",
                    default72pt_space: "#%n-marvin-round-72pt-space.png",
                    default72pt_asterisk: "#%n-marvin-round-72pt-asterisk.png",
                    default72pt_percent: "#%n-marvin-round-72pt-percent.png",
                    default97pt_0: "#%n-marvin-round-97pt-0.png",
                    default97pt_1: "#%n-marvin-round-97pt-1.png",
                    default97pt_2: "#%n-marvin-round-97pt-2.png",
                    default97pt_3: "#%n-marvin-round-97pt-3.png",
                    default97pt_4: "#%n-marvin-round-97pt-4.png",
                    default97pt_5: "#%n-marvin-round-97pt-5.png",
                    default97pt_6: "#%n-marvin-round-97pt-6.png",
                    default97pt_7: "#%n-marvin-round-97pt-7.png",
                    default97pt_8: "#%n-marvin-round-97pt-8.png",
                    default97pt_9: "#%n-marvin-round-97pt-9.png",
                    default97pt_colon: "#%n-marvin-round-97pt-colon.png",
                    default97pt_slash: "#%n-marvin-round-97pt-slash.png",
                    default97pt_plus: "#%n-marvin-round-97pt-plus.png",
                    default97pt_minus: "#%n-marvin-round-97pt-minus.png",
                    default97pt_x: "#%n-marvin-round-97pt-x.png",
                    default97pt_space: "#%n-marvin-round-97pt-space.png",
                    default97pt_asterisk: "#%n-marvin-round-97pt-asterisk.png",
                    default97pt_percent: "#%n-marvin-round-97pt-percent.png",
                    gamemessage_bg_png: "#%n-%n_message-level_msg_bg.png",
                    timer_png: "#%n-timer-timer.png",
                    timer_bg_png: "#%n-timer-timer_bg.png",
                    background_png: "#%n-checkbox-checkbox_bg.png",
                    check_mark_png: "#%n-checkbox-checkbox_mark.png",
                    mission_letter_png: "#%n-missions-mission_letter.png",
                    avatar_frame: "#%n-avatars-avatar_frame.png",
                    avatar_frame2: "#%n-avatars-avatar_frame2.png",
                    android_avatar: "#%n-avatars-android_avatar.png",
                    ios_avatar: "#%n-avatars-ios_avatar.png",
                    user_avatar: "#%n-avatars-user_avatar.png",
                    default_avatar: "#%n-avatars-default_avatar.png",
                    level_failed_heart_png: "#%n-main-lvf_heart.png",
                    level_failed_heart_empty_png: "#%n-main-lvf_heart_empty.png",
                    plus: "#%n-orangery-plus.png",
                    orangery_bg_light: "#%n-orangery-bg_light.png",
                    orangery_bg_dark: "#%n-orangery-bg_dark.png",
                    snapshot_rec: "#%n-dev_resources-icon_play.png",
                    snapshot_stop: "#%n-dev_resources-icon_stop.png",
                    snapshots_create_clip: "#%n-dev_resources-icon_create_clip.png",
                    snapshot: "#%n-dev_resources-icon_screen.png",
                    label_rec: "#%n-dev_resources-rec.png",
                    label_playback: "#%n-dev_resources-playback.png",
                    icon_edit: "#%n-dev_resources-icon_edit.png",
                    icon_error: "#%n-dev_resources-icon_error.png",
                    icon_report: "#%n-dev_resources-icon_report.png",
                    icon_stages: "#%n-dev_resources-icon_stages.png",
                    reward_element_bg_png: "#%n-reward_element-reward_element_bg.png",
                    icon_bg: "#%n-sidebar-icon_bg.png",
                    icon_text_bg: "#%n-sidebar-icon_text_bg.png",
                    bar_dailytask: "#%n-dailytasks-daily_task_bar.png",
                    bg_dailytask: "#%n-dailytasks-daily_task_bar_bg.png",
                    bg_vip: "#%n-vip_window-progress_background.png",
                    bar_vip: "#%n-vip_window-progressbar.png",
                    bg_dark_small: "#%n-progress_bar-bg_dark_small.png",
                    bg_dark: "#%n-progress_bar-bg_dark.png",
                    bg_dark_large: "#%n-progress_bar-bg_dark_large.png",
                    bg_green: "#%n-progress_bar-bg_green.png",
                    bg_green_large: "#%n-progress_bar-bg_green_large.png",
                    bar_red_small: "#%n-progress_bar-bar_red_small.png",
                    bar_orange_small: "#%n-progress_bar-bar_orange_small.png",
                    bar_blue_small: "#%n-progress_bar-bar_blue_small.png",
                    bar_red: "#%n-progress_bar-bar_red.png",
                    bar_orange: "#%n-progress_bar-bar_orange.png",
                    bar_blue: "#%n-progress_bar-bar_blue.png",
                    bar_green: "#%n-progress_bar-bar_green.png",
                    bar_red_large: "#%n-progress_bar-bar_red_large.png",
                    bar_orange_large: "#%n-progress_bar-bar_orange_large.png",
                    bar_blue_large: "#%n-progress_bar-bar_blue_large.png",
                    bar_green_large: "#%n-progress_bar-bar_green_large.png",
                    bar_simple: "#%n-simple-bar.png",
                    bg_simple: "#%n-simple-bar_bg.png",
                    bar_blue_large_round: "#%n-progress_bar-bar_blue_large_round.png",
                    pixel_png: "#%n-common-white_pixel.png",
                    piggy_bank_reward_icon: "#%n-images-piggy_bank_body3.png",
                    goals_bg_png: "#%n-prolongation_window-goals_bg.png",
                    label_moves_png: "#%n-prolongation_window-label_moves.png",
                    text_bg_png: "#%n-prolongation_window-text_bg.png",
                    moves_icon: "#%n-main-moves_icon.png",
                    game_moves_icon: "#%n-%n_moves_icon.png",
                    tile: "#%n-tiles-zen_tile.png",
                    opencards_bg: "#%n-tiles-zen_tile_bg.png",
                    opencards_fg: "#%n-tiles-zen_tile_bg2.png",
                    skin_random: "#%n-tiles-zen_tile_unknown.png",
                    skin_0: "#%n-tiles-0.png",
                    skin_1: "#%n-tiles-1.png",
                    skin_2: "#%n-tiles-2.png",
                    skin_3: "#%n-tiles-3.png",
                    skin_4: "#%n-tiles-4.png",
                    skin_5: "#%n-tiles-5.png",
                    skin_6: "#%n-tiles-6.png",
                    skin_7: "#%n-tiles-7.png",
                    skin_8: "#%n-tiles-8.png",
                    skin_9: "#%n-tiles-9.png",
                    skin_10: "#%n-tiles-10.png",
                    skin_11: "#%n-tiles-11.png",
                    skin_12: "#%n-tiles-12.png",
                    skin_13: "#%n-tiles-13.png",
                    skin_14: "#%n-tiles-14.png",
                    skin_15: "#%n-tiles-15.png",
                    skin_16: "#%n-tiles-16.png",
                    skin_17: "#%n-tiles-17.png",
                    skin_18: "#%n-tiles-18.png",
                    skin_19: "#%n-tiles-19.png",
                    skin_event_0: "#%n-event_tiles-0.png",
                    skin_event_1: "#%n-event_tiles-1.png",
                    skin_event_2: "#%n-event_tiles-2.png",
                    skin_event_3: "#%n-event_tiles-3.png",
                    skin_event_4: "#%n-event_tiles-4.png",
                    skin_event_5: "#%n-event_tiles-5.png"
                },
                important: ["play_tile_effect", "win_effect", "lose_effect", "timer_tick", "timer_tick_zero", "timer_start", "bomb_timer_tick", "bomb_timer_tick_zero", "bomb_timer_explosion"]
            },
            game_background_horizontal: {
                urls: {
                    background_music_game: "~sounds/music-d1f9cde96c.mp3",
                    background_music_hard: "~sounds/hardmusic-3b03abdc1b.mp3",
                    background: "@level_bg_horizontal-8bd1cb6c7c.jpg",
                    background_hard: "@hard_level_bg_horizontal-1ba97af0ae.jpg",
                    background_2: "@level_bg_horizontal_2-0050fecc11.jpg",
                    background_3: "@level_bg_horizontal_3-5365de5f88.jpg",
                    background_4: "@level_bg_horizontal_4-a540cd7d69.jpg",
                    background_5: "@level_bg_horizontal_5-5feba836a1.jpg",
                    background_6: "@level_bg_horizontal_6-1e5810df8e.jpg",
                    background_7: "@level_bg_horizontal_7-2fe0490be8.jpg"
                },
                horizontal: !0,
                extend: "game_music"
            },
            game_background_vertical: {
                urls: {
                    background: "@level_bg_vertical-3a52d91e79.jpg",
                    background_2: "@level_bg_vertical_2-7c2a124fb6.jpg",
                    background_3: "@level_bg_vertical_3-d01dc09cad.jpg",
                    background_4: "@level_bg_vertical_4-35f80fd571.jpg",
                    background_5: "@level_bg_vertical_5-31f240f609.jpg",
                    background_6: "@level_bg_vertical_6-d33ebe3e41.jpg",
                    background_7: "@level_bg_vertical_7-3618900b2c.jpg"
                }
            },
            game_music: {
                urls: {
                    background_music_game: "~sounds/music-d1f9cde96c.mp3",
                    background_music_hard: "~sounds/hardmusic-3b03abdc1b.mp3"
                }
            },
            gamemessage: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["%n_bg_png"],
                soundIds: ["game_message_effect", "game_message_hard_effect"]
            },
            growth_fund: {
                urls: {}
            },
            guidewindow_arrows: {
                virtual: !0,
                injectTo: ["dailycupruleswindow", "piggybankruleswindow", "lettertournamentguidewindow"],
                jsonIds: ["arrows"]
            },
            homefix: {
                virtual: !0,
                injectTo: []
            },
            knockout: {
                virtual: !0,
                injectTo: []
            },
            language_ar: {
                urls: {
                    json: "~%n/%n-d65ccf4473.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_ar-02a29daa4e.json",
                    common_json: "~%n/common_ar-7402ce67c6.json",
                    letter_tournament_json: "~%n/lettertournament_ar-19a6a127a4.json",
                    lives_json: "~%n/lives_ar-c2d367cd76.json",
                    meta_json: "~%n/simplemeta_ar-eb140cf68f.json",
                    piggybank_json: "~%n/piggybank_ar-527c9ac3d1.json",
                    project_json: "~%n/ar-79dca50013.json",
                    shares_json: "~%n/shares_ar-aceba44805.json",
                    type_json: "~%n/ar-bf5fea94f7.json"
                }
            },
            language_de: {
                urls: {
                    json: "~%n/%n-49a8592452.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_de-9357ccbb01.json",
                    common_json: "~%n/common_de-90e3b4b215.json",
                    letter_tournament_json: "~%n/lettertournament_de-802bbd9ec2.json",
                    lives_json: "~%n/lives_de-233011d6bb.json",
                    meta_json: "~%n/simplemeta_de-786c9f8f20.json",
                    piggybank_json: "~%n/piggybank_de-8710b829ca.json",
                    project_json: "~%n/de-6111f10253.json",
                    shares_json: "~%n/shares_de-58c9df43aa.json",
                    type_json: "~%n/de-876e6e8eed.json"
                }
            },
            language_en: {
                urls: {
                    json: "~%n/%n-cb7078847b.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_en-26e0636b90.json",
                    common_json: "~%n/common_en-520719c6b0.json",
                    letter_tournament_json: "~%n/lettertournament_en-a6117fa1c4.json",
                    lives_json: "~%n/lives_en-521535fdbc.json",
                    meta_json: "~%n/simplemeta_en-c6cfc1d869.json",
                    piggybank_json: "~%n/piggybank_en-ba6d729608.json",
                    project_json: "~%n/en-14a7b6ba47.json",
                    shares_json: "~%n/shares_en-7fbce9815f.json",
                    type_json: "~%n/en-20ee84dd26.json"
                }
            },
            language_es: {
                urls: {
                    json: "~%n/%n-19855cd05a.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_es-7af565fcf8.json",
                    common_json: "~%n/common_es-50bbfc96bf.json",
                    letter_tournament_json: "~%n/lettertournament_es-2212556946.json",
                    lives_json: "~%n/lives_es-9f70ea3c4d.json",
                    meta_json: "~%n/simplemeta_es-0152edb40b.json",
                    piggybank_json: "~%n/piggybank_es-0cf6ed56cb.json",
                    project_json: "~%n/es-5e250a2f72.json",
                    shares_json: "~%n/shares_es-0445fc79c0.json",
                    type_json: "~%n/es-ddb40193ae.json"
                }
            },
            language_fr: {
                urls: {
                    json: "~%n/%n-6fe3a355a4.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_fr-f1b2787644.json",
                    common_json: "~%n/common_fr-1dca393df2.json",
                    letter_tournament_json: "~%n/lettertournament_fr-e09d93433c.json",
                    lives_json: "~%n/lives_fr-09e5e129f4.json",
                    meta_json: "~%n/simplemeta_fr-ea4edf7a7b.json",
                    piggybank_json: "~%n/piggybank_fr-1fc6d740c2.json",
                    project_json: "~%n/fr-16ebcf6ff9.json",
                    shares_json: "~%n/shares_fr-4376fe79e1.json",
                    type_json: "~%n/fr-d971c5aaa8.json"
                }
            },
            language_it: {
                urls: {
                    json: "~%n/%n-34685b4c92.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_it-bf2f70a8d4.json",
                    common_json: "~%n/common_it-b902b45f11.json",
                    letter_tournament_json: "~%n/lettertournament_it-f119152cba.json",
                    lives_json: "~%n/lives_it-9a12b71109.json",
                    meta_json: "~%n/simplemeta_it-1e42502dff.json",
                    piggybank_json: "~%n/piggybank_it-d7301c065f.json",
                    project_json: "~%n/it-b4367b3adf.json",
                    shares_json: "~%n/shares_it-114a56bd2a.json",
                    type_json: "~%n/it-7a55417d2f.json"
                }
            },
            language_ja: {
                urls: {
                    json: "~%n/%n-b5c40a3a24.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_ja-c31fd8f014.json",
                    common_json: "~%n/common_ja-14054a0b22.json",
                    letter_tournament_json: "~%n/lettertournament_ja-287111e5bf.json",
                    lives_json: "~%n/lives_ja-0400a11e23.json",
                    meta_json: "~%n/simplemeta_ja-4260877bf8.json",
                    piggybank_json: "~%n/piggybank_ja-5b57017576.json",
                    project_json: "~%n/ja-c7efc537a7.json",
                    shares_json: "~%n/shares_ja-ca3f8ce298.json",
                    type_json: "~%n/ja-d8c63c2618.json"
                }
            },
            language_ko: {
                urls: {
                    json: "~%n/%n-7bfade6521.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_ko-5b231cdf41.json",
                    common_json: "~%n/common_ko-64594a26dd.json",
                    letter_tournament_json: "~%n/lettertournament_ko-4a9bbb4d11.json",
                    lives_json: "~%n/lives_ko-b10aef5718.json",
                    meta_json: "~%n/simplemeta_ko-05e6ed5cc4.json",
                    piggybank_json: "~%n/piggybank_ko-fcaeaa3549.json",
                    project_json: "~%n/ko-d2b953a663.json",
                    shares_json: "~%n/shares_ko-f59b1d1a54.json",
                    type_json: "~%n/ko-a9e00a1c1c.json"
                }
            },
            language_lv: {
                urls: {
                    json: "~%n/%n-49689837fd.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_lv-aecb9aca8f.json",
                    common_json: "~%n/common_lv-4980febaef.json",
                    letter_tournament_json: "~%n/lettertournament_lv-80b5dc3d57.json",
                    lives_json: "~%n/lives_lv-27aa1b2fd8.json",
                    meta_json: "~%n/simplemeta_lv-2e3e39ef07.json",
                    piggybank_json: "~%n/piggybank_lv-7b4081078e.json",
                    project_json: "~%n/lv-872aabfec2.json",
                    shares_json: "~%n/shares_lv-53b7c464f4.json",
                    type_json: "~%n/lv-768f9ddcb0.json"
                }
            },
            language_nl: {
                urls: {
                    json: "~%n/%n-8b5bf7ba30.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_nl-ff89842d54.json",
                    common_json: "~%n/common_nl-cda8890f8a.json",
                    letter_tournament_json: "~%n/lettertournament_nl-ed7691b0af.json",
                    lives_json: "~%n/lives_nl-f2fe20a891.json",
                    meta_json: "~%n/simplemeta_nl-031f68121e.json",
                    piggybank_json: "~%n/piggybank_nl-d5302fb08c.json",
                    project_json: "~%n/nl-8104cb2190.json",
                    shares_json: "~%n/shares_nl-ab94a2234c.json",
                    type_json: "~%n/nl-cbdbab52c5.json"
                }
            },
            language_pl: {
                urls: {
                    json: "~%n/%n-51405e2271.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_pl-ccaab53ce3.json",
                    common_json: "~%n/common_pl-fbe1e0235f.json",
                    letter_tournament_json: "~%n/lettertournament_pl-445618133f.json",
                    lives_json: "~%n/lives_pl-d4c2b67033.json",
                    meta_json: "~%n/simplemeta_pl-8edbc3384a.json",
                    piggybank_json: "~%n/piggybank_pl-c5bc499490.json",
                    project_json: "~%n/pl-579c9037f6.json",
                    shares_json: "~%n/shares_pl-6d73040ad0.json",
                    type_json: "~%n/pl-e4aeb47e7e.json"
                }
            },
            language_pt: {
                urls: {
                    json: "~%n/%n-4f9a002653.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_pt-29e9d89b7c.json",
                    common_json: "~%n/common_pt-645184d18b.json",
                    letter_tournament_json: "~%n/lettertournament_pt-a39d38617a.json",
                    lives_json: "~%n/lives_pt-fd1ec330dc.json",
                    meta_json: "~%n/simplemeta_pt-744ebcc5f1.json",
                    piggybank_json: "~%n/piggybank_pt-f590602e3f.json",
                    project_json: "~%n/pt-47734cb539.json",
                    shares_json: "~%n/shares_pt-c0e9a724e4.json",
                    type_json: "~%n/pt-131377b957.json"
                }
            },
            language_ru: {
                urls: {
                    json: "~%n/%n-385fc7a409.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_ru-2520fecce4.json",
                    common_json: "~%n/common_ru-08ac777810.json",
                    letter_tournament_json: "~%n/lettertournament_ru-7014f078bd.json",
                    lives_json: "~%n/lives_ru-8d304c0fc1.json",
                    meta_json: "~%n/simplemeta_ru-9f7e6d11c9.json",
                    piggybank_json: "~%n/piggybank_ru-b23917c4e5.json",
                    project_json: "~%n/ru-3e8e70c0cc.json",
                    shares_json: "~%n/shares_ru-3b1a96b6d5.json",
                    type_json: "~%n/ru-180be28cbc.json"
                }
            },
            language_tr: {
                urls: {
                    json: "~%n/%n-313aac5292.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_tr-d94942582c.json",
                    common_json: "~%n/common_tr-b039f4c251.json",
                    letter_tournament_json: "~%n/lettertournament_tr-ce6c2075a2.json",
                    lives_json: "~%n/lives_tr-629e6a97b6.json",
                    meta_json: "~%n/simplemeta_tr-5ae3bd4e60.json",
                    piggybank_json: "~%n/piggybank_tr-ba54295a03.json",
                    project_json: "~%n/tr-07d1060eb7.json",
                    shares_json: "~%n/shares_tr-dfe79e5446.json",
                    type_json: "~%n/tr-8db741c545.json"
                }
            },
            language_zh: {
                urls: {
                    json: "~%n/%n-7d12428e9a.json"
                },
                jsons: {
                    achievements_json: "~%n/achievements_zh-ff758fc08f.json",
                    common_json: "~%n/common_zh-a4bb283ed4.json",
                    letter_tournament_json: "~%n/lettertournament_zh-5fad50a4c9.json",
                    lives_json: "~%n/lives_zh-f8f54c0256.json",
                    meta_json: "~%n/simplemeta_zh-e2db489d52.json",
                    piggybank_json: "~%n/piggybank_zh-e723793c3e.json",
                    project_json: "~%n/zh-f4d3141bea.json",
                    shares_json: "~%n/shares_zh-76d5f0357e.json",
                    type_json: "~%n/zh-d11a929a05.json"
                }
            },
            lantern: {
                virtual: !0,
                injectTo: ["game"]
            },
            letter_tournament: {
                urls: {}
            },
            lettertournamentguidewindow: {
                urls: {
                    png: "@%n-b7f2b10484.png",
                    json: "@%n-cdbdbe25b3.json"
                },
                jsons: {
                    arrows: "@guide_arrows-4ff7d68ca2.json",
                    atlas: "@%n-b7f2b10484.atlas",
                    rules_stages_1: "@tournament_stage1-5ba5208087.json",
                    rules_stages_2: "@tournament_stage2-75a6a1d420.json",
                    rules_stages_3: "@tournament_stage3-ce8776e793.json"
                }
            },
            level: {
                virtual: !0,
                injectTo: ["main"],
                jsonIds: ["%n_json"]
            },
            level_start_window: {
                urls: {
                    png: "@%n-4358569e6e.png",
                    json: "@%n-4a3100ca93.json"
                },
                jsons: {
                    atlas: "@%n-4358569e6e.atlas",
                    plist: "@%n-4358569e6e.plist"
                },
                frames: {
                    pot_coins_png: "#%n-pot_coins.png"
                }
            },
            loading_scene: {
                urls: {
                    png: "@%n-603d1c13f8.png",
                    json: "@%n-6f6e9517f2.json"
                },
                jsons: {
                    atlas: "@%n-603d1c13f8.atlas",
                    logo_json: "@loading-8e0973b9ba.json"
                }
            },
            loading_scene_images: {
                urls: {
                    bg_loading: "~%n/bg_loading.png",
                    bar_loading: "~%n/bar_loading.png"
                }
            },
            loading_scene_images_horizontal: {
                urls: {
                    background: "@background_horizontal-2a6b13f696.jpg"
                },
                horizontal: !0
            },
            lose_window: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["level_failed_heart_png", "level_failed_heart_empty_png"],
                jsonIds: ["level_failed_small_hearts_json", "lose_json"],
                soundIds: ["lose_effect"]
            },
            lottery: {
                virtual: !0,
                injectTo: ["tile_shop", "main"],
                frameIds: ["%n_en", "%n_ru", "ok_%n", "ok_%n_10k", "vk_%n"]
            },
            main: {
                urls: {
                    click_effect: "~sounds/click-05d780add0.mp3",
                    notification_effect: "~sounds/notification-f04c69388d.mp3",
                    window_effect: "~sounds/window-c9e3bfe78a.mp3",
                    play_button_effect: "~sounds/play_button_effect-0caa47ecd1.mp3",
                    background_music_map: "~sounds/background_music-488a57e135.mp3",
                    reward_window_effect: "~sounds/reward-6fd002b7a1.mp3",
                    congratulate_sfx: "~sounds/congratulate-28bb2de73f.mp3",
                    reward_icon_show_effect: "~sounds/appearance_icon-d01bbf8270.mp3",
                    win_reward_box_effect: "~sounds/reward_box-608375d15c.mp3",
                    win_reward_effect: "~sounds/reward_taptocontinue-dc9f07b8aa.mp3",
                    coins_drop_effect: "~sounds/coins_drop-60e66baecc.mp3",
                    daily_game_mix_effect: "~sounds/mixbox-00c21a76ce.mp3",
                    press_effect: "~sounds/hand_hint-de043d48db.mp3",
                    prize_view_created_effect: "~sounds/prize_view_created-bbf5f83c58.mp3",
                    task_done_sfx: "~sounds/done_jingle-c8ff12607c.mp3",
                    lives_fly_finish_effect: "~sounds/reward_heart-158e7e348d.mp3",
                    coins_effect: "~sounds/coins-f1a88f9724.mp3",
                    star_collect_effect: "~sounds/star_collect-cc04d1e205.mp3",
                    simple_win_effect: "~sounds/simple_win-7e3c809b13.mp3",
                    simple_transition_effect: "~sounds/simple_transition-a0355f0cca.mp3",
                    metha_present_effect: "~sounds/present-7df31fe222.mp3",
                    simple_complete_bg_effect: "~sounds/simple_complete_bg-a386fbbee1.mp3",
                    fly_effect: "~sounds/hint_fly-727b5c2529.mp3",
                    show_up_effect: "~sounds/hint_app-b8cbd76c17.mp3",
                    booster_before_selection_effect: "~sounds/select_effect-a77a28f08f.mp3",
                    booster_before_cancel_effect: "~sounds/unselect_effect-f957e5fb80.mp3",
                    appear_sfx: "~sounds/emergence_boosterdo-4c0b6fe03d.mp3",
                    basefont_ttf: {
                        type: "font",
                        name: "Marvin-Round",
                        srcs: ["~fonts/marvin_round-19bc84dad1.ttf", "~fonts/marvin_round-19bc84dad1.eot"]
                    },
                    png: "@%n-6fef2aa3ed.png",
                    json: "@%n-b1626ef40c.json"
                },
                jsons: {
                    friday_schedule: {
                        url: "cleverapps/res/zenmatch/schedule.json",
                        data: '[\n  {\n    "features": ["periodic_sale"],\n    "start": "2023-11-24T00:00:00.000Z",\n    "finish": "2023-11-27T23:59:00.000Z"\n  },\n  {\n    "features": ["chain_sale"],\n    "start": "2024-02-05T00:00:00.000Z",\n    "finish": "2024-02-12T23:59:00.000Z",\n    "debug": true\n  },\n  {\n    "features": ["chain_sale"],\n    "start": "2024-02-10T00:00:00.000Z",\n    "finish": "2024-02-12T23:59:00.000Z"\n  },\n  {\n    "features": ["halloween"],\n    "start": "2023-09-18T00:00:00.000Z",\n    "finish": "2023-10-29T23:59:00.000Z",\n    "debug": true\n  },\n  {\n    "features": ["xmas"],\n    "start": "2023-12-18T00:00:00.000Z",\n    "finish": "2024-01-10T23:59:00.000Z"\n  }\n\n]\n',
                        inline: !0
                    },
                    ads_bubble_json: "@ad_bubble-116b67a48d.json",
                    aquatic_flower: "@pack_kraken_left-2c8bba8498.json",
                    arrow_json: "@arrow-d19bc7192c.json",
                    atlas: "@%n-6fef2aa3ed.atlas",
                    avatar_spark_json: "@avatar_spark-dae07e0bd6.json",
                    bg_person: "@person_circle-cd8253c532.json",
                    chain_sale_json: "@chain_sale_sidebar-eabdab3e2b.json",
                    dailycup_icon_json: "@icon_dailycup-995891f76f.json",
                    flash_json: "@progress_bar_flash-db8d86b0ff.json",
                    flying_ad_json: "@flying_ad-a047a2e10d.json",
                    hero_json: "@fairy_dwarf_violet-90312c64ed.json",
                    hero_minimal_json: "@fairy_dwarf_violet_minimal-0122953bf5.json",
                    invite_icon_json: "@invite_icon-71cafaa19c.json",
                    level_json: "@level-fd7b018b5a.json",
                    minigame_json: "@minigame-2fd9a84229.json",
                    mission_letter_icon_json: "@mission_ruby_icon-219d285467.json",
                    pack1_icon_json: "@icon_pack2-29f7383040.json",
                    pack2_icon_json: "@icon_pack3-e780932855.json",
                    pack_icon_json: "@icon_pack1-e6a78e91bc.json",
                    periodic_sale_json: "@blackfriday_icon-7f932014a5.json",
                    piggybank_icon_json: "@icon_piggy-41b7f6b987.json",
                    play_button_transition_json: "@play_button_transition-86d4e931e5.json",
                    plist: "@%n-6fef2aa3ed.plist",
                    present_json: "@present-ac3bfe828f.json",
                    prize_json: "@dt_present-270d89dd50.json",
                    prize_shine_json: "@prize_shine-79ec9db320.json",
                    progress_bar_json: "@progress_bar-6fc7b7e73d.json",
                    progress_bar_spark_json: "@progress_bar_spark-e14673a524.json",
                    reward_shine_json: "@reward_shine-124a9d154b.json",
                    reward_spine_json: "@reward_animation-c9d2d2986f.json",
                    shadow_liana_left: "@shadow_liana_left-2e2b6a0425.json",
                    shadow_liana_right: "@shadow_liana_right-632c8da844.json",
                    shuffle_json: "@replace-047fbf09bc.json",
                    sparks_json: "@sparks-02495497ad.json",
                    star_json: "@star-592ede93c3.json",
                    transition_curtains_json: "@transition_curtains-e8464e35be.json",
                    transition_person_json: "@transition_person-32e378e042.json",
                    treasurebag_json: "@treasurebag-013c3e29b8.json",
                    undo_json: "@undo-d2995bab03.json",
                    vk_json: "@vk-52cda37355.json",
                    wait_json: "@loading-9f26747c57.json",
                    wait_transition_json: "@loading-bf1adeddbc.json",
                    xmas_window: "@christmas_windows-047a3bed73.json",
                    xmas_window_title: "@xmas_top-63f262fbd7.json"
                },
                frames: {
                    white_button_png: "#%n-socialicons-white_button.png",
                    white_outline_button_png: "#%n-socialicons-white_outline_button.png",
                    white_outline_button_on_png: "#%n-socialicons-white_outline_button_on.png",
                    league_arrow_png: "#%n-leaderboard-league_arrow.png",
                    scrollbar_png: "#%n-scrollbar-scrollbar.png",
                    tooltip_bg_png: "#%n-tooltip-box.png",
                    tooltip_shadow_arrow_png: "#%n-tooltip-arrow.png",
                    tooltip_arrow_png: "#%n-tooltip-arrow2.png",
                    gold_small_png: "#%n-reward_icons-ruby_small.png",
                    coin_small_png: "#%n-reward_icons-coin_small.png",
                    reward_gold_png: "#%n-reward_icons-ruby.png",
                    reward_coin_png: "#%n-reward_icons-coin.png",
                    shop_gold_png: "#%n-reward_icons-ruby_shop.png",
                    shop_coin_png: "#%n-reward_icons-coin_shop.png",
                    bonussale_gift: "#%n-reward_icons-bonussale_gift.png",
                    life_png: "#%n-menubar-life.png",
                    life_small_png: "#%n-reward_icons-life_small.png",
                    life_unlim: "#%n-reward_icons-life_unlim.png",
                    life_unlim_small: "#%n-reward_icons-life_unlim_small.png",
                    simple_star_png: "#%n-reward_icons-simple_star.png",
                    booster_tile_shuffle_png: "#%n-reward_icons-booster_tile_shuffle.png",
                    booster_vacuum_png: "#%n-reward_icons-booster_vacuum.png",
                    booster_undo_png: "#%n-reward_icons-booster_undo.png",
                    push_icon: "#%n-button_icons-admin_push.png",
                    revert_icon: "#%n-button_icons-admin_rev.png",
                    regular_button: "#%n-admin-regular_button.png",
                    scroll_bg: "#%n-admin-regular_button.png",
                    regular_button_on: "#%n-admin-regular_button_on.png",
                    delete_button: "#%n-admin-delete_button.png",
                    scroll_content_bg: "#%n-admin-level_frame_selected.png",
                    loading: "#%n-admin-loading.png",
                    button: "#%n-editor-editor_button.png",
                    button_on: "#%n-editor-editor_button_on.png",
                    button_off: "#%n-editor-editor_button_off.png",
                    plus_button: "#%n-editor-plus_button.png",
                    window_bg_png: "#%n-windows-window_bg.png",
                    window_title_bg_secondary_png: "#%n-windows-window_title_bg_secondary.png",
                    windows_group_bg_png: "#%n-windows-window_group_bg.png",
                    windows_details_bg_png: "#%n-windows-window_details_bg.png",
                    editbox_bg_png: "#%n-common-editbox_bg.png",
                    ads_bg: "#%n-ads_info-ads_bg.png",
                    ads_alpha: "#%n-ads_info-alpha.png",
                    ads_beta: "#%n-ads_info-beta.png",
                    ads_gamma: "#%n-ads_info-gamma.png",
                    window_foreground_png: "#%n-windows-window_foreground.png",
                    details_rings: "#%n-orders-order_rings.png",
                    tile_bg_png: "#%n-orders-icon_background.png",
                    tile_amount_png: "#%n-orders-layout_header.png",
                    tutorial_click_png: "#%n-tutorial-circle.png",
                    tutorial_hand_png: "#%n-tutorial-hand.png",
                    underline_png: "#%n-underline-underline.png",
                    nostroke56pt_0: "#%n-marvin-round-nostroke-56pt-0.png",
                    nostroke56pt_1: "#%n-marvin-round-nostroke-56pt-1.png",
                    nostroke56pt_2: "#%n-marvin-round-nostroke-56pt-2.png",
                    nostroke56pt_3: "#%n-marvin-round-nostroke-56pt-3.png",
                    nostroke56pt_4: "#%n-marvin-round-nostroke-56pt-4.png",
                    nostroke56pt_5: "#%n-marvin-round-nostroke-56pt-5.png",
                    nostroke56pt_6: "#%n-marvin-round-nostroke-56pt-6.png",
                    nostroke56pt_7: "#%n-marvin-round-nostroke-56pt-7.png",
                    nostroke56pt_8: "#%n-marvin-round-nostroke-56pt-8.png",
                    nostroke56pt_9: "#%n-marvin-round-nostroke-56pt-9.png",
                    nostroke56pt_colon: "#%n-marvin-round-nostroke-56pt-colon.png",
                    nostroke56pt_slash: "#%n-marvin-round-nostroke-56pt-slash.png",
                    nostroke56pt_plus: "#%n-marvin-round-nostroke-56pt-plus.png",
                    nostroke56pt_minus: "#%n-marvin-round-nostroke-56pt-minus.png",
                    nostroke56pt_x: "#%n-marvin-round-nostroke-56pt-x.png",
                    nostroke56pt_space: "#%n-marvin-round-nostroke-56pt-space.png",
                    nostroke56pt_asterisk: "#%n-marvin-round-nostroke-56pt-asterisk.png",
                    nostroke56pt_percent: "#%n-marvin-round-nostroke-56pt-percent.png",
                    default41pt_0: "#%n-marvin-round-41pt-0.png",
                    default41pt_1: "#%n-marvin-round-41pt-1.png",
                    default41pt_2: "#%n-marvin-round-41pt-2.png",
                    default41pt_3: "#%n-marvin-round-41pt-3.png",
                    default41pt_4: "#%n-marvin-round-41pt-4.png",
                    default41pt_5: "#%n-marvin-round-41pt-5.png",
                    default41pt_6: "#%n-marvin-round-41pt-6.png",
                    default41pt_7: "#%n-marvin-round-41pt-7.png",
                    default41pt_8: "#%n-marvin-round-41pt-8.png",
                    default41pt_9: "#%n-marvin-round-41pt-9.png",
                    default41pt_colon: "#%n-marvin-round-41pt-colon.png",
                    default41pt_slash: "#%n-marvin-round-41pt-slash.png",
                    default41pt_plus: "#%n-marvin-round-41pt-plus.png",
                    default41pt_minus: "#%n-marvin-round-41pt-minus.png",
                    default41pt_x: "#%n-marvin-round-41pt-x.png",
                    default41pt_space: "#%n-marvin-round-41pt-space.png",
                    default41pt_asterisk: "#%n-marvin-round-41pt-asterisk.png",
                    default41pt_percent: "#%n-marvin-round-41pt-percent.png",
                    default56pt_0: "#%n-marvin-round-56pt-0.png",
                    default56pt_1: "#%n-marvin-round-56pt-1.png",
                    default56pt_2: "#%n-marvin-round-56pt-2.png",
                    default56pt_3: "#%n-marvin-round-56pt-3.png",
                    default56pt_4: "#%n-marvin-round-56pt-4.png",
                    default56pt_5: "#%n-marvin-round-56pt-5.png",
                    default56pt_6: "#%n-marvin-round-56pt-6.png",
                    default56pt_7: "#%n-marvin-round-56pt-7.png",
                    default56pt_8: "#%n-marvin-round-56pt-8.png",
                    default56pt_9: "#%n-marvin-round-56pt-9.png",
                    default56pt_colon: "#%n-marvin-round-56pt-colon.png",
                    default56pt_slash: "#%n-marvin-round-56pt-slash.png",
                    default56pt_plus: "#%n-marvin-round-56pt-plus.png",
                    default56pt_minus: "#%n-marvin-round-56pt-minus.png",
                    default56pt_x: "#%n-marvin-round-56pt-x.png",
                    default56pt_space: "#%n-marvin-round-56pt-space.png",
                    default56pt_asterisk: "#%n-marvin-round-56pt-asterisk.png",
                    default56pt_percent: "#%n-marvin-round-56pt-percent.png",
                    toolbar_bg_png: "#%n-toolbar-toolbar_bg.png",
                    toolbar_dailybonus_icon_png: "#%n-toolbar-tb_dailyquest.png",
                    toolbar_daily_tasks_icon_png: "#%n-toolbar-tb_daily_tasks.png",
                    toolbar_mail_icon_png: "#%n-toolbar-tb_messages.png",
                    toolbar_leader_board_icon_png: "#%n-toolbar-tb_leaderboard_icon.png",
                    toolbar_rewarded_video_icon_png: "#%n-toolbar-tb_video.png",
                    xmas_toolbar: "#%n-xmas-xmas_toolbar.png",
                    mark_png: "#%n-dailytasks-daily_task_check.png",
                    icon: "#%n-dailytasks-daily_tasks.png",
                    notification_bg: "#%n-dailytasks-notification_bg.png",
                    menu_icon_png: "#%n-controlbuttons-menu.png",
                    control_button_png: "#%n-controlbuttons-menu_button.png",
                    control_button_on_png: "#%n-controlbuttons-menu_button_on.png",
                    fullscreen_icon_png: "#%n-controlbuttons-fullscreen_icon.png",
                    back_button_png: "#%n-controlbuttons-back_button.png",
                    back_button_on_png: "#%n-controlbuttons-back_button_on.png",
                    back_icon_png: "#%n-controlbuttons-back.png",
                    xmas_control_buttons: "#%n-xmas-xmas_controlbuttons.png",
                    coin_png: "#%n-menubar-coin.png",
                    gold_png: "#%n-menubar-ruby.png",
                    menubar_bg_png: "#%n-menubar-bar_bg.png",
                    bar_timer_png: "#%n-menubar-bar_timer.png",
                    plus_button_png: "#%n-menubar-plus.png",
                    plus_button_on_png: "#%n-menubar-plus_on.png",
                    unlim_png: "#%n-menubar-unlim.png",
                    xmas_menubar: "#%n-xmas-xmas_menubar.png",
                    xmas_menubar_level: "#%n-xmas-xmas_menubar_level.png",
                    attention_png: "#%n-attention-attention.png",
                    button_png: "#%n-buttons-button.png",
                    button_on_png: "#%n-buttons-button_on.png",
                    button_disabled_png: "#%n-buttons-button_off.png",
                    small_button: "#%n-buttons-small_green_button.png",
                    small_button_on: "#%n-buttons-small_green_button_on.png",
                    small_button_off: "#%n-buttons-small_button_off.png",
                    blue_button_png: "#%n-buttons-button_blue.png",
                    blue_button_on_png: "#%n-buttons-button_blue_on.png",
                    small_blue_button: "#%n-buttons-small_blue_button.png",
                    small_blue_button_on: "#%n-buttons-small_blue_button_on.png",
                    red_button: "#%n-buttons-red_button.png",
                    red_button_on: "#%n-buttons-red_button_on.png",
                    help_button_png: "#%n-buttons-help_small.png",
                    help_button_on_png: "#%n-buttons-help_small_on.png",
                    help_button_off_png: "#%n-buttons-help_small_off.png",
                    sign_in_button_png: "#%n-buttons-sign_in_button.png",
                    sign_in_button_on_png: "#%n-buttons-sign_in_button_on.png",
                    vacuum_png: "#%n-buttons-vacuum.png",
                    gold_icon_png: "#%n-button_icons-ruby_icon.png",
                    coin_icon_png: "#%n-button_icons-coin_icon.png",
                    ad_icon_png: "#%n-button_icons-ad_icon.png",
                    ok_icon_png: "#%n-button_icons-ok_icon.png",
                    yandex_icon_png: "#%n-button_icons-yandex_icon.png",
                    playhop_icon_png: "#%n-button_icons-playhop_icon.png",
                    kred_icon_png: "#%n-button_icons-kred_icon.png",
                    window_close_png: "#%n-buttons-close.png",
                    window_close_on_png: "#%n-buttons-close_on.png",
                    close_band_icon: "#%n-buttons-close_icon.png",
                    scene_exit_button: "#%n-buttons-scene_exit.png",
                    music_off_png: "#%n-sounds-music_off.png",
                    music_on_png: "#%n-sounds-music_on.png",
                    sound_off_png: "#%n-sounds-sound_off.png",
                    sound_on_png: "#%n-sounds-sound_on.png",
                    close_small: "#%n-buttons-close_small.png",
                    close_small_on: "#%n-buttons-close_small_on.png",
                    community_icon: "#%n-buttons-community_icon.png",
                    copyid_icon: "#%n-buttons-copy_id_icon.png",
                    delete_icon: "#%n-buttons-delete_icon.png",
                    exit_icon: "#%n-buttons-exit_icon.png",
                    giveup_icon: "#%n-buttons-give_up_icon.png",
                    language_icon: "#%n-buttons-language_icon.png",
                    support_icon: "#%n-buttons-support_icon.png",
                    home_icon: "#%n-buttons-home_icon.png",
                    icon_bg: "#%n-sidebar-icon_bg.png",
                    treasurebag_bg_png: "#%n-sidebar-icon_bg.png",
                    lock: "#%n-sidebar-lock_sidebar.png",
                    icon_text_bg: "#%n-sidebar-icon_text_bg.png",
                    xmas_sidebar: "#%n-xmas-xmas_sidebar.png",
                    login_ok_icon_png: "#%n-socialicons-ok_icon.png",
                    login_vk_icon_png: "#%n-socialicons-vk_icon.png",
                    login_mm_icon_png: "#%n-socialicons-mm_icon.png",
                    login_fs_icon_png: "#%n-socialicons-fs_icon.png",
                    login_draugiem_icon_png: "#%n-socialicons-draugiem_icon.png",
                    login_mobage_icon_png: "#%n-socialicons-mobage_icon.png",
                    login_plinga_icon_png: "#%n-socialicons-plinga_icon.png",
                    login_kongregate_icon_png: "#%n-socialicons-kongregate_icon.png",
                    table_bg_png: "#%n-table-table_bg.png",
                    amount_bg_png: "#%n-table-amount_bg.png",
                    amount_bg_you_png: "#%n-table-amount_bg_you.png",
                    row_player_png: "#%n-table-row_player.png",
                    row_you_png: "#%n-table-row_you.png",
                    badge_1: "#%n-table-badge_1.png",
                    badge_2: "#%n-table-badge_2.png",
                    badge_3: "#%n-table-badge_3.png",
                    prize_1: "#%n-table-prize_1.png",
                    prize_2: "#%n-table-prize_2.png",
                    prize_3: "#%n-table-prize_3.png",
                    prize_4: "#%n-table-prize_4.png",
                    prize_5: "#%n-table-prize_5.png",
                    vertical_shop_tab_off: "#%n-tabs-vertical_tab_off.png",
                    vertical_shop_tab_on: "#%n-tabs-vertical_tab_on.png",
                    shop_tab_off: "#%n-tabs-tab_off.png",
                    shop_tab_on: "#%n-tabs-tab_on.png",
                    round_tab_bg: "#%n-tile_shop-tab_bg.png",
                    round_tab_bg_selected: "#%n-tile_shop-tab_bg_selected.png",
                    dailytasks_icon: "#%n-tabs-tasks.png",
                    achievements_icon: "#%n-tabs-achievements.png",
                    timer_png: "#%n-timer-timer.png",
                    timer_bg_png: "#%n-timer-timer_bg.png",
                    background_png: "#%n-checkbox-checkbox_bg.png",
                    check_mark_png: "#%n-checkbox-checkbox_mark.png",
                    letter_mission: "#%n-tablerowicons-row_mission_letter.png",
                    send_coins_icon: "#%n-friend_messages-message_coins_icon.png",
                    accept_stuck_coins_icon: "#%n-friend_messages-message_coins_stuck_icon.png",
                    friend_message_bg_png: "#%n-friend_messages-message_bg.png",
                    send_life_icon: "#%n-friend_messages-message_life_icon.png",
                    avatar_frame: "#%n-avatars-avatar_frame.png",
                    avatar_frame2: "#%n-avatars-avatar_frame2.png",
                    android_avatar: "#%n-avatars-android_avatar.png",
                    ios_avatar: "#%n-avatars-ios_avatar.png",
                    user_avatar: "#%n-avatars-user_avatar.png",
                    default_avatar: "#%n-avatars-default_avatar.png",
                    plus: "#%n-orangery-plus.png",
                    orangery_bg_light: "#%n-orangery-bg_light.png",
                    orangery_bg_dark: "#%n-orangery-bg_dark.png",
                    snapshot_rec: "#%n-dev_resources-icon_play.png",
                    snapshot_stop: "#%n-dev_resources-icon_stop.png",
                    snapshots_create_clip: "#%n-dev_resources-icon_create_clip.png",
                    snapshot: "#%n-dev_resources-icon_screen.png",
                    label_rec: "#%n-dev_resources-rec.png",
                    label_playback: "#%n-dev_resources-playback.png",
                    icon_edit: "#%n-dev_resources-icon_edit.png",
                    icon_error: "#%n-dev_resources-icon_error.png",
                    icon_report: "#%n-dev_resources-icon_report.png",
                    icon_stages: "#%n-dev_resources-icon_stages.png",
                    dialogue_arrow_png: "#%n-dialogues-arrow_bg.png",
                    bg_png: "#%n-dialogues-bg.png",
                    dialogue_name: "#%n-dialogues-char_name_bg.png",
                    bg_minimal_png: "#%n-dialogues-minimal_bg.png",
                    mini_arrow_bg_png: "#%n-dialogues-mini_arrow_bg.png",
                    arrow_png: "#%n-simple-arrow.png",
                    frame_gold_png: "#%n-simple-frame_gold.png",
                    frame_silver_png: "#%n-simple-frame_silver.png",
                    star_png: "#%n-simple-star.png",
                    tape_png: "#%n-simple-tape.png",
                    lock_png: "#%n-simple-lock.png",
                    closed_bg_png: "#%n-simple-closed_bg.png",
                    closed_bg_vertical_png: "#%n-simple-closed_bg_vertical.png",
                    lottery_en: "#%n-lottery-lottery_en.png",
                    lottery_ru: "#%n-lottery-lottery_ru.png",
                    ok_lottery: "#%n-lottery-ok_lottery.png",
                    ok_lottery_10k: "#%n-lottery-ok_lottery_10000.png",
                    vk_lottery: "#%n-lottery-vk_lottery.png",
                    bar_dailytask: "#%n-dailytasks-daily_task_bar.png",
                    bg_dailytask: "#%n-dailytasks-daily_task_bar_bg.png",
                    bg_vip: "#%n-vip_window-progress_background.png",
                    bar_vip: "#%n-vip_window-progressbar.png",
                    bg_dark_small: "#%n-progress_bar-bg_dark_small.png",
                    bg_dark: "#%n-progress_bar-bg_dark.png",
                    bg_dark_large: "#%n-progress_bar-bg_dark_large.png",
                    bg_green: "#%n-progress_bar-bg_green.png",
                    bg_green_large: "#%n-progress_bar-bg_green_large.png",
                    bar_red_small: "#%n-progress_bar-bar_red_small.png",
                    bar_orange_small: "#%n-progress_bar-bar_orange_small.png",
                    bar_blue_small: "#%n-progress_bar-bar_blue_small.png",
                    bar_red: "#%n-progress_bar-bar_red.png",
                    bar_orange: "#%n-progress_bar-bar_orange.png",
                    bar_blue: "#%n-progress_bar-bar_blue.png",
                    bar_green: "#%n-progress_bar-bar_green.png",
                    bar_red_large: "#%n-progress_bar-bar_red_large.png",
                    bar_orange_large: "#%n-progress_bar-bar_orange_large.png",
                    bar_blue_large: "#%n-progress_bar-bar_blue_large.png",
                    bar_green_large: "#%n-progress_bar-bar_green_large.png",
                    bar_simple: "#%n-simple-bar.png",
                    bg_simple: "#%n-simple-bar_bg.png",
                    bar_blue_large_round: "#%n-progress_bar-bar_blue_large_round.png",
                    pixel_png: "#%n-common-white_pixel.png",
                    badge: "#%n-promotion-badge.png",
                    booster_before_bg_png: "#%n-boosters_before-booster_before_bg.png",
                    booster_before_bg_off_png: "#%n-boosters_before-booster_before_bg_off.png",
                    booster_before_bg_on_png: "#%n-boosters_before-booster_before_bg_on.png",
                    booster_before_green_button_png: "#%n-boosters_before-booster_before_green_button.png",
                    booster_before_purple_button_png: "#%n-boosters_before-booster_before_purple_button.png",
                    booster_before_check_icon_png: "#%n-boosters_before-booster_before_check_icon.png",
                    booster_before_lock_png: "#%n-boosters_before-booster_before_lock.png",
                    booster_before_lantern_icon_png: "#%n-boosters_before-booster_before_lantern_icon.png",
                    booster_before_level_bg: "#%n-boosters_before-booster_before_level_bg.png"
                },
                important: ["click_effect", "window_effect"],
                priority: -1
            },
            menubar: {
                virtual: !0,
                injectTo: ["game", "daily_cup", "main"],
                frameIds: ["coin_png", "gold_png", "%n_bg_png", "bar_timer_png", "plus_button_png", "plus_button_on_png", "life_png", "unlim_png", "xmas_%n", "xmas_%n_level"],
                jsonIds: ["sparks_json"],
                soundIds: ["lives_fly_finish_effect", "coins_effect"]
            },
            metha_top_layer_0: {
                urls: {}
            },
            minesweeper: {
                urls: {}
            },
            minigame: {
                virtual: !0,
                injectTo: ["main"],
                jsonIds: ["%n_json"]
            },
            moves: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["%n_icon", "game_%n_icon"]
            },
            noconnection_window: {
                urls: {
                    png: "@%n-5bb72495b6.png",
                    json: "@%n-5db8aaedaf.json"
                },
                jsons: {
                    atlas: "@%n-5bb72495b6.atlas",
                    no_connection_json: "@no_connection-d9d32d5584.json"
                }
            },
            notification: {
                virtual: !0,
                injectTo: ["game", "main"],
                frameIds: ["icon", "%n_bg"],
                soundIds: ["task_done_sfx"]
            },
            pagination: {
                virtual: !0,
                injectTo: ["game"],
                jsonIds: ["%n_2_json", "%n_3_json"]
            },
            passruleswindow: {
                urls: {}
            },
            path: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["line_png"]
            },
            periodic_sale: {
                urls: {
                    bonussale_showup_effect: "~sounds/black_friday-da8da2f85f.mp3",
                    prize_view_created_effect: "~sounds/prize_view_created-bbf5f83c58.mp3",
                    png: "@%n-a4b7ca53bc.png",
                    json: "@%n-491627b785.json"
                },
                jsons: {
                    atlas: "@%n-a4b7ca53bc.atlas",
                    bonussale_bg: "@bonussale_bg-b029aebfbd.json",
                    flash_json: "@progress_bar_flash-db8d86b0ff.json",
                    plist: "@%n-a4b7ca53bc.plist",
                    prize_json: "@dt_present-270d89dd50.json",
                    prize_shine_json: "@prize_shine-79ec9db320.json",
                    shop_sparkles_large_json: "@shop_sparkles_large-200a55f070.json",
                    shuffle_json: "@replace-047fbf09bc.json",
                    undo_json: "@undo-d2995bab03.json"
                },
                frames: {
                    shop_gold_very_small_png: "#%n-tile_shop-shop_ruby_very_small.png",
                    shop_gold_small_png: "#%n-tile_shop-shop_ruby_small.png",
                    shop_gold_medium_png: "#%n-tile_shop-shop_ruby_medium.png",
                    shop_gold_large_png: "#%n-tile_shop-shop_ruby_large.png",
                    shop_gold_huge_png: "#%n-tile_shop-shop_ruby_huge.png",
                    sale_badge_png: "#%n-badge.png",
                    tile_bg: "#%n-bonus_sale_bg.png",
                    reward_title: "#%n-bonus_sale_tile_title.png",
                    bonus_sale_header: "#%n-bonus_sale_header.png",
                    bonus_product_decor1: "#%n-bonus_product_decor.png",
                    bonus_product_decor2: "#%n-bonus_product_decor2.png",
                    gold_small_png: "#%n-reward_icons-ruby_small.png",
                    coin_small_png: "#%n-reward_icons-coin_small.png",
                    reward_gold_png: "#%n-reward_icons-ruby.png",
                    reward_coin_png: "#%n-reward_icons-coin.png",
                    shop_gold_png: "#%n-reward_icons-ruby_shop.png",
                    shop_coin_png: "#%n-reward_icons-coin_shop.png",
                    bonussale_gift: "#%n-reward_icons-bonussale_gift.png",
                    life_png: "#%n-reward_icons-life.png",
                    life_small_png: "#%n-reward_icons-life_small.png",
                    life_unlim: "#%n-reward_icons-life_unlim.png",
                    life_unlim_small: "#%n-reward_icons-life_unlim_small.png",
                    simple_star_png: "#%n-reward_icons-simple_star.png",
                    booster_tile_shuffle_png: "#%n-reward_icons-booster_tile_shuffle.png",
                    booster_vacuum_png: "#%n-reward_icons-booster_vacuum.png",
                    booster_undo_png: "#%n-reward_icons-booster_undo.png",
                    underline_png: "#%n-underline-underline.png",
                    nostroke56pt_0: "#%n-marvin-round-nostroke-56pt-0.png",
                    nostroke56pt_1: "#%n-marvin-round-nostroke-56pt-1.png",
                    nostroke56pt_2: "#%n-marvin-round-nostroke-56pt-2.png",
                    nostroke56pt_3: "#%n-marvin-round-nostroke-56pt-3.png",
                    nostroke56pt_4: "#%n-marvin-round-nostroke-56pt-4.png",
                    nostroke56pt_5: "#%n-marvin-round-nostroke-56pt-5.png",
                    nostroke56pt_6: "#%n-marvin-round-nostroke-56pt-6.png",
                    nostroke56pt_7: "#%n-marvin-round-nostroke-56pt-7.png",
                    nostroke56pt_8: "#%n-marvin-round-nostroke-56pt-8.png",
                    nostroke56pt_9: "#%n-marvin-round-nostroke-56pt-9.png",
                    nostroke56pt_colon: "#%n-marvin-round-nostroke-56pt-colon.png",
                    nostroke56pt_slash: "#%n-marvin-round-nostroke-56pt-slash.png",
                    nostroke56pt_plus: "#%n-marvin-round-nostroke-56pt-plus.png",
                    nostroke56pt_minus: "#%n-marvin-round-nostroke-56pt-minus.png",
                    nostroke56pt_x: "#%n-marvin-round-nostroke-56pt-x.png",
                    nostroke56pt_space: "#%n-marvin-round-nostroke-56pt-space.png",
                    nostroke56pt_asterisk: "#%n-marvin-round-nostroke-56pt-asterisk.png",
                    nostroke56pt_percent: "#%n-marvin-round-nostroke-56pt-percent.png",
                    default41pt_0: "#%n-marvin-round-41pt-0.png",
                    default41pt_1: "#%n-marvin-round-41pt-1.png",
                    default41pt_2: "#%n-marvin-round-41pt-2.png",
                    default41pt_3: "#%n-marvin-round-41pt-3.png",
                    default41pt_4: "#%n-marvin-round-41pt-4.png",
                    default41pt_5: "#%n-marvin-round-41pt-5.png",
                    default41pt_6: "#%n-marvin-round-41pt-6.png",
                    default41pt_7: "#%n-marvin-round-41pt-7.png",
                    default41pt_8: "#%n-marvin-round-41pt-8.png",
                    default41pt_9: "#%n-marvin-round-41pt-9.png",
                    default41pt_colon: "#%n-marvin-round-41pt-colon.png",
                    default41pt_slash: "#%n-marvin-round-41pt-slash.png",
                    default41pt_plus: "#%n-marvin-round-41pt-plus.png",
                    default41pt_minus: "#%n-marvin-round-41pt-minus.png",
                    default41pt_x: "#%n-marvin-round-41pt-x.png",
                    default41pt_space: "#%n-marvin-round-41pt-space.png",
                    default41pt_asterisk: "#%n-marvin-round-41pt-asterisk.png",
                    default41pt_percent: "#%n-marvin-round-41pt-percent.png",
                    default56pt_0: "#%n-marvin-round-56pt-0.png",
                    default56pt_1: "#%n-marvin-round-56pt-1.png",
                    default56pt_2: "#%n-marvin-round-56pt-2.png",
                    default56pt_3: "#%n-marvin-round-56pt-3.png",
                    default56pt_4: "#%n-marvin-round-56pt-4.png",
                    default56pt_5: "#%n-marvin-round-56pt-5.png",
                    default56pt_6: "#%n-marvin-round-56pt-6.png",
                    default56pt_7: "#%n-marvin-round-56pt-7.png",
                    default56pt_8: "#%n-marvin-round-56pt-8.png",
                    default56pt_9: "#%n-marvin-round-56pt-9.png",
                    default56pt_colon: "#%n-marvin-round-56pt-colon.png",
                    default56pt_slash: "#%n-marvin-round-56pt-slash.png",
                    default56pt_plus: "#%n-marvin-round-56pt-plus.png",
                    default56pt_minus: "#%n-marvin-round-56pt-minus.png",
                    default56pt_x: "#%n-marvin-round-56pt-x.png",
                    default56pt_space: "#%n-marvin-round-56pt-space.png",
                    default56pt_asterisk: "#%n-marvin-round-56pt-asterisk.png",
                    default56pt_percent: "#%n-marvin-round-56pt-percent.png",
                    mark_png: "#%n-dailytasks-daily_task_check.png",
                    attention_png: "#%n-attention-attention.png",
                    button_png: "#%n-buttons-button.png",
                    button_on_png: "#%n-buttons-button_on.png",
                    button_disabled_png: "#%n-buttons-button_off.png",
                    small_button: "#%n-buttons-small_green_button.png",
                    small_button_on: "#%n-buttons-small_green_button_on.png",
                    small_button_off: "#%n-buttons-small_button_off.png",
                    blue_button_png: "#%n-buttons-button_blue.png",
                    blue_button_on_png: "#%n-buttons-button_blue_on.png",
                    small_blue_button: "#%n-buttons-small_blue_button.png",
                    small_blue_button_on: "#%n-buttons-small_blue_button_on.png",
                    red_button: "#%n-buttons-red_button.png",
                    red_button_on: "#%n-buttons-red_button_on.png",
                    help_button_png: "#%n-buttons-help_small.png",
                    help_button_on_png: "#%n-buttons-help_small_on.png",
                    help_button_off_png: "#%n-buttons-help_small_off.png",
                    sign_in_button_png: "#%n-buttons-sign_in_button.png",
                    sign_in_button_on_png: "#%n-buttons-sign_in_button_on.png",
                    vacuum_png: "#%n-buttons-vacuum.png",
                    gold_icon_png: "#%n-button_icons-ruby_icon.png",
                    coin_icon_png: "#%n-button_icons-coin_icon.png",
                    ad_icon_png: "#%n-button_icons-ad_icon.png",
                    ok_icon_png: "#%n-button_icons-ok_icon.png",
                    yandex_icon_png: "#%n-button_icons-yandex_icon.png",
                    playhop_icon_png: "#%n-button_icons-playhop_icon.png",
                    kred_icon_png: "#%n-button_icons-kred_icon.png",
                    badge_png: "#%n-tile_shop-badge.png",
                    badge_off_png: "#%n-tile_shop-badge_off.png",
                    bar_dailytask: "#%n-dailytasks-daily_task_bar.png",
                    bg_dailytask: "#%n-dailytasks-daily_task_bar_bg.png",
                    bg_vip: "#%n-vip_window-progress_background.png",
                    bar_vip: "#%n-vip_window-progressbar.png",
                    bg_dark_small: "#%n-progress_bar-bg_dark_small.png",
                    bg_dark: "#%n-progress_bar-bg_dark.png",
                    bg_dark_large: "#%n-progress_bar-bg_dark_large.png",
                    bg_green: "#%n-progress_bar-bg_green.png",
                    bg_green_large: "#%n-progress_bar-bg_green_large.png",
                    bar_red_small: "#%n-progress_bar-bar_red_small.png",
                    bar_orange_small: "#%n-progress_bar-bar_orange_small.png",
                    bar_blue_small: "#%n-progress_bar-bar_blue_small.png",
                    bar_red: "#%n-progress_bar-bar_red.png",
                    bar_orange: "#%n-progress_bar-bar_orange.png",
                    bar_blue: "#%n-progress_bar-bar_blue.png",
                    bar_green: "#%n-progress_bar-bar_green.png",
                    bar_red_large: "#%n-progress_bar-bar_red_large.png",
                    bar_orange_large: "#%n-progress_bar-bar_orange_large.png",
                    bar_blue_large: "#%n-progress_bar-bar_blue_large.png",
                    bar_green_large: "#%n-progress_bar-bar_green_large.png",
                    bar_simple: "#%n-simple-bar.png",
                    bg_simple: "#%n-simple-bar_bg.png",
                    bar_blue_large_round: "#%n-progress_bar-bar_blue_large_round.png"
                },
                important: ["bonussale_showup_effect"]
            },
            person_hero: {
                virtual: !0,
                injectTo: ["main"],
                jsonIds: ["hero_json"]
            },
            person_minimal_hero: {
                virtual: !0,
                injectTo: ["main"],
                jsonIds: ["hero_minimal_json"]
            },
            persons_main: {
                virtual: !0,
                injectTo: ["main"]
            },
            piggy_bank: {
                virtual: !0,
                injectTo: ["%n_window"],
                jsonIds: ["%n_json"]
            },
            piggy_bank_reward: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["%n_icon"],
                jsonIds: ["%n_json"]
            },
            piggy_bank_window: {
                urls: {
                    png: "@%n-2e5d0d40d7.png",
                    json: "@%n-ee6857cfaf.json"
                },
                jsons: {
                    atlas: "@%n-2e5d0d40d7.atlas",
                    piggy_bank_json: "@piggy_bank-c3cdd28d31.json"
                }
            },
            piggybankruleswindow: {
                urls: {
                    png: "@%n-d7aad0e84f.png",
                    json: "@%n-6aec5b6815.json"
                },
                jsons: {
                    arrows: "@guide_arrows-4ff7d68ca2.json",
                    atlas: "@%n-d7aad0e84f.atlas",
                    guide_stages: "@piggy_bank_rules-69580d489b.json"
                }
            },
            pixel: {
                virtual: !0,
                injectTo: ["wysiwyg", "game", "main"],
                frameIds: ["%n_png"]
            },
            prize: {
                virtual: !0,
                injectTo: ["periodic_sale", "main"],
                frameIds: ["mark_png"],
                jsonIds: ["%n_json", "%n_shine_json"],
                soundIds: ["%n_view_created_effect"]
            },
            progress_bar: {
                virtual: !0,
                injectTo: ["game", "vip_window", "periodic_sale", "main"],
                frameIds: ["bar_dailytask", "bg_dailytask", "bg_vip", "bar_vip", "bg_dark_small", "bg_dark", "bg_dark_large", "bg_green", "bg_green_large", "bar_red_small", "bar_orange_small", "bar_blue_small", "bar_red", "bar_orange", "bar_blue", "bar_green", "bar_red_large", "bar_orange_large", "bar_blue_large", "bar_green_large", "bar_simple", "bg_simple", "bar_blue_large_round"],
                jsonIds: ["flash_json"]
            },
            prolongation_window: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["goals_bg_png", "label_moves_png", "text_bg_png"],
                jsonIds: ["bonus_json", "label_moves_json", "timer_json", "bomb_timer_json"],
                soundIds: ["continue_effect", "timer_tick", "timer_tick_zero", "timer_start", "bomb_timer_tick", "bomb_timer_tick_zero", "bomb_timer_explosion"]
            },
            rate_window: {
                urls: {
                    png: "@%n-fc06c3808f.png",
                    json: "@%n-dbbafcf9ff.json"
                },
                jsons: {
                    atlas: "@%n-fc06c3808f.atlas",
                    plist: "@%n-fc06c3808f.plist"
                },
                frames: {
                    stars_png: "#%n-stars.png",
                    text_bg_png: "#%n-text_bg.png"
                }
            },
            request_center: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["send_coins_icon", "accept_stuck_coins_icon", "friend_message_bg_png", "send_life_icon"]
            },
            reward_element: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["%n_bg_png"],
                soundIds: ["reward_gold_effect"]
            },
            reward_icons: {
                virtual: !0,
                injectTo: ["admin", "game", "daily_cup", "tile_shop", "periodic_sale", "chain_sale", "main"],
                frameIds: ["gold_small_png", "coin_small_png", "reward_gold_png", "reward_coin_png", "shop_gold_png", "shop_coin_png", "bonussale_gift", "life_png", "life_small_png", "life_unlim", "life_unlim_small",
                    "simple_star_png", "booster_tile_shuffle_png", "booster_vacuum_png", "booster_undo_png"
                ]
            },
            scrollbar: {
                virtual: !0,
                injectTo: ["daily_cup", "chat", "main"],
                frameIds: ["%n_png"]
            },
            select_friend_window: {
                virtual: !0,
                injectTo: ["main"]
            },
            shares: {
                urls: {
                    default: "~%n/default.jpg",
                    default_en_1: "~%n/logo1-b31b7d93fc.jpg",
                    default_ru_1: "~%n/logo1-a9a55a318b.jpg",
                    victory_en_1: "~%n/victory1-befedc8b8d.jpg",
                    victory_en_2: "~%n/victory2-f2de3f0f16.jpg",
                    victory_en_3: "~%n/victory3-190dca2b06.jpg",
                    victory_ru_1: "~%n/victory1-07657e0eef.jpg",
                    victory_ru_2: "~%n/victory2-f2b3af581c.jpg",
                    victory_ru_3: "~%n/victory3-1d97aa9762.jpg"
                },
                convert: !1
            },
            sidebar: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["icon_bg", "lock", "icon_text_bg", "xmas_%n"],
                jsonIds: ["dailycup_icon_json", "piggybank_icon_json", "pack_icon_json", "pack1_icon_json", "pack2_icon_json", "invite_icon_json", "periodic_sale_json", "mission_letter_icon_json", "chain_sale_json"]
            },
            simple: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["arrow_png", "frame_gold_png", "frame_silver_png", "star_png",
                    "tape_png", "lock_png", "closed_bg_png", "closed_bg_vertical_png"
                ],
                jsonIds: ["star_json", "progress_bar_json", "avatar_spark_json", "progress_bar_spark_json"],
                soundIds: ["star_collect_effect", "%n_win_effect", "%n_transition_effect", "metha_present_effect", "%n_complete_bg_effect"]
            },
            simple_background_horizontal_0: {
                urls: {
                    background: "@background_horizontal_0-bb9c4a5901.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_1: {
                urls: {
                    background: "@background_horizontal_1-1cdb3fbeaa.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_10: {
                urls: {
                    background: "@background_horizontal_10-8aa53cbba4.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_11: {
                urls: {
                    background: "@background_horizontal_11-e4407b805e.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_12: {
                urls: {
                    background: "@background_horizontal_12-8ebf46b19a.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_13: {
                urls: {
                    background: "@background_horizontal_13-6619b5c776.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_14: {
                urls: {
                    background: "@background_horizontal_14-ce52ad8170.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_15: {
                urls: {
                    background: "@background_horizontal_15-682cbf9f99.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_16: {
                urls: {
                    background: "@background_horizontal_16-194a9dacb9.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_17: {
                urls: {
                    background: "@background_horizontal_17-4e69c37064.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_18: {
                urls: {
                    background: "@background_horizontal_18-551fca27e9.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_19: {
                urls: {
                    background: "@background_horizontal_19-926de17343.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_2: {
                urls: {
                    background: "@background_horizontal_2-fa66d43bb3.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_20: {
                urls: {
                    background: "@background_horizontal_20-c21cf5f5fc.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_21: {
                urls: {
                    background: "@background_horizontal_21-65220437eb.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_22: {
                urls: {
                    background: "@background_horizontal_22-d1b50b066a.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_23: {
                urls: {
                    background: "@background_horizontal_23-bae4d84a20.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_24: {
                urls: {
                    background: "@background_horizontal_24-1328fdfdf4.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_25: {
                urls: {
                    background: "@background_horizontal_25-df0e82baeb.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_26: {
                urls: {
                    background: "@background_horizontal_26-deb0424771.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_27: {
                urls: {
                    background: "@background_horizontal_27-20f2ddf61f.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_28: {
                urls: {
                    background: "@background_horizontal_28-75fca00c4f.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_29: {
                urls: {
                    background: "@background_horizontal_29-7284981dff.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_3: {
                urls: {
                    background: "@background_horizontal_3-f06fe05d81.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_30: {
                urls: {
                    background: "@background_horizontal_30-02c290dd83.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_31: {
                urls: {
                    background: "@background_horizontal_31-f0338a404e.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_32: {
                urls: {
                    background: "@background_horizontal_32-426cead94f.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_33: {
                urls: {
                    background: "@background_horizontal_33-69eb5f12eb.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_34: {
                urls: {
                    background: "@background_horizontal_34-cbb7a70500.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_35: {
                urls: {
                    background: "@background_horizontal_35-1d240b09c7.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_36: {
                urls: {
                    background: "@background_horizontal_36-e92e7620fe.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_37: {
                urls: {
                    background: "@background_horizontal_37-9ae99bcd08.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_38: {
                urls: {
                    background: "@background_horizontal_38-844d583592.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_39: {
                urls: {
                    background: "@background_horizontal_39-3078fbea73.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_4: {
                urls: {
                    background: "@background_horizontal_4-7e59a070bd.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_5: {
                urls: {
                    background: "@background_horizontal_5-20fbe2e0e6.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_6: {
                urls: {
                    background: "@background_horizontal_6-f2cd7fcfd2.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_7: {
                urls: {
                    background: "@background_horizontal_7-d7b10849db.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_8: {
                urls: {
                    background: "@background_horizontal_8-935ee548c6.jpg"
                },
                horizontal: !0
            },
            simple_background_horizontal_9: {
                urls: {
                    background: "@background_horizontal_9-14fee6c9cc.jpg"
                },
                horizontal: !0
            },
            simple_background_icon_0: {
                urls: {
                    icon: "@background_icon_0-36d002adc6.png"
                }
            },
            simple_background_icon_1: {
                urls: {
                    icon: "@background_icon_1-a023ba8e2f.png"
                }
            },
            simple_background_icon_10: {
                urls: {
                    icon: "@background_icon_10-efd5e4595e.png"
                }
            },
            simple_background_icon_11: {
                urls: {
                    icon: "@background_icon_11-f28cc7f643.png"
                }
            },
            simple_background_icon_12: {
                urls: {
                    icon: "@background_icon_12-b71c312bd7.png"
                }
            },
            simple_background_icon_13: {
                urls: {
                    icon: "@background_icon_13-f94a642e6b.png"
                }
            },
            simple_background_icon_14: {
                urls: {
                    icon: "@background_icon_14-c44b95886d.png"
                }
            },
            simple_background_icon_15: {
                urls: {
                    icon: "@background_icon_15-f1cea41c1c.png"
                }
            },
            simple_background_icon_16: {
                urls: {
                    icon: "@background_icon_16-9e11cbb85d.png"
                }
            },
            simple_background_icon_17: {
                urls: {
                    icon: "@background_icon_17-ae4eb44d28.png"
                }
            },
            simple_background_icon_18: {
                urls: {
                    icon: "@background_icon_18-774e143fb4.png"
                }
            },
            simple_background_icon_19: {
                urls: {
                    icon: "@background_icon_19-df0c2ca3a6.png"
                }
            },
            simple_background_icon_2: {
                urls: {
                    icon: "@background_icon_2-95496e0660.png"
                }
            },
            simple_background_icon_20: {
                urls: {
                    icon: "@background_icon_20-43a69cd46d.png"
                }
            },
            simple_background_icon_21: {
                urls: {
                    icon: "@background_icon_21-0a0aab32e6.png"
                }
            },
            simple_background_icon_22: {
                urls: {
                    icon: "@background_icon_22-aba45f79b7.png"
                }
            },
            simple_background_icon_23: {
                urls: {
                    icon: "@background_icon_23-3a6f9c2c33.png"
                }
            },
            simple_background_icon_24: {
                urls: {
                    icon: "@background_icon_24-8d163fe28f.png"
                }
            },
            simple_background_icon_25: {
                urls: {
                    icon: "@background_icon_25-f96444fb9f.png"
                }
            },
            simple_background_icon_26: {
                urls: {
                    icon: "@background_icon_26-96bb1e2d01.png"
                }
            },
            simple_background_icon_27: {
                urls: {
                    icon: "@background_icon_27-da0fa4ca05.png"
                }
            },
            simple_background_icon_28: {
                urls: {
                    icon: "@background_icon_28-15985a62e5.png"
                }
            },
            simple_background_icon_29: {
                urls: {
                    icon: "@background_icon_29-d00c429bd5.png"
                }
            },
            simple_background_icon_3: {
                urls: {
                    icon: "@background_icon_3-5851dc72a3.png"
                }
            },
            simple_background_icon_30: {
                urls: {
                    icon: "@background_icon_30-28b7299f70.png"
                }
            },
            simple_background_icon_31: {
                urls: {
                    icon: "@background_icon_31-32600518e3.png"
                }
            },
            simple_background_icon_32: {
                urls: {
                    icon: "@background_icon_32-46773733bb.png"
                }
            },
            simple_background_icon_33: {
                urls: {
                    icon: "@background_icon_33-4e7cc0e2cb.png"
                }
            },
            simple_background_icon_34: {
                urls: {
                    icon: "@background_icon_34-9580dd4021.png"
                }
            },
            simple_background_icon_35: {
                urls: {
                    icon: "@background_icon_35-b82cbc0e2c.png"
                }
            },
            simple_background_icon_36: {
                urls: {
                    icon: "@background_icon_36-1473583ef1.png"
                }
            },
            simple_background_icon_37: {
                urls: {
                    icon: "@background_icon_37-3be6133189.png"
                }
            },
            simple_background_icon_38: {
                urls: {
                    icon: "@background_icon_38-786b27584f.png"
                }
            },
            simple_background_icon_39: {
                urls: {
                    icon: "@background_icon_39-6eefc641bb.png"
                }
            },
            simple_background_icon_4: {
                urls: {
                    icon: "@background_icon_4-91a98b9447.png"
                }
            },
            simple_background_icon_5: {
                urls: {
                    icon: "@background_icon_5-f797eb2527.png"
                }
            },
            simple_background_icon_6: {
                urls: {
                    icon: "@background_icon_6-81f9fe07ba.png"
                }
            },
            simple_background_icon_7: {
                urls: {
                    icon: "@background_icon_7-2c20d66547.png"
                }
            },
            simple_background_icon_8: {
                urls: {
                    icon: "@background_icon_8-50ef612cc2.png"
                }
            },
            simple_background_icon_9: {
                urls: {
                    icon: "@background_icon_9-6f5268eb7a.png"
                }
            },
            simple_background_icon_coming_soon: {
                urls: {
                    icon: "@background_icon_coming_soon-c215c2d9e7.png"
                }
            },
            social_buttons: {
                urls: {
                    png: "@%n-bd18cff188.png",
                    json: "@%n-10c622b7ac.json"
                },
                jsons: {
                    atlas: "@%n-bd18cff188.atlas",
                    plist: "@%n-bd18cff188.plist"
                },
                frames: {
                    sign_in_apple: "#%n-buttons-sign_in_with_apple.png",
                    sign_in_facebook: "#%n-buttons-sign_in_with_facebook.png",
                    sign_in_google: "#%n-buttons-sign_in_with_google.png"
                }
            },
            socialicons: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["login_ok_icon_png", "login_vk_icon_png", "login_mm_icon_png", "login_fs_icon_png", "login_draugiem_icon_png", "login_mobage_icon_png", "login_plinga_icon_png", "login_kongregate_icon_png"]
            },
            sounds: {
                urls: {}
            },
            starter_pack: {
                urls: {
                    starter_pack_effect: "~sounds/%n-3b21378605.mp3",
                    png: "@%n-cd4a06037e.png",
                    json: "@%n-4e421135e4.json"
                },
                jsons: {
                    atlas: "@%n-cd4a06037e.atlas",
                    pack_json: "@%n-3041ccdf20.json",
                    plist: "@%n-cd4a06037e.plist",
                    shuffle_json: "@replace-047fbf09bc.json",
                    undo_json: "@undo-d2995bab03.json"
                },
                frames: {
                    underline_png: "#%n-underline-underline.png",
                    nostroke56pt_0: "#%n-marvin-round-nostroke-56pt-0.png",
                    nostroke56pt_1: "#%n-marvin-round-nostroke-56pt-1.png",
                    nostroke56pt_2: "#%n-marvin-round-nostroke-56pt-2.png",
                    nostroke56pt_3: "#%n-marvin-round-nostroke-56pt-3.png",
                    nostroke56pt_4: "#%n-marvin-round-nostroke-56pt-4.png",
                    nostroke56pt_5: "#%n-marvin-round-nostroke-56pt-5.png",
                    nostroke56pt_6: "#%n-marvin-round-nostroke-56pt-6.png",
                    nostroke56pt_7: "#%n-marvin-round-nostroke-56pt-7.png",
                    nostroke56pt_8: "#%n-marvin-round-nostroke-56pt-8.png",
                    nostroke56pt_9: "#%n-marvin-round-nostroke-56pt-9.png",
                    nostroke56pt_colon: "#%n-marvin-round-nostroke-56pt-colon.png",
                    nostroke56pt_slash: "#%n-marvin-round-nostroke-56pt-slash.png",
                    nostroke56pt_plus: "#%n-marvin-round-nostroke-56pt-plus.png",
                    nostroke56pt_minus: "#%n-marvin-round-nostroke-56pt-minus.png",
                    nostroke56pt_x: "#%n-marvin-round-nostroke-56pt-x.png",
                    nostroke56pt_space: "#%n-marvin-round-nostroke-56pt-space.png",
                    nostroke56pt_asterisk: "#%n-marvin-round-nostroke-56pt-asterisk.png",
                    nostroke56pt_percent: "#%n-marvin-round-nostroke-56pt-percent.png",
                    default41pt_0: "#%n-marvin-round-41pt-0.png",
                    default41pt_1: "#%n-marvin-round-41pt-1.png",
                    default41pt_2: "#%n-marvin-round-41pt-2.png",
                    default41pt_3: "#%n-marvin-round-41pt-3.png",
                    default41pt_4: "#%n-marvin-round-41pt-4.png",
                    default41pt_5: "#%n-marvin-round-41pt-5.png",
                    default41pt_6: "#%n-marvin-round-41pt-6.png",
                    default41pt_7: "#%n-marvin-round-41pt-7.png",
                    default41pt_8: "#%n-marvin-round-41pt-8.png",
                    default41pt_9: "#%n-marvin-round-41pt-9.png",
                    default41pt_colon: "#%n-marvin-round-41pt-colon.png",
                    default41pt_slash: "#%n-marvin-round-41pt-slash.png",
                    default41pt_plus: "#%n-marvin-round-41pt-plus.png",
                    default41pt_minus: "#%n-marvin-round-41pt-minus.png",
                    default41pt_x: "#%n-marvin-round-41pt-x.png",
                    default41pt_space: "#%n-marvin-round-41pt-space.png",
                    default41pt_asterisk: "#%n-marvin-round-41pt-asterisk.png",
                    default41pt_percent: "#%n-marvin-round-41pt-percent.png",
                    default56pt_0: "#%n-marvin-round-56pt-0.png",
                    default56pt_1: "#%n-marvin-round-56pt-1.png",
                    default56pt_2: "#%n-marvin-round-56pt-2.png",
                    default56pt_3: "#%n-marvin-round-56pt-3.png",
                    default56pt_4: "#%n-marvin-round-56pt-4.png",
                    default56pt_5: "#%n-marvin-round-56pt-5.png",
                    default56pt_6: "#%n-marvin-round-56pt-6.png",
                    default56pt_7: "#%n-marvin-round-56pt-7.png",
                    default56pt_8: "#%n-marvin-round-56pt-8.png",
                    default56pt_9: "#%n-marvin-round-56pt-9.png",
                    default56pt_colon: "#%n-marvin-round-56pt-colon.png",
                    default56pt_slash: "#%n-marvin-round-56pt-slash.png",
                    default56pt_plus: "#%n-marvin-round-56pt-plus.png",
                    default56pt_minus: "#%n-marvin-round-56pt-minus.png",
                    default56pt_x: "#%n-marvin-round-56pt-x.png",
                    default56pt_space: "#%n-marvin-round-56pt-space.png",
                    default56pt_asterisk: "#%n-marvin-round-56pt-asterisk.png",
                    default56pt_percent: "#%n-marvin-round-56pt-percent.png",
                    attention_png: "#%n-attention-attention.png",
                    button_png: "#%n-buttons-button.png",
                    button_on_png: "#%n-buttons-button_on.png",
                    button_disabled_png: "#%n-buttons-button_off.png",
                    small_button: "#%n-buttons-small_green_button.png",
                    small_button_on: "#%n-buttons-small_green_button_on.png",
                    small_button_off: "#%n-buttons-small_button_off.png",
                    blue_button_png: "#%n-buttons-button_blue.png",
                    blue_button_on_png: "#%n-buttons-button_blue_on.png",
                    small_blue_button: "#%n-buttons-small_blue_button.png",
                    small_blue_button_on: "#%n-buttons-small_blue_button_on.png",
                    red_button: "#%n-buttons-red_button.png",
                    red_button_on: "#%n-buttons-red_button_on.png",
                    help_button_png: "#%n-buttons-help_small.png",
                    help_button_on_png: "#%n-buttons-help_small_on.png",
                    help_button_off_png: "#%n-buttons-help_small_off.png",
                    sign_in_button_png: "#%n-buttons-sign_in_button.png",
                    sign_in_button_on_png: "#%n-buttons-sign_in_button_on.png",
                    vacuum_png: "#%n-buttons-vacuum.png",
                    gold_icon_png: "#%n-button_icons-ruby_icon.png",
                    coin_icon_png: "#%n-button_icons-coin_icon.png",
                    ad_icon_png: "#%n-button_icons-ad_icon.png",
                    ok_icon_png: "#%n-button_icons-ok_icon.png",
                    yandex_icon_png: "#%n-button_icons-yandex_icon.png",
                    playhop_icon_png: "#%n-button_icons-playhop_icon.png",
                    kred_icon_png: "#%n-button_icons-kred_icon.png",
                    default72pt_0: "#%n-marvin-round-72pt-0.png",
                    default72pt_1: "#%n-marvin-round-72pt-1.png",
                    default72pt_2: "#%n-marvin-round-72pt-2.png",
                    default72pt_3: "#%n-marvin-round-72pt-3.png",
                    default72pt_4: "#%n-marvin-round-72pt-4.png",
                    default72pt_5: "#%n-marvin-round-72pt-5.png",
                    default72pt_6: "#%n-marvin-round-72pt-6.png",
                    default72pt_7: "#%n-marvin-round-72pt-7.png",
                    default72pt_8: "#%n-marvin-round-72pt-8.png",
                    default72pt_9: "#%n-marvin-round-72pt-9.png",
                    default72pt_colon: "#%n-marvin-round-72pt-colon.png",
                    default72pt_slash: "#%n-marvin-round-72pt-slash.png",
                    default72pt_plus: "#%n-marvin-round-72pt-plus.png",
                    default72pt_minus: "#%n-marvin-round-72pt-minus.png",
                    default72pt_x: "#%n-marvin-round-72pt-x.png",
                    default72pt_space: "#%n-marvin-round-72pt-space.png",
                    default72pt_asterisk: "#%n-marvin-round-72pt-asterisk.png",
                    default72pt_percent: "#%n-marvin-round-72pt-percent.png",
                    default97pt_0: "#%n-marvin-round-97pt-0.png",
                    default97pt_1: "#%n-marvin-round-97pt-1.png",
                    default97pt_2: "#%n-marvin-round-97pt-2.png",
                    default97pt_3: "#%n-marvin-round-97pt-3.png",
                    default97pt_4: "#%n-marvin-round-97pt-4.png",
                    default97pt_5: "#%n-marvin-round-97pt-5.png",
                    default97pt_6: "#%n-marvin-round-97pt-6.png",
                    default97pt_7: "#%n-marvin-round-97pt-7.png",
                    default97pt_8: "#%n-marvin-round-97pt-8.png",
                    default97pt_9: "#%n-marvin-round-97pt-9.png",
                    default97pt_colon: "#%n-marvin-round-97pt-colon.png",
                    default97pt_slash: "#%n-marvin-round-97pt-slash.png",
                    default97pt_plus: "#%n-marvin-round-97pt-plus.png",
                    default97pt_minus: "#%n-marvin-round-97pt-minus.png",
                    default97pt_x: "#%n-marvin-round-97pt-x.png",
                    default97pt_space: "#%n-marvin-round-97pt-space.png",
                    default97pt_asterisk: "#%n-marvin-round-97pt-asterisk.png",
                    default97pt_percent: "#%n-marvin-round-97pt-percent.png"
                },
                important: ["starter_pack_effect"]
            },
            switch_state_button: {
                virtual: !0,
                injectTo: ["editor"],
                frameIds: ["%n"]
            },
            table: {
                virtual: !0,
                injectTo: ["daily_cup", "main"],
                frameIds: ["%n_bg_png", "amount_bg_png", "amount_bg_you_png", "row_player_png", "row_you_png", "badge_1", "badge_2", "badge_3", "prize_1", "prize_2", "prize_3", "prize_4",
                    "prize_5"
                ]
            },
            tablerow_icons: {
                virtual: !0,
                injectTo: ["daily_cup", "main"],
                frameIds: ["letter_mission"]
            },
            tabs: {
                virtual: !0,
                injectTo: ["tile_shop", "main"],
                frameIds: ["vertical_shop_tab_off", "vertical_shop_tab_on", "shop_tab_off", "shop_tab_on", "round_tab_bg", "round_tab_bg_selected", "dailytasks_icon", "achievements_icon"]
            },
            tile_shop: {
                urls: {
                    badge_appear_effect: "~sounds/badge_appear-7102ce72e2.mp3",
                    png: "@%n-84350f0add.png",
                    json: "@%n-9afd1cc33a.json"
                },
                jsons: {
                    ads_bubble_json: "@ad_bubble-116b67a48d.json",
                    atlas: "@%n-84350f0add.atlas",
                    plist: "@%n-84350f0add.plist",
                    shop_lives_animations_json: "@unlim_lives_animation-aa0871afc6.json",
                    shop_sparkles_large_json: "@shop_sparkles_large-200a55f070.json",
                    shuffle_json: "@replace-047fbf09bc.json",
                    undo_json: "@undo-d2995bab03.json"
                },
                frames: {
                    shop_title: "#%n-shop_title.png",
                    shop_title_off: "#%n-shop_title_off.png",
                    shop_tile_bg_png: "#%n-shop_bg_white.png",
                    shop_gold_very_small_png: "#%n-shop_ruby_very_small.png",
                    shop_gold_small_png: "#%n-shop_ruby_small.png",
                    shop_gold_medium_png: "#%n-shop_ruby_medium.png",
                    shop_gold_large_png: "#%n-shop_ruby_large.png",
                    shop_gold_huge_png: "#%n-shop_ruby_huge.png",
                    shop_coins_very_small_png: "#%n-shop_coins_very_small.png",
                    shop_coins_small_png: "#%n-shop_coins_small.png",
                    shop_coins_medium_png: "#%n-shop_coins_medium.png",
                    shop_coins_large_png: "#%n-shop_coins_large.png",
                    prem_crown: "#%n-prem_crown.png",
                    prem_tile_bg: "#%n-prem_substrate.png",
                    bonussale_decor: "#%n-blackfriday-bonussale_decor.png",
                    bonussale_badge: "#%n-blackfriday-bonussale_badge.png",
                    askLives_png: "#%n-life_friends.png",
                    refillLives_5_png: "#%n-life_5.png",
                    unlimitedLives_png: "#%n-life_infinity.png",
                    lives_for_video_png: "#%n-lives_for_video.png",
                    life_1_png: "#%n-life_1.png",
                    gold_small_png: "#%n-reward_icons-ruby_small.png",
                    coin_small_png: "#%n-reward_icons-coin_small.png",
                    reward_gold_png: "#%n-reward_icons-ruby.png",
                    reward_coin_png: "#%n-reward_icons-coin.png",
                    shop_gold_png: "#%n-reward_icons-ruby_shop.png",
                    shop_coin_png: "#%n-reward_icons-coin_shop.png",
                    bonussale_gift: "#%n-reward_icons-bonussale_gift.png",
                    life_png: "#%n-reward_icons-life.png",
                    life_small_png: "#%n-reward_icons-life_small.png",
                    life_unlim: "#%n-reward_icons-life_unlim.png",
                    life_unlim_small: "#%n-reward_icons-life_unlim_small.png",
                    simple_star_png: "#%n-reward_icons-simple_star.png",
                    booster_tile_shuffle_png: "#%n-reward_icons-booster_tile_shuffle.png",
                    booster_vacuum_png: "#%n-reward_icons-booster_vacuum.png",
                    booster_undo_png: "#%n-reward_icons-booster_undo.png",
                    underline_png: "#%n-underline-underline.png",
                    nostroke56pt_0: "#%n-marvin-round-nostroke-56pt-0.png",
                    nostroke56pt_1: "#%n-marvin-round-nostroke-56pt-1.png",
                    nostroke56pt_2: "#%n-marvin-round-nostroke-56pt-2.png",
                    nostroke56pt_3: "#%n-marvin-round-nostroke-56pt-3.png",
                    nostroke56pt_4: "#%n-marvin-round-nostroke-56pt-4.png",
                    nostroke56pt_5: "#%n-marvin-round-nostroke-56pt-5.png",
                    nostroke56pt_6: "#%n-marvin-round-nostroke-56pt-6.png",
                    nostroke56pt_7: "#%n-marvin-round-nostroke-56pt-7.png",
                    nostroke56pt_8: "#%n-marvin-round-nostroke-56pt-8.png",
                    nostroke56pt_9: "#%n-marvin-round-nostroke-56pt-9.png",
                    nostroke56pt_colon: "#%n-marvin-round-nostroke-56pt-colon.png",
                    nostroke56pt_slash: "#%n-marvin-round-nostroke-56pt-slash.png",
                    nostroke56pt_plus: "#%n-marvin-round-nostroke-56pt-plus.png",
                    nostroke56pt_minus: "#%n-marvin-round-nostroke-56pt-minus.png",
                    nostroke56pt_x: "#%n-marvin-round-nostroke-56pt-x.png",
                    nostroke56pt_space: "#%n-marvin-round-nostroke-56pt-space.png",
                    nostroke56pt_asterisk: "#%n-marvin-round-nostroke-56pt-asterisk.png",
                    nostroke56pt_percent: "#%n-marvin-round-nostroke-56pt-percent.png",
                    default41pt_0: "#%n-marvin-round-41pt-0.png",
                    default41pt_1: "#%n-marvin-round-41pt-1.png",
                    default41pt_2: "#%n-marvin-round-41pt-2.png",
                    default41pt_3: "#%n-marvin-round-41pt-3.png",
                    default41pt_4: "#%n-marvin-round-41pt-4.png",
                    default41pt_5: "#%n-marvin-round-41pt-5.png",
                    default41pt_6: "#%n-marvin-round-41pt-6.png",
                    default41pt_7: "#%n-marvin-round-41pt-7.png",
                    default41pt_8: "#%n-marvin-round-41pt-8.png",
                    default41pt_9: "#%n-marvin-round-41pt-9.png",
                    default41pt_colon: "#%n-marvin-round-41pt-colon.png",
                    default41pt_slash: "#%n-marvin-round-41pt-slash.png",
                    default41pt_plus: "#%n-marvin-round-41pt-plus.png",
                    default41pt_minus: "#%n-marvin-round-41pt-minus.png",
                    default41pt_x: "#%n-marvin-round-41pt-x.png",
                    default41pt_space: "#%n-marvin-round-41pt-space.png",
                    default41pt_asterisk: "#%n-marvin-round-41pt-asterisk.png",
                    default41pt_percent: "#%n-marvin-round-41pt-percent.png",
                    default56pt_0: "#%n-marvin-round-56pt-0.png",
                    default56pt_1: "#%n-marvin-round-56pt-1.png",
                    default56pt_2: "#%n-marvin-round-56pt-2.png",
                    default56pt_3: "#%n-marvin-round-56pt-3.png",
                    default56pt_4: "#%n-marvin-round-56pt-4.png",
                    default56pt_5: "#%n-marvin-round-56pt-5.png",
                    default56pt_6: "#%n-marvin-round-56pt-6.png",
                    default56pt_7: "#%n-marvin-round-56pt-7.png",
                    default56pt_8: "#%n-marvin-round-56pt-8.png",
                    default56pt_9: "#%n-marvin-round-56pt-9.png",
                    default56pt_colon: "#%n-marvin-round-56pt-colon.png",
                    default56pt_slash: "#%n-marvin-round-56pt-slash.png",
                    default56pt_plus: "#%n-marvin-round-56pt-plus.png",
                    default56pt_minus: "#%n-marvin-round-56pt-minus.png",
                    default56pt_x: "#%n-marvin-round-56pt-x.png",
                    default56pt_space: "#%n-marvin-round-56pt-space.png",
                    default56pt_asterisk: "#%n-marvin-round-56pt-asterisk.png",
                    default56pt_percent: "#%n-marvin-round-56pt-percent.png",
                    attention_png: "#%n-attention-attention.png",
                    button_png: "#%n-buttons-button.png",
                    button_on_png: "#%n-buttons-button_on.png",
                    button_disabled_png: "#%n-buttons-button_off.png",
                    small_button: "#%n-buttons-small_green_button.png",
                    small_button_on: "#%n-buttons-small_green_button_on.png",
                    small_button_off: "#%n-buttons-small_button_off.png",
                    blue_button_png: "#%n-buttons-button_blue.png",
                    blue_button_on_png: "#%n-buttons-button_blue_on.png",
                    small_blue_button: "#%n-buttons-small_blue_button.png",
                    small_blue_button_on: "#%n-buttons-small_blue_button_on.png",
                    red_button: "#%n-buttons-red_button.png",
                    red_button_on: "#%n-buttons-red_button_on.png",
                    help_button_png: "#%n-buttons-help_small.png",
                    help_button_on_png: "#%n-buttons-help_small_on.png",
                    help_button_off_png: "#%n-buttons-help_small_off.png",
                    sign_in_button_png: "#%n-buttons-sign_in_button.png",
                    sign_in_button_on_png: "#%n-buttons-sign_in_button_on.png",
                    vacuum_png: "#%n-buttons-vacuum.png",
                    gold_icon_png: "#%n-button_icons-ruby_icon.png",
                    coin_icon_png: "#%n-button_icons-coin_icon.png",
                    ad_icon_png: "#%n-button_icons-ad_icon.png",
                    ok_icon_png: "#%n-button_icons-ok_icon.png",
                    yandex_icon_png: "#%n-button_icons-yandex_icon.png",
                    playhop_icon_png: "#%n-button_icons-playhop_icon.png",
                    kred_icon_png: "#%n-button_icons-kred_icon.png",
                    vertical_shop_tab_off: "#%n-tabs-vertical_tab_off.png",
                    vertical_shop_tab_on: "#%n-tabs-vertical_tab_on.png",
                    shop_tab_off: "#%n-tabs-tab_off.png",
                    shop_tab_on: "#%n-tabs-tab_on.png",
                    round_tab_bg: "#%n-tab_bg.png",
                    round_tab_bg_selected: "#%n-tab_bg_selected.png",
                    dailytasks_icon: "#%n-tabs-tasks.png",
                    achievements_icon: "#%n-tabs-achievements.png",
                    timer_png: "#%n-timer-timer.png",
                    timer_bg_png: "#%n-timer-timer_bg.png",
                    badge_png: "#%n-badge.png",
                    badge_off_png: "#%n-badge_off.png",
                    lottery_en: "#%n-lottery-lottery_en.png",
                    lottery_ru: "#%n-lottery-lottery_ru.png",
                    ok_lottery: "#%n-lottery-ok_lottery.png",
                    ok_lottery_10k: "#%n-lottery-ok_lottery_10000.png",
                    vk_lottery: "#%n-lottery-vk_lottery.png"
                },
                important: ["badge_appear_effect"]
            },
            tiles_unlock_window: {
                urls: {
                    png: "@%n-b955c05a24.png",
                    json: "@%n-e001a52b2a.json"
                },
                jsons: {
                    atlas: "@%n-b955c05a24.atlas",
                    tiles_unlock_json: "@%n-f8c54029dc.json"
                }
            },
            timer: {
                virtual: !0,
                injectTo: ["game", "daily_cup", "tile_shop", "main"],
                frameIds: ["%n_png", "%n_bg_png"]
            },
            toolbar: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["%n_bg_png", "%n_dailybonus_icon_png", "%n_daily_tasks_icon_png", "%n_mail_icon_png", "%n_leader_board_icon_png", "%n_rewarded_video_icon_png", "xmas_%n"]
            },
            tooltip: {
                virtual: !0,
                injectTo: ["game", "main"],
                frameIds: ["%n_bg_png", "%n_shadow_arrow_png", "%n_arrow_png"]
            },
            tournament_icon: {
                virtual: !0,
                injectTo: ["game"],
                frameIds: ["mission_letter_png"]
            },
            transition: {
                virtual: !0,
                injectTo: ["main"],
                jsonIds: ["%n_curtains_json", "%n_person_json"]
            },
            treasurebag: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["%n_bg_png"],
                jsonIds: ["%n_json"]
            },
            victory_window: {
                virtual: !0,
                injectTo: ["game"],
                soundIds: ["win_effect"]
            },
            vip_window: {
                urls: {
                    png: "@%n-5c7922284d.png",
                    json: "@%n-9e2527e533.json"
                },
                jsons: {
                    atlas: "@%n-5c7922284d.atlas",
                    flash_json: "@progress_bar_flash-db8d86b0ff.json",
                    plist: "@%n-5c7922284d.plist",
                    vip_icon_json: "@vip-4c0f9f1595.json"
                },
                frames: {
                    bar_dailytask: "#%n-dailytasks-daily_task_bar.png",
                    bg_dailytask: "#%n-dailytasks-daily_task_bar_bg.png",
                    bg_vip: "#%n-progress_background.png",
                    bar_vip: "#%n-progressbar.png",
                    bg_dark_small: "#%n-progress_bar-bg_dark_small.png",
                    bg_dark: "#%n-progress_bar-bg_dark.png",
                    bg_dark_large: "#%n-progress_bar-bg_dark_large.png",
                    bg_green: "#%n-progress_bar-bg_green.png",
                    bg_green_large: "#%n-progress_bar-bg_green_large.png",
                    bar_red_small: "#%n-progress_bar-bar_red_small.png",
                    bar_orange_small: "#%n-progress_bar-bar_orange_small.png",
                    bar_blue_small: "#%n-progress_bar-bar_blue_small.png",
                    bar_red: "#%n-progress_bar-bar_red.png",
                    bar_orange: "#%n-progress_bar-bar_orange.png",
                    bar_blue: "#%n-progress_bar-bar_blue.png",
                    bar_green: "#%n-progress_bar-bar_green.png",
                    bar_red_large: "#%n-progress_bar-bar_red_large.png",
                    bar_orange_large: "#%n-progress_bar-bar_orange_large.png",
                    bar_blue_large: "#%n-progress_bar-bar_blue_large.png",
                    bar_green_large: "#%n-progress_bar-bar_green_large.png",
                    bar_simple: "#%n-simple-bar.png",
                    bg_simple: "#%n-simple-bar_bg.png",
                    bar_blue_large_round: "#%n-progress_bar-bar_blue_large_round.png"
                }
            },
            windows: {
                virtual: !0,
                injectTo: ["main"],
                frameIds: ["window_bg_png", "window_title_bg_secondary_png", "%n_group_bg_png", "%n_details_bg_png", "editbox_bg_png", "ads_bg", "ads_alpha", "ads_beta", "ads_gamma", "window_foreground_png", "details_rings", "tile_bg_png", "tile_amount_png"],
                jsonIds: ["present_json", "xmas_window", "xmas_window_title", "shadow_liana_left", "shadow_liana_right", "aquatic_flower"]
            }
        },
        resolutions = {
            high: {
                scale: 1,
                id: "high",
                height: 1334,
                webp: !0
            },
            h1200: {
                scale: .9,
                id: "h1200",
                height: 1200,
                webp: !0
            },
            h1000: {
                scale: .75,
                id: "h1000",
                height: 1e3,
                depth: 6
            },
            h800: {
                scale: .6,
                id: "h800",
                height: 800,
                webp: !0
            },
            low: {
                scale: .5,
                id: "low",
                height: 667,
                depth: 6
            }
        },
        unmifiyBundlesRec = function (e, t, s) {
            var i = e[t];
            if ("object" == typeof i) {
                if ("episode" !== t || t === s)
                    for (var n in i) unmifiyBundlesRec(i, n, s)
            } else "string" == typeof i && (i = (i = (i = i.replace("@", "~%n/%r/")).replace("~", "res/packed/")).replace(/%n/g, s), "undefined" != typeof unpackedBundles && unpackedBundles[s] && ("undefined" == typeof unpackedMap && (unpackedMap = {}), unpackedBundles[s][e[t]] && (unpackedMap[i] = unpackedBundles[s][e[t]])), e[t] = i)
        },
        isVirtualLink = function (e) {
            return "string" == typeof e && "@" === e.charAt(0)
        },
        createVirtualLink = function (e, t, s) {
            return "@" + e + "#" + s + "#" + t
        },
        parseVirtualLink = function (e) {
            return {
                bundle: e.substr(1, e.indexOf("#") - 1),
                id: e.substr(e.lastIndexOf("#") + 1)
            }
        },
        processVirtualUrl = function (e) {
            if (!isVirtualLink(e)) return cleverapps.skins.getLink(e);
            var t, s = parseVirtualLink(e),
                i = bundles[s.bundle],
                n = !1;
            for (t in i.injectTo) {
                var o = i.injectTo[t];
                if (cleverapps.bundleLoader.isLoaded(o)) {
                    if (bundles[o].urls[s.id]) return cleverapps.skins.getLink(bundles[o].urls[s.id]);
                    n = !0
                }
            }
            if (!n) {
                e = "no urlId " + e + " for bundle " + s.bundle;
                if (console.log(e), cleverapps.config.debugMode) throw e
            }
        },
        getVirtualLinkType = function (e) {
            return e.split("#")[1]
        },
        processVirtualFrame = (processVirtualImage = function (e, t) {
            if (!isVirtualLink(e)) return cleverapps.skins.getLink(e);
            var s = getVirtualLinkType(e);
            return "frame" === s ? processVirtualFrame(e, t) : "url" === s ? processVirtualUrl(e) : void 0
        }, function (e, t) {
            if (!isVirtualLink(e)) return cleverapps.skins.getLink(e);
            var s, i, n, o = parseVirtualLink(e),
                e = bundles[o.bundle],
                a = e.injectTo,
                r = (Array.isArray(t) && 0 < t.length && (Game.currentGame && Game.currentGame.map && (s = Game.currentGame.map.tilesTexture, i = Game.currentGame.map.unitsTexture), t = t.reduce(function (e, t) {
                    return s && ("tiles" === t ? t = s || t : "units" === t && (t = i || t)), e[t] = !0, e
                }, {}), a = a.filter(function (e) {
                    return t[e]
                }).concat(a)), !1);
            for (n in a) {
                var c = a[n];
                if (cleverapps.bundleLoader.isLoaded(c)) {
                    if (bundles[c].frames[o.id]) return cleverapps.skins.getLink(bundles[c].frames[o.id]);
                    r = !0
                }
            }
            if (!r) {
                e = "not loaded " + e.injectTo.join(";") + " for bundle " + o.bundle;
                if (console.log(e), cleverapps.config.debugMode) throw e
            }
        }),
        processInlineJSONs = (processVirtualJson = function (e) {
            if (!isVirtualLink(e)) return cleverapps.skins.getLink(e);
            var t, s = parseVirtualLink(e),
                i = bundles[s.bundle],
                n = !1;
            for (t in i.injectTo) {
                var o = i.injectTo[t];
                if (cleverapps.bundleLoader.isLoaded(o)) {
                    if (bundles[o].jsons[s.id]) return cleverapps.skins.getLink(bundles[o].jsons[s.id]);
                    n = !0
                }
            }
            if (!n) {
                e = "not loaded " + i.injectTo.join(";") + " for bundle " + s.bundle;
                if (console.log(e), cleverapps.config.debugMode) throw e
            }
        }, function (e) {
            for (var t in e.jsons) {
                var s, i = e.jsons[t];
                i.inline && (s = JSON.parse(i.data), i = i.url, cc.loader.cache[i] = s, e.jsons[t] = i)
            }
        }),
        unminifyBundles = function (e) {
            for (var t in e = e || Object.keys(bundles)) {
                var s = e[t],
                    i = (unmifiyBundlesRec(bundles, s, s), bundles[s].frames || (
                        bundles[s].frames = {}), bundles[s].jsons || (bundles[s].jsons = {}), processInlineJSONs(bundles[s]), bundles[s]);
                i.urls = i.urls || {}, i.injectTo && i.frameIds && (i.frameIds.forEach(function (e) {
                    i.frames[e] = createVirtualLink(s, e, "frame")
                }), delete i.frameIds), i.injectTo && i.jsonIds && (i.jsonIds.forEach(function (e) {
                    i.jsons[e] = createVirtualLink(s, e, "json")
                }), delete i.jsonIds), i.injectTo && i.soundIds && (i.soundIds.forEach(function (e) {
                    i.urls[e] = createVirtualLink(s, e, "url")
                }), delete i.soundIds), i.injectTo && i.unpackedIds && (i.unpackedIds.forEach(function (e) {
                    i.urls[e] = createVirtualLink(s, e, "url")
                }), delete i.unpackedIds)
            }
            for (t in "undefined" != typeof unpackedBundles && (unpackedBundles = void 0), ResourceProcessor.addStaticUrl(), e) s = e[t], (i = bundles[s]).important && (i.important = cleverapps.createSet(i.important.map(function (e) {
                return i.urls[e]
            })))
        },
        Bundle = (unminifyBundles(), function (e) {
            this.name = e, this.data = bundles[e]
        }),
        BundleLoader = (Bundle.prototype.onLoad = function (e) {
            e = e || function () { };
            var t, s = cc.loader.getRes(
                this.data.urls.json);
            for (t in s) {
                var i = this.data.jsons[t],
                    n = s[t];
                if ("string" == typeof i && ".plist" === cc.path.extname(i)) try {
                    n = cc.plistParser.parse(n)
                } catch (e) {
                    throw "Parse " + i + " " + this.data.urls.json + " error " + e
                }
                cc.loader.cache[i] = n
            }
            this.data.jsons.plist && cc.spriteFrameCache.addSpriteFrames(this.data.jsons.plist, this.data.urls.png), cc.loader.release(this.data.urls.json), e()
        }, Bundle.prototype.onUnload = function () {
            for (var e in this.data.jsons.plist && (cc.spriteFrameCache.removeSpriteFramesFromFile(this.data.jsons.plist), delete cc.spriteFrameCache._frameConfigCache[this.data.jsons.plist]), this.data.jsons) {
                e = this.data.jsons[e];
                cc.loader.release(e), delete cleverapps.Spine.cache[e]
            }
        }, Bundle.prototype.isResourceSound = function (e) {
            return !!e && (e.music || "string" == typeof e && (-1 !== e.indexOf("/sfx/") || -1 !== e.indexOf(".mp3")))
        }, Bundle.prototype.listSoundUrls = function () {
            return cc.sys.isWebViewAudio || cleverapps.config.debugMode && "important_only" === cleverapps.DataLoader.load(
                cleverapps.DataLoaderTypes.TEST_SOUNDS) ? [] : cleverapps.values(this.data.urls).filter(function (e) {
                    return this.isResourceSound(e) && !isVirtualLink(e) && !this.isImportantSound(e)
                }.bind(this))
        }, Bundle.prototype.listUrls = function () {
            return cleverapps.values(this.data.urls).filter(function (e) {
                if ("playable" === cleverapps.config.source) {
                    if ("string" == typeof e && (void 0 !== cc.loader.cache[e] || -1 !== e.indexOf(".json"))) return !1;
                    if (e && "font" === e.type) return !1
                }
                return !(this.isResourceSound(e) && (cc.sys.isWebViewAudio || !this.isImportantSound(e))) && !isVirtualLink(e)
            }.bind(this))
        }, Bundle.prototype.isImportantSound = function (e) {
            return !(!cleverapps.config.debugMode || "wait_all" !== cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.TEST_SOUNDS)) || this.data.important && this.data.important[e]
        }, Bundle.prototype.listJsons = function () {
            return cleverapps.values(this.data.jsons)
        }, Bundle.prototype.injectTo = function (t) {
            ["urls", "frames", "jsons"].forEach(function (e) {
                Object.assign(t, this.data[e])
            }, this)
        }, function () {
            this.handles = {}, this.blockedCounter = 0, this.unusedResources = {}, this.unusedBundles = {}, this.waitWindow = void 0
        }),
        LogTimeStart = (BundleLoader.prototype.addBlockWindow = function () {
            0 === this.blockedCounter && (!cleverapps.scenes.getRunningScene() || cleverapps.environment.isLoaderScene() || this.waitWindow || cleverapps.config.wysiwygMode || (this.waitWindow = new WaitWindow)), this.blockedCounter++
        }, BundleLoader.prototype.removeBlockWindow = function () {
            this.blockedCounter--, this.blockedCounter <= 0 && this.waitWindow && (this.waitWindow.close(), this.waitWindow = void 0)
        }, BundleLoader.prototype.onFailure = function (e, t) {
            var s = this.getHandle(e),
                i = s && s.onFailures;
            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.FAIL_BUNDLE + e), s && s.blocked ? (this.waitWindow && (this.waitWindow.close(), this.waitWindow = !1), new RestartWindow) : this.deleteBundle(e, !0), cleverapps.versionChecker.isClientVersionActual() && !cleverapps.config.debugMode && cleverapps.checkStatus(t, 404) && setTimeout(function () {
                throw "load actual bundle " + e + " 404 error"
            }, 0), i && i.forEach(function (e) {
                e(t)
            })
        }, BundleLoader.prototype.loadBundles = function (e, t) {
            for (var s = (t = t || {}).onSuccess || function () { }, i = t.onFailure, n = cleverapps.wait(e.length || 0, s), i = i && cleverapps.once(i), o = 0; o < e.length; o++) {
                var a = {
                    onSuccess: n,
                    onFailure: i,
                    blocked: t.blocked
                };
                this.loadBundle(e[o], a)
            }
        }, BundleLoader.prototype.getHandle = function (e) {
            return this.handles[e]
        }, BundleLoader.prototype.countLoaded = function (e) {
            if (Array.isArray(e)) return e.filter(function (e) {
                return this.countLoaded(e)
            }.bind(this)).length;
            if (bundles[e] && bundles[e].injectTo) return this.isVirtualLoaded(e);
            e = this.getHandle(e);
            return e && e.loaded ? 1 : 0
        }, BundleLoader.prototype.isLoaded = function (e) {
            return Array.isArray(e) || (e = [e]), this.countLoaded(e) === e.length
        }, BundleLoader.prototype.isVirtualLoaded = function (e) {
            var t, s = bundles[e];
            for (t in s.injectTo)
                if (cleverapps.bundleLoader.isLoaded(s.injectTo[t])) return !0;
            return !1
        }, BundleLoader.prototype.loadBundle = function (i, e) {
            var n = bundles[i],
                t = this.getHandle(i),
                s = (e = e || {}).onSuccess,
                o = e.onFailure,
                e = e.blocked;
            if (cleverapps.resolution.isInitialized() || cleverapps.throwAsync("Can't load urls while resolution is not defined"), n.virtual || n.stored) s && s(n);
            else {
                if (t) return t.counter++, void (t.loaded ? s && s(n) : (s && t.onSuccesses.push(s), o && t.onFailures.push(o), !t.blocked && e && (t.blocked = !0, this.addBlockWindow())));
                var a = [],
                    t = (s && (a = Array.isArray(s) ? s : [s]), []),
                    r = (o && (t = Array.isArray(o) ? o : [o]), {
                        loaded: !1,
                        counter: 1,
                        onSuccesses: a,
                        onFailures: t,
                        blocked: e
                    }),
                    c = (this.handles[i] = r, e && this.addBlockWindow(), r.onLoadedUrls = cleverapps.once(function () {
                        r.loaded = !0, r.blocked && this.removeBlockWindow(), new Bundle(i).onLoad(function () {
                            for (var e = 0; e < r.onSuccesses.length; e++) a[e].call(this, n);
                            delete r.onSuccesses, delete r.onFailures, delete r.blocked
                        })
                    }.bind(this)), 3),
                    l = function () {
                        var e, t, s;
                        this.getHandle(i) && (e = cc.game.config.noCache, n.unpacked && (cc.game.config.noCache = !0), t = new Bundle(i).listUrls(), s = new Bundle(i).listSoundUrls(), cc.loader.load(t, function (e) {
                            e ? (console.log("load failed", e,
                                JSON.stringify(new Bundle(i).listUrls())), c <= 1 || cleverapps.checkStatus(e, 404) ? cleverapps.versionChecker.loadClientVersion(function () {
                                    this.onFailure(i, e)
                                }.bind(this)) : (c--, l())) : (r.onLoadedUrls(), s.length && cc.loader.load(s, function () {
                                    cleverapps.audio.onSoundsLoaded(s)
                                }))
                        }.bind(this)), cc.game.config.noCache = e)
                    }.bind(this);
                l()
            }
        }, BundleLoader.prototype.cacheBundles = function (e) {
            e = cleverapps.toArray(e), cleverapps.bundleLoader.loadBundles(e, {
                onSuccess: function () {
                    cleverapps.bundleLoader.deleteBundles(e)
                }
            })
        }, BundleLoader.prototype.checkUrlUseInLoadedBundles = function (e) {
            for (var t in this.handles) {
                var s, t = new Bundle(t),
                    i = t.listUrls().concat(t.listSoundUrls());
                for (s in i)
                    if (i[s] === e) return !0
            }
            return !1
        }, BundleLoader.prototype.deleteBundles = function (e) {
            if (e)
                for (var t = 0; t < e.length; t++) this.deleteBundle(e[t])
        }, BundleLoader.prototype.deleteBundle = function (e, t) {
            var s = this.handles[e];
            if (void 0 !== s && -1 === ["main", "episodes_resources"].indexOf(e) && (s.counter--, !(0 < s.counter || (0 === e.indexOf("enemy") && (
                this.deleteStack || (this.deleteStack = {}), this.deleteStack[e] = (new Error).stack), bundles[e].stored)))) {
                t || s.loaded || !s.blocked || console.log("Remove blocked loading bundle (maybe error!)", e), s.loaded && this.clearOverrides(s);
                var i, t = new Bundle(e),
                    n = t.listUrls().concat(t.listSoundUrls());
                for (i in s.onLoadedUrls = function () { }, delete this.handles[e], n) {
                    var o = n[i];
                    this.checkUrlUseInLoadedBundles(o) || (this.unusedResources[o] = !0)
                }
                this.unusedBundles[e] = !0
            }
        }, BundleLoader.prototype.override = function (e, t, s, i) {
            e.overrides = e.overrides || new OverridesContainer, e.overrides.override(t, s, i)
        }, BundleLoader.prototype.clearOverrides = function (e) {
            e.overrides && (e.unoverride(), delete e.overrides)
        }, BundleLoader.prototype.isUnused = function (e) {
            return !this.isLoaded(e) && this.unusedBundles[e]
        }, BundleLoader.prototype.clearUnusedResources = function () {
            if (0 !== Object.keys(this.unusedBundles).length) {
                var e, t;
                for (e in this.unusedResources) this.checkUrlUseInLoadedBundles(e) || ((t = cc.textureCache.getTextureForKey(e)) && (
                    cc.spriteFrameCache.removeSpriteFramesFromTexture(t), cc.textureCache.removeTextureForKey(e)), cc.loader.release(e));
                this.unusedResources = {}, Object.keys(this.unusedBundles).forEach(function (e) {
                    bundles[e].injectTo || this.handles[e] || new Bundle(e).onUnload()
                }.bind(this)), this.unusedBundles = {}
            }
        }, BundleLoader.prototype.isAllLoaded = function (e) {
            var t = function (e) {
                var t = bundles[e];
                if (this.isLoaded(e) || !t || t.unpacked && t.episode) return !0;
                t = new Bundle(e).listUrls();
                return t.filter(function (e) {
                    return cc.loader.cache[e]
                }).length === t.length
            }.bind(this);
            return e.filter(t).length === e.length
        }, cleverapps.RestClient = {
            getBase: function () {
                return cc.sys.isNative || cleverapps.platform && cleverapps.platform.oneOf(Instant, Mobage, AndroidPlatform, GDCom, Huzcom, Pliega, Rustore, Yandex, Microsoft, Mygames, WortalPlatform, Samsung) ? cleverapps.config.deployment : ""
            },
            standsWeb: function (e) {
                return cleverapps.config.deployment + (e = e || "")
            },
            standsRest: function (e) {
                return cleverapps.config.deployment + "/" + cleverapps.config.name + "-rest" + (
                    e = e || "")
            },
            getDefaultTimeout: function () {
                return cleverapps.platform && cleverapps.platform.oneOf(Wechat) ? 2e4 : 1e4
            },
            sendRaw: function (e, t, s) {
                var i = cc.sys.isNative ? cc.loader.getXMLHttpRequest() : new XMLHttpRequest,
                    t = cleverapps.RestClient.getBase() + t;
                i.open(e, t), i.timeout = this.getDefaultTimeout(), i.send(s)
            },
            createQueryString: function (e) {
                var t, s = [];
                for (t in e) s.push(t + "=" + ("string" == typeof e[t] ? e[t] : JSON.stringify(e[t])));
                return s.join("&")
            },
            get: function (e, t, s, i, n) {
                this.send(cleverapps.RestClient.METHODS.GET, e, t, s, i, n)
            },
            post: function (e, t, s, i, n) {
                this.send(cleverapps.RestClient.METHODS.POST, e, t, s, i, n)
            },
            send: function (p, t, e, s, i, n) {
                var o, a, r, c, l;
                n = n || {}, cleverapps.flags && cleverapps.flags.norest && !n.ignoreNoRest || (e = e || {}, o = n.timeout || this.getDefaultTimeout(), a = cc.loader.getXMLHttpRequest(), r = setTimeout(function () {
                    c.call({
                        status: -1,
                        responseText: "our timeout"
                    })
                }, o + 1e3), c = function () {
                    if (void 0 !== r && (clearTimeout(r), r = void 0), 200 <= this.status && this.status < 300) {
                        if (s) {
                            var e;
                            try {
                                e = this.responseText && JSON.parse(this.responseText)
                            } catch (e) {
                                throw "parse json error: path - " + t + ", message - " + e.message
                            }
                            s(e)
                        }
                    } else this.responseText && (this.errorMessage = (this.responseText.split("\n")[0] || "").trim()), console.log("XMLHttpRequest FAILED", p, this.status, this.errorMessage, l), i && i(this);
                    s = function () { }, i = function () { }
                }.bind(a), a.ontimeout = c, a.onload = c, a.onerror = c, a.onabort = c, (l = t).startsWith("http") || n.fullPath || (l = cleverapps.RestClient.getBase() + cleverapps.config.restApiURL + t), a.open(p, l), a.timeout = o, n.noContentType || a.setRequestHeader("Content-Type", "application/json"), n.authorization ? a.setRequestHeader("authorization", n.authorization) : a.setRequestHeader("Cache-Control", "no-cache"), a.send(n.noContentType ? e : JSON.stringify(e)))
            },
            METHODS: {
                GET: "GET",
                POST: "POST"
            }
        }, cleverapps.ErrorHandler = {
            SEND_INTERVAL: "1 hour",
            lastSend: 0,
            formatMessage: function (e) {
                var t = [new Date + ""];
                return cleverapps.environment && t.push("Screen: " + cleverapps.environment.getScreen()), cleverapps.platform && t.push(
                    "Source: " + cleverapps.platform.source), cleverapps.config && (t.push("Name: " + cleverapps.config.name), t.push("Title: " + cleverapps.config.title), t.push("Version: " + cleverapps.config.version), t.push("WebpSupport: " + cleverapps.config.webpSupport)), void 0 !== levels && levels.user && (cleverapps.environment && (t.push("Episode: " + cleverapps.environment.episodeNo), t.push("Level: " + cleverapps.environment.levelNo)), cleverapps.config && "merge" === cleverapps.config.type ? t.push("User Level: " + levels.user.level) : t.push("User Level: " + levels.user.episode), t.push("User id: " + cleverapps.platform.getUserID())), cleverapps.paymentsHistory && t.push("Payer: " + cleverapps.paymentsHistory.classify()), cleverapps.settings && t.push("Language: " + cleverapps.settings.language), cleverapps.meta && (t.push("Focus: " + cleverapps.meta.focus), t.push("Focus history: " + cleverapps.meta.focusHistory.join(", "))), cleverapps.synchronizer && cleverapps.synchronizer.lastSyncIn && t.push("Last syncin: " + cleverapps.synchronizer.lastSyncIn),
                    "undefined" != typeof $msstart && t.push("Last $msstart: " + $msstart.lastCalled + " " + $msstart.lastCalledTime), t.push(window && window.navigator ? window.navigator.userAgent : "???"), t = (t = (t = t.concat(e)).join(" - ")).replace(/(?:\r\n|\r|\n)/g, " - ") + " ", t = window && window.assetsFolder ? t.replace(new RegExp(window.assetsFolder, "g"), "") : t
            },
            onerror: function (t, e, s, i, n) {
                var o = cleverapps.platform && cleverapps.platform.source,
                    a = [];
                if (n && n.arguments && a.push("Arguments: " + n.arguments), e = e || window.location.href, 0 !== s || 0 !== i || "gdcom" !== o) return n && n.stack ? (a.push("Message: " + t), a.push("Line: " + s), a.push("Column: " + i), a.push(n.stack)) : (a.push("Message: " + t), a.push("URL: " + e), a.push("Line: " + s), a.push("Column: " + i), a.push("Error: " + JSON.stringify(n))), cleverapps.ErrorHandler.getLastConsoleMessages(function (e) {
                    e && a.unshift("Console: " + e);
                    e = cleverapps.ErrorHandler.formatMessage(a);
                    if (cleverapps.ErrorHandler.showErrorNotification(n || t, a), cleverapps.ErrorHandler.needIgnore(e)) return !1;
                    cleverapps.ErrorHandler._onerror(e)
                }), !1
            },
            needIgnore: function (t) {
                return cleverapps.ErrorHandler.IGNORED_ERRORS.some(function (e) {
                    return t && -1 !== t.indexOf(e)
                })
            },
            _onerror: function (t) {
                var s, e;
                Date.now() - cleverapps.ErrorHandler.lastSend >= cleverapps.parseInterval(this.SEND_INTERVAL) && (this.send(t), cleverapps.ErrorHandler.lastSend = Date.now()), cc.sys.isNative && (console.log("_onerror - " + JSON.stringify(t)), s = cc.director.getTotalFrames(), e = function () {
                    if (s === cc.director.getTotalFrames() || !cleverapps.meta) return cleverapps.eventLogger && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.WEBVIEW_ONERROR_RELOAD_SILENT), cleverapps.throwAsync && cleverapps.throwAsync("WebView error location reload silent - " + JSON.stringify(t)), void window.location.reload();
                    var e = {
                        focus: "OnErrorRestartWindow",
                        action: function (e) {
                            cleverapps.eventLogger && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.WEBVIEW_ONERROR_RELOAD_WINDOW), cleverapps.throwAsync && cleverapps.throwAsync("WebView error location reload window - " + JSON.stringify(t)),
                                new RestartWindow({
                                    contentMessage: "RestartWindow.OnError"
                                }), cleverapps.meta.onceNoWindowsListener = e
                        }
                    };
                    cleverapps.meta.isFocused() ? cleverapps.meta.distract(e) : cleverapps.meta.display(e)
                }, setTimeout(function () {
                    s === cc.director.getTotalFrames() && (cc.game.pause(), cc.game.resume(), setTimeout(e, 500))
                }, 500))
            },
            send: function (e) {
                console.log(e), cleverapps.RestClient.sendRaw(cleverapps.RestClient.METHODS.POST, cleverapps.LOG_ERROR_URL, e), cleverapps.eventLogger && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.ERROR_AMOUNT)
            },
            getLastConsoleMessages: function (s) {
                if (cleverapps.platform && cleverapps.platform.oneOf(AndroidBase)) try {
                    cleverapps.platform.callNative("AppActivityPlugin.getLastConsoleMessages", function (e, t) {
                        s(t && t.consoleMessages)
                    })
                } catch (e) {
                    console.log("ErrorHandler.getLastConsoleMessages error", e), s()
                } else s()
            },
            showErrorNotification: function (e, t) {
                cleverapps.config.debugMode && cleverapps.bundleLoader && cleverapps.notification && (e = (
                    e = "string" == typeof e ? e : e && e.message ? e.message : JSON.stringify(e)).substr(0, 60), cleverapps.notification.create(e, {
                        defer: !0,
                        image: bundles.dev_buttons.frames.icon_error,
                        debugInfo: t.join("\n"),
                        toReplace: {
                            ignoreWarning: !0
                        }
                    }), cleverapps.resolution && cleverapps.resolution.isInitialized() && cleverapps.bundleLoader.loadBundle("main", {
                        onSuccess: function () {
                            cleverapps.resolution.showCanvas(), cleverapps.notification.processQueue(), cleverapps.bundleLoader.deleteBundle("main")
                        }
                    }))
            }
        }, window.onerror = cleverapps.ErrorHandler.onerror, cleverapps.LOG_ERROR_URL = "/log/", cleverapps.ErrorHandler.IGNORED_ERRORS = ["html5.api.gamedistribution.com", "hadronid.net/hadron.js", "app.mbga-platform.jp/gadgets/js/auth-refresh", "safari-extension://", "eval (eval at  anonymous  (eval at buildCode (:606:31))"], function () {
            this.started = Date.now(), this.timeout = setTimeout(this.stop.bind(this), 6e4)
        }),
        cleverappsEvents = (LogTimeStart.prototype.save = function () {
            var e, t, s;
            cleverapps.platform && cleverapps.user && cleverapps.RestClient ? (
                e = cleverapps.platform.source, t = cleverapps.platform.getUserID(), s = Math.round((Date.now() - this.started) / 1e3), cleverapps.RestClient.post("/timestart/" + encodeURIComponent(t) + "/" + s + "/" + e, {})) : console.log("Skip logging time start, no platform or user or RestClient found after timeout")
        }, LogTimeStart.prototype.stop = function () {
            void 0 !== this.timeout && (clearTimeout(this.timeout), this.timeout = void 0, this.save())
        }, cc.sys.isNative || (LogTimeStart.active = new LogTimeStart), cc.getCenter = function (e) {
            var t, s;
            if (e && 0 !== e.length) return t = 0, s = 0, e.forEach(function (e) {
                t += e.x, s += e.y
            }), cc.p(t / e.length, s / e.length)
        }, cc.getCenterPoint = function (e) {
            var t, s, i, n, o;
            if (e && 0 !== e.length) return t = 0, s = 0, e.forEach(function (e) {
                t += e.x, s += e.y
            }), i = cc.p(t / e.length, s / e.length), n = e[0], o = cc.pDistance(n, i), e.forEach(function (e) {
                var t = cc.pDistance(e, i);
                t < o && (n = e, o = t)
            }), n
        }, cc.getDistanceChebyshev = function (e, t) {
            return Math.max(Math.abs(e.x - t.x), Math.abs(e.y - t.y))
        }, cc.rectScale = function (e, t) {
            return cc.rect(e.x + e.width / 2 * (1 - t),
                e.y + e.height / 2 * (1 - t), e.width * t, e.height * t)
        }, cc.rectGetCenter = function (e) {
            return cc.p(e.x + e.width / 2, e.y + e.height / 2)
        }, cc.padding = function (e, t, s, i) {
            var n, o;
            return "object" == typeof t ? (n = cc.padding(e), t = (o = cc.padding(t)).right || n.right, s = o.bottom || n.bottom, i = o.left || n.left, e = o.top || n.top) : void 0 === t && void 0 !== e ? (t = e.right || e.x, s = e.bottom || e.y, i = e.left || e.x, e = e.top || e.y) : void 0 === s && void 0 !== t && void 0 !== e && (s = e, i = t), {
                top: e || 0,
                right: t || 0,
                bottom: s || 0,
                left: i || 0
            }
        }, cc.rectAddPadding = function (e, t) {
            return cc.rect(e.x - t.left, e.y - t.bottom, e.width + t.left + t.right, e.height + t.bottom + t.top)
        }, cc.rectSubPadding = function (e, t) {
            return cc.rect(e.x + t.left, e.y + t.bottom, Math.max(e.width - t.left - t.right, 0), Math.max(e.height - t.bottom - t.top, 0))
        }, cc.multPadding = function (e, t) {
            return {
                top: e.top * t,
                right: e.right * t,
                bottom: e.bottom * t,
                left: e.left * t
            }
        }, cc.paddingAddPadding = function (e, t) {
            return {
                top: e.top + t.top,
                right: e.right + t.right,
                bottom: e.bottom + t.bottom,
                left: e.left + t.left
            }
        }, cc.nearestToRect = function (e, t) {
            var s = t.x <= e.x ? e.x : t.x >= e.x + e.width ? e.x + e.width : t.x,
                e = t.y <= e.y ? e.y : t.y >= e.y + e.height ? e.y + e.height : t.y;
            return cc.p(s, e)
        }, {
            GENERAL: {
                TUTORIAL_COMPLETE: "tutorial_complete",
                LEVEL_UP: "level_up"
            },
            TARGET_FOR_BUYING: {
                DAY_1_WATCHED_15_ADS: "day_1_watched_15_ads",
                DAY_1_ADS_COUNT: "day_1_ads_count",
                DAY_1_ADS_VALUE: "day_1_ads_value",
                BASE_WATCH_5: "base_watch_5",
                BASE_REACH_5: "base_reach_5",
                BASE_REACH_6: "base_reach_6",
                BASE_REACH_7: "base_reach_7",
                BASE_REACH_8: "base_reach_8",
                BASE_REACH_10: "base_reach_10",
                BASE_REACH_15: "base_reach_15",
                BASE_REACH_20: "base_reach_20",
                BASE_REACH_25: "base_reach_25",
                BASE_REACH_30: "base_reach_30",
                BASE_REACH_35: "base_reach_35",
                BASE_REACH_40: "base_reach_40",
                BASE_REACH_45: "base_reach_45",
                BASE_REACH_50: "base_reach_50",
                BASE_REACH_60: "base_reach_60",
                BASE_REACH_70: "base_reach_70",
                BASE_REACH_80: "base_reach_80",
                BASE_REACH_90: "base_reach_90",
                BASE_REACH_100: "base_reach_100",
                BASE_PLAY_WATCH: "base_play_watch",
                RETENTION_1: "ret1",
                RETENTION_2: "ret2",
                RETENTION_3: "ret3",
                AD_START: "ad_start",
                WATCHED_5: "watched5",
                WATCHED_10: "watched10",
                WATCHED_20: "watched20",
                WATCHED_30: "watched30"
            },
            EARN: {
                HARD: "ehard",
                SOFT: "esoft",
                FLYING: "flying",
                PROMO: "promo",
                GROWTH_FUND: "fund",
                COOKIE_JAR: "cookie",
                CHEST: "chest",
                BOARD_COIN: "board",
                MAGNIFIER: "magnifier",
                FRIEND_REQUEST: "request",
                RETURN: "return",
                OTHER: "other",
                CRYPTEX: "cryptex",
                LEVEL_REWARD: "reward",
                LIVES: "lives"
            },
            SPENT: {
                HARD: "shard",
                BOOSTER: "booster",
                BOOSTER_BEFORE: "before",
                BARREL: "barrel",
                RUIN: "ruin",
                SPECIAL_OFFER: "special",
                PAY_ISLAND: "island",
                WORKER: "worker",
                SKIP_VIP: "skip_vip",
                LIVES: "lives",
                SOFT: "ssoft",
                UNIT: "unit",
                PAID_UNIT: "paid_unit",
                REFRESH: "refresh",
                SEASON: "season",
                CLAN: "clan",
                CONTINUE: "continue",
                TACTICAL_EXTEND: "tactical_extend",
                HERO_UPGRADE: "upgrade",
                BOMB_MOVES: "bomb",
                SLOT_MACHINE: "slot",
                HOMEFIX_CHOICE: "choice",
                INGREDIENT: "ingredient",
                MISSION_OFFER: "offer_",
                REFILL_TANK: "tank",
                GENIE_ENERGY: "genie",
                MINESWEEPER: "miner",
                PACK: "pack_",
                ORDER: "order",
                ENERGY_LOTTERY: "lottery",
                BATTLE_PASS: "battlepass",
                LAST_CHANCE: "lastchance",
                SPEED_UP: "speedup",
                FRUIT: "fruit",
                RESET: "reset",
                UNLOCK: "unlock",
                CARAVAN: "caravan",
                PERIODIC_LOT: "per_lot",
                CHAIN_LOT: "chain_lot",
                CUSTOMER: "customer",
                RECIPE_INGREDIENT: "ingred",
                FACTORY: "factory",
                TROOP_CARDS: "troop",
                PIGGY_BANK: "piggy",
                LUCKY_BONUS: "lucky_bonus"
            },
            ADS: {
                START: "ad_start",
                FINISH: "ad_finish",
                SESSION_FINISH: "ad_session_finish",
                COST: "ad_cost",
                CACHE: "ad_cache",
                READY: "ad_ready",
                TYPE: "ad-"
            },
            EXPEDITIONS: {
                PLAY: "play_",
                SPEND: "payments_",
                TOTAL: "total_"
            },
            STATS: {
                APP_INITIALIZE: "app_initialize",
                LOADER_PROGRESS: "loader_progress_",
                LEVEL_START: "level_start",
                SHOP_OPEN: "shop_open",
                SHOP_CLOSE: "shop_close",
                PRODUCT_BUY: "product_bought",
                BUY_ITEM: "buy_item",
                PAYMENTS: "payments",
                VIDEO_PRODUCT_BUY: "video_product_buy",
                RATE_WINDOW: "rate_window",
                RATE_SEND: "rate_send",
                SOCIAL_REVIEW: "social_review_",
                NATIVE_REVIEW: "native_review_",
                TUTORIAL_BEGIN: "tutorial_begin",
                TUTORIAL_STEP: "tutorial_step_",
                LEVEL_PASS_EVENT: "level_passed",
                LEVEL_FINISH: "level_finish",
                LEVEL_LEFT_MOVES: "level_left_moves",
                LEVEL_PASSED_TIME: "level_passed_time",
                LEVEL_STARS: "level_stars",
                UNIQUE_FINISH: "lev_finish",
                UNIQUE_START: "lev_start",
                USE_ENERGY: "use_energy",
                PROMO: "promo_",
                PROMO_SHOW: "promo_show_",
                PROMO_ERROR: "promo_error_",
                LOGIN: "login",
                CHAIN_SALE_OPEN: "chain_sale_open",
                DAU: "dau",
                DAU_COUNTRY: "dau_country_",
                PAYER_DAU: "payer_dau",
                DAY_1_DAU: "day_1_dau",
                DAY_1_ADS_COUNT_DAU: "day_1_ads_count_dau",
                REWARDED_AVAILABLE_DAU: "rewarded_available_dau",
                REWARDED_LOADED_DAU: "rewarded_loaded_dau",
                REWARDED_NOADS_DAU: "rewarded_noads_dau",
                NOADS_ERROR: "noads_error-",
                REWARDED_DAU: "rewarded_dau",
                REWARDED_ERROR_DAU: "rewarded_error_dau",
                VIP_REWARDED_WATCHED: "vip_rewarded_watched",
                VIP_REWARDED_DAU: "vip_rewarded_dau",
                RETENTION_0: "retention_0",
                RETENTION_1: "retention_1",
                RETENTION_2: "retention_2",
                RETENTION_3: "retention_3",
                RETENTION_7: "retention_7",
                RETENTION_14: "retention_14",
                RETENTION_30: "retention_30",
                ACTIVE_TIME: "active_time",
                ACTIVE_TIME_DAU: "active_time_dau",
                GAME_LEVEL_CONVERSION_DAYS: "gamelevel_conversion_d",
                USER_WANDS_DAU: "user_wands_dau",
                USER_WANDS_DAU_AMOUNT: "user_wands_dau_amount",
                ERROR_AMOUNT: "error_amount",
                ERROR_CONTEXT_LOST: "context_lost",
                LEVEL_FPS: "level_fps",
                RESOLUTION: "resolution_",
                WEBP: "webp_",
                APP_TRACKING: "app_tracking_",
                APP_LOVIN_ADS: "app_lovin_ads",
                ADMOB_ADS: "admob_ads",
                YANDEX_APP_ADS: "yandex_app_ads",
                GIFT_COINS_EARNED: "gift_coins_earned",
                INSTANT: {
                    SHORTCUT_SHOW: "instant_shortcut_show",
                    SHORTCUT: "instant_shortcut",
                    BOT_SHOW: "instant_bot_show",
                    BOT_ERROR: "instant_bot_error",
                    BOT: "instant_bot",
                    PAGE_SHOW: "instant_page_show",
                    PAGE_ERROR: "instant_page_error",
                    PAGE: "instant_page",
                    REQUEST: "instant_request",
                    PAYMENT: "instant_payment-",
                    CATALOG: "instant_catalog-",
                    SUBSCRIPTION_CATALOG: "instant_subs_cat-",
                    CONSUME: "instant_consume-",
                    LIST_PURCHASES: "instant_list-",
                    ADS_LOAD: "instant-",
                    ADS_PLAY: "instant_play-",
                    SUBSCRIPTION: "instant_subscr-",
                    SUBSCRIPTION_LIST: "instant_sublist-",
                    SUBSCRIPTION_API: "instant_subscr_api",
                    LOCALE: "instant_locale-",
                    PLATFORM: "instant_platform-",
                    ENTRY_POINT: "instant_epoint-"
                },
                YANDEX: {
                    ADS_PLAY: "yandex_play-"
                },
                PUSHES: {
                    SEND: "push_send-",
                    CLICK: "push_click-",
                    CLICK_ANDROID: "pusha_click-",
                    PERMITTED_DAU: "push_permitted_dau",
                    MOBILE_OK_CLICK: "push_mobile_ok_click",
                    ANDROID_OK_CLICK: "push_android_ok_click"
                },
                OKADS: {
                    PLAY: "okads_play-",
                    RESULT: "okads_result-"
                },
                OK: {
                    JOIN_GROUP: "ok_join_group_"
                },
                PRODUCT: {
                    OPEN: "product_open",
                    SUCCESS: "product_success",
                    RESTORE: "product_restore"
                },
                YOOKASSA: {
                    DAU: "yookassa_dau",
                    OPEN: "yookassa_open",
                    PAID_COUNT: "yookassa_paid_count",
                    PAID_AMOUNT: "yookassa_paid_amount"
                },
                GDCOM: {
                    ADS_EVENT: "gdcom_ae-"
                },
                BANNER: {
                    DAU: "banner_dau",
                    LOADING: "banner_loading",
                    SHOWN: "banner_shown",
                    HIDDEN: "banner_hidden"
                },
                XSOLLA: {
                    INIT_WIDGET_FAILED: "xsolla_init_widget_failed",
                    OPEN_WIDGET: "xsolla_open_widget"
                },
                PAY_RESULT: "pay_result"
            },
            DEBUG: {
                CLEARANCE: {
                    DATALOADER_CHECKSUM_MATCH: "dataloader_checksum_match",
                    DATALOADER_CHECKSUM_DIFFERENT: "dataloader_checksum_different",
                    LOCALSTORAGE_CLEARED: "localstorage_cleared",
                    LOCALSTORAGE_ERROR_SET_ITEM: "localstorage_error_set_item",
                    LOCALSTORAGE_SESSION_EXPIRED: "localstorage_session_expired"
                },
                FAIL_BUNDLE: "fail_bundle_",
                WEBVIEW_ONERROR_RELOAD_SILENT: "webview_onerror_reload_silent",
                WEBVIEW_ONERROR_RELOAD_WINDOW: "webview_onerror_reload_window",
                GDCOM_INIT_ERROR: "gdcom_init_error",
                PLINGA_INIT_ERROR: "plinga_init_error",
                KONGREGATE_INIT_ERROR: "kongregate_init_error",
                CRAZY_INIT_ERROR: "crazy_init_error",
                GRAVITY_INIT_ERROR: "gravity_init_error",
                GRAVITY_RECONNECT: "gravity_reconnect",
                MERGE: {
                    RESTORE_MULTICELL_BODY: "restore_multicellbody",
                    RESTORE_KICKOUT: "restore_kickout_",
                    UNITS_RESET: "units_reset",
                    UNKNOWN_UNIT_DAU: "unknown_unit_dau"
                },
                UNKNOWN_MISSION_DAU: "unknown_mission_dau",
                PENDING_REQUESTS_FREEZE: "pending_requests_freeze",
                SECOND_LOGIN: "second_login",
                RENDER_TYPE: "render_type_",
                AUDIO_PLAY_PAUSED_GAME: "audio_play_paused_game",
                MISSION_REPLACED: "mission_replaced-",
                MISSION_REPLACED_REMOVED: "mission_replaced_removed-",
                MISSION_REPLACED_UNAVAILABLE: "mission_replaced_unavailable-",
                MISSION_REPLACED_PAST: "mission_replaced_past-",
                OK_SESSION_EXPIRED: "ok_session_expired",
                OK_SESSION_RESTORED: "ok_session_restored"
            },
            MISSION: "mission_",
            MISSION_DAU: "mission_dau",
            PASS_FINISH_TASK: "pass_finish_task",
            PASS_RECEIVED: "pass_received",
            PASS_RECEIVED_PREMIUM: "pass_received_premium",
            MISSION_FINISH: "mission_finish",
            TOURNAMENT_LEVEL_PLACE: "tournament_level_place",
            EXPEDITION_DAU: "expedition_dau",
            EXPEDITION_FOG: "exp_",
            BONUS_WORLD_LEVEL: "bonus_world_level",
            BONUS_WORLD_DAU: "bonus_world_dau",
            BONUS_WORLD_LEVEL_DAU: "bonus_world_level_dau",
            BONUS_WORLD_REWARD: "BONUS_WORLD_REWARD",
            BONUS_WORLD_PAYMENTS: "bonus_world_payments_",
            METHA_ITEM: "metha_item",
            METHA_LEVEL: "metha_level",
            SIMPLE_METHA_BACKGROUND: "simple_metha_background",
            MAKE_CHOICE: "make_choice",
            REDO_CHOICE: "redo_choice",
            WIN_KNOCKOUT: "win_knockout",
            LOSE_KNOCKOUT: "lose_knockout",
            MINIGAME_FINISH: "minigame_finish",
            MINIGAME_REWARD: "minigame_reward",
            MINESWEEPER_START: "minesweeper_start",
            MINESWEEPER_VICTORY: "minesweeper_victory",
            DAILY_BONUS: "daily_bonus",
            HELP_BY_FIVE_ATTEMPTS: "help_by_five_attemts",
            HELP_BY_ATTEMPTS_DAU: "help_by_attemts_dau",
            HELP_BY_ATTEMPTS_ONE_AND_MORE: "help_by_attemts_1_and_more",
            HELP_BY_ATTEMPTS_THREE_AND_MORE: "help_by_attemts_3_and_more",
            HELP_BY_ATTEMPTS_FIVE_AND_MORE: "help_by_attemts_5_and_more",
            TACTICAL_EXTEND_SHOW: "tactical_extend_show",
            MESSAGE_SENT_FRIEND: "message_friend",
            MESSAGE_SENT_INVITE: "message_invite",
            MESSAGE_SENT_PREFIX: "message_sent_",
            MESSAGE_CANCEL_PREFIX: "message_cancel_",
            MESSAGE_ERROR: "message_error",
            INVITE_ICON_INVITE: "invite_icon_invite",
            SESSION_DAILY_TASK_AVAILABLE: "session_daily_task_available",
            SESSION_DAILY_TASK_FINISH: "session_daily_task_finish",
            SESSION_DAILY_TASK_REWARD: "session_daily_task_reward",
            SESSION_DAILY_TASK_OPEN_WINDOW: "session_daily_task_open_window",
            DAILY_TASK_REWARD: "daily_task_rewarded",
            DAILY_TASK_FINISH_AMOUNT: "daily_task_finish_amount",
            DAILY_TASKS_OPEN_WINDOW: "daily_tasks_open_window",
            DAILY_TASKS_START: "daily_tasks_start",
            SUBSCRIPTION_WINDOW_OPEN: "subscription_window_open",
            SUBSCRIPTION_REWARD: "subscription_reward",
            SUBSCRIPTION_BOUGHT: "subscription_bought",
            SUBSCRIPTION_CANCELLED: "subscription_cancelled",
            CRYPTEX_FAIL: "cryptex_fail",
            CUP_REWARD: "cup_reward_",
            CUP_DAU: "cup_dau_",
            CUP_PLAYERS: "cup_players_",
            FUND_BUY: "bought_fund",
            FUND_DAU: "growth_fund_dau",
            FUND_GOLD: "growth_fund_gold",
            SHARE_PROPOSED: "share_proposed_",
            SHARE: "share_",
            LEADERS_WINDOW_OPEN: "leaders_window_open",
            NEW_LEAGUE: "new_league",
            PACKWINDOW_OPENED: "packwindow_opened",
            PACK_STARTED: "pack_started",
            MOVES_SHOW: "moves_show",
            MOVES_BOUGHT: "moves_bought",
            MOVES_USED_FORCE: "moves_used_force",
            BOOSTERS_EXECUTE: "boosters_execute",
            HINT_USED: "hint_used",
            DAILY_LEVEL_CHANNEL: "daily_level_channel_",
            DAILY_LEVEL_PASSED: "daily_level_passed_",
            PIGGY_BANK: "pig",
            RETURNBONUS_CHECK: "returnbonus_check",
            RETURNBONUS_REWARD: "returnbonus_reward",
            STAR_CHEST_OPEN: "star_chest_open",
            PLAY_TIMES: "play_times",
            BOOSTER_CELL_ADDED: "booster_cell_added",
            BOOSTER_CELL_COLLECTED: "booster_cell_collected",
            BOOSTER_CELL_RECEIVED: "booster_cell_recevied",
            BOOSTER_COMBO_NO_PLACE: "booster_combo_no_place",
            BOOSTER_MULTICOLOR_NO_PLACE: "booster_multicolor_no_place",
            UNDO_USED_FORCE: "undo_force",
            MERGE_START: "merge_start",
            CURRENT_RESOURCE: "current_resource_",
            COMPLETE_RESOURCES: "complete_resources",
            CURRENT_ORDER: "current_order_",
            COMPLETE_ORDERS: "complete_orders",
            SEASON_START: "season_start",
            CURRENT_SEASON: "current_season_",
            COMPLETE_SEASON: "complete_season_",
            CURRENT_HERO: "current_hero_",
            COMPLETE_HEROES: "complete_heroes",
            CAMPAIGN: "campaign_",
            CURRENT_PET: "curr_pet_",
            CURRENT_PETRARE: "curr_petr_",
            CURRENT_PETLEGEND: "curr_petl_",
            COMPLETE_PET: "comp_pet",
            COMPLETE_PETRARE: "comp_petr",
            COMPLETE_PETLEGEND: "comp_petl",
            PET_RATE: "pet_rate_",
            CURRENT_EVENT: "curr_event_",
            COMPLETE_EVENT: "comp_event_",
            UNITS_SHOP_COINS: "units_shop_coins",
            UNITS_SHOP_ITEM: "units_shop_item",
            SOFT_CURRENCY_BUY: "soft_buy",
            SOFT_CURRENCY_COST: "soft_cost",
            UNITS_SOLD: "units_sold",
            SPEND_WANDS: "spend_wands",
            MONSTER_SPAWN: "monster_spawn",
            MONSTER_DIE: "monster_die",
            BANK_COINS: "bank_coins",
            BATTLE_REGULAR: "battle_regular",
            BATTLE_BONUS: "battle_bonus",
            SPECIAL_OFFER_COUNT: "special_offer_count",
            UNIT_VALUE: "value_",
            CLANS_DAU: "clans_dau",
            UNITS_AMOUNT: "units_amount",
            UNITS_AMOUNT_DAU: "units_amount_dau",
            EARNED_COINSPLANT: "earned_coinsplant",
            EARNED_RUBIESPLANT: "earned_rubiesplant",
            EARNED_ENERGYPLANT: "earned_energyplant",
            EARNED_MAGICPLANT: "earned_magicplant",
            CASTLE_PRIZES: "castle_prizes",
            LANDMARKS: {
                OPEN: "landmark_open",
                REPLACE: "landmark_replace"
            },
            FAKEFB_BY_TIMEOUT: "fakefb_by_timeout",
            FAKEFB_BY_SCRIPT_ERROR: "fakefb_by_script_error",
            FACEBOOK_INITED: "facebook_inited"
        }),
        ResolutionManager = ("undefined" != typeof module && (module.exports = cleverappsEvents), function () {
            this.frameWidth = window.innerWidth, this.frameHeight = window.innerHeight, this.isRotated = !1, this.shown = !1, this.containerPadding = cc.padding(), this.safePadding = cc.padding(), this.bottomBgPadding = 0, this.mode = cleverapps.WideMode.VERTICAL, cc.view.adjustViewPort(!0),
                cc.view._devicePixelRatio = Math.min(2, window.devicePixelRatio || 1);

            function e() {
                o(), s = 0, a()
            }
            var t, s = 0,
                i = void 0,
                n = [50, 100, 200, 300, 500, 1e3, 2e3, 4e3],
                o = cleverapps.accumulate(cleverapps.platform.oneOf(VKPlatform) ? ResolutionManager.RESIZE_THROTTLE_VK : ResolutionManager.RESIZE_THROTTLE, function () {
                    var e = this.getFrameSize();
                    e.width === this.frameWidth && e.height === this.frameHeight || (cleverapps.config.wysiwygMode ? console.log("ignore resolution update (controlled by wysiwyg)") : (console.log("update resolution - " + JSON.stringify(e)), this.setupDesignResolution()))
                }.bind(this)),
                a = function () {
                    i = s !== n.length ? (i && cleverapps.timeouts.clearTimeout(i), cleverapps.timeouts.setTimeout(function () {
                        o(), s++, a()
                    }, n[s])) : void 0
                };
            cleverapps.platform instanceof Wechat && ((t = document.createElement("style")).innerHTML = ".rotate-container {\n    transform: rotate(-90deg);\n    -webkit-transform: rotate(-90deg);\n    transform-origin: 0px 0px 0px;\n    -webkit-transform-origin: 0px 0px 0px;\n}", document.head.appendChild(t)),
                window.addEventListener("resize", e, !1), window.addEventListener("orientationchange", e, !1), cleverapps.platform.oneOf(Wechat) && (wx.onDeviceOrientationChange(e), wx.onWindowResize(e))
        }),
        HasInitialized = (ResolutionManager.prototype.showCanvas = function () {
            var e;
            this.shown || (this.shown = !0, window.wechatFirstScreen && (window.wechatFirstScreen.end(), delete window.wechatFirstScreen, (e = cc.director.getRunningScene()) && (e._canvas.active = !0)), cc.container && (cc.container.style.display = "block"), (e = cc.game.canvas).style.display = "block", e.style.left = null, e.style.top = null, (e = document.getElementById("cocosLoading")) && document.body.removeChild(e), this.setupDesignResolution())
        }, ResolutionManager.prototype.isInitialized = function () {
            return void 0 !== this.resolutionName
        }, ResolutionManager.prototype.setupResolutionScale = function () {
            this.resolutionName && resolutions[this.resolutionName] || (this.resolutionName = this._calcResolution()), resolutionScale = resolutions[this.resolutionName].scale, cleverapps.UI.updateSizes(
                resolutionScale), cleverapps.UI.selectSkinResources(this.resolutionName), cleverapps.skins && cleverapps.skins.prepareBundlesSkins(), cleverapps.home && cleverapps.home.setupResolution(), cleverapps.farm && cleverapps.farm.setupResolution(), this.setupDesignResolution()
        }, ResolutionManager.prototype.setBottomBgPadding = function (e) {
            this.bottomBgPadding = e || 0, cleverapps.config.wysiwygMode && 0 < this.bottomBgPadding || this.setupDesignResolution()
        }, ResolutionManager.prototype.setContainerPadding = function (e) {
            e = e || {}, this.containerPadding = cc.padding(e), this.setupDesignResolution()
        }, ResolutionManager.prototype.setSafePadding = function (e) {
            this.safePadding = cc.padding(e), this.setupDesignResolution()
        }, ResolutionManager.prototype.getSafePadding = function () {
            return this.safePadding
        }, ResolutionManager.prototype.getFrameSize = function () {
            return cleverapps.platform.oneOf(Wechat) ? cc.view.getFrameSize() : this.isRotated ? cc.size(window.innerHeight, window.innerWidth) : cc.size(window.innerWidth, window.innerHeight)
        },
            ResolutionManager.prototype.isLandscapeOrientation = function () {
                return window.innerHeight < window.innerWidth
            }, ResolutionManager.prototype.resizeFont = function (e) {
                var t = 1;
                return this.mode === cleverapps.WideMode.VERTICAL ? t = .625 : this.mode === cleverapps.WideMode.SQUARE && (t = .85), {
                    name: e.name,
                    size: t * e.size,
                    color: e.color,
                    stroke: e.stroke
                }
            }, ResolutionManager.prototype.setupDesignResolution = function (e) {
                cleverapps.platform instanceof Wechat || (this._needRotate() ? (cc.container.classList.add("rotate-container"), this.isRotated = !0) : (cc.container.classList.remove("rotate-container"), this.isRotated = !1));
                var t = e || this.getFrameSize();
                if (this.frameWidth = Math.max(t.width, cleverapps.MIN_FRAME_SIZE), this.frameHeight = Math.max(t.height, cleverapps.MIN_FRAME_SIZE), Math.min(this.frameWidth, this.frameHeight) < cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE) return this.bgSize = this.bgSize || cc.size(this.frameWidth, this.frameHeight), void (this.sceneSize = this.sceneSize || cc.size(this.frameWidth, this.frameHeight));
                var t = this._calculateSceneSize(void 0 !== e),
                    e = (this.sceneSize = t, this._updateEngine(), this.mode = cleverapps.WideMode.VERTICAL, t.width > cleverapps.styles.SQUARE_MODE_WIDTH && (this.mode = cleverapps.WideMode.SQUARE), t.width > cleverapps.styles.HORIZONTAL_MODE_WIDTH && (this.mode = cleverapps.WideMode.HORIZONTAL), cleverapps.bannerAd && cleverapps.bannerAd.onResize(), cleverapps.scenes.getRunningScene());
                e && (e.setContentSize2(t), t = [PointerView.currentPointer, FingerView.currentFinger, cleverapps.forces && cleverapps.forces.getRunningForce(), Game.currentGame && Game.currentGame.tutorial].filter(Boolean), (t = cleverapps.config.wysiwygMode ? [] : t).forEach(function (e) {
                    (!(e instanceof cc.Node) || e.isRunning && e.isRunning()) && e.beforeResize && e.beforeResize()
                }), (e.isAllLoaded || e instanceof LoaderScene) && (e.updateSize(), e.updatePosition(), e.completeAnimationOnResize()), e.children.forEach(function (e) {
                    e.onChangeSize()
                }), e.children.forEach(function (e) {
                    e.onChangePosition()
                }), e.scaleGameField && e.scaleGameField(),
                    e.updateDynamicNodes && e.updateDynamicNodes(!0), t.forEach(function (e) {
                        (!(e instanceof cc.Node) || e.isRunning && e.isRunning()) && e.afterResize && e.afterResize()
                    }))
            }, ResolutionManager.prototype._calculateSceneSize = function (e) {
                var t = cc.padding(this.containerPadding),
                    s = this.isRotated ? cc.rect(t.top, t.left, this.frameWidth - t.top - t.bottom, this.frameHeight - t.left - t.right) : cc.rect(t.left, t.top, this.frameWidth - t.left - t.right, this.frameHeight - t.top - t.bottom),
                    i = cc.view.getDevicePixelRatio(),
                    n = s.width / s.height,
                    o = s.height / (s.height - this.bottomBgPadding),
                    a = cleverapps.styles.SCENE_HEIGHT * o,
                    r = a * n,
                    n = (r < cleverapps.styles.SCENE_MIN_WIDTH && !e && (a = (r = cleverapps.styles.SCENE_MIN_WIDTH) / n), r > cleverapps.styles.SCENE_MAX_WIDTH && !e && (r = cleverapps.styles.SCENE_MAX_WIDTH), cc.view._viewPortRect = cc.rect(0, 0, this.frameWidth * i, this.frameHeight * i), cc.view._visibleRect = cc.rect(0, 0, r, a), cc.winSize.width = cc.director._winSizeInPoints.width = r, cc.winSize.height = cc.director._winSizeInPoints.height = a, s.height / a),
                    e = (
                        cc.view._scaleX = cc.view._scaleY = i * n, r * n),
                    n = s.height,
                    c = (cc.sys.isInApp && cleverapps.platform.oneOf(Instant) && (document.body.style.width = "100vw", document.body.style.height = "100vh"), cc.game.container.style);
                return c.width = cc.game.canvas.style.width = Math.round(e) + "px", c.height = cc.game.canvas.style.height = n + "px", c.left = Math.round(t.left) + "px", c.top = Math.round(t.top + (this.isRotated ? s.width : 0)) + "px", c.padding = "0 " + Math.round((s.width - e) / 2) + "px", cc.game.canvas.width = Math.round(e * i), cc.game.canvas.height = n * i, r = 2 * Math.round(r / 2), a = 2 * Math.round(a / 2), this.bgSize = cc.size(r, a), this.isRotated ? (r /= o, r = 2 * Math.round(r / 2)) : (a /= o, a = 2 * Math.round(a / 2)), cc.size(r, a)
            }, ResolutionManager.prototype._needRotate = function () {
                var e = window.innerWidth > window.innerHeight && "horizontal" !== cleverapps.config.orientation || window.innerWidth < window.innerHeight && "horizontal" === cleverapps.config.orientation,
                    t = this.getFrameSize(),
                    t = Math.min(t.width, t.height) > .65 * Math.max(t.width, t.height);
                return cc.sys.isMobile && !cc.sys.isNative && !t && e
            }, ResolutionManager.prototype._calcResolution = function () {
                function e(e) {
                    return e = e.scale * cleverapps.styles.SCENE_HEIGHT, s <= e ? e - s : 100 * (s - e)
                }
                for (var t = this.frameHeight, s = (window.screen && window.screen.height && (t = Math.max(t, window.screen.height)), (t = cleverapps.platform instanceof Mobage ? cleverapps.MobageSocial.HEIGHT : t) * cc.view.getDevicePixelRatio()), i = Object.keys(resolutions), t = i.filter(function (e) {
                    return resolutions[e].webp
                }), n = (0 < t.length && (cleverapps.config.webpSupport ? i = t : t.length < i.length && (i = cleverapps.substract(i, t))), i = i.sort(function (e, t) {
                    return resolutions[e].scale - resolutions[t].scale
                }), 0), o = e(resolutions[i[n]]), a = 1; a < i.length; a++) {
                    var r = e(resolutions[i[a]]);
                    r < o && (o = r, n = a)
                }
                return i[n]
            }, ResolutionManager.prototype._updateEngine = function () {
                "creator" !== engine ? (cc._renderType === cc.game.RENDER_TYPE_WEBGL ? cc.director.setGLDefaultValues() : cc._renderType === cc.game.RENDER_TYPE_CANVAS && (cc.renderer._allNeedDraw = !0),
                    cc.visibleRect && cc.visibleRect.init(cc.view._visibleRect), cc._renderContext.resetCache && cc._renderContext.resetCache(), cc.view._initFrameSize(), cc.sys.isMobile && cc.view._adjustViewportMeta()) : creator.director.root.resize(cc.game.canvas.width, cc.game.canvas.height, 1)
            }, "cocos2d" === engine && (cc.EGLView.prototype.convertToLocationInView = function (e, t, s) {
                e = this.getDevicePixelRatio() * (e - s.left), s = this.getDevicePixelRatio() * (s.top + s.height - t), t = cleverapps.resolution ? cleverapps.resolution.containerPadding.left + cleverapps.resolution.containerPadding.right : 0, t = this.getDevicePixelRatio() * t;
                return cleverapps.resolution && cleverapps.resolution.isRotated ? {
                    x: s,
                    y: this._viewPortRect.height - e - t
                } : {
                    x: e,
                    y: s
                }
            }), cleverapps.WideMode = {
                VERTICAL: 0,
                SQUARE: 1,
                HORIZONTAL: 2
            }, ResolutionManager.RESIZE_THROTTLE = 0, ResolutionManager.RESIZE_THROTTLE_VK = 50, window.ENABLE_IMAEG_POOL = !1, cleverapps.EVENTS = cleverappsEvents, cleverapps.whenAllInitialized = function (e) {
                cleverapps.allInitialized && e(),
                    cleverapps.__whenAllInitializedCallbacks || (cleverapps.__whenAllInitializedCallbacks = []), cleverapps.__whenAllInitializedCallbacks.push(e)
            }, cleverapps.afterAllLoadingFinish = function () {
                cleverapps.allInitialized = !0, cleverapps.timeStart = Date.now(), cleverapps.__whenAllInitializedCallbacks && cleverapps.__whenAllInitializedCallbacks.forEach(function (e) {
                    e()
                })
            }, cleverapps.askPermissionsAndInit = function () {
                new ActionPlayer([function (e) {
                    cleverapps.paymentsCountry.whenInitialized("rewardedAdsManager", e)
                }, function (e) {
                    cleverapps.platform.registerPlugin(Platform.ADS, cleverapps.rewardedAdsManager.createPlugin.bind(cleverapps.rewardedAdsManager)), cleverapps.rewardedAdsManager.askPermission(e)
                }, function (e) {
                    cleverapps.platform.connect(), e()
                }, function (e) {
                    cleverapps.appTracking.askPermission(e)
                }, function (e) {
                    cleverapps.localPushes.askPermission(e)
                }, function (e) {
                    cleverapps.whenAllInitialized(e)
                }, function (e) {
                    cleverapps.rewardedAdsManager.init(), cleverapps.localPushes.initialize(), e()
                }]).play()
            },
            cleverapps.afterResourceLoaded = function () {
                "undefined" != typeof document && (document.title = Messages.get(cleverapps.config.title)), LogTimeStart.active && LogTimeStart.active.stop(), cleverapps.LocalizationManager.run(), "undefined" != typeof GitManager && (cleverapps.git = new GitManager, cleverapps.git.load()), cleverapps.hose && cleverapps.hose.setCurrentEpisode(cleverapps.user.episode), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.APP_INITIALIZE), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.RENDER_TYPE + (cc._renderType === cc.game.RENDER_TYPE_CANVAS ? "canvas" : "webgl")), void 0 !== cleverapps.DataLoader.checksumMatch && cleverapps.eventLogger.logEvent(cleverapps.DataLoader.checksumMatch ? cleverapps.EVENTS.DEBUG.CLEARANCE.DATALOADER_CHECKSUM_MATCH : cleverapps.EVENTS.DEBUG.CLEARANCE.DATALOADER_CHECKSUM_DIFFERENT), cleverapps.Shaders.initialize(), cleverapps.config.debugMode && (cleverapps.administrator = new Administrator, void 0 !== CardBlockHandler && (cleverapps.cardBlockHandler = new CardBlockHandler),
                    cleverapps.toolModel = new ToolModel, cleverapps.shortcuts = new Shortcuts, cleverapps.sceneDebugger = new SceneDebugger, cleverapps.drawCallsDebugger = new DrawCallsDebugger, cleverapps.debugSlider = new DebugSlider, cleverapps.debugStats = new DebugStats), cleverapps.flags.update(), cleverapps.returnBonus = new ReturnBonus, cleverapps.placements = new Placements, cc.renderer.assignedZStep = 1e-5, "board" === cleverapps.config.type ? (levels.gameHints = new levels.GameHints, levels.cookieJar = new cleverapps.CookieJar, levels.tutorial = new cleverapps.Tutorial) : "match3" === cleverapps.config.type && (levels.levelAttempts = new levels.LevelAttempts), cleverapps.bannerAd = new BannerAd, cleverapps.giveUsersGifts(), cleverapps.meta.distract({
                        focus: "afterAllLoadingFinish",
                        actions: [function (e) {
                            cleverapps.resolution.showCanvas(), cleverapps.platform.oneOf(Instant, Samsung) ? cleverapps.platform.removeLoadingProgress(e) : e()
                        }, function (e) {
                            cleverapps.afterAllLoadingFinish(), cleverapps.userDelete.checkDeletion(e)
                        }, function (e) {
                            var t, s;
                            if (
                                cleverapps.loadedSnapshot && cleverapps.loadedSnapshot.scene) return s = cleverapps.loadedSnapshot.scene, t = new Episode(s.episodeNo).getLevel(s.levelNo), s = cleverapps.travelBook.getPageById(t.expedition) || cleverapps.travelBook.getPageById("main"), cleverapps.travelBook.setCurrentPage(s), (s = cleverapps.meta.getMainObject()).knockoutGame ? (s.knockoutGame.rumble = new Rumble, void s.knockoutGame.rumble.whenInitialize(function () {
                                    t.play(e)
                                })) : void t.play(e);
                            cleverapps.Plot.onStartup(e)
                        }]
                    })
            }, cleverapps.createGlobalObjects = function () {
                cleverapps.importSnapshot && cleverapps.importSnapshot(), cleverapps.unitsDemoMode && cleverapps.unitsDemoMode(), cleverapps.bundleLoader = new BundleLoader, cleverapps.timeouts = new Timeouts, cleverapps.platform.registerPlugin(Platform.SOCIAL, SocialHelper.create), cleverapps.flags = new cleverapps.Flags, cleverapps.gameModes = new GameModes, cleverapps.eventBus = new cleverapps.EventEmitter, cleverapps.notification = new cleverapps.Notification, cleverapps.aims = new Aims,
                    cleverapps.resolution = new ResolutionManager, cleverapps.DataLoader.init(), cleverapps.gameModes.load(), cleverapps.instantTournament = new InstantTournament, "undefined" != typeof Snapshots && (cleverapps.snapshots = new Snapshots), cleverapps.userDelete = new UserDelete, "merge" === cleverapps.config.type && (Families.initialize(), Pocket.initialize(), Landmarks.initialize()), Missions.initialize(), Offers.initialize(), Products.initialize(), VirtualProducts.initialize(), RewardedAdsManager.initialize(), RewardedAdOverlay.initialize(), cleverapps.PaymentsHistory.initialize(), cleverapps.synchronizer = new cleverapps.Synchronizer, cleverapps.eventLogger = new cleverapps.EventsLogger, cleverapps.meta = new Metha, PersonsLibrary.initialize(), cleverapps.playSession = new PlaySession, cleverapps.info = new cleverapps.Information, cleverapps.episodes = new Episodes, cleverapps.expBySlots = {}, CustomSyncers.SLOTS.forEach(function (e) {
                        cleverapps.expBySlots[e] = new Exp(e)
                    }), cleverapps.exp = cleverapps.expBySlots[CustomSyncers.SLOT_MAIN],
                    "merge" === cleverapps.config.type && (cleverapps.gameLevel = new GameLevel);
                var t = !1 === cleverapps.DataLoader.haveSavedData();
                return t && (console.log("Creating new user"), cleverapps.synchronizer.reset()), cleverapps.user = levels.user = new levels.User(t), cleverapps.restoreProgress = new RestoreProgress, cleverapps.consoleStream = new cleverapps.ConsoleStream, cleverapps.abTest = new cleverapps.ABTest, cleverapps.scenes = new cleverapps.Scenes, cleverapps.environment = new cleverapps.Environment, cleverapps.skins = new cleverapps.SkinManager, cleverapps.windows = new Windows, cleverapps.settings = new cleverapps.Settings(t), cleverapps.audio = new cleverapps.Audio, cleverapps.versionChecker = new VersionChecker, cleverapps.info.reportPhone(), cleverapps.info.reportUserAgent(), cleverapps.info.reportAppVersion(), cleverapps.info.reportMaxTextureSize(), cleverapps.info.reportSysLanguage(), cleverapps.firebase = cleverapps.FirebaseManager.run(), cleverapps.firebase.init(), cleverapps.googleAnalytics = GoogleAnalyticsManager.run(),
                    cleverapps.googleAnalytics.init(), cleverapps.meta.getType() === Metha.FARM ? (cleverapps.farm = new Farm, MethaHelper.prepare()) : cleverapps.meta.getType() === Metha.HOMEFIX ? (cleverapps.home = new Home, MethaHelper.prepare()) : cleverapps.meta.getType() === Metha.SHORTMETA ? cleverapps.shortmeta = new ShortMeta : cleverapps.meta.getType() === Metha.FISHDOM ? cleverapps.fishdom = new Fishdom : cleverapps.meta.getType() === Metha.SIMPLE ? cleverapps.simple = new Simple : cleverapps.meta.getType() === Metha.HOSE && (cleverapps.hose = new Hose), cleverapps.crossPromo = new cleverapps.CrossPromo, cleverapps.Adjust.IS_AVAILABLE() && (cleverapps.adjust = new cleverapps.Adjust), AdOcean.IsAvailable() && (cleverapps.adOcean = new AdOcean), cleverapps.fbPixel = new cleverapps.FbPixel, cleverapps.nativeFbEventsLogger = new cleverapps.NativeFbEventsLogger, cleverapps.paymentsCountry = new PaymentsCountry, cleverapps.friends = new FriendsCache, cleverapps.invitalbleFriends = new FriendsCache(!0), cleverapps.paymentsManager = new PaymentsManager,
                    cleverapps.platform.registerPlugin(Platform.PAYMENTS, cleverapps.paymentsManager.createPayments.bind(cleverapps.paymentsManager)), cleverapps.paymentsHistory = new cleverapps.PaymentsHistory, cleverapps.userIdsHistory = new UserIdsHistory, cleverapps.localPushes = new cleverapps.LocalPushes, cleverapps.serverFlags = new cleverapps.ServerFlags, -1 === ["merge", "blocks"].indexOf(cleverapps.config.type) && (cleverapps.periodicBonus = new cleverapps.MiniGame(t)), cleverapps.isKnockoutGame() && (cleverapps.knockoutTutorial = new KnockoutTutorial), cleverapps.config.lives && (cleverapps.unlimitedLives = new UnlimitedLives), (cleverapps.config.lives || cleverapps.config.energy) && (cleverapps.livesBySlots = {}, CustomSyncers.SLOTS.forEach(function (e) {
                        cleverapps.livesBySlots[e] = new cleverapps.Lives(t, e)
                    }), cleverapps.lives = cleverapps.livesBySlots[CustomSyncers.SLOT_MAIN]), cleverapps.boosters = new cleverapps.Boosters(t), cleverapps.forces = new Forces, cleverapps.packManager = new PackManager, cleverapps.config.features.includes("piggybank") && (cleverapps.piggyBank = new PiggyBank), cleverapps.subscription = new Subscription, -1 !== ["mergecraft", "wondermerge", "fairy"].indexOf(cleverapps.config.name) && (cleverapps.growthFund = new GrowthFund), "undefined" != typeof Heroes && (match3.heroes = new Heroes), "match3" === cleverapps.config.type && (cleverapps.starChest = new cleverapps.StarChest), levels.friendSorter = new FriendSorter, levels.friendRequests = new levels.FriendRequests, cleverapps.eventManager = new EventManager, cleverapps.competitionPlayers = new CompetitionPlayers, cleverapps.competitionStatistics = new CompetitionStatistics, cleverapps.leagueLeadersTable = new cleverapps.Table, cleverapps.cupsLeadersTable = new cleverapps.Table, cleverapps.cupsTopTable = new cleverapps.Table, cleverapps.dailyCup = new Cup(CupsConfig.TYPE_DAILY), cleverapps.weeklyCup = new Cup(CupsConfig.TYPE_WEEKLY), cleverapps.clanCupInner = new Cup(CupsConfig.TYPE_CLAN_INNER), cleverapps.clanCup = new Cup(CupsConfig.TYPE_CLAN, cleverapps.clanCupInner), -1 !== ["merge", "match3", "differences",
                        "solitaire", "board"
                    ].indexOf(cleverapps.config.type) && (cleverapps.dailyTasks = new DailyTasks(t)), void 0 !== cleverapps.BonusRoundChest && (cleverapps.bonusRoundChest = new cleverapps.BonusRoundChest(t)), cleverapps.config.features.includes("dailylevel") && (cleverapps.dailyLevel = new DailyLevel), cleverapps.rewardedAdsManager = new RewardedAdsManager, cleverapps.travelBook = new TravelBook, cleverapps.adsLimits = new AdsLimits, cleverapps.toolbar = new Toolbar, cleverapps.sideBar = new SideBar, cleverapps.menuBar = new MenuBar, cleverapps.treasureBag = new TreasureBag, cleverapps.offerManager = new OfferManager, WebWorker.IsAvailable() && (cleverapps.webWorker = WebWorker.Build()), "merge" === cleverapps.config.type && (cleverapps.travelBookHint = new TravelBookHint), cleverapps.missionManager = new MissionManager, cleverapps.missionManager.init(), cleverapps.travelBook.init(), "merge" === cleverapps.config.type && (cleverapps.unitSavers = new UnitSavers, cleverapps.unitsShop = new UnitsShop, cleverapps.unitsLibrary = new UnitsLibrary,
                        cleverapps.userClan = new UserClan, cleverapps.clans = new Clans, cleverapps.clanMessages = new ClanMessages), void 0 !== Achievements && (cleverapps.achievements = new Achievements), "battlefield" === cleverapps.config.type && (cleverapps.barracks = new Barracks, cleverapps.formation = new Formation, cleverapps.troopCards = new TroopCards, cleverapps.armyLibrary = new ArmyLibrary, cleverapps.army = new Army, 0 === cleverapps.user.level && 0 === cleverapps.user.episode && cleverapps.formation.isEmpty() && cleverapps.formation.initForNewPlayer()), ThinkingData.IsAvailable() && (cleverapps.thinkingData = new ThinkingData), GravityEngine.IsAvailable() && (cleverapps.gravityEngine = new GravityEngine), cleverapps.exclamation = new Exclamation, cleverapps.gameMessage = new GameMessage, cleverapps.tooltipManager = new TooltipManager, PlayButton.IsAvailable() && (cleverapps.playButton = new PlayButton), cleverapps.chat = new Chat, cleverapps.chat.load(), cleverapps.keyboardController = new KeyboardController, FlyingAd.IsAvailable() && (cleverapps.flyingAd = new FlyingAd),
                    cleverapps.appTracking = new AppTracking, cleverapps.offerManager.initialize(), cleverapps.config.debugMode && (cleverapps.snapshotBar = new SnapshotBar), cleverapps.config.features.includes("highscore") && (cleverapps.highscore = new Highscore), t
            }, cleverapps.checkWebpSupport = function (e) {
                if (void 0 === cleverapps.config.webpSupport) {
                    var t, s;
                    if (cleverapps.platform.oneOf(Wechat) && cc.sys.os === cc.sys.OS_ANDROID) return (t = document.createElement("canvas")).width = 1, t.height = 1, s = t.getContext && t.getContext("2d"), cleverapps.config.webpSupport = s && t.toDataURL("image/webp").startsWith("data:image/webp"), void e();
                    var i = {
                        lossy: "UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",
                        lossless: "UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",
                        alpha: "UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA=="
                    },
                        n = 0,
                        o = 0,
                        a = cleverapps.waitNoMore(5e3, cleverapps.once(function () {
                            cleverapps.config.webpSupport = o === Object.keys(i).length, e()
                        }));
                    Object.keys(i).forEach(
                        function (s) {
                            cc.loader.loadImg("data:image/webp;base64," + i[s], function (e, t) {
                                e = !e && t && 0 < t.width && 0 < t.height;
                                e || console.log("webp " + s + " not supported"), n++, e && o++, e && n !== Object.keys(i).length || a()
                            })
                        })
                } else e()
            }, cleverapps.onStart = function () {
                if ("undefined" != typeof document && (document.title = cleverapps.config.title), cleverapps.platform = PlatformManager.create({
                    config: cleverapps.config,
                    dataLoader: cleverapps.DataLoader
                }), cleverapps.platformLogic = PlatformLogic.create(), cleverapps.config.debugMode && !cleverapps.isLocalhost() && !cc.sys.isNative && "https:" !== window.location.protocol) throw "https required: " + window.location;
                cleverapps.platform.initialize(function () {
                    cleverapps.platformLogic.onInitialize(), cleverapps.onPlatformStart()
                })
            }, cleverapps.onPlatformStart = function () {
                var e = cleverapps.createGlobalObjects(),
                    t = (cleverapps.askPermissionsAndInit(), -1e3),
                    s = cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, function () {
                        t = cc.director.getTotalFrames()
                    }),
                    i = cleverapps.wait(3, function () {
                        e && cleverapps.settings.language !== cleverapps.Settings.getDefaultLanguage() && !cleverapps.config.importMode && cleverapps.settings.setLanguage(cleverapps.Settings.getDefaultLanguage()), Messages.preload(cleverapps.settings.language, function () {
                            cc.eventManager.removeListener(s), cleverapps.silentIntro = cc.game.isPaused() || cc.director.getTotalFrames() - t <= 60 || cleverapps.loadedSnapshot, cleverapps.afterResourceLoaded(e)
                        })
                    }),
                    n = cleverapps.once(i),
                    o = (cleverapps.flags.norest ? n() : cleverapps.synchronizer._onceFirstSyncCompletedListener = n, cleverapps.platform.on("login", function (e) {
                        cleverapps.SocialManager.onLogin(e)
                    }), cleverapps.platform.once("changeStatus:" + Platform.SOCIAL, function () {
                        var e;
                        cleverapps.config.importMode || (e = cleverapps.social.isLoggedIn() && 0 === cleverapps.user.level && 0 === cleverapps.user.episode, setTimeout(n, e ? 1e4 : 3e3)), cleverapps.versionChecker.check(), cleverapps.social.isLoggedIn() || (!cleverapps.platform.haveTmpId() && !cleverapps.platform.haveDeviceId() && cleverapps.social instanceof CrazySocial ? (cleverapps.DataLoader.cleanAll(), cleverapps.DataLoader.setEnabled(!1), window.location.reload()) : cleverapps.synchronizer.syncWhenReady()), i()
                    }), cleverapps.platform.start(), cleverapps.platformLogic.onStart(), cleverapps.timeredThrottle(1e4, cleverapps.platform.connect.bind(cleverapps.platform)));
                cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, o), cleverapps.timeouts.setInterval(o, cleverapps.parseInterval("5 minutes")), cleverapps.checkWebpSupport(function () {
                    cleverapps.resolution.setupResolutionScale(), cc.sys.isNative && !cleverapps.config.webpSupport && resolutions[cleverapps.resolution.resolutionName].webp && (alert("Error no webp supported"), cleverapps.throwAsync("Error no webp supported")), cleverapps.Spine.prepare();
                    var e = Date.now(),
                        t = new LoaderScene(ResourceProcessor.calcProbablyNeed(), function () {
                            cleverapps.bundleLoader.loadBundles(ResourceProcessor.calcAlwaysNeed(), {
                                onSuccess: function () {
                                    if (cleverapps.DataLoader.load(
                                        cleverapps.DataLoaderTypes.THROWERROR)) throw cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.THROWERROR), "test error on load";
                                    cleverapps.ConsoleStream.sendLoadingTime("loaderScene " + (Date.now() - e) + "ms"), i()
                                }
                            })
                        });
                    cc.director.runScene(t), cc.director.setNextScene()
                })
            },
            function () {
                this.onInitializedListeners = {}, this.initialized = !1
            }),
        PointerHandler = (HasInitialized.prototype.setInitialized = function (e) {
            if (this.initialized = e, this.initialized) {
                for (var t in this.onInitializedListeners) (0, this.onInitializedListeners[t])();
                this.onInitializedListeners = {}
            }
        }, HasInitialized.prototype.isInitialized = function () {
            return this.initialized
        }, HasInitialized.prototype.whenInitialized = function (e, t) {
            this.isInitialized() ? t() : this.onInitializedListeners[e] = t
        }, cleverapps.styles = {}, cleverapps.styles.ALIGN_BOTTOM = "b", cleverapps.ASPECT_RATIO = 1920 / 1080, cleverapps.styles.SCENE_HEIGHT = 1334, cleverapps.styles.SCENE_MIN_WIDTH = Math.round(cleverapps.styles.SCENE_HEIGHT / cleverapps.ASPECT_RATIO / 1.137),
            cleverapps.styles.SCENE_MAX_WIDTH = Math.round(cleverapps.styles.SCENE_HEIGHT * cleverapps.ASPECT_RATIO * 1.644), cleverapps.styles.SQUARE_MODE_WIDTH = 1.97 * cleverapps.styles.SCENE_MIN_WIDTH, cleverapps.styles.HORIZONTAL_MODE_WIDTH = .52 * cleverapps.styles.SCENE_MAX_WIDTH, cleverapps.MIN_FRAME_SIZE = 20, cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE = 150, cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE_FS = 350, cleverapps.styles.SIDEBAR_WIDTH = 35, cleverapps.styles.MIN_SIDEBAR_X = 2, cleverapps.styles.COLORS = {
                BLACK: new cc.Color(0, 0, 0, 255),
                BLACK_STROKE: new cc.Color(0, 0, 0, 90),
                COLOR_GRAY: new cc.Color(200, 200, 200, 255),
                COLOR_DARK_GRAY: new cc.Color(150, 150, 150, 255),
                COLOR_VERY_DARK_GRAY: new cc.Color(100, 100, 100, 255),
                WHITE: new cc.Color(255, 255, 255, 255),
                GREEN: new cc.Color(13, 119, 0, 255),
                YELLOW: new cc.Color(255, 255, 0, 255),
                ORANGE: new cc.Color(255, 165, 0),
                PURPLE: new cc.Color(101, 24, 143, 255),
                HOVER: new cc.Color(230, 230, 230, 255),
                COLOR_BROWN: new cc.Color(60, 45, 25, 255),
                COLOR_RED: new cc.Color(255, 0, 0, 255),
                COLOR_BLUE: new cc.Color(0, 177, 249, 255),
                COLOR_LIGHT_BLUE: new cc.Color(93, 147, 213, 255),
                MESSAGE_GREEN: new cc.Color(4, 160, 41, 255),
                MESSAGE_RED: new cc.Color(246, 42, 71, 255),
                MESSAGE_PINK: new cc.Color(245, 0, 138, 255),
                LIFE_GREEN: new cc.Color(24, 200, 61, 255),
                PINK: new cc.Color(255, 102, 102, 255),
                COLOR_DARK_BROWN: new cc.Color(120, 85, 85, 255),
                HERO_STATS_UPGRADE: new cc.Color(57, 237, 7, 255),
                REWARDS_TEXT_STROKE_COLOR: new cc.Color(76, 98, 109, 255),
                GRAY_SCALE_COLOR: new cc.Color(135, 135, 135, 255),
                GRAY_SCALE_RESTORE_COLOR: new cc.Color(255, 255, 255, 255),
                DAILY_TOURNAMENT_TIMER: new cc.Color(130, 70, 40, 255),
                DARK_RED: new cc.Color(200, 0, 0, 255),
                COLOR_DARK_YELLOW: new cc.Color(255, 194, 9, 255),
                COLOR_BROWN_2: new cc.Color(173, 61, 0, 255),
                COLOR_WINDOW_TEXT: new cc.Color(130, 70, 40, 255),
                COLOR_VERYLIGHTBROWN: new cc.Color(220, 191, 144, 255),
                TOOLTIP_COLOR: new cc.Color(148, 49, 19, 255),
                COINS_REWARD_YELLOW: new cc.Color(255, 244, 55, 255),
                COINS_REWARD_STROKE_COLOR: new cc.Color(149, 67, 23, 255),
                MINIGAME_REWARD_TEXT: new cc.Color(66, 68, 80),
                DARK_TEXT_COLOR: new cc.Color(255, 255, 255, 255),
                DRAGGING_UNIT_COLOR: new cc.Color(180, 255, 180, 255),
                CHEST_REWARD_COLOR: new cc.Color(248, 233, 43, 255),
                CHEST_REWARD_STROKE_COLOR: new cc.Color(189, 102, 5),
                LIGHT_TEXT_STROKE_COLOR: new cc.Color(0, 0, 0, 125),
                LIGHT_TEXT_SHADOW_COLOR: new cc.Color(9, 0, 0, 100)
            }, cleverapps.styles.DECORATORS = {
                WHITE_TEXT_SHADOW: {
                    color: cleverapps.styles.COLORS.BLACK,
                    direction: cc.size(0, -4),
                    blur: 5
                },
                BROWN_STROKE: {
                    color: cleverapps.styles.COLORS.COLOR_BROWN_2,
                    size: 3
                },
                BUTTON_TEXT_SHADOW: {
                    color: cleverapps.styles.COLORS.BLACK,
                    direction: cc.size(0, 0),
                    blur: 5
                },
                BUTTON_TEXT_STROKE: {
                    color: cleverapps.styles.COLORS.BLACK,
                    size: 2
                },
                WINDOW_WHITE_TEXT_STROKE: {
                    color: cleverapps.styles.COLORS.BLACK,
                    size: 1
                },
                REWARDS_TEXT_STROKE: {
                    color: cleverapps.styles.COLORS.REWARDS_TEXT_STROKE_COLOR,
                    size: 3
                },
                DAILY_TOURNAMENT_TITLE_STROKE: {
                    color: new cc.Color(116, 17, 168, 255),
                    size: 4
                },
                TILE_SHOP_WINDOW_STROKE: {
                    color: new cc.Color(150, 111, 72, 255),
                    size: 2
                },
                TILE_SHOP_WINDOW_TITLE_SHADOW: {
                    color: new cc.Color(112, 109, 109, 255),
                    direction: cc.size(0, -4),
                    blur: 0
                },
                IMAGE_FONT_STROKE: {
                    color: cleverapps.styles.COLORS.BLACK_STROKE,
                    size: 1
                },
                IMAGE_FONT_SHADOW: {
                    color: cleverapps.styles.COLORS.BLACK,
                    direction: cc.size(0, -1),
                    blur: 3
                },
                TRANSPARENT_BLACK_2PX: {
                    color: cleverapps.styles.COLORS.BLACK_STROKE,
                    size: 2
                },
                WHITE_STROKE: {
                    color: cleverapps.styles.COLORS.WHITE,
                    size: 2
                },
                LIGHT_TEXT_STROKE: {
                    color: cleverapps.styles.COLORS.LIGHT_TEXT_STROKE_COLOR,
                    size: 1
                },
                LIGHT_TEXT_SHADOW: {
                    color: cleverapps.styles.COLORS.LIGHT_TEXT_SHADOW_COLOR,
                    direction: cc.size(0, -3),
                    blur: 3
                },
                RED_STROKE: {
                    color: cleverapps.styles.COLORS.COLOR_RED,
                    size: 2
                },
                BLUE_STROKE: {
                    color: cleverapps.styles.COLORS.COLOR_BLUE,
                    size: 2
                },
                MESSAGE_RED_STROKE: {
                    color: cleverapps.styles.COLORS.MESSAGE_RED,
                    size: 4
                },
                MESSAGE_PINK_STROKE: {
                    color: cleverapps.styles.COLORS.MESSAGE_PINK,
                    size: 4
                },
                MESSAGE_GREEN_STROKE: {
                    color: cleverapps.styles.COLORS.MESSAGE_GREEN,
                    size: 4
                },
                CHEST_REWARD_STROKE: {
                    color: cleverapps.styles.COLORS.CHEST_REWARD_STROKE_COLOR,
                    size: 2
                }
            }, cleverapps.styles.FONTS = cleverapps.overrideFonts({}, {
                VICTORY_TEXT: {
                    size: 56,
                    color: cleverapps.styles.COLORS.WHITE,
                    shadow: cleverapps.styles.DECORATORS.WHITE_TEXT_SHADOW
                },
                FBLOGINORINVITE_TEXT: {
                    size: 28,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                BUTTON_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.WHITE,
                    shadow: cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,
                    stroke: cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE
                },
                STRICT_TEXT: {
                    size: 30,
                    color: new cc.Color(83, 97, 106, 255),
                    font: bundles.chat.urls.strict_font_ttf
                },
                STRICT_WHITE_TEXT: {
                    size: 30,
                    color: cleverapps.styles.COLORS.WHITE,
                    font: bundles.chat.urls.strict_font_ttf
                },
                STRICT_BLACK_TEXT: {
                    size: 18,
                    color: cleverapps.styles.COLORS.BLACK,
                    font: bundles.chat.urls.strict_font_ttf
                },
                STRICT_BLUE_TEXT: {
                    size: 18,
                    color: cleverapps.styles.COLORS.COLOR_LIGHT_BLUE,
                    font: bundles.chat.urls.strict_font_ttf
                },
                TOURNAMENTSTORY_OFFERS_TEXT: {
                    size: 16,
                    color: cleverapps.styles.COLORS.WHITE,
                    shadow: cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,
                    stroke: cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE
                },
                TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                VICTORY_CHEST_TEXT: {
                    name: "default",
                    size: 50
                },
                SMALL_TEXT: {
                    size: 30,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                SMALL_TEXT_BROWN: {
                    size: 30,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                },
                WINDOW_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                },
                DAILY_TASK_BOOSTER_AMOUNT_TEXT: {
                    size: 60,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                },
                WINDOW_SMALL_TEXT: {
                    size: 30,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                },
                REWARDS_TEXT: {
                    size: 30,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.REWARDS_TEXT_STROKE
                },
                SMALL_TEXT_ERROR: {
                    size: 30,
                    color: cleverapps.styles.COLORS.COLOR_RED
                },
                EPISODE_TITLE_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                },
                WHITE_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                RED_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.COLOR_RED,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                BIG_BROWN_TITLE_TEXT: {
                    size: 30,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                },
                SMALL_BROWN_TITLE_TEXT: {
                    size: 15,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                },
                SMALL_WHITE_TEXT: {
                    name: "default",
                    size: 30,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                FORCE_MESSAGE_TEXT: {
                    name: "nostroke",
                    size: 40,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                },
                DAILY_TOURNAMENT_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.DAILY_TOURNAMENT_TIMER
                },
                WHITE_TITLE_TEXT: {
                    size: 60,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                TOOLTIP_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.TOOLTIP_COLOR
                },
                TOOLTIP_FONT: {
                    name: "nostroke",
                    color: cleverapps.styles.COLORS.TOOLTIP_COLOR,
                    size: 40
                },
                BOOSTERS_BEFORE_UNLOCK: {
                    size: 30,
                    color: cleverapps.styles.COLORS.WHITE
                },
                UNDERLINE: {
                    name: "default",
                    size: 25
                },
                MESSAGE_TEXT_NORMAL: {
                    size: 77,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.MESSAGE_GREEN_STROKE
                },
                MESSAGE_TEXT_WARNING: {
                    size: 77,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.MESSAGE_RED_STROKE
                },
                MESSAGE_TEXT_CONGRATS: {
                    size: 77,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.MESSAGE_PINK_STROKE
                },
                CHEST_REWARD_TEXT: {
                    size: 70,
                    color: cleverapps.styles.COLORS.CHEST_REWARD_COLOR,
                    stroke: cleverapps.styles.DECORATORS.CHEST_REWARD_STROKE
                }
            }), cleverapps.Environment = function () {
                this.episodeNo = levels.user.episode, this.levelNo = levels.user.level, this.scene = void 0
            }, cleverapps.Environment.prototype.setScene = function (e) {
                this.scene = e, cleverapps.firebase && cleverapps.firebase.setScreenName(this.getScreen(), this.getScene())
            }, cleverapps.Environment.prototype.isDailyCupScene = function () {
                return this.scene === cleverapps.Environment.SCENE_DAILY_CUP
            }, cleverapps.Environment.prototype.isMainScene = function () {
                return this.scene === cleverapps.Environment.SCENE_MAIN
            },
            cleverapps.Environment.prototype.isLoaderScene = function () {
                return this.scene === cleverapps.Environment.SCENE_LOADER
            }, cleverapps.Environment.prototype.isHeroesScene = function () {
                return this.scene === cleverapps.Environment.SCENE_HEROES
            }, cleverapps.Environment.prototype.isGameScene = function () {
                return this.scene === cleverapps.Environment.SCENE_GAME
            }, cleverapps.Environment.prototype.isEditorScene = function () {
                return this.scene === cleverapps.Environment.SCENE_EDITOR
            }, cleverapps.Environment.prototype.isChatScene = function () {
                return this.scene === cleverapps.Environment.SCENE_CHAT
            }, cleverapps.Environment.prototype.isMineScene = function () {
                return this.scene === cleverapps.Environment.SCENE_MINE
            }, cleverapps.Environment.prototype.isAdministratorScene = function () {
                return this.scene === cleverapps.Environment.SCENE_ADMINISTRATOR
            }, cleverapps.Environment.prototype.isSceneWithPreview = function () {
                return this.scene === cleverapps.Environment.SCENE_EDITOR || this.scene === cleverapps.Environment.SCENE_ADMINISTRATOR || this.scene === cleverapps.Environment.SCENE_WYSIWYG
            }, cleverapps.Environment.prototype.isWysiwygScene = function () {
                return this.scene === cleverapps.Environment.SCENE_WYSIWYG
            }, cleverapps.Environment.prototype.isAtlasAnalyzerScene = function () {
                return this.scene === cleverapps.Environment.SCENE_ATLAS_ANALYZER
            }, cleverapps.Environment.prototype.isBonusWorldScene = function () {
                return this.scene === cleverapps.Environment.SCENE_BONUS_WORLD
            }, cleverapps.Environment.prototype.isSlotMachineScene = function () {
                return this.scene === cleverapps.Environment.SCENE_SLOT_MACHINE
            }, cleverapps.Environment.prototype.isComicsScene = function () {
                return this.scene === cleverapps.Environment.SCENE_COMICS
            }, cleverapps.Environment.prototype.onOpenWindow = function () {
                cleverapps.firebase && cleverapps.firebase.setScreenName(this.getScreen(), this.getScene())
            }, cleverapps.Environment.prototype.onCloseWindow = function () {
                cleverapps.firebase && cleverapps.firebase.setScreenName(this.getScreen(), this.getScene())
            }, cleverapps.Environment.prototype.getActiveWindow = function () {
                var e = cleverapps.windows && cleverapps.windows.currentWindow();
                if (e && e.name) return e.name
            }, cleverapps.Environment.prototype.getScreen = function () {
                return this.getActiveWindow() || this.getScene()
            }, cleverapps.Environment.prototype.getScene = function () {
                return this.scene
            }, cleverapps.Environment.prototype.hasScene = function (e) {
                return -1 !== e.indexOf(this.scene)
            }, cleverapps.Environment.prototype.hasEpisode = function (e) {
                return -1 !== cleverapps.toArray(e).indexOf(String(this.episodeNo))
            }, cleverapps.Environment.SCENE_LOADER = "loaderScene", cleverapps.Environment.SCENE_MAIN = "main", cleverapps.Environment.SCENE_GAME = "game", cleverapps.Environment.SCENE_EDITOR = "editor", cleverapps.Environment.SCENE_ADMINISTRATOR = "administrator", cleverapps.Environment.SCENE_COMICS = "comics", cleverapps.Environment.SCENE_HEROES = "heroes", cleverapps.Environment.SCENE_DAILY_CUP = "dailycup",
            cleverapps.Environment.SCENE_TRIPEAKS = "tripeaks", cleverapps.Environment.SCENE_CHAT = "chat", cleverapps.Environment.SCENE_WYSIWYG = "wysiwyg", cleverapps.Environment.SCENE_BONUS_WORLD = "bonusworld", cleverapps.Environment.SCENE_SLOT_MACHINE = "slotmachine", cleverapps.Environment.SCENE_MINE = "mine", cleverapps.Environment.SCENE_ATLAS_ANALYZER = "atlasanalyzer", resolutionScale = 1, cleverapps.UI = {
                stableKeys: ["SKIP_RESOLUTION", "descent", "verticalAlignment", "opacity", "scale9", "parent", "scale", "minScale", "maxScale", "rotation", "baseScale", "zoomScale", "mobileScale", "innerScale", "squareScale", "zoom", "scaleX", "scaleY", "anchorX", "anchorY", "zIndex", "zOrder", "SIDEBAR_WIDTH", "MIN_SIDEBAR_X", "duration", "delay", "idleDelay", "visiblePages", "type", "hideDirection", "number", "dialogueStages", "skew", "anchor", "factorX", "factorY", "smallMargin", "threshold", "timeScale", "timeout", "fadeIn", "stretch", "columns", "align", "patternSize"],
                needUpdateSizes: function (e, t, s) {
                    return !(s instanceof cc.Color) && ((
                        "direction" !== t || "object" == typeof s) && !(0 <= cleverapps.UI.stableKeys.indexOf(t)))
                },
                updateSizes: function (i) {
                    function n(e) {
                        if (!e.isUpdated)
                            for (var t in e.isUpdated = !0, a.push(e), e) {
                                var s = e[t];
                                "number" == typeof s ? Array.isArray(e) || cleverapps.UI.needUpdateSizes(e, t, s) && (o[t] = !0, e[t] *= i, e[t] = Math.round(e[t])) : "object" == typeof s && cleverapps.UI.needUpdateSizes(e, t, s) && n(s)
                            }
                    }
                    var o = {},
                        a = [];
                    cleverapps.styles.isUpdated || (n(cleverapps.styles), cleverapps.config.fonts.forEach(function (e) {
                        e.originalSize = e.size + ""
                    }), n(cleverapps.config.fonts), cleverapps.values(Forces).forEach(function (e) {
                        e.style && n(e.style), e.finger && n(e.finger)
                    }), a.forEach(function (e) {
                        delete e.isUpdated
                    }), cleverapps.styles.isUpdated = !0)
                },
                selectSkinResources: function (e) {
                    function n(e, t, s) {
                        for (var i in e) "string" == typeof e[i] && (e[i] = e[i].replace("/%r/", "/" + t + "/")), s && "object" == typeof e[i] && n(e[i], t, s)
                    }
                    var t, s;
                    for (t in bundles) {
                        var i = bundles[t];
                        n(i.urls, e), n(i.frames, e), n(i.jsons, e)
                    }
                    for (s in cleverapps.styles) {
                        var o = cleverapps.styles[s];
                        n(o, e, !0)
                    }
                    if ("object" == typeof HeroesLibrary && n(HeroesLibrary, e, !0), "undefined" != typeof unpackedMap)
                        for (t in unpackedMap) - 1 !== t.indexOf("/%r/") && (unpackedMap[t.replace("/%r/", "/" + e + "/")] = unpackedMap[t], delete unpackedMap[t])
                },
                HORIZONTAL: 0,
                VERTICAL: 1,
                AUTO: 2,
                ALIGN_START: 1,
                ALIGN_CENTER: 2,
                ALIGN_END: 3,
                DOCK_RIGHT: "right",
                DOCK_LEFT: "left",
                DOCK_LR: "lr",
                arrangeWithMargins: function (n, o) {
                    var a = o.margin,
                        r = (void 0 === a && (a = 0), 0),
                        r = o.direction === cleverapps.UI.HORIZONTAL ? o.x || 0 : o.y || 0,
                        c = (c = o.iterator) || function (e, t, s) {
                            var i;
                            o.align !== cleverapps.UI.ALIGN_START && o.align !== cleverapps.UI.ALIGN_END || (i = o.direction === cleverapps.UI.HORIZONTAL ? e.height * e.scaleY / 2 : e.width * e.scaleX / 2, o.align === cleverapps.UI.ALIGN_END && (i = -i), o.direction === cleverapps.UI.HORIZONTAL ? s += i : t += i), e.setPositionRound(t, s)
                        };
                    return n.forEach(function (e, t) {
                        var s, t = (e = void 0 === o.direction || o.direction === cleverapps.UI.VERTICAL && !o.reversed ? n[n.length - 1 - t] : e).baseScaleX || e.baseScale || e.scaleX,
                            i = e.baseScaleY || e.baseScale || e.scaleY;
                        o.direction === cleverapps.UI.HORIZONTAL ? (s = e.y, void 0 !== o.y && (s = o.y - (.5 - e.anchorY) * e.height * Math.abs(i)), c(e, r + e.width * Math.abs(t) * e.anchorX, s), r += e.width * Math.abs(t)) : (s = e.x, void 0 !== o.x && (s = o.x - (.5 - e.anchorX) * e.width * Math.abs(t)), c(e, s, r + e.height * Math.abs(i) * e.anchorY), r += e.height * Math.abs(i)), r += a
                    }), r - a
                },
                calculateContentSize: function (e) {
                    var t = 0,
                        s = 0;
                    return e.children.forEach(function (e) {
                        t < e.x + e.width * e.scaleX / 2 && (t = e.x + e.width * e.scaleX / 2), s < e.y + e.height * e.scaleY / 2 && (s = e.y + e.height * e.scaleY / 2)
                    }), cc.size(Math.round(t), Math.round(s))
                },
                fitToBox: function (e, t) {
                    var s = e.scaleX < 0 ? -1 : 1,
                        i = e.scaleY < 0 ? -1 : 1,
                        n = t.maxScale || 1,
                        o = t.minScale || 0,
                        a = s * t.width / e.width || n,
                        t = i * t.height / e.height || n,
                        o = Math.max(o, Math.min(a, t, n));
                    e.setScaleX(o * s), e.setScaleY(o * i)
                },
                calcBoundaries: function (e, t) {
                    t = t || {};
                    var s = cleverapps.scenes.getRunningScene(),
                        i = cleverapps.UI.getSceneSize(),
                        n = cleverapps.UI.getBgSize(),
                        o = t.lovesPosition || t.centerPoint || s.convertToWorldSpace(cc.p(i.width / 2, i.height / 2)),
                        a = Math.min(i.width / 2,
                            i.height / 2),
                        r = cc.rect(o.x - a, o.y - a, 2 * a, 2 * a),
                        c = e.map(function (e) {
                            e = e.getGlobalBoundingBox();
                            if (cleverapps.config.debugMode && e.x < o.x && o.x < e.x + e.width && e.y < o.y && o.y < e.y + e.height) throw "Incorrect center point! Should be outside all boxes.";
                            return e
                        }),
                        t = cleverapps.bannerAd.getGlobalBoundingBox(),
                        s = (t && c.push(t), c.forEach(function (e) {
                            cc.rectIntersectsRect(r, e) && ((e = cc.nearestToRect(e, o)).x !== o.x && (a = Math.min(Math.abs(e.x - o.x), a)), e.y !== o.y && (a = Math.min(Math.abs(e.y - o.y), a)), r = cc.rect(o.x - a, o.y - a, 2 * a, 2 * a))
                        }), cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? ["y", "x"] : ["x", "y"]),
                        l = cc.p(r.x + r.width / 2, r.y + r.height / 2);
                    return s.forEach(function (s) {
                        var e, i = "x" === s ? "width" : "height";
                        r[s] = 0, r[i] = n[i], c.forEach(function (e) {
                            var t;
                            cc.rectIntersectsRect(r, e) && ((t = cc.rectIntersection(r, e)).width < 1e-6 || t.height < 1e-6 || (e[s] < o[s] ? (r[i] = r[s] + r[i] - (e[s] + e[i]), r[s] = e[s] + e[i]) : e[s] > l[s] && (r[i] = e[s] - r[s])))
                        }), "x" === s && (e = Math.min(l.x - r.x, r.x + r.width - l.x), r.x = l.x - e, r.width = 2 * e)
                    }), r
                },
                inflateToBoundaries: function (e, t, s) {
                    var i, n, t = cleverapps.UI.calcBoundaries(t, s),
                        o = s.viewRect || e.calcRect();
                    0 !== o.width && 0 !== o.height && (s.padding && (t = cc.rectSubPadding(t, cc.padding(s.padding))), i = Math.min(t.width / o.width, t.height / o.height, s.maxScale || 1), i = Math.max(i, s.minScale || .25), (cleverapps.config.editorMode || cleverapps.config.wysiwygMode && 1 !== cleverapps.scenes.getRunningScene().scale) && (i = 1), n = cc.rectGetCenter(t), s.lovesPosition && (n = cc.nearestToRect(cc.rectSubPadding(t, cc.padding(o.height * i / 2, o.width * i / 2)), s.lovesPosition)), n = e.parent.convertToNodeSpace(n), e.newScale = i, t = function () {
                        s.callback && s.callback(i)
                    }, s.animate ? (e.stopAllActions(), e.runAction(new cc.Sequence(new cc.DelayTime(s.delay || 0), new cc.Spawn(new cc.ScaleTo(.3, i), new cc.MoveTo(.3, n)), new cc.CallFunc(t)))) : (e.setScale(i), e.setPosition(n), t()))
                },
                fitToBounds: function (e, t, s, i) {
                    return e.map(function (e) {
                        return e.x < s.x && (e.x = s.x + i.x), e.x + t.width > s.x + s.width && (e.x = s.x + s.width - t.width - i.x), e
                    }), e
                },
                findPositionsAroundRect: function (e, t, s, i) {
                    var n = [];
                    return t.y - e.height - (i = i || {
                        x: 10,
                        y: 10
                    }).y >= s.y && n.push({
                        x: t.x,
                        y: t.y - e.height - i.y
                    }), t.y + t.height + e.height + i.y <= s.height && n.push({
                        x: t.x,
                        y: t.y + t.height + i.y
                    }), n.push({
                        x: t.x - e.width - i.x,
                        y: t.y
                    }), n.push({
                        x: t.x + t.width + i.x,
                        y: t.y
                    }), this.fitToBounds(n, e, s, i)
                },
                rectsIntersection: function (e, t) {
                    for (var s = 0; s < t.length; s++) {
                        var i = t[s];
                        if (cc.rectIntersectsRect(e, i)) return !0
                    }
                    return !1
                },
                checkPositions: function (e, t, s) {
                    for (var i = 0; i < e.length; i++) {
                        var n = e[i];
                        if (s.x = n.x, s.y = n.y, !this.rectsIntersection(s, t)) return n
                    }
                },
                findPosition: function (t, s, e) {
                    function i(e) {
                        return e = t.parent.convertToNodeSpace({
                            x: e.x + t.width * t.anchorX,
                            y: e.y + t.height * t.anchorY
                        })
                    }
                    s = s.map(function (e) {
                        return e = t.calculatePositionRound(e), t.parent.convertToWorldSpace({
                            x: e.x - t.width * (1 - t.anchorX),
                            y: e.y - t.height * (1 - t.anchorY)
                        })
                    }), e = e.map(function (e) {
                        return e.getBoundingBoxToWorld()
                    });
                    var n = t.getBoundingBoxToWorld(),
                        o = cleverapps.UI.getSceneSize(),
                        e = (e.forEach(function (e) {
                            s = s.concat(
                                this.findPositionsAroundRect(n, e, {
                                    x: 0,
                                    y: 270,
                                    width: o.width,
                                    height: o.height
                                }))
                        }.bind(this)), this.checkPositions(s, e, n));
                    return i(e || s[1])
                },
                animateDelta: function (e, t) {
                    var s, i;
                    if (e) return s = "string" == typeof e ? cleverapps.UI.generateOnlyText(e, t.font || cleverapps.styles.FONTS.WHITE_TEXT || cleverapps.styles.FONTS.TEXT) : cleverapps.UI.generateImageText(0 < e ? "+" + e : "" + e, t.font || cleverapps.styles.FONTS.WHITE_TEXT || cleverapps.styles.FONTS.TEXT), t.icon instanceof cc.Node ? i = t.icon : t.icon && (i = new cc.Sprite(t.icon)), i && (t.iconScale && i.setScale(t.iconScale), (s = new cleverapps.Layout([s, i], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: cleverapps.styles.UI.delta.margin
                    })).setCascadeOpacityEnabled(!0)), t.parent && t.parent.addChild(s), s.setPositionRound(t), t.zOrder && s.setLocalZOrder(t.zOrder), e = t.dy || cleverapps.styles.UI.delta.y, t.delay = t.delay || 0, i = t.duration || 2, s.opacity = 0, s.runAction(new cc.Sequence(new cc.DelayTime(t.delay), new cc.CallFunc(function () {
                        s.opacity = 255
                    }), new cc.Spawn(new cc.MoveBy(i, cc.p(0, e)).easing(cc.easeIn(.7)), new cc.Sequence(new cc.FadeTo(i, 0), new cc.RemoveSelf)))), s
                },
                getFontName: function (e) {
                    return "playable" === cleverapps.config.source ? "Playable-font" : (void 0 === e && (e = bundles.main.urls.basefont_ttf), "creator" === engine ? cc.LabelTTF.getCreatorFontName(e.srcs[0]) : e.name)
                },
                generateImageText: function (e, t, s, i) {
                    if (i && cleverapps.config.debugMode) throw "deprecated";
                    if (cleverapps.config.debugMode && !cleverapps.UI.ImageFont.IsApplicable(t, e)) throw console.log(t), "Not applicable image font: " + e;
                    return new cleverapps.UI.ImageFont(e, t, s)
                },
                generateOnlyText: function (e, t, s) {
                    var i = new cleverapps.UI.LabelTTF("", cleverapps.UI.getFontName(t.font));
                    return i.setString(e, s), i.setFont(t), i
                },
                __generateNotLocalizedText: function (e, t) {
                    var s = new cleverapps.UI.LabelTTF("", cleverapps.UI.getFontName(t.font));
                    return cc.LabelTTF.prototype.setString.call(s, e), s.setFont(t), s
                },
                generateTTFText: function (e, t, s) {
                    var i;
                    return cleverapps.UI.ImageFont.IsApplicable(t, e) ? i = new cleverapps.UI.ImageFont(e, t) : ((
                        i = new cleverapps.UI.LabelTTF("", cleverapps.UI.getFontName(t.font))).setString(e, s), i.setFont(t)), i
                },
                drawUnderline: function (e, t) {
                    var s = new cc.Scale9Sprite(bundles.digits.frames.underline_png);
                    return s.setContentSize2(e.width, t && t.height ? t.height : 1), s.setPositionRound(t || {
                        x: e.x + e.width / 10,
                        y: e.y - e.height / 10
                    }), s.setAnchorPoint2(), s.setColor(e._getFillStyle() || cc.color.BLACK), s
                },
                CheckBox: cc.Node.extend({
                    ctor: function (e) {
                        this._super(), (e = e || {}).styles = e.styles || {}, this.options = e, this.onChangeCallback = e.onChange || function () { }, this.selected = !1;
                        var t = [],
                            s = this.createCheckBox(),
                            i = (t.push(s), e.label && (this.createLabel(), t.push(this.label)), this.getStyles()),
                            t = new cleverapps.Layout(t, {
                                margin: i.margin,
                                padding: i.padding,
                                direction: void 0 !== e.direction ? e.direction : cleverapps.UI.HORIZONTAL,
                                reversed: e.direction === cleverapps.UI.VERTICAL
                            });
                        this.addChild(t), this.label && (this.label.y += i.label.offsetY), this.setAnchorPoint2(), this.setContentSize2(t.getContentSize()), t.setPositionRound(this.width / 2,
                            this.height / 2), cleverapps.UI.applyHover(this), this.options.label && this.options.label.clickable ? cleverapps.UI.onClick(this, this.onClick.bind(this)) : cleverapps.UI.onClick(s, this.onClick.bind(this)), this.setSelected(this.options.isSelected)
                    },
                    createCheckBox: function () {
                        var e = new cc.Sprite(this.options.bgImage || bundles.checkbox.frames.background_png);
                        return this.icon = new cc.Sprite(this.options.checkImage || bundles.checkbox.frames.check_mark_png), e.addChild(this.icon), this.icon.setPositionRound(e.width / 2, e.height / 2), this.icon.setVisible(!1), e
                    },
                    createLabel: function () {
                        this.label = cleverapps.UI.generateTTFText(this.options.label.text, this.options.label.font || cleverapps.styles.FONTS.WINDOW_TEXT)
                    },
                    onClick: function () {
                        this.setSelected(!this.isSelected()), cleverapps.audio.playSound(bundles.main.urls.click_effect)
                    },
                    isSelected: function () {
                        return this.selected
                    },
                    setSelected: function (e) {
                        this.selected !== e && (this.selected = e, this.icon.setVisible(e), this.onChangeCallback(this.selected))
                    },
                    getStyles: function () {
                        return this.styles || (this.styles = cleverapps.overrideStyles(cleverapps.styles.UI.CheckBox, this.options.styles, !0)), this.styles
                    }
                }),
                wrap: function (e, t) {
                    if (t = t || {}, 0 === e.children.length) return e;
                    for (var s, i, n, o, p = 0; p < e.children.length; p++) {
                        var a = e.children[p],
                            d = a.baseScaleX || a.baseScale || a.scaleX,
                            r = a.baseScaleY || a.baseScale || a.scaleY,
                            c = a.height,
                            u = a.width,
                            l = (t.considerRotation && (c = a.getBoundingBox().height, u = a.getBoundingBox().width, r = d = 1), a.y - c * r * a.anchorY),
                            c = l + c * r,
                            r = ((void 0 === s || l < s) && (s = l), (void 0 === i || i < c) && (i = c), a.x - u * d * a.anchorX),
                            l = r + u * d;
                        (void 0 === n || r < n) && (n = r), (void 0 === o || o < l) && (o = l)
                    }
                    return n = -(n = 0 < n ? 0 : n), s = -(s = 0 < s ? 0 : s), e.setContentSize2(n + (o = o < 0 ? 0 : o), s + (i = i < 0 ? 0 : i)), e.children.forEach(function (e) {
                        e.x += n, e.y += s
                    }), t.keepPosition ? e.setPositionRound(e.x + (e.anchorX - n / e.width) * e.width, e.y + (e.anchorY - s / e.height) * e.height) : e.setAnchorPoint2(), e
                },
                shake: function (e, t) {
                    var s = (t = t || {}).delay || 0,
                        i = t.power || 1,
                        n = t.moveTime || 0,
                        o = void 0 !== t.delayTimeAfterMove ? t.delayTimeAfterMove : .05,
                        a = (a = t.strength) || cleverapps.styles.UI.shake,
                        r = t.points || [{
                            x: 2,
                            y: 1,
                            r: 0
                        }, {
                            x: -1,
                            y: -2,
                            r: -1
                        }, {
                            x: -3,
                            y: 0,
                            r: 1
                        }, {
                            x: 0,
                            y: 2,
                            r: 0
                        }, {
                            x: 1,
                            y: -1,
                            r: 1
                        }, {
                            x: 0,
                            y: 0,
                            r: 0
                        }],
                        c = (c = t.base) || {
                            x: e.x,
                            y: e.y,
                            r: e.rotation
                        },
                        r = r.map(function (e) {
                            return new cc.Spawn(new cc.MoveTo(n, c.x + e.x * a.dx * i, c.y + e.y * a.dy * i), new cc.RotateTo(n, c.r + e.r))
                        }),
                        l = [new cc.DelayTime(s / 1e3)];
                    r.forEach(function (e) {
                        l.push(e), l.push(new cc.DelayTime(o))
                    }), t.afterShakeAction && l.push(t.afterShakeAction), e.stopAllActions(), e.runAction(new cc.Sequence(l))
                },
                wrapWithPadding: function (e, t, s) {
                    if (t = cc.padding(t), s) return e.children.forEach(function (e) {
                        e.x += t.left, e.y += t.bottom
                    }), e.width += t.left + t.right, e.height += t.top + t.bottom, e;
                    s = new cc.Node;
                    return s.addChild(e), s.setContentSize2(e.width * e.scaleX + t.left + t.right, e.height * e.scaleY + t.top + t.bottom), s.setAnchorPoint2(), e.setPosition(t.left + e.width * e.scaleX / 2, t.bottom + e.height * e.scaleY / 2), s
                },
                setDimensions: function (e, t) {
                    var s = t.width || e.width * e.scaleX,
                        t = t.height || e.height * e.scaleY,
                        s = (cleverapps.UI.fitToBox(e, {
                            width: s,
                            height: t
                        }),
                            Math.max(0, s - e.width * e.scaleX)),
                        t = Math.max(0, t - e.height * e.scaleY);
                    (s || t) && cleverapps.UI.wrapWithPadding(e, {
                        x: s / 2 / e.scaleX,
                        y: t / 2 / e.scaleY
                    }, !0)
                },
                targetContainPoint: function (e, t, s) {
                    if (s) {
                        var i = s.padding && s.padding.bottom || 0;
                        if (!cc.rectContainsPoint(cc.rect(0, -i, e.width, e.height + i), t)) return !1;
                        if (t.x += (s.width - e.width) / 2, t.x < 0 || t.x > s.width) return !1;
                        var n = s.width / 2,
                            o = s.height / 2,
                            i = (t.x > n && (t.x = s.width - t.x), t.y += i, e.height + i);
                        return (i < s.height && (i = s.height), t.y > o && t.y < i - o) ? !0 : (t.y > o && (t.y = i - t.y), !(t.y < 0 || t.y > o) && (n - t.x) * o < t.y * n)
                    }
                    return i = e.clickRect || (s = e.clickPosition || {
                        x: 0,
                        y: 0
                    }, cc.rect(s.x, s.y, e.width, e.height)), cc.rectContainsPoint(i, t)
                },
                onDrag: function (e, t) {
                    return new PointerHandler(e, t = t || {})
                },
                onPressed: function (e, t, s) {
                    return (s = s || {}).onPressed = t, new PointerHandler(e, s)
                },
                onClick: function (e, t, s) {
                    return (s = s || {}).onClick = t, new PointerHandler(e, s)
                },
                applyHover: function (e, t) {
                    return (t = t || {}).hover = !0, new PointerHandler(e, t)
                },
                convertToGrayScale2: function (e, t) {
                    e.setColor(
                        cleverapps.styles.COLORS.BLACK), e.setOpacity(100), t && (e.setColor(cleverapps.styles.COLORS.WHITE), e.setOpacity(255))
                },
                convertToGrayScale: function (e, t) {
                    "undefined" != typeof gl && (e.spine && (e = e.spine), t ? e.normalShader ? e.setShaderProgram(e.normalShader) : e.opacity = 255 : cc.shaderCache && cleverapps.Shaders && cc.shaderCache._programs[cleverapps.Shaders.GRAYSCALE_SPRITE_KEY] ? (e.normalShader || (e.normalShader = e.getShaderProgram()), console.log(222), e.setShaderProgram(cc.shaderCache.getProgram(cleverapps.Shaders.GRAYSCALE_SPRITE_KEY))) : e.opacity = 150)
                },
                _setShaderUpdate: function (e, t, s) {
                    var i;
                    e._superUpdate ? (e.update = e._superUpdate.bind(e), delete e._superUpdate, e.normalShader && e.setShaderProgram(e.normalShader)) : cc.shaderCache && cleverapps.Shaders && cc.shaderCache.getProgram(t) && (e.normalShader || (e.normalShader = e.getShaderProgram()), e.setShaderProgram(cc.shaderCache.getProgram(t)), i = e.getShaderProgram(), e._superUpdate = e.update, e.scheduleUpdate(), e.update = function (e) {
                        s(e, i)
                    })
                },
                toggleFlickering: function (s, e) {
                    var i, n, o, a;
                    "undefined" != typeof gl && (i = (e = e || {}).flickSpeed || 2, n = e.flickPause || .2, (o = e.color) && Array.isArray(o) && !(o.length < 3) || (o = [.35, .35, .35]), a = 0, this._setShaderUpdate(s, cleverapps.Shaders.FLICKER_SHADER_KEY, function (e, t) {
                        s._superUpdate(e), t.use(), a += e;
                        e = Math.abs(Math.sin(Math.max(a - n, 0) * i)), e = Math.max(0, Math.min(1, e));
                        t.setUniformLocationWith1f("sineTime", e), t.setUniformLocationWith3f("flickColor", o[0], o[1], o[2])
                    }))
                },
                toggleBlur: function (l, p) {
                    var s, d, u, e, t, i;
                    (p = p || {}).animate = p.animate || {}, "undefined" != typeof gl ? (s = p.blurLength || .005, d = p.strength || 1, u = function (e, t) {
                        l.blurShader.use(), l.blurShader.setUniformLocationWith1f("u_blurOffset", s), l.blurShader.setUniformLocationWith1f("u_blurStrength", e), l.blurShader.setUniformLocationWith1f("u_extent", t)
                    }, e = function (e, t) {
                        t = t || function () { };
                        var s = p.animate.type || cleverapps.UI.BLUR_ANIMATION.FADE,
                            i = void 0 !== p.animate.time ? p.animate.time : .2,
                            n = p.animate.steps || 20,
                            o = e ? d : 0,
                            a = e ? 1 : 0,
                            r = d / n,
                            c = 1 / n;
                        l.blurAction = l.runAction(new cc.Sequence(
                            new cc.Repeat(new cc.Sequence(new cc.CallFunc(function () {
                                s === cleverapps.UI.BLUR_ANIMATION.FADE ? u(o += e ? -r : r, 1) : u(d, a += e ? -c : c)
                            }), new cc.DelayTime(i / n)), n), new cc.CallFunc(t))), l.blurAction.whenDone = t
                    }, l.blurAction && !l.blurAction.isDone() && (l.stopAction(l.blurAction), l.blurAction.whenDone(), delete l.blurAction), l.normalShader ? (t = function () {
                        l.setShaderProgram(l.normalShader), delete l.normalShader, delete l.blurShader
                    }, p.animate ? e(!0, function () {
                        t(), p.animate.callback && p.animate.callback()
                    }) : t()) : cc.shaderCache && cleverapps.Shaders && (i = cleverapps.Shaders.BLUR_FADE_KEY, p.animate.type === cleverapps.UI.BLUR_ANIMATION.CURTAIN && (i = p.animate.reverseCurtain ? cleverapps.Shaders.BLUR_CURTAIN_REVERSE_KEY : cleverapps.Shaders.BLUR_CURTAIN_KEY), cc.shaderCache.getProgram(i) && (l.normalShader = l.getShaderProgram(), l.setShaderProgram(cc.shaderCache.getProgram(i)), l.blurShader = l.getShaderProgram(), p.animate ? e(!1, p.animate.callback) : u(d, 1)))) : p.animate && p.animate.callback && p.animate.callback()
                },
                cutPlayerName: function (e, t) {
                    var s;
                    return e.length > t && (s = (e = e.replace(/^[\s]+/, "")).lastIndexOf(" ", t), e = e.substr(0, s = s <= 0 ? t : s)), e
                },
                getSceneSize: function () {
                    return cc.size(cleverapps.resolution.sceneSize)
                },
                getBgSize: function () {
                    return cc.size(cleverapps.resolution.bgSize)
                },
                getBgOffset: function () {
                    return cleverapps.UI.getBgSize().height - cleverapps.UI.getSceneSize().height
                },
                createPatternSprite: function (e, t) {
                    void 0 === t && (t = cleverapps.UI.getSceneSize());
                    var s, e = new cc.Sprite(e);
                    return "auto" === t.width && (t.width = e.width - 2), "auto" === t.height && (t.height = e.height - 2), "undefined" != typeof gl && e.getTexture() ? (e.getTexture().setTexParameters({
                        minFilter: gl.NEAREST,
                        magFilter: gl.NEAREST,
                        wrapS: gl.REPEAT,
                        wrapT: gl.REPEAT
                    }), (s = e.getTextureRect()).width = t.width, s.height = t.height, e.setTextureRect(s)) : t.width && t.height && e.setScale(t.width / e.width, t.height / e.height), e.setPositionRound(t.width / 2, t.height / 2), e
                },
                createSprite: function (e) {
                    if (!e) return new cc.Sprite;
                    var t, s, i, n, o = e && e.image || e,
                        o = processVirtualImage(o);
                    if (void 0 !== e.scale9 && !1 !== e.scale9) return t = cleverapps.UI.createScale9Sprite(o, e.scale9), i = e.sizes ? (n = e.sizes[cleverapps.resolution.mode].width, e.sizes[cleverapps.resolution.mode].height) : (n = e.width, e.height), s = e.rotation, (s = e.rotations ? e.rotations[cleverapps.resolution.mode] : s) && (a = i, i = n, n = a, t.setRotation(s)), t.setContentSize2(n, i), t;
                    var a = o;
                    return (o = new cc.Sprite(o)).scale = e.scale || 1, o.spriteFrameName = a, o
                },
                getScale9Rect: function (e, t) {
                    var s = {};
                    t === cleverapps.UI.Scale9Rect.TwoPixelXY ? (s.x = .5, s.y = .5) : t === cleverapps.UI.Scale9Rect.TwoPixelX ? s.x = .5 : t === cleverapps.UI.Scale9Rect.TwoPixelY ? s.y = .5 : t && (s.x = t.x, s.y = t.y);
                    var t = (e instanceof cc.SpriteFrame ? e : cc.spriteFrameCache.getSpriteFrame(e)).getOriginalSize(),
                        e = "number" == typeof s.x,
                        i = Math.round(e ? (t.width - 2) * s.x : t.width / 3),
                        e = Math.round(e ? 2 : t.width / 3),
                        n = "number" == typeof s.y,
                        s = Math.round(n ? (t.height - 2) * s.y : t.height / 3),
                        n = Math.round(n ? 2 : t.height / 3);
                    return cc.rect(i, s, e, n)
                },
                createScale9Sprite: function (e, t, s) {
                    if (!(
                        e instanceof cc.SpriteFrame ? e : cc.spriteFrameCache.getSpriteFrame(e))) {
                        if (cleverapps.config.debugMode) throw "No scale9 sprite: " + e;
                        return new cc.Scale9Sprite
                    }
                    t = new cc.Scale9Sprite(e, cleverapps.UI.getScale9Rect(e, t, s));
                    return t.spriteFrameName = e, t
                },
                createAnimation: function (e) {
                    e = e.spine;
                    var t = new cleverapps.Spine(e.json);
                    return t.setAnimation(0, e.openAnimation, !1), e.idleAnimation && t.setCompleteListener(function () {
                        t.setAnimation(0, e.idleAnimation, !0)
                    }), t
                },
                isNodeOnScene: function (e, t, s) {
                    var i = cleverapps.scenes.getRunningScene(),
                        n = i.convertToNodeSpace(e.convertToWorldSpace(cc.p(0, 0))),
                        e = i.convertToNodeSpace(e.convertToWorldSpace(cc.p(e.width, e.height))),
                        e = cc.rect(n.x, n.y, e.x - n.x, e.y - n.y);
                    return t = e.width < i.width && t || 0, s = e.height < i.height && s || 0, !(e.x + (1 - t) * e.width < 0 || e.x + t * e.width > i.width) && !(e.y + (1 - s) * e.height < 0 || e.y + s * e.height > i.height)
                }
            }, cleverapps.styles.UI = {
                delta: {
                    y: 20,
                    icon: {
                        margin: 5
                    }
                },
                Avatar: {
                    x: 8,
                    top: 8,
                    bottom: 8,
                    frame: {
                        scale: 1,
                        dx: 0,
                        dy: 0
                    }
                },
                shake: {
                    dx: 1,
                    dy: 1
                },
                CheckBox: {
                    margin: 10,
                    label: {
                        offsetY: 0
                    }
                }
            }, cleverapps.UI.Scale9Rect = {
                Default: 0,
                TwoPixelX: 1,
                TwoPixelY: 2,
                TwoPixelXY: 3
            }, cleverapps.UI.BLUR_ANIMATION = {
                FADE: 1,
                CURTAIN: 2
            }, cc.Class.extend({
                ctor: function (e, t) {
                    t = t || {}, this.touches = {}, this.target = e, this.swallowEvents = t.swallowEvents, this.filter = t.filter || function () {
                        return !0
                    }, this.onMouseZoom = t.onMouseZoom, this.onPinchZoom = t.onPinchZoom, this.usesPress = Boolean(t.onPressed), this.usesPress && (this.onPressed = t.onPressed), this.onOuterTouch = t.onOuterTouch, this.usesClick = Boolean(t.onClick || t.onLongClick || t.onDoubleClick), this.usesClick && (this.onClick = t.onClick, cleverapps.config.debugMode && (this.target.clickPointerHandler = this), this.onLongClick = t.onLongClick, this.onDoubleClick = t.onDoubleClick, this.longClickDuration = PointerHandler.LONG_CLICK_TIMEOUT, this.doubleClickDuration = PointerHandler.DOUBLE_CLICK_WAIT), this.usesDrag = Boolean(t.followPointer || t.onDragStart || t.onDragMove || t.onDragEnd), this.usesDrag && (this.onDragStart = t.onDragStart || function () {
                        return !0
                    },
                        this.onDragMove = cleverapps.throttle(PointerHandler.DRAG_THROTTLE, t.onDragMove || function () { }), this.onDragEnd = t.onDragEnd || function () { }, "function" == typeof t.followPointer ? this.followPointer = t.followPointer : t.followPointer && (this.followPointer = function (e) {
                            this.target.setPositionRound(this.target.parent.convertTouchToNodeSpace(e))
                        }.bind(this)), this.instantDrag = t.instantDrag, this.dragHoldTime = t.holdForDrag ? PointerHandler.DRAG_HOLD_TIME : 0), this.ignoreScale = this.onPinchZoom || this.usesDrag || this.usesPress || t.ignoreScale, (this.usesPress || this.usesClick || this.usesDrag || this.onPinchZoom || this.swallowEvents) && (this.touchListener = cc.eventManager.addListener({
                            event: cc.EventListener.TOUCH_ONE_BY_ONE,
                            onTouchBegan: function (e, t) {
                                if (this.handleTouchBegan(e, t)) return !0;
                                this.onOuterTouch && this.onOuterTouch(e, t)
                            }.bind(this),
                            onTouchMoved: function (e, t) {
                                this.handleTouchMoved(e, t)
                            }.bind(this),
                            onTouchEnded: function (e, t) {
                                this.handleTouchEnded(e, t)
                            }.bind(this),
                            onTouchCancelled: this.handleTouchCancelled.bind(this)
                        }, e)), this.useHover = Boolean(t.hover || t.onMouseOver || t.onMouseOut), this.useHover && (this.onMouseOver = t.onMouseOver || function () {
                            e.applyInteractiveScale()
                        }, this.onMouseOut = t.onMouseOut || function () {
                            e.applyInteractiveScale()
                        }), (this.useHover || this.onMouseZoom || this.swallowEvents) && (this.hoverListener = cc.eventManager.addListener({
                            event: cc.EventListener.MOUSE,
                            onMouseMove: this.onMouseMove.bind(this),
                            onMouseScroll: this.onMouseScroll.bind(this)
                        }, e)), this.isLabelTTF = e instanceof cc.LabelTTF
                },
                remove: function () {
                    this.touchListener && (cc.eventManager.removeListener(this.touchListener), this.touchListener = void 0), this.hoverListener && (cc.eventManager.removeListener(this.hoverListener), this.hoverListener = void 0), this.ignoreScale || (this.target.removeInteractiveStates(this.__instanceId + "_"), this.target.applyInteractiveScale())
                },
                setEnabled: function (e) {
                    this.touchListener && this.touchListener.setEnabled(e), this.hoverListener && this.hoverListener.setEnabled(e), e || (this.target.removeInteractiveStates(
                        this.__instanceId + "_"), this.target.applyInteractiveScale())
                },
                isTouchApplicable: function (e) {
                    var t = this.target.convertToNodeSpace(e.getLocation()),
                        e = this.target.clickRect || cc.rect(0, 0, this.target.width, this.target.height);
                    if (this.isLabelTTF && (e.x *= cc.view.getDevicePixelRatio(), e.y *= cc.view.getDevicePixelRatio(), e.width *= cc.view.getDevicePixelRatio(), e.height *= cc.view.getDevicePixelRatio()), !cc.rectContainsPoint(e, t)) return !1;
                    if (!this.target.isDisplayed()) return !1;
                    if (!cleverapps.meta.checkEventNode(this.target)) return !1;
                    for (var s = this.target; s.parent; s = s.parent) {
                        var t = cc.pointApplyAffineTransform(t, s.getNodeToParentTransform()),
                            i = s.parent.getCropContainer();
                        if (i && !cc.rectContainsPoint(i, t)) return !1
                    }
                    return !0
                },
                isInClickThreshold: function (e) {
                    var t = cleverapps.styles.PointerHandler.clickThreshold;
                    return cc.pDistanceSQ(e.getStartLocation(), e.getLocation()) < t * t
                },
                bubblesFromInnerNode: function (e) {
                    if (e.nodes && !e.nodes[this.target.__instanceId]) return !1;
                    if (!e.nodes) {
                        e.nodes = {},
                            e.innermost = this.__instanceId;
                        for (var t = this.target; t; t = t.parent) e.nodes[t.__instanceId] = !0
                    }
                    return !0
                },
                captureTouch: function (e) {
                    e.handler = this.__instanceId
                },
                canCaptureTouch: function (e) {
                    return !e.handler || e.handler === this.__instanceId
                },
                needProcessTouch: function (e) {
                    return !!this.canCaptureTouch(e) && (!!this.isTouchApplicable(e) && (!!this.filter(e) && this.bubblesFromInnerNode(e)))
                },
                handleTouchBegan: function (e, t) {
                    if (!this.needProcessTouch(e)) return !1;
                    this.swallowEvents && this.captureTouch(e);
                    var s = PointerHandler.STATE_NONE;
                    return this.usesDrag ? s = PointerHandler.STATE_DRAG_START : this.usesClick && (s = PointerHandler.STATE_CLICK), this.onPressed && this.onPressed(e, t) ? (s = PointerHandler.STATE_NONE, this.captureTouch(e)) : !this.onPinchZoom || (t = cleverapps.values(this.touches).find(function (e) {
                        return this.canCaptureTouch(e.touch) && !e.touch.pinchTouch
                    }.bind(this))) && (t = t.touch, s = PointerHandler.STATE_NONE, e.pinchTouch = t, e.pinchPrevPosition = e.getLocation(), this.captureTouch(e), t.pinchTouch = e,
                        t.pinchPrevPosition = t.getLocation(), this.captureTouch(t)), this.touches[e.__instanceId] = {
                            touch: e,
                            state: s,
                            startTime: cleverapps.timeouts.getTime()
                        }, this.ignoreScale || e.innermost !== this.__instanceId || (this.target.setInteractiveState(this.__instanceId + "_" + e.__instanceId, "pressed"), this.target.applyInteractiveScale()), (this.usesClick || this.onPinchZoom) && (e.useThreshold = !0), this.instantDrag && this.handleTouchMoved(e), !0
                },
                handleTouchMoved: function (e, t) {
                    var s, i, n = this.touches[e.__instanceId];
                    if (cleverapps.meta.checkEventNode(this.target) && n && this.canCaptureTouch(e)) {
                        if (e.pinchTouch) return s = e.pinchTouch, i = this.calcPinchDistance(e.pinchPrevPosition, s.pinchPrevPosition), i = this.calcPinchDistance(e.getLocation(), s.getLocation()) - i, void (3 < Math.abs(i) && (e.pinchPrevPosition = e.getLocation(), s.pinchPrevPosition = s.getLocation(), this.onPinchZoom(85e-5 * i)));
                        if (n.state === PointerHandler.STATE_DRAG_START) {
                            if (n.startTime + this.dragHoldTime > cleverapps.timeouts.getTime()) return;
                            if (
                                e.useThreshold && !this.instantDrag && this.isInClickThreshold(e)) return;
                            this.handleDragStart(e, t, n) ? (n.state = PointerHandler.STATE_DRAG_MOVE, this.captureTouch(e)) : n.state = PointerHandler.STATE_CLICK
                        }
                        n.state === PointerHandler.STATE_DRAG_MOVE && (this.followPointer && this.followPointer(e, t), this.handleDragMove(e, t))
                    }
                },
                handleTouchEnded: function (e, t) {
                    cleverapps.playSession.notifyActive(), cleverapps.payments.notifyActive();
                    var s = this.touches[e.__instanceId];
                    if ((delete this.touches[e.__instanceId], this.ignoreScale || e.innermost !== this.__instanceId || (this.target.setInteractiveState(this.__instanceId + "_" + e.__instanceId), this.target.applyInteractiveScale()), cleverapps.meta.checkEventNode(this.target)) && (s && this.canCaptureTouch(e) && (e.pinchTouch && ((i = e.pinchTouch).pinchTouch = void 0, i.pinchPrevPosition = void 0, e.pinchTouch = void 0, e.pinchPrevPosition = void 0), s.state === PointerHandler.STATE_DRAG_START && (s.state = PointerHandler.STATE_CLICK), s.state === PointerHandler.STATE_DRAG_MOVE && (this.handleDragMove(e, t),
                        this.handleDragEnd(e, t, s), this.instantDrag && this.isInClickThreshold(e) ? s.state = PointerHandler.STATE_CLICK : s.state = PointerHandler.STATE_NONE), s.state !== PointerHandler.STATE_CLICK || this.usesClick || (s.state = PointerHandler.STATE_NONE), s.state === PointerHandler.STATE_CLICK && (s.state = PointerHandler.STATE_NONE, this.isTouchApplicable(e)))))
                        if (this.captureTouch(e), this.onLongClick && s.startTime + this.longClickDuration <= cleverapps.timeouts.getTime()) this.onLongClick(e, t);
                        else if (this.onDoubleClick) {
                            if (this.lastClick) {
                                var i = this.lastClick;
                                if (this.lastClick = void 0, clearTimeout(i.timeout), this.isInClickThreshold(i.touch)) return void this.onDoubleClick(e, t)
                            }
                            s = setTimeout(function () {
                                clearTimeout(this.lastClick.timeout), this.lastClick = void 0, this.handleClick(e, t)
                            }.bind(this), this.doubleClickDuration);
                            this.lastClick = {
                                touch: e,
                                timeout: s
                            }
                        } else this.handleClick(e, t)
                },
                handleTouchCancelled: function (e, t) {
                    return this.handleTouchEnded(e, t)
                },
                handleClick: function (e, t) {
                    this.onClick && this.onClick(e, t)
                },
                handleDragStart: function (e, t, s) {
                    if (this.onDragStart(e, t)) return cleverapps.meta.display({
                        focus: "dragging",
                        keepControls: !0,
                        action: function (e) {
                            cleverapps.meta.setEventNodes([this.target]), s.freeFocus = e
                        }.bind(this)
                    }), !0
                },
                handleDragMove: function (e, t) {
                    this.onDragMove(e, t)
                },
                handleDragEnd: function (e, t, s) {
                    s.freeFocus && (s.freeFocus(), s.freeFocus = void 0), this.onDragEnd(e, t)
                },
                onMouseMove: function (e) {
                    var t;
                    cleverapps.UI.disableHover || this.canCaptureTouch(e) && (this.swallowEvents && this.captureTouch(e), t = cleverapps.timeouts.getTime(), this.lastMouseMoveTime !== t && (this.lastMouseMoveTime = t, this.useHover && this.handleMouseMove(e)))
                },
                onMouseScroll: function (e) {
                    var t;
                    this.canCaptureTouch(e) && (this.swallowEvents && this.captureTouch(e), t = cleverapps.timeouts.getTime(), this.lastMouseScrollTime !== t && (this.lastMouseScrollTime = t, this.onMouseZoom && this.handleMouseScroll(e)))
                },
                handleMouseMove: function (e) {
                    e = this.isTouchApplicable(e) && this.filter() ? "mouseover" : void 0;
                    this.target.setInteractiveState(
                        this.__instanceId + "_mouseover", e) && (e ? this.onMouseOver() : this.onMouseOut())
                },
                handleMouseScroll: function (e) {
                    this.isTouchApplicable(e) && this.filter() && (0 !== (e = e.getScrollY()) && this.onMouseZoom(e = 0 < e ? .1 : -.1))
                },
                calcPinchDistance: function (e, t) {
                    return Math.abs(e.x - t.x) + Math.abs(e.y - t.y)
                }
            })),
        Scale9SpriteResizeTo = (PointerHandler.STATE_NONE = 0, PointerHandler.STATE_CLICK = 1, PointerHandler.STATE_DRAG_START = 2, PointerHandler.STATE_DRAG_MOVE = 3, PointerHandler.DRAG_THROTTLE = 50, PointerHandler.LONG_CLICK_TIMEOUT = 400, PointerHandler.DOUBLE_CLICK_WAIT = 300, PointerHandler.DRAG_HOLD_TIME = 300, cleverapps.styles.PointerHandler = {
            clickThreshold: 20
        }, cc.PlaySound = cc.ActionInstant.extend({
            sound: void 0,
            ctor: function (e, t) {
                cc.ActionInstant.prototype.ctor.call(this), this.sound = e, this.options = t
            },
            update: function () {
                cleverapps.audio.playSound(this.sound, this.options)
            },
            reverse: function () {
                return this
            },
            clone: function () {
                return new cc.PlaySound(this.sound, this.options)
            }
        }), cc.CollectAnimation = cc.BezierBy.extend({
            ctor: function (e, t, s) {
                this.flyTo = t, this.endPosition = this.getEndPosition(t), this.options = s || {}, this._super(e, [])
            },
            startWithTarget: function (e) {
                this._super(e), this.flyTo.isRunning() && (this.endPosition = this.getEndPosition(this.flyTo));
                e = cc.CollectAnimation.calc3Points(e, this.endPosition, this.options);
                e[2] = cc.pSub(e[2], e[0]), e[1] = cc.pSub(e[1], e[0]), e[0] = cc.p(0, 0), this._config = e
            },
            getEndPosition: function (e) {
                return e.convertToWorldSpace(cc.p(e.width / 2, e.height / 2))
            },
            update: function (e) {
                var t, s;
                this.flyTo.isRunning() && (t = this.getEndPosition(this.flyTo), (s = this._config)[2] = cc.pAdd(s[2], cc.pSub(this.target.parent.convertToNodeSpace(t), this.target.parent.convertToNodeSpace(this.endPosition))), this.endPosition = t), this._super(e)
            }
        }), cc.CollectAnimation.calc3Points = function (e, t, s) {
            s = s || {};
            var i, n, o, a, r, c, l = e.getPosition(),
                t = e.parent.convertToNodeSpace(t);
            return [l, s.jump ? cc.p(l.x, t.y) : (i = cc.pSub(t, l), n = Math.min(cleverapps.styles.CollectAnimation.height, 1.5 * cc.pLength(i)), s.randomPath && (n *= Math.random() + .5), n = cc.pMult(
                cc.pNormalize(cc.pPerp(i)), n), o = cc.pMidpoint(l, t), r = cc.pAdd(o, n), c = cc.pSub(o, n), a = cleverapps.scenes.getRunningScene(), e = e.parent.convertToNodeSpace(cc.p(a.width / 2, a.height / 2)), a = cc.pDistance(r, e), r = cc.pDistance(c, e), c = s.randomPath ? o : cc.pSub(l, cc.pMult(i, .33)), a < r ? cc.pAdd(c, n) : cc.pSub(c, n)), t]
        }, cc.CollectAnimation.calcDuration = function (e) {
            var t = e.points,
                s = (t || (s = cc.CollectAnimation.prototype.getEndPosition(e.to), t = cc.CollectAnimation.calc3Points(e.targetNode, s, e)), cc.pDistance(t[0], t[1]) + cc.pDistance(t[1], t[2])),
                t = e.speed || cleverapps.styles.CollectAnimation.speed;
            return Math.min(1, Math.max(.3, s / t))
        }, cleverapps.styles.CollectAnimation = {
            height: 700,
            speed: 2600
        }, cc.CollectEffect = cc.CallFunc.extend({
            ctor: function (e) {
                var t = e.baseScaleX || e.baseScale || 1,
                    s = e.baseScaleY || e.baseScale || 1;
                this._super(function () {
                    e.isRunning() && e.runAction(new cc.Sequence(new cc.ScaleTo(.15, 1.1 * t, 1.1 * s).easing(cc.easeOut(2)), new cc.ScaleTo(.15, t, s).easing(cc.easeInOut(2))))
                })
            }
        }), cleverapps.styles.CollectEffect = {
            sparks: {
                x: -7,
                y: 5
            }
        }, cc.AnimateDelta = cc.CallFunc.extend({
            ctor: function (e, t, s) {
                s = Object.assign({
                    parent: e,
                    font: cleverapps.styles.FONTS.SCENE_ANIMATE_DELTA_TEXT
                }, s), this._super(function () {
                    e.isRunning() && t && cleverapps.UI.animateDelta(t, s)
                })
            }
        }), cc.JumpAnimation = function (e, t, s, i) {
            var n = cc.p(t.x, t.y),
                t = cc.p(t.x + s.x, t.y + s.y),
                s = cc.pMidpoint(n, t);
            return s.y += i, new cc.BezierTo(e, [n, s, t]).easing(cc.easeIn(1))
        }, cc.MoveInCircle = cc.ActionInterval.extend({
            ctor: function (e, t, s) {
                cc.ActionInterval.prototype.ctor.call(this), this._center = t, this.position = s, this.initWithDuration(e, t)
            },
            initWithDuration: function (e, t) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, e) && (this._center = t, !0)
            },
            clone: function () {
                return cc.log("MoveInCircle.clone(): clone hasn't been supported."), null
            },
            reverse: function () {
                return cc.log("MoveInCircle.reverse(): reverse hasn't been supported."), null
            },
            startWithTarget: function (e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e), this._startPosition = e.getPosition(),
                    this._startAngle = Math.atan2(this._startPosition.y - this._center.y, this._startPosition.x - this._center.x), this._radius = cc.pDistance(this._startPosition, this._center), this._toAngle = Math.atan2(this.position.y - this._center.y, this.position.x - this._center.x), this._toAngle <= 0 && (this._toAngle += 2 * Math.PI), this._toAngle += 2 * Math.PI
            },
            update: function (e) {
                e = this._computeEaseTime(e);
                e = this._startAngle + (this._toAngle - this._startAngle) * e;
                this.target.x = Math.cos(e) * this._radius + this._center.x, this.target.y = Math.sin(e) * this._radius + this._center.y
            }
        }), cc.ReplaceParent = cc.CallFunc.extend({
            ctor: function (t) {
                this._super(function (e) {
                    e.replaceParentSamePlace(t, {
                        keepScale: !0
                    })
                })
            }
        }), cc.SpineAction = cc.CallFunc.extend({
            ctor: function (e, t, s, i) {
                var n;
                e.getAnimationData(t) || cleverapps.throwAsync("no animation '" + t + "' for json '" + e.spine.jsonName + "'"), this._super(function () {
                    e.setAnimation(0, t, !1), s && s !== e.getTimeLeft() && (n = e.getTimeScale(), e.setTimeScale(e.getTimeLeft() / s)), e.setCompleteListener(function () {
                        e.setCompleteListener(), n && e.setTimeScale(n), i && i()
                    })
                })
            }
        }), cc.ActionInterval.extend({
            ctor: function (e, t, s) {
                cc.ActionInterval.prototype.ctor.call(this), this._form = cc.size(), this._to = cc.size(), this.initWithDuration(e, cc.size(t, s))
            },
            initWithDuration: function (e, t) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, e) && (this._to = t, !0)
            },
            clone: function () {
                return new Scale9SpriteResizeTo(this._duration, this._to)
            },
            reverse: function () {
                return cc.log("Scale9SpriteResizeTo.reverse(): reverse hasn't been supported."), null
            },
            startWithTarget: function (e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e), this._from = e.getContentSize()
            },
            update: function (e) {
                e = this._computeEaseTime(e), this.target.setContentSize(this._from.width + (this._to.width - this._from.width) * e, this._from.height + (this._to.height - this._from.height) * e)
            }
        })),
        ImageFontCountTo = (cc.QuadraticBezier = cc.ActionInterval.extend({
            ctor: function (e, t) {
                cc.ActionInterval.prototype.ctor.call(this), this._config = [], this._startPosition = cc.p(0, 0),
                    this._previousPosition = cc.p(0, 0), t && this.initWithDuration(e, t)
            },
            initWithDuration: function (e, t) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, e) && (this._config = t, !0)
            },
            clone: function () {
                for (var e = new cc.QuadraticBezier, t = (this._cloneDecoration(e), []), s = 0; s < this._config.length; s++) {
                    var i = this._config[s];
                    t.push(cc.p(i.x, i.y))
                }
                return e.initWithDuration(this._duration, t), e
            },
            startWithTarget: function (e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e), this._previousPosition.x = e.x, this._previousPosition.y = e.y, this._startPosition.x = e.x, this._startPosition.y = e.y, this._config[0] = cc.pSub(this._config[0], this._startPosition), this._config[1] = cc.pSub(this._config[1], this._startPosition), this._config[2] = cc.pSub(this._config[2], this._startPosition)
            },
            bezierAt: function (e, t, s, i) {
                return e * Math.pow(1 - i, 2) + t * (2 * (1 - i) * i) + s * Math.pow(i, 2)
            },
            update: function (e) {
                var t, s, i, n, o;
                e = this._computeEaseTime(e), this.target && (t = this.bezierAt(this._config[0].x, this._config[1].x, this._config[2].x, e),
                    e = this.bezierAt(this._config[0].y, this._config[1].y, this._config[2].y, e), s = this._startPosition, cc.ENABLE_STACKABLE_ACTIONS ? (i = this.target.getPositionX(), n = this.target.getPositionY(), o = this._previousPosition, s.x = s.x + i - o.x, s.y = s.y + n - o.y, t += s.x, e += s.y, o.x = t, o.y = e, this.target.setPosition(t, e)) : this.target.setPosition(s.x + t, s.y + e))
            },
            reverse: function () {
                var e = this._config,
                    e = [cc.pAdd(e[1], cc.pNeg(e[2])), cc.pAdd(e[0], cc.pNeg(e[2])), cc.pNeg(e[2])],
                    e = new cc.BezierBy(this._duration, e);
                return this._cloneDecoration(e), this._reverseEaseList(e), e
            }
        }), cc.ActionInterval.extend({
            ctor: function (e, t, s) {
                cc.ActionInterval.prototype.ctor.call(this, e), this._to = t, this._total = s
            },
            startWithTarget: function (e) {
                cc.ActionInterval.prototype.startWithTarget.call(this, e), this._from = parseFloat(e.getString().split(" / ")[0])
            },
            update: function (e) {
                e = this._computeEaseTime(e);
                e = this._from + Math.floor((this._to - this._from) * e);
                this._total && (e += " / " + this._total), this.target.setString(e)
            }
        })),
        getRadius = (cc.easeOutIn = function (e) {
            return {
                _rate: e,
                easing: function (e) {
                    return (e *= 2) < 1 ? .5 - .5 * Math.pow(1 - e, this._rate) : .5 + .5 * Math.pow(e - 1, this._rate)
                },
                reverse: function () {
                    return cc.easeOutIn(this._rate)
                }
            }
        }, cleverapps.UI.animateCollect = function (t, e, s) {
            s = s || {}, e = cleverapps.aims.getTarget(e);
            var i = cleverapps.scenes.getMovingNode(e),
                n = [],
                o = (s.replaceParentOnStart ? n.push(new cc.ReplaceParent(i)) : t.replaceParentSamePlace(i, {
                    keepScale: !0
                }), s.duration || cc.CollectAnimation.calcDuration({
                    targetNode: t,
                    to: e
                })),
                a = t.baseScaleX || t.baseScale || 1,
                r = t.baseScaleY || t.baseScale || 1,
                c = s.scale,
                l = (s.adjustToTarget && (c = Math.min(e.width / t.width, e.height / t.height, 1)), s.path && n.push(new cc.CallFunc(function () {
                    var e = new cleverapps.Particles(bundles.particle.jsons.particles_collect_json, bundles.particle.urls.particle_texture);
                    e.setPositionRound(i.convertToNodeSpace(t.convertToWorldSpace(cc.p(t.width / 2, t.height / 2)))), i.addChild(e, -1), e.followTarget(t)
                })), n.push(new cc.CallFunc(function () {
                    cleverapps.aims.showTarget(e)
                })), new cc.CollectAnimation(o, e, {
                    randomPath: s.randomPath
                })),
                l = (s.easing && (l = l.easing(s.easing)), n.push(new cc.Spawn(l, new cc.Sequence(new cc.ScaleTo(.4 * o, 1.3 * a, 1.3 * r), new cc.ScaleTo(.6 * o, c || a, c || r)))), s.sound);
            return (l = !l && e.aim && e.aim.treasureBag ? bundles.main.urls.win_reward_box_effect : l) && n.push(new cc.PlaySound(l, {
                throttle: 0
            })), s.collectEffect && n.push(new cc.CollectEffect(e)), s.collectDelta && n.push(new cc.AnimateDelta(e, s.collectDelta, {
                x: cleverapps.styles.Reward.sidebarDelta.x,
                y: cleverapps.styles.Reward.sidebarDelta.y
            })), 1 === n.length ? n[0] : new cc.Sequence(n)
        }, cleverapps.UI.animateJumpCollect = function (e, t, s) {
            s = s || {}, t = cleverapps.aims.getTarget(t);
            var i = cleverapps.scenes.getMovingNode(e),
                n = s.collectMovingNode || cleverapps.scenes.getMovingNode(t),
                i = (e.replaceParentSamePlace(i, {
                    keepScale: !0
                }), s.duration || cc.CollectAnimation.calcDuration({
                    targetNode: e,
                    to: t,
                    jump: !0
                })),
                o = cleverapps.styles.AnimateJumpCollect,
                a = s.jumpScale || 1.2 * e.scale,
                r = s.collectScale || e.scale,
                c = o.both,
                l = (s.jumpSide && (c = "left" === s.jumpSide ? o.left : o.right),
                    s.jumpOffset || 0),
                l = cc.p(c.x1 + (c.x2 - c.x1) * l, c.y1 + Math.random() * (c.y2 - c.y1)),
                c = [];
            return c.push(new cc.CallFunc(function () {
                cleverapps.aims.showTarget(t)
            })), c.push(new cc.Spawn(new cc.JumpAnimation(.4, e, l, o.height), new cc.ScaleTo(.4, a), new cc.Sequence(new cc.DelayTime(.3), new cc.PlaySound(bundles.main.urls.coins_drop_effect)))), s.collectDelay && c.push(new cc.DelayTime(s.collectDelay)), c.push(new cc.ReplaceParent(n)), c.push(new cc.Spawn(new cc.CollectAnimation(i, t, {
                jump: !0
            }), new cc.ScaleTo(i, r))), c.push(new cc.PlaySound(s.collectSound)), s.collectEffect && c.push(new cc.CollectEffect(t)), 1 === c.length ? c[0] : new cc.Sequence(c)
        }, cleverapps.styles.AnimateJumpCollect = {
            height: 200,
            right: {
                x1: 50,
                x2: 150,
                y1: -50,
                y2: -100
            },
            left: {
                x1: -50,
                x2: -150,
                y1: -50,
                y2: -100
            },
            both: {
                x1: -50,
                x2: 50,
                y1: -50,
                y2: -100
            }
        }, cleverapps.UI.animateCard = function (s) {
            s = s || {};

            function p() {
                var e, t = s.position;
                return (t = "function" == typeof t ? t() : t).parent || (e = "Animation for removed card. Debug label: " + s.debugLabel + "Position: " + JSON.stringify(
                    t.point) + ", frame size: " + cc.view.getFrameSize().width + " by " + cc.view.getFrameSize().height + ", resolutionScale: " + resolutionScale + " level number: " + cleverapps.user.getHumanReadableNumber(), cleverapps.throwAsync(e)), t.parent.convertToWorldSpace(t.point)
            }
            var e = cleverapps.scenes.getMovingNode(s.cardView),
                t = (s.zOrder && e.setLocalZOrder(s.zOrder), s.cardView),
                d = (t.realParent = t.parent === e ? t.realParent : t.parent, t.animationId = t.animationId + 1 || 1),
                i = s.scale || t.card.getScale(),
                n = p(),
                o = s.duration || .7,
                a = s.animation,
                r = t.parent.convertToWorldSpace(t).x <= n.x,
                c = (a === cleverapps.UI.animateCard.ANIMATIION_BIT && (a = r ? "bit" : "bit2"), []),
                a = (t.replaceParentSamePlace(e, {
                    keepScale: !0
                }), a && (l = s.animationTime || o, c.push(new cc.SpineAction(t.animation, a, l, function () {
                    t.setIdleAnimation()
                }))), s.delay && c.push(new cc.DelayTime(s.delay)), e.convertToNodeSpace(n)),
                l = [],
                r = (s.midpoint ? (n = e.convertToNodeSpace(t.parent.convertToWorldSpace(t)), r = cc.p(n.x + s.midpoint.x * (r ? 1 : -1), n.y + s.midpoint.y), l.push(new cc.BezierTo(o, [n, r, a]).easing(cc.easeIn(1)))) : (n = new cc.MoveTo(o, a), l.push(s.easing ? n.easing(s.easing) : n)), e.adjustScaleTo(t.realParent));
            return s.dynamicRatioOfParentScale && (r.x /= s.dynamicRatioOfParentScale, r.y /= s.dynamicRatioOfParentScale), l.push(cleverapps.UI.animateScale({
                scale: {
                    x: (i.x || i) / r.x,
                    y: (i.y || i) / r.y
                },
                duration: o,
                overScaling: s.overScaling
            })), c.push(new cc.Spawn(l)), !1 !== s.replaceParentBack && c.push(new cc.CallFunc(function () {
                d === t.animationId && (t.replaceParentSamePlace(t.realParent), t.setScale(i))
            })), c.push(new cc.CallFunc(function () {
                var e;
                t.parent && (e = t.parent.convertToNodeSpace(p()), t.setPositionRound(e))
            })), new cc.Sequence(c)
        }, cleverapps.UI.animateCard.ANIMATIION_BIT = "bit", cleverapps.UI.animateCube = function (e) {
            e = e || {};
            var t = cleverapps.scenes.getMovingNode(),
                s = e.cubeView,
                i = (s.realParent = s.parent === t ? s.realParent : s.parent, e.position.parent.convertToWorldSpace(e.position.point)),
                e = e.duration || .7,
                n = [],
                i = (n.push(new cc.ReplaceParent(t)), t.convertToNodeSpace(i)),
                t = t.convertToNodeSpace(
                    s.parent.convertToWorldSpace(s)),
                s = cc.p(t.x + cleverapps.Random.random(-100, 100), t.y + 600);
            return n.push(new cc.BezierTo(e, [t, s, i]).easing(cc.easeIn(.75))), new cc.Sequence(n)
        }, cleverapps.UI.animateScale = function (e) {
            return "object" != typeof (e = e || {}).scale && (e.scale = {
                x: e.scale,
                y: e.scale
            }), e.overScaling ? new cc.Sequence(new cc.ScaleTo(4 * e.duration / 5, e.scale.x * e.overScaling, e.scale.y * e.overScaling).easing(cc.easeIn(1)), new cc.ScaleTo(e.duration / 5, e.scale.x, e.scale.y).easing(cc.easeOut(1))) : new cc.ScaleTo(e.duration, e.scale.x, e.scale.y)
        }, function (e, t) {
            var s = 0;
            return e.forEach(function (e) {
                e = cc.pDistance(e, t);
                s = Math.max(s, e)
            }), s / 2
        }),
        getCenter = function (e) {
            var t = {
                x: 0,
                y: 0
            };
            return e.forEach(function (e) {
                t.x += e.x, t.y += e.y
            }), t.x /= e.length, t.y /= e.length, t
        },
        ScrollBarHandler = (cleverapps.UI.animateShuffle = function (e, i) {
            var n = getCenter(e),
                o = getRadius(e, n);
            i = i || function () { }, e.forEach(function (e) {
                var t = (.8 + .4 * Math.random()) * o,
                    s = e.getShuffleFinishPosition(),
                    t = cc.pAdd(cc.pMult(cc.pNormalize(cc.p(e.x - n.x, e.y - n.y)),
                        t), n);
                e.runAction(new cc.Sequence(new cc.MoveTo(.375, t).easing(cc.easeIn(3)), new cc.MoveInCircle(.75, n, s).easing(cc.easeOut(1.1)), new cc.CallFunc(i.bind(e)), new cc.MoveTo(.375, s).easing(cc.easeInOut(3))))
            })
        }, cc.Base = cc.Node, cc.Scale9Sprite.prototype.ctor = cleverapps.extendFunc(cc.Scale9Sprite.prototype.ctor, function (e) {
            checkBrokenLink(e, arguments);
            var t, s = isVirtualLink(e) ? e : e && e.virtualFrameName;
            0 < arguments.length && ("string" == typeof e && (e = t = processVirtualImage(e)), arguments[0] = e), this._super.apply(this, arguments), this.virtualFrameName = s, this.spriteFrameName = t, this._debugName = s || t
        }), cc.Scale9Sprite.prototype.setSpriteFrame = cleverapps.extendFunc(cc.Scale9Sprite.prototype.setSpriteFrame, function (e) {
            return checkBrokenLink(e, arguments), this.virtualFrameName = isVirtualLink(e) ? e : e && e.virtualFrameName, this.spriteFrameName = "string" == typeof e ? e : e && e.spriteFrameName, this._super.call(this, e)
        }), cc.textureCache.getTextureForKey = cleverapps.extendFunc(cc.textureCache.getTextureForKey, function (e, t) {
            var s = isVirtualLink(e) ? e : "",
                t = (e = processVirtualImage(e, t), this._super.call(this, e));
            return t && (t.spriteFrameName = e, t.virtualFrameName = s), t
        }), cc.spriteFrameCache.getSpriteFrame = cleverapps.extendFunc(cc.spriteFrameCache.getSpriteFrame, function (e, t) {
            var s = isVirtualLink(e) ? e : "",
                t = ("string" == typeof (e = processVirtualImage(e, t)) && 0 === e.indexOf("#") && (e = e.substr(1, e.length - 1)), this._super.call(this, e));
            return t && (t.spriteFrameName = e, t.virtualFrameName = s), t
        }), cleverapps.styles.FONTS.SYSTEM = {
            type: {
                name: "Arial"
            },
            size: 20,
            color: cleverapps.styles.COLORS.BLACK
        }, cc.Base.prototype.replaceParent = function (e) {
            this.removeTemporarily(!1), e.addChild(this)
        }, cc.Base.GetHierarchyRotation = function (e) {
            for (var t = {
                x: 0,
                y: 0
            }; e;) t.x += e.getRotationX(), t.y += e.getRotationY(), e = e.parent;
            return t
        }, cc.Base.prototype.adjustRotationTo = function (e) {
            for (var t = cc.Base.GetHierarchyRotation(e), s = (t.x *= -1, t.y *= -1, this); s;) t.x += s.getRotationX(), t.y += s.getRotationY(), s = s.parent;
            return t
        }, cc.Base.GetHierarchyScale = function (e) {
            for (
                var t = {
                    x: 1,
                    y: 1
                }; e;) t.x *= e.scaleX, t.y *= e.scaleY, e = e.parent;
            return t
        }, cc.Base.prototype.adjustScaleTo = function (e) {
            for (var t = cc.Base.GetHierarchyScale(e), s = (t.x = 1 / t.x, t.y = 1 / t.y, this); s;) t.x *= s.scaleX, t.y *= s.scaleY, s = s.parent;
            return t
        }, cc.Base.prototype.replaceParentSamePlace = function (e, t) {
            t && t.keepScale && (s = this.adjustScaleTo(e), this.setScaleX(s.x), this.setScaleY(s.y)), t && t.keepRotation && (s = this.adjustRotationTo(e), this.setRotationX(s.x), this.setRotationY(s.y));
            var s, t = e.convertToNodeSpace(this.parent.convertToWorldSpace(this.getPosition()));
            this.replaceParent(e), this.setPosition(t)
        }, cc.Base.prototype.createListener = function (e) {
            var t = this;
            return addCleaner(this, function () {
                e = t = void 0
            }),
                function () {
                    if (e && t && !t.stopListeners) return e.apply(t, arguments)
                }
        }, cc.Base.prototype.hasTouch = function (e) {
            if (!this.visible) return !1;
            e = this.convertTouchToNodeSpace(e);
            return cc.rectContainsPoint(cc.rect(0, 0, this.width, this.height), e)
        },
            cc.Base.prototype.createListener_onExitTransitionDidStart = cc.Base.prototype.onExitTransitionDidStart, cc.Base.prototype.onExitTransitionDidStart = function () {
                var e;
                this.stopListeners = !0, this.createListener_onExitTransitionDidStart(), (this.avoidNode || this.updateDynamicPosition || this._globalZOrder) && (e = cleverapps.scenes.getRunningScene(), this.avoidNode && e.removeAvoidNode && e.removeAvoidNode(this), this.updateDynamicPosition && e.removeDynamicNode && e.removeDynamicNode(this), this._globalZOrder && e.removeGlobalZOrderNode(this))
            }, cc.Base.prototype.onEnterTransitionDidFinish = cleverapps.extendFunc(cc.Base.prototype.onEnterTransitionDidFinish, function () {
                var e;
                this.stopListeners = !1, this._super.apply(this, arguments), (this.avoidNode || this.updateDynamicPosition || this._globalZOrder) && (e = cleverapps.scenes.getRunningScene(), this.avoidNode && e.addAvoidNode && e.addAvoidNode(this), this.updateDynamicPosition && e.addDynamicNode && e.addDynamicNode(this), this._globalZOrder && e.addGlobalZOrderNode(this))
            }),
            cc.Scale9Sprite.prototype.onEnterTransitionDidFinish = cleverapps.extendFunc(cc.Scale9Sprite.prototype.onEnterTransitionDidFinish, function () {
                this._super.apply(this, arguments), this.virtualFrameName && this.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(this.virtualFrameName, this.getPreferredBundles()))
            }), cc.Sprite.prototype.onEnterTransitionDidFinish = cleverapps.extendFunc(cc.Sprite.prototype.onEnterTransitionDidFinish, function () {
                this._super.apply(this, arguments), this.virtualFrameName && ("url" !== getVirtualLinkType(this.virtualFrameName) ? this.setSpriteFrame(this.virtualFrameName) : this.setTexture(this.virtualFrameName))
            }), cc.Base.prototype.cleanup = cleverapps.extendFunc(cc.Base.prototype.cleanup, function () {
                this.stopListeners = !0, runCleaners(this), this._super()
            }), cc.Base.prototype.runAction = cleverapps.extendFunc(cc.Base.prototype.runAction, function () {
                return this.stopListeners && cleverapps.config.debugMode && !cleverapps.config.wysiwygMode && cleverapps.throwAsync("runAction on stopped node"),
                    this.saveStack && (this.actionStack = (new Error).stack), this._super.apply(this, arguments)
            }), cc.Base.prototype.addCleaner = function (e) {
                addCleaner(this, e)
            }, cc.Base.prototype.addChild = cleverapps.extendFunc(cc.Base.prototype.addChild, function (e) {
                var t;
                this._super.apply(this, arguments), e.alignment && e.setPositionRound(e.alignment), this.isRunning() && (t = [], e.performRecursive(function (e) {
                    e.hidingNodeForInit && t.unshift(e.hidingNodeForInit)
                }), t.forEach(function (e) {
                    e.initialize()
                }))
            }), cc.Base.prototype.calculatePositionRound = function (e, t, s) {
                if ((e = Array.isArray(e) ? e[cleverapps.resolution.mode] : e).vertical && cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && (e = e.vertical), void 0 === s && (s = "object" == typeof e ? e.options || e : {}), void 0 === t && (t = e.y, e = e.x), s.world) return this.parent ? this.parent.convertToNodeSpace(this.calculatePositionRound(e, t, {
                    parentSize: cleverapps.UI.getBgSize()
                })) : {
                    x: e,
                    y: t,
                    options: s
                };
                if ("object" == typeof e || "object" == typeof t) {
                    var i, n = s.box;
                    if (this.parent && (
                        i = this.parent.getContentSize()), this.hidingNode && this.hidingNode.parent && (i = this.hidingNode.parent.getContentSize()), n && (i = n), !(i = s.parentSize ? s.parentSize : i)) return {
                            x: e,
                            y: t,
                            options: s
                        };
                    "object" == typeof e && (e = this.calculateCoordinate(e, "x", i.width) + (n && n.x || 0)), "object" == typeof t && (t = this.calculateCoordinate(t, "y", i.height) + (n && n.y || 0))
                }
                return cc.p(Math.floor(e), Math.floor(t))
            }, cc.Base.prototype.setPositionRound = function (e, t, s) {
                e = this.calculatePositionRound(e, t, s);
                "object" != typeof e.x && "object" != typeof e.y && !e.options || this.parent ? this.setPosition(e.x, e.y) : this.alignment = e
            }, cc.Base.prototype.calculateCoordinate = function (t, e, s) {
                var i, n;
                if (t.random) return i = void 0 !== t.random.start ? t.random.start : 0, n = void 0 !== t.random.end ? t.random.end : s, Math.round(Math.random() * (n - i) + i);
                var o = "x" === e ? this.getAnchorPoint().x : this.getAnchorPoint().y,
                    a = "x" === e ? "dx" : "dy",
                    r = 0,
                    c = (Object.keys(t).forEach(function (e) {
                        0 === e.indexOf(a) && (r += t[e])
                    }), "x" === e ? this.width * Math.abs(this.scaleX) : this.height * Math.abs(
                        this.scaleY));
                switch (t.align || "center") {
                    case "left":
                    case "bottom":
                        .1 <= Math.abs(o) && (r += Math.abs(o - 1) < .1 ? c : c / 2), "center" === t.anchor ? r -= c / 2 : "top" === t.anchor && (r -= c);
                        break;
                    case "center":
                        r += s / 2, Math.abs(o) < .1 ? r += -c / 2 : Math.abs(o - 1) < .1 && (r += c / 2), "top" === t.anchor ? r -= c / 2 : "bottom" === t.anchor && (r += c / 2);
                        break;
                    case "right":
                    case "top":
                        r += s, Math.abs(o) < .1 ? r += -c : .1 < Math.abs(o - 1) && (r += -c / 2), "center" === t.anchor ? r += c / 2 : "bottom" === t.anchor && (r += c)
                }
                return r
            }, cc.Base.prototype.getRelativeCoordinates = function (e) {
                e = e.hidingNode || e;
                return this.getParent().convertToNodeSpace(e.getParent().convertToWorldSpace(e.getPosition()))
            }, cc.Node.prototype.getScale = function () {
                return this.scaleX !== this.scaleY && cleverapps.throwAsync("getScale with different scaleX=" + this.scaleX + " and scaleY=" + this.scaleY), this.scaleX
            }, cc.Base.prototype.setAnchorPoint2 = function (e, t) {
                void 0 === e && (e = .5), void 0 === t && (t = .5), 0 < this.width && (e = Math.round(this.width * e) / this.width), 0 < this.height && (t = Math.round(this.height * t) / this.height),
                    this.setAnchorPoint(e, t)
            }, cc.Base.prototype.setContentSize2 = function (e, t) {
                Array.isArray(e) && (e = e[cleverapps.resolution.mode]), void 0 === (t = Array.isArray(t) ? t[cleverapps.resolution.mode] : t) && (t = e.height, e = e.width), this.setContentSize(2 * Math.round(e / 2), 2 * Math.round(t / 2))
            }, cc.Base.prototype.setScale2 = function (e) {
                Array.isArray(e) && (e = e[cleverapps.resolution.mode]), this.setScale(e)
            }, cc.Base.prototype.isDisplayed = function () {
                for (var e = this; e.isVisible() && e.parent;) e = e.parent;
                return e.isVisible() && e === cleverapps.scenes.getRunningScene()
            }, cc.Base.prototype.getCenterPos = function () {
                var e = this.getBoundingBox();
                return e.x += e.width / 2, e.y += e.height / 2, {
                    x: Math.round(e.x),
                    y: Math.round(e.y)
                }
            }, cc.Base.prototype.getBoundingBox = function () {
                var e = this.scaleX,
                    t = this.scaleY,
                    s = this.baseScaleX || this.baseScale || e,
                    i = this.baseScaleY || this.baseScale || t,
                    n = e !== s || t !== i,
                    s = (n && this.setScale(s, i), cc.rect(0, 0, this._contentSize.width, this._contentSize.height)),
                    i = cc.rectApplyAffineTransform(s, this.getNodeToParentTransform());
                return n && this.setScale(e, t), i
            }, cc.Base.prototype.getGlobalBoundingBox = function () {
                var e = cc.rect(0, 0, this._contentSize.width, this._contentSize.height),
                    t = this.getNodeToWorldTransform();
                return cc.rectApplyAffineTransform(e, t)
            }, cc.Base.prototype.setCascadeOpacityEnabledRecursively = function (t) {
                this.performRecursive(function (e) {
                    e.setCascadeOpacityEnabled(t)
                })
            }, cc.Base.prototype.setRecCascadeColorEnabled = function () {
                this.performRecursive(function (e) {
                    e.setCascadeColorEnabled(!0)
                })
            }, cc.Base.prototype.onChangeSize = function () {
                this.children.forEach(function (e) {
                    e.completeAnimationOnResize && e.completeAnimationOnResize(), e.onChangeSize()
                }), this.updateSize && this.updateSize(), this.completeAnimationOnResize && this.completeAnimationOnResize()
            }, cc.Base.prototype.onChangePosition = function () {
                this.updatePosition && this.updatePosition(), this.children.forEach(function (e) {
                    e.onChangePosition()
                })
            }, cc.Base.prototype.performRecursive = function (e) {
                for (var t = [this]; 0 < t.length;) {
                    var s = t.pop();
                    e(s), t = t.concat(s.children),
                        s.iterateTiles && s.iterateTiles(function (e) {
                            e instanceof cc.Node && t.push(e)
                        })
                }
            }, cc.Base.prototype.getPreferredBundles = function () {
                return this.bundles ? (void 0 === this.preferredBundles && (this.preferredBundles = this.bundles.reduce(function (e, t) {
                    var s = bundles[t];
                    return e.concat(s.injectTo || [t])
                }, [])), this.preferredBundles) : this.parent ? this.parent.getPreferredBundles() : void 0
            }, cc.Base.prototype.getCropContainer = function () { }, cc.Base.prototype.setInteractiveState = function (e, t) {
                return this.interactiveStates || (this.interactiveStates = {}), this.interactiveStates[e] !== (t = t || void 0) && (t ? this.interactiveStates[e] = t : delete this.interactiveStates[e], !0)
            }, cc.Base.prototype.getInteractiveStates = function () {
                var e, t = {};
                if (!this.interactiveStates) return t;
                for (e in this.interactiveStates) t[this.interactiveStates[e]] = !0;
                return t
            }, cc.Base.prototype.removeInteractiveStates = function (e) {
                if (this.interactiveStates)
                    for (var t in this.interactiveStates) 0 === t.indexOf(e) && delete this.interactiveStates[t]
            },
            cc.Base.prototype.applyInteractiveScale = function () {
                var e, t, s;
                this.ignoreScale || (e = this.baseScaleX || this.baseScale || 1, t = this.baseScaleY || this.baseScale || 1, (s = this.getInteractiveStates()).pressed ? this.setScale(.97 * e, .97 * t) : s.mouseover ? this.setScale(1.03 * e, 1.03 * t) : this.setScale(e, t))
            }, cc.Base.prototype.convertTouchToNodeSpaceDisplacement = function (e) {
                var t = this.convertToNodeSpace(e.getStartLocation()),
                    e = this.convertToNodeSpace(e.getLocation()),
                    s = -Math.PI / 180 * this.getRotation();
                return [t, e] = [t, e].map(function (e) {
                    return {
                        x: e.x * Math.cos(s) - e.y * Math.sin(s),
                        y: e.x * Math.sin(s) + e.y * Math.cos(s)
                    }
                }), cc.p(e.x - t.x, e.y - t.y)
            }, cc.Base.prototype.removeTemporarily = function () {
                "creator" === engine && (this._temporarilyRemoved = !0), this.removeFromParent.apply(this, arguments)
            }, cc.Base.prototype.setGlobalZOrder = function (e) {
                var t;
                this._globalZOrder !== e && (this._globalZOrder = e, this.isRunning() && (t = cleverapps.scenes.getRunningScene(), e ? t.addGlobalZOrderNode(this) : t.removeGlobalZOrderNode(this)))
            },
            cc.Scene.prototype.ctor = cleverapps.extendFunc(cc.Scene.prototype.ctor, function () {
                this._globalZOrderNodes = [], this._reorderGlobalNodesDirty = !1, this._super.apply(this, arguments)
            }), cc.Scene.prototype.addGlobalZOrderNode = function (e) {
                "creator" === engine && (e.pixiObject._static = !0), -1 === this._globalZOrderNodes.indexOf(e) && this._globalZOrderNodes.push(e), cc.renderer.childrenOrderDirty = this._reorderGlobalNodesDirty = !0
            }, cc.Scene.prototype.removeGlobalZOrderNode = function (e) {
                "creator" === engine && (e.pixiObject._static = !1);
                e = this._globalZOrderNodes.indexOf(e); - 1 !== e && this._globalZOrderNodes.splice(e, 1), cc.renderer.childrenOrderDirty = !0
            }, cc.Scene.prototype.visit = function (e) {
                var t = this._renderCmd,
                    e = e ? e._renderCmd : null;
                if (this._visible) {
                    t.visit(e), this._reorderChildDirty && this.sortAllChildren(), this._reorderGlobalNodesDirty && (this._globalZOrderNodes.sort(function (e, t) {
                        return e._globalZOrder - t._globalZOrder || e.arrivalOrder - t.arrivalOrder
                    }), this._reorderGlobalNodesDirty = !1), this.visitCurrent();
                    for (var s,
                        i = this._children, n = this._globalZOrderNodes, o = i.length, p = n.length, a = 0, r = 0; a < o || r < p;) {
                        var c = i[a],
                            l = n[r];
                        !c || l && l._globalZOrder < c._localZOrder ? (s = l._globalZOrder, l._globalZOrder = 0, l.visit(l.parent), l._globalZOrder = s, r++) : (c.visit(this), a++)
                    }
                    t._dirtyFlag = 0
                } else t._propagateFlagsDown(e)
            }, cc.Base.CHILDREN_ORDER_FN = function (e, t) {
                return e._localZOrder - t._localZOrder || e.arrivalOrder - t.arrivalOrder
            }, cc.Base.EMPTY_COLOR = cc.color(255, 255, 255, 255), cc.Sprite.prototype.ctor = cleverapps.extendFunc(cc.Sprite.prototype.ctor, function (e) {
                checkBrokenLink(e, arguments);
                var t, s = isVirtualLink(e) ? e : e && e.virtualFrameName;
                0 < arguments.length && ("string" == typeof e && (e = t = processVirtualImage(e)), arguments[0] = e), this._super.apply(this, arguments), this.virtualFrameName = s, this.spriteFrameName = t
            }), cc.Sprite.prototype.setTexture = cleverapps.extendFunc(cc.Sprite.prototype.setTexture, function (e) {
                return checkBrokenLink(e, arguments), this.virtualFrameName = isVirtualLink(e) ? e : e && e.virtualFrameName, e = processVirtualImage(e,
                    this.getPreferredBundles()), this.spriteFrameName = e && e.spriteFrameName || e, this._super.call(this, e)
            }), cc.Sprite.prototype.setSpriteFrame = cleverapps.extendFunc(cc.Sprite.prototype.setSpriteFrame, function (e) {
                if (checkBrokenLink(e, arguments), this.virtualFrameName = isVirtualLink(e) ? e : e && e.virtualFrameName, e = (e = processVirtualImage(e, this.getPreferredBundles())) && e.spriteFrameName || e, this.spriteFrameName !== e) return ("string" == typeof (e = "string" == typeof (this.spriteFrameName = e) && 0 === e.indexOf("#") ? e.substr(1, e.length - 1) : e) ? cc.spriteFrameCache.getSpriteFrame(e) : e) ? this._super.call(this, e) : (cleverapps.config.wysiwygMode || cleverapps.throwAsync("broken frame: " + e), !1)
            }), cc.Sprite.prototype.getSpriteFrame = cleverapps.extendFunc(cc.Sprite.prototype.getSpriteFrame, function () {
                var e = this._super.call(this);
                return e && (e.spriteFrameName = this.spriteFrameName, e.virtualFrameName = this.virtualFrameName), e
            }), cc.Sprite.prototype.unuse = function () {
                this.removeTemporarily()
            }, cc.Sprite.prototype.reuse = function () {
                this.setScale(1), this.setRotation(0), this.setAnchorPoint(.5, .5), this.setPosition(0, 0), this.setOpacity(255), this.setColor(cc.Base.EMPTY_COLOR), this.setCascadeColorEnabled(!1), this.setCascadeOpacityEnabled(!1)
            }, cc.Sprite.GetPoolId = function (e) {
                return "sprite_" + (e = e instanceof cc.Sprite ? e.spriteFrameName : e)
            }, cc.Sprite.GetFromPool = function (e) {
                return e = isVirtualLink(e) ? processVirtualImage(e) : e, cc.pool.getFromPool(cc.Sprite, e) || new cc.Sprite(e)
            }, cc.pool = {
                _pool: {},
                putInPool: function (e) {
                    var t = e.constructor,
                        s = [t].concat(Array.prototype.slice.call(arguments, 0)),
                        s = this.getPoolId.apply(this, s);
                    this._pool[s] || (this._pool[s] = []), e.unuse && e.unuse(), (!t.PoolLimit || this._pool[s].length < t.PoolLimit) && this._pool[s].push(e)
                },
                getPoolId: function (e) {
                    var t, s = e.prototype.__pid;
                    return s || ((t = {
                        writable: !0,
                        enumerable: !1,
                        configurable: !0
                    }).value = ClassManager.getNewID(), Object.defineProperty(e.prototype, "__pid", t)), e.GetPoolId && (t = Array.prototype.slice.call(arguments, 1), s = e.GetPoolId.apply(e, t)), s
                },
                hasObject: function () {
                    var e = this.getPoolId.apply(this, arguments);
                    return this._pool[e] && 0 < this._pool[e].length
                },
                getFromPool: function () {
                    var e, t;
                    if (this.hasObject.apply(this, arguments)) return t = this.getPoolId.apply(this, arguments), t = this._pool[t], e = Array.prototype.slice.call(arguments, 1), (t = t.pop()).reuse && t.reuse.apply(t, e), delete t.stopListeners, t
                },
                drainAllPools: function () {
                    this._pool = {}
                }
            }, cleverapps.UI.ScrollBarContainer = cc.Node.extend({}), cleverapps.UI.ScrollView = ccui.Layout.extend({
                ctor: function (e, t) {
                    switch (this.options = t || {}, this.dir = cleverapps.UI.ScrollView.DIR_NONE, this.onUpdatePositionListener = function () { }, this.onUpdateZoomListener = function () { }, this.options.childrenVisibility = void 0 === this.options.childrenVisibility ? cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK : this.options.childrenVisibility, this.options.childrenVisibilityPadding = this.options.childrenVisibilityPadding || 0, this.options.childrenVisibility) {
                        case cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_LINEAR:
                            this.childrenVisibility = new ScrollChildrenLinearVisibility(this);
                            break;
                        case cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK:
                            this.childrenVisibility = new ScrollChildrenFullCheckVisibility(this)
                    }
                    this._super(), void 0 !== this.options.clipping && !this.options.clipping || this.setClippingEnabled(!0), this.setAnchorPoint2(), this.centerNode = new cc.Node, this.addChild(this.centerNode), !1 !== this.options.scrollBarEnabled && (this.barContainer = new cleverapps.UI.ScrollBarContainer, this.addChild(this.barContainer, 2), this.barContainer.setCascadeOpacityEnabled(!0), this.barContainer.setOpacity(0), this.barContainer.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.FadeTo(.3, 255))), this.barHandler = new ScrollBarHandler(this)), this.zoom = 1, this.options.zoom && (this.zoomHandler = new cleverapps.UI.ZoomHandler(this, this.options.zoom));
                    t = t && t.scrollHandler || cleverapps.UI.ScrollHandler;
                    this.scrollHandler = new t(this, {
                        mouseScroll: !this.options.zoom,
                        outOfBoundaryScale: this.options.outOfBoundaryScale,
                        inertialScrollFactor: this.options.inertialScrollFactor
                    }), e && this.setInnerContent(e), this.scheduleUpdate()
                },
                isEmpty: function () {
                    return !this.innerContent || !this.innerContent.children.length
                },
                setContentSize: function (e, t) {
                    var s = this.width,
                        i = this.height,
                        n = this.innerContent && this.innerContent.getPosition();
                    this._super(e, t), s !== this.width || i !== this.height ? (this.barContainer && this.barContainer.setContentSize(this.getContentSize()), this.centerNode && this.centerNode.setPosition(this.width / 2, this.height / 2), this.innerContent && (this.calcBorders(), this.scrollToPoint(cc.p(-n.x, -n.y)))) : 0 === this.width && 0 === this.height && (this.min = cc.p(0, 0), this.max = cc.p(0, 0))
                },
                updateVisibility: function () {
                    if (this.innerContent.setVisibleRect && this.innerContent.setVisibleRect(this.getVisibleRect()), this.childrenVisibility && this.currentVisibleChildIds && !this.isEmpty() && this.width + this.height !== 0) {
                        for (var e, t = this.childrenVisibility.visibleIds(), s = 0; s < this.currentVisibleChildIds.length; s++) this.visibilityCheckList[this.currentVisibleChildIds[s]].hideDirty = !0;
                        for (s = 0; s < t.length; s++) delete (e = this.visibilityCheckList[t[s]]).hideDirty, delete e.beyondScroll, e.visible = !0;
                        for (s = 0; s < this.currentVisibleChildIds.length; s++)(e = this.visibilityCheckList[this.currentVisibleChildIds[s]]).hideDirty && (delete e.hideDirty, e.visible = !1, e.beyondScroll = !0);
                        this.currentVisibleChildIds = t
                    }
                },
                getVisibleRect: function () {
                    return cc.rect(Math.round(this.innerContent.width / 2 - this.width / this.zoom / 2 - this.innerContent.x), Math.round(this.innerContent.height / 2 - this.height / this.zoom / 2 - this.innerContent.y), Math.round(this.width / this.zoom), Math.round(this.height / this.zoom))
                },
                isVisiblePoint: function (e) {
                    var t = this.getVisibleRect();
                    return cc.rectContainsPoint(t, e)
                },
                calcBorders: function () {
                    if (this.isEmpty()) return this.min = cc.p(0, 0), void (this.max = cc.p(0, 0));
                    this.min = cc.p(-this.innerContent.width / 2 + this.width / this.zoom / 2, -this.innerContent.height / 2 + this.height / this.zoom / 2), 0 < this.min.x && (this.min.x = 0),
                        0 < this.min.y && (this.min.y = 0), this.max = cc.p(this.innerContent.width / 2 - this.width / this.zoom / 2, this.innerContent.height / 2 - this.height / this.zoom / 2), this.max.x < 0 && (this.max.x = 0), this.max.y < 0 && (this.max.y = 0), this.setDirection(), this.barHandler && this.barHandler.reset()
                },
                setInnerContent: function (e) {
                    this.innerContent && this.innerContent.removeFromParent(), this.innerContent = e, this.innerContent.setAnchorPoint2(), this.innerContent.setPositionRound(0, 0), this.centerNode.addChild(e), this.visibilityCheckList = e.visibilityCheckList || e.children, this.width && this.height ? (this.updateInnerContent(), this.scrollToDefault()) : this.initChildrenVisibility()
                },
                scrollToDefault: function () {
                    this.innerContent && this.scrollTo(cleverapps.UI.ScrollView.SCROLLS.UPPER_LEFT)
                },
                initChildrenVisibility: function () {
                    if (this.childrenVisibility) {
                        this.currentVisibleChildIds = [];
                        for (var e = 0; e < this.visibilityCheckList.length; e++) this.currentVisibleChildIds.push(e)
                    }
                },
                updateInnerContent: function () {
                    this.calcBorders(),
                        this.initChildrenVisibility(), this.scrollToPoint(this.normalizePoint(this.getContainerPosition()))
                },
                borderTouchScrollIteration: function (e, t, s) {
                    var i = this.width / this.zoom / 2 * (s *= .01),
                        s = this.height / this.zoom / 2 * s,
                        n = (t /= this.zoom, cleverapps.bannerAd.getGlobalBoundingBox()),
                        o = 0,
                        a = e.getLocation(),
                        a = (n && n.x <= a.x && a.x <= n.x + n.width && (o = this.centerNode.convertToNodeSpace(cc.p(0, n.height)).y - this.centerNode.convertToNodeSpace(cc.p(0, 0)).y), this.centerNode.convertTouchToNodeSpace(e)),
                        n = 0,
                        e = 0,
                        r = this.getContainerPosition();
                    return a.x < -i && (n = r.x - t >= this.min.x ? -t : this.min.x - r.x), a.x > i && (n = r.x + t <= this.max.x ? t : this.max.x - r.x), a.y < -s + o && (e = r.y - t >= this.min.y ? -t : this.min.y - r.y), a.y > s && (e = r.y + t <= this.max.y ? t : this.max.y - r.y), !(!n && !e) && (this.scrollToPoint(cc.p(r.x + n, r.y + e)), !0)
                },
                calcNodeDelta: function (e, t) {
                    var s = Object.assign({
                        left: 1,
                        right: 1,
                        top: 1,
                        bottom: 1
                    }, t.visibleBox),
                        i = this.zoom,
                        n = (this.zoomHandler && t.zoom && this.zoomHandler.setZoom(t.zoom, !0), e.getBoundingBox()),
                        o = cc.p(n.x, n.y),
                        n = cc.p(n.x + n.width,
                            n.y + n.height),
                        o = this.centerNode.convertToNodeSpace(e.getParent().convertToWorldSpace(o)),
                        n = this.centerNode.convertToNodeSpace(e.getParent().convertToWorldSpace(n)),
                        e = cc.p(-this.width / this.zoom / 2 * s.left, -this.height / this.zoom / 2 * s.bottom),
                        s = cc.p(this.width / this.zoom / 2 * s.right, this.height / this.zoom / 2 * s.top),
                        a = cc.p(0, 0);
                    return o.x < e.x && (a.x = -(e.x - o.x)), n.x > s.x && (a.x = n.x - s.x), o.y < e.y && (a.y = -(e.y - o.y)), n.y > s.y && (a.y = n.y - s.y), a = cc.pAdd(a, this.scrollHandler.getHowMuchOutOfBoundary(a)), this.zoomHandler && t.zoom && this.zoomHandler.setZoom(i, !0), a
                },
                targetToPoint: function (e, t) {
                    switch (t = t || {
                        x: 0,
                        y: 0
                    }, e) {
                        case cleverapps.UI.ScrollView.SCROLLS.UPPER_LEFT:
                            e = cc.p(this.min.x + t.x, this.max.y + t.y);
                            break;
                        case cleverapps.UI.ScrollView.SCROLLS.CENTER:
                            e = cc.p(t.x, t.y);
                            break;
                        case cleverapps.UI.ScrollView.SCROLLS.LOWER_RIGHT:
                            e = cc.p(this.max.x + t.x, this.min.y + t.y);
                            break;
                        default:
                            (e = e instanceof cc.Node || e instanceof Map2dCellView ? this.innerContent.convertToNodeSpace(e.getParent().convertToWorldSpace(e.getPosition())) : e).x -= this.innerContent.width / 2 + t.x, e.y -= this.innerContent.height / 2 + t.y
                    }
                    return e
                },
                scrollTo: function (e, t, s) {
                    var i = (s = s || {}).callback || function () { };
                    void 0 !== e ? (e = this.normalizePoint(this.targetToPoint(e, s.padding)), t ? (s.duration = t, s.targetPoint = !0, t = s.easing || cc.easeBackInOut(), this.runAction(new cc.Sequence(new cc.ScrollAction(e, s).easing(t), new cc.CallFunc(i)))) : (this.scrollToPoint(e), i())) : i()
                },
                scrollBy: function (e, t, s) {
                    e = cc.pAdd(e, this.getContainerPosition());
                    e.x += this.innerContent.width / 2, e.y += this.innerContent.height / 2, this.scrollTo(e, t, s)
                },
                update: function (e) {
                    this._super(e), this.scrollHandler.processAutoScroll(e)
                },
                getCurrentScroll: function () {
                    if (!this.innerContent) return {
                        x: 0,
                        y: 0
                    };
                    var e = this.max.x - this.min.x,
                        t = this.max.y - this.min.y;
                    return {
                        x: 0 != e ? (this.innerContent.x - this.min.x) / e : 0,
                        y: 0 != t ? (this.innerContent.y - this.min.y) / t : 0
                    }
                },
                normalizePoint: function (e) {
                    return {
                        x: Math.max(this.min.x, Math.min(this.max.x, e.x)),
                        y: Math.max(this.min.y, Math.min(this.max.y, e.y))
                    }
                },
                getContainerPosition: function () {
                    return cc.p(-this.innerContent.x, -this.innerContent.y)
                },
                getCurrentPosition: function () {
                    var e = this.innerContent.getPosition();
                    return {
                        x: -e.x + this.innerContent.width / 2,
                        y: -e.y + this.innerContent.height / 2
                    }
                },
                scrollToPoint: function (e) {
                    this.innerContent.setPosition(-e.x, -e.y), this.updateVisibility(), this.barHandler && this.barHandler.updatePos(), this.options.containerMovedListener && this.options.containerMovedListener(), this.onUpdatePositionListener()
                },
                scrollToPercent: function (e, t) {
                    var s;
                    e = Math.min(100, Math.max(0, e)), e = this.dir & cleverapps.UI.ScrollView.DIR_VERTICAL ? (s = (this.max.y - this.min.y) * e / 100 + this.min.y, cc.p(this.innerContent.x, s)) : (s = (this.max.x - this.min.x) * e / 100 + this.min.x, cc.p(s, this.innerContent.y)), t ? this.runAction(new cc.ScrollAction(e, {
                        duration: t,
                        targetPoint: !0
                    }).easing(cc.easeBackInOut())) : this.scrollToPoint(e)
                },
                stopScrollAction: function () {
                    this._scrollActionRunning && (cc.ScrollAction._UID++, this._scrollActionRunning = !1,
                        this.scrollHandler.afterContainerMove())
                },
                stopAutoScroll: function () {
                    this.stopScrollAction(), this.scrollHandler.stopAutoScroll()
                },
                setDirection: function () {
                    this.options.direction ? this.dir = this.options.direction : (this.dir = cleverapps.UI.ScrollView.DIR_BOTH, this.min.y === this.max.y && (this.dir ^= cleverapps.UI.ScrollView.DIR_VERTICAL), this.min.x === this.max.x && (this.dir ^= cleverapps.UI.ScrollView.DIR_HORIZONTAL))
                },
                getInnerContainer: function () {
                    return this.innerContent
                },
                setBarPadding: function (e) {
                    this.barHandler && this.barHandler.setPadding(e)
                },
                getCropContainer: function () {
                    return cc.rect(0, 0, this.width, this.height)
                }
            }), cleverapps.UI.ScrollView.SCROLLS = {
                UPPER_LEFT: 0,
                CENTER: 1,
                LOWER_RIGHT: 2
            }, cleverapps.UI.ScrollView.DIR_NONE = 0, cleverapps.UI.ScrollView.DIR_VERTICAL = 1, cleverapps.UI.ScrollView.DIR_HORIZONTAL = 2, cleverapps.UI.ScrollView.DIR_BOTH = cleverapps.UI.ScrollView.DIR_VERTICAL | cleverapps.UI.ScrollView.DIR_HORIZONTAL, cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE = 0,
            cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_LINEAR = 1, cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK = 2,
            function (e) {
                this.scroll = e
            }),
        ScrollBar = (ScrollBarHandler.prototype.reset = function () {
            !this.barY && this.scroll.dir & cleverapps.UI.ScrollView.DIR_VERTICAL && this.scroll.min.y !== this.scroll.max.y && (this.barY = new ScrollBar(this.scroll, cleverapps.UI.ScrollView.DIR_VERTICAL)), !this.barX && this.scroll.dir & cleverapps.UI.ScrollView.DIR_HORIZONTAL && this.scroll.min.x !== this.scroll.max.x && (this.barX = new ScrollBar(this.scroll, cleverapps.UI.ScrollView.DIR_HORIZONTAL)), this.barX && this.barX.reset(), this.barY && this.barY.reset(), this.updatePos()
        }, ScrollBarHandler.prototype.setAutoHide = function (e) {
            this.barX && this.barX.setAutoHideEnabled(e), this.barY && this.barY.setAutoHideEnabled(e)
        }, ScrollBarHandler.prototype.setPadding = function (e) {
            this.barPadding = e, this.barX && this.barX.setPadding(this.barPadding), this.barY && this.barY.setPadding(this.barPadding)
        }, ScrollBarHandler.prototype.updatePos = function () {
            var e = this.scroll.scrollHandler.getHowMuchOutOfBoundary();
            this.barY && this.barY.onScrolled(e), this.barX && this.barX.onScrolled(e)
        }, ScrollBarHandler.prototype.onTouchBegan = function () {
            this.barY && this.barY.onTouchBegan(), this.barX && this.barX.onTouchBegan()
        }, ScrollBarHandler.prototype.onTouchEnded = function () {
            this.barY && this.barY.onTouchEnded(), this.barX && this.barX.onTouchEnded()
        }, cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.scroll = e, this.dir = t, this._touching = !1, this._autoHideRemainingTime = 0, this._marginFromBoundary = ScrollBar.DEFAULT_MARGIN, this._marginForLength = ScrollBar.DEFAULT_MARGIN, this.opacity = 255 * ScrollBar.DEFAULT_SCROLLBAR_OPACITY, this.autoHideTime = ScrollBar.DEFAULT_AUTO_HIDE_TIME, this._autoHideEnabled = !0, this.init(), this.setCascadeColorEnabled(!0), this.setCascadeOpacityEnabled(!0), e.barContainer.addChild(this), this.setAutoHideEnabled(!1), this.setPadding(this.scroll.barHandler.barPadding), this.addControls(), this.setWidth(cleverapps.styles.ScrollBar.barWidth)
            },
            init: function () {
                this.bar = new cc.Scale9Sprite(bundles.scrollbar.frames.scrollbar_png), this.bar.setAnchorPoint2(.5, 0), this.addChild(this.bar), this.setColor(ScrollBar.DEFAULT_COLOR), this.onScrolled(cc.p(0, 0)), cc.Node.prototype.setOpacity.call(this, 0), this._autoHideRemainingTime = 0, this.dir === cleverapps.UI.ScrollView.DIR_HORIZONTAL && this.setRotation(90)
            },
            setPositionFromCorner: function (e) {
                this.dir === cleverapps.UI.ScrollView.DIR_VERTICAL ? (this._marginForLength = e.y, this._marginFromBoundary = e.x) : (this._marginForLength = e.x, this._marginFromBoundary = e.y)
            },
            onEnter: function () {
                cc.Node.prototype.onEnter.call(this), this.scheduleUpdate()
            },
            getPositionFromCorner: function () {
                return this.dir === cleverapps.UI.ScrollView.DIR_VERTICAL ? cc.p(this._marginFromBoundary, this._marginForLength) : cc.p(this._marginForLength, this._marginFromBoundary)
            },
            setWidth: function (e) {
                this.bar.width = e
            },
            setAutoHideEnabled: function (e) {
                this._autoHideEnabled = e,
                    !this._autoHideEnabled && !this._touching && this._autoHideRemainingTime <= 0 ? cc.Node.prototype.setOpacity.call(this, this.opacity) : cc.Node.prototype.setOpacity.call(this, 0)
            },
            isAutoHideEnabled: function () {
                return this._autoHideEnabled
            },
            setOpacity: function (e) {
                this._opacity = e
            },
            getOpacity: function () {
                return this._opacity
            },
            _updateLength: function (e) {
                this.bar.height = e
            },
            _processAutoHide: function (e) {
                !this._autoHideEnabled || this._autoHideRemainingTime <= 0 || this._touching || (this._autoHideRemainingTime -= e, this._autoHideRemainingTime <= this.autoHideTime && (this._autoHideRemainingTime = Math.max(0, this._autoHideRemainingTime), cc.Node.prototype.setOpacity.call(this, this._opacity * (this._autoHideRemainingTime / this.autoHideTime))))
            },
            update: function (e) {
                this._processAutoHide(e)
            },
            onTouchBegan: function () {
                this._autoHideEnabled && (this._touching = !0)
            },
            onTouchEnded: function () {
                this._autoHideEnabled && (this._touching = !1, this._autoHideRemainingTime <= 0 || (this._autoHideRemainingTime = this.autoHideTime))
            },
            _calculateLength: function (e,
                t, s) {
                0 !== s && (e += 20 * (0 < s ? s : -s)), s = t / e;
                return Math.abs(t - 2 * this._marginForLength) * s
            },
            _calculatePosition: function (e, t, s, i, n) {
                e -= t, 0 !== i && (e += Math.abs(i)), i = 0, 0 !== e && (i = s / e, i = Math.max(i, 0), i = Math.min(i, 1)), s = (t - n - 2 * this._marginForLength) * i + this._marginForLength;
                return this.dir === cleverapps.UI.ScrollView.DIR_VERTICAL ? cc.p(this.scroll.width - this._marginFromBoundary, s) : cc.p(s, this._marginFromBoundary)
            },
            setPadding: function (e) {
                var t = cleverapps.styles.ScrollBar,
                    s = (void 0 !== (e = e || {}).cornerPadding ? e : t).cornerPadding,
                    e = (void 0 !== e.sidePadding ? e : t).sidePadding,
                    t = cc.p(this.dir === cleverapps.UI.ScrollView.DIR_VERTICAL ? e : s, this.dir === cleverapps.UI.ScrollView.DIR_VERTICAL ? s : e);
                this.setPositionFromCorner(t), this.onScrolled(this.scroll.scrollHandler.getHowMuchOutOfBoundary())
            },
            reset: function () {
                this.scroll.dir & this.dir ? this.setVisible(!0) : this.setVisible(!1)
            },
            onScrolled: function (e) {
                this._autoHideEnabled && (this._autoHideRemainingTime = this.autoHideTime, cc.Node.prototype.setOpacity.call(this, this.opacity));
                var t = this.scroll.getInnerContainer(),
                    s = 0,
                    i = 0,
                    n = 0,
                    o = 0,
                    e = (this.dir === cleverapps.UI.ScrollView.DIR_VERTICAL ? (s = t.height, i = this.scroll.height, n = e.y, o = -t.getPositionY() + (this.scroll.max.y - this.scroll.min.y) / 2) : this.dir === cleverapps.UI.ScrollView.DIR_HORIZONTAL && (s = t.width, i = this.scroll.width, n = e.x, o = -t.getPositionX() + (this.scroll.max.x - this.scroll.min.x) / 2), this._calculateLength(s, i, n)),
                    t = this._calculatePosition(s, i, o, n, e);
                this._updateLength(e), this.setPosition(t)
            },
            getActualContentSize: function () {
                return this.bar.getContentSize()
            },
            addControls: function () {
                cleverapps.UI.onDrag(this.bar, {
                    instantDrag: !0,
                    onDragStart: function () {
                        return this.scroll.scrollHandler.stopAutoScroll(), !0
                    }.bind(this),
                    followPointer: function (e) {
                        var t = this.convertToNodeSpace(e.getLocation()),
                            e = this.convertToNodeSpace(e.getPreviousLocation()),
                            t = cc.pSub(t, e),
                            e = this.getPosToPercent(t);
                        this.scroll.scrollToPercent(e)
                    }.bind(this)
                })
            },
            getPosToPercent: function (e) {
                var t;
                return this.dir === cleverapps.UI.ScrollView.DIR_VERTICAL ? (
                    t = this.scroll.height - 2 * this.getPositionFromCorner().y - this.getActualContentSize().height, (this.y + e.y - this.getPositionFromCorner().y) / t * 100) : (t = this.scroll.width - 2 * this.getPositionFromCorner().x - this.getActualContentSize().height, (this.x + e.y - this.getPositionFromCorner().x) / t * 100)
            }
        })),
        ScrollChildrenLinearVisibility = (Object.defineProperty(ScrollBar.prototype, "opacity", {
            get: function () {
                return this.getOpacity()
            },
            set: function (e) {
                this.setOpacity(e)
            }
        }), cleverapps.styles.ScrollBar = {
            barWidth: 12,
            cornerPadding: 20,
            sidePadding: 20
        }, ScrollBar.DEFAULT_COLOR = new cc.Color(52, 65, 87), ScrollBar.DEFAULT_MARGIN = 20, ScrollBar.DEFAULT_AUTO_HIDE_TIME = .2, ScrollBar.DEFAULT_SCROLLBAR_OPACITY = .4, ScrollBar.BASE_WIDTH = 12, function (e) {
            this.scroll = e
        }),
        ScrollChildrenFullCheckVisibility = (ScrollChildrenLinearVisibility.prototype.visibleIds = function () {
            for (var e, t, s, i, n, o, a, r = this.scroll.visibilityCheckList, c = r.length <= 1 ? (e = 0, r.length) : (t = r.length - 1, s = this.getChildRect(r[0]), n = this.getChildRect(r[t]), i = s.getPosition(), (
                n = n.getPosition()).x -= i.x, n.x /= t, n.y -= i.y, n.y /= t, (c = 0 !== n.y ? (o = n.y, a = s.height / 2, e = (-this.scroll.innerContent.y - i.y + this.scroll.innerContent.height / 2 - this.scroll.height / 2) / o, (this.scroll.height + 2 * a) / o) : (o = n.x, a = s.width / 2, e = (-this.scroll.innerContent.x - i.x + this.scroll.innerContent.width / 2 - this.scroll.width / 2) / o, (this.scroll.width + 2 * a) / o)) < 0 && (e -= c = -c), e = Math.ceil(e - a / Math.abs(o)), Math.floor(c + 2 * a / Math.abs(o))), p = [], l = 0; l < c; l++) r[e + l] && p.push(e + l);
            return p
        }, ScrollChildrenLinearVisibility.prototype.getChildRect = function (e) {
            var t, s;
            return e.parent && e.parent !== this.scroll.innerContent ? (t = e.getBoundingBox(), s = cc.p(t.x + t.width / 2, t.y + t.height / 2), s = this.scroll.innerContent.convertToNodeSpace(e.parent.convertToWorldSpace(s)), cc.rect(s.x, s.y, t.width, t.height)) : e
        }, function (e) {
            this.scroll = e
        }),
        HidingNode = (ScrollChildrenFullCheckVisibility.prototype.visibleIds = function () {
            for (var e = [], t = this.scroll.visibilityCheckList, s = 0; s < t.length; s++) {
                var i, n, o = t[s];
                n = o.parent && o.parent !== this.scroll.innerContent ? (
                    i = o.getBoundingBox(), n = cc.p(i.x + i.width / 2, i.y + i.height / 2), n = this.scroll.innerContent.convertToNodeSpace(o.parent.convertToWorldSpace(n)), cc.rect(n.x, n.y, i.width, i.height)) : o, this.isRectVisible(n) && e.push(s)
            }
            return e
        }, ScrollChildrenFullCheckVisibility.prototype.isRectVisible = function (e) {
            var t = this.scroll.zoom,
                s = this.scroll.options.childrenVisibilityPadding || 0,
                i = e.x - this.scroll.innerContent.width / 2,
                n = e.y - this.scroll.innerContent.height / 2;
            return -this.scroll.innerContent.x - this.scroll.width / t / 2 - e.width / 2 - s <= i && i <= -this.scroll.innerContent.x + this.scroll.width / t / 2 + e.width / 2 + s && -this.scroll.innerContent.y - this.scroll.height / t / 2 - e.height / 2 - s <= n && n <= -this.scroll.innerContent.y + this.scroll.height / t / 2 + e.height / 2 + s
        }, cc.Node.extend({
            avoidNode: "HidingNode",
            ctor: function (e, t) {
                this._super(), this.isShown = !0, this.target = e, this.direction = t, e.hide || (e.hide = e.createListener(this.hide.bind(this))), e.show || (e.show = e.createListener(this.show.bind(this))), e.isShown = e.createListener(function () {
                    return this.isShown
                }.bind(this)), e.hideAnimation || (e.hideAnimation = e.createListener(this.hideAnimation.bind(this))), e.showAnimation || (e.showAnimation = e.createListener(this.showAnimation.bind(this))), e.toggle || (e.toggle = e.createListener(this.toggle.bind(this))), this.initialize()
            },
            initialize: function () {
                var e;
                this.target.hidingNode || ((e = this.target.getParent()) && e.isRunning() ? (this.target.hidingNodeForInit = void 0, e.addChild(this), (this.target.hidingNode = this).setLocalZOrder(this.target.getLocalZOrder()), this.setPositionRound(this.target.getPosition()), this.setAnchorPoint(this.target.getAnchorPoint()), this.hidePosition = this.target.hidePosition, this.target.replaceParent(this), this.updateSize(), !1 === this.isShown ? this.target.hideAnimation(!0) : this.target.showAnimation(!0), cleverapps.gameModes.noControls && this.hide(!0)) : this.target.hidingNodeForInit = this)
            },
            updateSize: function () {
                var e = this.target.getContentSize();
                this.setContentSize2(e.width * this.target.getScaleX(),
                    e.height * this.target.getScaleY())
            },
            onChangePosition: function () {
                this.updatePosition()
            },
            onChangePositionNext: function () {
                this.target.children.forEach(function (e) {
                    e.onChangePosition()
                })
            },
            updatePosition: function () {
                (this.target.updatePosition || this.target.updateRelativePosition) && (this.showAction && !this.showAction.isDone() && (this.stopAction(this.showAction), this.isShown && (this.target.visible = !0), delete this.showAction), this.target.updatePosition && this.target.updatePosition(), this.setPositionRound(this.target.getPosition()), this.target.setPositionRound(this.isShown ? this.getOriginalPosition() : this.calcHidePosition(this.direction))), this.onChangePositionNext()
            },
            calcHidePosition: function (e) {
                if (e = void 0 !== e ? e : cleverapps.UI.VERTICAL, this.hidePosition) return this.convertToNodeSpace(this.calculatePositionRound(this.hidePosition));
                var t, s = this.getParent().convertToWorldSpace(this.getPosition()),
                    i = cleverapps.UI.getBgSize(),
                    n = (e === cleverapps.UI.AUTO && (o = this.getPosition(), n = this.getBoundingBox(),
                        this.setPositionRound(o), o = Math.max(0, Math.min(n.x, i.width - n.x - n.width)), e = Math.max(0, Math.min(n.y, i.height - n.y - n.height)) < o ? cleverapps.UI.VERTICAL : cleverapps.UI.HORIZONTAL), this.width * this.scaleX),
                    o = this.height * this.scaleY,
                    a = cc.p(s.x + n * (.5 - this.anchorX), s.y + o * (.5 - this.anchorY)),
                    e = e === cleverapps.UI.VERTICAL ? (t = s.y > i.height / 2 ? i.height - a.y : -a.y, cc.p(a.x, a.y + 2 * t)) : (t = s.x > i.width / 2 ? i.width - a.x : -a.x, cc.p(a.x + 2 * t, a.y));
                return this.convertToNodeSpace(cc.p(e.x + n * (this.anchorX - .5), e.y + o * (this.anchorY - .5)))
            },
            getOriginalPosition: function () {
                return cc.p(this.width / 2, this.height / 2)
            },
            toggle: function (e, t) {
                e ? this.show(t) : this.hide(t)
            },
            showAnimation: function (e, t, s) {
                if (s = s || {}, this.target.stopAllActions(), e) return this.target.setPosition(this.getOriginalPosition()), void (this.target.visible = !0);
                this.showAction = this.target.runAction(new cc.Sequence(new cc.DelayTime(t || 0), new cc.Show, new cc.MoveTo(s.duration || .6, this.getOriginalPosition()).easing(cc.easeElasticOut(1.2))))
            },
            hideAnimation: function (e, t, s) {
                if (
                    s = s || {}, this.target.stopAllActions(), e) return this.target.setPosition(this.calcHidePosition(this.direction)), void (this.target.visible = !1);
                this.target.runAction(new cc.Sequence(new cc.DelayTime(t || 0), new cc.MoveTo(s.duration || .15, this.calcHidePosition(this.direction)).easing(cc.easeBackIn()), new cc.CallFunc(function () {
                    this.target.visible = !1
                }.bind(this))))
            },
            show: function (e, t, s) {
                !0 === this.isShown && !e || (this.isShown = !0, this.target.hidingNode && (this.target.onShow && this.target.onShow(e, t, s), this.target.showAnimation(e, t, s), cleverapps.scenes.onAvoidNodeVisibilityChanged()))
            },
            hide: function (e, t, s) {
                var i = s && s.force;
                (!1 !== this.isShown || e || i) && (this.isShown = !1, this.target.hidingNode && (this.target.onHide && this.target.onHide(e, t, s), this.target.hideAnimation(e, t, s), cleverapps.scenes.onAvoidNodeVisibilityChanged()))
            },
            setDirection: function (e) {
                this.direction = e
            }
        })),
        Windows = (cleverapps.UI.ScrollHandler = function (e, t) {
            t = t || {}, this.target = e, this.bounceEnabled = !0,
                this.outOfBoundaryScale = void 0 === t.outOfBoundaryScale ? .5 : t.outOfBoundaryScale, this.inertialScrollFactor = t.inertialScrollFactor || 1, this.initAutoScrollParams(), !1 !== t.mouseScroll && this.enableMouseWheelScroll(), this.enableTouchScroll()
        }, cleverapps.UI.ScrollHandler.prototype.enableMouseWheelScroll = function () {
            "mouse" in cc.sys.capabilities && cc.eventManager.addListener({
                event: cc.EventListener.MOUSE,
                onMouseScroll: function (e) {
                    this.target.isDisplayed() && cc.rectContainsPoint(cc.rect(0, 0, this.target.width, this.target.height), this.target.convertToNodeSpace(e.getLocation())) && cleverapps.meta.checkEventNode(this.target) && (this.handleMouseWheel(e.getScrollY()), e.stopPropagation())
                }.bind(this)
            }, this.target)
        }, cleverapps.UI.ScrollHandler.prototype.handleMouseWheel = function (e) {
            var t;
            0 != (this.target.dir & cleverapps.UI.ScrollView.DIR_VERTICAL) && (t = this.getHowMuchOutOfBoundary({
                y: 0 < e ? 1 : -1
            }), !this.fltEqualZero(t) && (t.y < 0 && 0 < e || 0 < t.y && e < 0) || this.lastMouseWheelTime && this.lastMouseWheelTime > Date.now() - 100 || ((
                !this.mouseWheelSpeed || this.lastMouseWheelTime < Date.now() - 500 || e * this.mouseWheelSpeed < 0) && (this.mouseWheelSpeed = 0), Math.abs(e) < 65 && this.lastMouseWheelTime && this.lastMouseWheelTime > Date.now() - 2e3 || (this.mouseWheelSpeed += cleverapps.styles.ScrollHandler.mouseWheelAcceleration * cleverapps.sign(e), Math.abs(this.mouseWheelSpeed) > cleverapps.styles.ScrollHandler.mouseWheelMaxSpeed && (this.mouseWheelSpeed = cleverapps.sign(this.mouseWheelSpeed) * cleverapps.styles.ScrollHandler.mouseWheelMaxSpeed), Math.abs(this.mouseWheelSpeed) < cleverapps.styles.ScrollHandler.mouseWheelMinSpeed && (this.mouseWheelSpeed = cleverapps.sign(this.mouseWheelSpeed) * cleverapps.styles.ScrollHandler.mouseWheelMinSpeed), this.startInertialScroll(cc.p(0, this.mouseWheelSpeed)), this.lastMouseWheelTime = Date.now())))
        }, cleverapps.UI.ScrollHandler.prototype.enableTouchScroll = function () {
            cleverapps.UI.onDrag(this.target, {
                onPressed: function () {
                    this.stopAutoScroll()
                }.bind(this),
                onDragStart: this.onTouchBegan.bind(this),
                followPointer: this.onTouchMoved.bind(this),
                onDragEnd: this.onTouchEnded.bind(this)
            })
        }, cleverapps.UI.ScrollHandler.prototype.onTouchBegan = function (e) {
            return !this.target.touchScrollDisabled && (this.target.stopScrollAction(), this.handlePress(e), !0)
        }, cleverapps.UI.ScrollHandler.prototype.onTouchMoved = function (e) {
            this.target.touchScrollDisabled || this.handleMove(e)
        }, cleverapps.UI.ScrollHandler.prototype.onTouchEnded = function (e) {
            this.target.touchScrollDisabled || this.handleRelease(e)
        }, cleverapps.UI.ScrollHandler.prototype.getTouchDelta = function (e, t) {
            var s = this.target.convertToNodeSpace(e.getLocation()),
                e = this.target.convertToNodeSpace(e.getPreviousLocation()),
                t = (t && !cc.rectContainsPoint(cc.rect(0, 0, this.target.width, this.target.height), s) && (s = e), cc.pMult(cc.pSub(e, s), 1 / this.target.zoom));
            return 0 == (this.target.dir & cleverapps.UI.ScrollView.DIR_HORIZONTAL) && (t.x = 0), 0 == (this.target.dir & cleverapps.UI.ScrollView.DIR_VERTICAL) && (t.y = 0), t
        },
            cleverapps.UI.ScrollHandler.prototype.initAutoScrollParams = function () {
                this._outOfBoundaryAmountDirty = !0, this._outOfBoundaryAmount = cc.p(0, 0)
            }, cleverapps.UI.ScrollHandler.prototype.afterContainerScale = function () {
                this._outOfBoundaryAmountDirty = !0;
                var e = this.getHowMuchOutOfBoundary();
                this.fltEqualZero(e) || this.startAutoScroll(e, 0)
            }, cleverapps.UI.ScrollHandler.prototype.afterContainerMove = function () {
                this._outOfBoundaryAmountDirty = !0, this.target.barHandler && this.target.barHandler.updatePos(), !this.bounceEnabled || this.inTouch || this._autoScrolling || this.startBounceBackIfNeeded()
            }, cleverapps.UI.ScrollHandler.prototype.startBounceBackIfNeeded = function () {
                if (!this.bounceEnabled) return !1;
                var e = this.getHowMuchOutOfBoundary();
                if (this.fltEqualZero(e)) return !1;
                return this.startAutoScroll(e, 1), !0
            }, cleverapps.UI.ScrollHandler.prototype.handlePress = function (e) {
                this.inTouch = !0, this.stopAutoScroll(), this._touchMovePreviousTimestamp = e.getLastModified(), this._touchMoveDisplacements = [],
                    this._touchMoveTimeDeltas = [], this.target.barHandler && this.target.barHandler.onTouchBegan()
            }, cleverapps.UI.ScrollHandler.prototype.handleMove = function (e) {
                var t = this.getTouchDelta(e),
                    s = (this.bounceEnabled ? (s = this.getHowMuchOutOfBoundary(t), t.x *= 0 === s.x ? 1 : this.outOfBoundaryScale, t.y *= 0 === s.y ? 1 : this.outOfBoundaryScale) : (s = this.getHowMuchOutOfBoundary(t), t.x += s.x, t.y += s.y), this.gatherMoveData(t, e), cc.pAdd(this.target.getContainerPosition(), t));
                this.moveContainer(s)
            }, cleverapps.UI.ScrollHandler.prototype.gatherMoveData = function (e, t) {
                for (; 5 <= this._touchMoveDisplacements.length;) this._touchMoveDisplacements.splice(0, 1), this._touchMoveTimeDeltas.splice(0, 1);
                this._touchMoveDisplacements.push(e);
                e = t.getLastModified();
                this._touchMoveTimeDeltas.push((e - this._touchMovePreviousTimestamp) / 1e3), this._touchMovePreviousTimestamp = e
            }, cleverapps.UI.ScrollHandler.prototype.handleRelease = function (e) {
                this.inTouch = !1;
                var t = this.getTouchDelta(e, !0);
                this.gatherMoveData(t, e), this.startBounceBackIfNeeded() || (0 === (
                    t = this.calcTouchVelocity()).x && 0 === t.y || this.startInertialScroll(t)), this.target.barHandler && this.target.barHandler.onTouchEnded()
            }, cleverapps.UI.ScrollHandler.prototype.calcAutoScrollPercentage = function () {
                var e = this._autoScrollAccumulatedTime < this._autoScrollTotalTime ? this._autoScrollAccumulatedTime / this._autoScrollTotalTime : 1;
                return e = this._autoScrollAttenuate ? --e * e * e * e * e + 1 : e
            }, cleverapps.UI.ScrollHandler.prototype.processAutoScroll = function (e) {
                var t, s;
                this._autoScrolling && !this.inTouch && (t = 1, 0 <= (s = this.calcAutoScrollPercentage()) && s <= 1 && this.isNecessaryAutoScrollBrake() && (t = .05), this._autoScrollAccumulatedTime += e * (1 / t), s = this.calcAutoScrollPercentage(), Math.abs(s - 1) <= 1e-4 && (s = 1, this.stopAutoScroll()), e = cc.pAdd(this._autoScrollStartPosition, cc.pMult(this._autoScrollTargetDelta, s)), e = cc.pAdd(this._autoScrollBrakingStartPosition, cc.pMult(cc.pSub(e, this._autoScrollBrakingStartPosition), t)), this.moveContainer(e))
            }, cleverapps.UI.ScrollHandler.prototype.moveContainer = function (e) {
                this.target.scrollToPoint(e), this.afterContainerMove()
            }, cleverapps.UI.ScrollHandler.prototype.isOutOfBoundary = function () {
                var e = this.getHowMuchOutOfBoundary();
                return !this.fltEqualZero(e)
            }, cleverapps.UI.ScrollHandler.prototype.calcTouchVelocity = function () {
                var e = this._touchMoveTimeDeltas.reduce(function (e, t) {
                    return e + t
                }, 0);
                if (0 === e || .5 <= e) return cc.p(0, 0);
                var t = cc.p(0, 0);
                return this._touchMoveDisplacements.forEach(function (e) {
                    t.x += e.x, t.y += e.y
                }), cc.pMult(t, 1 / e)
            }, cleverapps.UI.ScrollHandler.prototype.isNecessaryAutoScrollBrake = function () {
                if (this._autoScrollBraking) return !0;
                if (this.isOutOfBoundary()) {
                    if (!this._autoScrollCurrentlyOutOfBoundary) return this._autoScrollCurrentlyOutOfBoundary = !0, this._autoScrollBraking = !0, this._autoScrollBrakingStartPosition = this.target.getContainerPosition(), !0
                } else this._autoScrollCurrentlyOutOfBoundary = !1;
                return !1
            }, cleverapps.UI.ScrollHandler.prototype.startInertialScroll = function (e) {
                var t = .7 * this.inertialScrollFactor,
                    t = cc.pMult(e, t),
                    e = this.calculateAutoScrollTimeByInitialSpeed(cc.pLength(e));
                this.startAutoScroll(t, e)
            }, cleverapps.UI.ScrollHandler.prototype.calculateAutoScrollTimeByInitialSpeed = function (e) {
                return Math.sqrt(Math.sqrt(e / 5)) * this.inertialScrollFactor
            }, cleverapps.UI.ScrollHandler.prototype.fltEqualZero = function (e) {
                return Math.abs(e.x) <= 1e-4 && Math.abs(e.y) <= 1e-4
            }, cleverapps.UI.ScrollHandler.prototype.startAutoScroll = function (e, t) {
                this._autoScrolling = !0, this._autoScrollTargetDelta = e, this._autoScrollAttenuate = !0, this._autoScrollStartPosition = this.target.getContainerPosition(), this._autoScrollTotalTime = t, this._autoScrollAccumulatedTime = 0, this._autoScrollBraking = !1, this._autoScrollBrakingStartPosition = cc.p(0, 0);
                t = this.getHowMuchOutOfBoundary();
                this.fltEqualZero(t) || (this._autoScrollCurrentlyOutOfBoundary = !0, e = this.getHowMuchOutOfBoundary(e), (0 < t.x * e.x || 0 < t.y * e.y) && (this._autoScrollBraking = !0, this._autoScrollBrakingStartPosition = this.target.getContainerPosition()))
            },
            cleverapps.UI.ScrollHandler.prototype.stopAutoScroll = function () {
                this._autoScrolling = !1
            }, cleverapps.UI.ScrollHandler.prototype.getHowMuchOutOfBoundary = function (e) {
                if (0 === (e = void 0 === e ? cc.p(0, 0) : e).x && 0 === e.y && !this._outOfBoundaryAmountDirty) return this._outOfBoundaryAmount;
                var t = cc.p(0, 0),
                    s = this.target.getContainerPosition();
                return s.x + e.x > this.target.max.x ? t.x = this.target.max.x - (s.x + e.x) : s.x + e.x < this.target.min.x && (t.x = this.target.min.x - (s.x + e.x)), s.y + e.y < this.target.min.y ? t.y = this.target.min.y - (s.y + e.y) : s.y + e.y > this.target.max.y && (t.y = this.target.max.y - (s.y + e.y)), 0 === e.x && 0 === e.y && (this._outOfBoundaryAmount = t, this._outOfBoundaryAmountDirty = !1), t
            }, cleverapps.UI.ScrollHandler.prototype.isProcessing = function () {
                return this.inTouch || this._autoScrolling
            }, cleverapps.styles.ScrollHandler = {
                mouseWheelAcceleration: 200,
                mouseWheelMinSpeed: 500,
                mouseWheelMaxSpeed: 2e3
            }, cc.ScrollAction = cc.ActionInterval.extend({
                ctor: function (e, t) {
                    cc.ActionInterval.prototype.ctor.call(this), this._params = t || {};
                    t = void 0 === this._params.duration ? cc.ScrollAction.SCROLL_TO_DURATION : this._params.duration;
                    this._params.silent && (t = 0), this._creationStack = (new Error).stack, this._targetNode = e, cc.ActionInterval.prototype.initWithDuration.call(this, t)
                },
                startWithTarget: function (e) {
                    cc.ActionInterval.prototype.startWithTarget.call(this, e), this._startPosition = this.target.getContainerPosition(), !e.isMapScroll || !cleverapps.meta.isFocused() || this._params.allowScrollWithFocus || Game.currentGame.tutorial.isActive() ? this._targetNode instanceof cc.Node && !this._targetNode.isRunning() || (e.stopAutoScroll(), cc.ScrollAction._UID++, this._UID = cc.ScrollAction._UID, "number" == typeof this._targetNode ? this._targetPosition = this.target.normalizePoint(this.target.targetToPoint(this._targetNode, this._params.padding)) : !this._targetNode || "object" == typeof this._targetNode && this._targetNode.stopListeners ? this._targetPosition = this._startPosition : this._params.targetPoint ? this._targetPosition = this._targetNode : this._params.visibleBox ? (
                        e = this.target.calcNodeDelta(this._targetNode, this._params), this._targetPosition = cc.pAdd(this._startPosition, e)) : this._targetPosition = this.target.normalizePoint(this.target.targetToPoint(this._targetNode, this._params.padding))) : this._params.skipFocusReport || cleverapps.throwAsync("Trying to scroll with focus, stack - " + this._creationStack)
                },
                clone: function () {
                    return new cc.ScrollAction(this._targetNode, this._params)
                },
                stop: function () {
                    cc.ScrollAction._UID === this._UID && (this.target._scrollActionRunning = !1)
                },
                update: function (e) {
                    cc.ScrollAction._UID === this._UID && (e = this._computeEaseTime(e), this.target.scrollToPoint(cc.pAdd(this._startPosition, cc.pMult(cc.pSub(this._targetPosition, this._startPosition), e))), this.target._scrollActionRunning = !0)
                }
            }), cc.ScrollAction._UID = 0, cc.ScrollAction.SCROLL_TO_DURATION = 1, cc.CellScrollAction = cc.ScrollAction.extend({
                ctor: function (e, t) {
                    this._cellPos = {
                        x: e.x,
                        y: e.y
                    };
                    e = Game.currentGame.map.getView().getCell(this._cellPos.x, this._cellPos.y);
                    this._super(e, t)
                },
                clone: function () {
                    return new cc.CellScrollAction(this._cellPos, this._params)
                }
            }), cleverapps.UI.MapScrollHandler = function (e) {
                this.target = e, this.bounceEnabled = !1, this.initAutoScrollParams()
            }, cleverapps.UI.MapScrollHandler.prototype.initAutoScrollParams = function () {
                this._outOfBoundaryAmountDirty = !0, this._outOfBoundaryAmount = cc.p(0, 0)
            }, cleverapps.UI.MapScrollHandler.prototype.afterContainerMove = function () {
                this._outOfBoundaryAmountDirty = !0
            }, cleverapps.UI.MapScrollHandler.prototype.handlePress = function () {
                this._autoScrolling = !1, this._touchMovePreviousTimestamp = Date.now(), this._touchMoveDisplacements = [], this._touchMoveTimeDeltas = []
            }, cleverapps.UI.MapScrollHandler.prototype.gatherMoveData = function (e) {
                var t = this.getHowMuchOutOfBoundary(e);
                for (e.x += t.x, e.y += t.y; 5 <= this._touchMoveDisplacements.length;) this._touchMoveDisplacements.splice(0, 1), this._touchMoveTimeDeltas.splice(0, 1);
                this._touchMoveDisplacements.push(e);
                t = Date.now();
                this._touchMoveTimeDeltas.push((t - this._touchMovePreviousTimestamp) / 1e3),
                    this._touchMovePreviousTimestamp = t
            }, cleverapps.UI.MapScrollHandler.prototype.handleRelease = function (e) {
                this.gatherMoveData(e);
                e = this.calcTouchVelocity();
                0 === e.x && 0 === e.y || this.startInertialScroll(e)
            }, cleverapps.UI.MapScrollHandler.prototype.processAutoScroll = function (e) {
                var t, s;
                this._autoScrolling && (t = this.isNecessaryAutoScrollBrake() ? .05 : 1, this._autoScrollAccumulatedTime += e * (1 / t), e = Math.min(1, this._autoScrollAccumulatedTime / this._autoScrollTotalTime), this._autoScrollAttenuate && (e = --e * e * e * e * e + 1), t = cc.pAdd(this._autoScrollStartPosition, cc.pMult(this._autoScrollTargetDelta, e)), e = Math.abs(e - 1) <= 1e-4, s = cc.pSub(t, this.target.getContainerPosition()), s = this.getHowMuchOutOfBoundary(s), this.fltEqualZero(s) || (t.x += s.x, t.y += s.y, e = !0), e && (this._autoScrolling = !1), this.target.moveContainer(cc.pSub(t, this.target.getContainerPosition())))
            }, cleverapps.UI.MapScrollHandler.prototype.isOutOfBoundary = function () {
                var e = this.getHowMuchOutOfBoundary();
                return !this.fltEqualZero(e)
            },
            cleverapps.UI.MapScrollHandler.prototype.calcTouchVelocity = function () {
                var e = this._touchMoveTimeDeltas.reduce(function (e, t) {
                    return e + t
                }, 0);
                if (0 === e || e >= this._touchTotalTimeThreshold) return cc.p(0, 0);
                var t = cc.p(0, 0);
                return this._touchMoveDisplacements.forEach(function (e) {
                    t.x += e.x, t.y += e.y
                }), cc.pMult(t, 1 / e)
            }, cleverapps.UI.MapScrollHandler.prototype.isNecessaryAutoScrollBrake = function () {
                if (this._autoScrollBraking) return !0;
                if (this.isOutOfBoundary()) {
                    if (!this._autoScrollCurrentlyOutOfBoundary) return this._autoScrollCurrentlyOutOfBoundary = !0, this._autoScrollBraking = !0, this._autoScrollBrakingStartPosition = this.getContainerPosition(), !0
                } else this._autoScrollCurrentlyOutOfBoundary = !1;
                return !1
            }, cleverapps.UI.MapScrollHandler.prototype.startInertialScroll = function (e) {
                var t = cc.pMult(e, .7),
                    e = this.calculateAutoScrollTimeByInitialSpeed(cc.pLength(e));
                this.startAutoScroll(t, e, !0)
            }, cleverapps.UI.MapScrollHandler.prototype.calculateAutoScrollTimeByInitialSpeed = function (e) {
                return Math.sqrt(Math.sqrt(e / 5))
            }, cleverapps.UI.MapScrollHandler.prototype.fltEqualZero = function (e) {
                return Math.abs(e.x) <= 1e-4 && Math.abs(e.y) <= 1e-4
            }, cleverapps.UI.MapScrollHandler.prototype.startAutoScroll = function (e, t) {
                this._autoScrolling = !0, this._autoScrollTargetDelta = e, this._autoScrollAttenuate = !0, this._autoScrollStartPosition = this.target.getContainerPosition(), this._autoScrollTotalTime = t, this._autoScrollAccumulatedTime = 0, this._autoScrollBraking = !1, this._autoScrollBrakingStartPosition = cc.p(0, 0);
                t = this.getHowMuchOutOfBoundary();
                this.fltEqualZero(t) || (this._autoScrollCurrentlyOutOfBoundary = !0, e = this.getHowMuchOutOfBoundary(e), (0 < t.x * e.x || 0 < t.y * e.y) && (this._autoScrollBraking = !0))
            }, cleverapps.UI.MapScrollHandler.prototype.stopAutoScroll = function () {
                this._autoScrolling = !1
            }, cleverapps.UI.MapScrollHandler.prototype.getHowMuchOutOfBoundary = function (e) {
                if (0 === (e = void 0 === e ? cc.p(0, 0) : e).x && 0 === e.y && !this._outOfBoundaryAmountDirty) return this._outOfBoundaryAmount;
                var t = cc.p(0, 0),
                    s = this.target.container.getBoundingBox();
                return 0 < s.x + e.x ? t.x = -(s.x + e.x) : s.width + s.x + e.x < this.target.width && (t.x = this.target.width - (s.width + s.x + e.x)), s.height + s.y + e.y < this.target.height ? t.y = this.target.height - (s.height + s.y + e.y) : 0 < s.y + e.y && (t.y = -(s.y + e.y)), 0 === e.x && 0 === e.y && (this._outOfBoundaryAmount = t, this._outOfBoundaryAmountDirty = !1), t
            }, cleverapps.UI.Button = cc.Node.extend({
                ctor: function (e) {
                    this._super(), this.setAnchorPoint2(), !(this.settings = e).type && cleverapps.environment.isEditorScene() && (e.type = cleverapps.styles.UI.Button.Images.editor), !e.textVariant && cleverapps.environment.isEditorScene() && (e.textVariant = "strict"), e.type && e.type.button_png || (e.type = cleverapps.styles.UI.Button.Images.button_green), this.bright = !0, this.createBackground(), (e.text || e.textOff) && (this.font = this.workFont(e.textVariant)), e.text && e.type.widthByContent && (e.content = this.createText(e.text, e), t = this.calcPadding(), t = Math.min(e.content.width + t.left + t.right, .9 * cleverapps.UI.getSceneSize().width), this.resize(t, e.content.height), delete e.text),
                        this.content = e.content, this.contentOff = e.contentOff;
                    var t, s = this.calcInnerRect();
                    [this.content, this.contentOff].forEach(function (e) {
                        e && cleverapps.UI.fitToBox(e, {
                            width: s.width,
                            height: s.height
                        })
                    }, this), e.text && (this.content = this.createText(e.text, e, s)), e.textOff && (this.contentOff = this.createText(e.textOff, e, s)), [this.content, this.contentOff].forEach(function (e) {
                        e && (this.addChild(e), e.setPositionRound(s.x + s.width / 2, s.y + s.height / 2))
                    }, this), this._toggleContent(!0), this.content instanceof cleverapps.UI.LabelTTF && (this.text = this.content), this.contentOff instanceof cleverapps.UI.LabelTTF && (this.textOff = this.contentOff), this.hoverHandler = cleverapps.UI.applyHover(this, {
                        filter: e.filter,
                        onMouseOver: this.onMouseOver.bind(this),
                        onMouseOut: this.onMouseOut.bind(this)
                    }), this.clickHandler = cleverapps.UI.onClick(this, function () {
                        this.action()
                    }.bind(this), {
                        filter: e.filter
                    }), e.mark && this.setAttention(!0), e.disabled && this.disable()
                },
                setAttention: function (e) {
                    e && this.mark || (e ? (this.mark = new Attention,
                        this.mark.setPositionRound(this.settings.type.mark || cleverapps.styles.UI.Button.mark), this.addChild(this.mark)) : this.mark && (this.mark.removeFromParent(), delete this.mark))
                },
                calcInnerRect: function () {
                    var e = this.calcPadding();
                    return cc.rect(e.left, e.bottom, this.width - e.left - e.right, this.height - e.bottom - e.top)
                },
                calcPadding: function () {
                    var e = (this.settings.type.SKIP_RESOLUTION ? this.settings.type : cleverapps.styles.UI.Button).SKIP_RESOLUTION.padding;
                    return {
                        left: Math.floor(this.height * e.left),
                        right: Math.floor(this.height * e.right),
                        bottom: Math.floor(this.height * e.bottom),
                        top: Math.floor(this.height * e.top)
                    }
                },
                createText: function (e, t, s) {
                    if (TextWithIcon.IsApplicable(e, t.icons)) return new TextWithIcon(e, {
                        font: this.font,
                        width: s && s.width,
                        height: s && s.height,
                        icons: t.icons,
                        iconMinHeight: t.iconMinHeight,
                        iconMaxHeight: t.iconMaxHeight
                    });
                    t = cleverapps.UI.generateOnlyText(e, this.font);
                    return s && t.fitTo(s.width, s.height), t
                },
                guessFontSize: function () {
                    var e = cleverapps.styles.UI.Button,
                        t = Math.round(
                            this.height * cleverapps.styles.FONTS.BUTTON_TEXT.size / e.defaultSize);
                    return Math.min(e.maxFontSize, t)
                },
                showAlert: function () {
                    !this.disabled && this.settings.spine && this.background.hasAnimation("alert") && this.background.addAnimation(0, "alert", !1)
                },
                setMarkVisible: function (e) {
                    this.mark && this.mark.setVisible(e)
                },
                showHint: function (e) {
                    var t = new cc.Sequence(new cc.DelayTime(1), new cc.CallFunc(function () {
                        this.disabled || !this.isDisplayed() || this.hint || (this.hint = new cleverapps.UI.Tooltip(this.background, {
                            text: e,
                            size: cleverapps.styles.UI.Button.tooltipSize,
                            position: this.settings.hintPosition || cleverapps.styles.UI.Tooltip.LOCATION.above
                        }), this.addChild(this.hint), this.hint.setPositionRound(this.settings.hintPosition || cleverapps.styles.UI.Tooltip.LOCATION.above), this.hint.replaceParentSamePlace(cleverapps.scenes.getRunningScene()))
                    }.bind(this)));
                    t.setTag(cleverapps.UI.Button.HINT_ACTION_TAG), this.runAction(t)
                },
                hideHint: function () {
                    this.stopActionByTag(cleverapps.UI.Button.HINT_ACTION_TAG), this.hint && (
                        this.hint.removeFromParent(), this.hint = void 0)
                },
                createBackground: function () {
                    var e, t;
                    this.settings.noBg ? this.setContentSize2(this.settings.width, this.settings.height) : (this.settings.spine ? (e = this.settings.width, t = this.settings.height, this.background = new cleverapps.Spine(this.settings.spine), this.settings.skin && this.background.setSkin(this.settings.skin), this.background.setAnimation(0, "idle", !0)) : (this.background = cleverapps.UI.createScale9Sprite(this.settings.type.button_png, void 0 !== this.settings.scale9Rect ? this.settings.scale9Rect : cleverapps.UI.Scale9Rect.TwoPixelX), e = this.settings.width || this.background.width, t = this.settings.height || this.background.height), this.addChild(this.background), this.resize(e, t))
                },
                workFont: function (e) {
                    var e = cleverapps.clone(cleverapps.UI.Button.WorkFont(e)),
                        t = this.guessFontSize();
                    return t && (e.size = t), e
                },
                setString: function (e) {
                    this._setString(this.content, this.text, e)
                },
                setStringOff: function (e) {
                    this._setString(this.contentOff, this.textOff, e)
                },
                _setString: function (
                    e, t, s) {
                    var i = this.calcInnerRect();
                    e instanceof TextWithIcon ? e.setString(s) : (t.setFont(this.font), t.setString(s), t.fitTo(i.width, i.height))
                },
                setTextVariant: function (e) {
                    this.text && (this.font = this.workFont(e), this.text.setFont(this.font), this.setString(this.text.getString())), this.content instanceof TextWithIcon && (this.font = this.workFont(e), this.content.setFont(this.font))
                },
                setType: function (e) {
                    e && e.button_png || (e = cleverapps.styles.UI.Button.Images.button_green), this.settings.type = e, this._innerUpdateBgContent()
                },
                resize: function (e, t) {
                    this.setContentSize2(e, t), this.settings.spine || (this.settings.type.keepRadius || cleverapps.styles.UI.Button.keepRadius && !1 !== this.settings.type.keepRadius || this.settings.keepRadius ? (this.background.setScale(t / this.background.height), this.background.setContentSize2(e / this.background.scale, this.background.height)) : this.background.setContentSize2(e, t)), this.background.setPositionRound(this.width / 2, this.height / 2)
                },
                applyInteractiveScale: function () {
                    var e, t, s;
                    this.disabled || (e = this.baseScaleX || this.baseScale || 1, t = this.baseScaleY || this.baseScale || 1, (s = this.getInteractiveStates()).mouseover || s.pressed ? this.setScale(1.03 * e, 1.03 * t) : this.setScale(e, t), this._innerUpdateBgContent())
                },
                action: function () {
                    this.disabled || this._isAncestorsVisible(this) && (cleverapps.audio.playSound(this.settings.click_effect || bundles.main.urls.click_effect), this.settings.onClicked(), this.settings.selectOnClick && (this.selected = !this.selected, this._innerUpdateBgContent()))
                },
                setBright: function (e) {
                    this.bright = e, this._innerUpdateBgContent()
                },
                disable: function () {
                    this.disabled || (this.onMouseOut(), this.setMarkVisible(!1), this.disabled = !0, this.clickHandler.setEnabled(!1), this._innerUpdateBgContent())
                },
                enable: function () {
                    this.disabled && (this.disabled = !1, this.setMarkVisible(!0), this.clickHandler.setEnabled(!0), this._innerUpdateBgContent())
                },
                onMouseOver: function () {
                    this.disabled || (this.settings.onMouseOver ? this.settings.onMouseOver() : (this.applyInteractiveScale(),
                        this.settings.hint && this.showHint(this.settings.hint)))
                },
                onMouseOut: function () {
                    this.disabled || (this.settings.onMouseOut ? this.settings.onMouseOut() : (this.applyInteractiveScale(), this.settings.hint && this.hideHint()))
                },
                _toggleContent: function (e) {
                    this.content && this.contentOff && (e ? (this.content.setVisible(!0), this.contentOff.setVisible(!1)) : (this.content.setVisible(!1), this.contentOff.setVisible(!0)))
                },
                _innerUpdateBgContent: function () {
                    var e, t = this.bright && !this.disabled,
                        s = this.getInteractiveStates();
                    this.settings.spine ? (e = "idle", s.pressed && this.background.hasAnimation("idle_on") ? e = "idle_on" : !t && this.background.hasAnimation("idle_off") && (e = "idle_off"), this.background.setAnimation(0, e, !0)) : (this.background && (e = this.settings.type.button_off_png, s.pressed || this.selected ? e = this.settings.type.button_on_png : t && (e = this.settings.type.button_png), this.background.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(e, this.getPreferredBundles()))), this._toggleContent(t))
                },
                _isAncestorsVisible: function (e) {
                    if (null == e) return !0;
                    e = e.getParent();
                    return !(e && !e.isVisible()) && this._isAncestorsVisible(e)
                }
            }), cleverapps.UI.Button.HINT_ACTION_TAG = 2, cleverapps.UI.Button.TEXT_REGULAR = "regular", cleverapps.UI.Button.TEXT_EMPHASIS = "emphasis", cleverapps.UI.Button.WorkFont = function (e) {
                return cleverapps.UI.Button.Fonts || (cleverapps.UI.Button.Fonts = {
                    regular: {
                        size: 0
                    },
                    emphasis: {
                        size: 0
                    },
                    strict: {
                        size: 0
                    },
                    strict_white: {
                        size: 0
                    },
                    strict_black: {
                        size: 0
                    },
                    strict_blue: {
                        size: 0
                    }
                }, cleverapps.overrideFonts(cleverapps.UI.Button.Fonts, {
                    regular: cleverapps.styles.FONTS.BUTTON_TEXT,
                    emphasis: cleverapps.styles.FONTS.BUTTON_TEXT,
                    strict: cleverapps.styles.FONTS.STRICT_TEXT,
                    strict_white: cleverapps.styles.FONTS.STRICT_WHITE_TEXT,
                    strict_black: cleverapps.styles.FONTS.STRICT_BLACK_TEXT,
                    strict_blue: cleverapps.styles.FONTS.STRICT_BLUE_TEXT
                }), cleverapps.UI.Button.Fonts.emphasis.color = cleverapps.styles.COLORS.COLOR_RED), e && cleverapps.UI.Button.Fonts[e] || cleverapps.UI.Button.Fonts.regular
            }, cleverapps.styles.UI.Button = {
                keepRadius: !1,
                maxFontSize: 65,
                SKIP_RESOLUTION: {
                    padding: {
                        left: .3,
                        right: .3,
                        top: .05,
                        bottom: .05
                    }
                },
                defaultSize: 90,
                tooltipSize: {
                    width: 300,
                    height: 80
                },
                mark: {
                    x: {
                        align: "right",
                        dx: 15
                    },
                    y: {
                        align: "top",
                        dy: 10
                    }
                }
            }, cleverapps.styles.UI.Button.Images = cleverapps.overrideTemplates({}, {
                button_green: {
                    button_png: bundles.buttons.frames.button_png,
                    button_on_png: bundles.buttons.frames.button_on_png,
                    button_off_png: bundles.buttons.frames.button_disabled_png
                },
                button_blue: {
                    button_png: bundles.buttons.frames.blue_button_png,
                    button_on_png: bundles.buttons.frames.blue_button_on_png,
                    button_off_png: bundles.buttons.frames.button_disabled_png
                },
                button_red: {
                    button_png: bundles.buttons.frames.red_button,
                    button_on_png: bundles.buttons.frames.red_button_on,
                    button_off_png: bundles.buttons.frames.button_disabled_png
                },
                button_purple: {
                    button_png: bundles.buttons.frames.purple_button_png,
                    button_on_png: bundles.buttons.frames.purple_button_on_png,
                    button_off_png: bundles.buttons.frames.button_disabled_png
                },
                small_button_blue: {
                    button_png: bundles.buttons.frames.small_blue_button,
                    button_on_png: bundles.buttons.frames.small_blue_button_on,
                    button_off_png: bundles.buttons.frames.small_button_off
                },
                small_button_green: {
                    button_png: bundles.buttons.frames.small_button,
                    button_on_png: bundles.buttons.frames.small_button_on,
                    button_off_png: bundles.buttons.frames.small_button_off
                },
                chat: {
                    button_png: bundles.chat.frames.accept_button,
                    button_on_png: bundles.chat.frames.accept_button_on
                },
                chat_categories: {
                    button_png: bundles.chat.frames.category_bg,
                    button_on_png: bundles.chat.frames.category_bg_on,
                    button_off_png: bundles.chat.frames.active_category_bg,
                    widthByContent: !0
                },
                field_button_green: {
                    button_png: bundles.buttons.frames.field_green_button,
                    button_on_png: bundles.buttons.frames.field_green_button_on,
                    button_off_png: bundles.buttons.frames.field_button_off
                },
                field_button_blue: {
                    button_png: bundles.buttons.frames.field_blue_button,
                    button_on_png: bundles.buttons.frames.field_blue_button_on,
                    button_off_png: bundles.buttons.frames.field_button_off
                }
            }), cleverapps.config.debugMode && cleverapps.overrideTemplates(cleverapps.styles.UI.Button.Images, {
                git: {
                    button_png: bundles.git.frames.button,
                    button_on_png: bundles.git.frames.button_on,
                    button_off_png: bundles.git.frames.button_off,
                    SKIP_RESOLUTION: {
                        padding: {
                            left: .1,
                            right: .1,
                            top: .1,
                            bottom: .1
                        }
                    }
                },
                editor: {
                    button_png: bundles.editor_buttons.frames.button,
                    button_on_png: bundles.editor_buttons.frames.button_on,
                    button_off_png: bundles.editor_buttons.frames.button_off,
                    SKIP_RESOLUTION: {
                        padding: {
                            left: .1,
                            right: .1,
                            top: .1,
                            bottom: .1
                        }
                    }
                },
                editor_plus: {
                    button_png: bundles.admin.frames.plus_button,
                    button_on_png: bundles.admin.frames.plus_button,
                    button_off_png: bundles.admin.frames.plus_button
                },
                wysiwyg: {
                    button_png: bundles.wysiwyg.frames.button_on,
                    button_on_png: bundles.wysiwyg.frames.button_on,
                    button_off_png: bundles.wysiwyg.frames.button_off,
                    SKIP_RESOLUTION: {
                        padding: {
                            left: .05,
                            right: .05,
                            top: .05,
                            bottom: .05
                        }
                    }
                }
            }), cleverapps.UI.HelpButton = cleverapps.UI.Button.extend({
                ctor: function (e, t) {
                    this.options = t || {}, this._super({
                        type: {
                            button_png: bundles.buttons.frames.help_button_png,
                            button_on_png: bundles.buttons.frames.help_button_on_png,
                            button_off_png: bundles.buttons.frames.help_button_off_png
                        },
                        onClicked: e
                    })
                },
                getPreferredBundles: function () {
                    return this.options.window ? ["main"] : this._super()
                }
            }), cleverapps.UI.LabelTTF = cc.LabelTTF.extend({
                ctor: function (e, t, s) {
                    this._wrapWidth = 0, this._strokeOpacity = 0, this._super("", t), this.setWrapWidth(s)
                },
                fitTo: function (e, t) {
                    cleverapps.UI.ImageFont.prototype.fitTo.apply(this, arguments), this.debugRegionForFitTo = {
                        width: e,
                        height: t
                    }
                },
                canAttachLastLine: function () {
                    var e = this._renderCmd._strings;
                    if (!e || e.length <= 1) return !1;
                    var t = e[e.length - 1];
                    return this._string.slice(this._string.length - t.length - 1) !== "\n" + t && (10 <= e[e.length - 2].length && t.length <= 2)
                },
                setWrapWidth: function (e) {
                    e = 0 < e ? Math.min(e, this.maxWidth()) : Math.min(cleverapps.styles.UI.TTFText.wrapWidth, this.maxWidth()), this._wrapWidth !== e && (this._wrapWidth = e, e = this.getString(), cc.LabelTTF.prototype.setString.call(this, ""),
                        cc.LabelTTF.prototype.setString.call(this, e))
                },
                setDimensions: function (e, t) {
                    void 0 === t && (t = e.height, e = e.width), 0 < e || (e = 0), 0 < t || (t = 0), e = Math.min(e, this.maxWidth()), this._super(e, t)
                },
                setFontSize: function (e) {
                    cleverapps.styles.UI.glyphScale && -1 !== ["ja", "zh", "ko"].indexOf(cleverapps.settings.language) && (e = Math.round(e * cleverapps.styles.UI.glyphScale.scale)), this._super(e)
                },
                setFont: function (e) {
                    this.setFontFillColor(e.color || cleverapps.styles.COLORS.WHITE), this.setFontSize(e.size), e.shadow ? this.enableShadow(e.shadow.color, e.shadow.direction, e.shadow.blur) : this.disableShadow(), e.stroke ? this.enableStroke(e.stroke.color, e.stroke.size) : this.disableStroke(), e.lineHeight && this.setLineHeight(e.lineHeight);
                    e = this.getString();
                    cc.LabelTTF.prototype.setString.call(this, ""), cc.LabelTTF.prototype.setString.call(this, e)
                },
                enableStroke: function (e, t) {
                    this._super(e, t);
                    t = e.a / 255;
                    this._strokeOpacity !== t && (this._strokeOpacity = t, this._renderCmd._setColorsString())
                },
                byLetterAnimation: function (t) {
                    var i = (t = t || {}).speed || .03,
                        e = t.delay || .1;
                    if (cc.sys.isMobile && !cc.sys.isNative) return this.setOpacity(0), this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.FadeIn(.3))), void (t.callback && t.callback());
                    this._fullString = this.getString();
                    var n = 0,
                        o = (this._byLetterAnimationRunning && this.stopAllActions(), this._byLetterAnimationRunning = !0, this._byLetterAnimationDone = function (e) {
                            this._byLetterAnimationRunning && (this.stopAllActions(), this._byLetterAnimationRunning = !1, cc.LabelTTF.prototype.setString.call(this, this._fullString), this._byLetterAnimationDone = void 0, t.callback && t.callback(e))
                        }.bind(this), cc.LabelTTF.prototype.setString.call(this, ""), void 0),
                        a = function (e) {
                            this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.CallFunc(function () {
                                var e = 0 < n ? this._fullString[n - 1] : void 0,
                                    t = (n++, this._fullString[n - 1]);
                                if (" " === e && " " !== t) {
                                    for (var s = n; s < this._fullString.length && " " !== this._fullString[s];) s++;
                                    cc.LabelTTF.prototype.setString.call(this, this._fullString.substr(0, s)), o && this.height !== o && (
                                        this._fullString = this._fullString.substr(0, n - 2) + "\n" + this._fullString.substr(n - 1))
                                }
                                cc.LabelTTF.prototype.setString.call(this, this._fullString.substr(0, n)), n < this._fullString.length ? (a(i), o = this.height) : this._byLetterAnimationDone && this._byLetterAnimationDone()
                            }.bind(this))))
                        }.bind(this);
                    a(e)
                },
                byLetterAnimationFinish: function () {
                    this._byLetterAnimationRunning && this._byLetterAnimationDone(!0)
                },
                setString: function (e, t) {
                    e = cleverapps.UI.LabelTTF.GetLocalizedText(e, t), cc.LabelTTF.prototype.setString.call(this, e), cleverapps.config.debugMode && (this.debugTextCode = Messages.debugTextCodes[e.toLowerCase().replace(/\s/g, ".")])
                },
                maxWidth: function () {
                    return cc._renderType !== cc.game.RENDER_TYPE_CANVAS ? cc.configuration.getMaxTextureSize() / cc.view.getDevicePixelRatio() : cleverapps.styles.UI.TTFText.wrapWidth
                }
            }), cleverapps.UI.LabelTTF.GetLocalizedText = function (e, t) {
                return "number" == typeof e ? e + "" : "string" != typeof e ? (e || "") + "" : Messages.get(e, t)
            }, "cocos2d" === engine && (cc.LabelTTF.prototype.setLineHeight = function (
                e) {
                this._lineHeight = e, this._setUpdateTextureDirty()
            }, cc.LabelTTF.prototype._setUpdateTextureDirty = function () {
                this._needUpdateTexture = !0, this._needUpdateTTF = !0, this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.textDirty)
            }, cc.LabelTTF.RenderCmd.prototype._setColorsString = function () {
                var e = this._displayedColor,
                    t = this._node,
                    s = t._shadowColor || this._displayedColor,
                    i = t._strokeColor,
                    n = t._textFillColor,
                    o = e.r / 255,
                    a = e.g / 255,
                    e = e.b / 255;
                this._shadowColorStr = "rgba(" + (0 | o * s.r) + "," + (0 | a * s.g) + "," + (0 | e * s.b) + "," + t._shadowOpacity + ")", this._fillColorStr = "rgba(" + (0 | o * n.r) + "," + (0 | a * n.g) + "," + (0 | e * n.b) + ", 1)", this._strokeColorStr = "rgba(" + (0 | o * i.r) + "," + (0 | a * i.g) + "," + (0 | e * i.b) + "," + t._strokeOpacity + ")"
            }, cc.LabelTTF.WebGLRenderCmd.prototype._setColorsString = cc.LabelTTF.RenderCmd.prototype._setColorsString, cc.LabelTTF.CacheRenderCmd.prototype._setColorsString = cc.LabelTTF.RenderCmd.prototype._setColorsString, cc.LabelTTF.CanvasRenderCmd.prototype._setColorsString = cc.LabelTTF.RenderCmd.prototype._setColorsString,
                cc.LabelTTF.CacheCanvasRenderCmd.prototype._setColorsString = cc.LabelTTF.RenderCmd.prototype._setColorsString, cc.LabelTTF.RenderCmd.prototype._updateTTF = function () {
                    var e = this._node;
                    if (e._needUpdateTTF) {
                        e._needUpdateTTF = !1;
                        var t = cc.view.getDevicePixelRatio(),
                            s = e._wrapWidth * t || 0,
                            i = e._dimensions.width * t || 0,
                            n = e._dimensions.height * t || 0,
                            p = (this._measureConfig(), 0),
                            o = 0,
                            a = (e._strokeEnabled && (p = o = 2 * e._strokeSize), e._shadowEnabled && (p += 2 * Math.abs(e._shadowOffset.x), o += 2 * Math.abs(e._shadowOffset.y)), o *= t, (p *= t) + 2 * t),
                            r = ("normal" !== e._getFontStyle() && (a += Math.ceil(.3 * e._fontSize)), this._strings = e._string.split("\n")),
                            c = i || s;
                        if (0 < c) {
                            for (var d = Math.max(a, c - a), l = 0; l < r.length; ++l) r[l] = r[l].trim(), this._checkWarp(r, l, d);
                            c = i
                        }
                        if (this._isMultiLine = 1 < r.length, !c) {
                            for (l = 0; l < r.length; ++l) c < (d = Math.ceil(this._measure(r[l]))) && (c = d);
                            c += a = 0 === c ? 0 : a
                        }
                        s = c, n = (cc._renderType !== cc.game.RENDER_TYPE_CANVAS && (s = Math.min(s, cc.configuration.getMaxTextureSize())), i = n || e.getLineHeight() * t * r.length + o, e.setContentSize(s, i),
                            e._strokeShadowOffsetX = p, e._strokeShadowOffsetY = o, e._anchorPoint);
                        this._anchorPointInPoints.x = .5 * a + (s - a) * n.x, this._anchorPointInPoints.y = .5 * o + (i - o) * n.y
                    }
                }, cc.LabelTTF.WebGLRenderCmd.prototype._updateTTF = cc.LabelTTF.RenderCmd.prototype._updateTTF, cc.LabelTTF.CacheRenderCmd.prototype._updateTTF = cc.LabelTTF.RenderCmd.prototype._updateTTF, cc.LabelTTF.CanvasRenderCmd.prototype._updateTTF = cc.LabelTTF.RenderCmd.prototype._updateTTF, cc.LabelTTF.CacheCanvasRenderCmd.prototype._updateTTF = cc.LabelTTF.RenderCmd.prototype._updateTTF, cc.LabelTTF.RenderCmd.prototype._setFontStyle = function (e, t, s, i) {
                    e instanceof cc.FontDefinition ? this._fontStyleStr = e._getCanvasFontStr() : this._fontStyleStr = s + " " + i + " " + cc.view.getDevicePixelRatio() * t + "px '" + e + "'", this._fontProperties = cc.LabelTTF.__getFontProperties(e, t), this._fontClientHeight = this._fontProperties.ascent + this._fontProperties.descent
                }, cc.LabelTTF.WebGLRenderCmd.prototype._setFontStyle = cc.LabelTTF.RenderCmd.prototype._setFontStyle,
                cc.LabelTTF.CacheRenderCmd.prototype._setFontStyle = cc.LabelTTF.RenderCmd.prototype._setFontStyle, cc.LabelTTF.CanvasRenderCmd.prototype._setFontStyle = cc.LabelTTF.RenderCmd.prototype._setFontStyle, cc.LabelTTF.CacheCanvasRenderCmd.prototype._setFontStyle = cc.LabelTTF.RenderCmd.prototype._setFontStyle, cc.LabelTTF._textBaseline = ["alphabetic", "alphabetic", "alphabetic"], cc.LabelTTF.RenderCmd.prototype._saveStatus = function () {
                    var e = this._node,
                        t = e._strokeShadowOffsetX,
                        s = e._strokeShadowOffsetY,
                        i = e._contentSize.height - s,
                        n = e._vAlignment,
                        o = e._hAlignment,
                        p = .5 * t,
                        s = i + .5 * s,
                        a = [],
                        t = e._contentSize.width - t,
                        r = cc.view.getDevicePixelRatio(),
                        c = e.getLineHeight() * r,
                        e = this._fontProperties.ascent * r,
                        r = (r = this._fontProperties.descent * r) * c / ((e = e * c / (e + r)) + r),
                        o = o === cc.TEXT_ALIGNMENT_RIGHT ? t : o === cc.TEXT_ALIGNMENT_CENTER ? t / 2 : 0;
                    if (this._isMultiLine)
                        for (var l = this._strings.length, d = n === cc.VERTICAL_TEXT_ALIGNMENT_TOP ? e - i : n === cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM ? -c * (l - 1) - r : -i / 2 - c * (l - 1) / 2 - (r - e) / 2, u = 0; u < l; u++) a.push(0 | c * u + d);
                    else d = n === cc.VERTICAL_TEXT_ALIGNMENT_TOP ? e - i : n === cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM ? -r : -i / 2 - (r - e) / 2, a.push(0 | d);
                    t = {
                        contextTransform: cc.p(p, s),
                        xOffset: o,
                        OffsetYArray: a
                    };
                    this._status.push(t)
                }, cc.LabelTTF.WebGLRenderCmd.prototype._saveStatus = cc.LabelTTF.RenderCmd.prototype._saveStatus, cc.LabelTTF.CacheRenderCmd.prototype._saveStatus = cc.LabelTTF.RenderCmd.prototype._saveStatus, cc.LabelTTF.CanvasRenderCmd.prototype._saveStatus = cc.LabelTTF.RenderCmd.prototype._saveStatus, cc.LabelTTF.CacheCanvasRenderCmd.prototype._saveStatus = cc.LabelTTF.RenderCmd.prototype._saveStatus), cc.LabelTTF.METRICS_STRING = "|ÉÅÇعر", cc.LabelTTF.BASELINE_SYMBOL = "M", cc.LabelTTF.__labelPropertiesCanvas = document.createElement("canvas"), cc.LabelTTF.__labelPropertiesContext = cc.LabelTTF.__labelPropertiesCanvas.getContext("2d"), cc.LabelTTF.__fontPropertiesCache = {}, cc.LabelTTF.__getFontProperties = function (e, t) {
                    var s, e = e instanceof cc.FontDefinition ? (t = e.fontSize, s = e._getCanvasFontStr(),
                        e.fontStyle + " " + e.fontWeight + " " + e.fontSize + "px '" + e.fontName + "'") : void 0 === t ? s = e : (s = e + "." + t, t + "px '" + e + "'");
                    if (i = cc.LabelTTF.__fontPropertiesCache[s]) return i;
                    var i = {
                        ascent: 0,
                        descent: 0
                    },
                        p = cc.LabelTTF.__labelPropertiesCanvas,
                        n = cc.LabelTTF.__labelPropertiesContext,
                        d = (n.font = e, cc.LabelTTF.METRICS_STRING + cc.LabelTTF.BASELINE_SYMBOL),
                        o = n.measureText(d);
                    if (o.actualBoundingBoxAscent && o.actualBoundingBoxDescent) return cc.LabelTTF.__fontPropertiesCache[s] = i = {
                        ascent: o.actualBoundingBoxAscent,
                        descent: o.actualBoundingBoxDescent
                    }, i;
                    var o = Math.ceil(o.width),
                        u = n.measureText(cc.LabelTTF.BASELINE_SYMBOL),
                        a = Math.ceil(2 * u.width),
                        r = Math.ceil(1.4 * u.width);
                    if (!o || !a) return {
                        ascent: Math.round(1.06 * t),
                        descent: Math.round(.3 * t)
                    };
                    p.width = o, p.height = a, n.fillStyle = "#f00", n.fillRect(0, 0, o, a), n.font = e, n.textBaseline = "alphabetic", n.fillStyle = "#000", n.fillText(d, 0, r);
                    for (var h = n.getImageData(0, 0, o, a).data, g = 4 * o, v = 0, m = !1, c = 0; c < r; ++c) {
                        for (var l = 0; l < g; l += 4)
                            if (255 !== h[v + l]) {
                                m = !0;
                                break
                            } if (m) break;
                        v += g
                    }
                    for (i.ascent = r - c,
                        v = h.length - g, m = !1, c = a; r < c; --c) {
                        for (l = 0; l < g; l += 4)
                            if (255 !== h[v + l]) {
                                m = !0;
                                break
                            } if (m) break;
                        v -= g
                    }
                    return i.descent = c - r, cc.LabelTTF.__fontPropertiesCache[s] = i
                }, cleverapps.overrideStyles(cleverapps.styles.UI, {
                    TTFText: {
                        wrapWidth: 1e3
                    }
                }), cleverapps.Layout = cc.Node.extend({
                    ctor: function (e, t) {
                        this._super(), this.options = t, e.length && this.setItems(e)
                    },
                    setItems: function (e, t) {
                        this.removeAllChildren(t), e.forEach(function (e) {
                            e && this.addChild(e)
                        }, this), this.reshape()
                    },
                    reshape: function () {
                        return this.children.forEach(function (e) {
                            e.setPositionRound(0, 0)
                        }), cleverapps.UI.arrangeWithMargins(this.children, this.options), cleverapps.UI.wrap(this, {
                            considerRotation: !0
                        }), this.options.padding && cleverapps.UI.wrapWithPadding(this, this.options.padding, !0), this.options.dimensions && cleverapps.UI.setDimensions(this, this.options.dimensions), this
                    },
                    setOptions: function (e) {
                        cleverapps.override(this.options, e)
                    }
                }), cleverapps.Layout.AsyncChild = cc.Node.extend({
                    ctor: function () {
                        this._super(), this.setAnchorPoint2()
                    }
                }),
            cleverapps.Layout.AsyncChild.prototype.reshape = function (e) {
                this.setContentSize2(e.width * e.scaleX, e.height * e.scaleY), this.addChild(e), e.setPositionRound(this.width / 2, this.height / 2), this.alignment && this.setPositionRound(this.alignment), this.parent && this.parent.reshape && this.parent.reshape()
            }, cleverapps.GridLayout = cc.Node.extend({
                ctor: function (e, t) {
                    this._super(), this.items = e.slice(), this.setAnchorPoint2(), this.prepareOptions(t), this.reshape()
                },
                prepareOptions: function (e) {
                    (e = e || {}).padding = e.padding || {}, e.margin = e.margin || {}, e.align = e.align || {}, e.separator = e.separator || {}, this.options = {
                        columns: e.columns || 1,
                        reverseRows: e.reverseRows || !1,
                        margin: {
                            x: e.margin.x || 0,
                            y: e.margin.y || 0
                        },
                        padding: {
                            left: e.padding.left || e.padding.x || 0,
                            right: e.padding.right || e.padding.x || 0,
                            top: e.padding.top || e.padding.y || 0,
                            bottom: e.padding.bottom || e.padding.y || 0
                        },
                        align: {
                            x: e.align.x || cleverapps.GridLayout.ALIGN_CENTER,
                            y: e.align.y || cleverapps.GridLayout.ALIGN_CENTER
                        },
                        cell: e.cell && {
                            width: e.cell.width || 0,
                            height: e.cell.height || 0
                        },
                        separator: {
                            horizontal: e.separator.horizontal,
                            map: e.separator.map
                        },
                        ascZOrder: e.ascZOrder
                    }
                },
                setItems: function (e) {
                    this.items = e.slice(), this.reshape(!1)
                },
                addItems: function (e) {
                    e = cleverapps.toArray(e), this.setItems(this.items.concat(e))
                },
                removeItems: function (e) {
                    e = cleverapps.toArray(e), this.setItems(cleverapps.substract(this.items, e, function (e) {
                        return e.__instanceId
                    }))
                },
                sortItems: function (e) {
                    this.items = this.items.slice().sort(e), this.reshape(!1)
                },
                calcCellsSize: function () {
                    var e = this.columnsWidth = [],
                        t = this.rowsHeight = [];
                    if (this.options.cell) {
                        for (var s = 0; s < this.rows.length; ++s) t[s] = this.options.cell.height;
                        for (s = 0; s < this.options.columns; ++s) e[s] = this.options.cell.width
                    } else
                        for (s = 0; s < this.rows.length; ++s)
                            for (var i = 0, n = this.rows[s]; i < n.length; ++i) {
                                var o = n[i];
                                e[i] = Math.max(o.width * o.scaleX, e[i] || 0), t[s] = Math.max(o.height * o.scaleY, t[s] || 0)
                            }
                },
                splitItemsInRows: function () {
                    for (var e = this.rows = [], t = 0; t < this.items.length; t += this.options.columns) e.push(this.items.slice(t,
                        t + this.options.columns));
                    this.options.reverseRows || e.reverse()
                },
                reshape: function (e) {
                    this.removeAllChildren(e), this.splitItemsInRows(), this.calcCellsSize();
                    for (var s = this.options, t = s.padding.bottom, i = 0; i < this.rows.length; ++i) {
                        for (var n = s.padding.left, o = this.rows[i], a = 0; a < o.length; ++a) this.insertChild(o[a], n, t, i, a), s.separator.horizontal && a !== o.length - 1 && (o[a].skipSeparator || this.addSeparator(s.separator.horizontal, n + this.columnsWidth[a], t, s.margin.x, this.rowsHeight[i])), n += this.columnsWidth[a] + s.margin.x;
                        t += this.rowsHeight[i] + s.margin.y
                    }
                    var e = this.columnsWidth.reduce(function (e, t) {
                        return e + t + s.margin.x
                    }, 0) + s.padding.left + s.padding.right - s.margin.x,
                        r = t + s.padding.top - s.margin.y;
                    this.setContentSize2(e, r)
                },
                insertChild: function (e, t, s, i, n) {
                    var o = {},
                        a = {};
                    switch (this.options.align.x) {
                        case cleverapps.GridLayout.ALIGN_START:
                            o.x = 0, a.x = t;
                            break;
                        case cleverapps.GridLayout.ALIGN_END:
                            o.x = 1, a.x = t + this.columnsWidth[n];
                            break;
                        default:
                            o.x = .5, a.x = t + this.columnsWidth[n] / 2
                    }
                    switch (this.options.align.y) {
                        case cleverapps.GridLayout.ALIGN_START:
                            o.y = 0, a.y = s;
                            break;
                        case cleverapps.GridLayout.ALIGN_END:
                            o.y = 1, a.y = s + this.rowsHeight[i];
                            break;
                        default:
                            o.y = .5, a.y = s + this.rowsHeight[i] / 2
                    }
                    this.addChild(e), e.setAnchorPoint2(o.x, o.y), e.setPositionRound(a.x, a.y)
                },
                addSeparator: function (e, t, s, i, n) {
                    var o = new cc.Sprite(e.icon || bundles.merge.frames.next_arrow);
                    o.setAnchorPoint2(), o.setPositionRound(t + (e.x ? o.calculateCoordinate(e.x, "x", i) : i / 2), s + (e.y ? o.calculateCoordinate(e.y, "y", n) : n / 2)), this.addChild(o)
                }
            }), cleverapps.GridLayout.ALIGN_CENTER = 0, cleverapps.GridLayout.ALIGN_START = 1, cleverapps.GridLayout.ALIGN_END = 2, cleverapps.WrapGridLayout = cleverapps.GridLayout.extend({
                reshape: function () {
                    this.removeAllChildren(), this.splitItemsInRows();
                    var e = this.rows.map(function (e, t) {
                        e = new cleverapps.Layout(e, {
                            direction: cleverapps.UI.HORIZONTAL,
                            margin: this.options.margin.x
                        });
                        return this.options.ascZOrder && e.setLocalZOrder(this.rows.length - t), e
                    }, this),
                        e = new cleverapps.Layout(e, {
                            direction: cleverapps.UI.VERTICAL,
                            margin: this.options.margin.y,
                            padding: this.options.padding,
                            reversed: !0
                        });
                    this.setContentSize(e.getContentSize()), this.addChild(e), e.setPositionRound(this.width / 2, this.height / 2)
                }
            }), cleverapps.UI.CarouselView = cc.Node.extend({
                ctor: function (e, t) {
                    this._super(e, t), this.items = e, this.items.forEach(function (e, t) {
                        cleverapps.UI.onClick(e, function () {
                            this.setCurrent(t)
                        }.bind(this))
                    }, this), this.amount = e.length, this.direction = t.direction, this.onChange = t.onChange, this.content = new cleverapps.Layout(e, t), this.setAnchorPoint2();
                    var e = this.content.getContentSize(),
                        t = cleverapps.UI.getSceneSize(),
                        s = (this.direction === cleverapps.UI.HORIZONTAL ? e.width = Math.min(t.width, 2 * e.width) : e.height = Math.min(t.height, 2 * e.height), this.setContentSize2(e), this.addChild(this.content), this.content.setPositionRound(this.width / 2, this.height / 2), this.content.setAnchorPoint2(0, .5), !1);
                    cleverapps.UI.onDrag(this, {
                        onDragStart: function () {
                            return !(s = !1)
                        },
                        onDragMove: function (e) {
                            var t;
                            s || (t = cleverapps.styles.CarouselView,
                                e = this.convertTouchToNodeSpaceDisplacement(e), e = this.direction === cleverapps.UI.HORIZONTAL ? e.x : e.y, Math.abs(e) > t.minDist && (this.setCurrent(this.current - cleverapps.sign(e)), s = !0))
                        }.bind(this)
                    }), this.setCurrent(0, !0)
                },
                setCurrent: function (e, t) {
                    var s, i;
                    e > this.amount - 1 || e < 0 || this.current !== e && (i = this.items[e], s = cc.p(this.width / 2, this.height / 2), this.direction === cleverapps.UI.HORIZONTAL ? s.x = this.width / 2 - i.x : s.y = this.height / 2 - i.y, t ? (this.content.setPositionRound(s), void 0 !== this.current && (this.items[this.current].setScale(1), this.items[this.current].baseScale = 1), this.items[e].setScale(1.2)) : (i = cc.pDistance(s, this.content.getPosition()), i = Math.min(i / cleverapps.styles.CarouselView.speed, .3), this.content.runAction(new cc.MoveTo(i, s)), this.items[this.current].runAction(new cc.ScaleTo(i, 1)), this.items[this.current].baseScale = 1, this.items[e].runAction(new cc.ScaleTo(i, 1.2))), this.items[e].baseScale = 1.2, this.current = e, this.onChange(e, t))
                }
            }), cleverapps.styles.CarouselView = {
                minDist: 100,
                speed: 1500
            },
            cleverapps.Shaders = {
                GRAYSCALE_SPRITE_KEY: "grayscaleSprite",
                FLICKER_SHADER_KEY: "flicker",
                BLUR_FADE_KEY: "blur_fade",
                BLUR_CURTAIN_KEY: "blur_curtain",
                BLUR_CURTAIN_REVERSE_KEY: "blur_curtain_reverse",
                VERTEX_SRC: "  attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",
                GRAYSCALE_SRC: "varying vec2 v_texCoord;\nvarying vec4 v_fragmentColor; \nvoid main(){vec4 col = texture2D(CC_Texture0, v_texCoord);\nfloat gray = dot(col.rgb, vec3(0.25, 0.25, 0.25));\ngl_FragColor = v_fragmentColor * vec4(gray, gray, gray, col.a);\n}\n",
                FLICKER_FRAGM: "precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform float sineTime; \nuniform vec3 flickColor; \nvoid main() \n{ \n    vec4 c = texture2D(CC_Texture0, v_texCoord); \n    vec3 deltacolor = c.rgb * flickColor * sineTime;\n    vec3 color = clamp(c.rgb + deltacolor, 0.0, 1.0);\n    gl_FragColor = v_fragmentColor * vec4(color, c.a); \n}",
                BLUR_TEMPLATE: "precision lowp float;\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\nuniform float u_blurOffset;\nuniform float u_extent;\nuniform float u_blurStrength;\n#define MAX_BLUR_WIDTH 4\nbool skipPixel(float y)\n{\n   %{skipFunction}}\nvoid main()\n{\n    vec2 u_blurOffset1 = vec2(0.0, float(u_blurOffset));\n    vec2 u_blurOffset2 = vec2(float(u_blurOffset), 0.0);\n    vec2 u_blurOffset3 = vec2(float(u_blurOffset) * sqrt(2.0), float(u_blurOffset) * sqrt(2.0));\n    vec2 u_blurOffset4 = vec2(float(u_blurOffset) * sqrt(2.0), -float(u_blurOffset) * sqrt(2.0));\n    vec4 color = texture2D(CC_Texture0, v_texCoord);\n    if (skipPixel(v_texCoord.y)) {\n       gl_FragColor = color;\n    } else {\n       float blurWidth = u_blurStrength * float(MAX_BLUR_WIDTH);\n       vec4 blurColor  = vec4(color.rgb, 1.0);\n       for (int i = 1; i < MAX_BLUR_WIDTH; ++ i)\n       {\n           if ( float(i) >= blurWidth ) break;           float weight = 1.0 - float(i) / blurWidth;\n           weight = weight * weight * (3.0 - 2.0 * weight); // smoothstep\n           vec4 sampleColor1 = texture2D(CC_Texture0, v_texCoord + u_blurOffset1 * float(i));\n           vec4 sampleColor2 = texture2D(CC_Texture0, v_texCoord - u_blurOffset1 * float(i));\n           vec4 sampleColor3 = texture2D(CC_Texture0, v_texCoord + u_blurOffset2 * float(i));\n           vec4 sampleColor4 = texture2D(CC_Texture0, v_texCoord - u_blurOffset2 * float(i));\n           vec4 sampleColor5 = texture2D(CC_Texture0, v_texCoord + u_blurOffset3 * float(i));\n           vec4 sampleColor6 = texture2D(CC_Texture0, v_texCoord - u_blurOffset3 * float(i));\n           vec4 sampleColor7 = texture2D(CC_Texture0, v_texCoord + u_blurOffset4 * float(i));\n           vec4 sampleColor8 = texture2D(CC_Texture0, v_texCoord - u_blurOffset4 * float(i));\n           blurColor += vec4(sampleColor1.rgb + sampleColor2.rgb + sampleColor3.rgb + sampleColor4.rgb + sampleColor5.rgb + sampleColor6.rgb + sampleColor7.rgb + sampleColor8.rgb, 8.0) * weight; \n       }\n       gl_FragColor = vec4(blurColor.rgb / blurColor.w, color.a);\n    }\n}",
                BLUR_FADE_FRAGM: "",
                BLUR_CURTAIN_FRAGM: "",
                BLUR_CURTAIN_REVERSE_FRAGM: "",
                BLUR_FADE_SKIP: "   return false;\n",
                BLUR_CURTAIN_SKIP: "   return y > u_extent;\n",
                BLUR_CURTAIN_REVERSE_SKIP: "   return y < (1. - u_extent);\n",
                initialize: function () {
                    var e;
                    "undefined" != typeof gl && (e = function (t, e, s) {
                        try {
                            var i = new cc.GLProgram;
                            i.initWithString(e, s), i.addAttribute(cc.ATTRIBUTE_NAME_POSITION, cc.VERTEX_ATTRIB_POSITION), i.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD, cc.VERTEX_ATTRIB_TEX_COORDS), i.addAttribute(cc.ATTRIBUTE_NAME_COLOR, cc.VERTEX_ATTRIB_COLOR), i.link(), i.updateUniforms(), cc.shaderCache.addProgram(i, t)
                        } catch (e) {
                            cleverapps.Shaders[t] = void 0, console.log(e)
                        }
                    }, cleverapps.Shaders.initializing = !0, e(cleverapps.Shaders.GRAYSCALE_SPRITE_KEY, cleverapps.Shaders.VERTEX_SRC, cleverapps.Shaders.GRAYSCALE_SRC), e(cleverapps.Shaders.FLICKER_SHADER_KEY, cleverapps.Shaders.VERTEX_SRC, cleverapps.Shaders.FLICKER_FRAGM), cleverapps.Shaders.BLUR_FADE_FRAGM = cleverapps.Shaders.BLUR_TEMPLATE.replace("%{skipFunction}",
                        cleverapps.Shaders.BLUR_FADE_SKIP), cleverapps.Shaders.BLUR_CURTAIN_FRAGM = cleverapps.Shaders.BLUR_TEMPLATE.replace("%{skipFunction}", cleverapps.Shaders.BLUR_CURTAIN_SKIP), cleverapps.Shaders.BLUR_CURTAIN_REVERSE_FRAGM = cleverapps.Shaders.BLUR_TEMPLATE.replace("%{skipFunction}", cleverapps.Shaders.BLUR_CURTAIN_REVERSE_SKIP), e(cleverapps.Shaders.BLUR_FADE_KEY, cleverapps.Shaders.VERTEX_SRC, cleverapps.Shaders.BLUR_FADE_FRAGM), e(cleverapps.Shaders.BLUR_CURTAIN_KEY, cleverapps.Shaders.VERTEX_SRC, cleverapps.Shaders.BLUR_CURTAIN_FRAGM), e(cleverapps.Shaders.BLUR_CURTAIN_REVERSE_KEY, cleverapps.Shaders.VERTEX_SRC, cleverapps.Shaders.BLUR_CURTAIN_REVERSE_FRAGM), cleverapps.Shaders.initializing = !1)
                }
            }, cleverapps.UI.Avatar = cc.Node.extend({
                ctor: function (e, t, s) {
                    var i, n = e,
                        o = (e && (e.avatar || e.id) && (n = e.avatar, t = e.id), this._super(), t === cleverapps.platform.getUserID()),
                        a = new cc.Sprite(o ? bundles.avatar.frames.user_avatar : bundles.avatar.frames.default_avatar),
                        e = (this.addChild(a), this.avatar = a, e && !(
                            e instanceof cc.SpriteFrame) && e.frame),
                        o = (e || (i = cleverapps.skins.getSlot("avatarFramesBundle") || "avatar", e = o ? bundles[i].frames.avatar_frame2 : bundles[i].frames.avatar_frame), this.frame = new cc.Sprite(e));
                    o.setLocalZOrder(1), this.addChild(o), this.styles = s || cleverapps.styles.UI.Avatar, this.setAnchorPoint(.5, .5), this.setContentSize2(o.getContentSize()), a.setPositionRound(this.width / 2, this.height / 2 + (this.styles.bottom - this.styles.top) / 2), o.setPositionRound(this.width / 2, this.height / 2), this.adjustSize(), (this.image = n) && "string" == typeof n && cleverapps.social.isLoggedIn() && t && 0 <= n.indexOf("fbsbx.com") && (cleverapps.social instanceof WebViewFacebook || cleverapps.social instanceof cleverapps.FacebookCanvasSocial) && (this.avatarFBUserId = t, this.onImageLoadErrorListener = this.createListener(this.onImageLoadError.bind(this))), this.onImageLoadListener = this.createListener(this.onImageLoad.bind(this))
                },
                onImageLoadError: function () {
                    cleverapps.social.aboutUser(this.avatarFBUserId, this.createListener(
                        this.onFBUserLoaded.bind(this)))
                },
                onFBUserLoaded: function (e) {
                    var t;
                    e && e.picture && e.picture.data && e.picture.data.url && (this.image = e.picture.data.url, this.onImageLoadErrorListener = void 0, this.setImage(this.image), t = {
                        avatar: this.image
                    }, cleverapps.RestClient.post("/info/" + this.avatarFBUserId, t, function () { }, function () {
                        console.log("Failed updating user avatar: " + t.avatar)
                    }))
                },
                onEnter: function () {
                    var t;
                    this._super(), this.image && (t = !0, ["stub_128x128.gif", "camera_200.png"].forEach(function (e) {
                        "string" == typeof this.image && -1 !== this.image.indexOf(e) && (t = !1)
                    }.bind(this)), t && this.setImage(this.image))
                },
                adjustSize: function () {
                    this.avatar.setScale((this.width - 2 * this.styles.x) / this.avatar.width, (this.height - this.styles.top - this.styles.bottom) / this.avatar.height)
                },
                onImageLoad: function (e, t) {
                    if (e) this.onImageLoadErrorListener && this.onImageLoadErrorListener(), console.log("Error loading avatar image!");
                    else try {
                        var s = new cc.Sprite(t);
                        s.setPositionRound(this.width / 2, this.height / 2),
                            this.avatar.removeFromParent(), this.addChild(s), this.avatar = s, this.adjustSize()
                    } catch (e) {
                        console.log("Cross-domain??", e)
                    }
                },
                loadGif: function (i) {
                    if ((i = !cc.sys.isNative ? i.replace("https:", "").replace("http:", "") : i) !== this.imageUrl) {
                        this.imageUrl = i;
                        try {
                            var n = new SuperGif;
                            n.load_url(i, this.createListener(function () {
                                var e, t, s;
                                i === this.imageUrl && (e = n.getFrames(), Array.isArray(e) && 0 < e.length && ((s = new cc.Sprite(e[0])).setPositionRound(this.width / 2, this.height / 2), this.avatar.removeFromParent(), this.addChild(s), this.avatar = s, this.adjustSize(), t = [], e.forEach(function (e) {
                                    t.push(new cc.Sprite(e).getSpriteFrame())
                                }), s = new cc.Animation(t, .075), this.avatar.runAction(new cc.RepeatForever(new cc.Animate(s)))))
                            }.bind(this)))
                        } catch (e) {
                            i === this.imageUrl && delete this.imageUrl, console.log("Cross-domain??", e), this.onImageLoadErrorListener && this.onImageLoadErrorListener()
                        }
                    }
                },
                getImageSpriteFrame: function (e) {
                    if (0 === e.indexOf("#") || 0 === e.indexOf("@")) return cc.spriteFrameCache.getSpriteFrame(e) || cc.spriteFrameCache.getSpriteFrame(e.replace(/\//g, "-")) || cc.spriteFrameCache.getSpriteFrame(e.replace(/\//g, "-").replace("#", "#main-"))
                },
                setImage: function (e) {
                    var t;
                    e instanceof cc.SpriteFrame ? (this.avatar.setSpriteFrame(e), this.adjustSize()) : 0 !== e.indexOf("#") && 0 !== e.indexOf("@") || !this.getImageSpriteFrame(e) ? -1 !== e.indexOf(".gif") ? this.loadGif(e) : (e = decodeURIComponent(e), (t = cleverapps.UI.Avatar.cache.get(e)) ? this.onImageLoadListener(0, t) : cc.loader.loadImg(e, function (e, t) {
                        this.onImageLoadListener(e, t)
                    }.bind(this))) : (this.avatar.setSpriteFrame(this.getImageSpriteFrame(e)), this.adjustSize())
                }
            }), cleverapps.UI.Avatar.cache = new cleverapps.Cache, cleverapps.UI.Avatar.preload = function (s, i) {
                var t, e;
                if (i = i || function () { }, Array.isArray(s)) return t = cleverapps.wait(s.length, i), void s.forEach(function (e) {
                    cleverapps.UI.Avatar.preload(e.avatar || e, t)
                });
                "string" == typeof s && 0 !== s.indexOf("#") && -1 === s.indexOf(".gif") ? (s = decodeURIComponent(s), (e = cleverapps.UI.Avatar.cache.get(s)) ? i(e) : cc.loader.loadImg(
                    s,
                    function (e, t) {
                        e || cleverapps.UI.Avatar.cache.set(s, t), i(!e && t)
                    })) : i()
            }, cleverapps.FixedWidthScene = cc.Scene.extend({
                listBundles: function () {
                    return []
                },
                cachedBundles: function () {
                    return []
                },
                listBaseBundles: function () {
                    cleverapps.eventManager.setCurrentFeatures(), cleverapps.skins.update(this);
                    var e = ["main"];
                    return cleverapps.config.debugMode && (e.push("dev_resources"), e.push("orangery")), e = cleverapps.skins.getBundles() ? e.concat(cleverapps.skins.getBundles()) : e
                },
                ctor: function (e) {
                    this._super(), this.level = e && e.level
                },
                closeAction: function () {
                    cleverapps.meta.isFocused() || cleverapps.git && !cleverapps.git.handleSceneClose() || this._closeAction()
                },
                _closeAction: function () {
                    cleverapps.meta.display({
                        focus: "closeScene",
                        action: function (e) {
                            cleverapps.travelBook.gotoMainScene(e)
                        }
                    })
                },
                prepareBundles: function () {
                    this.bundles = this.listBundles().concat(this.listBaseBundles()), this.bundles = cleverapps.unique(this.bundles.filter(function (e) {
                        return e && bundles[e]
                    }))
                },
                load: function (e) {
                    var e = cleverapps.wait(2, e),
                        t = (
                            this.level ? this.level.load(e) : e(), cleverapps.substract(this.bundles, this.prevSceneBundles));
                    cleverapps.bundleLoader.loadBundles(t, {
                        onSuccess: e,
                        onFailure: function () {
                            var e = {
                                focus: "loadSceneBundlesFailure",
                                action: function () {
                                    new RestartWindow
                                }
                            };
                            cleverapps.meta.isFocused() ? cleverapps.meta.distract(e) : cleverapps.meta.display(e)
                        }
                    })
                },
                setLoadingFinished: function () {
                    this.isAllLoaded = !0, cleverapps.bannerAd && cleverapps.bannerAd.check(!0)
                },
                unload: function (e) {
                    this.level && this.level.unload(), e.prevSceneBundles = this.bundles;
                    e = cleverapps.substract(this.bundles, e.bundles);
                    cleverapps.bundleLoader.deleteBundles(e), cleverapps.bundleLoader.clearUnusedResources(), cc.pool.drainAllPools()
                },
                canTransitionFast: function () {
                    return !!cc.game.isPaused() || !!this.bundles && (!!cleverapps.bundleLoader.isLoaded(this.bundles) || !(!cc.sys.isNative || !this.bundles.every(function (e) {
                        return !bundles[e].external
                    })))
                },
                onSceneLoaded: function (e) {
                    cleverapps.environment.setScene(e), this.avoidNodes = {}, this.dynamicNodes = {},
                        this.introScale = this.getBgIntroScale(), this.setContentSize(cleverapps.UI.getSceneSize()), this.setPositionRound(0, cleverapps.UI.getBgOffset()), this.movingNode = new cc.Node, this.movingNode.setLocalZOrder(BaseWindow.WINDOWS_ZORDER + 3), this.addChild(this.movingNode);
                    var e = new ShadowView,
                        e = (this.addChild(e, BaseWindow.WINDOWS_ZORDER - 3), e.loading.replaceParentSamePlace(this, {
                            keepScale: !0
                        }), e.updatePosition(), this.backgroundStyles = this.getBackgroundStyles(), this.setBackground(), this.addTreasureBag(), this.addMenuContainer(), this.addControlButtons(), this.addSideBar(), this.addToolbar(), this.addDebugToolsBar(), cleverapps.windows.reset(), this.getAudioStyles());
                    "playable" !== cleverapps.config.source && this.startOrRestartMusic(e), cleverapps.flyingAd && cleverapps.flyingAd.reset(), cleverapps.restoreProgress.isAvailable() && (e = new RestoreProgressButton, this.addChild(e)), cc.director.setClearColor(cleverapps.styles.FixedWidthScene.clearColor || cc.color.BLACK), this.debugId = "Scene", this.scheduleUpdateWithPriority(
                        1), cleverapps.scenes.onAvoidNodeVisibilityChanged = this.createListener(function () {
                            this.updateDynamicNodes()
                        })
                },
                startOrRestartMusic: function (e) {
                    this.runAction(new cc.Sequence(new cc.DelayTime(e.delay || 0), new cc.CallFunc(function () {
                        cleverapps.audio.insertDisk(e.res), cleverapps.audio.fadeIn(e.fadeIn || 0)
                    })))
                },
                getAudioStyles: function () {
                    return cleverapps.styles.FixedWidthScene.sound
                },
                getBgIntroScale: function () {
                    return 1
                },
                introControls: function () { },
                playIntro: function (e) {
                    e()
                },
                addMenuContainer: function () {
                    this.upMenuContainer && (this.upMenuContainer.removeFromParent(), delete this.upMenuContainer), this.upMenuContainer = new UpMenuContainer, this.addChild(this.upMenuContainer)
                },
                addControlButtons: function () {
                    this.controlButtons && (this.controlButtons.removeFromParent(), delete this.controlButtons);
                    var e = new SceneControlButtonsView;
                    SceneControlButtonsView.isOutsideMenu() ? (this.upMenuContainer.removeControlButtons(), this.addChild(e), e.updateSize()) : this.upMenuContainer.addControlButtons(e), e.updatePosition(),
                        this.controlButtons = new HidingNode(e, cleverapps.UI.VERTICAL), cleverapps.meta.registerControl("SceneControlButtonsView", e)
                },
                addSideBar: function () {
                    this.sideBar && (this.sideBar.removeFromParent(), delete this.sideBar);
                    var e = this.sideBar = new SideBarView;
                    this.addChild(e)
                },
                addToolbar: function () {
                    var e;
                    cleverapps.environment.isMainScene() && !cleverapps.gameModes.noControls && ((e = new ToolbarView).setLocalZOrder(1), this.addChild(e), this.downToolBarControl = new HidingNode(e, cleverapps.UI.VERTICAL), cleverapps.meta.registerControl("toolbar", e))
                },
                addTreasureBag: function () {
                    this.treasureBag && (this.treasureBag.removeFromParent(), this.treasureBag = void 0), this.treasureBag = new TreasureBagIcon, this.treasureBag.setLocalZOrder(TreasureBagIcon.ZORDER), this.addChild(this.treasureBag), this.treasureBag.updatePosition(), this.treasureBag.hide(!0), cleverapps.treasureBag.hide()
                },
                addDebugToolsBar: function () {
                    var e;
                    cleverapps.config.debugMode && !cleverapps.config.wysiwygMode && (cleverapps.environment.isGameScene() || cleverapps.environment.isMainScene()) && (e = cleverapps.styles.FixedWidthScene, this.snapshotBar = new SnapshotBarView, this.snapshotBar.setLocalZOrder(1e3), this.snapshotBar.setPositionRound(e.snapshotBar), this.addChild(this.snapshotBar), this.gitButtons = new GitButtonsView({
                        hiddenByDefault: !0
                    }), this.gitButtons.setLocalZOrder(1e3), this.gitButtons.setPositionRound(e.gitButtons), this.addChild(this.gitButtons))
                },
                getBackgroundStyles: function () {
                    return cleverapps.skins.getSlot("sceneBg") || cleverapps.styles.FixedWidthScene.background
                },
                setBackground: function () {
                    var e = this.backgroundStyles;
                    if (e && !cleverapps.gameModes.noBg) {
                        if (e.patternId) {
                            var t = cleverapps.UI.getSceneSize(),
                                t = (t.height += 2, this.background = new cc.Node, this.background.setAnchorPoint(.5, .5), this.background.setContentSize(t), cleverapps.UI.createPatternSprite(bundles[e.bundle].urls[e.patternId], t));
                            this.background.addChild(t)
                        } else if (e.horizontalPattern) {
                            var s = 0,
                                i = [];
                            do {
                                var n = new cc.Sprite(e.horizontalPattern)
                            } while (i.push(n), (s += n.width) < this.width || i.length < 2);
                            this.background = new cleverapps.Layout(i, {
                                direction: cleverapps.UI.HORIZONTAL,
                                margin: 0
                            })
                        } else if (e.scale9) this.background = cleverapps.UI.createScale9Sprite(e.scale9, cleverapps.UI.Scale9Rect.TwoPixelXY);
                        else if (e.movableAnimation) this.background = new cleverapps.Spine(e.movableAnimation), this.background.setAnimation(0, "animation", !0);
                        else {
                            if (!e.backgroundId) return;
                            this.background = new cc.Sprite(bundles[e.bundle].urls[e.backgroundId])
                        }
                        e.animation && ((t = this.background.animation = new cleverapps.Spine(e.animation)).setAnimation(0, "animation", !0), e.skin && t.setSkin(e.skin), this.background.addChild(t)), this.background.transitionBundles = cleverapps.toArray(e.bundle), this.updateBackgroundScale(), this.updateBackgroundPosition(), this.background.setScale(this.background.baseScale / this.introScale), this.background.setLocalZOrder(-10), this.addChild(this.background)
                    }
                },
                completeAnimationOnResize: function () {
                    this.background && this.updateBackgroundScale(), this.removeFilmEffect()
                },
                updateSize: function () {
                    this.setContentSize(cleverapps.UI.getSceneSize()), this.updateBackgroundScale()
                },
                updatePosition: function () {
                    var e = cleverapps.styles.FixedWidthScene;
                    this.setPositionRound(0, cleverapps.UI.getBgOffset()), this.updateBackgroundPosition(), this.snapshotBar && this.snapshotBar.setPositionRound(e.snapshotBar), this.gitButtons && this.gitButtons.setPositionRound(e.gitButtons)
                },
                updateBackgroundPosition: function () {
                    var e;
                    !this.background || this.backgroundStyles && this.backgroundStyles.movableAnimation || (e = cleverapps.UI.getBgSize(), this.backgroundStyles && this.backgroundStyles.position ? (this.background.setPositionRound(this.backgroundStyles.position), this.background.originalPosition = this.backgroundStyles.position) : this.background.setPositionRound(this.convertToNodeSpace(cc.p(e.width / 2, e.height / 2))))
                },
                updateBackgroundScale: function () {
                    var e, t;
                    !this.background || this.backgroundStyles && this.backgroundStyles.movableAnimation || (e = this.backgroundStyles,
                        this.background instanceof cc.Scale9Sprite ? ((t = cleverapps.UI.getSceneSize()).width = t.width * this.introScale / this.scale + 2, t.height = t.height * this.introScale / this.scale + 2, this.background.setContentSize2(t.width, t.height)) : "number" == typeof e.scale ? this.background.setScale(e.scale) : (t = e.size || this.background.getContentSize(), e = Math.max(this.width / t.width * this.introScale / this.scale, cleverapps.UI.getBgSize().height / t.height * this.introScale / this.scale), this.background.setScale(e), !cleverapps.platform.oneOf(Instant) || (t = t.height / this.introScale * e) > this.height && (this.background.y = this.height / 2 + (t - this.height) / 3), this.background.stopAllActions()), this.background.animation && this.background.animation.setPositionRound(this.background.width / 2, this.background.height / 2), this.background.baseScale = this.background.scale)
                },
                onTransitionAnimationDidStart: function () {
                    cleverapps.audio.fadeOut(.1)
                },
                createTransition: function () {
                    var e;
                    if (this.background && this.background.transitionBundles) return e = this.background,
                        this.background = void 0, e.replaceParentSamePlace(this, {
                            keepScale: !0
                        }), e.setLocalZOrder(1e3), e
                },
                getPreferredBundles: function () {
                    var e = this._super();
                    return cleverapps.substract(e, ["dev_resources"])
                },
                addDynamicNode: function (e) {
                    this.dynamicNodes[e.__instanceId] || (this.dynamicNodes[e.__instanceId] = e)
                },
                removeDynamicNode: function (e) {
                    this.dynamicNodes[e.__instanceId] && delete this.dynamicNodes[e.__instanceId]
                },
                addAvoidNode: function (e) {
                    this.avoidNodes[e.__instanceId] || (this.avoidNodes[e.__instanceId] = e, this.updateDynamicNodes())
                },
                removeAvoidNode: function (e) {
                    this.avoidNodes[e.__instanceId] && (delete this.avoidNodes[e.__instanceId], this.updateDynamicNodes())
                },
                updateDynamicNodes: function (e) {
                    this.dynamicNodesDirty = !0, this.dynamicNodesSilent = e
                },
                getAvoidNodes: function (t) {
                    return t = cleverapps.createSet(t), cleverapps.values(this.avoidNodes).filter(function (e) {
                        return t[e.avoidNode]
                    })
                },
                update: function () {
                    var t;
                    this.dynamicNodesDirty && (this.dynamicNodesDirty = !1, t = this.dynamicNodesSilent,
                        this.dynamicNodesSilent = !1, cleverapps.values(this.dynamicNodes).forEach(function (e) {
                            e.updateDynamicPosition(t)
                        }))
                },
                createFilmEffect: function (e) {
                    this.removeFilmEffect(), this.filmEffect = new SceneFilmEffect(e), this.addChild(this.filmEffect)
                },
                removeFilmEffect: function (e, t) {
                    this.filmEffect ? this.filmEffect.hideAnimation(e, function () {
                        delete this.filmEffect, t && t()
                    }.bind(this)) : t && t()
                }
            }), cleverapps.styles.FixedWidthScene = {
                sound: {
                    res: bundles.main.urls.background_music_map,
                    delay: .5
                },
                snapshotBar: {
                    x: {
                        align: "right"
                    },
                    y: {
                        align: "bottom"
                    }
                },
                gitButtons: {
                    x: {
                        align: "right",
                        dx: -4
                    },
                    y: {
                        align: "bottom",
                        dy: 90
                    }
                }
            },
            function () {
                cleverapps.EventEmitter.call(this), this.list = [], this.bundles = 0, this.onHideShadow = function (e) { }, this.onShowShadow = function (e) { }, this.onMoveShadowUp = function () { }, this.onMoveShadowDown = function () { }, this.onHideLoading = function () { }, this.onShowLoading = function () { }, this.onceNoWindowsListener = void 0
            }),
        ShadowView = (Windows.prototype = Object.create(cleverapps.EventEmitter.prototype), (
            Windows.prototype.constructor = Windows).prototype.isActive = function () {
                return 0 < this.list.length || 0 < this.bundles
            }, Windows.prototype.reset = function () {
                this.list = [], this.bundles = 0, this.onHideShadow()
            }, Windows.prototype.currentWindow = function () {
                return this.list[this.list.length - 1]
            }, Windows.prototype.findWindow = function (t) {
                return this.list.find(function (e) {
                    return e instanceof t
                })
            }, Windows.prototype.closeBottomWindows = function () {
                this.list.slice(0, this.list.length - 1).reverse().forEach(function (e) {
                    e.closed || e.close()
                })
            }, Windows.prototype.closeAllWindows = function () {
                this.list.reverse().forEach(function (e) {
                    e.closed || e.close()
                })
            }, Windows.prototype.add = function (e) {
                var t;
                cleverapps.meta.isFocused() || -1 !== ["promptwindow"].indexOf(e.name) || cleverapps.meta.debugMessage("Trying to show window without user focus!"), e instanceof WaitWindow ? e.displaySelf() : (0 < this.list.length && (t = this.list[this.list.length - 1], e instanceof ForceView || (t.setVisible(!1), this.onHideShadow(), t.initializedSuccess && t.onHide())),
                    this.onShowLoading(), this.list.push(e), e.displaySelf(), (1 === this.list.length && !(this.list[0] instanceof ForceView) || 2 === this.list.length && this.list[0] instanceof ForceView) && this.trigger("openWindow"))
            }, Windows.prototype.notifyMetha = function () {
                var e;
                this.isActive() || (cleverapps.meta.onceNoWindowsListener && (e = cleverapps.meta.onceNoWindowsListener, cleverapps.meta.onceNoWindowsListener = void 0, e()), cleverapps.meta.tutorialNoWindowsListener && cleverapps.meta.tutorialNoWindowsListener())
            }, Windows.prototype.runClose = function (t) {
                new ActionPlayer([function (e) {
                    t.beforeCloseAnimation(e)
                }, function (e) {
                    t.isCurrent() ? t.closeAnimation(e) : e()
                }, function (e) {
                    t.shareCheckBox ? t.shareCheckBox.onWindowClose(e) : e()
                }, function (e) {
                    this.delete(t), t.onClose(), cleverapps.environment && cleverapps.environment.onCloseWindow(t.name), t.closeAnimationCallbacks && (t.closeAnimationCallbacks.forEach(function (e) {
                        e()
                    }), t.closeAnimationCallbacks = []), e()
                }.bind(this), function (e) {
                    t.removeFromParent(),
                        cleverapps.bundleLoader.deleteBundles(t.bundles), setTimeout(e, 0)
                }, function (e) {
                    this.notifyMetha(), e()
                }.bind(this)]).play()
            }, Windows.prototype.remove = function (e) {
                e.closed || (e.closed = !0, e.stop(), e.isCurrent() && cleverapps.meta.setEventNodes([]), this.runClose(e))
            }, Windows.prototype.delete = function (e) {
                var t = e === this.currentWindow(),
                    s = this.list.indexOf(e); - 1 !== s && this.list.splice(s, 1), t && (e.initializedSuccess || this.onHideLoading(), 0 === this.list.length ? (e instanceof ForceView && this.onMoveShadowDown(), this.onHideShadow(), (s = cleverapps.scenes.getRunningScene()) && s.onShow && s.onShow(), setTimeout(function () {
                        0 === this.list.length && this.trigger("closeWindows")
                    }.bind(this), e.closeDuration())) : e instanceof ForceView ? (this.onMoveShadowDown(), setTimeout(function () {
                        var e = this.currentWindow();
                        e && cleverapps.meta.setEventNodes([e])
                    }.bind(this), 150)) : (t = this.currentWindow(), this.onShowLoading(), t.displaySelf(), 1 === this.list.length && this.list[0] instanceof ForceView && this.trigger("closeWindows")))
            },
            cc.Node.extend({
                ctor: function () {
                    if (this._super(), this.shadow = new ShadowLayer, this.shadow.setOpacity(0), this.addChild(this.shadow), this.shadow.visible = !1, this.show = !1, this.loading = WaitWindow.prototype.showLoading.call(this), this.addChild(this.loading), this.loading.setLocalZOrder(1e3), this.loading.visible = !1, !cleverapps.windows) throw new Error("No cleverapps.windows cleverapps.allInitialized - " + cleverapps.allInitialized);
                    cleverapps.windows.onHideShadow = this.createListener(this.deleteShadow.bind(this)), cleverapps.windows.onShowShadow = this.createListener(this.createShadow.bind(this)), cleverapps.windows.onMoveShadowUp = this.createListener(this.moveUp.bind(this)), cleverapps.windows.onMoveShadowDown = this.createListener(this.moveDown.bind(this)), cleverapps.windows.onHideLoading = this.createListener(this.hideLoading.bind(this)), cleverapps.windows.onShowLoading = this.createListener(this.showLoading.bind(this))
                }
            })),
        BaseWindow = (ShadowView.prototype.updatePosition = function () {
            var e = cleverapps.scenes.getRunningScene(),
                e = this.convertToNodeSpaceAR(cc.p(e.width / 2, e.height / 2));
            this.loading.setPositionRound(e)
        }, ShadowView.prototype.updateSize = function () {
            this.updatePosition()
        }, ShadowView.prototype.hideLoading = function () {
            this.deleteShadow(), this.moveDown(), this.loading.stopAllActions(), this.loading.setVisible(!1)
        }, ShadowView.prototype.showLoading = function () {
            this.loading.stopAllActions(), this.moveUp(), this.loading.runAction(new cc.Sequence(new cc.DelayTime(.1), new cc.Show, new cc.DelayTime(.9), new cc.CallFunc(this.createShadow.bind(this, !0))))
        }, ShadowView.prototype.createShadow = function (e) {
            var t;
            this.show || (this.show = !0, this.shadow.stopAllActions(), this.shadow.visible = !0, t = cleverapps.styles.ShadowView, e = e ? t.slowDuration : t.duration, this.shadow.updateSize(), this.shadow.runAction(new cc.FadeTo(e, t.opacity)))
        }, ShadowView.prototype.deleteShadow = function () {
            var e;
            this.show && (this.show = !1, this.shadow.stopAllActions(), e = cleverapps.styles.ShadowView, this.shadow.runAction(
                new cc.Sequence(new cc.FadeTo(e.duration, 0), new cc.CallFunc(function () {
                    this.shadow.visible = !1
                }.bind(this)))))
        }, ShadowView.prototype.moveUp = function () {
            this.setLocalZOrder(30)
        }, ShadowView.prototype.moveDown = function () {
            this.setLocalZOrder(BaseWindow.WINDOWS_ZORDER - 3)
        }, cleverapps.styles.ShadowView = {
            duration: .3,
            slowDuration: .6,
            opacity: 150
        }, cc.Node.extend({
            listBundles: function () {
                return []
            },
            ctor: function () {
                this._super();
                var e, t, s = arguments,
                    i = (cleverapps.scenes.getRunningScene().addChild(this), this.adjustBaseWindow(), this.setLocalZOrder(BaseWindow.WINDOWS_ZORDER), cleverapps.windows.add(this), this.openTime = Date.now(), this.bundles = this.listBundles.apply(this, arguments) || [], cleverapps.skins.getBundles() && (this.bundles = this.bundles.concat(cleverapps.skins.getBundles())), this.getPersonBundles());
                i && (this.bundles = this.bundles.concat(i)), this.bundles.push("windows"), this.bundles = cleverapps.unique(this.bundles), this.bundles = this.bundles.filter(function (e) {
                    return bundles[e]
                }), 0 !== this.bundles.length ? (
                    e = Date.now(), i = this.createListener(function () {
                        this.runWindow(s), cleverapps.ConsoleStream.sendLoadingTime("window " + this.name + " " + (Date.now() - e) + "ms")
                    }.bind(this)), t = this.createListener(function () {
                        this.deleteSelf(), new RestartWindow
                    }.bind(this)), cleverapps.meta.clearUpdateTimeout(), this.load(i, t)) : this.runWindow(s)
            },
            getPerson: function () { },
            getPersonBundles: function () {
                var e, t, s = [],
                    i = this.getPerson();
                return i && (i.left || i.right ? (e = i.left, t = i.right) : e = i, [e, t].filter(Boolean).forEach(function (e) {
                    e = PersonsLibrary.getPerson(e.role || e);
                    e && e.bundle && s.push(e.bundle)
                })), s
            },
            load: function (e, t) {
                cleverapps.bundleLoader.loadBundles(this.bundles, {
                    onSuccess: e,
                    onFailure: t
                })
            },
            onChangeSize: function () {
                this.initializedSuccess && !this.closed && this._super()
            },
            onChangePosition: function () {
                this.initializedSuccess && !this.closed && this._super()
            },
            updateSize: function () {
                this.adjustBaseWindow()
            },
            updatePosition: function () { },
            adjustBaseWindow: function () {
                var e = cleverapps.scenes.getRunningScene();
                this.setScale(1 / e.getScale()),
                    this.setContentSize(e.width, e.height), cleverapps.config.wysiwygMode ? this.setPositionRound(0, 0) : this.setPositionRound(e.convertToNodeSpace(cc.p(0, cleverapps.UI.getBgOffset())))
            },
            isCurrent: function () {
                return cleverapps.windows.currentWindow() === this
            },
            runWindow: function (e) {
                this.adjustBaseWindow(), this.onWindowLoaded.apply(this, e), this.initializedSuccess = !0, this.displaySelf()
            },
            hideSelf: function () {
                cleverapps.windows.currentWindow() === this && (this.setVisible(!1), this.styles.shadow && cleverapps.windows.onHideShadow(), this.onHide())
            },
            grabFocus: function () {
                cleverapps.meta.setEventNodes([this])
            },
            displaySelf: function () {
                this.initializedSuccess && cleverapps.windows.currentWindow() === this && (this.adjustWindow(), this.updatePosition(), cleverapps.windows.onHideLoading(), cleverapps.meta.updateControlsVisibility(), this.setVisible(!0), this.grabFocus(), this.styles.shadow ? cleverapps.windows.onShowShadow() : cleverapps.windows.onHideShadow(), this instanceof ForceView && cleverapps.windows.onMoveShadowUp(),
                    cleverapps.environment && cleverapps.environment.onOpenWindow(), this.popUpAnimation(), this.onShow())
            },
            deleteSelf: function () {
                cleverapps.windows.delete(this), this.removeFromParent()
            },
            stop: function () {
                cc.eventManager.removeListeners(this, !0)
            },
            beforeCloseAnimation: function (e) {
                e()
            },
            close: function () {
                !0 === this.closed && cleverapps.throwAsync("Closing already closed window: " + this.name), this.initializedSuccess && !this.closed && (this.closeButton instanceof BandButton && this.closeButton.hide(), this.shareCheckBox && !this.withBg && this.shareCheckBox.hide(), this.tapToContinue && this.tapToContinue.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide)), this.homeButton && this.homeButton.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide)), this.windowFooter && this.windowFooter.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide)), this.windowTitle && this.windowTitle.hide(), this.decors && this.decors.hideAll(), this.content && this.content.children.forEach(function (e) {
                    e.hide && e.hide()
                }),
                    cleverapps.windows.remove(this))
            },
            onClose: function () { }
        })),
        WINDOW_ANIMATIONS = (BaseWindow.WINDOWS_ZORDER = 22, {
            default: {
                open: function (e) {
                    var t = this.window.scale;
                    this.window.setScale(.8 * t), this.window.runAction(new cc.Sequence(new cc.ScaleTo(.3, t).easing(cc.easeBackOut()), new cc.CallFunc(e)))
                },
                close: function (e) {
                    e()
                }
            },
            fallIn: {
                open: function (e) {
                    var t = this.window.scale;
                    this.window.setScale(3.2 * t), this.performRecursive(function (e) {
                        e !== this && e.setCascadeOpacityEnabled(!0)
                    }), this.window.setOpacity(30), this.window.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.5, t).easing(cc.easeIn(1.5)), new cc.FadeIn(.5).easing(cc.easeIn(2))), new cc.CallFunc(e)))
                },
                close: function (e) {
                    e()
                }
            },
            fromLeft: {
                open: function (e) {
                    var t = this.window.basePosition;
                    this.window.setPositionX(-t.x), this.window.runAction(new cc.Sequence(new cc.MoveTo(.3, t.x, t.y).easing(cc.easeBackOut()), new cc.CallFunc(e)))
                },
                close: function (e) {
                    this.window.runAction(new cc.Sequence(new cc.MoveTo(.3, -this.window.x, this.window.y).easing(cc.easeBackIn()), new cc.CallFunc(e)))
                }
            },
            fromBelow: {
                open: function (e) {
                    var t = this.window.basePosition;
                    this.window.setPositionY(0), this.window.runAction(new cc.Sequence(new cc.MoveTo(.3, t.x, t.y).easing(cc.easeBackOut()), new cc.CallFunc(e)))
                },
                close: function (e) {
                    this.window.runAction(new cc.Sequence(new cc.MoveTo(.4, this.window.x, 0).easing(cc.easeBackIn()), new cc.CallFunc(e)))
                }
            },
            fromLeftToRight: {
                open: function (e) {
                    var t = this.window.basePosition;
                    this.window.setPositionX(-this.window.width / 2), this.window.runAction(new cc.Sequence(new cc.MoveTo(.3, t.x, t.y).easing(cc.easeBackOut()), new cc.CallFunc(e)))
                },
                close: function (e) {
                    this.window.runAction(new cc.Sequence(new cc.MoveTo(.3, this.width + this.window.width / 2, this.window.y).easing(cc.easeBackIn()), new cc.CallFunc(e)))
                }
            },
            bezierCircle: {
                open: function (e) {
                    var t = cc.p(this.window.basePosition.x, this.window.basePosition.y),
                        s = cc.p(t.x + .2 * this.width, this.height - this.window.height / 2),
                        i = cc.p(t.x + .35 * this.width, t.y - this.window.height / 6),
                        n = this.window.scale;
                    this.window.setScale(
                        .3 * n), this.window.setPosition(s);
                    this.window.runAction(new cc.Sequence(new cc.Spawn(new cc.BezierTo(.25, [s, i, t]), new cc.ScaleTo(.25, n).easing(cc.easeIn(3))), new cc.CallFunc(e)))
                },
                close: function (e) {
                    var t = cc.p(this.window.basePosition.x, this.window.basePosition.y),
                        s = cc.p(t.x - .2 * this.width, this.height - this.window.height / 2),
                        i = cc.p(t.x - .35 * this.width, t.y - this.window.height / 2);
                    this.window.setPosition(t);
                    this.window.runAction(new cc.Sequence(new cc.Spawn(new cc.BezierTo(.25, [t, i, s]), new cc.ScaleTo(.25, .3).easing(cc.easeOut(.33))), new cc.CallFunc(e)))
                }
            },
            instant: {
                open: function (e) {
                    e()
                },
                close: function (e) {
                    e()
                }
            },
            force: {
                open: function (e) {
                    e()
                },
                close: function (e) {
                    this.dialogue.close(e)
                }
            }
        }),
        Window = BaseWindow.extend({
            onWindowLoaded: function (e) {
                this.onWindowLoadedOptions = e = e || {}, this.showSound = e.showSound, this.contentPadding = e.contentPadding;
                var t = cleverapps.styles.Window,
                    t = (e.styles && (t = cleverapps.overrideStyles(t, e.styles, !0)), this.styles = t, this.name = e.name || e.title || "window", this.content = e.content,
                        this.content && (this.withBg = !e.noBackground && !t.noBackground, this.buttons = this.createWindowButtons(e), e.shareId && Share.isAvailable() && (this.shareCheckBox = new ShareCheckBox(e.shareId, this)), !1 !== e.closeButton && !1 !== t.closeButton && (this.closeButton = this.createCloseButton()), e.loginOrInvite && (this.loginOrInvite = cleverapps.FBLoginOrInvite()), this.withBg ? this.createWindowWithBg(e) : this.createWindowWithoutBg(), this.debugId = this.name, this.windowSize = this.window.getContentSize(), e.title && (this.windowTitle = new WindowTitle(this, e.title, t.HelpButton.lovesTitle && e.help), this.window.addChild(this.windowTitle)), e.help && !t.HelpButton.lovesTitle && (this.helpButton = this.createHelpButton(e.help), this.window.addChild(this.helpButton)), e.homeButton && (this.homeButton = this.createHomeButton(), this.addChild(this.homeButton)), this.closeButton instanceof BandButton ? this.addChild(this.closeButton) : this.closeButton instanceof CloseButton && this.window.addChild(this.closeButton), (t = cleverapps.skins.getSlot(
                            "windowDecors", {
                            decors: t.decors,
                            window: this,
                            level: e.level
                        })) && (this.decors = new Decors(this, t)), this.adjustWindow()), !1 === e.closeButton && !e.closeByBackButton || (this.closeByBackButton = this.createListener(function () {
                            cleverapps.meta.checkEventNode(this) && this.close()
                        }.bind(this))), e.fireworks && (this.fireworks = new Fireworks(this.window, e.fireworks), this.fireworks.setPositionRound(this.width / 2, this.height / 2), this.fireworks.setLocalZOrder(e.fireworks.zOrder || 0), this.addChild(this.fireworks)), this.getPerson && this.getPerson());
                t && (this.persons = new WindowPersons(t, this)), this.closeAnimationCallbacks = [], this.customize(), cleverapps.audio.playSound(e.openSound || bundles.main.urls.window_effect)
            },
            createWindowButtons: function (e) {
                var t = [];
                if (e.button && (e.button.onClicked = e.button.onPressed || this.close.bind(this), t.push(new BottomButton(e.button))), (t = e.buttons ? t.concat(e.buttons) : t).length) return new Buttons(t)
            },
            createWindowWithoutBg: function () {
                var e = [],
                    e = (this.buttons && e.push(this.buttons),
                        this.closeButton instanceof TapToContinue && e.push(this.closeButton), e.length && (this.tapToContinue = new cleverapps.Layout(e, {
                            direction: cleverapps.UI.VERTICAL,
                            margin: this.styles.Footer.margin
                        }), this.tapToContinue.setLocalZOrder(2), this.addChild(this.tapToContinue)), this.window = new cleverapps.Layout([this.content], {
                            direction: cleverapps.UI.VERTICAL
                        }), this.window.setLocalZOrder(1), this.wrapper = cleverapps.UI.wrapWithPadding(this.window), this.wrapper.setLocalZOrder(1), this.addChild(this.wrapper), []);
                this.shareCheckBox && (this.shareCheckBox.setOpacity(180), e.push(this.shareCheckBox)), this.loginOrInvite && e.push(this.loginOrInvite), e.length && (this.windowFooter = new cleverapps.Layout(e, {
                    direction: cleverapps.UI.VERTICAL,
                    margin: this.styles.Footer.margin
                }), this.windowFooter.setPositionRound(this.styles.Footer), this.windowFooter.setLocalZOrder(2), this.addChild(this.windowFooter))
            },
            createWindowWithBg: function (e) {
                var t = [this.content, this.shareCheckBox, this.buttons].filter(Boolean),
                    t = (
                        this.window = new cleverapps.Layout(t, {
                            margin: this.styles.margin,
                            direction: cleverapps.UI.VERTICAL,
                            padding: !e.noPadding && this.styles.padding
                        }), this.window.setLocalZOrder(1), (void 0 !== e.minWidth ? e : cleverapps.styles.Window).minWidth),
                    s = (void 0 !== e.minHeight ? e : cleverapps.styles.Window).minHeight,
                    t = t - this.window.width,
                    s = s - this.window.height;
                (0 < t || 0 < s) && cleverapps.UI.wrapWithPadding(this.window, {
                    x: 0 < t && t,
                    y: 0 < s && s
                }, !0), this.bg = this.createBackground(e), this.window.addChild(this.bg), this.bg.setLocalZOrder(-1e3), this.bg.setPositionRound(this.window.width / 2, this.window.height / 2), this.wrapper = cleverapps.UI.wrapWithPadding(this.window), this.wrapper.setLocalZOrder(1), this.addChild(this.wrapper), e.foreground && (this.foreground = this.createForeground(e.foreground), this.window.addChild(this.foreground)), this.loginOrInvite && (this.windowFooter = this.loginOrInvite, this.windowFooter.setPositionRound(this.styles.Footer), this.windowFooter.setLocalZOrder(2), this.addChild(this.windowFooter))
            },
            adjustWrapper: function () {
                var e = this.window.getGlobalBoundingBox(),
                    t = [this.windowTitle && !this.windowTitle.fixedScenePosition ? this.windowTitle : void 0, this.tabs && this.tabs.isVisible() ? this.tabs : void 0].filter(Boolean).reduce(function (e, t) {
                        return cc.rectUnion(e, t.getGlobalBoundingBox())
                    }, e);
                this.wrapper.setContentSize2(t.width, t.height), this.window.setPositionRound(this.window.width / 2 + e.x - t.x, this.window.height / 2 + e.y - t.y)
            },
            adjustTapToContinue: function (e) {
                var t, s;
                this.tapToContinue && (t = (t = this.windowFooter ? this.windowFooter.getBoundingBox() : void 0) ? t.y + t.height : 0, this.tapToContinue.setScale(1), this.tapToContinue.setPositionRound(this.wrapper.x, t + this.tapToContinue.height / 2), e && e.inflate && (e = this.wrapper.getBoundingBox().y, s = this.getContentPadding(), cleverapps.UI.inflateToBoundaries(this.tapToContinue, this.getOverlappingNodes().concat(this.wrapper), {
                    padding: cc.padding(0, s.right, 0, s.left),
                    viewRect: this.tapToContinue.getGlobalBoundingBox(),
                    maxScale: this.wrapper.getScale(),
                    lovesPosition: this.convertToWorldSpace(cc.p(this.wrapper.x, t + 3 * (e - t) / 5))
                })))
            },
            adjustWindow: function () {
                var e;
                this.windowSize && (e = this.onWindowLoadedOptions || {}, this.windowScale = 1, this.wrapper.setScale(1), this.wrapper.setPositionRound(this.width / 2, this.height / 2), this.windowTitle && this.windowTitle.adjustPosition(), this.adjustWrapper(), this.adjustTapToContinue(), this.closeButton && this.closeButton.updatePosition && this.closeButton.updatePosition(), e.noScaleAdjustment || cleverapps.UI.inflateToBoundaries(this.wrapper, this.getOverlappingNodes(), {
                    padding: this.getContentPadding(),
                    viewRect: this.wrapper.getGlobalBoundingBox(),
                    lovesPosition: this.convertToWorldSpace(cc.p(this.width / 2, this.height / 2))
                }), this.windowTitle && this.windowTitle.adjustPosition(), this.adjustTapToContinue({
                    inflate: !0
                }), this.windowScale = this.wrapper.getScale(), this.wrapper.basePosition = this.wrapper.getPosition())
            },
            getOverlappingNodes: function () {
                var e = cleverapps.scenes.getRunningScene(),
                    t = this.onWindowLoadedOptions || {},
                    t = this.closeButton instanceof BandButton && !t.canOverlapCloseButton;
                return [cleverapps.meta.isControlEnabled(["MenuBarGoldItem", "MenuBarGameLevelItem", "MenuBarLivesItem", "MenuBarCoinsItem", "MenuBarWandsItem", "MenuBarWorkersItem"]) ? e.upMenuContainer : void 0, this.windowTitle && this.windowTitle.fixedScenePosition && this.windowTitle.isVisible() ? this.windowTitle : void 0, this.goldInfo, this.bottomLine, this.windowFooter, t ? this.closeButton : void 0].filter(Boolean)
            },
            getContentPadding: function () {
                var e = cleverapps.UI.getSceneSize(),
                    t = this.contentPadding;
                return t === cleverapps.UI.DOCK_RIGHT ? t = {
                    left: e.width / 2
                } : t === cleverapps.UI.DOCK_LEFT && (t = {
                    right: e.width / 2
                }), cc.paddingAddPadding(cc.padding(t), this.getBackgroundPadding())
            },
            getBackgroundPadding: function () {
                var e = this.styles || cleverapps.styles.Window,
                    t = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && "merge" !== cleverapps.config.type,
                    s = cc.padding(e.Background.padding);
                return s = t && e.Background.vertical ? cc.padding(s, e.Background.vertical.padding) : s
            },
            updateSize: function () {
                this._super(), this.adjustWindow(this.onWindowLoadedOptions), this.decors && this.decors.updateAll(), this.fireworks && this.fireworks.setPositionRound(this.width / 2, this.height / 2)
            },
            updatePosition: function () {
                this._super(), this.windowFooter && this.windowFooter.setPositionRound(this.styles.Footer), this.persons && this.persons.update()
            },
            createCloseButton: function () {
                var e = BandButton,
                    t = {
                        onClicked: this.close.bind(this),
                        styles: this.styles.CloseButton
                    };
                return this.withBg && !this.onWindowLoadedOptions.bandButton && (e = CloseButton), !this.withBg && this.onWindowLoadedOptions.tapToContinue && (e = TapToContinue, t = {
                    text: this.onWindowLoadedOptions.tapToContinue
                }), new e(t)
            },
            createHelpButton: function (e) {
                var t = this.styles.HelpButton,
                    e = new cleverapps.UI.HelpButton(e, {
                        window: !0
                    });
                return e.setPositionRound(t), e.setLocalZOrder(t.zOrder), e
            },
            createHomeButton: function () {
                var e = new cleverapps.UI.Button({
                    type: {
                        button_png: bundles.controlbuttons.frames.back_button_png,
                        button_on_png: bundles.controlbuttons.frames.back_button_on_png
                    },
                    onClicked: function () {
                        this.boatswain && this.boatswain.setIntent(Boatswain.RETURN_INTENT), this.close()
                    }.bind(this),
                    content: new cc.Sprite(bundles.buttons_main.frames.home_icon)
                });
                return e.avoidNode = "HomeButton", e.updatePosition = function () {
                    e.setPositionRound(this.styles.HomeButton.position)
                }.bind(this), e.updatePosition(), e
            },
            customize: function () { },
            onShow: function (e) {
                this.shareCheckBox && this.shareCheckBox.updateState(), this.fireworks && this.fireworks.start(), this.persons && this.persons.showUp();
                e = e || 0;
                !0 === this.onWindowLoadedOptions.closeButtonDelay && (e = 1.5), this.closeButton instanceof TapToContinue ? (this.homeButton && (this.homeButton.stopAllActions(), this.homeButton.setCascadeOpacityEnabledRecursively(!0), this.homeButton.setVisible(!1), this.homeButton.runAction(new cc.Sequence(new cc.FadeTo(0, 0), new cc.DelayTime(e), new cc.Show, new cc.FadeIn(.4).easing(cc.easeOut(1.2))))), this.tapToContinue.children.forEach(function (e) {
                    e.stopAllActions(), e.setVisible(!0)
                }), this.tapToContinue.setCascadeOpacityEnabledRecursively(!0), this.tapToContinue.setVisible(!1), this.tapToContinue.runAction(new cc.Sequence(new cc.FadeTo(0, 0), new cc.DelayTime(e), new cc.Show, new cc.CallFunc(function () {
                    cleverapps.audio.playSound(bundles.windows.urls.tap_to_continue_show_effect)
                }), new cc.FadeIn(.4).easing(cc.easeOut(1.2)), new cc.CallFunc(function () {
                    this.enableTouchInShadow()
                }.bind(this))))) : this.closeButton && (this.closeButton.hide(!0), this.closeButton.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.CallFunc(function () {
                    this.closeButton.show(), this.enableTouchInShadow()
                }.bind(this))))), this.windowFooter && (this.windowFooter.setCascadeOpacityEnabledRecursively(!0), this.windowFooter.setVisible(!1), this.windowFooter.runAction(new cc.Sequence(new cc.FadeTo(0, 0), new cc.DelayTime(e + .5), new cc.Show, new cc.FadeIn(.4).easing(cc.easeOut(1.2))))), this.showSound && cleverapps.audio.playSound(this.showSound)
            },
            onHide: function () {
                this.fireworks && this.fireworks.stop(), this.touchListener && (cc.eventManager.removeListener(this.touchListener), this.touchListener = void 0)
            },
            createBackground: function (e) {
                var t = this.styles.Background,
                    s = t.image,
                    s = cleverapps.skins.getSlot("windowBg", {
                        image: s,
                        level: e.level
                    }),
                    e = cleverapps.UI.createScale9Sprite(s, t.scale9);
                return e.setContentSize2(this.window.getContentSize()), t.opacity && e.setOpacity(t.opacity), e.setLocalZOrder(-1e3), e.setPositionRound(this.window.width / 2, this.window.height / 2), e
            },
            createForeground: function (e) {
                this.foreground = cleverapps.UI.createScale9Sprite(e, cleverapps.UI.Scale9Rect.TwoPixelXY), cleverapps.config.debugMode && (this.foreground.isExcluded = !0), this.foreground.setAnchorPoint2(0, 0), this.foreground.setLocalZOrder(1);
                e = cc.rect(0, 0, this.window.width, this.window.height), e = cc.rectSubPadding(e, cc.padding(this.styles.Foreground && this.styles.Foreground.padding));
                return this.foreground.setPositionRound(e.x, e.y), this.foreground.setContentSize2(e.width, e.height), this.foreground
            },
            onTouchInShadow: function () {
                this.onWindowLoadedOptions.notCloseByTouchInShadow || (cleverapps.audio.playSound(bundles.main.urls.click_effect), this.close())
            },
            setTitle: function (e, t) {
                this.windowTitle && this.windowTitle.setTitle(e, t)
            },
            getMinimalDialogueRects: function () {
                var e = cleverapps.styles.Window,
                    t = [cc.rectSubPadding(this.window.getGlobalBoundingBox(), cc.padding(e.BoundingBoxPadding))];
                return this.windowTitle && t.push(cc.rectSubPadding(this.windowTitle.getGlobalBoundingBox(), cc.padding(e.BoundingBoxPadding.Title))), t
            },
            enableTouchInShadow: function () {
                cleverapps.UI.onClick(this, function (e) {
                    if (this.window && !(this.closeButton instanceof TapToContinue)) {
                        var t = this.window.getContentSize(),
                            t = cc.rect(0, 0, t.width, t.height);
                        if (cc.rectContainsPoint(t, this.window.convertToNodeSpace(e.getLocation())) || cc.rectContainsPoint(t, this.window.convertToNodeSpace(e.getStartLocation()))) return
                    }
                    this.onTouchInShadow()
                }.bind(this), {
                    ignoreScale: !0
                })
            }
        }),
        WindowTitle = (Window.prototype.onPopUpAnimationFinished = function () { }, Window.prototype.popUpAnimation = function () {
            var e = this.chooseAnimation();
            e ? (this.window && this.window.stopAllActions(), e.open.call(this, this.onPopUpAnimationFinished.bind(this))) : this.onPopUpAnimationFinished()
        }, Window.prototype.stop = function () {
            BaseWindow.prototype.stop.apply(this), this.window && this.window.stopAllActions()
        }, Window.prototype.closeAnimation = function (e) {
            cleverapps.audio.playSound(bundles.main.urls.close_window_effect || bundles.main.urls.window_effect);
            var t = this.chooseAnimation();
            !t || 1 < cleverapps.windows.list.length && !this.styles.windowShowUpAnimation.force ? e() : t.close.call(this, e)
        }, Window.prototype.chooseAnimation = function () {
            var e = this.styles || cleverapps.styles.Window;
            if (e.windowShowUpAnimation && (this.window || this instanceof ForceView)) return this.bg || e.windowShowUpAnimation.force ? WINDOW_ANIMATIONS[e.windowShowUpAnimation.name] : WINDOW_ANIMATIONS.default
        }, Window.prototype.closeDuration = function () {
            return (this.styles || cleverapps.styles.Window).closeAnimation.duration
        },
            cleverapps.overrideFonts(cleverapps.styles.FONTS, {
                CLOSE_TEXT: {
                    size: 46,
                    color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                    stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                    shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
                },
                WINDOW_TITLE_TEXT: {
                    size: 70,
                    color: cleverapps.styles.COLORS.COLOR_BROWN
                }
            }), cleverapps.styles.Window = {
                shadow: !0,
                margin: 30,
                padding: {
                    x: 85,
                    top: 160,
                    bottom: 50
                },
                HelpButton: {
                    zOrder: 1,
                    x: {
                        align: "left",
                        dx: 70
                    },
                    y: {
                        align: "top",
                        dy: -45
                    }
                },
                BottomButton: {
                    width: 200,
                    height: 90
                },
                HomeButton: {
                    position: {
                        x: {
                            align: "right",
                            dx: -40
                        },
                        y: {
                            align: "top",
                            dy: -15
                        }
                    }
                },
                minHeight: 200,
                minWidth: 240,
                windowShowUpAnimation: {
                    name: "default",
                    force: !1
                },
                Background: {
                    image: bundles.windows.frames.window_bg_png,
                    scale9: cleverapps.UI.Scale9Rect.TwoPixelXY,
                    padding: {
                        x: 15,
                        y: 70
                    }
                },
                closeAnimation: {
                    duration: 200
                },
                Footer: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom",
                        dy: 60
                    },
                    margin: 20
                },
                BoundingBoxPadding: {
                    x: 30,
                    y: 30,
                    Title: {
                        x: 30,
                        y: 30
                    }
                }
            }, cc.Node.extend({
                ctor: function (e, t, s) {
                    this._super(), this.setAnchorPoint2(), this.setLocalZOrder(2),
                        this.window = e, this.type = this.window.withBg ? cleverapps.styles.WindowTitle.Types.default : cleverapps.styles.WindowTitle.Types.alternative, this.fixedScenePosition = !this.window.withBg, this.help = s, this.type.background && (this.background = cleverapps.UI.createScale9Sprite(this.type.background.image), this.addChild(this.background), this.window.decors && this.window.decors.initTitleDecorators()), this.text = cleverapps.UI.generateOnlyText("", cleverapps.styles.FONTS.WINDOW_TITLE_TEXT), this.maxTextHeight = 1.5 * this.text.getFontSize(), this.addChild(this.text, 1);
                    e = t, t.text && (e = t.text), s = {};
                    t.toReplace && (s = t.toReplace), this.window.withBg && this.help && (this.helpButton = new cleverapps.UI.HelpButton(this.help, {
                        window: !0
                    }), this.addChild(this.helpButton)), this.setTitle(e, s), this.setCascadeOpacityEnabledRecursively(!0)
                },
                adjustPosition: function () {
                    var e = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && this.type.mobilePosition || this.type.position;
                    this.setPositionRound(e.x, e.y, {
                        world: this.fixedScenePosition
                    })
                },
                setTitle: function (e, t) {
                    this.text.setString(e, t);
                    var e = cleverapps.UI.getSceneSize().width;
                    this.window.withBg ? (e = this.window.window.width - 2 * this.type.windowOffsetX, this.help && (e -= 2 * this.type.helpButton.padding.x)) : e -= 2 * this.type.scenePaddingX, this.text.fitTo(e, this.maxTextHeight), this.background ? (t = 2 * this.type.padding.x, this.helpButton && (t += 2 * this.type.helpButton.padding.x), e = Math.max(this.text.width + t, this.type.background.minWidth), this.background.setContentSize2(e, this.type.background.height), this.setContentSize2(this.background.getContentSize()), this.background.setPositionRound(this.width / 2, this.height / 2), this.window.decors && this.window.decors.updateAll()) : this.setContentSize2(this.text.getContentSize()), this.text.setPositionRound(this.type.textPosition), this.helpButton && (this.text.x += this.type.helpButton.padding.x, this.helpButton.setPositionRound(this.type.helpButton))
                },
                hide: function () {
                    this.window.withBg || this.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide))
                }
            })),
        WindowPersons = (cleverapps.styles.WindowTitle = {}, cleverapps.styles.WindowTitle.Types = {
            default: {
                background: {
                    image: bundles.windows.frames.window_title_bg_png,
                    height: 147,
                    minWidth: 350
                },
                windowOffsetX: 190,
                padding: {
                    x: 60
                },
                textPosition: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 12
                    }
                },
                position: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "top",
                        anchor: "center",
                        dy: -2
                    }
                },
                helpButton: {
                    x: {
                        align: "left",
                        dx: 20
                    },
                    y: {
                        align: "center",
                        dy: 3
                    },
                    padding: {
                        x: 30
                    }
                }
            },
            alternative: {
                background: {
                    image: bundles.windows.frames.window_title_bg_secondary_png,
                    height: 122,
                    minWidth: 600
                },
                padding: {
                    x: 195
                },
                textPosition: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 8
                    }
                },
                position: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "top",
                        dy: -165
                    }
                },
                scenePaddingX: 150
            }
        }, function (e, t) {
            var s, i;
            this.window = t, this.visible = !0, e.left || e.right ? (s = e.left, i = e.right) : s = e, s && (this.leftPerson = this.createPerson(s)), i && ((i = "string" == typeof i ? {
                role: i
            } : i).orientation = "right", this.rightPerson = this.createPerson(i))
        }),
        BottomButton = (WindowPersons.prototype.update = function () {
            var e = this.positionPersons();
            this.toggleVisible(e)
        }, WindowPersons.prototype.positionPersons = function () {
            for (var i = cleverapps.styles.WindowPersons, e = [this.window.wrapper, this.window.tapToContinue].filter(Boolean), n = e[0], t = 1; t < e.length; ++t) {
                var s = e[t];
                s.width * s.scale > n.width * n.scale && (n = s)
            }
            var o = !0;
            return [this.leftPerson, this.rightPerson].filter(Boolean).forEach(function (e) {
                var t, s = e.getOrientation();
                e.setPositionRound(i.position[s]), !n || Math.abs(e.x - n.x) < (t = (e.width + n.width * n.scale) / 2 + i.offset) && (e.x = n.x + t * ("left" === s ? -1 : 1)), e.originalPosition = e.getPosition(), o = o && e.x >= .2 * e.width && e.x <= cleverapps.UI.getSceneSize().width - .2 * e.width
            }, this), o
        }, WindowPersons.prototype.createPerson = function (e) {
            e = new Person(e);
            return e.setVisible(this.visible), e.setAnchorPoint2(.5, 0), e.setLocalZOrder(3), this.window.addChild(e), e
        }, WindowPersons.prototype.getHidePosition = function (e) {
            e = "left" === e.getOrientation() ? cc.p(-e.width, e.y) : cc.p(cleverapps.scenes.getRunningScene().width + e.width, e.y);
            return e
        },
            WindowPersons.prototype.showPerson = function (e) {
                e.stopAllActions(), e.setPositionRound(this.getHidePosition(e)), e.runAction(new cc.Sequence(new cc.MoveTo(.6, e.originalPosition).easing(cc.easeBackOut())))
            }, WindowPersons.prototype.hidePerson = function (e) {
                e.stopAllActions(), e.runAction(new cc.Sequence(new cc.MoveTo(.6, this.getHidePosition(e)).easing(cc.easeBackIn()), new cc.RemoveSelf))
            }, WindowPersons.prototype.showUp = function () {
                [this.leftPerson, this.rightPerson].forEach(function (e) {
                    e && this.showPerson(e)
                }, this)
            }, WindowPersons.prototype.hide = function () {
                [this.leftPerson, this.rightPerson].forEach(function (e) {
                    e && this.hidePerson(e)
                }, this)
            }, WindowPersons.prototype.toggleVisible = function (t) {
                this.visible !== t && (this.visible = t, [this.leftPerson, this.rightPerson].forEach(function (e) {
                    e && (e.setVisible(t), e.isShown = t, cleverapps.scenes.onAvoidNodeVisibilityChanged())
                }))
            }, WindowPersons.prototype.setLeftPerson = function (e) {
                e = Person.ParseOptions(e), this.leftPerson && this.leftPerson.getRole() === e.role || (
                    this.leftPerson && this.hidePerson(this.leftPerson), this.leftPerson = this.createPerson(e), this.positionPersons(), this.showPerson(this.leftPerson))
            }, WindowPersons.prototype.setRightPerson = function (e) {
                (e = Person.ParseOptions(e)).orientation = "right", this.rightPerson && this.rightPerson.getRole() === e.role || (this.rightPerson && this.hidePerson(this.rightPerson), this.rightPerson = this.createPerson(e), this.showPerson(this.rightPerson))
            }, cleverapps.styles.WindowPersons = {
                offset: 50,
                position: {
                    left: {
                        x: {
                            align: "left",
                            dx: 50
                        },
                        y: {
                            align: "bottom"
                        },
                        world: !0
                    },
                    right: {
                        x: {
                            align: "right",
                            dx: -50
                        },
                        y: {
                            align: "bottom"
                        },
                        world: !0
                    },
                    dy: {}
                }
            }, cleverapps.UI.Button.extend({
                ctor: function (e) {
                    var t = cleverapps.styles.Window.BottomButton;
                    e.width = e.width || t.width, e.height = e.height || t.height, this._super(e)
                }
            })),
        checkBrokenLink = (cleverapps.NodeDebugCommands = {
            parentCell: {
                description: "Parent cell",
                key: cc.KEY.c,
                filter: function () {
                    return "undefined" != typeof EditorMap2dDecoratorView && this instanceof EditorMap2dDecoratorView
                },
                action: function (e) {
                    var t, s = Game.currentGame.map.getView(),
                        i = s.getCell(this.decorator.x, this.decorator.y);
                    switch (e) {
                        case cc.KEY.down:
                            i = s.getCell(this.decorator.x, this.decorator.y + 1);
                            break;
                        case cc.KEY.left:
                            i = s.getCell(this.decorator.x - 1, this.decorator.y);
                            break;
                        case cc.KEY.up:
                            i = s.getCell(this.decorator.x, this.decorator.y - 1);
                            break;
                        case cc.KEY.right:
                            i = s.getCell(this.decorator.x + 1, this.decorator.y);
                            break;
                        default:
                            return
                    }
                    s.addTile(this.decorator.getLayerId(), i.cell.x, i.cell.y, this), e = Math.round((this.x - i.x) / resolutionScale), t = Math.round((this.y - i.y) / resolutionScale), this.decorator.updateCell(i.cell.x, i.cell.y, e, t), this.unselect(), this.select()
                }
            },
            anchor: {
                description: "Anchor",
                noDisplayUpdate: !0,
                filter: function () {
                    return cleverapps.flags.keyboardAnchorsMode || this.debugEditUnitAnchorsMode
                },
                action: function (e) {
                    switch (e) {
                        case cc.KEY.left:
                            (this.sprite || this).anchorX += .01, this.debugBorderDx += .01;
                            break;
                        case cc.KEY.right:
                            (this.sprite || this).anchorX -= .01, this.debugBorderDx -= .01;
                            break;
                        case cc.KEY.down:
                            this.anchorY += .01,
                                this.debugBorderDy += .01;
                            break;
                        case cc.KEY.up:
                            this.anchorY -= .01, this.debugBorderDy -= .01
                    }
                    console.log("anchors: " + Math.floor(100 * (this.sprite || this).anchorX) / 100 + " x " + Math.floor(100 * this.anchorY) / 100 + "\toffsets: " + Math.floor(100 * this.debugBorderDx) / 100 + " x " + Math.floor(100 * this.debugBorderDy) / 100), "undefined" != typeof UnitView && this instanceof UnitView && cleverapps.git.edit("anchors", {
                        code: this.unit.code,
                        stage: this.unit.stage,
                        anchorX: Math.floor(100 * (this.sprite || this).anchorX) / 100,
                        anchorY: Math.floor(100 * this.anchorY) / 100
                    })
                }
            },
            rotate: {
                description: "Rotate",
                key: cc.KEY.r,
                action: function (e) {
                    switch (e) {
                        case cc.KEY.down:
                        case cc.KEY.left:
                            --this.rotation;
                            break;
                        case cc.KEY.up:
                        case cc.KEY.right:
                            ++this.rotation
                    }
                    this.onChangeRotation && this.onChangeRotation(this.rotation)
                }
            },
            scale: {
                description: "Scale",
                key: cc.KEY.s,
                action: function (e) {
                    function t(e) {
                        return +e.toFixed(2)
                    }
                    var s = 0,
                        i = 0;
                    switch (e) {
                        case cc.KEY.up:
                        case cc.KEY.right:
                            s = 0 < this.scaleX ? .05 : -.05, i = 0 < this.scaleY ? .05 : -.05;
                            break;
                        case cc.KEY.down:
                        case cc.KEY.left:
                            s = 0 < this.scaleX ? -.05 : .05, i = 0 < this.scaleY ? -.05 : .05
                    }
                    this.scaleX = t(this.scaleX + s), this.scaleY = t(this.scaleY + i), this.onChangeScale && this.onChangeScale(s, i)
                }
            },
            mirror: {
                description: "Mirror",
                key: cc.KEY.m,
                action: function (e) {
                    function t(e) {
                        return +e.toFixed(2)
                    }
                    var s = 0,
                        i = 0;
                    switch (e) {
                        case cc.KEY.up:
                        case cc.KEY.down:
                            s = 0, i = 2 * -this.scaleY;
                            break;
                        case cc.KEY.left:
                        case cc.KEY.right:
                            s = 2 * -this.scaleX, i = 0
                    }
                    this.scaleX = t(this.scaleX + s), this.scaleY = t(this.scaleY + i), this.onChangeScale && this.onChangeScale(s, i)
                }
            },
            width: {
                description: "Width",
                key: cc.KEY.w,
                filter: function () {
                    return "undefined" == typeof EditorMap2dDecoratorView || !(this instanceof EditorMap2dDecoratorView)
                },
                action: function (e) {
                    switch (e) {
                        case cc.KEY.up:
                            this.width++;
                            break;
                        case cc.KEY.down:
                            this.width--
                    }
                }
            },
            height: {
                description: "Height",
                key: cc.KEY.h,
                filter: function () {
                    return "undefined" == typeof EditorMap2dDecoratorView || !(this instanceof EditorMap2dDecoratorView)
                },
                action: function (e) {
                    switch (e) {
                        case cc.KEY.up:
                            this.height++;
                            break;
                        case cc.KEY.down:
                            this.height--
                    }
                }
            },
            fontSize: {
                description: "Font size",
                key: cc.KEY.f,
                filter: function () {
                    return this instanceof cc.LabelTTF
                },
                action: function (e) {
                    switch (e) {
                        case cc.KEY.up:
                            this.setFontSize(this.getFontSize() + 1);
                            break;
                        case cc.KEY.down:
                            this.setFontSize(this.getFontSize() - 1)
                    }
                }
            },
            textDimensions: {
                description: "Text dimensions",
                key: cc.KEY.d,
                filter: function () {
                    return this instanceof cc.LabelTTF
                },
                action: function (e) {
                    var t = this.getDimensions();
                    switch (e) {
                        case cc.KEY.up:
                            this.setDimensions(t.width, t.height + 1);
                            break;
                        case cc.KEY.down:
                            this.setDimensions(t.width, t.height - 1);
                            break;
                        case cc.KEY.left:
                            this.setDimensions(t.width - 1, t.height);
                            break;
                        case cc.KEY.right:
                            this.setDimensions(t.width + 1, t.height)
                    }
                }
            },
            move: {
                description: "Move",
                key: void 0,
                action: function (e) {
                    var t, s = cleverapps.keyboardController.isPressed(cc.KEY.shift) ? 10 : 1;
                    switch (e) {
                        case cc.KEY.left:
                            this.x -= s, this.debugBorderDx -= s;
                            break;
                        case cc.KEY.right:
                            this.x += s, this.debugBorderDx += s;
                            break;
                        case cc.KEY.down:
                            this.y -= s, this.debugBorderDy -= s;
                            break;
                        case cc.KEY.up:
                            this.y += s, this.debugBorderDy += s
                    }
                    "undefined" != typeof EditorMap2dDecoratorView && this instanceof EditorMap2dDecoratorView && (e = Game.currentGame.map.getView().getCell(this.decorator.x, this.decorator.y), t = Math.round((this.x - e.x) / resolutionScale), e = Math.round((this.y - e.y) / resolutionScale), this.decorator.updatePosition(t, e, this.decorator.rotation))
                }
            }
        }, cc.checkGLErrorDebug = function (e, t) {
            var s;
            cc._renderType !== cc.game.RENDER_TYPE_WEBGL || (s = !((s = cc._renderContext.getError()) || "afterCreateProgramObj" !== t || e._programObj instanceof WebGLProgram) ? "notWebGLProgram" : s) && (t = ["error: " + s], e && (t.push("glProgram._programObj isUndefined: " + (void 0 === e._programObj)), t.push("glProgram._programObj is WebGLProgram: " + (e._programObj instanceof WebGLProgram))), cc.sys.isNative && cc.sys.os === cc.sys.OS_ANDROID && t.push("info: " + JSON.stringify(cleverapps.info && cleverapps.info.data)), s = "WebGL error: " + t.join(" - "), cleverapps.Shaders.initializing ? console.log(s) : cleverapps.throwAsync(s))
        }, function (e, t) {
            e || 0 === t.length || null === e || (console.log(t), cleverapps.throwAsync("broken frame: " + e))
        }),
        previewRes = (cc.Base.prototype.debugGetName = function () {
            var s = this.constructor,
                i = "[unknown]";
            return [window, cc, ccui, cleverapps, cleverapps.UI, sp, levels].forEach(function (e) {
                for (var t in e)
                    if (e[t] === s) {
                        i = t;
                        break
                    }
            }), i
        }, cc.Base.prototype.debugParents = function () {
            for (var e = [], t = this; t;) e.push(t.debugGetName()), t = t.parent;
            console.log("cleverapps.sceneDebugger.selectedNode -> " + e.join("->"))
        }, cc.Base.prototype.debugBorder = function (e) {
            var n, t, p, s, i, o, a, r, c, l;
            cleverapps.config.debugMode && (cleverapps.sceneDebugger.selectedNode = this, e = e || {}, "object" != typeof selectedNode || "function" != typeof selectedNode.unselect || selectedNode === this || selectedNode.stopListeners || selectedNode.unselect(), selectedNode = this, cleverapps.nodeAttributesPannel && (cleverapps.nodeAttributesPannel.remove(), cleverapps.nodeAttributesPannel = void 0), this.debugBorderDx = this.debugBorderDx || 0, this.debugBorderDy = this.debugBorderDy || 0,
                "undefined" != typeof EditorMap2dDecoratorView && this instanceof EditorMap2dDecoratorView && (this.debugBorderDx = this.decorator.dx || 0, this.debugBorderDy = this.decorator.dy || 0), n = function (e) {
                    return +e.toFixed(2)
                }, t = function (e) {
                    var t = this.getBoundingBox(),
                        s = ("undefined" != typeof UnitView && this instanceof UnitView && (i = " " + this.unit.getType() + " " + Unit.GetKey(this.unit), i += (s = this.unit.components.map(function (e) {
                            return e.constructor.name
                        }).join(" ")) ? "\n" + s : ""), [this.debugGetName() + (this instanceof cc.LabelTTF ? " " + this.getFontSize() : "") + (i || ""), n(t.width) + "x" + n(t.height) + " (" + this.width + "x" + this.height + ")", "scale: " + Math.ceil(100 * this.scaleX) / 100 + " x " + Math.ceil(100 * this.scaleY) / 100, "pos: " + Math.floor(100 * this.x) / 100 + " x " + Math.floor(100 * this.y) / 100, "offset: " + Math.floor(100 * this.debugBorderDx) / 100 + " x " + Math.floor(100 * this.debugBorderDy) / 100, "rotation " + this.rotation]),
                        i = this.decorator;
                    return i && void 0 !== i.x && void 0 !== i.y && s.push("cell: " + i.x + " x " + i.y), console.log(s.join(e)), s.join(e)
                }.bind(this), p = function () {
                    console.log(t("\t")), this.labelSavedPtr && e.showPosition && this.labelSavedPtr.setString(t("\n"))
                }.bind(this), this.debugBorderKeyboardListener = cc.EventListener.create({
                    event: cc.EventListener.KEYBOARD,
                    onKeyPressed: function (e) {
                        for (var t in cleverapps.NodeDebugCommands) {
                            t = cleverapps.NodeDebugCommands[t];
                            if (!t.filter || t.filter.call(this)) {
                                if (t.key === e && t.toggle) {
                                    t.toggle.call(this);
                                    break
                                }
                                if (-1 !== [cc.KEY.up, cc.KEY.down, cc.KEY.right, cc.KEY.left].indexOf(e) && (void 0 === t.key || cleverapps.keyboardController.isPressed(t.key))) {
                                    t.action.call(this, e), t.noDisplayUpdate || p(), this.spriteSavedPtr && this.spriteSavedPtr.setContentSize(this.getContentSize());
                                    break
                                }
                            }
                        }
                    }.bind(this)
                }), cc.eventManager.addListener(this.debugBorderKeyboardListener, this), this.spriteSavedPtr || ((s = cleverapps.UI.createScale9Sprite(bundles.dev_resources.frames.border, cleverapps.UI.Scale9Rect.TwoPixelY)).setAnchorPoint2(0, 0), s.setContentSize(this.getContentSize()), this.spriteSavedPtr = s, r = [new cc.Color(255, 0, 0, 255),
                new cc.Color(255, 0, 255, 0), new cc.Color(255, 255, 0, 0)
                ], s.setColor(e.color || cleverapps.Random.choose(r, this.debugGetName().length)), r = cc.view.getDevicePixelRatio(), i = "cocos2d" === engine && 1 < r ? r : 1, this instanceof cc.LabelTTF && (s.setScale(i), this.debugRegionForFitTo && (s.setColor(new cc.Color(255, 255, 255, 255)), r = this.debugRegionForFitTo.width || this.getContentSize().width, c = this.debugRegionForFitTo.height || this.getContentSize().height, o = 0, this.debugRegionForFitTo.width && (o = (this.debugRegionForFitTo.width - this.getContentSize().width) / 2), a = 0, this.debugRegionForFitTo.height && (a = this.debugRegionForFitTo.height - this.getContentSize().height, this.verticalAlign === cc.VERTICAL_TEXT_ALIGNMENT_CENTER && (a /= 2)), s.setContentSize(r, c), s.x -= o * i, s.y -= a * i)), (r = this.debugButtons = this.createEditButtons(e)) && (r.setAnchorPoint(0, 1), r.setPositionRound(s.width, s.height), s.addChild(r)), this.addChild(s), s.setLocalZOrder(10)), this.labelSavedPtr || (c = e.labelText || (e.showZOrder ? this.getLocalZOrder() : e.showPosition ? t("\n") : this.getContentSize().width + " x " + this.getContentSize().height + " " + this.debugGetName()), (l = this.labelSavedPtr = cleverapps.UI.generateOnlyText("", cleverapps.styles.FONTS.SYSTEM)).setAnchorPoint2(0, 0), l.setLocalZOrder(10), this.addChild(l), l._super_setString = l.setString, l.setString = function () {
                    l._super_setString.apply(l, arguments), l.setPosition(this.scaleX < 0 ? this.width : 0, this.scaleY < 0 ? 0 : this.height * i), l.setScaleX(1 / (this.scaleX / i)), l.setScaleY(1 / (this.scaleY / i))
                }.bind(this), l.setString(c, {
                    ignoreWarning: !0
                })), e.showAttributes && cleverapps.flags.nodeDebugPanelMode && this.showNodeDebugPanel())
        }, cc.Base.prototype.showNodeDebugPanel = function () {
            this.setCascadeOpacityEnabledRecursively(!0), this.setRecCascadeColorEnabled(!0), this.debugButtons && this.debugButtons.setCascadeColorEnabled(!1);

            function e(e, t, s, i, n, o) {
                var a = document.createElement("input");
                a.type = "range", a.min = String(t), a.max = String(s), a.step = String(i), a.value = String(n || s), a.style.width = "200px", a.style.height = "40px",
                    a.oninput = a.onchange = function () {
                        o(parseFloat(a.value))
                    }, a.onmousedown = function (e) {
                        e.stopPropagation()
                    }, a.onwheel = function (e) {
                        e.preventDefault(), a.value = String(parseFloat(a.value) + (0 <= e.deltaY ? -1 : 1) * i), o(parseFloat(a.value))
                    }, (t = document.createElement("div")).innerText = e, r.appendChild(t), r.appendChild(a)
            }
            var r = cleverapps.nodeAttributesPannel = document.createElement("div");
            Object.assign(r.style, {
                position: "absolute",
                padding: "3px",
                backgroundColor: "rgb(0, 0, 34)",
                bottom: "0px",
                right: "0px",
                display: "grid",
                "grid-template-columns": "auto auto",
                "justify-items": "center",
                "align-items": "center"
            }), r.ondragstart = function () {
                return !1
            }, r.onmousedown = function (e) {
                var t = function (e) {
                    e = e.getBoundingClientRect();
                    return {
                        top: e.top,
                        left: e.left
                    }
                }(r),
                    s = e.pageX - t.left,
                    i = e.pageY - t.top;

                function n(e) {
                    r.style.bottom = "", r.style.right = "", r.style.left = e.pageX - s + "px", r.style.top = e.pageY - i + "px"
                }
                n(e), document.onmousemove = function (e) {
                    n(e)
                }, document.onmouseup = function () {
                    document.onmousemove = null, document.onmouseup = null
                }
            };
            e("red",
                0, 255, 1, this.color.r,
                function (e) {
                    var t = this.color;
                    t.r = e, cleverapps.sceneDebugger.selectedNode.setColor(t)
                }.bind(this)), e("green", 0, 255, 1, this.color.g, function (e) {
                    var t = this.color;
                    t.g = e, cleverapps.sceneDebugger.selectedNode.setColor(t)
                }.bind(this)), e("blue", 0, 255, 1, this.color.b, function (e) {
                    var t = this.color;
                    t.b = e, cleverapps.sceneDebugger.selectedNode.setColor(t)
                }.bind(this)), e("opacity", 0, 255, 1, this.opacity, function (e) {
                    this.opacity = e
                }.bind(this)), cc.container.appendChild(r)
        }, cc.Base.prototype.showUnpackedRes = function () {
            var n, o, a;
            if ("undefined" != typeof unpackedMap) return n = 0, o = void 0, a = function (e) {
                var t, s, i;
                n++ < 10 && e.getChildren().forEach(function (e) {
                    a(e)
                }), e.constructor !== cc.Sprite && e.constructor !== cc.Scale9Sprite || (s = processVirtualImage(e.spriteFrameName)) && ("#" !== s[0] && (s = "#" + s), (t = unpackedMap[s]) && ((s = ["cleverapps", "match3"].find(function (e) {
                    return t.startsWith(e)
                })) ? i = t.substring(s.length) : (i = "/" + t, s = cleverapps.config.name), i.includes("dev_resources") || (
                    s = "https://github.com/rvvslv/" + s + "/tree/master" + i, o = o || s, console.log(e.spriteFrameName + "\n" + s)))), e.constructor !== sp.SkeletonAnimation || (i = cleverapps.Spine.getGitPath(e.jsonName)) && (o = o || i.link, console.log(i.name + "\n" + i.link))
            }, a(this), o
        }, cc.Base.prototype.createEditButtons = function (e) {
            if (delete this.debugEditUnitAnchorsMode, !e.noResLinks) {
                function t(e) {
                    return new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.small_button_green,
                        content: e.content,
                        onClicked: e.onClicked,
                        hint: e.hint,
                        width: a.width,
                        height: a.height
                    })
                }
                var s, i, n, o, a = cleverapps.styles.NodeDebug.button,
                    r = this instanceof cc.LabelTTF ? this.showLinkToLocalization() : this.showUnpackedRes(),
                    e = (r && (s = t({
                        content: new cc.Sprite(bundles.dev_buttons.frames.icon_edit),
                        hint: "Open link to git",
                        onClicked: function () {
                            setTimeout(window.open.bind(window, r, "_blank"), 0)
                        }
                    })), !cleverapps.git.checkAvailableErrors() && "undefined" != typeof UnitView && this instanceof UnitView && (i = t({
                        content: cleverapps.UI.generateOnlyText("A",
                            cleverapps.UI.Button.WorkFont()),
                        hint: "Toggle edit anchors mode",
                        onClicked: function () {
                            cleverapps.flags.keyboardAnchorsMode ? cleverapps.notification.create("Disable anchors mode in debug tool (or press 'a').") : (this.debugEditUnitAnchorsMode = !this.debugEditUnitAnchorsMode, n(), cleverapps.notification.create("Edit anchors mode " + (this.debugEditUnitAnchorsMode ? "activated" : "switched off")))
                        }.bind(this)
                    }), n = function () {
                        i.setType(cleverapps.flags.keyboardAnchorsMode || this.debugEditUnitAnchorsMode ? cleverapps.styles.UI.Button.Images.small_button_blue : cleverapps.styles.UI.Button.Images.small_button_green)
                    }.bind(this), cleverapps.flags.on("change:keyboardAnchorsMode", n, i), n()), this.unit && Families[this.unit.code].units[0].mission && (o = t({
                        content: new cc.Sprite(bundles.dev_buttons.frames.icon_stages),
                        hint: "Open unit demo",
                        onClicked: function () {
                            var e = cleverapps.RestClient.standsWeb("/?unitsDemo=" + cleverapps.travelBook.currentPage.id + "&code=" + this.unit.code);
                            setTimeout(window.open.bind(window, e, "_blank"), 0)
                        }.bind(this)
                    })), [s, i, o].filter(Boolean));
                if (e.length) return new cleverapps.Layout(e, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: a.margin
                })
            }
        }, cc.Base.prototype.showGitLink = function () {
            if (this instanceof cc.LabelTTF) return this.showLinkToLocalization()
        }, cc.Base.prototype.showLinkToLocalization = function () {
            var e, t, s;
            if (void 0 !== Messages && Messages.debugMapping) return e = function (e) {
                cleverapps.copyToClipboard(e);
                var t, s = Messages.debugMapping[e],
                    s = unpackedMap[s];
                if (s) return t = s.substring(0, s.indexOf("/")), s = s.substring(s.indexOf("/")), "https://github.com/rvvslv/" + t + "/edit/master" + (s += "?key=" + e)
            }(this.debugTextCode), t = this.debugTextCode || this.getString(), s = Messages.get(t, {
                ignoreWarning: !0
            }) || t, console.log(t + "\n" + s + "\n" + (e || "no link found")), e
        }, cc.Base.prototype.cleanupBorder = function () {
            this.spriteSavedPtr && (this.spriteSavedPtr.removeFromParent(), delete this.spriteSavedPtr), this.labelSavedPtr && (this.labelSavedPtr.removeFromParent(), delete this.labelSavedPtr), cc.eventManager.removeListener(
                this.debugBorderKeyboardListener), "object" == typeof selectedNode && selectedNode === this && (selectedNode = void 0), cleverapps.sceneDebugger.selectedNode === this && (cleverapps.sceneDebugger.selectedNode = void 0), cleverapps.nodeAttributesPannel && (cleverapps.nodeAttributesPannel.remove(), cleverapps.nodeAttributesPannel = void 0)
        }, cc.Base.prototype.drawRects = function (e) {
            this.drawRectsNode && (this.drawRectsNode.removeFromParent(), this.drawRectsNode = void 0), this.drawRectsNode = new cc.DrawNode, this.drawRectsNode.setAnchorPoint(0, 0), this.drawRectsNode.setContentSize2(this.width, this.height), this.drawRectsNode.setLocalZOrder(1e4), this.addChild(this.drawRectsNode), this.drawRectsNode.getBoundingBoxToWorld = function () {
                return cc.rect()
            }, e.forEach(function (e) {
                var t = this.getWorldToNodeTransform(),
                    t = cc.rectApplyAffineTransform(e, t),
                    s = (this.drawRectsNode.drawRect(cc.p(t.x, t.y), cc.p(t.x + t.width, t.y + t.height), null, 4, cc.color(255, 0, 0, 255)), [{
                        x: t.x,
                        y: t.y + t.height,
                        anchorX: 0,
                        anchorY: 0
                    }, {
                        x: t.x + t.width,
                        y: t.y + t.height,
                        anchorX: 1,
                        anchorY: 0
                    }, {
                        x: t.x,
                        y: t.y,
                        anchorX: 0,
                        anchorY: 1
                    }, {
                        x: t.x + t.width,
                        y: t.y,
                        anchorX: 1,
                        anchorY: 1
                    }]),
                    i = cleverapps.UI.generateOnlyText(e.name || "Noname", cleverapps.styles.FONTS.SYSTEM);
                this.drawRectsNode.addChild(i);
                for (var n = 0; n < s.length; ++n) {
                    var o = s[n];
                    if (i.setAnchorPoint2(o.anchorX, o.anchorY), i.setPosition(o.x, o.y), cleverapps.UI.isNodeOnScene(i)) break
                }
            }.bind(this))
        }, function (s) {
            function i(e) {
                var t = cleverapps.scenes.getRunningScene();
                t.addChild(e), e.setPositionRound(t.width / 2, t.height / 2)
            }
            var e, t = (s = processVirtualImage(s) || processVirtualJson(s)).split(".").slice(-1)[0];
            "json" === t ? (e = function () {
                var e = new cleverapps.Spine(s),
                    t = Object.keys(e.data.animations);
                e.setAnimation(0, t[0], !0), e.setSkin(cleverapps.Spine.getSkins(s)[0] || "default"), e.debugBorder(), i(e), console.log(t)
            }, cleverapps.Spine.isAnimationLoaded(s) ? e() : cleverapps.bundleLoader.loadBundle(cleverapps.Spine.listBundles(s), {
                onSuccess: e
            })) : "png" !== t && "jpg" !== t || i(cleverapps.UI.createScale9Sprite(s))
        }),
        checkFonts = function (e) {
            var t = [];
            e = e || {};
            for (var s = 15; s < 90; s += 5) {
                var i = {
                    name: e.name || "default",
                    size: s,
                    fnt: !0,
                    stroke: e.stroke,
                    shadow: e.shadow
                },
                    n = cleverapps.UI.generateOnlyText("1235", i),
                    i = cleverapps.UI.generateImageText("1235", i),
                    n = new cleverapps.Layout([n, i], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: 5
                    });
                t.push(n)
            }
            var o = new cleverapps.Layout(t, {
                direction: cleverapps.UI.VERTICAL,
                margin: 5
            });
            cleverapps.scenes.getRunningScene().addChild(o), o.setPositionRound(cleverapps.UI.getSceneSize().width / 2, cleverapps.UI.getSceneSize().height / 2)
        },
        TextWithIcon = (cleverapps.styles.NodeDebug = {
            button: {
                x: {
                    align: "right",
                    dx: 50
                },
                y: {
                    align: "top"
                },
                width: 50,
                height: 50,
                margin: 5
            }
        }, cleverapps.Particles = cc.ParticleSystem.extend({
            ctor: function (e, t) {
                e = cc.loader.getRes(processVirtualJson(e));
                e.textureFileName = t, this._super(e)
            },
            stop: function (e) {
                e = e || function () { }, delete this.target, this.setAutoRemoveOnFinish(!0), this.stopSystem(), this.runAction(new cc.Sequence(new cc.DelayTime(3), new cc.CallFunc(e), new cc.RemoveSelf))
            },
            followTarget: function (e) {
                this.setPositionType(cc.ParticleSystem.TYPE_RELATIVE), this.target = e, this.updateRelativePosition(), addCleaner(e, this.createListener(function () {
                    this.target === e && this.stop()
                }.bind(this)))
            },
            updateRelativePosition: function () {
                var e;
                this.target && this.getParent() && this.target.getParent() && (e = this.getRelativeCoordinates(this.target), this.setPositionRound(e))
            },
            update: function (e) {
                this.updateRelativePosition(), this._super(e)
            }
        }), cleverapps.Spine = cc.Node.extend({
            ctor: function (t, e, s) {
                this._super(), this.setAnchorPoint2(), t = cleverapps.Spine.processJson(t), cleverapps.config.wysiwygMode && "object" == typeof t && t.atlas && (s = t.atlas, t = t.json), this.jsonName = t;
                var i = cleverapps.Spine.jsonToBundle[t],
                    n = cleverapps.bundleLoader.isLoaded(i);
                if (!n && "loading_scene" !== i && t && i) throw "Json " + t + " bundle " + i + " not loaded stack" + (cleverapps.bundleLoader.deleteStack && cleverapps.bundleLoader.deleteStack[i]);
                if (void 0 === i && !s) throw console.log("json bundles cache", cleverapps.Spine.jsonToBundle),
                    "Can't find bundle for json - " + t + " in bundles cache ";
                var o = t,
                    s = s || bundles[i].jsons.atlas;
                if (!cc.loader.getRes(s)) throw "Atlas " + o + " bundle " + i + " not loaded " + n;
                i = cleverapps.Spine.getCachedData(t, e = e || 1);
                i && (o = i.data, s = i.atlas);
                try {
                    var a = this.spine = sp.SkeletonAnimation.createWithJsonFile(o, s, e, t)
                } catch (e) {
                    throw console.error(e), cleverapps.config.debugMode ? (n = cleverapps.Spine.getGitPath(t) || {}, e.message = n.name + "\n" + n.link + "\n" + e) : e.message = t + "\n" + e, new Error(e.message)
                }
                a.jsonName = t;
                i = {
                    data: a._skeletonData,
                    atlas: s
                }, "cocos2d" === engine && (i.atlas = !0), cleverapps.Spine.setCachedData(i, t, e, a.getSkin && a.getSkin()), this.data = cc.loader.getRes(t), o = this.data.skeleton;
                this.setContentSize2(o.width * resolutionScale, o.height * resolutionScale), a.setPositionRound(this.width / 2, this.height / 2), this.addChild(a), this.setCascadeOpacityEnabledRecursively(!0), this.setRecCascadeColorEnabled(!0), this.runningAnimation = void 0, this.initialize(), cleverapps.Spine.debugSlots && this.setDebugSlots(!0),
                    cleverapps.Spine.debugBones && this.setDebugBones(!0)
            },
            initialize: function () {
                this.setVisible(!1), this.startVisibleListener = void 0
            },
            setStartVisibleListener: function (e) {
                this.startVisibleListener = e
            },
            setIdle: function (e) {
                e !== this.idle && (this.idle = e, this.setAnimation(0, this.idle, !0))
            },
            setIdleSet: function (s) {
                var i = 0,
                    e = (cleverapps.values(s).forEach(function (e) {
                        i += e
                    }), function () {
                        this.setAnimation(0, function () {
                            var e, t = Math.random() * i;
                            for (e in s)
                                if ((t -= s[e]) <= 0) return e
                        }(), !1), this.setCompleteListener(e), this.setSafeToRemove()
                    }.bind(this));
                e()
            },
            hasAnimation: function (e) {
                return this.data.animations[e]
            },
            getAnimationData: function (e) {
                return this.spine.findAnimation(e)
            },
            getAnimationDuration: function (e) {
                e = this.getAnimationData(e);
                if (e) return e.duration
            },
            hasSkin: function (e) {
                return void 0 !== this.data.skins[e]
            },
            listAnimations: function () {
                return Object.keys(this.data.animations)
            },
            setAnimation: function (e, t, s) {
                this.getCurrentAnimationName() && this.setCompleteListener(), this.spine.setAnimation(e, t, s), this.idle && (
                    this.idle = void 0);
                e = this.spine.jsonName;
                this.data.animations[t] || cleverapps.throwAsync("Not found animation " + t + " in json " + e), this.visible || (this.visible = !0, this.startVisibleListener && this.startVisibleListener())
            },
            addAnimation: function (e, t, s, i) {
                this.spine.addAnimation(e, t, s, i);
                e = this.spine.jsonName;
                this.data.animations[t] || cleverapps.throwAsync("Not found animation " + t + " in json " + e)
            },
            getCurrentState: function (e) {
                return this.spine.getCurrent(e || 0)
            },
            getTimeLeft: function (e) {
                var e = this.getCurrentState(e),
                    t = e && e.animation && e.animation.duration || 0,
                    e = e && e.trackTime || 0;
                return Math.max(0, (t - e) / this.getTimeScale())
            },
            getCurrentAnimationName: function (e) {
                e = this.spine.getCurrent(e);
                return e && e.animation && e.animation.name
            },
            setTimeScale: function (e) {
                this.spine.setTimeScale(e)
            },
            getTimeScale: function () {
                return this.spine.getTimeScale()
            },
            clearTrack: function (e) {
                this.spine.clearTrack(e)
            },
            setSkin: function (e) {
                this.spine.setSkin(e)
            },
            setStartListener: function (e) {
                this.spine.setStartListener(e)
            },
            setCompleteListener: function (e) {
                this.spine.setCompleteListener(e || function () { }), this._cantBeRemoved = Boolean(e), this.saveStack && this._cantBeRemoved && (this.actionStack = (new Error).stack)
            },
            setCompleteListenerRemove: function (e) {
                this.setCompleteListener(function () {
                    e && e(), this.runAction(new cc.RemoveSelf)
                }.bind(this)), this.setSafeToRemove()
            },
            setCompleteListenerOnce: function (e) {
                this.setCompleteListener(function () {
                    e(), this.setCompleteListener()
                }.bind(this))
            },
            setAnimationAndContinue: function (e) {
                var t = this.getCurrentAnimationName(0);
                this.setAnimation(0, e, !1), this.addAnimation(0, t, !0)
            },
            setAnimationAndIdleAfter: function (e, t) {
                this.setAnimation(0, e, !1), this.addAnimation(0, t, !0)
            },
            setDebugSlots: function (e) {
                this.spine.setDebugSolots(e)
            },
            setDebugBones: function (e) {
                this.spine.setDebugBones(e)
            },
            setSafeToRemove: function () {
                this._cantBeRemoved = !1, delete this.cantRemoveStack
            },
            isSaveToRemove: function () {
                return !this._cantBeRemoved
            },
            getCurSkin: function () {
                return this.spine._skeleton.skin ? this.spine._skeleton.skin.name : "default"
            },
            getBoundingBoxToWorld: function () {
                var e = cc.rect(0, 0, this._contentSize.width, this._contentSize.height),
                    t = this.getNodeToWorldTransform();
                return cc.rectApplyAffineTransform(e, t)
            },
            _getBoundingBoxToCurrentNode: function (e) {
                var t = cc.rect(0, 0, this._contentSize.width, this._contentSize.height),
                    e = void 0 === e ? this.getNodeToParentTransform() : cc.affineTransformConcat(this.getNodeToParentTransform(), e);
                return cc.rectApplyAffineTransform(t, e)
            },
            unuse: function () {
                this.removeTemporarily(!1), this.setStartListener(void 0), this.setCompleteListener(void 0), this.clearTrack(0)
            },
            reuse: function () {
                this.initialize()
            }
        }), cleverapps.Spine.getCachedData = function (e, t, s) {
            e = cleverapps.Spine.cache[e] && cleverapps.Spine.cache[e][t];
            return "creator" === engine && (s = s || "default", e = e && e[s]), e
        }, cleverapps.Spine.setCachedData = function (e, t, s, i) {
            cleverapps.Spine.cache[t] || (cleverapps.Spine.cache[t] = {}), "creator" === engine ? (cleverapps.Spine.cache[t][s] || (
                cleverapps.Spine.cache[t][s] = {}), cleverapps.Spine.cache[t][s][i] || (cleverapps.Spine.cache[t][s][i] = e)) : cleverapps.Spine.cache[t][s] || (cleverapps.Spine.cache[t][s] = e)
        }, cleverapps.Spine.processJson = function (e) {
            return e = cleverapps.skins.getSlot("spine", {
                json: e
            }), processVirtualJson(e)
        }, cleverapps.Spine.hasAnimation = function (e, t) {
            t = cleverapps.Spine.getSkeletonData(t);
            return t && t.animations && void 0 !== t.animations[e]
        }, cleverapps.Spine.hasSkin = function (e, t) {
            t = cleverapps.Spine.getSkeletonData(t);
            return t && t.skins && void 0 !== t.skins[e]
        }, cleverapps.Spine.getSkins = function (e) {
            e = cleverapps.Spine.getSkeletonData(e);
            return Object.keys(e.skins).filter(function (e) {
                return "default" !== e
            })
        }, cleverapps.Spine.getSkeletonData = function (e) {
            return cc.loader.getRes(processVirtualJson(e))
        }, cleverapps.Spine.isAnimationLoaded = function (e) {
            return e = processVirtualJson(e), e = cleverapps.skins.getSlot("spine", {
                json: e
            }), cleverapps.bundleLoader.isLoaded(cleverapps.Spine.jsonToBundle[e])
        }, cleverapps.Spine.prepare = function () {
            var e, t = {};
            for (e in bundles) {
                var s = bundles[e];
                if (!s.injectTo && (0 !== e.indexOf("episode_") || 1 !== Object.keys(s.jsons).length || !s.jsons.levels))
                    for (var i in s.jsons) {
                        var n = s.jsons[i],
                            o = e;
                        if (0 === i.indexOf("island_") && 0 === e.indexOf("episode_") && (o = "episodes_resources"), t[n] && t[n] !== o) throw "Already exist json: " + n + " oldBundle - " + t[n] + " bundle - " + e;
                        t[n] = o
                    }
            }
            cleverapps.Spine.jsonToBundle = t
        }, cleverapps.Spine.listBundles = function (t) {
            Array.isArray(t) || (t = [t]);
            var s = [];
            return t.forEach(function (e) {
                t && cleverapps.Spine.jsonToBundle[e] && s.push(cleverapps.Spine.jsonToBundle[e])
            }), cleverapps.unique(s)
        }, cleverapps.Spine.removeSlot = function (e, t) {
            e = processVirtualJson(e), e = cleverapps.skins.getSlot("spine", {
                json: e
            }), (e = cc.loader.getRes(e)).slots = e.slots.filter(function (e) {
                return e.name !== t
            }), cleverapps.values(e.skins).forEach(function (e) {
                delete e[t]
            }), cleverapps.values(e.animations).forEach(function (e) {
                delete e.slots[t]
            })
        }, cleverapps.Spine.getGitPath = function (e) {
            var t = processVirtualJson(e);
            if (t) {
                var s, i,
                    t = unpackedMap[t];
                if (t) return s = t.indexOf("/"), "res" === (i = t.substring(0, s)) && (i = cleverapps.config.name, s = -1), i = "https://github.com/rvvslv/" + i + "/tree/master/" + t.substring(s + 1, t.lastIndexOf("/")), {
                    name: e.substring(0, e.lastIndexOf("-")) + ".json",
                    link: i
                }
            }
        }, cleverapps.Spine.cache = {}, cleverapps.Spine.GetPoolId = function (e) {
            return "spine_" + (e = e instanceof cleverapps.Spine ? e.jsonName : e)
        }, cleverapps.Spine.GetFromPool = function (e) {
            return e = cleverapps.Spine.processJson(e), cc.pool.getFromPool(cleverapps.Spine, e) || new cleverapps.Spine(e)
        }, cleverapps.Layout.extend({
            ctor: function (e, t) {
                this._super([], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: cleverapps.styles.TextWithIcon.margin,
                    align: t && t.align
                }), this.textOptions = t || {}, this.customIcons = this.textOptions.icons || {}, this.font = this.textOptions.font || cleverapps.styles.FONTS.BUTTON_TEXT, this.fontSize = this.font.size, this.setString(e)
            },
            calcCurrentSize: function () {
                var i = cleverapps.styles.TextWithIcon;
                return this.items.reduce(function (e, t, s) {
                    return e.width += t.width * t.scale, 0 < s && (e.width += i.margin), e.height = Math.max(e.height, t.height * t.scale), e
                }, cc.size(0, 0))
            },
            setFontSize: function (e) {
                this.fontSize = e, this._updateFontSize()
            },
            _updateFontSize: function () {
                this.items.forEach(function (e) {
                    e.isIcon ? e.setScale(this.getIconScale(e)) : e.isSpace ? e.width = this.getSpaceWidth() : e.setFontSize(this.fontSize), e.setPosition(0, 0)
                }, this), this.reshape()
            },
            getFontSize: function () {
                return this.fontSize
            },
            fitTo: function (e, t) {
                for (var s = 0; s < 10; s++) {
                    var i = this.calcCurrentSize();
                    if (!(e && i.width > e || t && i.height > t)) break;
                    var n = 1,
                        o = 1,
                        i = (e && i.width > e && (n = e / i.width), t && i.height > t && (o = t / i.height), .9),
                        n = Math.min(n, o),
                        o = (.9 < n && n < 1 && (i = n), Math.floor(this.getFontSize() * i)),
                        n = !1;
                    if (o < cleverapps.UI.ImageFont.getFontSizeThreshold() && (n = !0, o = cleverapps.UI.ImageFont.getFontSizeThreshold()), this.setFontSize(o), n) break
                }
            },
            createItems: function (e) {
                return e.map(function (e) {
                    return TextWithIcon.ICONS[e] || this.customIcons[e] ? this.createIcon(e) : " " === e ? this.createSpace() : this.createText(e)
                }, this)
            },
            getIconScale: function (e) {
                var t = this.fontSize * (this.textOptions.iconMinHeight || 1),
                    s = this.fontSize * (this.textOptions.iconMaxHeight || 1);
                return e.height < t ? t / e.height : e.height > s ? s / e.height : 1
            },
            getSpaceWidth: function () {
                return .2 * this.fontSize
            },
            createIcon: function (e) {
                e = this.chooseImage(e), e = "string" == typeof e ? new cc.Sprite(e) : e;
                return e.setScale(this.getIconScale(e)), e.isIcon = !0, e
            },
            createSpace: function () {
                var e = new cc.Node;
                return e.setAnchorPoint2(), e.setContentSize(this.getSpaceWidth(), 1), e.isSpace = !0, e
            },
            createText: function (e) {
                e = this.textOptions.notLocalized ? cleverapps.UI.__generateNotLocalizedText(e, this.font) : cleverapps.UI.ImageFont.IsApplicable(this.font, e) ? cleverapps.UI.generateImageText(e, this.font) : cleverapps.UI.generateOnlyText(e, this.font);
                return e.setFontSize(this.fontSize), e
            },
            parseText: function (e) {
                e = (e = e.trim()).replace(/ +/, " ");
                for (var t = [], p = Object.keys(TextWithIcon.ICONS).concat(Object.keys(this.customIcons)), s = 0; ;) {
                    for (var i = e.length, n = void 0,
                        o = 0; o < p.length && i !== s; ++o) {
                        var d = p[o],
                            a = e.indexOf(d, s);
                        0 <= a && a < i && (i = a, n = d)
                    }
                    if (t.push(e.slice(s, i)), !n) break;
                    t.push(n), s = i + n.length
                }
                for (var r = [], c = 0; c < t.length; ++c) {
                    var l = t[c];
                    0 !== l.length && (1 !== l.length ? (" " === l[0] && r.push(" "), r.push(l.trim()), " " === l[l.length - 1] && r.push(" ")) : r.push(l))
                }
                return r
            },
            chooseImage: function (e) {
                if (this.customIcons[e]) return this.customIcons[e];
                e = TextWithIcon.ICONS[e].filter(function (e) {
                    return cleverapps.bundleLoader.isLoaded(e.bundle)
                }).sort(function (e, t) {
                    return Math.abs(1 - this.fontSize / e.size) - Math.abs(1 - this.fontSize / t.size)
                })[0];
                return bundles[e.bundle].frames[e.name]
            },
            setString: function (e) {
                this.originalString = e;
                e = this.parseText("" + e);
                this.items = this.createItems(e), this.textOptions.width && this.fitTo(this.textOptions.width, this.textOptions.height), this.removeAllChildren(), this.items.forEach(function (e) {
                    this.addChild(e)
                }, this), this.reshape()
            },
            setFont: function (e) {
                this.font = e, this.fontSize = e.size, this.setString(this.originalString)
            }
        })),
        ShadowLayer = (
            TextWithIcon.IsApplicable = function (e, t) {
                if (t) return !0;
                for (var s in e += "", TextWithIcon.ICONS)
                    if (-1 !== e.indexOf(s)) return !0;
                return !1
            }, TextWithIcon.ICONS_BY_NAME = {
                rubies: "$$",
                hard: "$$",
                gold: "$$",
                energy: "%%",
                coins: "@@",
                soft: "@@",
                wands: "++"
            }, TextWithIcon.ICONS = {
                $$: [{
                    name: "gold_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }, {
                    name: "big_gold_icon_png",
                    bundle: "big_buttons",
                    size: 90
                }],
                "@@": [{
                    name: "coin_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }, {
                    name: "big_coin_icon_png",
                    bundle: "big_buttons",
                    size: 90
                }],
                "##": [{
                    name: "ad_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }, {
                    name: "big_ad_icon_png",
                    bundle: "big_buttons",
                    size: 90
                }],
                "**": [{
                    name: "ok_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                "&&": [{
                    name: "yandex_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                "}}": [{
                    name: "playhop_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                "{{": [{
                    name: "kred_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                "%%": [{
                    name: "energy_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                "^^": [{
                    name: "instant_worker_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                "++": [{
                    name: "wand_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                "--": [{
                    name: "worker_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                ">>": [{
                    name: "speedup_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }],
                "<<": [{
                    name: "feed_icon_png",
                    bundle: "buttons_inlined_icons",
                    size: 50
                }]
            }, cleverapps.styles.TextWithIcon = {
                margin: 0
            }, cc.Scale9Sprite.extend({
                ctor: function () {
                    var e = this.baseSize = cleverapps.UI.getBgSize();
                    this._super(bundles.pixel.frames.pixel_png), this.setColor(cleverapps.styles.COLORS.BLACK), this.setContentSize(1.05 * e.width + 5, 1.05 * e.height + 5), this.setAnchorPoint2(0, 0), this.setPosition(.025 * -e.width - 2, .025 * -e.height - 2)
                },
                updateSize: function () {
                    var e = cleverapps.UI.getBgSize(),
                        t = cc.Base.GetHierarchyScale(this.parent),
                        t = (e.width /= t.x, e.height /= t.y, Math.max(e.width / this.baseSize.width, this.baseSize.width / e.width)),
                        s = Math.max(e.height / this.baseSize.height, this.baseSize.height / e.height);
                    this.setScale(t * s),
                        this.setPositionRound(this.parent.convertToNodeSpace(cc.p(.025 * -e.width - 2, .025 * -e.height - 2)))
                },
                updatePosition: function () {
                    this.updateSize()
                }
            })),
        Dialogue = (cc.eventManager._sortEventListenersOfSceneGraphPriorityDes = function (e, t) {
            var s = cc.eventManager._nodePriorityMap,
                i = e._getSceneGraphPriority(),
                n = t._getSceneGraphPriority();
            if (!t || !n || !s[n.__instanceId]) return -1;
            if (!e || !i || !s[i.__instanceId]) return 1;
            n = s[t._getSceneGraphPriority().__instanceId] - s[e._getSceneGraphPriority().__instanceId];
            return 0 == n ? t.__instanceId - e.__instanceId : n
        }, "cocos2d" === engine && (cc.KEYBOARD_RETURNTYPE_DEFAULT = 0, cc.KEYBOARD_RETURNTYPE_DONE = 1, cc.KEYBOARD_RETURNTYPE_SEND = 2, cc.KEYBOARD_RETURNTYPE_SEARCH = 3, cc.KEYBOARD_RETURNTYPE_GO = 4, cc.EDITBOX_INPUT_MODE_ANY = 0, cc.EDITBOX_INPUT_MODE_EMAILADDR = 1, cc.EDITBOX_INPUT_MODE_NUMERIC = 2, cc.EDITBOX_INPUT_MODE_PHONENUMBER = 3, cc.EDITBOX_INPUT_MODE_URL = 4, cc.EDITBOX_INPUT_MODE_DECIMAL = 5, cc.EDITBOX_INPUT_MODE_SINGLELINE = 6, cc.EDITBOX_INPUT_FLAG_PASSWORD = 0, cc.EDITBOX_INPUT_FLAG_SENSITIVE = 1,
            cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD = 2, cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE = 3, cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS = 4, cc.EditBoxDelegate = cc.Class.extend({
                editBoxEditingDidBegin: function () { },
                editBoxEditingDidEnd: function () { },
                editBoxTextChanged: function () { },
                editBoxReturn: function () { }
            }), cc.EditBox = cc.Node.extend({
                _backgroundSprite: null,
                _delegate: null,
                _editBoxInputMode: cc.EDITBOX_INPUT_MODE_ANY,
                _editBoxInputFlag: cc.EDITBOX_INPUT_FLAG_SENSITIVE,
                _keyboardReturnType: cc.KEYBOARD_RETURNTYPE_DEFAULT,
                _maxLength: 50,
                _text: "",
                _textColor: null,
                _placeholderText: "",
                _placeholderFontName: "",
                _placeholderFontSize: 14,
                _placeholderColor: null,
                _className: "EditBox",
                _touchListener: null,
                _touchEnabled: !0,
                ctor: function (e, t, s) {
                    cc.Node.prototype.ctor.call(this), this._anchorPoint = cc.p(.5, .5), this._textColor = cc.color.WHITE, this._placeholderColor = cc.color.GRAY, this._oneLine = s, this._renderCmd._createLabels(), this.createDomElementIfNeeded(), this.initWithSizeAndBackgroundSprite(e, t),
                        this._touchListener = cc.EventListener.create({
                            event: cc.EventListener.TOUCH_ONE_BY_ONE,
                            swallowTouches: !0,
                            onTouchBegan: this._onTouchBegan.bind(this),
                            onTouchEnded: this._onTouchEnded.bind(this)
                        }), cc.eventManager.addListener(this._touchListener, this), this.setInputFlag(this._editBoxInputFlag)
                },
                setTouchEnabled: function (e) {
                    this._touchEnabled !== e && (this._touchEnabled = e, this._touchEnabled ? cc.eventManager.addListener(this._touchListener, this) : cc.eventManager.removeListener(this._touchListener))
                },
                _createRenderCmd: function () {
                    return new (cc._renderType === cc.game.RENDER_TYPE_CANVAS ? cc.EditBox.CanvasRenderCmd : cc.EditBox.WebGLRenderCmd)(this)
                },
                setContentSize: function (e, t) {
                    void 0 !== e.width && void 0 !== e.height && (t = e.height, e = e.width), cc.Node.prototype.setContentSize.call(this, e, t), this._updateEditBoxSize(e, t)
                },
                setVisible: function (e) {
                    cc.Node.prototype.setVisible.call(this, e), this._renderCmd.updateVisibility()
                },
                createDomElementIfNeeded: function () {
                    this._renderCmd._edTxt || this._renderCmd._createDomTextArea()
                },
                setTabIndex: function (e) {
                    this._renderCmd._edTxt && (this._renderCmd._edTxt.tabIndex = e)
                },
                getTabIndex: function () {
                    return this._renderCmd._edTxt ? this._renderCmd._edTxt.tabIndex : (cc.warn("The dom control is not created!"), -1)
                },
                setFocus: function () {
                    this._renderCmd._edTxt && (this.previousActive = document.activeElement, this._renderCmd._edTxt.focus())
                },
                setBlur: function () {
                    this._renderCmd._edTxt && (this._renderCmd._edTxt.blur(), this.previousActive && (this.previousActive.focus(), this.previousActive = void 0))
                },
                isFocused: function () {
                    return this._renderCmd._edTxt ? document.activeElement === this._renderCmd._edTxt : (cc.warn("The dom control is not created!"), !1)
                },
                stayOnTop: function (e) {
                    this._alwaysOnTop !== e && (this._alwaysOnTop = e, this._renderCmd.stayOnTop(this._alwaysOnTop))
                },
                cleanup: function () {
                    this._super(), this._renderCmd._removeDomFromGameContainer()
                },
                _isAncestorsVisible: function (e) {
                    if (null == e) return !0;
                    e = e.getParent();
                    return !(e && !e.isVisible()) && this._isAncestorsVisible(e)
                },
                _onTouchBegan: function (e) {
                    var t;
                    if (
                        this.isVisible() && this._isAncestorsVisible(this)) return e = e.getLocation(), t = cc.rect(0, 0, this._contentSize.width, this._contentSize.height), !!cc.rectContainsPoint(t, this.convertToNodeSpace(e)) || (this._renderCmd._endEditing(), !1)
                },
                _onTouchEnded: function () {
                    this.isVisible() && this._isAncestorsVisible(this) && this._renderCmd._beginEditing()
                },
                _updateBackgroundSpriteSize: function (e, t) {
                    this._backgroundSprite && this._backgroundSprite.setContentSize(e, t)
                },
                _updateEditBoxSize: function (e, t) {
                    var s = "number" == typeof e.width ? e.width : e,
                        e = "number" == typeof e.height ? e.height : t;
                    this._updateBackgroundSpriteSize(s, e), this._renderCmd.updateSize(s, e)
                },
                setLineHeight: function (e) {
                    this._renderCmd.setLineHeight(e)
                },
                setFont: function (e, t) {
                    this._renderCmd.setFont(e, t)
                },
                _setFont: function (e) {
                    this._renderCmd._setFont(e)
                },
                getBackgroundSprite: function () {
                    return this._backgroundSprite
                },
                setFontName: function (e) {
                    this._renderCmd.setFontName(e)
                },
                setFontSize: function (e) {
                    this._renderCmd.setFontSize(e)
                },
                setString: function (e) {
                    e.length >= this._maxLength && (e = e.slice(0, this._maxLength)), this._text = e, this._renderCmd.setString(e)
                },
                setFontColor: function (e) {
                    this._textColor = e, this._renderCmd.setFontColor(e)
                },
                setMaxLength: function (e) {
                    isNaN(e) || (this._maxLength = e = e < 0 ? 65535 : e, this._renderCmd.setMaxLength(e))
                },
                getMaxLength: function () {
                    return this._maxLength
                },
                setPlaceHolder: function (e) {
                    null !== e && (this._renderCmd.setPlaceHolder(e), this._placeholderText = e)
                },
                setPlaceholderFont: function (e, t) {
                    this._placeholderFontName = e, this._placeholderFontSize = t, this._renderCmd._updateDOMPlaceholderFontStyle()
                },
                _setPlaceholderFont: function (e) {
                    e = cc.LabelTTF._fontStyleRE.exec(e);
                    e && (this._placeholderFontName = e[2], this._placeholderFontSize = parseInt(e[1]), this._renderCmd._updateDOMPlaceholderFontStyle())
                },
                setPlaceholderFontName: function (e) {
                    this._placeholderFontName = e, this._renderCmd._updateDOMPlaceholderFontStyle()
                },
                setPlaceholderFontSize: function (e) {
                    this._placeholderFontSize = e, this._renderCmd._updateDOMPlaceholderFontStyle()
                },
                setPlaceholderFontColor: function (e) {
                    this._placeholderColor = e, this._renderCmd.setPlaceholderFontColor(e)
                },
                setInputFlag: function (e) {
                    this._editBoxInputFlag = e, this._renderCmd.setInputFlag(e)
                },
                getString: function () {
                    return this._text
                },
                initWithSizeAndBackgroundSprite: function (e, t) {
                    return this._backgroundSprite && this._backgroundSprite.removeFromParent(), this._backgroundSprite = t, this.setContentSize(e), this._backgroundSprite && !this._backgroundSprite.parent && (this._backgroundSprite.setAnchorPoint(cc.p(0, 0)), this.addChild(this._backgroundSprite), this._updateBackgroundSpriteSize(e.width, e.height)), this.x = 0, !(this.y = 0)
                },
                setDelegate: function (e) {
                    this._delegate = e
                },
                getPlaceHolder: function () {
                    return this._placeholderText
                },
                setInputMode: function (e) {
                    var t;
                    this._editBoxInputMode !== e && (t = this.getString(), this._editBoxInputMode = e, this._renderCmd.setInputMode(e), this._renderCmd.transform(), this.setString(t), this._renderCmd._updateLabelPosition(this.getContentSize()))
                },
                setReturnType: function (e) {
                    this._keyboardReturnType = e, this._renderCmd._updateDomInputType()
                },
                initWithBackgroundColor: function (e, t) {
                    this._edWidth = e.width, this.dom.style.width = this._edWidth.toString() + "px", this._edHeight = e.height, this.dom.style.height = this._edHeight.toString() + "px", this.dom.style.backgroundColor = cc.colorToHex(t)
                }
            }), (_p = cc.EditBox.prototype).font, cc.defineGetterSetter(_p, "font", null, _p._setFont), _p.fontName, cc.defineGetterSetter(_p, "fontName", null, _p.setFontName), _p.fontSize, cc.defineGetterSetter(_p, "fontSize", null, _p.setFontSize), _p.fontColor, cc.defineGetterSetter(_p, "fontColor", null, _p.setFontColor), _p.string, cc.defineGetterSetter(_p, "string", _p.getString, _p.setString), _p.maxLength, cc.defineGetterSetter(_p, "maxLength", _p.getMaxLength, _p.setMaxLength), _p.placeHolder, cc.defineGetterSetter(_p, "placeholder", _p.getPlaceHolder, _p.setPlaceHolder), _p.placeHolderFont, cc.defineGetterSetter(_p, "placeholderFont", null, _p._setPlaceholderFont), _p.placeHolderFontName, cc.defineGetterSetter(_p,
                "placeholderFontName", null, _p.setPlaceholderFontName), _p.placeHolderFontSize, cc.defineGetterSetter(_p, "placeholderFontSize", null, _p.setPlaceholderFontSize), _p.placeHolderFontColor, cc.defineGetterSetter(_p, "placeholderFontColor", null, _p.setPlaceholderFontColor), _p.inputFlag, cc.defineGetterSetter(_p, "inputFlag", null, _p.setInputFlag), _p.delegate, cc.defineGetterSetter(_p, "delegate", null, _p.setDelegate), _p.inputMode, cc.defineGetterSetter(_p, "inputMode", null, _p.setInputMode), _p.returnType, cc.defineGetterSetter(_p, "returnType", null, _p.setReturnType), _p = null, cc.EditBox.create = function (e, t, s, i) {
                    return new cc.EditBox(e, t, s, i)
                },
            function (e) {
                e._polyfill = {
                    zoomInvalid: !1
                }, cc.sys.OS_ANDROID !== cc.sys.os || cc.sys.browserType !== cc.sys.BROWSER_TYPE_SOUGOU && cc.sys.browserType !== cc.sys.BROWSER_TYPE_360 || (e._polyfill.zoomInvalid = !0)
            }(cc.EditBox),
            function (p) {
                function s(e) {
                    var t = e.convertToWorldSpace(cc.p(0, 0)),
                        s = cc.visibleRect.height,
                        e = cc.visibleRect.width,
                        i = s < e ? .7 : .5;
                    setTimeout(function () {
                        var e;
                        window.scrollY < 40 && t.y < s * i && (320 < (e = (e = s * i - t.y - window.scrollY) < 35 ? 35 : e) && (e = 320), window.scrollTo(e, e))
                    }, 400)
                }
                var e = Object.create(Object.prototype),
                    t = (e.updateMatrix = function () {
                        var e, t, s, i, n, o, a, r, c, l;
                        this._edTxt && (e = this._node, r = cc.view._scaleX, t = cc.view._scaleY, a = cc.view._devicePixelRatio, l = this._worldTransform, r /= a, t /= a, a = cc.game.container, s = l.a * r, i = l.b, n = l.c, o = l.d * t, c = a && a.style.paddingLeft && parseInt(a.style.paddingLeft), a = a && a.style.paddingBottom && parseInt(a.style.paddingBottom), r = l.tx * r + c, c = l.ty * t + a, p.zoomInvalid && (this.updateSize(e._contentSize.width * s, e._contentSize.height * o), o = s = 1), this._edTxt.style.transform = l = "matrix(" + s + "," + -i + "," + -n + "," + o + "," + r + "," + -c + ")", this._edTxt.style["-webkit-transform"] = l, this._edTxt.style["transform-origin"] = "0px 100% 0px", this._edTxt.style["-webkit-transform-origin"] = "0px 100% 0px")
                    }, e.updateVisibility = function () {
                        this._edTxt && (this._node.visible ? this._edTxt.style.visibility = "visible" : this._edTxt.style.visibility = "hidden")
                    }, e.stayOnTop = function (e) {
                        e ? (this._removeLabels(), this._edTxt.style.display = "") : (this._createLabels(), this._edTxt.style.display = "none", this._showLabels())
                    }, e._beginEditingOnMobile = function (e) {
                        this.__orientationChanged = function () {
                            s(e)
                        }, window.addEventListener("orientationchange", this.__orientationChanged), cc.view.isAutoFullScreenEnabled() ? (this.__fullscreen = !0, cc.view.enableAutoFullScreen(!1), cc.screen.exitFullScreen()) : this.__fullscreen = !1, this.__autoResize = cc.view.__resizeWithBrowserSize, cc.view.resizeWithBrowserSize(!1)
                    }, e._endEditingOnMobile = function () {
                        var e, t, s;
                        this.__rotateScreen && ((e = cc.game.container.style)["-webkit-transform"] = "rotate(90deg)", e.transform = "rotate(90deg)", t = (e = cc.view)._originalDesignResolutionSize.width, s = e._originalDesignResolutionSize.height, 0 < t && e.setDesignResolutionSize(t, s, e._resolutionPolicy), this.__rotateScreen = !1), window.removeEventListener("orientationchange", this.__orientationChanged), window.scrollTo(0, 0), this.__fullscreen && cc.view.enableAutoFullScreen(!0),
                            this.__autoResize && cc.view.resizeWithBrowserSize(!0)
                    }, e._onFocusOnMobile = function (e) {
                        var t;
                        cc.view._isRotated ? ((t = cc.game.container.style)["-webkit-transform"] = "rotate(0deg)", t.transform = "rotate(0deg)", t.margin = "0px", window.scrollTo(35, 35), this.__rotateScreen = !0) : this.__rotateScreen = !1, s(e)
                    }, e._createDomInput = function () {
                        this._removeDomFromGameContainer();
                        var s = this,
                            e = this._edTxt = document.createElement("input");
                        return e.type = "text", e.style.fontFamily = this._edFontName, e.style.fontSize = this._edFontSize + "px", e.style.color = "#000000", e.style.border = 0, e.style.background = "transparent", e.style.width = "100%", e.style.height = "100%", e.style.active = 0, e.style.outline = "medium", e.style.padding = "0", e.style.textTransform = "uppercase", e.style.display = "none", e.style.position = "absolute", e.style.bottom = "0px", e.style.left = "2px", e.style.className = "cocosEditBox", this.setMaxLength(s._editBox._maxLength), e.addEventListener("input", function () {
                            var e = s._editBox;
                            this.value.length > this.maxLength && (
                                this.value = this.value.slice(0, this.maxLength)), e._delegate && e._delegate.editBoxTextChanged && e._text !== this.value && (e._text = this.value, s._updateDomTextCases(), e._delegate.editBoxTextChanged(e, e._text))
                        }), e.addEventListener("keypress", function (e) {
                            var t = s._editBox;
                            e.keyCode === cc.KEY.enter && (e.stopPropagation(), e.preventDefault(), "" === this.value && (this.style.fontSize = t._placeholderFontSize + "px", this.style.color = cc.colorToHex(t._placeholderColor)), t._text = this.value, s._updateDomTextCases(), s._endEditing(), t._delegate && t._delegate.editBoxReturn && t._delegate.editBoxReturn(t), cc._canvas.focus())
                        }), e.addEventListener("focus", function () {
                            var e = s._editBox;
                            this.style.fontSize = s._edFontSize + "px", this.style.color = cc.colorToHex(e._textColor), s._hiddenLabels(), cc.sys.isMobile && s._onFocusOnMobile(e), e._delegate && e._delegate.editBoxEditingDidBegin && e._delegate.editBoxEditingDidBegin(e)
                        }), e.addEventListener("blur", function () {
                            var e = s._editBox;
                            e._text = this.value, s._updateDomTextCases(),
                                e._delegate && e._delegate.editBoxEditingDidEnd && e._delegate.editBoxEditingDidEnd(e), "" === this.value && (this.style.fontSize = e._placeholderFontSize + "px", this.style.color = cc.colorToHex(e._placeholderColor)), s._endEditing()
                        }), this._addDomToGameContainer(), e
                    }, e._createDomTextArea = function () {
                        this._removeDomFromGameContainer();
                        var s = this,
                            e = this._edTxt = document.createElement("textarea");
                        return e.type = "text", e.style.fontFamily = this._edFontName, e.style.fontSize = this._edFontSize + "px", e.style.color = "#000000", e.style.border = 0, e.style.background = "transparent", e.style.width = "100%", e.style.height = "100%", e.style.active = 0, e.style.outline = "medium", e.style.padding = "0", e.style.resize = "none", this._node._oneLine ? (e.wrap = "off", e.style.overflow = "hidden") : e.style.overflow_y = "scroll", e.style.textTransform = "uppercase", e.style.display = "none", e.style.position = "absolute", e.style.bottom = "0px", e.style.left = "2px", e.style.className = "cocosEditBox", this.setMaxLength(s._editBox._maxLength), e.addEventListener("input",
                            function () {
                                this.value.length > this.maxLength && (this.value = this.value.slice(0, this.maxLength));
                                var e = s._editBox;
                                e._delegate && e._delegate.editBoxTextChanged && e._text.toLowerCase() !== this.value.toLowerCase() && (e._text = this.value, s._updateDomTextCases(), e._delegate.editBoxTextChanged(e, e._text))
                            }), e.addEventListener("focus", function () {
                                var e = s._editBox;
                                s._hiddenLabels(), this.style.fontSize = s._edFontSize + "px", this.style.color = cc.colorToHex(e._textColor), cc.sys.isMobile && s._onFocusOnMobile(e), e._delegate && e._delegate.editBoxEditingDidBegin && e._delegate.editBoxEditingDidBegin(e)
                            }), e.addEventListener("keypress", function (e) {
                                var t = s._editBox;
                                e.keyCode === cc.KEY.enter && (e.stopPropagation(), t._delegate && t._delegate.editBoxReturn && t._delegate.editBoxReturn(t))
                            }), e.addEventListener("keyup", function (e) {
                                var t = s._editBox;
                                t._delegate && t._delegate.editBoxOnKeyUp && (e.stopPropagation(), t._delegate.editBoxOnKeyUp(e.keyCode))
                            }), e.addEventListener("blur", function () {
                                var e = s._editBox;
                                e._text = this.value,
                                    s._updateDomTextCases(), e._delegate && e._delegate.editBoxEditingDidEnd && e._delegate.editBoxEditingDidEnd(e), "" === this.value && (this.style.fontSize = e._placeholderFontSize + "px", this.style.color = cc.colorToHex(e._placeholderColor)), s._endEditing()
                            }), this._addDomToGameContainer(), e
                    }, e._createLabels = function () {
                        var e = this._editBox.getContentSize();
                        this._textLabel || (this._textLabel = new cc.LabelTTF, this._textLabel.setAnchorPoint(cc.p(0, 1)), this._editBox.addChild(this._textLabel, 100)), this._placeholderLabel || (this._placeholderLabel = new cc.LabelTTF, this._placeholderLabel.setAnchorPoint(cc.p(0, 1)), this._placeholderLabel.setColor(cc.color.GRAY), this._editBox.addChild(this._placeholderLabel, 100)), this._updateLabelPosition(e)
                    }, e._removeLabels = function () {
                        this._textLabel && (this._editBox.removeChild(this._textLabel), this._textLabel = null)
                    }, e._updateLabelPosition = function (e) {
                        var t, s;
                        this._textLabel && this._placeholderLabel && (t = cc.size(e.width - 2, e.height), this._textLabel.setContentSize(t),
                            this._textLabel.setDimensions(t), this._placeholderLabel.setLineHeight(e.height), t = this._placeholderLabel.getContentSize(), s = Math.round(.08 * t.height), this._editBox._editBoxInputMode === cc.EDITBOX_INPUT_MODE_ANY ? (this._textLabel.setPosition(2, e.height), this._placeholderLabel.setPosition(2, e.height + s), this._placeholderLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP), this._textLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP)) : (this._textLabel.setPosition(2, e.height), this._placeholderLabel.setPosition(2, (e.height + t.height) / 2 + s), this._placeholderLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), this._textLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER)))
                    }, e.setLineHeight = function (e) {
                        this._textLabel && this._textLabel.setLineHeight(e)
                    }, e._hiddenLabels = function () {
                        this._textLabel && this._textLabel.setVisible(!1), this._placeholderLabel && this._placeholderLabel.setVisible(!1)
                    }, e._updateDomTextCases = function () {
                        var e = this._editBox._editBoxInputFlag;
                        e === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS ? this._editBox._text = this._editBox._text.toUpperCase() : e === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD ? this._editBox._text = this._editBox._text.replace(/(?:^|\s)\S/g, function (e) {
                            return e.toUpperCase()
                        }) : e === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE && (this._editBox._text = (e = this._editBox._text).charAt(0).toUpperCase() + e.slice(1))
                    }, e._updateLabelStringStyle = function () {
                        if ("password" === this._edTxt.type) {
                            for (var e = "", t = this._editBox._text.length, s = 0; s < t; ++s) e += "●";
                            this._textLabel && this._textLabel.setString(e)
                        } else this._updateDomTextCases(), this._textLabel && this._textLabel.setString(this._editBox._text)
                    }, e._showLabels = function () {
                        this._hiddenLabels(), "" === this._edTxt.value ? this._placeholderLabel && (this._placeholderLabel.setVisible(!0), this._placeholderLabel.setString(this._editBox._placeholderText)) : this._textLabel && (this._textLabel.setVisible(!0), this._textLabel.setString(this._editBox._text)), this._updateLabelStringStyle()
                    },
                        e._beginEditing = function () {
                            this._editBox._alwaysOnTop || "none" === this._edTxt.style.display && (this._edTxt.style.display = "", this._edTxt.focus()), cc.sys.isMobile && !this._editingMode && this._beginEditingOnMobile(this._editBox), this._editingMode = !0
                        }, e._endEditing = function () {
                            var e;
                            this._editBox._alwaysOnTop || (this._edTxt.style.display = "none"), this._showLabels(), cc.sys.isMobile && this._editingMode && (e = this, setTimeout(function () {
                                e._endEditingOnMobile()
                            }, 400)), this._editingMode = !1
                        }, e._setFont = function (e) {
                            var e = cc.LabelTTF._fontStyleRE.exec(e),
                                t = e[2],
                                s = parseInt(e[1]);
                            e && this.setFont(t, s)
                        }, e.setFont = function (e, t) {
                            this._edFontName = e || this._edFontName, this._edFontSize = t || this._edFontSize, this._updateDOMFontStyle()
                        }, e.setFontName = function (e) {
                            this._edFontName = e || this._edFontName, this._updateDOMFontStyle()
                        }, e.setFontSize = function (e) {
                            this._edFontSize = e || this._edFontSize, this._updateDOMFontStyle()
                        }, e.setFontColor = function (e) {
                            this._edTxt && (this._edTxt.value !== this._editBox._placeholderText && (
                                this._edTxt.style.color = cc.colorToHex(e)), this._textLabel && this._textLabel.setColor(e))
                        }, e.setPlaceHolder = function (e) {
                            this._placeholderLabel.setString(e)
                        }, e.setMaxLength = function (e) {
                            this._edTxt && (this._edTxt.maxLength = e)
                        }, e._updateDOMPlaceholderFontStyle = function () {
                            this._placeholderLabel.setFontName(this._editBox._placeholderFontName), this._placeholderLabel.setFontSize(this._editBox._placeholderFontSize)
                        }, e.setPlaceholderFontColor = function (e) {
                            this._placeholderLabel.setColor(e)
                        }, e._updateDomInputType = function () {
                            var e = this._editBox._editBoxInputMode;
                            e === cc.EDITBOX_INPUT_MODE_EMAILADDR ? this._edTxt.type = "email" : e === cc.EDITBOX_INPUT_MODE_DECIMAL || e === cc.EDITBOX_INPUT_MODE_NUMERIC ? this._edTxt.type = "number" : e === cc.EDITBOX_INPUT_MODE_PHONENUMBER ? (this._edTxt.type = "number", this._edTxt.pattern = "[0-9]*") : e === cc.EDITBOX_INPUT_MODE_URL ? this._edTxt.type = "url" : (this._edTxt.type = "text", this._editBox._keyboardReturnType === cc.KEYBOARD_RETURNTYPE_SEARCH && (this._edTxt.type = "search")),
                                this._editBox._editBoxInputFlag === cc.EDITBOX_INPUT_FLAG_PASSWORD && (this._edTxt.type = "password")
                        }, e.setInputFlag = function (e) {
                            this._edTxt && (this._updateDomInputType(), this._edTxt.style.textTransform = "none", e === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS ? this._edTxt.style.textTransform = "uppercase" : e === cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD && (this._edTxt.style.textTransform = "capitalize"), this._updateLabelStringStyle())
                        }, e.setInputMode = function (e) {
                            e === cc.EDITBOX_INPUT_MODE_ANY ? this._createDomTextArea() : this._createDomInput(), this._updateDomInputType();
                            e = this._node.getContentSize();
                            this.updateSize(e.width, e.height)
                        }, e.setString = function (e) {
                            this._edTxt && null !== e && ("" === (this._edTxt.value = e) ? (this._placeholderLabel && (this._placeholderLabel.setString(this._editBox._placeholderText), this._placeholderLabel.setColor(this._editBox._placeholderColor)), this._editingMode || (this._placeholderLabel && this._placeholderLabel.setVisible(!0), this._textLabel && this._textLabel.setVisible(!1))) : (
                                this._edTxt.style.color = cc.colorToHex(this._editBox._textColor), this._textLabel && this._textLabel.setColor(this._editBox._textColor), this._editingMode || (this._placeholderLabel && this._placeholderLabel.setVisible(!1), this._textLabel && this._textLabel.setVisible(!0)), this._updateLabelStringStyle()))
                        }, e._updateDOMFontStyle = function () {
                            this._edTxt && (this._edTxt.style.fontFamily = this._edFontName, this._edTxt.style.fontSize = this._edFontSize + "px", this._textLabel && (this._textLabel.setFontSize(this._edFontSize), this._textLabel.setFontName(this._edFontName)))
                        }, e.updateSize = function (e, t) {
                            var s = this._edTxt;
                            s && (s.style.width = e + "px", s.style.height = t + "px", this._updateLabelPosition(cc.size(e, t)))
                        }, e._addDomToGameContainer = function () {
                            cc.game.container.appendChild(this._edTxt)
                        }, e._removeDomFromGameContainer = function () {
                            var e = this._edTxt;
                            !e || ("contains" in cc.game.container ? cc.game.container.contains(e) : cc.game.container.compareDocumentPosition(e) % 16) && cc.game.container.removeChild(e), this._edTxt = null
                        },
                        e.initializeRenderCmd = function (e) {
                            this._editBox = e, this._edFontSize = 14, this._edFontName = "Arial", this._textLabel = null, this._placeholderLabel = null, this._editingMode = !1, this.__fullscreen = !1, this.__autoResize = !1, this.__rotateScreen = !1, this.__orientationChanged = null
                        }, cc.EditBox.CanvasRenderCmd = function (e) {
                            this._rootCtor(e), this.initializeRenderCmd(e)
                        }, cc.EditBox.CanvasRenderCmd.prototype = Object.create(cc.Node.CanvasRenderCmd.prototype)),
                    t = (cc.inject(e, t), t.constructor = cc.EditBox.CanvasRenderCmd, t.transform = function (e, t) {
                        this.originTransform(e, t), this.updateMatrix()
                    }, cc.EditBox.WebGLRenderCmd = function (e) {
                        this._rootCtor(e), this.initializeRenderCmd(e)
                    }, cc.EditBox.WebGLRenderCmd.prototype = Object.create(cc.Node.WebGLRenderCmd.prototype));
                cc.inject(e, t), t.constructor = cc.EditBox.WebGLRenderCmd, t.transform = function (e, t) {
                    this.originTransform(e, t), this.updateMatrix()
                }
            }(cc.EditBox._polyfill)), cleverapps.Plot = {
                ReturnToMainScene: function (e, s) {
                    var t, i, n, o, a, r = this.isEpisodeFinished(s) && cleverapps.meta.getType() === Metha.HOSE && !cleverapps.Plot.isPassedAllEpisodes,
                        c = [],
                        l = "undefined" != typeof match3 && match3.heroes.readyToOpen();
                    l && (c.push(function (e) {
                        match3.heroes.incLevel(l), new HeroWindow({
                            color: l,
                            type: "unlocked"
                        }), cleverapps.meta.onceNoWindowsListener = e
                    }), (t = match3.heroes.getComics(l)) && c.push(function (e) {
                        ComicsScene.showComics(e, t)
                    })), this.isEpisodeFinished(s) && !cleverapps.Plot.isPassedAllEpisodes && (n = levels.user.episode - 1, (i = cleverapps.styles.comicses["finishEpisode" + n] || cleverapps.styles.comicses.finishEpisode) && c.push(function (e) {
                        ComicsScene.showComics(e, i)
                    })), cleverapps.isKnockoutGame() && s.isRegular() ? (n = cleverapps.meta.getRumble()).outcome === Rumble.OUTCOME_UNKNOWN ? c.push(function (e) {
                        cleverapps.meta.wantsToPlay(e)
                    }) : (n.outcome === Rumble.OUTCOME_WIN && (c.push(function (e) {
                        cleverapps.meta.getMainObject().knockoutGame.openWindow(e)
                    }), c.push(function (e) {
                        new KnockoutVictoryWindow, cleverapps.meta.onceNoWindowsListener = e
                    })), c.push(function (e) {
                        cleverapps.meta.stopRumble(), e()
                    }), c.push(function (e) {
                        cleverapps.travelBook.gotoMainScene(e)
                    })) : c.push(function (e) {
                        var t = cleverapps.missionManager.getMissionWithIntent();
                        !r && t && t.logic.willUseIntent(s) ? t.useMissionIntent(e) : cleverapps.travelBook.gotoMainScene(e)
                    }), r && (cleverapps.hose.changeEpisodeAnimation = !0, o = levels.user.episode - 1, a = 1 + o, c.push(function (e) {
                        cleverapps.meta.compound(e, [function (e) {
                            cleverapps.Plot.onFinishEpisode(e, {
                                episode: cleverapps.hose.episodes[o]
                            })
                        }, function (e) {
                            cleverapps.hose.changeEpisodeAnimation = !1, cleverapps.hose.gotoNextEpisode(e, !0, a)
                        }, function (e) {
                            cleverapps.Plot.onStartEpisode(e, {
                                episode: cleverapps.hose.episodes[a]
                            })
                        }])
                    })), s.isRegular() && s.isPassed && s.isCurrentLevel() && cleverapps.Plot.getDialogueAfterLevel(s) && c.push(function (e) {
                        cleverapps.Plot.finishLevelDialogue(e, s)
                    }), cleverapps.meta.compound(e, c)
                },
                onFinishEpisode: function (e, t) {
                    cleverapps.meta.compound(e, [function (e) {
                        new FinishEpisodeWindow(t.episode.episodeNo), cleverapps.meta.onceNoWindowsListener = e
                    }, function (e) {
                        t.episode.animatePass(e)
                    }])
                },
                onStartup: function (e, t) {
                    return 0 === levels.user.episode && 0 === levels.user.level ? this.onFirstInit(e, t) : t ? cleverapps.meta.getMainScene() : cleverapps.dailyLevel && cleverapps.dailyLevel.isStartFromPortlet() ? (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_LEVEL_CHANNEL + cleverapps.dailyLevel.getCurrentEvent()), void cleverapps.dailyLevel.start(e)) : void cleverapps.travelBook.gotoMainScene(e)
                },
                onFirstInit: function (e, t) {
                    var s = [];
                    if (cleverapps.styles.comicses && cleverapps.styles.comicses.begin && "playable" !== cleverapps.config.source) {
                        if (t) return {
                            scene: ComicsScene,
                            options: [cleverapps.styles.comicses.begin]
                        };
                        s.push(function (e) {
                            ComicsScene.showComics(e, cleverapps.styles.comicses.begin)
                        })
                    } else if (this.hasStartEpisodeWindow()) return t ? cleverapps.meta.getMainScene() : (s.push(function (e) {
                        cleverapps.travelBook.gotoMainScene(e)
                    }), s.push(function (e) {
                        this.onStartEpisode(e, {
                            episode: cleverapps.hose.getCurrentEpisode()
                        })
                    }.bind(this)), void cleverapps.meta.compound(e, s));
                    if (
                        cleverapps.meta.getType() !== Metha.HOSE && cleverapps.meta.getType() !== Metha.SIMPLE || "playable" === cleverapps.config.source) {
                        if (t) return cleverapps.meta.getMainScene();
                        s.push(function (e) {
                            cleverapps.travelBook.gotoMainScene(e)
                        })
                    } else {
                        if (t) return GameScene;
                        s.push(function (e) {
                            cleverapps.meta.wantsToPlay(e)
                        })
                    }
                    cleverapps.meta.compound(e, s)
                },
                hasStartEpisodeWindow: function () {
                    return cleverapps.meta.getType() === Metha.HOSE && "riddles" === cleverapps.config.name && "playable" !== cleverapps.config.source
                },
                onStartEpisode: function (e, t) {
                    var s;
                    t.episode.isComingSoon() ? (new FinisherWindow, cleverapps.meta.onceNoWindowsListener = e) : ((s = []).push(function (e) {
                        t.episode.animateOpen(e)
                    }), this.hasStartEpisodeWindow() && s.push(function (e) {
                        new StartEpisodeWindow(t.episode), cleverapps.meta.onceNoWindowsListener = e
                    }), cleverapps.meta.compound(e, s))
                },
                isEpisodeFinished: function (e) {
                    return e.isRegular() && e.isPassed && e.isLastLevelOnEpisode() && e.isCurrentLevel()
                },
                getDialogueAfterLevel: function (e) {
                    if (
                        !cleverapps.styles.dialogues || !e.isRegular()) return !1;
                    e = cleverapps.user.getHumanReadableNumber() - 1;
                    return cleverapps.styles.dialogues["finishLevel" + e]
                },
                finishLevelDialogue: function (e, t) {
                    var s, i = this.getDialogueAfterLevel(t);
                    i && (s = cleverapps.scenes.getRunningScene(), cleverapps.meta.compound(e, [function (e) {
                        i.bundles ? cleverapps.bundleLoader.loadBundles(i.bundles, {
                            onSuccess: function () {
                                e()
                            },
                            blocked: !0
                        }) : e()
                    }, function (e) {
                        var t = s.height * (1.2 - 1);
                        s.createFilmEffect({
                            scale: 1.2,
                            layerTimeout: .3,
                            scaleTimeout: 1,
                            moveBy: {
                                y: t
                            },
                            onShow: e
                        })
                    }, function (e) {
                        var t = new Dialogue(i.dialogue, {
                            autoClose: !0,
                            autoScroll: 3,
                            parentScene: !0,
                            showUp: !0
                        });
                        t.on("afterClose", e), new DialogueView(t).setLocalZOrder(51)
                    }, function (e) {
                        s.removeFilmEffect(.4, e)
                    }]))
                }
            }, cleverapps.styles.comicses = {}, function (e, t) {
                cleverapps.EventEmitter.call(this), this.options = t || {}, this.parentScene = t.parentScene, this.autoScroll = 3, void 0 !== this.options.autoScroll && (this.autoScroll = this.options.autoScroll), this.data = Array.isArray(e) ? e : [e], this.stage = -1,
                    this.stageData = this.data[0], this.personSlots = [void 0, void 0];
                var s = [];
                e.forEach(function (t) {
                    ["person", "person2"].forEach(function (e) {
                        t[e] && (e = PersonsLibrary.getPerson(t[e].role || t[e]), s.push(e && e.bundle || t[e]))
                    })
                }), this.bundlesToLoad = cleverapps.unique(["dialogues"].concat(s).concat(this.options.bundles || [])).filter(function (e) {
                    return bundles[e]
                })
            }),
        PointerView = (Dialogue.prototype = Object.create(cleverapps.EventEmitter.prototype), (Dialogue.prototype.constructor = Dialogue).prototype.run = function () {
            cleverapps.meta.isFocused() || (console.log("Dialogue:", this.data), cleverapps.meta.debugMessage("Trying to show dialogue without user focus!")), this.focus = cleverapps.meta.focus, this.next()
        }, Dialogue.prototype.isStarted = function () {
            return -1 !== this.stage
        }, Dialogue.prototype.finishClose = function () {
            this.closeCallback && (this.closeCallback(), delete this.closeCallback), this.trigger("afterClose")
        }, Dialogue.prototype.close = function (e) {
            this.closing || (this.closing = !0, this.closeCallback = e, this.trigger("close",
                !this.options.showUp))
        }, Dialogue.prototype.next = function (e) {
            clearTimeout(this.nextTimeout), !1 !== cleverapps.meta.focus && cleverapps.meta.focus !== this.focus || (e ? this.nextTimeout = this.createTimeout(this.next.bind(this), 1e3 * e) : this.typing ? this.finishTyping() : this.stage < this.data.length - 1 ? this.incStage() : this.options.autoClose && this.close())
        }, Dialogue.prototype.incStage = function () {
            this.stage++, this.stageData = this.data[this.stage], this.onChangeStage()
        }, Dialogue.prototype.createTimeout = function (e, t) {
            return new cleverapps.CountDown(t, {
                onFinish: function () {
                    this.closing || e()
                }.bind(this)
            })
        }, Dialogue.prototype.onChangeStage = function () {
            void 0 === this.stageData.person && (this.stageData.person = "hero");
            var e = this.stageData.person && Person.ParseOptions(this.stageData.person),
                t = (e && (e.active = !0), this.stageData.person2 && Person.ParseOptions(this.stageData.person2));
            t && (t.active = !1), (t = "left" === e.orientation ? [e, t] : [t, e]).forEach(function (e, t) {
                var t = this.personSlots[t];
                this.areSamePersons(e, t) || (t && this.trigger(
                    "hidePerson", t.orientation), e && (t = 0 === this.stage, this.trigger("addPerson", e, t)))
            }, this), this.trigger("updateActive", e && e.orientation), this.trigger("updatePersonTitle", e), this.trigger("changedStage"), this.personSlots = t, 0 === this.stage ? this.trigger("showUp", !this.options.showUp, this.onTyping.bind(this)) : this.onTyping()
        }, Dialogue.prototype.onTyping = function (e) {
            this.typing = !0, this.trigger("changeText", this.stageData.text, e)
        }, Dialogue.prototype.areSamePersons = function (e, t) {
            return e && t && e.orientation === t.orientation && e.role === t.role
        }, Dialogue.prototype.finishTyping = function (e) {
            this.typing = !1, this.trigger("finishTyping", e), this.autoScroll && this.next(this.autoScroll)
        }, Dialogue.prototype.screenClicked = function () {
            this.trigger("screenClicked"), this.next()
        }, Dialogue.POSITIONS = {
            TOP: "top",
            TOP_LOWER: "top_lower",
            BOTTOM: "bottom",
            CENTER: "center"
        }, cleverapps.Spine.extend({
            avoidNode: "PointerView",
            ctor: function (e) {
                this._super(bundles.finger.jsons.arrow_json), this.options = e || {},
                    this.target = this.options.target, this.target.addChild(this), this.replaceParentSamePlace(cleverapps.scenes.getRunningScene(), {
                        keepScale: !0
                    }), this.afterResize(), cleverapps.windows.on("openWindow", this.createListener(this.setVisible.bind(this, !1)), this), cleverapps.windows.on("closeWindows", this.createListener(this.setVisible.bind(this, !0)), this), this.setLocalZOrder(100)
            },
            definePosition: function (e) {
                this.direction = e, this.setAnimation(0, e, !0);
                var t = -1 !== [PointerView.DIRECTIONS.DOWN, PointerView.DIRECTIONS.LEFT].indexOf(e) ? 1 : -1; - 1 !== [PointerView.DIRECTIONS.UP, PointerView.DIRECTIONS.DOWN].indexOf(e) ? this.pointerPosition = cc.pMult(cc.p(0, (this.target.height + this.height) / 2 * t), this.scale) : this.pointerPosition = cc.pMult(cc.p((this.target.width + this.width) / 2 * t, 0), this.scale)
            },
            guessDirection: function () {
                if (this.target instanceof MenuBarItemView) return PointerView.DIRECTIONS.RIGHT;
                if (void 0 !== CardView && this.target instanceof CardView) return PointerView.DIRECTIONS.DOWN;
                if (!this.target.getParent()) return PointerView.DIRECTIONS.UP;
                var e = cleverapps.scenes.getRunningScene(),
                    t = e.convertToNodeSpace(this.target.getPosition());
                return t.y > 4 * e.height / 5 ? PointerView.DIRECTIONS.UP : t.x < e.width / 5 ? PointerView.DIRECTIONS.RIGHT : t.x > 4 * e.width / 5 ? PointerView.DIRECTIONS.LEFT : PointerView.DIRECTIONS.DOWN
            },
            afterResize: function () {
                var e = (e = this.target.parent) || cleverapps.scenes.getRunningScene(),
                    t = this.guessDirection(),
                    t = (t !== this.direction && this.definePosition(t), this.parent.convertToNodeSpace(e.convertToWorldSpace(this.target.getPosition())));
                this.setPosition(t.x + this.pointerPosition.x, t.y + this.pointerPosition.y)
            }
        })),
        ForceView = (PointerView.create = function (e) {
            var t = new PointerView(e = e || {});
            return PointerView.remove(PointerView.currentPointer), PointerView.currentPointer = t, addCleaner(t, function () {
                PointerView.remove(t)
            }), t
        }, PointerView.remove = function (e) {
            e && PointerView.currentPointer === e && (PointerView.currentPointer = void 0, e.removeFromParent())
        }, PointerView.DIRECTIONS = {
            UP: "up",
            DOWN: "down",
            LEFT: "left",
            RIGHT: "right"
        }, Window.extend({
            ctor: function (e, t, s) {
                this.forceConfig = t, this.options = s || {}, this.force = t, this.element = e;
                var i = this.options.actives || [],
                    n = (e !== ForceView.NO_ELEMENT && i.push(e), this.actives = [], i.forEach(function (e) {
                        this._existParent(e, i) || this.actives.push(e)
                    }, this), this.options.highlights || []);
                this.actives.forEach(function (e) {
                    n.push(e)
                }), this.highlights = [], n.forEach(function (e) {
                    this._existParent(e, n) || this.highlights.push(e)
                }, this), this._super(e, t)
            },
            grabFocus: function () {
                cleverapps.meta.setEventNodes(this.actives)
            },
            beforeResize: function () {
                this.element && this.backNodesFromForce()
            },
            afterResize: function () {
                this.element && (this.upNodesForForce(), this.text && this.createDialogue())
            },
            moveNodeAndKeepScale: function (e) {
                var t, s, i;
                e.isRunning() && (s = (t = e.getParent()).adjustScaleTo(this), (i = new cc.Node).setScale(s.x, s.y), i.setLocalZOrder(e.getLocalZOrder()), this.content.addChild(i), e.forceParent = t, e.forcePosition = e.getPosition(), e.replaceParentSamePlace(i))
            },
            upNodesForForce: function () {
                this.lifted || (this.lifted = !0, this.highlights.forEach(function (e) {
                    this.moveNodeAndKeepScale(e)
                }, this))
            },
            backNodesFromForce: function () {
                this.lifted && (this.lifted = !1, this.highlights.forEach(function (e) {
                    this.returnNode(e)
                }, this))
            },
            _existParent: function (e, t) {
                for (e = e.getParent(); e;) {
                    if (0 <= t.indexOf(e)) return !0;
                    e = e.getParent()
                }
                return !1
            },
            returnNode: function (e) {
                e.parent && e.parent.parent === this.content && (e.replaceParentSamePlace(e.forceParent), e.setPosition(e.forcePosition)), e.forceParent = void 0, e.forcePosition = void 0
            },
            listRects: function () {
                var t = [];
                return this.options.importantNodes && this.options.importantNodes.forEach(function (e) {
                    t.push(e.getGlobalBoundingBox())
                }), this.pointer && t.push(this.pointer.getGlobalBoundingBox()), this.actives.forEach(function (e) {
                    t.push(e.getGlobalBoundingBox())
                }), t
            },
            onWindowLoaded: function (e, t) {
                var s, i;
                this.id = t.id, this._super({
                    content: new cc.Node,
                    noBackground: !0,
                    name: "forcewindow" + this.id,
                    closeButton: !1,
                    styles: cleverapps.styles.Force
                }),
                    t.controls && cleverapps.meta.showControlsWhileFocused(t.controls, !0), this.setLocalZOrder(BaseWindow.WINDOWS_ZORDER + 9), cleverapps.toolbar.freezeUpdates(), this.element = e, this.upNodesForForce(), e !== ForceView.NO_ELEMENT && !1 !== t.finger && (!t.finger || (i = (i = "function" == typeof (i = t.finger) ? i() : i).mobile && cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? i.mobile : i).delay && (s = i.delay), this.finger = FingerView.hintClick(e, {
                        delay: s
                    })), e !== ForceView.NO_ELEMENT && t.pointer && (this.pointer = PointerView.create({
                        target: e
                    })), this.text = "function" == typeof t.text ? t.text(t, e) : t.text, e !== ForceView.NO_ELEMENT && !this.forceConfig.closeByTouchInShadow || this.addCloseByTouchInShadow(), e !== ForceView.NO_ELEMENT && (this.watchElementInterval = setInterval(function () {
                        this.element.parent && this.element.visible || (cleverapps.forces.isRunningForce() ? cleverapps.forces.closeRunningForce() : (this.close(), cleverapps.forces.clearForce(this.id)))
                    }.bind(this), 5e3)), this.text && this.createDialogue()
            },
            createDialogue: function () {
                this.dialogue && this.dialogue.removeFromParent(), this.dialogue = new MinimalDialogue({
                    text: this.text,
                    person: this.force.person,
                    targetRect: this.element && this.element !== ForceView.NO_ELEMENT && this.element.getGlobalBoundingBox(),
                    rects: this.listRects(),
                    forcePosition: "function" == typeof this.force.position ? this.force.position() : this.force.position
                }), this.addChild(this.dialogue), this.dialogue.display()
            },
            onClose: function () {
                this.watchElementInterval && clearInterval(this.watchElementInterval), this.backNodesFromForce(), FingerView.remove(this.finger), PointerView.remove(this.pointer), this.pointer = void 0, this.finger = void 0, cleverapps.toolbar.unfreezeUpdates()
            },
            addCloseByTouchInShadow: function () {
                this.clickArea = new cc.Node, this.clickArea.setContentSize(this.getContentSize()), this.addChild(this.clickArea), cc.eventManager.addListener({
                    event: cc.EventListener.TOUCH_ONE_BY_ONE,
                    swallowTouches: !0,
                    onTouchBegan: function () {
                        cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce()
                    }
                }, this.clickArea)
            },
            stop: function () { }
        })),
        FragileForceView = (cleverapps.styles.Force = {
            windowShowUpAnimation: {
                name: "instant",
                force: !0
            }
        }, ForceView.NO_ELEMENT = "emptyForceElement", cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.force = t, this.setLocalZOrder(31), this.pointer = PointerView.create({
                    target: e
                }), this.dialogue = new MinimalDialogue({
                    text: this.force.text,
                    person: this.force.person,
                    forcePosition: Dialogue.POSITIONS.TOP_LOWER
                }), this.addChild(this.dialogue), this.dialogue.display(), this.runAction(new cc.Sequence(new cc.DelayTime(15), new cc.CallFunc(this.closeForce.bind(this)))), cleverapps.eventBus.on("changeFocus", this.closeForce.bind(this), this), cleverapps.scenes.getRunningScene().addChild(this)
            },
            close: function () {
                this.stopAllActions(), this.dialogue && (this.dialogue.remove(), this.dialogue = void 0), PointerView.remove(this.pointer), this.runAction(new cc.Sequence(new cc.DelayTime(.5), new cc.RemoveSelf))
            },
            closeForce: function () {
                cleverapps.forces.isRunningForce(this.force) && cleverapps.forces.closeRunningForce()
            }
        })),
        Forces = function () {
            this.shownForces = [], this.load(), this.forceView = void 0, this.onceForceClosed = void 0
        },
        AdsLimits = (Forces.prototype.isRunningForce = function (e) {
            return void 0 !== this.forceView && (void 0 === e || this.forceView.force.id === e.id)
        }, Forces.prototype.getRunningForce = function () {
            return this.forceView
        }, Forces.prototype.whenForceClosed = function (e) {
            this._whenForceClosedCallbacks || (this._whenForceClosedCallbacks = []), this._whenForceClosedCallbacks.push(e)
        }, Forces.prototype._runForceClosedCallbacks = function () {
            this._whenForceClosedCallbacks && (this._whenForceClosedCallbacks.forEach(function (e) {
                e()
            }), delete this._whenForceClosedCallbacks)
        }, Forces.prototype.closeRunningForce = function () {
            var e;
            this.forceView.close(), this._runForceClosedCallbacks(this.forceView.force.id), void 0 !== this.forceView.force.id && this.saveForce(this.forceView.force.id), this.forceView = void 0, this.onceForceClosed && (e = this.onceForceClosed, this.onceForceClosed = void 0, e())
        }, Forces.prototype.reset = function () {
            this.shownForces = [],
                this.save()
        }, Forces.prototype.load = function () {
            this.shownForces = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.FORCES) || []
        }, Forces.prototype.save = function (e) {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.FORCES, this.shownForces), e || cleverapps.synchronizer.addUpdateTask("forces")
        }, Forces.prototype.getInfo = function () {
            return {
                forces: cleverapps.toBit(this.shownForces)
            }
        }, Forces.prototype.updateInfo = function (e, t) {
            this.shownForces = cleverapps.fromBit(e.forces || 0), this.save(t)
        }, Forces.prototype.isAvailable = function (e, t) {
            return !(!e || e !== ForceView.NO_ELEMENT && !e.isRunning()) && (void 0 === t.id || -1 === this.shownForces.indexOf(t.id))
        }, Forces.prototype.isShown = function (e) {
            return void 0 !== e && (this.shownForces && 0 <= this.shownForces.indexOf(e))
        }, Forces.prototype.saveForce = function (e) {
            e && !this.isShown(e) && (this.shownForces.push(e), this.save())
        }, Forces.prototype.clearForce = function (e) {
            e = this.shownForces.indexOf(e); - 1 !== e && (this.shownForces.splice(e, 1), this.save())
        },
            Forces.prototype.create = function (e, t, s) {
                var i;
                if (this.isAvailable(e, t)) return i = t.fragile ? FragileForceView : ForceView, this.forceView = new i(e, t, s), this.forceView
            }, Forces.prototype.checkMainForces = function () {
                return this.checkDailyTasksForce() || this.checkPeriodicBonusForce() || this.checkBonusRoundForce() || this.checkHeroesForce()
            }, Forces.prototype.checkDailyTasksForce = function () {
                return cleverapps.dailyTasks && cleverapps.dailyTasks.isAvailable() && !this.isShown(Forces.DAILY_TASKS_FORCE.id)
            }, Forces.prototype.checkPeriodicBonusForce = function () {
                return cleverapps.periodicBonus && cleverapps.periodicBonus.isAvailable() && !this.isShown(Forces.PERIODIC_BONUS_FORCE.id)
            }, Forces.prototype.checkBonusRoundForce = function () {
                return cleverapps.bonusRoundChest && cleverapps.bonusRoundChest.isActive() && !this.isShown(Forces.BONUS_ROUND_FORCE.id)
            }, Forces.prototype.checkHeroesForce = function () {
                return "undefined" != typeof match3 && match3.heroes.available() && !this.isShown(Forces.HEROES_AVAILABLE.id)
            }, Forces.FREE_UNDO_FORCE = {
                id: 2,
                text: "UndoTutorialMessage"
            }, Forces.FREE_HINT_FORCE = {
                id: 3,
                text: "hintTutorialMessage"
            }, Forces.FIRST_BOOSTERS_BEFORE = {
                id: 4,
                text: "FirstBoostersBefore.force",
                position: Dialogue.POSITIONS.BOTTOM
            }, Forces.SECOND_BOOSTERS_BEFORE = {
                id: 5,
                text: "SecondBoostersBefore.force",
                position: Dialogue.POSITIONS.BOTTOM
            }, Forces.THIRD_BOOSTERS_BEFORE = {
                id: 6,
                text: "ThirdBoostersBefore.force",
                position: Dialogue.POSITIONS.BOTTOM
            }, Forces.FREE_PAINT_FORCE = {
                id: 8,
                text: "Paint.force"
            }, Forces.DAILY_TASKS_FORCE = {
                id: 10,
                text: "Forces.DailyTasks"
            }, Forces.COOLDOWN_FORCE = {
                id: 11,
                text: "CoolDownNode.force",
                button: {
                    text: "SkipButton"
                },
                finger: !1
            }, Forces.PERIODIC_BONUS_FORCE = {
                id: 12,
                text: "Forces.PeriodicBonus"
            }, Forces.FOG_EXPLORE = {
                id: 13
            }, Forces.HEROES_AVAILABLE = {
                id: 17,
                text: "Forces.HeroesAvailable"
            }, Forces.DAILY_CUP = {
                id: 18,
                text: "Cups.daily.force"
            }, Forces.LANTERN = {
                id: 20,
                text: "LanternWindow.force"
            }, Forces.BONUS_ROUND_FORCE = {
                id: 21,
                text: "Forces.BonusRound"
            }, Forces.UNLOCK_HEROES = {
                text: "Forces.UnlockHero"
            }, Forces.UPGRADE_HEROES = {
                text: "Forces.UpgradeFirstHero"
            }, Forces.METHA_PLAY_BUTTON = {
                id: 23,
                controls: ["play_button"],
                text: function () {
                    return cleverapps.meta.getType() === Metha.SIMPLE ? "SimpleMethaPlayButton.force" : "MethaPlayButton.force"
                },
                position: Dialogue.POSITIONS.TOP_LOWER
            }, Forces.KNOCKOUT_PLAYERS = {
                id: 24,
                text: "KnockoutPlayers.force",
                button: {
                    text: "SkipButton"
                },
                finger: !1,
                closeByTouchInShadow: !0
            }, Forces.KEYPAD = {
                id: 25,
                text: "Keypad.force",
                button: {
                    text: "SkipButton"
                },
                finger: !1,
                position: function () {
                    if ("differences" === cleverapps.config.type) return Dialogue.POSITIONS.TOP
                }
            }, Forces.COOKIEJAR = {
                id: 27,
                text: "Cookiejar.force",
                button: {
                    text: "OK"
                },
                closeByTouchInShadow: !0
            }, Forces.CRYPTEX = {
                id: 28,
                text: "Cryptex.force",
                fragile: !0
            }, Forces.FREE_SHUFFLE_FORCE = {
                id: 29,
                text: "ShuffleBooster.force"
            }, Forces.PHOTO_CLOVER = {
                id: 30,
                text: "PhotoClover.force"
            }, Forces.TRICKY_LEVEL = {
                id: 31,
                text: "TrickyLevelForce",
                finger: !1
            }, Forces.SIMPLE = {
                id: 32,
                text: "Simple.Force"
            }, Forces.BONUS_WORLD = {
                id: 33
            }, Forces.SLOT_MACHINE_ICON = {
                id: 34,
                text: "SlotMachine.IconForce"
            },
            Forces.SLOT_MACHINE = {
                id: 35,
                text: "SlotMachine.Force"
            }, Forces.BUY_ENERGY_ICON = {
                id: 36,
                text: "BuyEnergy.IconForce",
                productKey: "buyEnergy350",
                productOptions: {
                    price: 0,
                    reward: 30
                }
            }, Forces.UNITS_SHOP_ICON = {
                id: 37,
                text: "UnitsShop.IconForce"
            }, Forces.SLOT_MACHINE_HELP = {
                id: 38,
                text: "SlotMachine.HelpForce"
            }, Forces.QUEST_ICON = {
                id: 39,
                text: "Quest.IconForce"
            }, Forces.TRAVEL_BOOK = {
                id: 40,
                text: function () {
                    return cleverapps.travelBook.chosenForForce.forceText
                },
                person: "king"
            }, Forces.PERIODIC_SALE = {
                id: 41,
                text: function () {
                    var e = cleverapps.eventManager.getFeatureEvent("lottery");
                    return e && e.options.vkSaleDay ? "PeriodicSale.vkforce" : "PeriodicSale.force"
                }
            }, Forces.PERIODIC_PACK = {
                id: 26,
                text: "PeriodicPack.force"
            }, Forces.CLANS_ICON = {
                id: 42,
                text: "Clans.force"
            }, Forces.OFFER_ICON_SLOT1 = {
                id: 43,
                text: "Offer.IconForce"
            }, Forces.OFFER_ICON_SLOT2 = {
                id: 44,
                text: "Offer.IconForce"
            }, Forces.LEVELPASS = {
                id: 45,
                text: "LevelPass.force"
            }, Forces.SECOND_LANDMARK = {
                id: 46
            }, Forces.LANDMARK_DONOR_SLOT1 = {
                id: 47,
                text: "Landmarks.force"
            },
            Forces.LANDMARK_DONOR_SLOT2 = {
                id: 48,
                text: "Landmarks.force"
            }, Forces.CHAIN_SALE = {
                id: 50,
                text: "ChainSale.force"
            }, Forces.FREE_VACUUM_FORCE = {
                id: 22,
                text: "VacuumBooster.force"
            }, Forces.FREE_PROLONGATION_FORCE = {
                id: 51,
                text: "Prolongation.force"
            }, Forces.FREE_REPLACE_ALL_FORCE = {
                id: 7,
                text: "ReplaceAllBooster.force"
            }, Forces.FREE_NEXT_PIECES_FORCE = {
                id: 16,
                text: "ClearPiecesBooster.force"
            }, Forces.FREE_UNDO_PIECE = {
                id: 19,
                text: "UndoPieceBooster.force"
            }, Forces.FREE_BOMB_FORCE = {
                id: 9,
                text: "outOfBombMovesHint"
            }, Forces.TROOP_CARDS_FORCE = {
                id: 14,
                text: "TroopCards.force"
            }, Forces.MENU_BAR_SOFT_FORCE = {
                id: 15,
                text: "SoftForce",
                finger: {
                    useForceTarget: !0
                },
                available: {
                    level: 1.6
                },
                productKey: "softCurrencyVerySmall",
                productOptions: {
                    price: 0
                }
            }, Forces.BLOCK_TUTORIAL = {
                text: "Blocks.TutorialMessage1",
                position: Dialogue.POSITIONS.TOP_LOWER,
                finger: {
                    delay: 10
                }
            },
            function () {
                cleverapps.EventEmitter.call(this), AdsLimits.initialize(), this.load(), this.dirty = !1, this.update(), cleverapps.rewardedAdsManager.on(
                    "changeLoaderState:" + RewardedAdsManager.REWARDED, this.notifyUpdated.bind(this)), new cleverapps.Interval(this.update.bind(this), cleverapps.parseInterval(AdsLimits.CHECK_INTERVAL))
            }),
        Actor = (AdsLimits.prototype = Object.create(cleverapps.EventEmitter.prototype), (AdsLimits.prototype.constructor = AdsLimits).prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ADS_LIMITS_DATA, this.data)
        }, AdsLimits.prototype.load = function () {
            this.data = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ADS_LIMITS_DATA) || {};
            var t = cleverapps.values(AdsLimits.TYPES);
            Object.keys(this.data).forEach(function (e) {
                -1 === t.indexOf(e) && delete this.data[e]
            }, this)
        }, AdsLimits.prototype._updateType = function (e) {
            var t = this.getLimit(e),
                s = this.data[e];
            s && 0 < s.watchCount && s.lastRefresh + t.timeout <= Date.now() && (delete this.data[e], this.save(), this.dirty = !0)
        }, AdsLimits.prototype.notifyUpdated = function () {
            this.trigger("update")
        }, AdsLimits.prototype.update = function () {
            for (var e in AdsLimits.TYPES) this._updateType(AdsLimits.TYPES[e]);
            this.dirty && (this.dirty = !1, this.notifyUpdated())
        }, AdsLimits.prototype.state = function (e) {
            this._updateType(e);
            var t = this.getLimit(e);
            return t.disabled ? AdsLimits.STATE_DISABLED : cleverapps.user.checkAvailable(t.available) ? 0 === this.getLimitLeftCount(e) ? AdsLimits.STATE_LIMITED : cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED) ? AdsLimits.STATE_READY : AdsLimits.STATE_NOADS : AdsLimits.STATE_UNAVAILABLE
        }, AdsLimits.prototype.getLimit = function (e) {
            var t, e = AdsLimits.LIMITS[e] || {
                disabled: !0
            };
            return e && e.nonpayer ? (t = cleverapps.paymentsHistory.classify()) === cleverapps.PaymentsHistory.BRACKET_NONE ? e.nonpayer : t === cleverapps.PaymentsHistory.BRACKET_UNDECIDED ? e.undecided : e.payer : e
        }, AdsLimits.prototype.getLimitLeftTime = function (e) {
            var t = this.data[e] || {
                lastRefresh: 0
            },
                e = this.getLimit(e);
            return Math.max(0, t.lastRefresh + e.timeout - Date.now())
        }, AdsLimits.prototype.getWatchCount = function (e) {
            return this.data[e] && this.data[e].watchCount || 0
        },
            AdsLimits.prototype.getLimitLeftCount = function (e) {
                var t = this.getLimit(e);
                if (t.limit === AdsLimits.UNLIMITED) return 1;
                e = this.data[e] || {
                    watchCount: 0
                };
                return Math.max(0, t.limit - e.watchCount)
            }, AdsLimits.prototype.getLimitLevel = function (e) {
                e = this.getLimit(e);
                return cleverapps.humanReadableNumber({
                    floatLevel: e.available.level
                })
            }, AdsLimits.prototype.watch = function (e) {
                this.data[e] ? this.data[e].watchCount++ : this.data[e] = {
                    watchCount: 1,
                    lastRefresh: Date.now()
                }, this.save(), cleverapps.timeouts.setTimeout(this.update.bind(this), this.getLimit(e).timeout), this.notifyUpdated()
            }, AdsLimits.prototype.reset = function (e) {
                delete this.data[e], this.save()
            }, AdsLimits.STATE_UNAVAILABLE = 0, AdsLimits.STATE_LIMITED = 1, AdsLimits.STATE_NOADS = 2, AdsLimits.STATE_READY = 3, AdsLimits.STATE_DISABLED = 4, AdsLimits.CHECK_INTERVAL = "1 minute", AdsLimits.UNLIMITED = "unlimited", AdsLimits.LIMITS = {}, AdsLimits.TYPES = {
                HARD: "hard",
                WORKER: "worker",
                LIVES: "lives",
                ENERGY_SHORT: "lives_short",
                BARREL: "barrel",
                SPEEDUP: "speedup",
                SPECIAL_OFFER: "special",
                PIXEL: "pixel",
                OPEN_CHEST: "chest",
                BOOSTERS_BEFORE: "before",
                FLYING_HINT: "hint",
                FLYING_STAR: "star",
                FLYING_BOOSTER: "combo",
                FLYING_DISCOVER: "discover",
                FLYING_MOVES: "flying_moves",
                FLYING_HARD_SOFT: "flying_gold",
                TOOLBAR: "toolbar",
                POINTS_SPECIAL_OFFER: "special_points",
                ANIMALS_SPECIAL_OFFER: "special_animals",
                BANK: "bank",
                FREEX2: "freex2",
                PRODUCT: "product",
                CINEMA: "cinema",
                PROLONGATION: "extend",
                CHOICE: "choice",
                ENERGY: "energy",
                ENERGY_2: "energy_2",
                ENERGY_2_SHORT: "energy_short_2",
                ENERGY_1: "energy_1",
                ENERGY_1_SHORT: "energy_short_1",
                ENERGY_3: "energy_3",
                ENERGY_3_SHORT: "energy_short_3",
                BOOSTER_1: "booster_1",
                BOOSTER_2: "booster_2",
                BOOSTER_3: "booster_3"
            }, AdsLimits.initialize = function () {
                AdsLimits.LIMITS = {}, AdsLimits.LIMITS[AdsLimits.TYPES.HARD] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "1 hour" : "12 hours"),
                        limit: 2
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.LIVES] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(
                            cleverapps.config.debugMode ? "10 minutes" : "6 hours"),
                        limit: 3
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.BOOSTERS_BEFORE] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "30 minutes" : "1 day"),
                        limit: 3
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.FLYING_HINT] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "5 minutes" : "15 minutes"),
                        limit: 1,
                        available: {
                            types: ["board"]
                        }
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.FLYING_STAR] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "5 minutes" : "1 hours"),
                        limit: 1,
                        available: {
                            meta: [Metha.SIMPLE]
                        }
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.FLYING_BOOSTER] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "5 minutes" : "15 minutes"),
                        limit: 1,
                        available: {
                            level: .67,
                            types: ["match3"]
                        }
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.FLYING_DISCOVER] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "5 minutes" : "15 minutes"),
                        limit: 1,
                        available: {
                            types: ["differences"]
                        }
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.FLYING_MOVES] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "5 minutes" : "1 hour"),
                        limit: 1,
                        available: {
                            level: 3,
                            types: ["match3", "solitaire"]
                        }
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.FLYING_HARD_SOFT] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "5 minutes" : "1 hour"),
                        limit: 4,
                        available: {
                            level: 2.5
                        }
                    },
                    undecided: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "1 hour" : "22 hours"),
                        limit: 4,
                        available: {
                            level: 2.5
                        }
                    },
                    payer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "1 hour" : "22 hours"),
                        limit: 4,
                        available: {
                            level: 2.5
                        }
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.TOOLBAR] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "5 minutes" : "3 hour"),
                        limit: 10,
                        available: {
                            level: 2.5
                        }
                    },
                    undecided: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "5 minutes" : "22 hours"),
                        limit: 1,
                        available: {
                            level: 2.5
                        }
                    },
                    payer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "5 minutes" : "22 hours"),
                        limit: 1,
                        available: {
                            level: 2.5
                        }
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.PROLONGATION] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "1 minute" : "10 minutes"),
                        limit: 3
                    },
                    undecided: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "10 minute" : "22 hours"),
                        limit: 1,
                        available: {
                            level: 2
                        }
                    },
                    payer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "10 minute" : "22 hours"),
                        limit: 1,
                        available: {
                            level: 2
                        }
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.WORKER] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "1 hour" : "24 hours"),
                        limit: 3,
                        available: {
                            level: 6,
                            types: ["merge"]
                        }
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.ENERGY] = AdsLimits.LIMITS[AdsLimits.TYPES.ENERGY_1] = AdsLimits.LIMITS[AdsLimits.TYPES.ENERGY_2] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "10 minutes" : "1 hour"),
                        limit: 1,
                        available: {
                            level: 7,
                            types: ["merge"]
                        }
                    },
                    undecided: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "10 minutes" : "3 hour"),
                        limit: 1,
                        available: {
                            level: 7,
                            types: ["merge"]
                        }
                    },
                    payer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "10 minutes" : "22 hours"),
                        limit: 1,
                        available: {
                            level: 7,
                            types: ["merge"]
                        }
                    }
                }, AdsLimits.LIMITS[AdsLimits.TYPES.ENERGY_SHORT] = AdsLimits.LIMITS[AdsLimits.TYPES.ENERGY_1_SHORT] = AdsLimits.LIMITS[AdsLimits.TYPES.ENERGY_2_SHORT] = {
                    nonpayer: {
                        timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "30 minutes" : "3 hour"),
                        limit: 10,
                        available: {
                            level: 8,
                            types: ["merge"]
                        }
                    },
                    undecided: {
                        disabled: !0
                    },
                    payer: {
                        disabled: !0
                    }
                },
                    AdsLimits.LIMITS[AdsLimits.TYPES.BARREL] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "3 minute" : "1 hour"),
                            limit: 1,
                            available: {
                                level: 6,
                                types: ["merge"]
                            }
                        },
                        undecided: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "3 minute" : "5 hour"),
                            limit: 1,
                            available: {
                                level: 6,
                                types: ["merge"]
                            }
                        },
                        payer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "3 minute" : "22 hours"),
                            limit: 1,
                            available: {
                                level: 6,
                                types: ["merge"]
                            }
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.SPEEDUP] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "1 minute" : "30 minutes"),
                            limit: 2,
                            available: {
                                types: ["merge"]
                            }
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.SPECIAL_OFFER] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "1 minute" : "10 minutes"),
                            limit: 1,
                            available: {
                                level: 7,
                                types: ["merge"]
                            }
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    },
                    AdsLimits.LIMITS[AdsLimits.TYPES.POINTS_SPECIAL_OFFER] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "5 minutes" : "30 minutes"),
                            limit: 1
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.ANIMALS_SPECIAL_OFFER] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "5 minutes" : "30 minutes"),
                            limit: 1
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.PIXEL] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "1 minute" : "5 minutes"),
                            limit: 1,
                            available: {
                                level: 6,
                                types: ["merge"]
                            }
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.OPEN_CHEST] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode || cleverapps.flags.videoAdsMainMonetization ? "1 minute" : "5 minutes"),
                            limit: 1,
                            available: {
                                level: 6,
                                types: ["merge"]
                            }
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.BANK] = {
                        nonpayer: {
                            timeout: 0,
                            limit: AdsLimits.UNLIMITED,
                            available: {
                                types: ["merge"]
                            }
                        },
                        undecided: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "1 minute" : "3 hour"),
                            limit: 1,
                            available: {
                                types: ["merge"]
                            }
                        },
                        payer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "1 hour" : "22 hours"),
                            limit: 1,
                            available: {
                                types: ["merge"]
                            }
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.BOOSTER_1] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "1 minutes" : "5 minutes"),
                            limit: 1
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.BOOSTER_2] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "2 minutes" : "10 minutes"),
                            limit: 1
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.BOOSTER_3] = {
                        nonpayer: {
                            timeout: cleverapps.parseInterval(cleverapps.config.debugMode ? "3 minutes" : "30 minutes"),
                            limit: 1
                        },
                        undecided: {
                            disabled: !0
                        },
                        payer: {
                            disabled: !0
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.FREEX2] = {
                        timeout: 0,
                        limit: AdsLimits.UNLIMITED,
                        available: {
                            types: ["merge"]
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.PRODUCT] = {
                        timeout: 0,
                        limit: AdsLimits.UNLIMITED
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.CINEMA] = {
                        timeout: 0,
                        limit: AdsLimits.UNLIMITED,
                        available: {
                            types: ["merge"]
                        }
                    }, AdsLimits.LIMITS[AdsLimits.TYPES.CHOICE] = {
                        timeout: 0,
                        limit: AdsLimits.UNLIMITED,
                        available: {
                            types: ["merge"]
                        }
                    }
            }, cc.Node.extend({
                ctor: function (e) {
                    this._super(), this.options = e, this.setAnchorPoint2(), this.updateSize(), this.spine = new cleverapps.Spine(e.spine), this.currSpine = e.spine, this.currSpineId = e.spineId, this.currSfx = e.sfx, this.addChild(this.spine), e.skin && (this.spine.setSkin(e.skin), this.currSkin = e.skin), this.spine.setAnimation(0, Actor.ANIMATIONS.IDLE, !0), this.alive = !0, this.positionStyles = e.boostersAmountPosition ? e.boostersAmountPosition[Game.currentGame.boosters.amountAvailable()] : e, this.updatePosition()
                },
                updateSize: function () {
                    this.setContentSize(this.options.size),
                        this.baseScaleX = this.baseScaleY = 1, this.options.scales && (this.baseScaleX = this.baseScaleY = this.options.scales[cleverapps.resolution.mode]), this.options.scaleX && (this.baseScaleX *= this.options.scaleX), this.options.scaleY && (this.baseScaleY *= this.options.scaleY), this.setScale(this.baseScaleX, this.baseScaleY)
                },
                updatePosition: function () {
                    var e = (e = cleverapps.clone(this.positionStyles, !0)).wideModePositions ? e.wideModePositions[cleverapps.resolution.mode] : e.position;
                    this.setPositionRound(e), this.options.spinePosition ? this.spine.setPositionRound(this.width / 2 + this.options.spinePosition.x, this.height / 2 + this.options.spinePosition.y) : this.spine.setPositionRound(this.width / 2, 0)
                },
                shake: function () {
                    this.stopAllActions(), this.setScale(this.baseScaleX, this.baseScaleY), this.runAction(new cc.Sequence(new cc.ScaleTo(.1, 1.07 * this.baseScaleX, .93 * this.baseScaleY), new cc.ScaleTo(.05, this.baseScaleX, this.baseScaleY)))
                },
                showUpAnimation: function () {
                    this.runStartAnimation();
                    var e = cleverapps.once(function () {
                        this.isStartAnimationInProgress && this.runAction(new cc.CallFunc(function () {
                            this.finishStartAnimation()
                        }.bind(this)))
                    }.bind(this));
                    this.runAction(new cc.Sequence(new cc.DelayTime(2.5), new cc.CallFunc(e)))
                },
                completeAnimationOnResize: function () {
                    this.isStartAnimationInProgress && (this.stopAllActions(), this.isStartAnimationInProgress = !1)
                },
                runStartAnimation: function () {
                    var e = cleverapps.styles.Actor,
                        t = (this.isStartAnimationInProgress = !0, cleverapps.scenes.getRunningScene()),
                        t = (this.basePosition = this.getPosition(), this.getParent().convertToNodeSpace(cc.p(t.width / 2 + e.animation.playerPositions.x, t.height / 2 + e.animation.playerPositions.y)));
                    cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && (t.x -= e.animation.mobileOffsetX), this.setVisible(!0), this.setPositionRound(t.x + this.width, t.y), this.runAction(new cc.MoveTo(.4, t).easing(cc.easeElasticOut(2))), cleverapps.meta.showControlsWhileFocused("panel_controls"), this.runAction(new cc.Sequence(new cc.DelayTime(.9), new cc.CallFunc(function () {
                        this.animate(Actor.ANIMATIONS.HURT)
                    }.bind(this)), new cc.DelayTime(1.2), new cc.CallFunc(function () {
                        this.animate(Actor.ANIMATIONS.HURT)
                    }.bind(this)), new cc.DelayTime(.4)))
                },
                finishStartAnimation: function () {
                    this.stopAllActions(), this.runAction(new cc.Sequence(new cc.MoveTo(.8, this.basePosition), new cc.CallFunc(function () {
                        this.isStartAnimationInProgress = !1
                    }.bind(this))))
                },
                animate: function (t, s) {
                    if (s = s || {}, !this.alive) {
                        if (t !== Actor.ANIMATIONS.REVIVE) return;
                        this.alive = !0
                    }
                    var e; - 1 !== [Actor.ANIMATIONS.DIE, Actor.ANIMATIONS.DIE_IDLE].indexOf(t) && (this.alive = !1), -1 !== [Actor.ANIMATIONS.HURT, Actor.ANIMATIONS.HURT2].indexOf(t) && (-1 !== [Actor.ANIMATIONS.ATTACK1, Actor.ANIMATIONS.ATTACK2, Actor.ANIMATIONS.ATTACK3, Actor.ANIMATIONS.ATTACK4].indexOf(this.animationRunning) && (this.animationRunning = !1), -1 !== [Actor.ANIMATIONS.HURT, Actor.ANIMATIONS.HURT2].indexOf(this.animationRunning) && this.animationStarted < Date.now() - 300 && (this.animationRunning = !1)), -1 !== [Actor.ANIMATIONS.DIE, Actor.ANIMATIONS.DIE_IDLE,
                    Actor.ANIMATIONS.REVIVE, Actor.ANIMATIONS.HEAL, Actor.ANIMATIONS.ENEMY_ATTACK
                    ].indexOf(t) && (this.animationRunning = !1), this.animationRunning || ((e = this.currSfx && !s.noSFX ? this.currSfx[t] : e) && this.runAction(new cc.Sequence(new cc.DelayTime(s.sfxDelay || cleverapps.styles.Actor.sfx.delay), new cc.CallFunc(function () {
                        cleverapps.audio.playSound(e)
                    }))), this.animationRunning = t, this.animationStarted = Date.now(), this.spine.setAnimation(0, t, !1), this.spine.setCompleteListener(function () {
                        var e;
                        this.animationRunning = !1, this.spine.setCompleteListener(), e = s.idleAnimation || (-1 !== [Actor.ANIMATIONS.DIE, Actor.ANIMATIONS.DIE_IDLE].indexOf(t) ? Actor.ANIMATIONS.DIE_IDLE : Actor.ANIMATIONS.IDLE), this.spine.setAnimation(0, e, !0), s.callback && s.callback()
                    }.bind(this)))
                }
            })),
        Competition = (Actor.ANIMATIONS = {}, Actor.ANIMATIONS.ENEMY_ATTACK = "attack", Actor.ANIMATIONS.ATTACK1 = "attack1", Actor.ANIMATIONS.ATTACK2 = "attack2", Actor.ANIMATIONS.ATTACK3 = "attack3", Actor.ANIMATIONS.ATTACK4 = "attack4", Actor.ANIMATIONS.IDLE = "idle",
            Actor.ANIMATIONS.HURT = "hurt", Actor.ANIMATIONS.HURT2 = "hurt2", Actor.ANIMATIONS.DIE = "die", Actor.ANIMATIONS.DIE_IDLE = "die_idle", Actor.ANIMATIONS.HEAL = "heal", Actor.ANIMATIONS.REVIVE = "revive", cleverapps.styles.Actor = {
                sfx: {
                    delay: .7
                },
                animation: {
                    mobileOffsetX: 180,
                    playerPositions: {
                        x: 350,
                        y: -20
                    }
                }
            },
            function (e) {
                this.type = e.type;
                var t = void 0;
                (this.options = e).store && ((t = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION + "_" + this.type)) || -1 === [Mission.TYPE_COMBO, Mission.TYPE_COLLECT_MARK, Mission.TYPE_BURN_NEARBY, Mission.TYPE_LETTER].indexOf(this.type) || (t = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION)), cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.COMPETITION)), t ? (this.results = t.results, e.algo.lastProcessed = t.algorithm) : e.players ? this.results = e.players : this.results = cleverapps.competitionPlayers.listFakePlayers(e.amount), this.player = this.getPlayerById(cleverapps.platform.getUserID()), this.player || (this.player = {
                    player: !0,
                    id: cleverapps.platform.getUserID(),
                    name: cleverapps.friends.getPlayer().name,
                    avatar: cleverapps.friends.getPlayer().avatar,
                    amount: 0
                }, this.results.push(this.player)), void 0 !== e.playerResult && (this.player.amount = e.playerResult), this.running = !0, this.onChangeResultsListeners = {}, this.onLoseListener = function () { }, this.onChangePlaceListener = function () { }, this.updateShownPlace(), this.algorithm = new CompetitionAlgorithm(this, this.options.algo), 0 < this.countFakePlayers() && this.onPlayersAvailable(), this.onAnimateResults = function () { }, this.onGetOpponent = function () { }, this.onGetUserView = function () { }
            }),
        CompetitionPlayers = (Competition.prototype.start = function () {
            this.algorithm.start()
        }, Competition.optionsForTournament = function (e) {
            var t = "tournament",
                s = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION + "_" + t) || {};
            if (e.emptySave || s.level === e.level.getHumanReadableNumber()) {
                var i, n, s = s.results || [];
                if (e.emptySave && (Competition.CLEAN_SAVED(t), i = [.5, .8, 1.1].sort(function () {
                    return Math.random() < .5 ? -1 : 1
                }), (
                    s = cleverapps.competitionPlayers.listPlayers(3) || []).forEach(function (e, t) {
                        e.amount = 0, e.force = i[t]
                    })), !(s.length < 3)) return cleverapps.UI.Avatar.preload(s), n = cleverapps.competitionStatistics.getBoardGameWordOpenByKeypadLengthTime(e.keypad.amountKeys()), {
                        type: t,
                        amount: 3,
                        level: e.level,
                        store: !0,
                        lose: !1,
                        players: s,
                        algo: {
                            noPlayerEpisodeCoef: !0,
                            averageProcessTimeout: cleverapps.parseInterval(n + " seconds"),
                            botAheadPlayerCoef: .25,
                            botAheadPlayerBigDifferenceCoef: .3,
                            bigDistanceLength: 1,
                            offlineProcess: !0,
                            useRealForce: !0,
                            duration: cleverapps.parseInterval("3 hour"),
                            maxResult: e.totalItemsToSolve()
                        }
                    }
            }
        }, Competition.optionsForKnockoutGame = function (e) {
            var t = 10,
                s = ("board" === cleverapps.config.type ? t = cleverapps.competitionStatistics.getBoardGameWordOpenByKeypadLengthTime(e.keypad.amountKeys()) : "differences" === cleverapps.config.type && (t = cleverapps.competitionStatistics.getOneDifferenceFindTime()), cleverapps.meta.getRumble()),
                i = s.getCurrentRound().getOpponent(cleverapps.platform.getUserID()),
                n = (i.force = [.6, .8, 1][s.rounds.length - 1], i.amount = 0, .3),
                o = 1.5,
                a = .5;
            switch (cleverapps.meta.getMainObject().knockoutGame.calcTournamentType()) {
                case KnockoutGame.BOT_CANNOT_WIN_TOURNAMENT:
                    a = 0, o = 2, t = Math.floor(.8 * t);
                    break;
                case KnockoutGame.VERY_EASY_TOURNAMENT:
                    n = .3, o = 2, t = Math.floor(2.5 * t);
                    break;
                case KnockoutGame.EASY_TOURNAMENT:
                    n = .4, o = 1, a = .3, t = Math.floor(1.3 * t);
                    break;
                case KnockoutGame.NORMAL_TOURNAMENT:
                    n = .5, o = 1.2, a = .3, t = Math.floor(1.1 * t);
                    break;
                case KnockoutGame.DIFFICULT_TOURNAMENT:
                    n = .6, o = 1.5, t = Math.floor(.8 * t);
                    break;
                case KnockoutGame.VERY_DIFFICULT_TOURNAMENT:
                    n = .8, o = 1.5, t = Math.floor(.5 * t)
            }
            return {
                type: "knockout",
                amount: 1,
                players: [i],
                algo: {
                    noPlayerEpisodeCoef: !0,
                    averageProcessTimeout: cleverapps.parseInterval(t + " seconds"),
                    botAheadPlayerCoef: n,
                    botAheadPlayerBigDifferenceCoef: .5,
                    playerAheadBotCoef: o,
                    playerAheadBotBigDifferenceCoef: 2,
                    bigDistanceLength: 1,
                    offlineProcess: !1,
                    useRealForce: !0,
                    duration: cleverapps.parseInterval("3 hour"),
                    maxResult: e.totalItemsToSolve(),
                    botFinishCoef: a
                }
            }
        },
            Competition.optionsByMission = function (e) {
                var t = {
                    store: !0,
                    type: e.type,
                    playerResult: e.result,
                    amount: Array.isArray(e.competition.amount) ? cleverapps.Random.random(e.competition.amount[0], e.competition.amount[1], !1) : e.competition.amount
                };
                return t.algo = {
                    start: e.started,
                    finish: e.finishTime()
                }, Object.assign(t.algo, e.competition), t
            }, Competition.prototype.changePlayerId = function (e, t) {
                this.player.id === e && (this.player.id = t);
                for (var s = 0; s < this.results.length; ++s) this.results[s].id === e && (this.results[s].id = t)
            }, Competition.prototype.calcPlace = function () {
                return this.results.sort(function (e, t) {
                    return t.amount !== e.amount ? t.amount - e.amount : "tournament" === this.type && e.event && t.event && e.event !== t.event ? e.event - t.event : e === this.player ? -1 : t === this.player ? 1 : 0
                }.bind(this)), this.results.indexOf(this.player)
            }, Competition.prototype.updatePlayerResult = function (e, t) {
                this.options.algo.maxResult && t > this.options.algo.maxResult && (t = this.options.algo.maxResult);
                for (var s = 0; s < this.results.length; s++)
                    if (
                        this.results[s].id === e && this.results[s].amount !== t) {
                        this.results[s].amount = t, this.results[s].event = Date.now(), this.runChangeResultsListeners(e);
                        break
                    } this.hasPlaceChanged() && this.onChangePlaceListener(), this.getFinishedOpponents().length === this.options.amount && !1 !== this.options.lose && this.onLoseListener()
            }, Competition.prototype.hasPlaceChanged = function () {
                return this.lastShownPlace ? this.lastShownPlace !== this.calcPlace() : (this.lastShownPlace = this.calcPlace(), !1)
            }, Competition.prototype.updateShownPlace = function () {
                this.lastShownPlace = this.calcPlace()
            }, Competition.prototype.getFinishedOpponents = function () {
                return this.results.filter(function (e) {
                    return e.id !== cleverapps.platform.getUserID() && e.amount === this.options.algo.maxResult
                }.bind(this))
            }, Competition.prototype.runChangeResultsListeners = function (t) {
                cleverapps.values(this.onChangeResultsListeners).forEach(function (e) {
                    e(t)
                })
            }, Competition.prototype.stop = function () {
                this.running = !1,
                    delete cleverapps.competitionPlayers.onAvailableListeners[this.type], this.algorithm.stop()
            }, Competition.prototype.onPlayersAvailable = function () {
                var e;
                delete cleverapps.competitionPlayers.onAvailableListeners[this.type], this.running && (e = cleverapps.competitionPlayers.listPlayers(Math.min(this.countFakePlayers(), cleverapps.competitionPlayers.getAmount())), this.replaceFakePlayers(e), 0 < this.countFakePlayers() && (cleverapps.competitionPlayers.onAvailableListeners[this.type] = this.onPlayersAvailable.bind(this)))
            }, Competition.CLEAN_SAVED = function (e) {
                cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.COMPETITION + "_" + e)
            }, Competition.prototype.countFakePlayers = function () {
                var t = 0;
                return this.results.forEach(function (e) {
                    e.fake && t++
                }), t
            }, Competition.prototype.replaceFakePlayers = function (e) {
                for (var t = 0, s = 0; s < this.results.length && t < e.length; s++) {
                    var i = this.results[s];
                    i.fake && (i.id = e[t].id, i.name = e[t].name, i.avatar = e[t].avatar, delete i.fake, t++)
                }
                this.save()
            },
            Competition.prototype.getPlayerById = function (t) {
                return this.results.filter(function (e) {
                    return e.id === t
                })[0]
            }, Competition.prototype.getResults = function () {
                return this.results.slice()
            }, Competition.prototype.save = function () {
                this.options.store && cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.COMPETITION + "_" + this.type, {
                    results: this.results,
                    algorithm: this.algorithm.getData(),
                    level: this.options.level ? this.options.level.getHumanReadableNumber() : void 0
                })
            }, Competition.prototype.onUserInfoChanged = function () {
                this.player.name = cleverapps.friends.getPlayer().name, this.player.avatar = cleverapps.friends.getPlayer().avatar, this.player.id = cleverapps.friends.getPlayer().id, this.save()
            },
            function () {
                this.onAvailableListeners = {}, this.load(), this.reload(), setInterval(this.reload.bind(this), cleverapps.parseInterval(CompetitionPlayers.RELOAD_INTERVAL))
            }),
        CompetitionStatistics = (CompetitionPlayers.prototype.reload = function () {
            var e, t, s;
            this.reloading || (this.reloading = !0, e = function (e) {
                this.reloading = !1,
                    this.players = [];
                for (var t = 0; t < e.length; t++) e[t].id !== cleverapps.platform.getUserID() && e[t].name && 0 < e[t].name.length && this.players.push({
                    id: e[t].id,
                    name: e[t].name,
                    avatar: e[t].avatar
                });
                if (this.save(), 0 < this.players.length)
                    for (var s in this.onAvailableListeners) this.onAvailableListeners[s]()
            }.bind(this), t = function () {
                this.reloading = !1
            }.bind(this), s = "/competitionplayers/?locale=" + cleverapps.settings.language, cleverapps.platform.oneOf(Microsoft) && (s += "&amountPlayers=30"), cleverapps.config.debugMode && (s = "https://riddles.labsystech.ru/riddles-rest" + s), cleverapps.RestClient.get(s, {}, e, t))
        }, CompetitionPlayers.prototype.getAmount = function () {
            return this.players.length
        }, CompetitionPlayers.prototype.listFakePlayers = function (e) {
            for (var t = [], s = 0; s < e; s++) t.push({
                id: Math.round(1e6 * Math.random()),
                name: "player" + s,
                fake: !0
            });
            return t
        }, CompetitionPlayers.prototype.listPlayers = function (e) {
            e = this.players.splice(0, e);
            return this.save(), this.reload(), e
        }, CompetitionPlayers.prototype.load = function () {
            this.players = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION_PLAYERS) || []
        }, CompetitionPlayers.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.COMPETITION_PLAYERS, this.players)
        }, CompetitionPlayers.RELOAD_INTERVAL = "30 minutes", function () {
            this.load()
        }),
        CompetitionAlgorithm = (CompetitionStatistics.prototype.onGameStop = function (e) {
            var t;
            "board" === cleverapps.config.type && e.outcome !== GameBase.OUTCOME_UNKNOWN && (t = Math.floor(e.timer.getTime() / e.board.countTotalWords() / 1e3), this.saveBoardGameWordOpenByKeypadLengthTime(e.keypad.amountKeys(), t))
        }, CompetitionStatistics.prototype._newData = function (e, t) {
            this.data[e] && this._isAppropriateValue(e, t) && (this.data[e] = Math.round(.9 * this.data[e] + .1 * t), this.save())
        }, CompetitionStatistics.prototype._isAppropriateValue = function (e, t) {
            return t > CompetitionStatistics.DEFAULTS[e] / 5 && t < 5 * CompetitionStatistics.DEFAULTS[e]
        }, CompetitionStatistics.prototype.saveBoardGameWordOpenByKeypadLengthTime = function (e, t) {
            this._newData("brd_l" + e, t)
        }, CompetitionStatistics.prototype.getBoardGameWordOpenByKeypadLengthTime = function (e) {
            return e = Math.min(Math.max(e, 4), 9), this.data["brd_l" + e]
        }, CompetitionStatistics.prototype.saveOneDifferenceFindTime = function (e) {
            console.log("save diff time", e), this._newData("diff_time", e)
        }, CompetitionStatistics.prototype.getOneDifferenceFindTime = function () {
            return this.data.diff_time
        }, CompetitionStatistics.prototype.load = function () {
            this.updateInfo(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION_STATISTICS) || {})
        }, CompetitionStatistics.prototype.updateInfo = function (e, t) {
            for (var s in this.data = {}, CompetitionStatistics.DEFAULTS) this.data[s] = (e[s] && this._isAppropriateValue(s, e[s]) ? e : CompetitionStatistics.DEFAULTS)[s];
            t && this.save(!0)
        }, CompetitionStatistics.prototype.getInfo = function () {
            var e, t = {};
            for (e in CompetitionStatistics.DEFAULTS) CompetitionStatistics.DEFAULTS[e] !== this.data[e] && (t[e] = this.data[e]);
            return t
        }, CompetitionStatistics.prototype.save = function (e) {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.COMPETITION_STATISTICS, this.getInfo()), e || cleverapps.synchronizer.addUpdateTask("competitionstatistics")
        }, CompetitionStatistics.DEFAULTS = {
            brd_l4: 8,
            brd_l5: 15,
            brd_l6: 20,
            brd_l7: 30,
            brd_l8: 40,
            brd_l9: 50,
            diff_time: 30
        }, function (e, t) {
            this.competition = e, void 0 === (this.options = t).start && (t.start = Date.now(), t.finish = t.start + t.duration), this.lastProcessed = t.lastProcessed || t.start
        }),
        NotificationView = (CompetitionAlgorithm.prototype.start = function () {
            this.isPrepared() || this.prepareFromScratch(), this.competition.running && (this.intervalProcess(), this.runInterval = setInterval(function () {
                this.competition.running ? this.intervalProcess() : this.stop()
            }.bind(this), this.intervalTimeout()))
        }, CompetitionAlgorithm.prototype.stop = function () {
            this.runInterval && (clearInterval(this.runInterval), this.runInterval = void 0)
        }, CompetitionAlgorithm.prototype.getData = function () {
            return this.lastProcessed
        }, CompetitionAlgorithm.prototype.process = function (e) {
            for (var t = [],
                s = 0; s < this.competition.results.length; s++) {
                var i, n = this.competition.results[s];
                !n.player && Math.random() < this.botProcessProb(n, e) && (this.options.maxResult && n.amount === this.options.maxResult || (i = n.amount + this.processAmount(), this.options.maxResult && i > this.options.maxResult && (i = this.options.maxResult), n.amount !== i && t.push({
                    id: n.id,
                    amount: i
                })))
            }
            if (0 < t.length) {
                for (s = 0; s < t.length; s++) this.competition.updatePlayerResult(t[s].id, t[s].amount);
                this.competition.save()
            }
        }, CompetitionAlgorithm.prototype.isPrepared = function () {
            for (var e = 0; e < this.competition.results.length; e++)
                if (!this.competition.results[e].player) return void 0 !== this.competition.results[e].force;
            return !0
        }, CompetitionAlgorithm.prototype.prepareFromScratch = function () {
            this.competition.results.forEach(function (e) {
                e.player || (e.amount = 0, e.force = Math.floor(Math.random() * (CompetitionAlgorithm.BOT_MAX_FORCE + 1)), this.options.minBotForce && (e.force = Math.max(e.force, this.options.minBotForce)), e.sleep = this.generateSleepPeriod())
            }, this),
                this.competition.save()
        }, CompetitionAlgorithm.prototype.generateSleepPeriod = function () {
            var e, t = this.options.finish - this.options.start;
            if (!(t < cleverapps.parseInterval("1 hour"))) return e = Math.floor(t / 4 + Math.random() * t / 4), t = this.options.start + Math.floor(Math.random() * (t - e)), {
                s: t,
                f: t + e
            }
        }, CompetitionAlgorithm.prototype.offlineCoef = function () {
            return void 0 !== this.options.offlineCoef ? this.options.offlineCoef : .3
        }, CompetitionAlgorithm.prototype.playerAheadBotCoef = function () {
            return void 0 !== this.options.playerAheadBotCoef ? this.options.playerAheadBotCoef : 1
        }, CompetitionAlgorithm.prototype.playerAheadBot5AmountCoef = function () {
            return void 0 !== this.options.playerAheadBotBigDifferenceCoef ? this.options.playerAheadBotBigDifferenceCoef : 2
        }, CompetitionAlgorithm.prototype.botAheadPlayerCoef = function () {
            return void 0 !== this.options.botAheadPlayerCoef ? this.options.botAheadPlayerCoef : .3
        }, CompetitionAlgorithm.prototype.botAheadPlayer5AmountCoef = function () {
            return void 0 !== this.options.botAheadPlayerBigDifferenceCoef ? this.options.botAheadPlayerBigDifferenceCoef : .1
        }, CompetitionAlgorithm.prototype.mediumAmount = function () {
            var e = this.options.step;
            return e && 0 < e.length ? e.reduce(function (e, t) {
                return e + t
            }, 0) / e.length : 1
        }, CompetitionAlgorithm.prototype.processAmount = function () {
            var e = this.options.step;
            return e ? 2 < e.length ? cleverapps.Random.choose(e, !1) : cleverapps.Random.random(e[0], e[1], !1) : 1
        }, CompetitionAlgorithm.prototype.getBotForceCoef = function (e) {
            if (this.options.useRealForce) return e;
            var t = [0, .03, .08, .15, .25, .35, .5, .7, 1, 1.5, 2];
            return (void 0 !== t[e] ? t[e] : 2) * (this.options.forceCoef || 1)
        }, CompetitionAlgorithm.prototype.sleepNow = function (e) {
            return !!e.sleep && (e.sleep.s <= this.lastProcessed && this.lastProcessed <= e.sleep.f)
        }, CompetitionAlgorithm.prototype.bigDistanceLength = function () {
            return this.options.bigDistanceLength || 5
        }, CompetitionAlgorithm.prototype.calcFromBotAmountCoef = function (e) {
            if (!this.options.maxResult || this.options.maxResult < 2) return 1;
            var t = (this.options.maxResult - 1) / 2;
            return 1.25 - .75 * (e.amount - t) / t
        }, CompetitionAlgorithm.prototype.botProcessProb = function (e, t) {
            if (this.sleepNow(e)) return 0;
            var s = this.competition.player.amount,
                t = this.perIntervalProb(t);
            return e.amount >= s ? (t *= this.botAheadPlayerCoef(e), e.amount > s + this.bigDistanceLength() * this.mediumAmount() && (t *= this.botAheadPlayer5AmountCoef(e))) : (t *= this.playerAheadBotCoef(e), s > e.amount + this.bigDistanceLength() * this.mediumAmount() && (t *= this.playerAheadBot5AmountCoef(e))), void 0 !== this.options.botFinishCoef && this.options.maxResult && e.amount + this.mediumAmount() >= this.options.maxResult && (t *= this.options.botFinishCoef), (t *= this.calcFromBotAmountCoef(e)) * this.playerEpisodeCoef() * this.getBotForceCoef(e.force)
        }, CompetitionAlgorithm.prototype.perIntervalProb = function (e) {
            return e ? (this.offlinePerIntervalProb || (this.offlinePerIntervalProb = this.offlineCoef() * this.intervalTimeout(e) / this.maxForceBotAverageProcessTimeout()), this.offlinePerIntervalProb) : (
                this.onlinePerIntervalProb || (this.onlinePerIntervalProb = this.intervalTimeout(e) / this.maxForceBotAverageProcessTimeout()), this.onlinePerIntervalProb)
        }, CompetitionAlgorithm.prototype.intervalTimeout = function (e) {
            return cleverapps.parseInterval(e ? "10 minutes" : "5 seconds")
        }, CompetitionAlgorithm.prototype.freeze = function (e) {
            var t = Date.now();
            this.lastProcessed > t ? this.lastProcessed += e : this.lastProcessed = t + e
        }, CompetitionAlgorithm.prototype.intervalProcess = function () {
            var e = Math.min(Date.now(), this.options.finish);
            if (!(this.lastProcessed > e)) {
                var t = this.intervalTimeout(!0),
                    s = this.intervalTimeout();
                if (!1 !== this.options.offlineProcess)
                    for (; this.lastProcessed < e - 2 * t;) this.lastProcessed += t, this.process(!0);
                for (; this.lastProcessed < e - s / 2;) this.lastProcessed += s, this.process();
                this.lastProcessed = e, this.competition.save()
            }
        }, CompetitionAlgorithm.prototype.maxForceBotAverageProcessTimeout = function () {
            return this.options.averageProcessTimeout || cleverapps.parseInterval("3 minutes")
        },
            CompetitionAlgorithm.prototype.playerEpisodelevel = function () {
                return 10 <= levels.user.episode ? 2 : 5 <= levels.user.episode ? 1 : 0
            }, CompetitionAlgorithm.prototype.playerEpisodeCoef = function () {
                return this.options.noPlayerEpisodeCoef ? 1 : [.1, .13, .15][this.playerEpisodelevel()]
            }, CompetitionAlgorithm.BOT_MAX_FORCE = 10, cleverapps.Notification = function () {
                this.queue = [], this.current = void 0, this.onRemove = function () { }, this.onUpdateProgress = function () { }
            }, cleverapps.Notification.prototype.create = function (t, s) {
                var i;
                ((s = s || {}).debugInfo || this.canShow() && t) && (this.current && t === this.current.msg ? s.progress && this.onUpdateProgress(s.progress.newAmount || s.progress.amount, s.progress.total) : (i = !1, this.queue.forEach(function (e) {
                    e.msg === t && (s.progress && e.options.progress && (s.progress.newAmount ? e.options.progress.newAmount = s.progress.newAmount : e.options.progress = s.progress), i = !0)
                }), i || (this.queue.push({
                    msg: t,
                    options: s
                }), this.queue.length > cleverapps.Notification.MAX_QUEUE && this.queue.shift(), s.defer || this.processQueue())))
            }, cleverapps.Notification.prototype.processQueue = function () {
                var e, t;
                this.current || !this.queue.length || (e = cleverapps.scenes.getRunningScene()) && (t = this.queue.shift(), this.current = {
                    msg: t.msg
                }, t = new NotificationView(this, t.msg, t.options), e.addChild(t))
            }, cleverapps.Notification.prototype.reset = function () {
                this.onRemove(), this.current = void 0
            }, cleverapps.Notification.prototype.clear = function () {
                this.reset(), this.queue = []
            }, cleverapps.Notification.prototype.canShow = function () {
                return !cleverapps.gameModes.noNotifications && (cleverapps.allInitialized && !cleverapps.environment.isLoaderScene() && "playable" !== cleverapps.config.source)
            }, cleverapps.Notification.MAX_QUEUE = 3, cc.Scale9Sprite.extend({
                ctor: function (e, t, s) {
                    var i = bundles.notification.frames.notification_bg,
                        i = (this._super(i, cleverapps.UI.getScale9Rect(i, cleverapps.UI.Scale9Rect.TwoPixelXY)), this.model = e, cleverapps.styles.NotificationView),
                        e = (this.setLocalZOrder(UpMenuContainer.ZORDER + 1), cleverapps.UI.generateOnlyText(t,
                            cleverapps.styles.FONTS.NOTIFICATION_TEXT, s.toReplace)),
                        t = Math.min(.85 * cleverapps.UI.getSceneSize().width, i.maxWidth),
                        n = s.image,
                        o = (n && (n instanceof cc.Node || (n = new cc.Sprite(n)), cleverapps.UI.fitToBox(n, i.image), t -= n.width * n.scale + i.image.margin), i.text.height),
                        a = (s.progress && ((a = this.bar = ScaledProgressBar.Types[i.progress.type].create({
                            barText: {
                                text: s.progress.amount >= s.progress.total ? Messages.get("done") : s.progress.amount + "/" + s.progress.total,
                                font: cleverapps.styles.FONTS.NOTIFICATION_PROGRESS_FONT
                            }
                        })).setLength(i.progress.width), a.setPercentage(s.progress.amount / s.progress.total * 100), a.setAnchorPoint2(), cleverapps.UI.fitToBox(a, {
                            height: i.progress.height
                        }), o -= a.height * a.scale + i.progress.margin), e.width > t && (e.setDimensions(t, 0), e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER)), e.fitTo(void 0, o), this.bar && (e = new cleverapps.Layout([e, this.bar], {
                            margin: i.progress.margin,
                            direction: cleverapps.UI.VERTICAL
                        })), n && (e = new cleverapps.Layout([n, e], {
                            margin: i.image.margin,
                            direction: cleverapps.UI.HORIZONTAL
                        })), this.addChild(e), Math.max(i.minWidth, e.width + 2 * i.padding.x)),
                        t = Math.max(i.minHeight, 2 * (e.height + i.padding.y));
                    this.setContentSize(a, t), e.setPositionRound(e.width / 2 + i.padding.x, e.height / 2 + i.padding.y), this.updatePosition(), s.noSound || cleverapps.audio.playSound(bundles.main.urls.notification_effect), this.show(), this.onShowListener = function () {
                        s.progress && s.progress.newAmount ? this.updateProgress(s.progress.newAmount, s.progress.total, .5) : this.delayAndHide()
                    }.bind(this), this.model.onRemove = this.createListener(this.removeFromParent.bind(this)), this.model.onUpdateProgress = this.createListener(this.updateProgress.bind(this)), s.debugInfo && (this.setLocalZOrder(1e4), this.model.onRemove = function () { }, this.alwaysOn = !0, cleverapps.UI.onPressed(this, function () {
                        cleverapps.meta.isFocused() ? new ErrorWindow(s) : cleverapps.meta.display({
                            focus: "ErrorWindow",
                            action: function (e) {
                                new ErrorWindow(s), cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    }))
                },
                updatePosition: function () {
                    var e = cleverapps.styles.NotificationView,
                        t = cleverapps.UI.getSceneSize();
                    this.base = cc.p(t.width / 2, t.height + this.height / 2), this.target = cc.p(t.width / 2, t.height - e.offsetY), this.showInProgress || this.hideInProgress || this.setPositionRound(this.shown ? this.target : this.base), this.showInProgress && this.show(), this.hideInProgress && this.hide()
                },
                show: function () {
                    var e;
                    this.shown || (e = .2, this.showAction && !this.showAction.isDone() && (e = Math.max(0, this.showAction.getDuration() - this.showAction.getElapsed()), this.stopAction(this.showAction)), this.showInProgress = !0, this.showAction = this.runAction(new cc.Sequence(new cc.MoveTo(e, this.target), new cc.CallFunc(function () {
                        this.shown = !0, this.showInProgress = !1, delete this.showAction, this.onShowListener()
                    }.bind(this)))))
                },
                hide: function () {
                    var e;
                    this.shown && (e = .5, this.hideAction && !this.hideAction.isDone() && (e = Math.max(0, this.hideAction.getDuration() - this.hideAction.getElapsed()), this.stopAction(this.hideAction)), this.hideInProgress = !0, this.hideAction = this.runAction(
                        new cc.Sequence(new cc.MoveTo(e, this.base), new cc.CallFunc(function () {
                            this.shown = !1, this.hideInProgress = !1, delete this.hideAction, this.model.reset(), this.model.processQueue()
                        }.bind(this)))))
                },
                delayAndHide: function () {
                    this.runAction(new cc.Sequence(new cc.DelayTime(3), new cc.CallFunc(this.hide.bind(this))))
                },
                updateProgress: function (s, i, e) {
                    this.bar && this.shown && (this.stopAllActions(), e = e || 0, this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.CallFunc(function () {
                        this.delayAndHide(), this.bar.animatedChange(s / i * 100);
                        var e, t = s + "/" + i;
                        i <= s && (t = Messages.get("done"), cleverapps.audio.playSound(bundles.notification.urls.task_done_sfx), bundles.notification.jsons.bar_flash_json && (e = new cleverapps.Spine(bundles.notification.jsons.bar_flash_json), this.bar.addChild(e), e.setPositionRound(cleverapps.styles.NotificationView.progress.animation), e.setAnimation(0, "animation", !1), e.setCompleteListenerRemove())), this.bar.updateBarText(t)
                    }.bind(this)))))
                }
            })),
        MapScrollView = (cleverapps.overrideFonts(
            cleverapps.styles.FONTS, {
            NOTIFICATION_TEXT: {
                name: "nostroke",
                size: 50,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            }
        }), cleverapps.styles.NotificationView = {
            offsetY: 10,
            text: {
                height: 100
            },
            image: {
                margin: 20,
                width: 200,
                height: 100,
                maxScale: 1.5
            },
            minWidth: 300,
            minHeight: 200,
            maxWidth: 750,
            padding: {
                x: 30,
                y: 40
            },
            progress: {
                margin: 10,
                width: 350,
                height: 30,
                type: "green",
                animation: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: -2
                    }
                }
            }
        }, NotificationView.ZORDER = BaseWindow.WINDOWS_ZORDER + 2, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            NOTIFICATION_PROGRESS_FONT: {
                name: "default",
                size: 26
            }
        }), cc.Node.extend({
            ctor: function () {
                this._super(), this.container = new cc.Node, this.addChild(this.container), this.scheduleUpdate(), this.scrollHandler = new cleverapps.UI.MapScrollHandler(this), this.zoom = 1, this.updateChildren = cleverapps.throttle(25, this.checkChildrenVisibility.bind(this))
            },
            zoomTo: function (t) {
                var s = this.zoom,
                    i = Date.now(),
                    n = (t.zoom - s) / t.timeout;
                this._zoomInterval = setInterval(this.createListener(function () {
                    var e = Date.now() - i;
                    if (e >= t.timeout) return this.setZoom(t.zoom), clearInterval(this._zoomInterval), void (t.onComplete && t.onComplete());
                    this.setZoom(s + n * e, t.centerPoint)
                }), 13)
            },
            setZoom: function (e, t) {
                this.scrollHandler.stopAutoScroll();
                var s, i = cleverapps.UI.getBgSize(),
                    n = this.getContainerSize(),
                    o = (e = Math.max(e, cleverapps.styles.WorldMap.zoom.minScale, i.width / n.width, i.height / n.height), e = Math.min(e, 1.1), this.zoom),
                    e = (this.zoom = e, this.setScale(this.zoom), this.getContainerPosition()),
                    a = (this.setContentSize2(Math.ceil(i.width / this.zoom), Math.ceil(i.height / this.zoom)), 0),
                    r = 0;
                o && (a = Math.ceil(i.width / this.zoom) - Math.ceil(i.width / o), r = Math.ceil(i.height / this.zoom) - Math.ceil(i.height / o)), t && (0 < (s = Math.abs(t.x) + i.width / 2 - n.width / 2) && (0 < t.x ? a -= s : a += s), 0 < (s = Math.abs(t.y) + i.height / 2 - n.height / 2) && (0 < t.y ? r -= s : r += s)), this.setContainerPosition(this.availableScrollPosition({
                    x: e.x + a / 2,
                    y: e.y + r / 2
                }), this.zoom < o)
            },
            setContainerSize: function (e) {
                this.innerWidth = e.width, this.innerHeight = e.height, this.container.setContentSize2(e)
            },
            getContainerSize: function () {
                return this.container.getContentSize()
            },
            getContainerPosition: function () {
                return this.container.getPosition()
            },
            setContainerPosition: function (e, t) {
                e.x === this.container.getPositionX() && e.y === this.container.getPositionY() && !t || (this.container.setPosition(e), this.updateChildren(), this.scrollHandler.afterContainerMove())
            },
            update: function (e) {
                this._super(e), this.scrollHandler.processAutoScroll(e)
            },
            onEnter: function () {
                this._super(), this.addControls()
            },
            checkChildrenVisibility: function () {
                this.container.getChildren().forEach(function (e) {
                    !e.visible && this.isInContainer(e) ? e.visible = !0 : e.visible && !this.isInContainer(e) && (e.visible = !1)
                }, this)
            },
            isInContainer: function (e) {
                var t = cleverapps.styles.MapScrollView.visiblePadding,
                    s = this.getContainerPosition(),
                    i = this.getContentSize(),
                    s = cc.rect(-s.x, -s.y, i.width, i.height),
                    i = e.getBoundingBox(),
                    e = (i.x -= t.width / 2, i.y -= t.height / 2, i.width += t.width / 2, i.height += t.height / 2, cc.rectIntersection(s, i));
                return 0 < e.width && 0 < e.height
            },
            addControls: function () {
                cleverapps.UI.onDrag(this, {
                    onMouseZoom: function (e) {
                        var t = 1;
                        this.zoom <= .3 ? t = .3 : this.zoom <= .5 && (t = .5), this.setZoom(this.zoom + e * t)
                    }.bind(this),
                    onPinchZoom: cc.sys.capabilities.touches && function (e) {
                        this.setZoom(this.zoom + e)
                    }.bind(this),
                    onPressed: function () {
                        this.scrollHandler.stopAutoScroll()
                    }.bind(this),
                    onClick: this.onClick && this.onClick.bind(this),
                    onDragStart: this.onTouchBegan.bind(this),
                    followPointer: this.onTouchMoved.bind(this),
                    onDragEnd: this.onTouchEnded.bind(this)
                })
            },
            onTouchBegan: function () {
                return this.container.stopAllActions(), this.scrollHandler.handlePress(), !0
            },
            onTouchMoved: function (e) {
                var t = this.convertToNodeSpace(e.getLocation()),
                    e = this.convertToNodeSpace(e.getPreviousLocation()),
                    t = cc.pSub(t, e);
                this.scrollHandler.gatherMoveData(t), this.moveContainer(t)
            },
            onTouchEnded: function (e) {
                var t = this.convertToNodeSpace(e.getLocation()),
                    e = this.convertToNodeSpace(e.getPreviousLocation()),
                    t = cc.pSub(t, e);
                this.scrollHandler.handleRelease(t)
            },
            moveContainer: function (e) {
                e = cc.pAdd(this.getContainerPosition(), e);
                this.setContainerPosition(e)
            }
        })),
        PagesViewParallax = (cleverapps.styles.MapScrollView = {
            visiblePadding: {
                width: 40,
                height: 40
            }
        }, function (e, t, s) {
            if (this.parallaxBackgrounds = [], this.direction = s, e && e.layers) {
                for (var s = cleverapps.UI.getSceneSize(), i = ("scene" === e.width ? s : e).width, n = ("scene" === e.height ? s : e).height, o = 0; o < e.layers[cleverapps.resolution.mode]; o++) {
                    var a, r = bundles.main.urls["episodes_bg_jpg_" + o];
                    r && ((a = new ParallaxBackground(e.speed[o], this.direction, function () {
                        var e, t = new cc.Node;
                        return t.setContentSize2(i, n), t.setAnchorPoint2(), r && ((e = new cc.Sprite(r)).setPositionRound(t.width / 2, t.height / 2), this.parallaxBackgrounds.push(e), t.addChild(e)), t
                    }.bind(this))).setLocalZOrder(e.zIndex[o]), t.addChild(a))
                }
                this.updateScale()
            }
        }),
        ParallaxBackground = (PagesViewParallax.prototype.updateScale = function () {
            var s = cleverapps.UI.getSceneSize();
            this.parallaxBackgrounds.forEach(function (e) {
                var t = Math.max(s.width / e.width, s.height / e.height);
                e.setScale(t)
            })
        },
            cc.Node.extend({
                ctor: function (e, t, s) {
                    this._super(), this.ratio = e, this.direction = t;
                    e = this.frame1 = new ParallaxFrame(s(0), cc.p(0, 0), t), this.addChild(e), s = this.frame2 = new ParallaxFrame(s(1), cc.p(e.width - 2, e.height - 2), t);
                    this.addChild(s), this.scheduleUpdate()
                },
                onEnterTransitionDidFinish: function () {
                    this._super(), this.updatePosition()
                },
                update: function (e) {
                    this._super(e), this.updatePosition()
                },
                updatePosition: function () {
                    this.y = -this.parent.y * (1 - this.ratio), this.x = -this.parent.x * (1 - this.ratio), this.frame1.updatePosition(), this.frame2.updatePosition()
                }
            })),
        ParallaxFrame = cc.Node.extend({
            ctor: function (e, t, s) {
                this._super(), this.direction = s, this.offset = t, this.frame = e, this.addChild(e), this.setContentSize2(e.getContentSize()), this.setAnchorPoint2(), this.setPositionRound(this.width / 2, this.height / 2)
            },
            updatePosition: function () {
                var e, t = cleverapps.UI.getSceneSize(),
                    s = this.frame,
                    i = s.width,
                    n = s.height;
                this.direction === PagingScrollView.DIRECTIONS.Horizontal ? (e = -(this.parent.parent.x + this.parent.x), s.x = Math.floor(
                    e / i) * i + i / 2 + this.offset.x, s.y = n / 2, s.visible = 0 <= -e + s.x + i / 2 && -e + s.x - i / 2 < t.width) : (e = -(this.parent.parent.y + this.parent.y), s.x = i / 2, s.y = Math.floor(e / n) * n + n / 2 + this.offset.y, s.visible = 0 <= -e + s.y + n / 2 && -e + s.y - n / 2 < t.height)
            }
        }),
        Fireworks = cc.Node.extend({
            ctor: function (e, t) {
                switch (this._super(), t = t || {}, this.count = 0, this.state = Date.now(), this.window = e, this.type = t.type || "confetti", this.type) {
                    case "fireworks":
                        this.sound = t.sound || bundles.fireworks.urls.fireworks_effect, this.json = t.json || bundles.fireworks.jsons.fireworks_json;
                        break;
                    case "confetti":
                        this.sound = t.sound || bundles.fireworks.urls.confetti_effect, this.json = t.json || bundles.fireworks.jsons.confetti_json
                }
                this.setAnchorPoint2(), this.started = !1, this.ready = !1, this.updateSize(), this.updatePosition()
            },
            start: function (e) {
                this.started || (this.started = !0, this.ready = !1, this.stopAllActions(), this.runAction(new cc.Sequence(new cc.DelayTime(e || 0), new cc.CallFunc(function () {
                    this.ready = !0, this.process()
                }.bind(this)))))
            },
            stop: function () {
                this.started && (
                    this.stopAllActions(), this.started = !1)
            },
            onEnter: function () {
                this._super(), cleverapps.bundleLoader.loadBundle("fireworks", {
                    onSuccess: function () {
                        this.process()
                    }.bind(this)
                })
            },
            onExit: function () {
                this._super(), cleverapps.bundleLoader.deleteBundle("fireworks")
            },
            updateSize: function () {
                var e = cleverapps.UI.getSceneSize(),
                    t = (e.width - this.width) / 2,
                    s = (e.height - this.height) / 2;
                this.setContentSize(e), this.children.forEach(function (e) {
                    e.setPosition(e.x + t, e.y + s)
                })
            },
            updatePosition: function () {
                var e = cleverapps.UI.getSceneSize();
                this.setPositionRound(e.width / 2, e.height / 2)
            },
            process: function () {
                var e;
                this.started && this.ready && cleverapps.bundleLoader.isLoaded("fireworks") && ("confetti" === this.type ? e = this.confettiAnimation() : "fireworks" === this.type && (e = this.fireworksAnimation()), this.count += 1, e && (this.stopAllActions(), this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.CallFunc(this.process.bind(this))))))
            },
            confettiAnimation: function () {
                var e = new cleverapps.Spine(this.json); - 1 === ["heroes", "tropical"].indexOf(
                    cleverapps.config.ui) && cleverapps.UI.fitToBox(e, {
                        minScale: .6,
                        width: this.parent.width
                    }), e.setAnimation(0, "animation1", !1), e.setCompleteListenerRemove(), e.setPositionRound(this.width / 2, this.height / 2), this.addChild(e), cleverapps.audio.playSound(this.sound)
            },
            fireworksAnimation: function () {
                var e = cleverapps.styles.Fireworks.fireworks,
                    t = cleverapps.Random.state,
                    s = (cleverapps.Random.seed(this.state), this.delays && this.delays.length || (this.delays = cleverapps.arrayFill(cleverapps.Random.random(5, 10), 0).map(function (e, t) {
                        return 0 === t ? Fireworks.DELAYS.intermission + cleverapps.Random.random(0, 2e3) : Fireworks.DELAYS.sequentBase + cleverapps.Random.random(0, Fireworks.DELAYS.sequentRandom)
                    })), this.delays.pop()),
                    i = (s = s * cleverapps.Random.random(.8, 1.1, .1) / 1e3, cc.rect(this.count % 2 ? (this.width + this.window.width) / 2 : 0, this.height / 2 - e.bottom, (this.width - this.window.width) / 2, e.bottom + e.top));
                if (i.width < e.minWidth) return s;
                var e = new cleverapps.Spine(this.json),
                    n = (e.setCascadeColorEnabled(!0), e.setColor(
                        cleverapps.Random.choose(Fireworks.COLORS)), e.setAnimation(0, cleverapps.Random.choose(e.listAnimations()), !1), e.setCompleteListenerRemove(), this.addChild(e), i = cc.rectSubPadding(i, cc.padding(e.height / 2, e.width / 2)), cleverapps.Random.choose([-1, 1])),
                    o = cleverapps.Random.random(i.x, i.x + i.width),
                    i = cleverapps.Random.random(i.y, i.y + i.height);
                return e.setScaleX(n), e.setAnchorPoint2(), e.setPositionRound(o, i), this.state = cleverapps.Random.state, cleverapps.Random.state = t, cleverapps.audio.playSound(this.sound, {
                    throttle: 0
                }), s
            }
        }),
        FingerView = (Fireworks.DELAYS = {
            sequentBase: 3e3,
            sequentRandom: 500,
            intermission: 12e3
        }, Fireworks.COLORS = [cc.color(50, 245, 247, 255), cc.color(160, 255, 114, 255), cc.color(255, 255, 0, 255), cc.color(255, 54, 54, 255), cc.color(255, 164, 248, 255)], cleverapps.styles.Fireworks = {
            fireworks: {
                top: 500,
                bottom: 150,
                minWidth: 400
            }
        }, cc.Node.extend({
            ctor: function (e) {
                e = e || {}, this._super(), this.setAnchorPoint2(), this.finger = new cc.Sprite(e.image || bundles.finger.frames.tutorial_hand_png),
                    this.finger.setPositionRound(0, 0), this.addChild(this.finger);
                var t = cleverapps.styles.FingerView,
                    e = t[e.name] || t.default;
                this.finger.setAnchorPoint2(e.anchorX, e.anchorY), cleverapps.gameModes.showFingerAnchor && this.showAnchorPoint(), this.setCascadeOpacityEnabledRecursively(!0), this.scheduleUpdateWithPriority(2)
            },
            clear: function () {
                delete this.actions, delete this.options
            },
            updateSize: function () {
                this.reset()
            },
            reset: function () {
                if (this.finger.stopAllActions(), this.finger.setVisible(!1), this.pressed = !1, this.pathNode && this.pathNode.reset(), this.payload && (this.payload.stopAllActions(), this.payload.setVisible(!1)), this.path)
                    for (var e = 0; e < this.path.length; ++e) {
                        var t = this.path[e];
                        t.unselect && t.unselect()
                    }
                this.play(this.options)
            },
            update: function () {
                var e, t = this.target;
                t && (t.node.isRunning() ? (this.skipLoop || (e = cleverapps.meta.checkEventNode(t.node) && t.node.isDisplayed(), this.setVisible(e)), e = this.parent.convertToNodeSpace(t.node.convertToWorldSpace(t.position)), this.setPosition(e.x + this.targetOffset.x,
                    e.y + this.targetOffset.y)) : FingerView.remove(this))
            },
            rotateIfDoesNotFit: function (e) {
                for (var t = e.node; t; t = t.parent)
                    if ("undefined" != typeof Map2dView && t instanceof Map2dView) return;
                var s = cleverapps.scenes.getRunningScene(),
                    e = s.convertToNodeSpace(e.node.convertToWorldSpace(e.position)),
                    i = (e.y -= this.finger.height * this.finger.anchorY, e.x += this.finger.width * this.finger.anchorX, 0);
                e.x >= s.width ? i = e.y <= 0 ? 170 : 90 : e.y <= 0 && (i = -80), this.finger.setRotation(i)
            },
            enablePath: function (e) {
                this.pathNode = new cleverapps.Path(cc.color(e.r, e.g, e.b, FingerView.PATH_BASE_ALPHA)), this.pathNode.lineWidth = FingerView.PATH_LINE_WIDTH, this.pathNode.setLocalZOrder(-2), this.addChild(this.pathNode), this.pathNode.runAction(new cc.RepeatForever(new cc.Sequence(new cc.DelayTime(.02), new cc.CallFunc(function () {
                    this.pathNode.draw(this.finger.getPosition())
                }.bind(this)))))
            },
            fadeIn: function () {
                var e = cleverapps.styles.FingerView;
                return this.finger.setOpacity(0), this.finger.setScale(1), new cc.Spawn(new cc.Show, new cc.MoveBy(0, 0,
                    e.offsetY), new cc.FadeIn(.3), new cc.MoveBy(.3, 0, -e.offsetY))
            },
            fadeOut: function () {
                var e = cleverapps.styles.FingerView;
                return new cc.Sequence(new cc.Spawn(new cc.FadeOut(.3), new cc.MoveBy(.3, 0, e.offsetY)), new cc.Hide)
            },
            press: function () {
                return new cc.Sequence(new cc.Spawn(new cc.RotateBy(.2, FingerView.FINGER_CLICKED_ANGLE), new cc.ScaleTo(.2, .7)), new cc.CallFunc(function () {
                    this.pressed = !0, this.pathNode && (this.pathNode.reset(), this.pathNode.push(this.finger.getPosition()))
                }.bind(this)))
            },
            release: function () {
                return new cc.Sequence(new cc.Spawn(new cc.RotateBy(.2, -FingerView.FINGER_CLICKED_ANGLE), new cc.ScaleTo(.2, 1)), new cc.CallFunc(function () {
                    this.pressed = !1, this.pathNode && this.pathNode.animateFadeOut(400)
                }.bind(this)))
            },
            moveTo: function (t, s) {
                return "number" != typeof t && (t = this.getMoveDuration(t, s)), new cc.Sequence(new cc.CallFunc(function () {
                    var e = this.convertToNodeSpace(s.node.convertToWorldSpace(s.position));
                    0 === t && this.rotateIfDoesNotFit(s), this.setTarget(s),
                        this.payload && this.payload.runAction(new cc.MoveTo(t, e)), this.finger.runAction(new cc.MoveTo(t, e))
                }.bind(this)), new cc.DelayTime(t), new cc.CallFunc(function () {
                    this.pathNode && this.pressed && this.pathNode.push(this.finger.getPosition())
                }.bind(this)))
            },
            prepareTarget: function (e) {
                if (e.node && e.position) return {
                    node: e.node,
                    position: e.position
                };
                if (e instanceof FingerView) return {
                    node: this,
                    position: this.finger.getPosition()
                };
                if (e instanceof cc.Node) return {
                    node: e,
                    position: cc.p(e.width / 2, e.height / 2)
                };
                if ("undefined" != typeof BaseBlock && e instanceof BaseBlock) return {
                    node: cleverapps.scenes.getRunningScene().keypadView,
                    position: BaseBlockView.alignInTheGrid(e.x, e.y),
                    select: function () {
                        e.highlight()
                    },
                    unselect: function () {
                        e.unhighlight()
                    }
                };
                if ("undefined" != typeof DifferenceArea && e instanceof DifferenceArea) return {
                    node: cleverapps.scenes.getRunningScene().photos.imageB,
                    position: PhotoViews.FrameSizeAndPos(e)
                };
                var t = Game.currentGame && Game.currentGame.map && Game.currentGame.map.getView();
                if (t) return {
                    node: t.animations,
                    position: t.getUnitCenterPos(e.x, e.y)
                };
                t = Game.currentGame && Game.currentGame.battlefield && Game.currentGame.battlefield.onGetView();
                if (t) return {
                    node: t,
                    position: e
                };
                t = Game.currentGame && Game.currentGame.fieldController && Game.currentGame.fieldController.fieldView;
                if (t) return {
                    node: t,
                    position: Array.isArray(e) ? BaseCellView.alignInTheGrid(e[0], e[1]) : BaseCellView.alignInTheGrid(e.col, e.row)
                };
                t = Game.currentGame && Game.currentGame.grid && Game.currentGame.grid.getView();
                if (t) return {
                    node: t,
                    position: GridView.cellToPosition(e)
                };
                if (cleverapps.config.debugMode) throw "unknown finger target";
                return e
            },
            setTarget: function (e) {
                this.target = e, this.targetOffset = cc.pSub(this.getPosition(), this.parent.convertToNodeSpace(e.node.convertToWorldSpace(e.position)))
            },
            zigzagTo: function (e) {
                function t(e, t, s) {
                    var i = n(e, t),
                        t = -1 / ((t.y - e.y) / (t.x - e.x));
                    return cc.p(i.x + Math.cos(Math.atan(t)) * s, i.y + Math.sin(Math.atan(t)) * s)
                }
                var s = this.finger.getPosition(),
                    n = (e instanceof cc.Node && (e = this.convertToNodeSpace(
                        e.convertToWorldSpace(cc.p(e.width / 2, e.height / 2)))), function (e, t) {
                            return cc.p((e.x + t.x) / 2, (e.y + t.y) / 2)
                        }),
                    i = .618 * Math.sqrt(Math.pow(e.x - s.x, 2) + Math.pow(e.y - s.y, 2)),
                    o = .618 * -i,
                    a = n(s, e),
                    i = t(s, a, i),
                    o = t(a, e, o);
                return new cc.Sequence(new cc.BezierTo(1.3, [s, i, a]).easing(cc.easeSineIn()), new cc.BezierTo(.8, [a, o, e]).easing(cc.easeQuinticActionOut()))
            },
            relax: function (e) {
                return new cc.MoveBy(e, cc.p(80, -80)).easing(cc.easeBackOut())
            },
            dislodge: function (e, t) {
                return new cc.MoveBy(e, t).easing(cc.easeBackOut(3))
            },
            circle: function () {
                return new cc.CallFunc(function () {
                    var e;
                    this.visible && ((e = new cc.Sprite(bundles.finger.frames.tutorial_click_png)).setPosition(this.finger.x, this.finger.y), e.setScale(0), e.setLocalZOrder(-1), this.addChild(e), e.runAction(new cc.Sequence(new cc.PlaySound(bundles.finger.urls.press_effect), new cc.DelayTime(.2), new cc.FadeOut(.3), new cc.RemoveSelf)), e.runAction(new cc.ScaleTo(.5, 1)))
                }.bind(this))
            },
            showPayload: function (e) {
                var t = this.payload = e.payload,
                    s = (t.replaceParentSamePlace(this, {
                        keepScale: !0
                    }), t.setVisible(!1), t.setLocalZOrder(-1), t.getScale());
                return new cc.TargetedAction(t, new cc.Sequence(new cc.ScaleTo(0, s), new cc.Show, new cc.ScaleTo(.2, e.payloadScale || 1.3 * s)))
            },
            hidePayload: function (e) {
                return new cc.TargetedAction(e, new cc.Hide)
            },
            calculateActions: function (e) {
                return e.map(function (e) {
                    return "function" == typeof e ? e() : e
                })
            },
            play: function (e) {
                var t;
                e = e || {}, this.actions = e.actions || this.actions, this.actions && (t = this.calculateActions(this.actions), (e.callback || e.runOnce) && t.push(new cc.CallFunc(function () {
                    e.keepShown || FingerView.remove(this), e.callback && e.callback()
                }.bind(this))), t = new cc.Sequence(t), e.callback || e.runOnce ? this.finger.runAction(t) : (this.stopAllActions(), this.finger.runAction(new cc.Sequence(new cc.DelayTime(e.repeatDelay || .8), t, new cc.CallFunc(this.play.bind(this, e))))))
            },
            hintClick: function (i, e) {
                this.options = e = e || {}, i = cleverapps.toArray(i).map(function (e) {
                    return this.prepareTarget(e)
                }.bind(this)), this.actions = [], this.setTarget(i[0]),
                    e.delay && this.actions.push(new cc.DelayTime(e.delay)), e.loopFilter && this.actions.push(new cc.CallFunc(function () {
                        this.skipLoop = !e.loopFilter(), this.skipLoop && this.setVisible(!1)
                    }.bind(this))), i.forEach(function (e, t) {
                        this.actions.push(new cc.DelayTime(.2)), this.actions.push(this.moveTo.bind(this, 0, e)), this.actions.push(this.fadeIn());
                        for (var s = 0; s < 2; s++) this.actions.push(new cc.DelayTime(.1)), this.actions.push(this.press()), this.actions.push(this.circle()), this.actions.push(new cc.DelayTime(.1)), this.actions.push(this.release());
                        this.actions.push(this.fadeOut()), t !== i.length - 1 && this.actions.push(new cc.DelayTime(1.4))
                    }.bind(this)), this.play(e)
            },
            hintDrag: function (e, t) {
                this.options = t = t || {}, e = this.path = e.map(function (e) {
                    return this.prepareTarget(e)
                }, this), this.actions = [];
                var s = e[0];
                this.setTarget(s), t.delay && this.actions.push(new cc.DelayTime(t.delay)), this.actions.push(new cc.DelayTime(.2)), this.actions.push(this.moveTo.bind(this, 0, s)), this.actions.push(new cc.DelayTime(.1)),
                    this.actions.push(this.fadeIn()), this.actions.push(this.press()), this.actions.push(this.circle()), s.select && this.actions.push(new cc.CallFunc(s.select)), this.actions.push(new cc.DelayTime(.2)), t.payload && this.actions.push(this.showPayload(t));
                for (var i = 1; i < e.length; ++i) s = e[i], this.actions.push(this.moveTo.bind(this, e[i - 1], s)), s.select && this.actions.push(new cc.CallFunc(s.select));
                for (this.actions.push(this.release()), t.payload && this.actions.push(this.hidePayload(t.payload)), i = 0; i < e.length; ++i)(s = e[i]).unselect && this.actions.push(new cc.CallFunc(s.unselect));
                this.actions.push(this.fadeOut()), this.play(t)
            },
            getMoveDuration: function (e, t, s) {
                e = this.convertToNodeSpace(e.node.convertToWorldSpace(e.position)), t = this.convertToNodeSpace(t.node.convertToWorldSpace(t.position));
                e = cc.pDistance(e, t) / (s || cleverapps.styles.FingerView.speed);
                return ((e = Math.pow(2, 3 * e)) - 1) / (e + 1)
            },
            showAnchorPoint: function () {
                var e = new cc.Sprite(bundles.wysiwyg.frames.pixel_png),
                    t = (e.setColor(cc.color(0, 255, 0, 0)), e.setScale(
                        15), this.finger.addChild(e), this.finger.width * this.finger.anchorX * this.finger.scaleX),
                    s = this.finger.height * this.finger.anchorY * this.finger.scaleY;
                e.setPositionRound(t, s)
            }
        })),
        Timeouts = (FingerView.isRunning = function (e) {
            return e && FingerView.currentFinger === e
        }, FingerView.remove = function (e, t) {
            FingerView.isRunning(e) && (FingerView.currentFinger = void 0, e.isRunning() && (e.clear(), e.stopAllActions(), e.finger.stopAllActions(), t ? e.removeFromParent() : e.runAction(new cc.Sequence(new cc.FadeOut(.2), new cc.RemoveSelf))))
        }, FingerView.create = function (e) {
            var t = new FingerView(e = e || {});
            return FingerView.remove(FingerView.currentFinger), FingerView.currentFinger = t, cleverapps.scenes.getRunningScene().addChild(t), t.setRotation(e.rotation || 0), t.setScale(e.scale || 1), t.setLocalZOrder(BaseWindow.WINDOWS_ZORDER + 1e4), addCleaner(t, function () {
                FingerView.remove(t)
            }), t
        }, FingerView.hintClick = function (e, t) {
            t = t || {};
            var s = FingerView.create();
            return s.hintClick(e, t), s
        }, FingerView.hintDrag = function (e, t) {
            t = t || {};
            var s = FingerView.create();
            return t.pathColor && s.enablePath(t.pathColor), s.hintDrag(e, t), s
        }, FingerView.PATH_BASE_ALPHA = 255, FingerView.PATH_LINE_WIDTH = 15, FingerView.FINGER_CLICKED_ANGLE = 7, cleverapps.styles.FingerView = {
            speed: 500,
            offsetY: 5,
            default: {
                anchorX: .1,
                anchorY: .9
            }
        }, function () {
            "cocos2d" === engine ? this.__instanceId = classManager.getNewInstanceId() : cc.director.getScheduler().enableForTarget(this), this.time = 0, this.uid = 1, this.listeners = Object.create(null), cc.director.getScheduler().scheduleUpdate(this, cc.Scheduler.PRIORITY_SYSTEM, !1)
        }),
        clearTimeoutSuper = (Timeouts.prototype.getTime = function () {
            return this.time
        }, Timeouts.prototype.update = function (e) {
            for (var t in this.time += e = (e *= 1e3) < 0 ? 0 : e, this.listeners) {
                var s = this.listeners[t];
                s ? (s.timeLeft <= 0 && (void 0 === s.interval ? delete this.listeners[t] : s.timeLeft = s.interval, s.callback()), s.timeLeft -= e) : (cleverapps.throwAsync("empty listener for timeout " + t), delete this.listeners[t])
            }
        }, Timeouts.prototype.setTimeout = function (e, t, s) {
            e = {
                uid: this.uid,
                callback: e,
                timeLeft: t || 0
            };
            return s && s.interval && (e.interval = t || 0), this.listeners[this.uid] = e, this.uid += 1, e
        }, Timeouts.prototype.setInterval = function (e, t) {
            return this.setTimeout(e, t, {
                interval: !0
            })
        }, Timeouts.prototype.clearTimeout = function (e) {
            e && e.uid && delete this.listeners[e.uid]
        }, Timeouts.prototype.clearInterval = function (e) {
            this.clearTimeout(e)
        }, cleverapps.CountDownView = cc.Node.extend({
            ctor: function (e, t) {
                this.style = t || {}, this._super(), this.setAnchorPoint(.5, .5), this.countDown = "number" == typeof e ? this.createStaticCountdown(e) : e, this.style.bar ? s = this.createBar() : this.style.background_content ? s = this.style.background_content : this.style.background && (s = cleverapps.UI.createScale9Sprite(this.style.background.frame, cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(this.style.background.width || s.width, this.style.background.height || s.height), s && (s.setCascadeOpacityEnabled(!0), s.setCascadeColorEnabled(!0), s.setAnchorPoint2(), s.setPositionRound(0, 0), this.addChild(s));
                var s, i,
                    t = this.leftTimeText = new cc.Node,
                    e = (t.setCascadeOpacityEnabled(!0), t.setCascadeColorEnabled(!0), t.setAnchorPoint2(), this.addChild(t), this.refresh(), this.style.timerPosition || {
                        x: 0,
                        y: 0
                    });
                t.setPositionRound(e.x, e.y), this.style.icon && (this.style.icon.json ? ((i = new cleverapps.Spine(this.style.icon.json)).setAnimation(0, this.style.icon.animation, !0), this.style.icon.stopped && i.clearTrack(0)) : i = new cc.Sprite(this.style.icon.frame || this.style.icon), s ? (i.setPositionRound(-s.width * s.scaleX / 2, 0), t.setPositionRound(t.x + i.width / 4 + cleverapps.styles.CountDownView.textOffsetX, t.y)) : (i.setPositionRound(-t.width * t.scaleX / 2, 0), t.setPositionRound(t.x + .65 * i.width, t.y)), this.addChild(i)), cleverapps.UI.wrap(this), this.countDown.onSecond = this.createListener(this.refresh.bind(this))
            },
            createBar: function () {
                var e = this.bar = new ScaledProgressBar(this.style.bar.type),
                    t = (e.setLength(this.style.bar.width), this.countDown.getTimeLeft());
                return e.fullValue = this.style.bar.fullValue || t, e.setPercentage(this.calcBarPercentage(t, e.fullValue)), e
            },
            calcBarPercentage: function (e, t) {
                return 100 * (this.style.bar.reversed ? 1 - e / t : e / t)
            },
            createStaticCountdown: function (e) {
                return {
                    onSecond: function () { },
                    onFinish: function () { },
                    getTimeLeft: function () {
                        return e
                    },
                    stop: function () { },
                    remove: function () { }
                }
            },
            fitTo: function (e, t) {
                this.fitToSize = {
                    width: e,
                    height: t
                }, this.text && this.text.fitTo(e, t)
            },
            recreateText: function (e) {
                this.text && this.text.removeFromParent(!0), cleverapps.UI.ImageFont.IsApplicable(this.style.font, e) ? this.text = new cleverapps.UI.ImageFont(e, this.style.font, {
                    fixedNumberWidth: !0
                }) : this.text = cleverapps.UI.generateOnlyText(e, this.style.font), this.leftTimeText.width && this.leftTimeText.height || this.leftTimeText.setContentSize2(this.text.width * this.text.scaleX, this.text.height * this.text.scaleY), this.text.setPositionRound(this.leftTimeText.width / 2, this.leftTimeText.height / 2), this.leftTimeText.addChild(this.text)
            },
            setString: function (e) {
                this.text ? cleverapps.UI.ImageFont.intertypeSetString({
                    textObj: this.text,
                    string: e,
                    font: this.style.font,
                    recreateFunc: this.recreateText.bind(this)
                }) : this.recreateText(e)
            },
            updateBar: function () {
                this.bar.fullValue > cleverapps.CountDownView.BAR_ANIMATION_LIMIT ? this.bar.setPercentage(this.calcBarPercentage(this.countDown.getTimeLeft(), this.bar.fullValue)) : this.bar.animatedChange(this.calcBarPercentage(this.countDown.getTimeLeft(), this.bar.fullValue), {
                    time: 1,
                    easing: !1
                })
            },
            refresh: function () {
                var e = cleverapps.intervalToString(this.countDown.getTimeLeft(), this.style.showHours);
                this.setString(e), this.text && this.fitToSize && this.text.fitTo(this.fitToSize.width, this.fitToSize.height), this.bar && this.updateBar()
            },
            whatToDoOnStop: function () {
                this.countDown.permanent ? this.countDown.onSecond = function () { } : this.countDown.remove()
            },
            cleanup: function () {
                this._super(), this.whatToDoOnStop()
            }
        }), cleverapps.CountDown = function (e, t) {
            this.onSecond = function () { }, this.onFinish = (t = t || {}).onFinish || function () { }, this.onTick = t.onTick || function () { }, this.permanent = t.permanent, this.ignorePaused = t.ignorePaused,
                e <= 0 ? this.onFinish() : this.resetTimeLeft(e)
        }, cleverapps.CountDown.prototype.remove = function () {
            void 0 !== this.interval && cleverapps.CountDownManager.removeListener(this.interval), this.interval = void 0, this.onFinish = function () { }, this.onTick = function () { }, this.onSecond = function () { }
        }, cleverapps.CountDown.prototype.stop = function () {
            this.remove(), this.timeStop = Date.now()
        }, cleverapps.CountDown.prototype.isRunning = function () {
            return void 0 !== this.interval
        }, cleverapps.CountDown.prototype.getTimeLeft = function () {
            return this.timeFinish ? this.timeStop ? this.timeFinish - this.timeStop : Math.max(this.timeFinish - Date.now(), 0) : 0
        }, cleverapps.CountDown.prototype.resetTimeLeft = function (e) {
            this.timeStart = Date.now(), this.timeFinish = this.timeStart + e, void 0 === this.interval && (this.interval = cleverapps.CountDownManager.addListener(this))
        }, cleverapps.CountDown.prototype.nextSecond = function (e) {
            e = this.timeFinish - e;
            this.onTick(e = e < 0 ? 0 : e), this.onSecond(e), 0 === e && (cleverapps.CountDownManager.removeListener(this.interval),
                this.interval = void 0, this.onFinish())
        }, cleverapps.Interval = function (e, t, s) {
            (s = s || {}).onTick = cleverapps.accumulate(t, e), cleverapps.CountDown.call(this, cleverapps.parseInterval("120 months"), s)
        }, cleverapps.Interval.prototype = Object.create(cleverapps.CountDown.prototype), cleverapps.Interval.prototype.constructor = cleverapps.Interval, cleverapps.LongTimeout = function (e, t, s) {
            if (t <= cleverapps.LongTimeout.THRESHOLD) return t < 0 && (t = 0), void (this.timeout = setTimeout(e, t));
            (s = s || {}).onFinish = e, cleverapps.CountDown.call(this, t, s)
        }, cleverapps.LongTimeout.prototype = Object.create(cleverapps.CountDown.prototype), cleverapps.LongTimeout.prototype.constructor = cleverapps.LongTimeout, cleverapps.LongTimeout.prototype.remove = function () {
            void 0 !== this.timeout ? clearTimeout(this.timeout) : cleverapps.CountDown.prototype.remove.apply(this, arguments)
        }, cleverapps.CountDownManager = {
            listeners: {},
            uid: 0,
            interval: !1,
            paused: !1,
            muted: !1,
            onTick: function () {
                var e, t = Date.now(),
                    s = this.paused || this.muted;
                for (e in this.listeners) {
                    var i = this.listeners[e];
                    !i || s && !i.ignorePaused || i.nextSecond(t)
                }
            },
            pause: function () {
                this.paused = !0
            },
            resume: function () {
                this.paused = !1
            },
            mute: function () {
                this.muted = !0
            },
            unmute: function () {
                this.muted = !1
            },
            addListener: function (e) {
                var t = this.uid;
                return this.listeners[t] = e, this.uid++, !1 === this.interval && (this.interval = setInterval(this.onTick.bind(this), cleverapps.CountDown.INTERVAL)), t
            },
            removeListener: function (e) {
                delete this.listeners[e]
            }
        }, cleverapps.CountDown.INTERVAL = 1e3, cleverapps.LongTimeout.THRESHOLD = cleverapps.CountDown.INTERVAL, cleverapps.CountDownView.BAR_ANIMATION_LIMIT = cleverapps.parseInterval("5 minutes"), cleverapps.styles.CountDownView = {
            textOffsetX: -2
        }, clearTimeout),
        clearIntervalSuper = clearInterval,
        UpMenuContainer = (clearTimeout = function (e) {
            e instanceof cleverapps.CountDown ? e.remove() : clearTimeoutSuper(e)
        }, clearInterval = function (e) {
            e instanceof cleverapps.CountDown ? e.remove() : clearIntervalSuper(e)
        }, cc.Node.extend({
            ctor: function () {
                this._super(), cleverapps.environment.isWysiwygScene() || cleverapps.environment.isAtlasAnalyzerScene() || (this.menuBar = new MenuBarView, this.addChild(this.menuBar)), this.setLocalZOrder(UpMenuContainer.ZORDER), this.updateSize(), this.updatePosition()
            },
            addControlButtons: function (e) {
                this.removeControlButtons(), this.controlButtons = e, this.addChild(this.controlButtons), this.updateSize(), this.updatePosition()
            },
            removeControlButtons: function () {
                this.controlButtons && (this.controlButtons.removeFromParent(), delete this.controlButtons, this.updateSize(), this.updatePosition())
            },
            updateSize: function () {
                var e = cleverapps.styles.UpMenuContainer,
                    t = e.scale[cleverapps.resolution.mode],
                    s = ((cleverapps.environment.isWysiwygScene() || cleverapps.environment.isAtlasAnalyzerScene()) && (t = .5), cleverapps.UI.getSceneSize().width),
                    i = (s -= 2 * e.padding.x, cleverapps.environment.isWysiwygScene() && (s -= cleverapps.styles.InspectorView.width), s = (s /= t) - cleverapps.resolution.getSafePadding().right, 0),
                    n = 0,
                    o = 0;
                this.controlButtons && (n = Math.max(n,
                    this.controlButtons.height * this.controlButtons.scaleY), i += this.controlButtons.width * this.controlButtons.scaleX, o += 1), this.menuBar && (this.menuBar.reshape(s, s - i), n = Math.max(n, this.menuBar.height * this.menuBar.scaleY), i += this.menuBar.width * this.menuBar.scaleX, o += 1), s < (i += e.margin * Math.max(0, o - 1)) && (t *= s / i, s = i), this.setScale(t), this.setContentSize(s, n)
            },
            updatePosition: function () {
                var e = cleverapps.styles.UpMenuContainer,
                    t = -e.padding.y;
                t -= cleverapps.resolution.getSafePadding().top, this.setPositionRound({
                    align: "left",
                    dx: e.padding.x
                }, {
                    align: "top",
                    dy: t
                }), this.menuBar && this.menuBar.setPositionRound(e.menuBar)
            }
        })),
        ExitControlButton = (UpMenuContainer.ZORDER = BaseWindow.WINDOWS_ZORDER + 1, cleverapps.styles.UpMenuContainer = {
            scale: [.8, .8, 1],
            margin: 14,
            padding: {
                x: 20,
                y: 10
            },
            menuBar: {
                x: {
                    align: "left"
                },
                y: {
                    align: "center"
                }
            }
        }, {
            onClicked: function () {
                cleverapps.config.demoMode ? window.location.search = "" : cleverapps.scenes.getRunningScene().closeAction()
            },
            isAvailableInEpisode: function () {
                return cleverapps.environment.isMainScene() ? !cleverapps.platform.oneOf(SPMobage, Mobage) && (cleverapps.administrator && AdministratorScene.IsAvailable()) : ("battlefield" !== cleverapps.config.type || !Game.currentGame || Game.currentGame.mode !== Epicart.MODE_BATTLE) && (!(!cleverapps.environment.hasScene([cleverapps.Environment.SCENE_ATLAS_ANALYZER]) && !cleverapps.config.adminMode) || !(cleverapps.environment.hasScene([cleverapps.Environment.SCENE_CHAT]) || cleverapps.environment.isGameScene() && -1 !== ["riddles", "heroes", "zenmatch"].indexOf(cleverapps.config.name)) && (levels && levels.user && levels.user.checkAvailable("merge" === cleverapps.config.type ? {
                    level: 1
                } : {
                    level: .07
                })))
            }
        }),
        FullscreenControlButton = {
            onClicked: function () {
                cleverapps.platform.toggleFullScreen()
            },
            isAvailableInEpisode: function () {
                return !cleverapps.config.wysiwygMode && (("battlefield" !== cleverapps.config.type || !Game.currentGame || Game.currentGame.mode !== Epicart.MODE_BATTLE) && (!cleverapps.environment.hasScene([cleverapps.Environment.SCENE_CHAT,
                cleverapps.Environment.SCENE_MINE, cleverapps.Environment.SCENE_SLOT_MACHINE
                ]) && cleverapps.platform.isFullscreenAvailable()))
            }
        },
        MenuControlButton = {
            onClicked: function () {
                cleverapps.meta.display({
                    focus: "SettingsWindowFromMenu",
                    action: function (e) {
                        new SettingsWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            },
            isAvailableInEpisode: function () {
                return ("battlefield" !== cleverapps.config.type || !Game.currentGame || Game.currentGame.mode !== Epicart.MODE_BATTLE) && !cleverapps.environment.hasScene([cleverapps.Environment.SCENE_EDITOR, cleverapps.Environment.SCENE_CHAT, cleverapps.Environment.SCENE_MINE])
            },
            onUpdateAttention: function () { },
            updateAttention: function () {
                this.onUpdateAttention(cleverapps.chat.hasUnread && ("merge" === cleverapps.config.type || !Game.currentGame))
            }
        },
        PauseControlButton = {
            onClicked: function () {
                Game.currentGame.pause(), new PauseWindow
            },
            isAvailableInEpisode: function () {
                return "battlefield" === cleverapps.config.type && Game.currentGame && Game.currentGame.mode === Epicart.MODE_BATTLE
            }
        },
        SceneControlButton = cleverapps.UI.Button.extend({
            ctor: function (e) {
                this.options = e = e || {};
                var t = cleverapps.styles.SceneControlButton,
                    s = {
                        button_png: bundles.controlbuttons.frames.control_button_png,
                        button_on_png: bundles.controlbuttons.frames.control_button_on_png
                    },
                    s = e.type || s;
                s.mark = t.mark, this._super({
                    type: s,
                    onClicked: e.logic.onClicked.bind(this),
                    content: new cc.Sprite(e.icon)
                }), SceneDecors.add(this, cleverapps.skins.getSlot("sceneControlButton", {
                    target: this
                })), e.logic.updateAttention && (e.logic.onUpdateAttention = this.createListener(this.setAttention.bind(this)), e.logic.updateAttention())
            }
        }),
        SceneControlButtonsView = (cleverapps.styles.SceneControlButton = {
            mark: {
                x: {
                    align: "right",
                    dx: 5
                },
                y: {
                    align: "top",
                    dy: -5
                }
            }
        }, cleverapps.Layout.extend({
            ctor: function () {
                var e = cleverapps.styles.SceneControlButtonsView;
                this.buttons = SceneControlButtonsView.controlButtons.filter(function (e) {
                    return e.logic.isAvailableInEpisode()
                }).map(function (e) {
                    return new SceneControlButton(e)
                }), this._super(this.buttons, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin
                }), this.updatePosition()
            },
            updateSize: function () {
                var e = cleverapps.styles.SceneControlButtonsView;
                SceneControlButtonsView.isOutsideMenu() && this.setScale(e.outsideMenu.scale)
            },
            updatePosition: function () {
                var e = cleverapps.styles.SceneControlButtonsView;
                SceneControlButtonsView.isOutsideMenu() ? this.setPositionRound(e.outsideMenu) : this.setPositionRound(e.controlButtons)
            }
        })),
        MenuBar = (SceneControlButtonsView.isOutsideMenu = function () {
            return -1 !== ["heroes", "riddles"].indexOf(cleverapps.config.name) && cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && cleverapps.environment.isGameScene()
        }, SceneControlButtonsView.menuButtonData = {
            logic: MenuControlButton,
            icon: bundles.controlbuttons.frames.menu_icon_png
        }, SceneControlButtonsView.controlButtons = [{
            logic: ExitControlButton,
            icon: bundles.controlbuttons.frames.back_icon_png,
            type: {
                button_png: bundles.controlbuttons.frames.back_button_png,
                button_on_png: bundles.controlbuttons.frames.back_button_on_png
            }
        }, {
            logic: FullscreenControlButton,
            icon: bundles.controlbuttons.frames.fullscreen_icon_png
        }, SceneControlButtonsView.menuButtonData, {
            logic: PauseControlButton,
            icon: bundles.controlbuttons.frames.pause_png
        }], cleverapps.styles.SceneControlButtonsView = {
            margin: 16,
            outsideMenu: {
                x: {
                    align: "left",
                    dx: 10
                },
                y: {
                    align: "bottom",
                    dy: 10
                },
                scale: .8
            },
            controlButtons: {
                x: {
                    align: "right"
                },
                y: {
                    align: "center",
                    dy: -5
                }
            }
        }, function () {
            this.items = cleverapps.MenuBarItems().map(function (e) {
                var t = e.modelClass;
                return new (e.modelClass ? t : MenuBarItem)(e)
            })
        }),
        MenuBarItem = (MenuBar.prototype.getSceneItems = function () {
            if (cleverapps.environment.isEditorScene()) return [];
            var t = [];
            return this.items.forEach(function (e) {
                e.isAvailableOnScene() ? (e.init(), t.push(e)) : e.clean()
            }), t
        }, MenuBar.prototype.stopItems = function () {
            this.items.forEach(function (e) {
                e.stop()
            })
        }, MenuBar.prototype.showForce = function (t) {
            var s, i = this.items.find(function (e) {
                return e.name === t
            });
            return cleverapps.meta.display({
                focus: t + "MenuBarItemForce",
                control: "MenuBar" + t,
                actions: [function (
                    e) {
                    s = !0, cleverapps.timeouts.setTimeout(e, 500)
                }, function (e) {
                    i.onShowForce(i.config.force), cleverapps.forces.onceForceClosed = e
                }]
            }), s
        }, MenuBar.prototype.clean = function () {
            this.items.forEach(function (e) {
                e.clean()
            })
        }, cleverapps.MenuBarItems = function () {
            var e = [];
            return "merge" === cleverapps.config.type && e.push({
                name: "GameLevelItem",
                targets: ["default", "exp"],
                viewClass: MenuBarGameLevelView,
                modelClass: GameLevelMenuBarItem,
                availableOnScenes: [cleverapps.Environment.SCENE_MAIN]
            }), -1 === ["klondike"].indexOf(cleverapps.config.type) && e.push({
                name: "GoldItem",
                lottery: !0,
                isClickable: function () {
                    return !cleverapps.flags.videoAdsMainMonetization || cleverapps.rewardedAdsManager.isEnabled()
                },
                clickableUpdater: function (e) {
                    cleverapps.flags.on("change:videoAdsMainMonetization", e, this)
                },
                targets: "hard",
                plusButton: !0,
                value: function () {
                    return cleverapps.user.gold
                },
                updater: function (e) {
                    cleverapps.user.on("changeHard", e, this)
                },
                attentionUpdater: function (e) {
                    cleverapps.adsLimits.on("update", e, this),
                        cleverapps.subscription && cleverapps.subscription.on("update", e, this), cleverapps.growthFund && cleverapps.growthFund.on("updateState", e, this)
                },
                attention: function () {
                    return -1 !== ShopProductSource.listProducts(ShopWindow.TABS.HARD_CURRENCY).indexOf("hardForVideo") && cleverapps.adsLimits.state(AdsLimits.TYPES.HARD) === AdsLimits.STATE_READY || (!(-1 === ShopProductSource.listProducts(ShopWindow.TABS.HARD_CURRENCY).indexOf("subsMonth") || !cleverapps.subscription || !cleverapps.subscription.needsAttention()) || !(!cleverapps.growthFund || !cleverapps.growthFund.needsAttention()))
                },
                availableOnScenes: function () {
                    return [cleverapps.Environment.SCENE_MAIN, cleverapps.Environment.SCENE_HEROES, cleverapps.Environment.SCENE_DAILY_CUP, cleverapps.Environment.SCENE_BONUS_WORLD, cleverapps.Environment.SCENE_SLOT_MACHINE, cleverapps.Environment.SCENE_GAME]
                },
                hiddenByDefault: ["match3", "tile3", "battlefield"].includes(cleverapps.config.type) ? [cleverapps.Environment.SCENE_GAME, cleverapps.Environment.SCENE_WYSIWYG] : void 0,
                icon: bundles.menubar.frames.gold_png,
                onClickWindow: HardCurrencyShopWindow,
                deltaSound: bundles.menubar.urls.coins_effect,
                sparks: ["merge", "board"].includes(cleverapps.config.type)
            }), cleverapps.lives && e.push({
                name: "LivesItem",
                lottery: !0,
                targets: "lives",
                plusButton: !cleverapps.platform.oneOf(Pliega) || void 0,
                attentionUpdater: function (e) {
                    Game.currentGame && Game.currentGame.energyLottery && (Game.currentGame.energyLottery.onLotteryAttentionChanged = e)
                },
                attention: function () {
                    if (Game.currentGame && Game.currentGame.energyLottery) return Game.currentGame.energyLottery.isReady()
                },
                availableOnScenes: function () {
                    var e = [cleverapps.Environment.SCENE_BONUS_WORLD];
                    return cleverapps.travelBook.getCurrentPage().withEnergy() && e.push(cleverapps.Environment.SCENE_MAIN), cleverapps.dailyCup.withLives() && e.push(cleverapps.Environment.SCENE_DAILY_CUP), e
                },
                force: Forces.BUY_ENERGY_ICON,
                viewClass: MenuBarWithTimeoutView,
                modelClass: LivesMenuBarItem,
                icon: bundles.menubar.frames.life_png,
                onClickWindow: cleverapps.platform.oneOf(
                    Pliega) ? void 0 : LivesShopWindow,
                sparks: !0,
                deltaSound: cleverapps.config.lives ? bundles.menubar.urls.lives_fly_finish_effect : bundles.menubar.urls.energy_fly_finish_effect
            }), cleverapps.config.soft && e.push({
                name: "CoinsItem",
                targets: "soft",
                plusButton: !0,
                value: function () {
                    return cleverapps.user.soft
                },
                updater: function (e) {
                    cleverapps.user.on("changeSoft", e, this)
                },
                attentionUpdater: function (e) {
                    cleverapps.adsLimits.on("update", e, this)
                },
                attention: function () {
                    return !1
                },
                onClickWindow: SoftCurrencyShopWindow,
                icon: bundles.menubar.frames.coin_png,
                force: Forces.MENU_BAR_SOFT_FORCE,
                availableOnScenes: function () {
                    return [cleverapps.Environment.SCENE_MAIN, cleverapps.Environment.SCENE_GAME]
                },
                hiddenByDefault: ["match3"].includes(cleverapps.config.type) ? [cleverapps.Environment.SCENE_GAME] : void 0,
                sparks: !0,
                deltaSound: bundles.menubar.urls.coins_effect
            }), "merge" === cleverapps.config.type && e.push({
                name: "WandsItem",
                plusButton: !1,
                targets: "wands",
                value: function () {
                    return Game.currentGame.wands
                },
                updater: function (e) {
                    Game.currentGame.onChangeWandsListener = e
                },
                onClickWindow: GuideWindow,
                onClickOptions: function () {
                    return cleverapps.travelBook.getCurrentExpedition() ? ExpeditionWandsGuideOptions : {
                        name: "WandsGuideWindow"
                    }
                },
                icon: function () {
                    return bundles.menubar.frames.merge_wand_png
                },
                deltaSound: bundles.menubar.urls.wand_fly_finish_effect,
                availableOnScenes: function () {
                    if (cleverapps.travelBook.getCurrentPage().withWands()) return [cleverapps.Environment.SCENE_MAIN]
                },
                sparks: !0
            }, {
                name: "WorkersItem",
                plusButton: !0,
                targets: "worker",
                timerTTF: !0,
                viewClass: MenuBarWithTimeoutView,
                modelClass: WorkersMenuBarItem,
                attention: function () {
                    return Game.currentGame && Game.currentGame.workers.isAdsWorkerAvailable() && cleverapps.adsLimits.state(AdsLimits.TYPES.WORKER) === AdsLimits.STATE_READY && cleverapps.flags.videoAdsMainMonetization
                },
                onClickWindow: BonusWorkerWindow,
                icon: function () {
                    return bundles.menubar.frames.merge_worker_png
                },
                availableOnScenes: function () {
                    if (cleverapps.travelBook.getCurrentPage().withWorkers()) return [
                        cleverapps.Environment.SCENE_MAIN
                    ]
                },
                deltaSound: bundles.menubar.urls.worker_fly_finish_effect,
                sticker: function () {
                    if (cleverapps.travelBook.getCurrentPage().isMain() && Subscription.IsAvailable() && cleverapps.subscription.isActive()) return "premium"
                }
            }), cleverapps.meta.getType() === Metha.HOMEFIX && e.push({
                name: "MethaStarsItem",
                plusButton: !0,
                value: function () {
                    return cleverapps.home.stars
                },
                updater: function (e) {
                    cleverapps.home.onChangeStars = e
                },
                onClickWindow: GuideWindow,
                onClickOptions: {
                    name: "HomefixRulesWindow"
                },
                icon: bundles.menubar.frames.menubar_metha_stars,
                availableOnScenes: [cleverapps.Environment.SCENE_MAIN]
            }), "undefined" != typeof match3 && e.push({
                name: "ExpItem",
                plusButton: !0,
                lottery: !0,
                isClickable: function () {
                    return !cleverapps.flags.videoAdsMainMonetization
                },
                clickableUpdater: function (e) {
                    cleverapps.flags.on("change:videoAdsMainMonetization", e, this)
                },
                value: function () {
                    return cleverapps.exp.getExp()
                },
                updater: function (e) {
                    cleverapps.exp.on("changeExp", e, this)
                },
                onClickWindow: ExpInfoWindow,
                icon: bundles.menubar.frames.exp_png,
                availableOnScenes: [cleverapps.Environment.SCENE_HEROES]
            }), 0 <= ["board", "differences"].indexOf(cleverapps.config.type) && e.push({
                name: "CryptexItem",
                centerAlign: !0,
                helpButton: !0,
                force: Forces.CRYPTEX,
                icon: bundles.menubar.frames.cryptex_png,
                onClickWindow: CryptexWindow,
                modelClass: CryptexMenuBarItem,
                availableOnScenes: function () {
                    return Game.currentGame && Game.currentGame.cryptex && [cleverapps.Environment.SCENE_GAME]
                }
            }), e.push({
                name: "BonusRoundTimerItem",
                centerAlign: !0,
                tooltip: "BonusRoundCountdownTooltip",
                animation: bundles.menubar.jsons.bound_round_timer_json,
                modelClass: BonusRoundMenuBarItem,
                availableOnScenes: function () {
                    return Game.currentGame && Game.currentGame.bonusRoundCountDown && [cleverapps.Environment.SCENE_GAME]
                }
            }), e
        }, function (e) {
            this.config = e, this.timerShowHours = !1, this.onRemove = function () { }, this.onChangeText = function () { }, this.onUpdateTimer = function () { }, this.onShowForce = function () { }, this.onUpdateSticker = function () { }, this.onAttentionOnListener = function () { },
                this.onAttentionOffListener = function () { }, this.onFingerOnListener = function () { }, this.onFingerOffListener = function () { }, this.onUpdateClickable = function () { }, this.onUpdatePlusButton = function () { }
        }),
        WorkersMenuBarItem = (MenuBarItem.prototype.isAvailableOnScene = function () {
            var e = this.config.availableOnScenes;
            return "function" == typeof e && (e = e()), cleverapps.environment.hasScene(e || [])
        }, MenuBarItem.prototype.init = function () {
            this.stopped = !1, Object.assign(this, this.config), this.plusButton = this.withPlusButton(), this.config.onClickWindow && (this.canActionNow = function () {
                return !(!this.config.force || !cleverapps.forces.isRunningForce(this.config.force)) || !cleverapps.meta.isFocused()
            }.bind(this), this.action = function () {
                var i = this.config.force && cleverapps.forces.isRunningForce(this.config.force);
                i && cleverapps.forces.closeRunningForce(), this.onAction && this.onAction(), cleverapps.meta.display({
                    focus: "MenuBar" + this.getName() + "Window",
                    control: this.getControlName(),
                    action: function (e) {
                        var t = this.config.onClickWindow,
                            s = (s = "function" == typeof this.config.onClickOptions ? this.config.onClickOptions() : this.config.onClickOptions) || {};
                        i && this.config.force.productKey && (s.force = this.config.force), new t(s), cleverapps.meta.onceNoWindowsListener = e
                    }.bind(this)
                })
            }.bind(this)), this.config.updater && (this.config.updater.call(this, this.changeText.bind(this)), this.updater = void 0), this.config.attentionUpdater && this.config.attentionUpdater.call(this, this.updateAttention.bind(this)), this.config.clickableUpdater && this.config.clickableUpdater.call(this, function () {
                this.updateClickable(), this.updatePlusButton()
            }.bind(this)), this.updateClickable(), this.updateAttention(), this.customInit()
        }, MenuBarItem.prototype.updateClickable = function () {
            var e = this.action && (!this.config.isClickable || this.config.isClickable());
            e !== this.clickable && (this.clickable = e, this.onUpdateClickable())
        }, MenuBarItem.prototype.changeText = function () {
            this.onChangeText()
        }, MenuBarItem.prototype.updateAttention = function () {
            var e;
            !this.stopped && this.config.attention && (e = this.config.attention(), this.attention !== e && ((this.attention = e) ? this.onAttentionOnListener() : this.onAttentionOffListener()))
        }, MenuBarItem.prototype.updatePlusButton = function () {
            var e = this.withPlusButton();
            e !== this.plusButton && (this.plusButton = e, this.onUpdatePlusButton())
        }, MenuBarItem.prototype.withPlusButton = function () {
            return this.config.plusButton && (!this.config.isClickable || this.config.isClickable())
        }, MenuBarItem.prototype.customInit = function () { }, MenuBarItem.prototype.getName = function () {
            return this.config.name
        }, MenuBarItem.prototype.getTargetTypes = function () {
            return this.config.targets
        }, MenuBarItem.prototype.getControlName = function () {
            return "MenuBar" + this.getName()
        }, MenuBarItem.prototype.getCurrentValue = function () {
            return {
                amount: this.config.value && this.config.value() || 0
            }
        }, MenuBarItem.prototype.getViewClass = function () {
            return this.config.viewClass || MenuBarItemView
        }, MenuBarItem.prototype.getText = function () {
            if (this.timer) return cleverapps.intervalToString(this.timer.getTimeLeft(), this.timerShowHours);
            var e = this.getCurrentValue();
            return void 0 === e.amount ? "" : "" + e.amount
        }, MenuBarItem.prototype.calcTimerTTF = function () {
            var e = this.timer && this.timer.getTimeLeft() || 0;
            return e >= cleverapps.ONE_DAY - 1e3 || !this.timerShowHours && e > cleverapps.ONE_HOUR - 1e3
        }, MenuBarItem.prototype.timerRefresh = function () {
            this.timerTTF === this.calcTimerTTF() ? this.onRefreshTimer && this.onRefreshTimer() : this.updateTimer()
        }, MenuBarItem.prototype.updateTimer = function () {
            var e = this.timer;
            this.stopTimer(), this.onChangeTimer && this.onChangeTimer(Boolean(this.timer) === Boolean(e)), this.onRefreshTimer && this.onRefreshTimer()
        }, MenuBarItem.prototype.stop = function () {
            this.stopped = !0, this.stopTimer()
        }, MenuBarItem.prototype.clean = function () {
            this.stop(), runCleaners(this)
        }, MenuBarItem.prototype.stopTimer = function () {
            this.timer && (this.timer.stop(), this.timer = !1)
        }, MenuBarItem.prototype.setTimer = function (e) {
            this.timer = e, this.timer.onSecond = this.timerRefresh.bind(
                this), this.timerTTF = this.calcTimerTTF()
        }, MenuBarItem.prototype.getSticker = function () {
            return this.config.sticker && this.config.sticker()
        }, MenuBarItem.prototype.setFinger = function (e) {
            this.finger !== (e = !!e) && ((this.finger = e) ? this.onFingerOnListener() : this.onFingerOffListener())
        }, function (e) {
            MenuBarItem.call(this, e), this.timerShowHours = !0
        }),
        BonusRoundMenuBarItem = (WorkersMenuBarItem.prototype = Object.create(MenuBarItem.prototype), (WorkersMenuBarItem.prototype.constructor = WorkersMenuBarItem).prototype.customInit = function () {
            Game.currentGame.workers.onChangeStatusListener = this.changeText.bind(this), Game.currentGame.workers.onChangeTotalAmount = function (e) {
                this.changeText(e), this.updateTimer(), this.onUpdateSticker(), this.updateAttention()
            }.bind(this), cleverapps.adsLimits.on("update", this.updateAttention.bind(this), this), this.updateTimer()
        }, WorkersMenuBarItem.prototype.getCurrentValue = function () {
            return {
                amount: Game.currentGame.workers.countRegularFree(),
                total: Game.currentGame.workers.countRegularTotal()
            }
        }, WorkersMenuBarItem.prototype.highlightTotal = function () {
            return Game.currentGame && Game.currentGame.workers.isBonusWorkerBuyed() || Game.currentGame && Game.currentGame.isMainGame() && Subscription.IsAvailable() && cleverapps.subscription.isActive()
        }, WorkersMenuBarItem.prototype.updateTimer = function () {
            var e = this.timer;
            this.stopTimer(), Game.currentGame && Game.currentGame.workers.isBonusWorkerBuyed() && this.setTimer(new cleverapps.CountDown(Game.currentGame.workers.bonusWorkerLeftTime(), {
                onFinish: this.updateTimer.bind(this)
            }), !0), this.onChangeTimer && this.onChangeTimer(!!this.timer == !!e), this.onRefreshTimer && this.timer && this.onRefreshTimer()
        }, function (e) {
            MenuBarItem.call(this, e)
        }),
        GameLevelMenuBarItem = (BonusRoundMenuBarItem.prototype = Object.create(MenuBarItem.prototype), (BonusRoundMenuBarItem.prototype.constructor = BonusRoundMenuBarItem).prototype.customInit = function () {
            Game.currentGame.on("stop", function () {
                Game.currentGame.outcome === GameBase.OUTCOME_LOST && this.onSetAnimationAndHide("timeout")
            }.bind(this), this), this.updateTimer()
        }, BonusRoundMenuBarItem.prototype.timerRefresh = function () {
            this.timerTTF === this.calcTimerTTF() ? this.onChangeText() : this.updateTimer()
        }, BonusRoundMenuBarItem.prototype.updateTimer = function () {
            var e = this.timer,
                t = (this.stopTimer(), Game.currentGame.bonusRoundCountDown.getTimeLeft());
            0 < t && this.setTimer(new cleverapps.CountDown(t, {
                onFinish: this.updateTimer.bind(this)
            })), this.onUpdateTimer(Boolean(this.timer) === Boolean(e)), this.onChangeText()
        }, function (e) {
            MenuBarItem.call(this, e), this.onChangeLevelNo = function () { }, this.onChangeExpProgress = function () { }
        }),
        MenuBarItemView = (GameLevelMenuBarItem.prototype = Object.create(MenuBarItem.prototype), (GameLevelMenuBarItem.prototype.constructor = GameLevelMenuBarItem).prototype.customInit = function () {
            cleverapps.gameLevel.on("changeLevel", function () {
                this.onChangeLevelNo()
            }.bind(this), this), cleverapps.exp.on("changeExp", function () {
                this.onChangeExpProgress()
            }.bind(this), this), cleverapps.gameLevel.withOwnLevel ? this.worldTitle = "TravelBook.title." + cleverapps.travelBook.getCurrentPage().id : delete this.worldTitle
        }, GameLevelMenuBarItem.prototype.debugAction = function () {
            Game.currentGame.addReward("exp", cleverapps.gameLevel.nextLevelThreshold())
        }, GameLevelMenuBarItem.prototype.getCurrentValue = function () {
            return {
                level: cleverapps.gameLevel.getLevel(),
                amount: cleverapps.exp.getExp(),
                total: cleverapps.gameLevel.nextLevelThreshold()
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.setAnchorPoint2(), this.styles = cleverapps.styles.MenuBarItem, this.item = e, this.centerAlign = this.item.centerAlign, this.lastShownValue = this.item.getCurrentValue(), this.reset(!0), this.item.onRemove = this.createListener(this.remove.bind(this)), this.item.onChangeText = this.createListener(this.onChangeText.bind(this)), this.item.onUpdateTimer = this.createListener(this.addText.bind(this)), this.item.onShowForce = this.createListener(this.showForce.bind(this)),
                    this.item.onAttentionOnListener = this.createListener(this.turnOnAttention.bind(this)), this.item.onAttentionOffListener = this.createListener(this.turnOffAttention.bind(this)), this.item.onSetAnimationAndHide = this.createListener(this.setAnimationAndHide.bind(this)), this.item.onUpdatePlusButton = this.createListener(this.updatePlusButton.bind(this)), this.item.onUpdateLotteryIcon = this.createListener(this.updateLotteryIcon.bind(this)), this.item.onUpdateSticker = this.createListener(this.updateSticker.bind(this)), this.item.onFingerOnListener = this.createListener(this.turnOnFinger.bind(this)), this.item.onFingerOffListener = this.createListener(this.turnOffFinger.bind(this)), this.item.onUpdateClickable = this.createListener(this.updateClickable.bind(this));
                e = this.item.getTargetTypes();
                e && cleverapps.aims.registerTarget(e, this.getIcon(), {
                    controls: this.item.getControlName(),
                    animate: this.animateIcon.bind(this)
                }), this.item.tooltip && cleverapps.tooltipManager.create(this, {
                    text: this.item.tooltip,
                    position: cleverapps.styles.UI.Tooltip.LOCATION.below,
                    control: this.item.getControlName() + "Tooltip"
                })
            },
            getIcon: function () {
                return this.icon
            },
            updatePlusButton: function () {
                !!this.item.plusButton != !!this.plusButton && (this.item.plusButton ? this.addPlusButton() : (this.plusButton.removeFromParent(), delete this.plusButton))
            },
            updateLotteryIcon: function () {
                !!this.item.lottery != !!this.lotteryIcon && (this.item.lottery ? -1 !== ["board", "differences"].indexOf(cleverapps.config.type) && cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && cleverapps.environment.isGameScene() || Lottery.addIcon(this, "menu") : (this.lotteryIcon.removeFromParent(), delete this.lotteryIcon))
            },
            setAnimationAndHide: function (e) {
                this.icon instanceof cleverapps.Spine && this.icon.setAnimation(0, e, !1), this.runAction(new cc.Sequence(new cc.DelayTime(.8), new cc.CallFunc(function () {
                    cleverapps.meta.hideControlsWhileFocused(this.item.getControlName())
                }.bind(this))))
            },
            reset: function () {
                this.turnOffAttention(), this.removeAllChildren(), this.addBg(),
                    this.addIcon(), this.bg.setPositionRound(this.bg.width / 2 + this.iconRealWidth / 2, this.styles.bg.height / 2), this.setContentSize2(this.bg.width + this.iconRealWidth / 2, this.bg.height), this.updatePlusButton(), this.addHelpButton(), this.addText(), this.updateClickable(), cleverapps.UI.onClick(this, function () {
                        this.onPressed()
                    }.bind(this), {
                        filter: this.item.canActionNow
                    }), SceneDecors.add(this.bg, cleverapps.skins.getSlot("menuBarItem", {
                        name: this.item.getName()
                    })), this.updateLotteryIcon(), this.item.attention && this.turnOnAttention(), this.updateSticker(!0)
            },
            remove: function () {
                this.runAction(new cc.Sequence(new cc.ScaleTo(.3, 0), new cc.RemoveSelf))
            },
            showForce: function (e) {
                this.show(!0), cleverapps.forces.create(this, e, {
                    importantNodes: [this]
                })
            },
            updateText: function (e) {
                this.text.setString(e)
            },
            getTextValue: function () {
                return this.item.getText()
            },
            onChangeText: function () {
                var e = this.item.getCurrentValue(),
                    t = e.amount - this.lastShownValue.amount,
                    s = (s = e.time - (void 0 === this.lastShownValue.time ? Date.now() : this.lastShownValue.time)) && (0 < s ? "+" + Product.FormatTimePeriod(s).title : Product.FormatTimePeriod(s).title),
                    i = t || s || 0,
                    n = this.getTextValue(),
                    t = (this.text.stopAllActions(), this.text.setScale(this.text.baseScale), this.item.deltaSound);
                t && cleverapps.audio.playSound(t), this.text.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.1 * this.text.baseScale), new cc.CallFunc(function () {
                    cleverapps.UI.animateDelta(i, {
                        parent: this,
                        x: this.bg.width / 2 + this.iconRealWidth / 2,
                        y: this.styles.deltaAnimation.dy,
                        font: cleverapps.styles.FONTS.MENUBAR_TEXT_DELTA || cleverapps.styles.FONTS.MENUBAR_TEXT
                    }), this.lastShownValue = e, this.updateText(n), this.text.setPositionRound(this.getTextPosition())
                }.bind(this)), new cc.ScaleTo(.2, this.text.baseScale), new cc.CallFunc(function () {
                    this.textFitTo()
                }.bind(this))))
            },
            animateIcon: function () {
                var e;
                this.icon && (this.icon.stopAllActions(), this.icon.setScale(this.icon.baseScale), this.icon.runAction(new cc.Sequence(new cc.ScaleTo(.05, 1.2 * this.icon.baseScale).easing(cc.easeIn(1)), new cc.ScaleTo(
                    .05, this.icon.baseScale).easing(cc.easeOut(1))))), this.item.sparks && this.icon && ((e = new cleverapps.Spine(bundles.menubar.jsons.sparks_json)).setAnimation(0, "animation_y", !1), e.setCompleteListenerRemove(), this.addChild(e, -1), e.setPositionRound(this.icon.getPositionX() + this.styles.sparks.x, this.icon.getPositionY() + this.styles.sparks.y))
            },
            animateChange: function (e) {
                return e && !this.item.timer
            },
            addIcon: function () {
                this.item.animation ? (this.icon = new cleverapps.Spine(this.item.animation), this.icon.setAnimation(0, "idle", !0)) : this.icon = new cc.Sprite("function" == typeof this.item.icon ? this.item.icon() : this.item.icon), this.icon.baseScale = this.icon.getScale(), this.iconRealWidth = this.styles.icon.fullInsideBg ? 0 : this.icon.getBoundingBox().width, this.addChild(this.icon), this.icon.setLocalZOrder(1), this.icon.setPositionRound({
                    x: this.iconRealWidth / 2 + this.styles.icon.x,
                    y: this.styles.bg.height / 2 + this.styles.icon.y
                })
            },
            addBg: function () {
                this.bg = cleverapps.UI.createScale9Sprite(
                    bundles.menubar.frames.menubar_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY), this.bg.setContentSize2(this.styles.bg.width, this.styles.bg.height), this.addChild(this.bg)
            },
            textFitTo: function () {
                this.text.fitTo(this.getTextWidth())
            },
            getTextWidth: function () {
                var e = 0;
                return this.item.helpButton && (e = this.styles.helpButton.width), this.width - this.iconRealWidth - this.styles.icon.x - this.styles.bg.padding.right - e
            },
            getTextPosition: function () {
                var e = this.styles.bg.padding.bottom;
                return cc.p(this.iconRealWidth + this.styles.icon.x + this.getTextWidth() / 2, this.height / 2 + e)
            },
            addText: function () {
                this.text && this.text.parent && this.text.removeFromParent();
                var e = this.item.getText(),
                    e = cleverapps.UI.ImageFont.IsApplicable(cleverapps.styles.FONTS.MENUBAR_TEXT, e) ? cleverapps.UI.generateImageText(e, cleverapps.styles.FONTS.MENUBAR_TEXT, {
                        fixedNumberWidth: !!this.item.timer
                    }) : cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.MENUBAR_TEXT);
                this.addChild(e), (this.text = e).baseScale = e.scale, this.textFitTo(),
                    e.setPositionRound(this.getTextPosition())
            },
            updateClickable: function () {
                this.item.clickable ? this.hoverHandler = cleverapps.UI.applyHover(this, {
                    filter: this.item.canActionNow
                }) : this.hoverHandler && (this.hoverHandler.remove(), delete this.hoverHandler)
            },
            onPressed: function () {
                this.item.clickable && this.item.action()
            },
            addPlusButton: function () {
                var e = this.plusButton = new cleverapps.UI.Button({
                    type: {
                        button_png: bundles.menubar.frames.plus_button_png,
                        button_on_png: bundles.menubar.frames.plus_button_on_png
                    },
                    onClicked: this.item.action,
                    filter: this.item.canActionNow
                }),
                    t = (this.addChild(e), e.setLocalZOrder(1), cleverapps.meta.registerControl(this.item.getControlName() + ".Plus", this.plusButton.createListener(function (e, t) {
                        this.plusButton && (this.plusButton.stopAllActions(), e = e ? 1 : 0, t ? this.plusButton.setScale(e) : this.plusButton.runAction(new cc.ScaleTo(.2, e)))
                    }.bind(this))), cleverapps.meta.isControlEnabled(this.item.getControlName() + ".Plus") && cleverapps.meta.showControlsWhileFocused(this.item.getControlName() + ".Plus", !0), cc.p(this.icon.x + this.iconRealWidth / 2, 0));
                t.x += this.styles.plusButton.offset.x, t.y += this.styles.plusButton.offset.y, e.setPositionRound(t)
            },
            addHelpButton: function () {
                var t;
                this.item.helpButton && (t = this.helpButton = new cleverapps.UI.Button({
                    type: {
                        button_png: bundles.buttons.frames.help_button_png,
                        button_on_png: bundles.buttons.frames.help_button_on_png
                    },
                    onClicked: this.item.action,
                    filter: this.item.canActionNow
                }), this.addChild(t), cleverapps.meta.registerControl(this.item.getControlName() + ".HelpButton", this.createListener(function (e) {
                    t.stopAllActions(), e ? t.runAction(new cc.ScaleTo(.2, 1)) : t.runAction(new cc.ScaleTo(.2, 0))
                })), t.setPositionRound(this.styles.helpButton))
            },
            turnOnAttention: function () {
                var e, t;
                this.attention || (e = cleverapps.styles.MenuBarItem.attention, (t = this.attention = new Attention).setPositionRound(e), this.addChild(t))
            },
            turnOffAttention: function () {
                this.attention && (this.attention.removeFromParent(), delete this.attention)
            },
            updateSticker: function (e) {
                var t = this.item.getSticker();
                !this.sticker != !t ? (this.sticker && (e ? this.sticker.removeFromParent() : this.sticker.runAction(new cc.Sequence(new cc.FadeOut(.6), new cc.RemoveSelf)), this.sticker = void 0), "premium" === t && this.showPremiumSticker(e)) : this.sticker && (this.sticker.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.4 * this.sticker.scale), new cc.ScaleTo(.2, this.sticker.scale))), this.text.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.4 * this.text.baseScale), new cc.ScaleTo(.2, this.text.baseScale))))
            },
            showPremiumSticker: function (e) {
                var t = cleverapps.styles.MenuBarItem.premiumSticker,
                    s = this.sticker = new cc.Sprite(bundles.menubar.frames.premium_sticker),
                    i = (s.setAnchorPoint2(), s.setPositionRound(t), this.addChild(s), cleverapps.UI.generateOnlyText("WorkersMenuBarItem.subscription", cleverapps.styles.FONTS.MENUBAR_TIMER_TEXT));
                i.setAnchorPoint2(), i.setPositionRound(t.text), i.fitTo(t.text.width), i.setRotation(t.text.rotation), s.addChild(i), s.setCascadeOpacityEnabled(!0), e || (s.setOpacity(0), s.runAction(
                    new cc.FadeIn(.6)))
            },
            turnOnFinger: function () {
                this.finger = FingerView.hintClick(this, {
                    delay: .8
                })
            },
            turnOffFinger: function () {
                FingerView.remove(this.finger), this.finger = void 0
            }
        })),
        MenuBarWithTimeoutView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            MENUBAR_TEXT: {
                name: "default",
                size: 40
            }
        }), cleverapps.styles.MenuBarItem = {
            noPlusDx: 14,
            bg: {
                width: 200,
                minWidth: 170,
                padding: {
                    right: 20,
                    bottom: 0
                }
            },
            deltaAnimation: {
                dy: -40
            },
            icon: {
                fullInsideBg: !1,
                x: -10,
                y: 0
            },
            sparks: {
                x: -7,
                y: 5
            },
            iconText: {
                position: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                }
            },
            plusButton: {
                offset: {
                    x: 0,
                    y: 0
                }
            },
            totalIcon: {
                x: {
                    align: "center",
                    dx: -15
                },
                y: {
                    align: "center"
                }
            },
            attention: {
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -17
                }
            },
            premiumSticker: {
                x: {
                    align: "center",
                    dx: 45
                },
                y: {
                    align: "center",
                    dy: 58
                },
                text: {
                    x: {
                        align: "center",
                        dx: -21
                    },
                    y: {
                        align: "center",
                        dy: 8
                    },
                    width: 140,
                    rotation: -7
                }
            },
            helpButton: {
                width: 50,
                x: {
                    align: "right",
                    dx: 5
                },
                y: {
                    align: "center"
                }
            }
        }, MenuBarItemView.extend({
            ctor: function (e) {
                this._super(e), this.item.onChangeTimer = this.createListener(
                    this.onChangeTimer.bind(this)), this.item.onRefreshTimer = this.createListener(this.onRefreshTimer.bind(this))
            },
            onChangeTimer: function (e) {
                this.timer && (this.timer instanceof cleverapps.UI.ImageFont && this.item.timerTTF && this.removeTimer(e), this.timer instanceof cleverapps.UI.ImageFont || this.item.timerTTF || this.removeTimer(e)), this.item.timer ? this.createTimer(e) : this.removeTimer(e)
            },
            reset: function (e) {
                this._super(e), this.timerBlock = void 0, this.onChangeTimer(!0)
            },
            animateChange: function (e) {
                return e
            },
            createTimer: function (e) {
                var t;
                this.timerBlock || cleverapps.platform.oneOf(Pliega) || (this.timerBlock = cleverapps.UI.createScale9Sprite(bundles.menubar.frames.bar_timer_png), this.timerBlock.setCascadeOpacityEnabled(!0), t = this.bg.width - 2 * this.styles.timer.padding.x, this.timerBlock.setContentSize2(t, this.styles.timer.height), this.timerBlock.setPositionRound(this.styles.timer.position), this.addChild(this.timerBlock, -1), this.styles.timer.icon && ((t = new cc.Sprite(bundles.timer.frames.timer_png)).setPositionRound(this.styles.timer.icon), this.timerBlock.addChild(t)), this.item.timerTTF ? this.timer = cleverapps.UI.generateOnlyText("", cleverapps.styles.FONTS.MENUBAR_TIMER_TEXT) : this.timer = cleverapps.UI.generateImageText("", cleverapps.styles.FONTS.MENUBAR_TIMER_TEXT, {
                    fixedNumberWidth: !0
                }), this.timer.baseScale = 1, this.timerBlock.addChild(this.timer), e ? this.onRefreshTimer() : (this.timerBlock.setOpacity(0), this.timerBlock.runAction(new cc.Sequence(new cc.FadeIn(.3), new cc.CallFunc(this.onRefreshTimer.bind(this))))))
            },
            removeTimer: function (e) {
                this.timerBlock && (e ? this.timerBlock.removeFromParent() : this.timerBlock.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.RemoveSelf)), this.timerBlock = void 0)
            },
            onRefreshTimer: function () {
                this.timerBlock && (this.timer.setString(this.item.getText()), this.timer.setFont(cleverapps.styles.FONTS.MENUBAR_TIMER_TEXT), this.timer.setScale(this.timer.baseScale), this.timer.fitTo(cleverapps.styles.MenuBarItem.timer.text.width), this.timer.setPositionRound(
                    this.styles.timer.text))
            },
            getTextValue: function () {
                return this.item.getCurrentValue()
            },
            updateText: function (e) {
                if (this.text.removeAllChildren(), this.item.totalIcon) return (t = new cc.Sprite(this.item.totalIcon)).setPositionRound(this.styles.totalIcon), void this.text.addChild(t);
                var t = e.amount,
                    e = e.total,
                    s = cleverapps.UI.generateImageText(t, cleverapps.styles.FONTS.MENUBAR_TEXT),
                    t = (this.styles.noColoredText || (e <= t ? s.setColor(cleverapps.styles.COLORS.GREEN) : t < .1 * e && s.setColor(cleverapps.styles.COLORS.COLOR_RED)), this.separateText = cleverapps.UI.generateImageText("/", cleverapps.styles.FONTS.MENUBAR_TEXT)),
                    e = cleverapps.UI.generateImageText(e, cleverapps.styles.FONTS.MENUBAR_TEXT),
                    s = (this.item.highlightTotal && this.item.highlightTotal() && e.setColor(cleverapps.styles.COLORS.COLOR_BONUS), new cleverapps.Layout([s, t, e], {
                        direction: cleverapps.UI.HORIZONTAL
                    }));
                this.text.setContentSize(s.getContentSize()), s.setPositionRound(this.text.width / 2, this.text.height / 2), this.text.addChild(s)
            },
            textFitTo: function () {
                var e = this.getTextWidth();
                this.text.width > e ? (this.text.baseScale = e / this.text.width, this.text.setScale(this.text.baseScale)) : this.text.baseScale = 1
            },
            addText: function () {
                var e = new cc.Node;
                e.setAnchorPoint2(), this.addChild(e), this.text = e, this.updateText(this.getTextValue()), this.textFitTo(), e.setPositionRound(this.getTextPosition())
            }
        })),
        MenuBarGameLevelView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            MENUBAR_TIMER_TEXT: {
                name: "default",
                size: 32,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.MenuBarItem = cleverapps.overrideStyles(cleverapps.styles.MenuBarItem, {
            timer: {
                icon: {
                    x: {
                        align: "left",
                        dx: 31
                    },
                    y: {
                        align: "center",
                        dy: 1
                    }
                },
                text: {
                    x: {
                        align: "left",
                        dx: 68
                    },
                    y: {
                        align: "center",
                        dy: 0
                    },
                    width: 125
                },
                position: {
                    x: {
                        align: "center",
                        dx: 16
                    },
                    y: {
                        align: "bottom",
                        dy: -49
                    }
                },
                padding: {
                    x: 40
                },
                height: 59
            }
        }), MenuBarItemView.extend({
            ctor: function (e) {
                this._super(e), e.onChangeLevelNo = this.createListener(this.onChangeLevelNo.bind(this)),
                    e.onChangeExpProgress = this.createListener(this.onChangeExpProgress.bind(this))
            },
            reset: function () {
                var e = cleverapps.styles.MenuBarGameLevelView,
                    e = (this.removeAllChildren(), this.setContentSize2(e.width, e.height), this.level = this.createLevel()),
                    t = this.progress = this.createProgress(e);
                this.addChild(t), this.addChild(e), cleverapps.UI.wrap(this), SceneDecors.add(this, cleverapps.skins.getSlot("menuBarLevelItem")), this.onChangeLevelNo(), this.updateProgress(!0), this.addAction(), this.item.worldTitle && this.createWorldTitle()
            },
            getIcon: function () {
                return this.crown
            },
            createWorldTitle: function () {
                var e = cleverapps.styles.MenuBarGameLevelView,
                    t = (this.worldTitle = cleverapps.UI.createScale9Sprite(bundles.menubar.frames.bar_timer_png), this.progress.width - 2 * e.worldTitle.padding.x),
                    s = (this.worldTitle.setContentSize2(t, e.worldTitle.height), this.worldTitle.setPositionRound(e.worldTitle.position), this.progress.addChild(this.worldTitle, -1), cleverapps.UI.generateOnlyText(this.item.worldTitle,
                        cleverapps.styles.FONTS.MENUBAR_WORLD_TITLE_TEXT));
                s.fitTo(.9 * t), this.worldTitle.addChild(s), s.setPositionRound(e.worldTitle.content)
            },
            checkLevelBundle: function (e) {
                var t = this.level && this.level.value;
                t && "big_digits" === t.bundle && (t = ["GameLevel has bundle big_digits", "level preferred bundles - " + t.getPreferredBundles(), "this preferred bundles - " + this.getPreferredBundles()].join(" "), cleverapps.throwAsync(t, e))
            },
            createLevel: function () {
                var e = cleverapps.styles.MenuBarGameLevelView,
                    t = new cc.Scale9Sprite(bundles.menubar.frames.menubar_round_bg_png),
                    s = (t.setPositionRound(t.width / 2, t.height / 2), new cc.Node),
                    t = (s.setAnchorPoint2(), s.setContentSize(t.width, t.height), s.setPositionRound(s.width / 2 + e.level.offset.x, this.height / 2 + e.level.offset.y), s.addChild(t), cleverapps.UI.generateImageText("", cleverapps.styles.FONTS.MENUBAR_LEVEL_TEXT)),
                    i = cleverapps.travelBook.getCurrentPage().id,
                    n = e.value.offset[i] || e.value.offset,
                    n = (t.setPositionRound(s.width / 2 + n.x, s.height / 2 + n.y), e.crown.offset[i] || e.crown.offset),
                    i = this.crown = new cleverapps.Spine(bundles.menubar.jsons.crown_json);
                return i.setPositionRound(n.x, s.height + n.y), i.setAnimation(0, "idle", !0), s.value = t, s.crown = i, s.addChild(t), s.addChild(i), setTimeout(this.createListener(this.checkLevelBundle.bind(this, new Error("checkLevelBundle"))), 100), s
            },
            createProgress: function (e) {
                var t = cleverapps.styles.MenuBarGameLevelView,
                    s = ScaledProgressBar.Types.green_large,
                    s = (s = cleverapps.gameLevel.withOwnLevel ? ScaledProgressBar.Types.blue_large_round : s).create(),
                    e = (s.setAnchorPoint(0, .5), s.setLength(this.width - e.width - t.margin), s.setPositionRound(e.width + t.margin, this.height / 2), cleverapps.UI.generateImageText("", cleverapps.styles.FONTS.MENUBAR_PROGRESS_TEXT));
                return e.setPositionRound(s.width / 2 + t.exp.offset.x, s.height / 2 + t.exp.offset.y), s.exp = e, s.addChild(e), s
            },
            updateProgress: function (e) {
                var t = cleverapps.styles.MenuBarGameLevelView,
                    s = this.progress,
                    i = this.item.getCurrentValue(),
                    n = i.amount,
                    i = i.total,
                    o = n / i * 100;
                e ? s.setPercentage(o) : s.animatedChange(o),
                    s.exp.setString(n + "/" + i), s.exp.setFontSize(s.exp.font.size), s.exp.fitTo(s.width - t.exp.padding.x, s.height - t.exp.padding.y)
            },
            onChangeExpProgress: function () {
                this.updateProgress(), this.progress.exp.stopAllActions(), this.progress.exp.runAction(new cc.Sequence(new cc.PlaySound(bundles.menubar.urls.exp_fly_finish_effect), new cc.ScaleTo(.2, 1.4), new cc.ScaleTo(.2, 1))), this.animateIcon()
            },
            onChangeLevelNo: function () {
                var e = cleverapps.styles.MenuBarGameLevelView,
                    t = this.level;
                t.value.setString(this.item.getCurrentValue().level), t.value.fitTo(t.width - 2 * e.value.padding.x, t.height - 2 * e.value.padding.y)
            },
            animateIcon: function () {
                this.crown.setAnimationAndIdleAfter("animation", "idle")
            },
            addAction: function () {
                cleverapps.config.debugMode && cleverapps.UI.onClick(this, this.item.debugAction)
            }
        })),
        MenuBarView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            MENUBAR_LEVEL_TEXT: {
                name: "default",
                size: 86
            },
            MENUBAR_PROGRESS_TEXT: {
                name: "default",
                size: 52
            },
            MENUBAR_WORLD_TITLE_TEXT: {
                name: "nostroke",
                size: 30
            }
        }),
            cleverapps.styles.MenuBarGameLevelView = {
                width: 455,
                height: 65,
                margin: -52,
                level: {
                    offset: {
                        x: 23,
                        y: 0
                    }
                },
                bar: {
                    offset: {
                        x: -1,
                        y: 3
                    }
                },
                exp: {
                    offset: {
                        x: 16,
                        y: 3
                    },
                    padding: {
                        x: 80,
                        y: 13
                    }
                },
                value: {
                    padding: {
                        x: 26,
                        y: 13
                    },
                    offset: {
                        x: 1,
                        y: 10,
                        collections: {
                            x: 0,
                            y: 0
                        }
                    }
                },
                crown: {
                    offset: {
                        x: 9,
                        y: -13,
                        collections: {
                            x: 11,
                            y: -21
                        }
                    }
                },
                worldTitle: {
                    content: {
                        x: {
                            align: "center",
                            dx: 0
                        },
                        y: {
                            align: "center",
                            dy: 0
                        }
                    },
                    position: {
                        x: {
                            align: "center",
                            dx: 0
                        },
                        y: {
                            align: "bottom",
                            dy: -50
                        }
                    },
                    padding: {
                        x: 40
                    },
                    height: 59
                }
            }, cc.Node.extend({
                ctor: function () {
                    this._super();
                    var e = cleverapps.styles.MenuBar,
                        t = cleverapps.menuBar.getSceneItems().filter(function (e) {
                            return "CoinsItem" !== e.name || !cleverapps.gameModes.hideMenuBarCoinsItem
                        }).map(function (e) {
                            return new (e.getViewClass())(e)
                        }),
                        e = this.layout = new cleverapps.Layout(t, {
                            direction: cleverapps.UI.HORIZONTAL,
                            margin: e.margin
                        });
                    this.addChild(e), this.views = t.map(function (e) {
                        var t = new HidingNode(e, cleverapps.UI.VERTICAL),
                            s = e.item.hiddenByDefault;
                        return "GoldItem" === e.item.name && cleverapps.gameModes.showMenuBarGoldItem && (s = void 0),
                            cleverapps.meta.registerControl(e.item.getControlName(), e, s), t
                    }), this.updateContentSize()
                },
                reshape: function (e, t) {
                    var s = cleverapps.styles.MenuBar,
                        i = this.layout,
                        s = (i.options.margin = s.margin, i.reshape(), i.width > t && (i.options.margin = s.smallMargin, i.reshape()), this.views[1]);
                    i.width < t && s && s.target && s.target.centerAlign && s.x < e / 2 && e / 2 + s.width / 2 <= t && (s.x = e / 2, i.width = s.x + s.width / 2), this.updateContentSize()
                },
                updateContentSize: function () {
                    this.setContentSize2(this.layout.width * this.layout.scale, this.layout.height * this.layout.scale), this.layout.setPositionRound(this.width / 2, this.height / 2)
                }
            })),
        Attention = (cleverapps.styles.MenuBar = {
            margin: 16,
            smallMargin: 12
        }, cc.Sprite.extend({
            ctor: function () {
                this._super(bundles.attention.frames.attention_png), this.setAnchorPoint2(), this.setLocalZOrder(2)
            },
            pulse: function () {
                void 0 === this.baseScale && (this.baseScale = this.scale), this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.2, 1.3 * this.baseScale).easing(cc.easeOut(2)), new cc.ScaleTo(.15, this.baseScale).easing(cc.easeIn(2)), new cc.ScaleTo(.2, 1.2 * this.baseScale).easing(cc.easeOut(2)), new cc.ScaleTo(.15, this.baseScale).easing(cc.easeIn(2)), new cc.DelayTime(3))))
            },
            jump: function () {
                void 0 === this.baseScale && (this.baseScale = this.scale), this.runAction(new cc.Repeat(new cc.Sequence(new cc.ScaleTo(.4, 1.15 * this.baseScale).easing(cc.easeOut(2)), new cc.ScaleTo(.3, this.baseScale).easing(cc.easeIn(2))), 3))
            }
        })),
        ScaledProgressBar = (cleverapps.UI.ImageFont = cc.Node.extend({
            ctor: function (e, t, s) {
                this._super(), this.params = s || {}, this.letters = new cc.Node, this.letters.setAnchorPoint2(0, 0), this.letters.setCascadeOpacityEnabled(!0), this.letters.setCascadeColorEnabled(!0), this.addChild(this.letters), this.setFont(t), this.setAnchorPoint(.5, .5), this.setCascadeOpacityEnabled(!0), this.setString(e), this.setCascadeColorEnabled(!0)
            },
            setHorizontalAlignment: function () { },
            setVerticalAlignment: function () { },
            setDimensions: function () { },
            fitTo: function (e, t) {
                for (var s = 0; s < 10;) {
                    var i = this.width,
                        n = this.height,
                        o = this.canAttachLastLine();
                    if (!(e && e < i || t && t < n || o)) break;
                    s++;
                    var o = 1,
                        a = 1,
                        i = (e && e < i && (o = e / i), t && t < n && (a = t / n), .9),
                        n = Math.min(o, a);
                    if (.9 < n && n < 1 && (i = n), this.setFontSize(Math.floor(this.getFontSize() * i)), this.getFontSize() < cleverapps.UI.ImageFont.getFontSizeThreshold()) return void this.setFontSize(cleverapps.UI.ImageFont.getFontSizeThreshold())
                }
            },
            countToAnimation: function (e, t, s) {
                this.runAction(new ImageFontCountTo(e, t, s))
            },
            canAttachLastLine: function () {
                return !1
            },
            setFont: function (s) {
                var t = s.name || "default",
                    e = cleverapps.config.fonts.filter(function (e) {
                        return e.name === t && cleverapps.bundleLoader.isLoaded(e.bundle)
                    }).sort(function (e, t) {
                        return Math.abs(1 - s.size / e.size) - Math.abs(1 - s.size / t.size)
                    }),
                    i = e[0],
                    n = this.getPreferredBundles();
                if (void 0 === (i = n ? e.filter(function (e) {
                    e = bundles[e.bundle].injectTo || [e.bundle];
                    return 0 < cleverapps.intersect(e, n).length
                })[0] || i : i)) throw console.log(s), "No image font";
                this.font = s, this.baseFont = i, this.bundle = i.bundle, this.prefix = i.name + i.originalSize + "pt_",
                    this.strokeSize = s.stroke ? s.stroke.size : 0, this.shadowOffset = s.shadow ? cc.size(s.shadow.direction.width || s.shadow.direction.x || 0, s.shadow.direction.height || s.shadow.direction.y || 0) : cc.size(0, 0), this.setColor(s.color || cleverapps.styles.COLORS.WHITE), this.setFontSize(s.size);
                e = this.getString();
                e && this.setString(e)
            },
            onEnterTransitionDidFinish: function () {
                this._super();
                var e = this.getFontSize(),
                    t = this.getColor();
                this.setFont(this.font), this.setFontSize(e), this.setColor(t)
            },
            setString: function (e) {
                var t;
                this.stopListeners || (this.string = "" + e, this.letters.removeAllChildren(!0), t = cc.size(0, 0), this.string.split("").forEach(function (e) {
                    this.createLetter(e, t)
                }, this), this.letters.setContentSize2(t), this.setFontSize(this.getFontSize()))
            },
            createLetter: function (e, t) {
                cleverapps.UI.ImageFont.LETTERS_MAP[e] && (e = cleverapps.UI.ImageFont.LETTERS_MAP[e]);
                var s = bundles[this.bundle].frames[this.prefix + e],
                    s = (s || (console.log(this), console.log("No image for letter: ", e), cleverapps.throwAsync(
                        "No image for letter: " + e + ", bundle - " + this.bundle + ", prefix - " + this.prefix)), new cc.Sprite(s)),
                    i = 2 * Math.round(s.width / 2);
                this.params.fixedNumberWidth && "0" <= e && e <= "9" && (this.baseFont.zeroLetterWidth || (e = new cc.Sprite(bundles[this.bundle].frames[this.prefix + "0"]).width, this.baseFont.zeroLetterWidth = 2 * Math.round(e / 2)), i = this.baseFont.zeroLetterWidth * cleverapps.styles.UI.ImageFont.fixedNumberWidth.stretch), s.setAnchorPoint2(.5, 0), s.setPositionRound(t.width + i / 2, 0), this.letters.addChild(s), t.width += i, t.height = Math.max(t.height, s.height)
            },
            getString: function () {
                return this.string
            },
            getFontSize: function () {
                return Math.floor(this.letters.scale * this.baseFont.size)
            },
            setFontSize: function (e) {
                var t = this.properties = cc.LabelTTF.__getFontProperties(cleverapps.UI.getFontName(this.font.font), e),
                    s = e / this.baseFont.size;
                this.letters.setScale(s), this.letters.setPosition(0, t.descent - Math.ceil(e * cleverapps.styles.UI.ImageFont.SKIP_RESOLUTION.DESCENTS[this.baseFont.folder]) + this.strokeSize + Math.abs(
                    this.shadowOffset.height)), this.setContentSize2(this.letters.width * this.letters.scale, t.ascent + t.descent + 2 * this.strokeSize + 2 * Math.abs(this.shadowOffset.height))
            }
        }), cleverapps.UI.ImageFont.MAX_MAGNITUDE = 1.25, cleverapps.UI.ImageFont.LETTERS_MAP = {
            "/": "slash",
            "+": "plus",
            "-": "minus",
            ":": "colon",
            "#": "sharp",
            ".": "point",
            " ": "space",
            "[": "left_square_bracket",
            "]": "right_square_bracket",
            "*": "asterisk",
            "%": "percent"
        }, cleverapps.UI.ImageFont.getFontSizeThreshold = function () {
            var e = 8;
            return (e = !cc.sys.isMobile ? 5 : e) * resolutionScale
        }, cleverapps.UI.ImageFont.IsApplicable = function (e, t) {
            if (!t) return !0;
            for (var s, i, n = e.name || "default", o = 0; o < cleverapps.config.fonts.length; o++) {
                var a = cleverapps.config.fonts[o];
                a.name === n && cleverapps.bundleLoader.isLoaded(a.bundle) && (s = a.bundle, i = a.name + a.originalSize + "pt_")
            }
            if (!s) return !1;
            for (o = 0; o < t.length; o++) {
                var r = cleverapps.UI.ImageFont.LETTERS_MAP[t[o]] || t[o];
                if (!bundles[s].frames[i + r]) return !1
            }
            return !0
        }, cleverapps.UI.ImageFont.intertypeSetString = function (e) {
            e.textObj instanceof cleverapps.UI.ImageFont === cleverapps.UI.ImageFont.IsApplicable(e.font, e.string) ? e.textObj.setString(e.string) : e.recreateFunc(e.string)
        }, cleverapps.styles.UI.ImageFont = {
            SKIP_RESOLUTION: {
                DESCENTS: {
                    "marvin-round": .1,
                    "marvin-round-nostroke": .1,
                    formal: 0,
                    "custom/custom_digits": .15,
                    bryndanwrite: .015,
                    "bryndanwrite-nostroke": .015,
                    "custom/heroes_custom_digits": 0
                }
            },
            fixedNumberWidth: {
                stretch: 1
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.progressFrames = e.progressFrames, this.delimiters = e.delimiters, this.layout = e.layout || ScaledProgressBar.HORIZONTAL, this.sizeDirty = !0, e.background && (this.background = cleverapps.UI.createScale9Sprite(e.background), this.background.setAnchorPoint(0, 0), this.addChild(this.background), this.applyCapInsets(this.background)), this.progress = cleverapps.UI.createScale9Sprite(e.progress), this.progress.setAnchorPoint(0, 0), this.addChild(this.progress), this.applyCapInsets(this.progress);
                var t = e.background ? cc.size(this.background.width,
                    this.background.height) : cc.size(this.progress.width, this.progress.height);
                this.percentage = 0, this.setContentSize2(t.width, t.height), this.setAnchorPoint2(), e.barText && this.createBarText(e.barText), this.minSize = e.minSize, this.onChange()
            },
            onEnterTransitionDidFinish: function () {
                this._super(), this.updateProgressFrame()
            },
            applyCapInsets: function (e) {
                this.layout === ScaledProgressBar.HORIZONTAL ? e.setCapInsets(cc.rect(e.width / 2 - 1, e.height / 3, 2, e.height / 3)) : e.setCapInsets(cc.rect(e.width / 3, e.height / 2 - 1, e.width / 3, 2))
            },
            onChange: function () {
                this.background && this.sizeDirty && this.background.setContentSize2(this.width, this.height), this.barTextBlock && this.sizeDirty && this.updateBarTextPosition(), this.updateProgressFrame();
                var e = cc.size(this.width, this.height),
                    t = this.minSize || cc.size(this.progress._spriteFrame.getOriginalSize());
                this.layout === ScaledProgressBar.HORIZONTAL ? e.width = this.percentage ? Math.max(t.width, e.width * this.percentage / 100) : 0 : e.height = this.percentage ? Math.max(t.height,
                    e.height * this.percentage / 100) : 0, this.progress.setContentSize(e.width, e.height), this.sizeDirty = !1
            },
            animatedChange: function (e, t) {
                t = t || {}, (e = Math.max(Math.min(e, 100), 0)) !== this.percentage && (this.stopAnimatedChangeData(), this.updateProgressFrame(), e = new ScaledProgressBarProgressTo(t.time || .8, e), !1 !== t.easing && e.easing(t.easing || cc.easeCubicActionOut()), t.callback && (e = new cc.Sequence(e, new cc.CallFunc(t.callback))), this.isRunning() && (this.animatedChangeAction = this.runAction(e), this.animatedChangeAction.setTag(ScaledProgressBar.ANIMATE_CHANGE_ACTION_TAG)))
            },
            updateProgressFrame: function () {
                if (this.progressFrames) {
                    var e, t;
                    for (t in this.progressFrames) this.percentage >= t && (e = this.progressFrames[t]);
                    (e = processVirtualImage(e, this.getPreferredBundles())) && this.currentFrame !== e && (this.currentFrame = e, this.progress.setSpriteFrame(new cc.Sprite(e).getSpriteFrame()))
                }
            },
            setLength: function (e) {
                this.layout === ScaledProgressBar.VERTICAL ? this.setContentSize2(this.width, e) : this.setContentSize2(e, this.height),
                    this.sizeDirty = !0, this.onChange()
            },
            setLayout: function (e) {
                this.layout = e, this.onChange()
            },
            stopAnimatedChangeData: function () {
                this.animatedChangeAction && !this.animatedChangeAction.isDone() && (this.stopActionByTag(ScaledProgressBar.ANIMATE_CHANGE_ACTION_TAG), delete this.animatedChangeAction)
            },
            setPercentage: function (e) {
                this.stopAnimatedChangeData(), e = Math.max(Math.min(e, 100), 0), this.percentage !== e && (this.percentage = e, this.onChange())
            },
            getPercentage: function () {
                return this.percentage
            },
            createBarText: function (e) {
                this.textOptions = e, this.textOptions.dx = this.textOptions.dx || 0, this.textOptions.dy = this.textOptions.dy || 0;
                var t, s = e.font || cleverapps.styles.FONTS.SMALL_WHITE_TEXT,
                    s = (this.barText = cleverapps.UI.generateImageText(e.text || "", s), this.barText.fontUsed = s, [this.barText]);
                e.icon && (t = this.icon = new cc.Sprite(e.icon), e.iconBeforeText ? s.unshift(t) : s.push(t), this.barText.setAnchorPoint2(1, .5)), this.barTextBlock = new cleverapps.Layout(s, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.iconMargin
                }),
                    this.addChild(this.barTextBlock)
            },
            addDelimiters: function (e, t) {
                var s, i;
                for (i in this.delimiters) this.percentage >= i && (s = this.delimiters[i]);
                if (!s) return !1;
                for (var n = 1; n <= Math.min(e, t - 1); n++) {
                    var o = cleverapps.UI.createSprite(s);
                    o.setAnchorPoint(0, 0), o.setPositionRound(n * this.width / t - o.width, 0), this.addChild(o)
                }
                return !0
            },
            updateBarTextPosition: function () {
                this.barTextBlock.setPositionRound(this.width / 2 + this.textOptions.dx, this.height / 2 + this.textOptions.dy), this.barTextBlock.reshape()
            },
            updateBarText: function (t) {
                var s;
                this.barText && (s = this.barText.fontUsed, cleverapps.UI.ImageFont.intertypeSetString({
                    textObj: this.barText,
                    string: t,
                    font: s,
                    recreateFunc: function () {
                        var e = cleverapps.UI.ImageFont.IsApplicable(s, t) ? cleverapps.UI.generateImageText(t, s) : cleverapps.UI.generateOnlyText(t, s);
                        this.barText.parent.addChild(e), e.fontUsed = s, this.barText.removeFromParent(), this.barText = e
                    }.bind(this)
                }), this.updateBarTextPosition())
            }
        })),
        ScaledProgressBarProgressTo = cc.ProgressTo.extend({
            update: function (e) {
                this.target instanceof ScaledProgressBar && (e = this._computeEaseTime(e), this.target.percentage = Math.max(Math.min(this._from + (this._to - this._from) * e, 100), 0), this.target.onChange())
            }
        }),
        SideBar = (ScaledProgressBar.HORIZONTAL = 0, ScaledProgressBar.VERTICAL = 1, ScaledProgressBar.ANIMATE_CHANGE_ACTION_TAG = "animateChange", ScaledProgressBar.Types = cleverapps.overrideTemplates({}, {
            blue: {
                progress: bundles.progress_bar.frames.bar_blue,
                background: bundles.progress_bar.frames.bg_dark
            },
            blue_with_frames: {
                progress: bundles.progress_bar.frames.bar_blue,
                background: bundles.progress_bar.frames.bg_dark,
                progressFrames: {
                    0: bundles.progress_bar.frames.bar_red,
                    30: bundles.progress_bar.frames.bar_orange,
                    70: bundles.progress_bar.frames.bar_blue
                },
                delimiters: {
                    0: bundles.progress_bar.frames.delimiter_red,
                    30: bundles.progress_bar.frames.delimiter_orange,
                    70: bundles.progress_bar.frames.delimiter_blue
                }
            },
            blue_small: {
                progress: bundles.progress_bar.frames.bar_blue_small,
                background: bundles.progress_bar.frames.bg_dark_small
            },
            blue_small_with_frames: {
                progress: bundles.progress_bar.frames.bar_blue_small,
                background: bundles.progress_bar.frames.bg_dark_small,
                progressFrames: {
                    0: bundles.progress_bar.frames.bar_red_small,
                    30: bundles.progress_bar.frames.bar_orange_small,
                    70: bundles.progress_bar.frames.bar_blue_small
                }
            },
            blue_large_with_frames: {
                progress: bundles.progress_bar.frames.bar_blue_large,
                background: bundles.progress_bar.frames.bg_dark_large,
                progressFrames: {
                    0: bundles.progress_bar.frames.bar_red_large,
                    30: bundles.progress_bar.frames.bar_orange_large,
                    70: bundles.progress_bar.frames.bar_blue_large
                }
            },
            green: {
                progress: bundles.progress_bar.frames.bar_green,
                background: bundles.progress_bar.frames.bg_green
            },
            green_large: {
                progress: bundles.progress_bar.frames.bar_green_large,
                background: bundles.progress_bar.frames.bg_green_large
            },
            red: {
                progress: bundles.progress_bar.frames.bar_red,
                background: bundles.progress_bar.frames.bg_dark
            },
            red_small: {
                progress: bundles.progress_bar.frames.bar_red_small,
                background: bundles.progress_bar.frames.bg_dark_small
            },
            blue_large_round: {
                progress: bundles.progress_bar.frames.bar_blue_large_round,
                background: bundles.progress_bar.frames.bg_green_large
            }
        }), cleverapps.values(ScaledProgressBar.Types).forEach(function (s) {
            s.create = function (e) {
                var t = cleverapps.clone(s),
                    e = (Object.assign(t, e || {}), new ScaledProgressBar(t));
                return e.setAnchorPoint2(0, 0), e
            }
        }), cleverapps.Chest = function (e) {
            this.locked = !1, this.changeLockedListener = function () { }, this.storage = e.storage, this.serverTaskName = e.serverTaskName, e.isNewUser ? (this.initializeForNewUser(), this.save()) : this.load()
        }, cleverapps.Chest.prototype.fromJSON = function (e) {
            this.locked = e
        }, cleverapps.Chest.prototype.toJSON = function () {
            return this.locked
        }, cleverapps.Chest.prototype.load = function () {
            var e = cleverapps.DataLoader.load(this.storage);
            void 0 === e ? (this.initializeForNewUser(), this.save()) : this.fromJSON(e)
        }, cleverapps.Chest.prototype.save = function (e) {
            cleverapps.DataLoader.save(this.storage, this.toJSON()),
                this.serverTaskName && !1 !== e && cleverapps.synchronizer.addUpdateTask(this.serverTaskName)
        }, cleverapps.Chest.prototype.initializeForNewUser = function () {
            this.locked = !1
        }, cleverapps.Chest.prototype.unlock = function () {
            this.locked = !1, this.changeLockedListener()
        }, cleverapps.Chest.prototype.open = function () {
            this.locked = !0, this.changeLockedListener()
        }, cleverapps.DailyChest = function (e) {
            cleverapps.config.debugMode && (cleverapps.DailyChest.TIMEOUT = "10 minutes"), e = Object.assign({
                storage: cleverapps.DataLoaderTypes.DAILY_CHEST,
                interval: cleverapps.parseInterval(cleverapps.DailyChest.TIMEOUT)
            }, e), this.onUnlockingStarted = function () { }, this.interval = e.interval, cleverapps.Chest.call(this, e)
        }, cleverapps.DailyChest.prototype = Object.create(cleverapps.Chest.prototype), cleverapps.DailyChest.prototype.constructor = cleverapps.DailyChest, cleverapps.DailyChest.prototype.initializeForNewUser = function () {
            this.locked = !0, this.startUnlockFromScratch()
        }, cleverapps.DailyChest.prototype.fromJSON = function (e) {
            this.locked = !0,
                this.setWhenUnlock(e.nextTime)
        }, cleverapps.DailyChest.prototype.toJSON = function () {
            return {
                nextTime: this.when
            }
        }, cleverapps.DailyChest.prototype.startUnlockFromScratch = function () {
            this.setWhenUnlock(Date.now() + this.interval)
        }, cleverapps.DailyChest.prototype.open = function () {
            this.locked = !0, this.startUnlockFromScratch(), this.changeLockedListener()
        }, cleverapps.DailyChest.prototype.resetUnlockCountdown = function () {
            void 0 !== this.countdown ? this.countdown.resetTimeLeft(this.when - Date.now()) : this.countdown = new cleverapps.CountDown(this.when - Date.now(), {
                onFinish: this.unlock.bind(this),
                permanent: !0
            }), this.onUnlockingStarted()
        }, cleverapps.DailyChest.prototype.setWhenUnlock = function (e) {
            e = e || Date.now(), this.when = Math.min(e, Date.now() + this.interval), this.save(), this.resetUnlockCountdown()
        }, cleverapps.DailyChest.TIMEOUT = "3 hours", function () {
            this.icons = [], this.availableIcons = this.loadAvailable(), this.savePositions(), this.clearListeners()
        }),
        SideBarIcon = (SideBar.prototype.loadAvailable = function () {
            var e = [];
            return "merge" === cleverapps.config.type ? (e.push(ExitExpeditionIcon), e.push(QuestsSideBarIcon), bundles.sidebar.jsons.free_rubies_json && cleverapps.platform.oneOf(IOSCh) && e.push(FreeRubiesIcon), e.push(DailyTasksIcon), e.push(PackIcon), e.push(ClansCupIcon), e.push(InviteIcon), e.push(LandmarkDonorIcon), e.push(PawBoxIcon)) : (cleverapps.config.features.includes("dailylevel") && e.push(DailyLevelIcon), cleverapps.starChest && e.push(StarChestIcon), "undefined" != typeof match3 && match3.heroes && e.push(HeroesIcon), e.push(PackIcon), cleverapps.config.features.includes("piggybank") && e.push(PiggyBankIcon), e.push(DailyCupIcon), e.push(InviteIcon)), e.map(function (e) {
                return new e
            })
        }, SideBar.prototype.savePositions = function () {
            this.availableIcons.forEach(function (e, t) {
                e.availableIndex = t
            })
        }, SideBar.PRIORITY_NORMAL = 1, SideBar.PRIORITY_REDUNDANT = 0, SideBar.prototype.clearListeners = function () {
            this.onAddIcon = function () { }, this.onMoveIcon = function () { }, this.onRemoveIcon = function (e) { }, this.onForceIcon = function (e) { };
            for (
                var e = 0; e < this.icons.length; e++) this.icons[e].clearListeners()
        }, SideBar.prototype.getDefaultIconByClassName = function (e) {
            for (var t = 0; t < this.availableIcons.length; t++)
                if (this.availableIcons[t] instanceof e) return this.availableIcons[t]
        }, SideBar.prototype.getIconByClassName = function (e) {
            for (var t = 0; t < this.icons.length; t++)
                if (this.icons[t] instanceof e) return this.icons[t]
        }, SideBar.prototype.resetByClassName = function (e) {
            e = this.getDefaultIconByClassName(e);
            e && (e.resetState(), e.available && -1 === this.icons.indexOf(e) && this.addIcon(e), e.available || -1 === this.icons.indexOf(e) || this.removeIcon(e))
        }, SideBar.prototype.refreshAllIcons = function () {
            var e = this.availableIcons;
            e.forEach(function (e) {
                e.resetState()
            }), e.forEach(function (e) {
                e.available || -1 === this.icons.indexOf(e) || this.removeIcon(e)
            }, this), e.forEach(function (e) {
                e.available && -1 === this.icons.indexOf(e) && this.addIcon(e)
            }, this)
        }, SideBar.prototype.anyIconWithForceIndex = function () {
            for (var e = 0; e < this.icons.length; e++) {
                var t = this.icons[e];
                if (
                    !t.locked && e < SideBar.SLOTS.length) {
                    t = t.getForce();
                    if (t && !cleverapps.forces.isShown(t.id)) return e
                }
            }
        }, SideBar.prototype.showAnyForce = function () {
            var t = this.anyIconWithForceIndex();
            void 0 !== t && cleverapps.meta.display({
                focus: "sidebarIconForce",
                control: this.icons[t].name,
                actions: [function (e) {
                    cleverapps.timeouts.setTimeout(e, 1100)
                }, function (e) {
                    void 0 !== (t = this.anyIconWithForceIndex()) ? (this.onForceIcon(t), cleverapps.forces.onceForceClosed = e) : e()
                }.bind(this)]
            })
        }, SideBar.prototype.addTemporaryIcon = function (e) {
            this.availableIcons.push(e);
            for (var t = this.availableIcons.length - 2; 0 <= t && e.priority > this.availableIcons[t].priority; t--) this.availableIcons[t + 1] = this.availableIcons[t], this.availableIcons[t] = e;
            this.savePositions(), e.available && this.addIcon(e)
        }, SideBar.prototype.removeTemporaryIcon = function (e) {
            var t = this.availableIcons.indexOf(e); - 1 !== t && (this.availableIcons.splice(t, 1), this.savePositions()), this.removeIcon(e)
        }, SideBar.prototype.addIcon = function (e) {
            for (var t = this.icons.length,
                s = this.icons.length - 1; 0 <= s && !(this.icons[s].availableIndex < e.availableIndex); s--) t--;
            for (s = this.icons.length - 1; t <= s; s--) this.icons[s + 1] = this.icons[s], this.onMoveIcon(s + 1, s);
            this.icons[t] = e, this.onAddIcon(t)
        }, SideBar.prototype.findMissionIcon = function (e) {
            for (var t = 0; t < this.availableIcons.length; t++) {
                var s = this.availableIcons[t];
                if (s instanceof MissionIcon && s.mission.type === e) return s
            }
        }, SideBar.prototype.findOfferIcon = function (e) {
            for (var t = 0; t < this.availableIcons.length; t++) {
                var s = this.availableIcons[t];
                if (s instanceof OfferIcon && s.offer.type === e) return s
            }
        }, SideBar.prototype.getTeaserIcon = function () {
            return this.availableIcons.filter(function (e) {
                return e instanceof TeaserIcon
            })[0]
        }, SideBar.prototype.removeIcon = function (e) {
            var t = this.icons.indexOf(e);
            if (-1 !== t) {
                for (this.onRemoveIcon(t); t < this.icons.length - 1; t++) this.icons[t] = this.icons[t + 1], this.onMoveIcon(t, t + 1);
                this.icons.pop()
            }
        }, SideBar.LEFT_COLUMN = 0, SideBar.RIGHT_COLUMN = 1, SideBar.SLOTS = [{
            row: 0,
            col: SideBar.LEFT_COLUMN
        }, {
            row: 1,
            col: SideBar.LEFT_COLUMN
        }, {
            row: 2,
            col: SideBar.LEFT_COLUMN
        }, {
            row: 0,
            col: SideBar.RIGHT_COLUMN
        }, {
            row: 1,
            col: SideBar.RIGHT_COLUMN
        }, {
            row: 2,
            col: SideBar.RIGHT_COLUMN
        }, {
            row: 3,
            col: SideBar.LEFT_COLUMN
        }, {
            row: 3,
            col: SideBar.RIGHT_COLUMN
        }, {
            row: 4,
            col: SideBar.LEFT_COLUMN
        }, {
            row: 4,
            col: SideBar.RIGHT_COLUMN
        }], SideBar.ICONS = [], function (e) {
            this.available = !1, this.animation = void 0, this.locked = !1, this.disabled = !1, this.lottery = !1, this.attention = !1, this.title = void 0, this.titleIcon = void 0, this.leftTime = void 0, this.priority = SideBar.PRIORITY_NORMAL, Object.assign(this, e), this.clearListeners()
        }),
        SideBarIconView = (SideBarIcon.prototype.clearListeners = function () {
            this.onShowIconListener = function () { }, this.onUnlockListener = function () { }, this.onEnableListener = function () { }, this.onDisableListener = function () { }, this.onAddLotteryListener = function () { }, this.onRemoveLotteryListener = function () { }, this.onAttentionOnListener = function () { }, this.onAttentionOffListener = function () { }, this.onFingerOnListener = function () { },
                this.onFingerOffListener = function () { }, this.onChangeTitleListener = function () { }, this.onStartTimerListener = function () { }, this.onRemoveTimerListener = function () { }
        }, SideBarIcon.prototype.getTargetTypes = function () {
            return this.targets
        }, SideBarIcon.prototype.setAnimation = function (e, t) {
            this.animation !== e && (this.animation = e, this.skin = t, this.onShowIconListener())
        }, SideBarIcon.prototype.setIcon = function (e) {
            this.icon !== e && (this.icon = e, this.onShowIconListener())
        }, SideBarIcon.prototype.setDisabled = function (e) {
            this.disabled !== (e = !!e) && (this.disabled = e, this.disabled ? this.onDisableListener() : this.onEnableListener())
        }, SideBarIcon.prototype.setLocked = function (e) {
            this.locked !== (e = !!e) && (this.locked = e, this.locked || this.onUnlockListener())
        }, SideBarIcon.prototype.setLottery = function (e) {
            this.lottery !== (e = !!e) && ((this.lottery = e) ? this.onAddLotteryListener() : this.onRemoveLotteryListener())
        }, SideBarIcon.prototype.setAttention = function (e) {
            this.attention !== (e = !!e) && ((this.attention = e) ? this.onAttentionOnListener() : this.onAttentionOffListener())
        }, SideBarIcon.prototype.setFinger = function (e) {
            this.finger !== (e = !!e) && ((this.finger = e) ? this.onFingerOnListener() : this.onFingerOffListener())
        }, SideBarIcon.prototype.setTitle = function (e) {
            this.title !== e && (this.title = e, this.onChangeTitleListener())
        }, SideBarIcon.prototype.setLeftTime = function (e) {
            this.leftTime !== e && (this.leftTime = e), 0 < this.leftTime ? this.onStartTimerListener() : this.onRemoveTimerListener()
        }, SideBarIcon.prototype.resetState = function () { }, SideBarIcon.prototype.getLockedTipData = function () { }, SideBarIcon.prototype.onPressed = function () { }, SideBarIcon.prototype.getForce = function () { }, SideBarIcon.prototype.removeFromSideBar = function () {
            cleverapps.sideBar.removeIcon(this)
        }, SideBarIcon.prototype.getTitle = function () {
            return this.locked ? this.locked.lockedEvent ? Messages.get("Soon") : Messages.get("IconLocked.TextDefault", {
                levelNo: cleverapps.humanReadableNumber({
                    floatLevel: this.locked.level
                })
            }) : this.title
        }, SideBarIcon.prototype.getToolTip = function () {
            if (this.locked) return {
                position: cleverapps.styles.UI.Tooltip.LOCATION.above,
                text: Messages.get("IconLocked.TipDefault", {
                    level: this.getLockedTipData()
                })
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this.model = e, this._super(), this.setAnchorPoint2(), this.show(), e.onShowIconListener = this.createListener(this.showIcon.bind(this)), e.onUnlockListener = this.createListener(this.unlock.bind(this)), e.onEnableListener = this.createListener(this.enable.bind(this)), e.onDisableListener = this.createListener(this.disable.bind(this)), e.onAttentionOnListener = this.createListener(this.turnOnAttention.bind(this)), e.onAttentionOffListener = this.createListener(this.turnOffAttention.bind(this)), e.onFingerOnListener = this.createListener(this.turnOnFinger.bind(this)), e.onFingerOffListener = this.createListener(this.turnOffFinger.bind(this)), e.onChangeTitleListener = this.createListener(this.addTitle.bind(this)), e.onAddLotteryListener = this.createListener(this.addLotteryIcon.bind(this)), e.onRemoveLotteryListener = this.createListener(
                    this.removeLotteryIcon.bind(this)), e.onStartTimerListener = this.createListener(this.runTimer.bind(this)), e.onRemoveTimerListener = this.createListener(this.hideTimer.bind(this)), (this.model.animation || this.model.icon) && this.showIcon(), this.model.locked && this.setLocked(), this.model.disabled && this.disable(), this.model.attention && this.turnOnAttention(), this.model.finger && this.turnOnFinger(), this.model.title && this.addTitle(), 0 < this.model.leftTime && this.runTimer(), this.model.lottery && this.addLotteryIcon(), cleverapps.UI.onClick(this, function () {
                        this.onPressed()
                    }.bind(this)), cleverapps.UI.applyHover(this);
                e = this.model.getTargetTypes();
                e && cleverapps.aims.registerTarget(e, this, {
                    controls: this.model.control
                })
            },
            addLotteryIcon: function () {
                this.removeLotteryIcon(), this.timerView ? Lottery.addIcon(this.timerView, "iconTimer") : Lottery.addIcon(this, "icon")
            },
            removeLotteryIcon: function () {
                this.lotteryIcon && this.lotteryIcon.removeFromParent()
            },
            onPressed: function () {
                cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), cleverapps.audio.playSound(bundles.main.urls.click_effect);
                var e = this.model.getToolTip();
                e ? cleverapps.tooltipManager.onClick(this, e) : this.model.onPressed()
            },
            showForce: function () {
                cleverapps.forces.create(this, this.model.getForce())
            },
            setSize: function (e) {
                this.setContentSize2(e), this.setContentSize2(e), this.setPositionRound(this.width / 2, this.height / 2)
            },
            showIcon: function () {
                var e, t;
                this.icon && this.icon.removeFromParent(), this.model.icon ? (e = this.model.icon, e = this.icon = e(), cleverapps.UI.fitToBox(e, {
                    width: .7 * this.width,
                    height: .7 * this.height,
                    maxScale: 1.2
                }), e.setPositionRound(this.iconNode.width / 2, this.iconNode.height / 2), this.iconNode.addChild(e)) : this.model.animation && ((t = this.icon = new cleverapps.Spine(this.model.animation)).setPositionRound(this.iconNode.width / 2, this.iconNode.height / 2), this.iconNode.addChild(t), this.model.skin && t.setSkin(this.model.skin), t.setAnimation(0, "animation", !1), this.model.locked || t.setCompleteListener(function () {
                    t.runAction(
                        new cc.Sequence(new cc.DelayTime(cleverapps.Random.mathChoose(SideBarIconView.RANDOM_ANIMATION_INTERVALS)), new cc.CallFunc(function () {
                            t.setAnimation(0, "animation", !1)
                        })))
                }))
            },
            show: function () {
                var e = cleverapps.styles.SideBarIconView,
                    t = cleverapps.skins.getSlot("sidebarBg") || bundles.sidebar.frames.icon_bg,
                    t = this.bg = cleverapps.UI.createScale9Sprite(t),
                    e = (e.bg && e.bg.width && t.setContentSize(e.bg), SceneDecors.add(t, cleverapps.skins.getSlot("sidebarIcon")), this.addChild(t), t.setPositionRound(t.width / 2, t.height / 2), this.setSize(t.getContentSize()), this.iconNode = new cc.Node);
                e.setAnchorPoint2(), e.setContentSize2(this.getContentSize()), e.setPositionRound(this.width / 2, this.height / 2), this.addChild(e)
            },
            setLocked: function () {
                var e = cleverapps.styles.SideBarIconView,
                    t = (e.lock.color ? this.icon && this.icon.spine && this.icon.spine.setColor(e.lock.color) : e.lock.greyscale && this.icon && this.icon.spine && cleverapps.UI.convertToGrayScale(this.icon.spine), this.lock = new cc.Sprite(bundles.sidebar.frames.lock));
                this.addChild(t, 1), t.setPositionRound(e.lock)
            },
            unlock: function () {
                this.lock.removeFromParent(), this.bg.setColor(cleverapps.styles.COLORS.WHITE), this.icon && this.icon.spine && (this.icon.spine.setColor(cleverapps.styles.COLORS.WHITE), cleverapps.UI.convertToGrayScale(this.icon.spine, !0))
            },
            enable: function () {
                this.icon && this.icon.spine && this.icon.spine.setColor(cleverapps.styles.COLORS.WHITE)
            },
            disable: function () {
                this.icon && this.icon.spine && this.icon.spine.setColor(new cc.Color(130, 130, 130, 200))
            },
            addTitle: function () {
                var e, t;
                this.text && (this.text.removeFromParent(), delete this.text), this.textBg && (this.textBg.removeFromParent(), delete this.textBg), void 0 !== this.model.title && (t = cleverapps.styles.SideBarIconView.text, (e = this.textBg = this.getTitleBg()).setPositionRound(t), this.addChild(e), this.text = cleverapps.UI.generateTTFText(this.model.title, cleverapps.styles.FONTS.SIDEBAR_ICON_TEXT), this.text.setPositionRound(e.width / 2, e.height / 2 + t.offsetY), t = this.getTitleTextSize(), this.text.fitTo(t.width,
                    t.height), this.text.baseScale = this.text.scale, e.addChild(this.text))
            },
            runTimer: function () {
                this.hideTimer();
                var e = this.timer = new cleverapps.CountDown(this.model.leftTime, {
                    onFinish: function () {
                        this.model.resetState()
                    }.bind(this)
                }),
                    t = cleverapps.styles.SideBarIconView.text,
                    s = {
                        font: cleverapps.styles.FONTS.SIDEBAR_ICON_TEXT,
                        timerPosition: {
                            x: 0,
                            y: t.offsetY
                        }
                    },
                    i = this.getTitleBg(),
                    i = (i && (s.background_content = i), this.timerView = new cleverapps.CountDownView(e, s)),
                    e = this.getTitleTextSize();
                i.fitTo(e.width, e.height), i.baseScale = i.scale, this.addChild(i), i.setPositionRound(t)
            },
            getTitleBg: function () {
                var e, t = cleverapps.styles.SideBarIconView.text,
                    s = cleverapps.UI.createScale9Sprite(bundles.sidebar.frames.icon_text_bg, cleverapps.UI.Scale9Rect.TwoPixelXY);
                return s.setContentSize2(t.width, t.height), this.model.titleIcon && (e = new cc.Sprite(this.model.titleIcon), s.addChild(e), e.setPositionRound(t.titleIcon)), s
            },
            getTitleTextSize: function () {
                var e = cleverapps.styles.SideBarIconView.text;
                return {
                    width: .86 * e.width,
                    height: .86 * e.height
                }
            },
            hideTimer: function () {
                this.timer && (this.timer.remove(), delete this.timer), this.timerView && (this.timerView.removeFromParent(), delete this.timerView)
            },
            showAttentionAnimation: function () {
                !this.mark || this.attentionJumped || cleverapps.meta.isFocused() || (this.mark.jump(), this.attentionJumped = !0)
            },
            turnOnAttention: function () {
                var e;
                this.mark || ((e = this.mark = new Attention).setPositionRound(cleverapps.styles.SideBarIconView.mark), this.addChild(e)), this.attentionJumped = !1, this.showAttentionAnimation()
            },
            turnOffAttention: function () {
                this.mark.removeFromParent(), delete this.mark
            },
            turnOnFinger: function () {
                this.finger = FingerView.hintClick(this, {
                    delay: .8
                })
            },
            turnOffFinger: function () {
                FingerView.remove(this.finger), this.finger = void 0
            },
            getModel: function () {
                return this.model
            }
        })),
        SideBarView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            SIDEBAR_ICON_TEXT: {
                name: "default",
                size: 40
            }
        }), cleverapps.styles.SideBarIconView = {
            lock: {
                color: new cc.Color(130, 130, 130, 200),
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: 0
                }
            },
            text: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: 0
                },
                width: 148,
                height: 56,
                offsetY: 0,
                titleIcon: {
                    x: {
                        align: "left",
                        dx: -45
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                }
            },
            mark: {
                x: {
                    align: "right",
                    dx: -5
                },
                y: {
                    align: "top",
                    dy: -5
                }
            }
        }, SideBarIconView.RANDOM_ANIMATION_INTERVALS = [5, 7, 9, 11, 12], cc.Node.extend({
            ctor: function (e) {
                this._super(), this.options = e || {}, this.updateSize(), this.slots = SideBar.SLOTS.map(function (e) {
                    e = new SideBarSlotView(e, this);
                    return this.addChild(e), e
                }, this), cleverapps.sideBar.refreshAllIcons(), cleverapps.sideBar.onAddIcon = this.createListener(this.insert.bind(this)), cleverapps.sideBar.onMoveIcon = this.createListener(this.move.bind(this)), cleverapps.sideBar.onRemoveIcon = this.createListener(this.eject.bind(this)), cleverapps.sideBar.onForceIcon = this.createListener(this.onForce.bind(this));
                for (var t = 0; t < cleverapps.sideBar.icons.length; t++) this.insert(t);
                this.updateZOrder()
            }
        })),
        SideBarSlotView = (SideBarView.prototype.updateSize = function () {
            var e = this.options.size || cc.size(
                cleverapps.UI.getSceneSize());
            this.setAnchorPoint2(), this.setContentSize2(e.width, e.height), this.setPositionRound(e.width / 2, e.height / 2)
        }, SideBarView.prototype.onForce = function (e) {
            this.slots[e].showForce()
        }, SideBarView.prototype.insert = function (e) {
            this.slots[e] && this.slots[e].insert(new SideBarIconView(cleverapps.sideBar.icons[e]))
        }, SideBarView.prototype.eject = function (e) {
            this.slots[e] && this.slots[e].eject()
        }, SideBarView.prototype.move = function (e, t) {
            var s, i;
            this.slots[e] ? ((i = this.slots[t] ? this.slots[t].release() : i) || (s = cleverapps.sideBar.icons[e], i = new SideBarIconView(s)), this.slots[e].insert(i)) : this.slots[t] && this.slots[t].eject()
        }, SideBarView.prototype.updateZOrder = function () {
            this.setLocalZOrder(cleverapps.meta.isFocused() ? BaseWindow.WINDOWS_ZORDER + 1 : SideBarView.ZORDER)
        }, SideBarView.ZORDER = 1, cc.Node.extend({
            ctor: function (e, t) {
                this._super();
                var s = cleverapps.styles.SideBarSlot;
                this.setAnchorPoint2(), this.setContentSize2(s.width, s.height), this.sideBar = t, this.row = e.row, this.col = e.col,
                    this.updatePosition(), this.debugId = "SideBarSlot" + this.row + this.col
            },
            updatePosition: function () {
                this.stopAllActions(), this.visible = !0;
                var e = cleverapps.styles.SideBarSlot,
                    t = (this.setScale(cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? e.mobileScale : 1), e.wideModePadding && e.wideModePadding[cleverapps.resolution.mode] || e.padding),
                    s = this.width / 2 * this.scale,
                    i = (this.width + t.horizontal) * this.scale,
                    n = cleverapps.resolution.getSafePadding().top,
                    t = this.sideBar.height - t.top - this.row * (e.margin + this.height * this.scale) - n,
                    e = (this.col === SideBar.LEFT_COLUMN ? (this.hidePosition = {
                        x: -s,
                        y: t
                    }, this.showPosition = {
                        x: this.hidePosition.x + i,
                        y: t
                    }) : (this.hidePosition = {
                        x: this.sideBar.width + s,
                        y: t
                    }, this.showPosition = {
                        x: this.hidePosition.x - i,
                        y: t
                    }), this.iconView && (this.iconView.model.control || this.getControlName()));
                cleverapps.meta.lastControlsVisible[e] ? (this.isShown = !0, this.setPositionRound(this.showPosition)) : (this.isShown = !1, this.visible = !1, this.setPositionRound(this.hidePosition))
            },
            getControlName: function () {
                return "sideBarSlot_" + this.row + "_" + this.col
            },
            insert: function (e) {
                this.iconView = e, this.addChild(e), e.setPositionRound(this.width / 2, this.height / 2), cleverapps.meta.registerControl(e.model.control || this.getControlName(), this, cleverapps.values(cleverapps.Environment).filter(function (e) {
                    return e !== cleverapps.Environment.SCENE_MAIN
                }))
            },
            eject: function () {
                cleverapps.meta.removeControl(this.iconView.model.control || this.getControlName()), this.iconView.removeFromParent(), this.iconView = void 0
            },
            release: function () {
                cleverapps.meta.removeControl(this.iconView.model.control || this.getControlName()), this.iconView.removeTemporarily(!1);
                var e = this.iconView;
                return this.iconView = void 0, e
            },
            showForce: function () {
                cleverapps.meta.showControlsWhileFocused(this.iconView.model.control || this.getControlName(), !0), this.iconView.showForce()
            },
            toggle: function (e, t) {
                e ? this.show(t) : this.hide(t)
            },
            show: function (e) {
                this.isShown = !0, this.sideBar.updateZOrder(), this.iconView ? this.iconView.showAttentionAnimation() : e = !0,
                    this.stopAllActions(), e ? (this.visible = !0, this.setPositionRound(this.showPosition)) : this.runAction(new cc.Sequence(new cc.DelayTime(.3 + .1 * this.row), new cc.Show, new cc.MoveTo(1, this.showPosition).easing(cc.easeElasticOut(.6)))), cleverapps.scenes.onAvoidNodeVisibilityChanged()
            },
            hide: function (e) {
                this.isShown = !1, this.iconView || (e = !0), this.stopAllActions(), e ? (this.visible = !1, this.setPositionRound(this.hidePosition)) : this.runAction(new cc.Sequence(new cc.MoveTo(.15, this.hidePosition).easing(cc.easeBackIn()), new cc.Hide)), cleverapps.scenes.onAvoidNodeVisibilityChanged()
            }
        })),
        PackIcon = (cleverapps.styles.SideBarSlot = {
            width: 200,
            height: 200,
            margin: 20,
            mobileScale: .8,
            padding: {
                top: 220,
                horizontal: 15
            }
        }, function () {
            SideBarIcon.call(this, {
                lottery: !0
            }), cleverapps.flags.on("change:videoAdsMainMonetization", function () {
                cleverapps.sideBar.resetByClassName(PackIcon)
            })
        }),
        DailyCupIcon = (PackIcon.prototype = Object.create(SideBarIcon.prototype), (PackIcon.prototype.constructor = PackIcon).prototype.resetState = function () {
            var e;
            this.available = cleverapps.packManager.isAvailable(), this.available && (e = [bundles.sidebar.jsons.pack_icon_json, bundles.sidebar.jsons.pack1_icon_json, bundles.sidebar.jsons.pack2_icon_json], this.setAnimation(e[cleverapps.packManager.get().stage]))
        }, PackIcon.prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "PackWindow",
                control: ["MenuBarGoldItem", "MenuBarLivesItem", "MenuBarCoinsItem", "MenuBarWandsItem", "MenuBarWorkersItem"],
                action: function (e) {
                    new PackWindow, cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, function () {
            SideBarIcon.call(this, {
                animation: bundles.sidebar.jsons.dailycup_icon_json
            }), cleverapps.dailyCup.onChangedIcon = function () {
                cleverapps.sideBar.resetByClassName(DailyCupIcon)
            }
        }),
        HeroesIcon = (DailyCupIcon.prototype = Object.create(SideBarIcon.prototype), (DailyCupIcon.prototype.constructor = DailyCupIcon).prototype.getForce = function () {
            return cleverapps.dailyCup.getForce()
        }, DailyCupIcon.prototype.resetState = function () {
            this.available = cleverapps.dailyCup.isAvailable({
                future: !0
            });
            var e = this.available && !cleverapps.dailyCup.isAvailable();
            this.available && !e && (this.available = cleverapps.dailyCup.isActive()), e ? (this.setLocked(!0), this.setAttention(!1), this.setTitle(Messages.get("IconLocked.TextDefault", {
                levelNo: this.getLockedTipData()
            }))) : (this.setLocked(!1), this.setAttention(!this.locked && cleverapps.dailyCup.isFinished()), 0 < (e = cleverapps.dailyCup.getTimeLeft()) ? (this.setLeftTime(e), this.setTitle(void 0)) : (this.setLeftTime(0), this.setTitle("Finished")))
        }, DailyCupIcon.prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "DailyCupSceneFromIcon",
                action: function (e) {
                    cleverapps.scenes.replaceScene(new DailyCupScene, e)
                }
            })
        }, DailyCupIcon.prototype.getLockedTipData = function () {
            var e = CupsConfig.TYPES[CupsConfig.TYPE_DAILY].available;
            return cleverapps.humanReadableNumber({
                floatLevel: e.level
            })
        }, function () {
            SideBarIcon.call(this, {
                animation: bundles.sidebar.jsons.heroes_icon_json
            })
        }),
        QuestsSideBarIcon = (HeroesIcon.prototype = Object.create(SideBarIcon.prototype), (
            HeroesIcon.prototype.constructor = HeroesIcon).prototype.resetState = function () {
                this.available = "undefined" != typeof match3 && match3.heroes && match3.heroes.available({
                    future: !0
                }), this.available && !match3.heroes.available() ? (this.setLocked(!0), this.setAttention(!1), this.setTitle(Messages.get("IconLocked.TextDefault", {
                    levelNo: this.getLockedTipData()
                }))) : (this.setLocked(!1), this.setAttention(match3.heroes.canUpgradeSomebody()), this.setTitle(void 0))
            }, HeroesIcon.prototype.onPressed = function () {
                cleverapps.meta.display({
                    focus: "HeroesSceneFromIcon",
                    action: function (e) {
                        cleverapps.scenes.replaceScene(new HeroesScene, e)
                    }
                })
            }, HeroesIcon.prototype.getForce = function () {
                return Forces.HEROES_AVAILABLE
            }, HeroesIcon.prototype.getLockedTipData = function () {
                return cleverapps.humanReadableNumber({
                    floatLevel: Heroes.AVAILABLE.level
                })
            }, function () {
                SideBarIcon.call(this, {
                    animation: bundles.sidebar.jsons.quests_icon_json,
                    targets: "quests",
                    control: "QuestsSideBarIcon"
                })
            }),
        StarChestIcon = (QuestsSideBarIcon.prototype = Object.create(
            SideBarIcon.prototype), (QuestsSideBarIcon.prototype.constructor = QuestsSideBarIcon).prototype.onPressed = function () {
                cleverapps.meta.display({
                    focus: "QuestsIconClicked",
                    action: function (e) {
                        new QuestsWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }, QuestsSideBarIcon.prototype.resetState = function () {
                this.available = Game.currentGame && Game.currentGame.quests && Game.currentGame.quests.getSelectedQuest() && Game.currentGame.quests.config && !cleverapps.config.editorMode
            }, QuestsSideBarIcon.prototype.getForce = function () {
                if (Game.currentGame && Game.currentGame.quests && 4 < Game.currentGame.quests.count()) return Forces.QUEST_ICON
            }, function () {
                SideBarIcon.call(this, {
                    animation: bundles.sidebar.jsons.star_chest_icon_json
                })
            }),
        DailyTasksIcon = (StarChestIcon.prototype = Object.create(SideBarIcon.prototype), (StarChestIcon.prototype.constructor = StarChestIcon).prototype.resetState = function () {
            this.available = void 0 !== cleverapps.starChest;
            var e = cleverapps.starChest.stars + "/" + cleverapps.StarChest.GOAL_AMOUNT;
            this.setTitle(e),
                this.setAttention(cleverapps.starChest.stars >= cleverapps.StarChest.GOAL_AMOUNT)
        }, StarChestIcon.prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "StarChestWindow",
                action: function (e) {
                    new StarChestWindow, cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, function () {
            SideBarIcon.call(this, {
                animation: bundles.sidebar.jsons.dailytasks_json
            }), cleverapps.dailyTasks.onChangeStateListener = function () {
                cleverapps.sideBar.resetByClassName(DailyTasksIcon)
            }
        }),
        InviteIcon = (DailyTasksIcon.prototype = Object.create(SideBarIcon.prototype), (DailyTasksIcon.prototype.constructor = DailyTasksIcon).prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "DailyTasksWindow",
                action: function (e) {
                    cleverapps.dailyTasks.update(), new DailyTasksWindow, cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, DailyTasksIcon.prototype.resetState = function () {
            var e;
            "merge" === cleverapps.config.type && (this.available = cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition() && cleverapps.dailyTasks.isAvailable({
                future: !0
            })), this.available && (!cleverapps.dailyTasks.isAvailable() ? (this.setLocked(!0), this.setAttention(!1), this.setTitle(Messages.get("IconLocked.TextDefault", {
                levelNo: this.getLockedTipData()
            }))) : (this.setLocked(!1), e = 0 < cleverapps.dailyTasks.getNotCollectedTasks().length, this.setAttention(e), e = cleverapps.dailyTasks.getCompleteAllTask(), this.setTitle(e.progress + "/" + e.goal)))
        }, DailyTasksIcon.prototype.getForce = function () {
            return Forces.DAILY_TASKS_FORCE
        }, DailyTasksIcon.prototype.getLockedTipData = function () {
            var e = cleverapps.Availables.DAILY_TASKS;
            return cleverapps.humanReadableNumber({
                floatLevel: e.level
            })
        }, function () {
            SideBarIcon.call(this, {
                animation: bundles.sidebar.jsons.invite_icon_json,
                priority: SideBar.PRIORITY_REDUNDANT
            })
        }),
        LandmarkDonorIcon = (InviteIcon.prototype = Object.create(SideBarIcon.prototype), (InviteIcon.prototype.constructor = InviteIcon).prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "InviteIcon",
                action: function (t) {
                    cleverapps.platform.inviteFriends(function (e) {
                        e === cleverapps.CODE_SUCCEED && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INVITE_ICON_INVITE), t()
                    }), cleverapps.meta.onceNoWindowsListener = t
                }
            })
        }, InviteIcon.prototype.resetState = function () {
            this.available = levels.user.checkAvailable(cleverapps.Availables.INVITE_FRIENDS_ICON) && !cleverapps.flags.noinvites, this.available && "merge" === cleverapps.config.type && (this.available = cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition())
        }, function () {
            SideBarIcon.call(this, {
                animation: bundles.sidebar.jsons.landmarkdonor_icon_json
            }), this.resetState()
        }),
        FreeRubiesIcon = (LandmarkDonorIcon.prototype = Object.create(SideBarIcon.prototype), (LandmarkDonorIcon.prototype.constructor = LandmarkDonorIcon).prototype.resetState = function () {
            var e;
            this.available = !1, cleverapps.config.editorMode || !cleverapps.environment.isMainScene() || (e = this.findWithProgress()) && (this.available = !0, this.setAttention(Game.currentGame.landmarks.getPendingProgress(e)), this.setLeftTime(Game.currentGame.landmarks.getTimeLeft(
                e)))
        }, LandmarkDonorIcon.prototype.findWithProgress = function () {
            for (var e = Game.currentGame && Game.currentGame.landmarks && Game.currentGame.landmarks.listActiveLandmarks() || [], t = 0; t < e.length; ++t) {
                var s = e[t];
                if (Game.currentGame.landmarks.getPendingProgress(s)) return s
            }
            return e[0]
        }, LandmarkDonorIcon.prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "LandmarkDonorIconClicked",
                action: function (e) {
                    new LandMarkDonorWindow(this.findWithProgress()), cleverapps.meta.onceNoWindowsListener = e
                }.bind(this)
            })
        }, LandmarkDonorIcon.prototype.getForce = function () {
            return Landmarks.getForce(cleverapps.travelBook.getCurrentPage().id)
        }, function () {
            SideBarIcon.call(this, {
                animation: bundles.sidebar.jsons.free_rubies_json
            })
        }),
        OfferIcon = (FreeRubiesIcon.prototype = Object.create(SideBarIcon.prototype), (FreeRubiesIcon.prototype.constructor = FreeRubiesIcon).prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "RubiesShopFromIcon",
                control: ["MenuBarGoldItem"],
                action: function (e) {
                    new HardCurrencyShopWindow,
                        cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, FreeRubiesIcon.prototype.resetState = function () {
            this.available = cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition(), this.setAttention(this.available && cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED))
        }, function (e) {
            SideBarIcon.call(this, {
                animation: e.sideBarJson,
                priority: SideBar.PRIORITY_REDUNDANT
            }), this.offer = e, this.resetState()
        }),
        TeaserIcon = (OfferIcon.prototype = Object.create(SideBarIcon.prototype), (OfferIcon.prototype.constructor = OfferIcon).prototype.resetState = function () {
            var e;
            cleverapps.config.editorMode ? this.available = !1 : (this.available = this.offer.hasProperMission(), this.available && (e = this.offer.getTimeLeft(), this.setLeftTime(e), this.setTitle(void 0)))
        }, OfferIcon.prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: this.offer.name + "IconClicked",
                action: function (e) {
                    new MissionOfferWindow(this.offer), cleverapps.meta.onceNoWindowsListener = e
                }.bind(this)
            })
        },
            OfferIcon.prototype.getForce = function () {
                return this.offer.force
            },
            function (e) {
                SideBarIcon.call(this, {
                    animation: Missions[e].sideBarJson,
                    priority: SideBar.PRIORITY_REDUNDANT,
                    progressIconJson: Missions[e].sideBarProgressIconJson
                }), this.type = e, this.available = !0, this.resetState()
            }),
        ExitExpeditionIcon = (TeaserIcon.prototype = Object.create(SideBarIcon.prototype), (TeaserIcon.prototype.constructor = TeaserIcon).prototype.resetState = function () {
            this.available = MissionManager.hasProperParent(Missions[this.type]), this.available && (this.setLocked(!0), this.setAttention(!1), this.setFinger(!1), this.setTitle(Messages.get("IconLocked.TextDefault", {
                levelNo: this.getLockedTipData()
            })))
        }, TeaserIcon.prototype.getLockedTipData = function () {
            if (Missions[this.type].available) return cleverapps.humanReadableNumber({
                floatLevel: Missions[this.type].available.level
            })
        }, function () {
            SideBarIcon.call(this, {
                animation: bundles.sidebar.jsons.exit_expedition_json,
                targets: "mainWorld",
                control: "ExitExpeditionIcon"
            })
        }),
        PawBoxIcon = (
            ExitExpeditionIcon.prototype = Object.create(SideBarIcon.prototype), (ExitExpeditionIcon.prototype.constructor = ExitExpeditionIcon).prototype.onPressed = function () {
                cleverapps.meta.display({
                    focus: "ExitExpeditionIconClicked",
                    actions: [function (e) {
                        setTimeout(e, 300)
                    }, function (e) {
                        cleverapps.travelBook.gotoMainScene(e)
                    }]
                })
            }, ExitExpeditionIcon.prototype.resetState = function () {
                var e;
                this.available = cleverapps.travelBook.isExpedition() && !cleverapps.config.editorMode, this.available && (this.setTitle(Messages.get("Exit")), e = new Pocket, this.setAttention(!e.isEmpty()))
            },
            function () {
                SideBarIcon.call(this, {
                    animation: bundles.sidebar.jsons.pawbox_icon_json,
                    titleIcon: bundles.sidebar.frames.pawbox_titleIcon,
                    control: "PawBoxIcon",
                    targets: ["pawsPoints"]
                })
            }),
        TreasureBag = (PawBoxIcon.prototype = Object.create(SideBarIcon.prototype), (PawBoxIcon.prototype.constructor = PawBoxIcon).prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "PawBoxIconClicked",
                action: function (e) {
                    new GuideWindow({
                        name: "PawBoxGuideWindow",
                        getBundleName: function () {
                            return "pawbox_guide_window"
                        }
                    }), cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, PawBoxIcon.prototype.resetState = function () {
            this.available = !1, !cleverapps.config.wysiwygMode && !cleverapps.config.editorMode && cleverapps.travelBook.isExpedition() && Game.currentGame && Game.currentGame.pawBox && (Game.currentGame && Game.currentGame.pawBox && PawBox.IsIconActive() && (this.available = !0), this.setTitle(Game.currentGame.pawBox.getPoints() + "/" + PawBox.GOAL))
        }, function () {
            this.visible = !1, this.onShow = function () { }, this.onHide = function () { }
        }),
        TreasureBagIcon = (TreasureBag.prototype.isVisible = function () {
            return this.visible
        }, TreasureBag.prototype.show = function () {
            this.visible || (this.visible = !0, this.onShow())
        }, TreasureBag.prototype.hide = function () {
            this.visible && (this.visible = !1, this.onHide())
        }, cc.Node.extend({
            ctor: function () {
                this._super();
                var e = cleverapps.styles.TreasureBag,
                    t = new cc.Sprite(bundles.treasurebag.frames.treasurebag_bg_png),
                    t = (t.setPositionRound(t.width / 2, t.height / 2),
                        this.setAnchorPoint2(), this.setContentSize2(t.width, t.height), this.addChild(t), new cleverapps.Spine(bundles.treasurebag.jsons.treasurebag_json));
                t.setAnimation(0, "animation", !0), t.setPositionRound(e.animation), this.addChild(t), cleverapps.aims.registerTarget("default", this, {
                    withoutDelta: !0,
                    treasureBag: !0
                }), cleverapps.treasureBag.onShow = this.createListener(this.show.bind(this)), cleverapps.treasureBag.onHide = this.createListener(this.hide.bind(this))
            },
            updatePosition: function () {
                var e = cleverapps.styles.TreasureBag,
                    t = cleverapps.styles.SideBarSlot,
                    t = (cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && this.setScale(t.mobileScale), this.baseScale = this.scale, t.wideModePadding && t.wideModePadding[cleverapps.resolution.mode] || t.padding),
                    s = this.width / 2 * this.scale,
                    e = this.height / 2 * this.scale + e.offsetY,
                    t = (this.width + t.horizontal) * this.scale;
                this.hidePosition = {
                    x: this.parent.width + s,
                    y: e
                }, this.showPosition = {
                    x: this.hidePosition.x - t,
                    y: e
                }
            },
            show: function () {
                this.stopAllActions(), this.runAction(
                    new cc.Sequence(new cc.Show, new cc.MoveTo(.5, this.calculatePositionRound(this.showPosition)).easing(cc.easeBackOut())))
            },
            hide: function (e) {
                if (e) return this.setVisible(!1), void this.setPositionRound(this.hidePosition);
                this.stopAllActions(), this.runAction(new cc.Sequence(new cc.MoveTo(.15, this.calculatePositionRound(this.hidePosition)), new cc.Hide))
            }
        })),
        SpecialEnergyOfferIcon = (TreasureBagIcon.ZORDER = BaseWindow.WINDOWS_ZORDER + 1, cleverapps.styles.TreasureBag = {
            animation: {
                x: {
                    align: "center",
                    dx: -2
                },
                y: {
                    align: "center",
                    dy: -8
                }
            },
            offsetY: 60
        }, function () {
            SideBarIcon.call(this, {
                animation: bundles.sidebar.jsons.special_energy_offer_json,
                priority: SideBar.PRIORITY_REDUNDANT
            }), this.available = !0, this.resetState()
        }),
        ChestVictoryAnimation = (SpecialEnergyOfferIcon.prototype = Object.create(SideBarIcon.prototype), (SpecialEnergyOfferIcon.prototype.constructor = SpecialEnergyOfferIcon).prototype.resetState = function () {
            var e;
            Game.currentGame && ((e = Game.currentGame.specialEnergyOffer.getIconLeftTime()) <= 0 ? cleverapps.sideBar.removeTemporaryIcon(this) : this.setLeftTime(e))
        }, SpecialEnergyOfferIcon.prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "SpecialEnergyOfferWindow",
                action: function (e) {
                    new SpecialEnergyOfferWindow, cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, cc.Node.extend({
            ctor: function () {
                this._super(), this.setAnchorPoint2();
                var e = cleverapps.styles.ChestVictoryAnimation,
                    t = this.animation = new cleverapps.Spine(bundles.game.jsons.gold_chest_json, 1),
                    t = (t.setAnimation(0, "jump", !1), t.setAnchorPoint2(), this.addChild(t), this.text = cleverapps.UI.generateImageText(Game.currentGame.rewards[GameBase.REWARD_HARD], cleverapps.styles.FONTS.CHEST_REWARD_TEXT), new cc.Sprite(bundles.game.frames.gold_png));
                this.reward = new cleverapps.Layout([this.text, t], {
                    margin: e.reward.margin,
                    direction: cleverapps.UI.HORIZONTAL
                }), this.addChild(this.reward), this.reward.setPosition(e.reward.position), this.reward.setCascadeOpacityEnabledRecursively(!0), this.reward.setOpacity(0), this.reward.runAction(
                    new cc.Sequence(new cc.DelayTime(.4), new cc.FadeIn(.5))), cleverapps.audio.playSound(bundles.game.urls.chest_victory_effect)
            },
            getFlyTargetPosition: function () {
                var e = cleverapps.styles.ChestVictoryAnimation.targetAlignment;
                return {
                    x: this.animation.width / 2 + e.x,
                    y: this.animation.height / 2 + e.y
                }
            },
            animationLeave: function (e) {
                this.reward.runAction(new cc.Sequence(new cc.PlaySound(bundles.game.urls.end_chest_victory_effect), new cc.ScaleTo(.4, 1.8), new cc.ScaleTo(.2, 1), new cc.FadeOut(.1), new cc.CallFunc(function () {
                    this.animation.setAnimation(0, "leaving", !1), this.animation.setCompleteListener(function () {
                        cleverapps.audio.playSound(bundles.game.urls.end_collected), this.removeFromParent(), e()
                    }.bind(this))
                }.bind(this))))
            },
            addGold: function () {
                this.animation.setAnimation(0, "cards", !1), this.text.setString(Game.currentGame.rewards[GameBase.REWARD_HARD]), this.reward.reshape(), this.reward.stopAllActions(), this.reward.runAction(new cc.Sequence(new cc.PlaySound(bundles.game.urls.fill_chest_victory_effect, {
                    throttle: 250
                }), new cc.ScaleTo(.15, 1.3), new cc.ScaleTo(.15, 1)))
            }
        })),
        AutoScrollText = (cleverapps.styles.ChestVictoryAnimation = {
            reward: {
                position: {
                    x: 0,
                    y: 230
                },
                margin: 10
            },
            targetAlignment: {
                x: 25,
                y: 80
            },
            chestPosition: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            }
        }, cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.options = t || {}, this.styles = cleverapps.styles.AutoScrollText, this.setAnchorPoint2(), this.setContentSize2(t.width, t.height), this.createTexts(e), this.createArrow(), this.currentTextIndex = 0, this.texts[this.currentTextIndex].setVisible(!0)
            },
            createTexts: function (e) {
                this.texts = [], e.forEach(function (e) {
                    e = cleverapps.UI.generateOnlyText(e, this.options.font || cleverapps.styles.FONTS.WINDOW_TEXT);
                    this.addChild(e), e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setDimensions(this.width, 0), e.fitTo(void 0, this.height), e.setPositionRound(this.width / 2, this.height / 2), e.setVisible(!1), this.texts.push(e)
                }.bind(this))
            },
            createArrow: function () {
                var e = cleverapps.UI.generateOnlyText("▼",
                    this.options.font || cleverapps.styles.FONTS.WINDOW_TEXT),
                    t = new cc.Node;
                t.setContentSize2(this.styles.arrow.width, this.styles.arrow.height), t.setAnchorPoint2(), this.addChild(t), t.setPositionRound(this.styles.arrow), t.addChild(e), e.setPositionRound(t.width / 2, t.height / 2), cleverapps.UI.onClick(t, function () {
                    this.next(), this.reinitTimer()
                }.bind(this))
            },
            next: function () {
                this.texts[this.currentTextIndex].setVisible(!1), this.currentTextIndex = (this.currentTextIndex + 1) % this.texts.length, this.texts[this.currentTextIndex].setVisible(!0)
            },
            reinitTimer: function () {
                this.stopAllActions(), this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.DelayTime(5), new cc.CallFunc(this.next.bind(this)))))
            },
            setTextByIndex: function (e) {
                this.texts[this.currentTextIndex] && this.texts[this.currentTextIndex].setVisible(!1), this.currentTextIndex = e, this.texts[this.currentTextIndex].setVisible(!0)
            }
        })),
        LoginButton = (cleverapps.styles.AutoScrollText = {
            arrow: {
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -30
                },
                width: 40,
                height: 40
            }
        },
            cleverapps.UI.Button.extend({
                ctor: function (e) {
                    this.options = e || {}, this.options.onSuccess = this.options.onSuccess || function () { }, this.options.onFailure = this.options.onFailure || function () { }, this.source = this.options.source || cleverapps.platform.source;
                    var e = cleverapps.styles.LoginButton,
                        t = {
                            type: this.options.type,
                            width: this.options.width || e.width,
                            height: this.options.height || e.height,
                            onClicked: this.onClicked.bind(this),
                            text: this.getText(),
                            icons: {
                                "%%": this.getIcon()
                            }
                        };
                    void 0 !== e.content[this.source] && (t.height = e.customHeight, t.content = this.getContent(), t.text = void 0, t.icons = void 0, t.type = {
                        button_png: bundles.buttons.frames.sign_in_button_png,
                        button_on_png: bundles.buttons.frames.sign_in_button_on_png,
                        button_off_png: bundles.buttons.frames.sign_in_button_png,
                        keepRadius: !1
                    }), this._super(t)
                },
                getContent: function () {
                    return new cc.Sprite(cleverapps.styles.LoginButton.content[this.source])
                },
                getIcon: function () {
                    return cleverapps.styles.LoginButton.icon.image[this.source]
                },
                getText: function () {
                    return (
                        this.getIcon() ? "%% " : "") + "SignIn"
                },
                onClicked: function () {
                    var e;
                    cleverapps.platform.isConnected(Platform.SOCIAL) ? (e = function () {
                        cleverapps.social.login(function (e) {
                            e === cleverapps.CODE_SUCCEED ? this.options.onSuccess() : (this.options.onFailure(), cleverapps.SocialManager.onFailedLogin())
                        }.bind(this), {
                            source: this.source
                        })
                    }.bind(this), this.options.multiSocials && cc.sys.isNative ? (this.stopAllActions(), this.setScale(.95), this.runAction(new cc.Sequence(new cc.DelayTime(.05), new cc.CallFunc(e), new cc.ScaleTo(.15, 1).easing(cc.easeBackInOut())))) : e()) : cleverapps.notification.create("SocialManager.Initialization")
                }
            })),
        InviteButton = (cleverapps.styles.LoginButton = {
            width: 200,
            height: 110,
            icon: {
                image: {
                    mobile_ok: bundles.main.frames.login_ok_icon_png,
                    web_ok: bundles.main.frames.login_ok_icon_png,
                    mobile_vk: bundles.main.frames.login_vk_icon_png,
                    web_vk: bundles.main.frames.login_vk_icon_png,
                    mbga: bundles.main.frames.login_mobage_icon_png,
                    sp_mbga: bundles.main.frames.login_mobage_icon_png,
                    draugiem: bundles.main.frames.login_draugiem_icon_png,
                    web_mm: bundles.main.frames.login_mm_icon_png,
                    mobile_mm: bundles.main.frames.login_mm_icon_png,
                    fotostrana: bundles.main.frames.login_fs_icon_png,
                    plinga: bundles.main.frames.login_plinga_icon_png,
                    kongregate: bundles.main.frames.login_kongregate_icon_png
                }
            },
            customHeight: 100,
            content: {
                facebook: bundles.social_buttons.frames.sign_in_facebook,
                microsoft: bundles.social_buttons.frames.sign_in_facebook,
                androidsocial: bundles.social_buttons.frames.sign_in_google,
                applesocial: bundles.social_buttons.frames.sign_in_apple
            }
        }, cleverapps.UI.Button.extend({
            ctor: function (e) {
                this.options = e || {}, this.options.onSuccess = this.options.onSuccess || function () { };
                e = cleverapps.styles.InviteButton;
                this._super({
                    type: this.options.type,
                    width: this.options.width || e.width,
                    height: this.options.height || e.height,
                    onClicked: this.onClicked.bind(this),
                    text: "InviteButton.Text"
                })
            },
            onClicked: function () {
                cleverapps.platform.inviteFriends(function (e) {
                    e === cleverapps.CODE_SUCCEED && this.options.onSuccess()
                }.bind(this))
            }
        })),
        BandButton = (cleverapps.styles.InviteButton = {
            width: 200,
            height: 110
        }, cc.Node.extend({
            avoidNode: "BandButton",
            ctor: function (e) {
                this._super();
                var t = cleverapps.styles.BandButton;
                this.options = e;
                var e = {
                    width: (e = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && t.mobileSize ? t.mobileSize : t).width,
                    height: e.height + cleverapps.resolution.getSafePadding().top
                },
                    s = (this.setAnchorPoint2(), this.setContentSize2(e), this.setLocalZOrder(3), this.updatePosition(), cleverapps.UI.createScale9Sprite(bundles.buttons_main.frames.scene_exit_button, cleverapps.UI.Scale9Rect.TwoPixelXY)),
                    e = (s.setContentSize2(e), this.addChild(s), s.setPositionRound(this.width / 2, this.height / 2), new cc.Sprite(bundles.buttons_main.frames.close_band_icon));
                this.addChild(e), e.setPositionRound(t.icon), cleverapps.UI.applyHover(this), cleverapps.UI.onClick(this, function () {
                    this.action()
                }.bind(this))
            },
            updatePosition: function () {
                this.setPositionRound(this._calcPosition())
            },
            action: function () {
                cleverapps.audio.playSound(bundles.main.urls.click_effect), this.options.onClicked()
            },
            hide: function (e) {
                if (this.stopAllActions(), e) return this.setPositionRound(this._calcPosition(!0)), void this.setVisible(!1);
                this.runAction(new cc.Sequence(this._animate("close"), new cc.Hide))
            },
            show: function () {
                this.stopAllActions(), this.runAction(new cc.Sequence(new cc.Show, this._animate("open")))
            },
            _animate: function (e) {
                var t = "open" === e ? cc.easeBackOut(10) : cc.easeBackIn(10),
                    e = this._calcPosition("open" !== e);
                return new cc.MoveTo(.3, e).easing(t)
            },
            _calcPosition: function (e) {
                var t = cleverapps.styles.BandButton,
                    t = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && t.mobilePosition ? t.mobilePosition : t.position;
                return (t = cleverapps.clone(t, !0)).x.dx = (t.x.dx || 0) - cleverapps.resolution.getSafePadding().right, e && (t.y.dy = (t.y.dy || 0) + 1.1 * this.height), this.calculatePositionRound(t)
            }
        })),
        CloseButton = (cleverapps.styles.BandButton = {
            width: 85,
            height: 190,
            position: {
                x: {
                    align: "right",
                    dx: -40
                },
                y: {
                    align: "top",
                    dy: 10
                }
            },
            icon: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 25
                }
            }
        }, cleverapps.UI.Button.extend({
            ctor: function (e) {
                this._super({
                    type: {
                        button_png: bundles.buttons_main.frames.window_close_png,
                        button_on_png: bundles.buttons_main.frames.window_close_on_png
                    },
                    onClicked: e.onClicked
                }), this.setPositionRound(e.styles || cleverapps.styles.CloseButton), this.setLocalZOrder(3)
            },
            hide: function () {
                this.setVisible(!1)
            },
            show: function () {
                this.runAction(new cc.Sequence(new cc.ScaleTo(0, .3), new cc.Show, new cc.ScaleTo(.4, 1).easing(cc.easeBackOut())))
            }
        })),
        TapToContinue = (cleverapps.styles.CloseButton = {
            x: {
                align: "right",
                dx: 20
            },
            y: {
                align: "top",
                dy: 20
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super();
                e = "string" == typeof e.text ? e.text : "Window.ClickToClose", e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.CLOSE_TEXT);
                e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && e.setWrapWidth(cc.view.getFrameSize().width), e.setPositionRound(e.width / 2, e.height / 2),
                    this.setAnchorPoint2(), this.setContentSize(e.getContentSize()), this.addChild(e), this.setCascadeOpacityEnabled(!0)
            },
            hide: function (e) {
                this.stopAllActions(), e ? this.setVisible(!1) : this.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide))
            },
            hideAndRemove: function () {
                this.stopAllActions(), this.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide, new cc.RemoveSelf))
            },
            show: function () {
                this.stopAllActions(), this.runAction(new cc.Sequence(new cc.FadeTo(0, 0), new cc.Show, new cc.FadeIn(.3)))
            }
        })),
        Product = (cleverapps.styles.TapToContinue = {
            x: {
                align: "center"
            },
            y: {
                align: "bottom",
                dy: 250
            }
        }, cleverapps.Path = cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.baseColor = e, this.pathColor = cc.color(this.baseColor), this.lineWidth = t || cleverapps.styles.Path.lineWidth, this.segments = [];
                for (var s = 0; s < cleverapps.Path.MAX_SEGMENTS; ++s) this.segments.push(cleverapps.UI.createScale9Sprite(bundles.path.frames.line_png)), this.segments[s].setAnchorPoint2(0, .5), this.segments[s].visible = !1, this.addChild(this.segments[s]);
                this.path = [], this.animatingInterval = void 0, this.drawTrailing = !0, this.setCascadeOpacityEnabled(!0), this.setLocalZOrder(-1)
            },
            clear: function () {
                this.segments.forEach(function (e) {
                    e.visible = !1
                })
            },
            reset: function () {
                this.animatingInterval && (clearInterval(this.animatingInterval), this.animatingInterval = void 0), this.clearFadeInInterval(), this.path = [], this.pathColor = cc.color(this.baseColor), this.opacity = 255, this.draw()
            },
            clearFadeInInterval: function () {
                void 0 !== this.animateFadeInInterval && (clearInterval(this.animateFadeInInterval), this.animateFadeInInterval = void 0)
            },
            push: function (e) {
                this.path.push(e), this.draw()
            },
            pop: function () {
                this.path.pop(), this.draw()
            },
            setPath: function (e) {
                this.path = e.map(function (e) {
                    return e
                })
            },
            listPath: function () {
                return this.path
            },
            onExitTransitionDidStart: function () {
                this.reset(), this._super()
            },
            drawSegment: function (e, t, s) {
                var i = 15 * resolutionScale / 2 * .9,
                    n = Math.sqrt(Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)) + 2 * i,
                    s = this.segments[s],
                    n = (s.setColor(this.pathColor), s.setContentSize2(n,
                        this.lineWidth), Math.round(100 * Math.atan2(t.y - e.y, t.x - e.x)) / 100);
                s.setPositionRound(e.x - i * Math.cos(n), e.y - i * Math.sin(n)), s.rotation = 180 * -n / Math.PI, s.visible = !0
            },
            draw: function (e) {
                if (this.clear(), 0 < this.path.length)
                    for (var t = this.drawTrailing && e ? this.path.concat(e) : this.path, s = 0; s < t.length - 1; s++) this.drawSegment(t[s], t[s + 1], s)
            },
            stopAnimation: function () {
                this.animatingInterval && this.reset()
            },
            animateFadeIn: function (e) {
                e = e || 300;
                var t = 0,
                    s = this.createListener(function () {
                        this.opacity = Math.min(255, Math.floor(255 * (1 - (e - t) / e))), this.draw(), e <= (t += 16) && this.clearFadeInInterval()
                    });
                this.animateFadeInInterval = setInterval(s, 16), s()
            },
            animateFadeOut: function (e) {
                e = e || 300;
                var t = 0,
                    s = this.createListener(function () {
                        e <= t ? this.reset() : (this.opacity = Math.floor(Math.min(155, this.baseColor.a) * (e - t) / e), this.draw(), t += 16)
                    });
                this.stopAnimation(), this.animatingInterval = setInterval(s, 16), s()
            }
        }), cleverapps.Path.MAX_SEGMENTS = 10, cleverapps.styles.Path = {
            lineWidth: 17
        }, function (e) {
            Object.assign(this, e),
                this.title = Messages.getLocalized(this.title), this.description = Messages.getLocalized(this.description), cleverapps.flags.videoAdsMainMonetization && (this.videoProduct = -1 !== ["gold500", "gold1800", "gold3800", "gold6000", "gold25000", "sweetPack", "jamPack", "tastyPack", "honeyPack", "epicPack"].indexOf(this.key)), this.videoProduct && this.prepareVideoProduct(), this.id && (e = "res/fbproducts/" + (cleverapps.settings.language + "/" + (0 === cleverapps.config.debugMode ? "production/" : "")) + this.id.facebook, this.id.facebook = cleverapps.platform.getExternalUrl(e))
        }),
        VirtualProduct = (Product.SearchProductId = function (e) {
            for (var t in cleverapps.config.products)
                if (cleverapps.config.products[t].loadedId === e) return t;
            return e
        }, Product.FormatTimePeriod = function (e, t) {
            if ("object" == typeof e) return e;
            var s, i, n = (e = "string" == typeof e ? cleverapps.parseInterval(e) : e) / 1e3;
            if (t) return t = {
                1: "1 day",
                2: "2 day",
                3: "3 day",
                5: "5 day",
                7: "7 day",
                9: "9 day",
                10: "10 day"
            }, o = {
                15: "15 minutes",
                10: "10 minutes",
                30: "30 minutes",
                45: "45 minutes",
                60: "OneHour",
                120: "TwoHours",
                180: "ThreeHours",
                360: "6 hours",
                720: "12 hours"
            }, s = Math.round(n / 60), {
                title: "TimePeriod." + (t[i = Math.floor(n / 86400)] || o[s]),
                time: e
            };
            i = Math.floor(n / 86400), n %= 86400;
            var t = Math.floor(n / 3600),
                o = (n %= 3600, {
                    day: i,
                    hr: t,
                    min: s = Math.round(n / 60)
                }),
                n = "minutesString";
            return 0 < i && 0 < t ? n = "dayTimeString" : 0 < i ? n = "daysString" : 0 < t && 0 < s ? n = "hoursMinutesString" : 0 < t && (n = "hoursString"), {
                title: Messages.get(n, o),
                time: e
            }
        }, Product.AddUpRewards = function (e, t) {
            for (var s in t = t || {}, e) {
                var i = e[s];
                if ("unlimitedLives" === s) t[s] = t[s] ? t[s] + cleverapps.parseInterval(i) : cleverapps.parseInterval(i);
                else if ("boosters" === s)
                    for (var n in t.boosters || (t.boosters = {}), i) t.boosters[n] = t.boosters[n] ? t.boosters[n] + parseInt(i[n]) : parseInt(i[n]);
                else t[s] = t[s] ? t[s] + parseInt(i) : parseInt(i)
            }
            return t
        }, Product.UnlimitedToHours = function (e) {
            var t;
            return e.unlimitedLives && (t = Math.round(e.unlimitedLives / 1e3 / 60 / 60), e.unlimitedLives = {
                title: Messages.get("AMOUNT_HOURS", {
                    amount: t
                }),
                interval: t + " hours"
            }), e
        },
            Product.ReplaceIconCodes = function (e) {
                var t, s = {
                    "**": "OK",
                    "&&": "YAN",
                    "}}": "HOP"
                };
                for (t in s) e = e.replace(t, " " + s[t]);
                return e
            }, Product.prototype.prepareVideoProduct = function () {
                var t = 1;
                this.reward && (t = .25, ["hard", "soft", "energy", "wands"].forEach(function (e) {
                    this.reward[e] && (this.reward[e] = 10 * Math.ceil(this.reward[e] * t / 10))
                }, this), this.reward.boosters && Object.keys(this.reward.boosters).forEach(function (e) {
                    this.reward.boosters[e] = Math.ceil(this.reward.boosters[e] * t)
                }, this)), this.videoPrice = 5 * Math.ceil(this.price * t * 2)
            }, Product.prototype.getCurrentPrice = function () {
                return this.loadedPrice || Product.CURRENCY + " " + this.price
            }, Product.prototype.showBoughtMessage = function (e) {
                var s, i, n;
                this.image && (s = this.boughtMessage || "Product.YouBought", (i = this.boughtMessageParams || {}).moves = this.moves, e && (e.hard || e.soft) && (i.coins = e.hard || e.soft), n = cleverapps.platform.getExternalUrl(this.image), cc.loader.load(n, function (e) {
                    var t = void 0;
                    e || (t = new cc.Sprite(n)), cleverapps.notification.create(s, {
                        toReplace: i,
                        image: t
                    })
                }))
            }, Product.prototype.onBuyed = function (e) {
                var t = (e = e || {}).restore,
                    s = this.restoreLogic || {},
                    i = t && (s.GetRestoreReward && s.GetRestoreReward(this) || this.restoreReward) || PeriodicSaleLogic.addProductBonus(this) || this.reward;
                this.showBoughtMessage(i), i && !e.noRewardWindow && (cleverapps.meta.isFocused() ? RewardWindow.createPurchaseWindow(i) : cleverapps.meta.display({
                    focus: (t ? "restore" : "purchase") + "RewardWindow",
                    action: function (e) {
                        RewardWindow.createPurchaseWindow(i), cleverapps.meta.onceNoWindowsListener = e
                    }
                })), cleverapps.userClan && void 0 !== cleverapps.userClan.id && this.clanGift && !this.videoProduct && cleverapps.clans.sendGift({
                    purchase: this.itemId
                }), cleverapps.user.incProgressCompare(50), cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect)
            }, Product.prototype.logBuyItem = function () {
                var e = cleverapps.windows.findWindow(ShopWindow),
                    e = {
                        store_type: e && e.getTitle(),
                        item_name: this.constructor === Product ? this.title : void 0,
                        item_price: this.price,
                        cost_type: this.currency || this.loadedCurrencyCode
                    },
                    t = Object.keys(this.reward || {})[0];
                t && (e.item_id = t, e.item_num = this.reward[t]), this.itemId.startsWith("buyEnergy") && (e.item_id = "energy", e.item_num = this.reward), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.BUY_ITEM, e)
            }, Product.prototype.buy = function (e, t) {
                cleverapps.paymentsManager.purchase(this, e, t)
            }, Product.Create = function (e) {
                e = Product.SearchProductId(e);
                var t = cleverapps.config.products[e] || VirtualProducts[e];
                if (t) return (t = cleverapps.clone(t, !0)).itemId = e, new (cleverapps.config.products[e] ? Product : VirtualProduct)(t)
            }, Product.WAIT_NO_MORE = 4e3, Product.CURRENCY = "$", Product.CURRENCY_CODE = "USD", Product.PENDING_PURCHASE = "pendingPurchase", Product.OVERLAY_CANCEL = "overlayCancel", Product.TIMEOUT_CANCEL = "timeoutCancel", Product.PURCHASE_PROCESSING = "purchaseProcessing", Product.RESTORE_CHECK = "restoreCheck", Product.CURRENCY_SIGNS = {
                USD: "$",
                EUR: "€",
                GBP: "£",
                RUB: "₽"
            },
            function (e) {
                Product.call(this, e)
            }),
        PaymentOverlay = (VirtualProduct.prototype = Object.create(Product.prototype), (
            VirtualProduct.prototype.constructor = VirtualProduct).prototype.getCurrentPrice = function () {
                return "hard" === this.currency ? "$$" + this.price : "@@" + this.price
            }, VirtualProduct.prototype.buy = function (e) {
                var t = "hard" === this.currency ? levels.user.spendHard : levels.user.spendSoft,
                    s = "hard" === this.currency ? "buy_hard" : "buy_soft";
                return !!t.call(levels.user, this.spentEvent, this.price) && (new RewardWindow(this.reward, {
                    event: s
                }), cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect), e(!0), !0)
            }, cc.Scale9Sprite.extend({
                ctor: function () {
                    var e = cleverapps.UI.getSceneSize();
                    this._super(bundles.pixel.frames.pixel_png), this.setContentSize2(e.width, e.height), this.setAnchorPoint2(), this.setLocalZOrder(TransitionAnimation.ZORDER + 1), this.setPositionRound(e.width / 2, e.height / 2), cc.eventManager.addListener({
                        event: cc.EventListener.TOUCH_ONE_BY_ONE,
                        swallowTouches: !0,
                        onTouchBegan: function () {
                            return !0
                        },
                        onTouchEnded: function () {
                            return this.closeText.isVisible() && this.startCancel(), !0
                        }.bind(this)
                    }, this),
                        cleverapps.UI.disableHover = !0, this.addCleaner(function () {
                            cleverapps.UI.disableHover = !1
                        }), this.addText(), this.addCloseText(), this.setOpacity(0), this.showLoading(), this.runAction(new cc.Sequence(new cc.DelayTime(4), new cc.CallFunc(function () {
                            this.hideLoading(), PaymentOverlay.isCancelAvailable() ? this.setColor(cleverapps.styles.COLORS.BLACK) : this.removeFromParent()
                        }.bind(this)), new cc.FadeTo(.3, 80)))
                },
                showLoading: function () {
                    var e = this.loading = WaitWindow.prototype.showLoading.call(this);
                    e.setPositionRound(this.width / 2, this.height / 2), this.addChild(e), e.visible = !1, e.runAction(new cc.Sequence(new cc.DelayTime(.2), new cc.CallFunc(function () {
                        e.visible = !0
                    })))
                },
                hideLoading: function () {
                    this.loading && (this.loading.removeFromParent(), delete this.loading)
                },
                updatePosition: function () {
                    var e = cleverapps.UI.getSceneSize();
                    this.setContentSize2(e.width, e.height), this.setPositionRound(e.width / 2, e.height / 2), this.loading && this.loading.visible && (this.hideLoading(), this.showLoading()),
                        this.text && this.text.setPositionRound(cleverapps.styles.RewardedAdOverlay.text), this.closeText && (this.closeText.setDimensions(e.width, 0), this.closeText.fitTo(e.width), this.closeText.setPositionRound(cleverapps.styles.PaymentOverlay.closeText))
                },
                addText: function () {
                    var e = this.text = cleverapps.UI.generateOnlyText("ProcessingInProgress", cleverapps.styles.FONTS.REWARDED_AD_OVERLAY_TEXT);
                    e.setPositionRound(cleverapps.styles.RewardedAdOverlay.text), this.addChild(e), e.setOpacity(0), e.runAction(new cc.Sequence(new cc.DelayTime(4), new cc.FadeIn(.3)))
                },
                addCloseText: function () {
                    var e = this.closeText = cleverapps.UI.generateOnlyText("Window.ClickToClose", cleverapps.styles.FONTS.PAYMENT_OVERLAY_CLOSE_TEXT);
                    e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setDimensions(cleverapps.UI.getSceneSize().width, 0), e.fitTo(cleverapps.UI.getSceneSize().width), e.setPositionRound(cleverapps.styles.PaymentOverlay.closeText), this.addChild(e), e.setOpacity(0), e.setVisible(!1), e.runAction(new cc.Sequence(
                        new cc.DelayTime(PaymentOverlay.CLOSE_AVAILABLE / 1e3), new cc.Show, new cc.FadeIn(.3)))
                },
                startCancel: function () {
                    this.text.visible = !1, this.closeText.visible = !1, this.showLoading();
                    var e = PaymentOverlay.CANCEL_DURATION / 1e3;
                    cleverapps.payments.getPurchaseState() === PaymentsManager.STATE_VALIDATE && (e += 5), this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.CallFunc(function () {
                        this.hideLoading(), cleverapps.paymentsManager.stopPurchasePlayer()
                    }.bind(this))))
                },
                onEnter: function () {
                    this._super(), console.log("PaymentsManager overlay created")
                },
                onExit: function () {
                    this._super(), console.log("PaymentsManager overlay closed")
                }
            })),
        BaseProductTile = (PaymentOverlay.isCancelAvailable = function () {
            return !cleverapps.platform.oneOf(Draugiem, Microsoft, Amazon)
        }, PaymentOverlay.initialize = function () {
            var e = "15 seconds",
                t = "10 seconds";
            cleverapps.platform.oneOf(MobileMyMailRu) && (e = "5 seconds"), cleverapps.platform.oneOf(CleverApps, MSStart) && (e = "30 seconds"), cleverapps.platform.oneOf(Apple) && (e = "30 seconds", t = "20 seconds"), cleverapps.payments instanceof YooKassaPayments && (e = "5 seconds", t = "2 seconds"), PaymentOverlay.CLOSE_AVAILABLE = cleverapps.parseInterval(e), PaymentOverlay.CANCEL_DURATION = cleverapps.parseInterval(t)
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PAYMENT_OVERLAY_TEXT: {
                size: 60,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            PAYMENT_OVERLAY_CLOSE_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.PaymentOverlay = {
            text: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            closeText: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -100
                }
            }
        }, cc.Node.extend({
            ctor: function (e, t, s) {
                this._super(), this.tileModel = e, this.styles = t, this.options = s || {}, this.setAnchorPoint2(), this.setContentSize2(t.width, t.height), this.addBackground(), this.addDecorators(), this.updateTileState(), this.tileModel.onGetView = this.createListener(function () {
                    return this
                }.bind(this)),
                    this.tileModel.onUpdateTileModel = this.createListener(this.updateTileState.bind(this)), this.tileModel.onBuyVideoProduct = this.createListener(this.buyVideoProduct.bind(this)), this.tileModel.onUpdateAvailability = this.createListener(this.updateAvailability.bind(this))
            },
            onExit: function () {
                this.tileModel.onExit && this.tileModel.onExit()
            },
            buyVideoProduct: function () {
                this.button.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.2), new cc.CallFunc(function () {
                    this.button.setString(this.button.getText()), this.button.setStringOff(this.button.getText(!0))
                }, this), new cc.ScaleTo(.3, 1)))
            },
            updateAvailability: function () {
                this.tileModel.isAvailable() ? (this.button && this.button.enable(), this.icon && this.icon.enable()) : (this.button && this.button.disable(), this.icon && this.icon.disable()), this.titleBg && this.titleBg.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(this.getTitleImage())), this.descriptionBg && this.descriptionBg.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(this.getDescriptionBg()))
            },
            addFinger: function () {
                this.finger = FingerView.hintClick(this.button)
            },
            removeFinger: function () {
                FingerView.remove(this.finger), this.finger = void 0
            },
            updateTileState: function () {
                this.content && this.content.removeFromParent(), this.content = this.createContent(), this.addChild(this.content), this.tileBadge && this.tileBadge.removeFromParent(), this.tileBadge = this.createBadge(), this.tileBadge && this.addChild(this.tileBadge), this.options.onClicked && !this.options.noTileClick && (this.clickHandler && (this.clickHandler.remove(), this.clickHandler = void 0), this.tileModel.isAvailable() && (this.clickHandler = cleverapps.UI.onClick(this, function () {
                    cleverapps.audio.playSound(bundles.main.urls.click_effect), this.options.onClicked(this.tileModel)
                }.bind(this))))
            },
            addBackground: function () {
                var e = this.styles.background,
                    t = e.tileBg || bundles.tile_shop.frames.shop_tile_bg_png,
                    t = cleverapps.UI.createScale9Sprite(t, e.adjustBackgroundCapInsets ? cleverapps.UI.Scale9Rect.TwoPixelXY : cleverapps.UI.Scale9Rect.Default);
                t.setContentSize2(this.width, this.height),
                    t.setPositionRound(this.width / 2, this.height / 2), this.addChild(t)
            },
            addDecorators: function () {
                var e = this.styles.decorators;
                e && e.forEach(function (e) {
                    var t, s;
                    e.filter && !e.filter(this.tileModel) || (t = cleverapps.UI.createScale9Sprite(e.image, cleverapps.UI.Scale9Rect.TwoPixelXY), e.type === Decors.TYPE_SCALE9 && t.setContentSize2(e.width || t.width, e.height || t.height), t.setPositionRound(e), t.setLocalZOrder(e.zOrder || 0), e.content && (s = e.content.generator(this.tileModel.product), t.addChild(s), s.setPositionRound(e.content)), e.fitToBox && cleverapps.UI.fitToBox(t, e.fitToBox), this.addChild(t))
                }, this)
            },
            createBadge: function () {
                var e = this.tileModel.getBadge();
                if (e) return (e = new TileBadge(e)).setPositionRound(this.styles.badge), e.setLocalZOrder(2), e.setScale(this.styles.badge.scale), this.tileModel.isAvailable() || e.disable(), e
            },
            createContent: function () {
                var e = this.styles,
                    t = this.createLimit(),
                    s = this.icon = this.createIcon(),
                    i = this.wrapTitleWithBg(this.createTitle()),
                    n = this.wrapDescriptionWithBg(this.createDescription()),
                    o = this.button = this.createButton(),
                    a = [t, s, i, n, o],
                    a = (e.content.order === BaseProductTile.ORDER.TITLE_TOP ? a = [t, i, s, n, o] : e.content.order === BaseProductTile.ORDER.TITLE_BOTTOM && (a = [t, s, n, i, o]), new cleverapps.Layout(a.filter(Boolean), {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.content[this.tileModel.product.itemId] && e.content[this.tileModel.product.itemId].margin || e.content.margin
                    }));
                return a.setAnchorPoint2(), a.setPositionRound(this.options.contentOffset || e.content), a.setLocalZOrder(1), t && (t.y += e.limit.y), s && (s.y += e.icon.y), i && (i.x += e.title.x, i.y += e.title.y), n && (n.x += e.description.x, n.y += e.description.y), o && (o.y += e.button.y), a
            },
            createIcon: function () {
                var e = new TileIcon(this.tileModel, {
                    animationOverride: this.options.iconAnimationOverride,
                    skipScale: this.options.iconSkipScale,
                    zOrder: this.options.iconZOrder
                });
                return this.tileModel.isAvailable() || e.disable(), e
            },
            createLimit: function () {
                var e, t, s, i, n = this.tileModel.getProductLimit();
                if (n) return e = this.styles.limit,
                    t = cleverapps.styles.FONTS.PRODUCT_TILE_LIMIT_TEXT, n.countdown ? (i = cleverapps.UI.generateOnlyText("TileShop.tile.leftTime", t), s = new cleverapps.CountDownView(new cleverapps.CountDown(n.countdown, {
                        onFinish: this.tileModel.updateModelState.bind(this.tileModel)
                    }), {
                        font: t
                    }), new cleverapps.Layout([i, s].filter(Boolean), {
                        direction: cleverapps.UI.VERTICAL,
                        dimensions: e
                    })) : n.left ? ((i = cleverapps.UI.generateOnlyText(n.left, t)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), i.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), i.setDimensions(e.width, e.height), i) : void 0
            },
            createDescription: function () { },
            wrapDescriptionWithBg: function (e) {
                if (e) {
                    var t = this.getDescriptionBg();
                    if (!t) return e;
                    var s = this.styles.description,
                        t = this.descriptionBg = new cc.Scale9Sprite(t);
                    return t.setContentSize2(s.bg && s.bg.width || e.width, s.bg && s.bg.height || e.height), t.setAnchorPoint2(), t.setPositionRound(this.styles.description.bg), t.setLocalZOrder(-1), t.addChild(e), e.setPositionRound(t.width / 2, t.height / 2), t
                }
            },
            getTitleImage: function () {
                var e = this instanceof PackProductTile && bundles.tile_shop.frames.pack_shop_title || bundles.tile_shop.frames.shop_title;
                return e = !this.tileModel.isAvailable() ? this instanceof PackProductTile && bundles.tile_shop.frames.pack_shop_title_off || bundles.tile_shop.frames.shop_title_off : e
            },
            getDescriptionBg: function () {
                var e = bundles.tile_shop.frames.description_bg;
                return (e = !this.tileModel.isAvailable() ? bundles.tile_shop.frames.description_bg_off : e) || bundles.tile_shop.frames.rewards_block_bg_png
            },
            createTitle: function () {
                var e, t, s;
                if (this.styles.title) return e = cleverapps.styles.FONTS.SHOP_WINDOW_SMALL_TILE_TITLE, t = this.tileModel.getTitle(), cleverapps.UI.ImageFont.IsApplicable(cleverapps.styles.FONTS.SHOP_WINDOW_TILE_TITLE, t) && (e = cleverapps.styles.FONTS.SHOP_WINDOW_TILE_TITLE), s = this.tileModel.getRewardsIcon(), new TextWithIcon((s ? "%%" : "") + t, {
                    font: e,
                    icons: {
                        "%%": s
                    }
                })
            },
            wrapTitleWithBg: function (e) {
                var t, s;
                if (e) return t = this.styles.title,
                    s = this.titleBg = cleverapps.UI.createScale9Sprite(this.getTitleImage()), s.setAnchorPoint2(), s.setLocalZOrder(t.zOrder), s.setContentSize2(t.width || s.width, t.height || s.height), e.fitTo && e.fitTo(.9 * s.width), e.setPositionRound(t.text), s.addChild(e), s
            },
            createRewards: function (e) {
                var t = new RewardsList(this.tileModel.getReward()).listRewards()[0],
                    s = t.getText("merge" === cleverapps.config.type ? "" : "x"),
                    i = TextWithIcon.ICONS_BY_NAME[t.type] || "%%",
                    n = this.tileModel.getRewardsIcon();
                return new TextWithIcon((i = n ? "%%" : i) + s, {
                    font: e,
                    icons: {
                        "%%": n || RewardTypes[t.type].icon
                    }
                })
            },
            createButton: function () {
                var e;
                if (this.styles.button && !this.options.noButton) return e = new TileButton(this.tileModel, {
                    onClicked: function () {
                        this.removeFinger(), this.options.onClicked.apply(this, arguments)
                    }.bind(this)
                }), e.setLocalZOrder(1), this.tileModel.isAvailable() || e.disable(), e
            }
        })),
        CoinsProductTile = (BaseProductTile.ORDER = {
            DEFAULT: 0,
            TITLE_TOP: 1,
            TITLE_BOTTOM: 2
        }, cleverapps.styles.BaseProductTile = {
            width: 444,
            height: 747,
            background: {},
            badge: {
                x: {
                    align: "left",
                    dx: -30
                },
                y: {
                    align: "top",
                    dy: 30
                },
                scale: 1
            },
            content: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            limit: {
                width: 370,
                height: 70,
                y: 0
            },
            icon: {
                y: 0
            },
            title: {
                width: 480,
                x: 0,
                y: 0,
                zOrder: 1,
                text: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                },
                content: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                }
            },
            description: {
                width: 360,
                height: 180,
                y: 0,
                x: 0,
                bg: {
                    width: 494,
                    height: 120,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    }
                }
            },
            button: {
                y: 0
            }
        }, BaseProductTile.extend({
            ctor: function (e, t) {
                var s = CoinsProductTile.styles = CoinsProductTile.styles || cleverapps.overrideStyles(cleverapps.styles.BaseProductTile, cleverapps.styles.CoinsProductTile, !0);
                this._super(e, s, t)
            },
            createTitle: function () {
                if (this.styles.title) return this.createRewards(cleverapps.styles.FONTS.TILE_SHOP_COINS_OFFER)
            },
            createDescription: function () {
                if (this.styles.description) return this.createRewards(cleverapps.styles.FONTS.TILE_SHOP_COINS_OFFER)
            }
        })),
        PackProductTile = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PRODUCT_TILE_LIMIT_TEXT: {
                size: 35,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.CoinsProductTile = {}, BaseProductTile.extend({
            ctor: function (e, t) {
                var s = PackProductTile.styles = PackProductTile.styles || cleverapps.overrideStyles(cleverapps.styles.BaseProductTile, cleverapps.styles.PackProductTile, !0);
                this._super(e, s, t = t || {})
            },
            createDescription: function () {
                return new TileRewardsBlock(this.tileModel, {
                    size: cc.size(this.styles.description),
                    font: cleverapps.styles.FONTS.PACK_TILE_REWARDS_TEXT,
                    icons: {},
                    paddingY: this.styles.description.paddingY
                })
            }
        })),
        SoftCurrencyTile = (cleverapps.styles.PackProductTile = {}, BaseProductTile.extend({
            ctor: function (e, t) {
                var s = SoftCurrencyTile.styles = SoftCurrencyTile.styles || cleverapps.overrideStyles(cleverapps.styles.BaseProductTile, cleverapps.styles.SoftCurrencyTile, !0);
                (t = t || {}).noTileClick = !0, t.iconSkipScale = !0, t.iconAnimationOverride = e.product.animation ? {
                    json: bundles.tile_shop.jsons.shop_lives_animations_json,
                    delay: 0
                } : {},
                    this._super(e, s, t)
            },
            createTitle: function () {
                return this.createRewards(cleverapps.styles.FONTS.TILE_SHOP_COINS_OFFER)
            }
        })),
        SubscriptionTile = (cleverapps.styles.SoftCurrencyTile = {}, BaseProductTile.extend({
            ctor: function (e, t) {
                var s = SubscriptionTile.styles = SubscriptionTile.styles || cleverapps.overrideStyles(cleverapps.styles.BaseProductTile, cleverapps.styles.SubscriptionTile, !0);
                (t = t || {}).onClicked = this.onClick.bind(this), t.iconZOrder = s.icon.zOrder, this._super(e, s, t)
            },
            createDescription: function () {
                var e, t = this.styles.description,
                    s = new cc.Node,
                    i = (s.setAnchorPoint2(), s.setContentSize2(t), bundles.tile_shop.frames.prem_rewards_bg && ((i = cleverapps.UI.createScale9Sprite(bundles.tile_shop.frames.prem_rewards_bg, cleverapps.UI.Scale9Rect.TwoPixelY)).setContentSize2(t), s.addChild(i), i.setPositionRound(s.width / 2, s.height / 2), this.tileModel.isAvailable() || (i.setOpacity(160), i.setColor(new cc.Color(200, 200, 200, 255)))), this.tileModel.getDescription()),
                    n = cleverapps.subscription.getLeftTime();
                return i.title ? ((
                    e = cleverapps.UI.generateOnlyText(i.title, cleverapps.styles.FONTS.TILE_REWARDS_HEADER)).setDimensions(t.NATextWidth, 0), e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.fitTo(void 0, .9 * s.height)) : e = n ? this.createTimer(n) : new TileRewardsBlock(this.tileModel, {
                        size: this.styles.description,
                        font: cleverapps.styles.FONTS.TILE_REWARDS,
                        columns: "tripeaks" === cleverapps.config.name ? 3 : 2,
                        icons: {
                            treasure: bundles.reward_icons.frames.treasure_chest_png
                        }
                    }), e.setPositionRound(t.content), s.addChild(e), s
            },
            getTitleImage: function () {
                return bundles.tile_shop.frames.prem_title_bg || BaseProductTile.prototype.getTitleImage.call(this)
            },
            createIcon: function () {
                var e, t = this._super();
                return this.tileModel.isAvailable() && ((e = new cleverapps.Spine(bundles.tile_shop.jsons.shop_sparkles_large_json)).setAnimation(0, "animation", !0), t.icon.addChild(e, cleverapps.styles.SubscriptionTile.icon.animation.zOrder), e.setPositionRound(t.icon.width / 2, t.icon.height / 2)), t
            },
            createTimer: function (e) {
                var t = this.styles.description,
                    e = new cleverapps.CountDownView(new cleverapps.CountDown(e, {
                        onFinish: this.tileModel.updateModelState.bind(this.tileModel)
                    }), {
                        font: cleverapps.styles.FONTS.TILE_REWARDS
                    }),
                    s = new cc.Sprite(bundles.timer.frames.timer_png),
                    s = (s.setScale(t.timer.scale), new cleverapps.Layout([s, e], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: t.timer.margin
                    })),
                    e = cleverapps.UI.generateOnlyText("TileShop.subscription.next", cleverapps.styles.FONTS.TILE_REWARDS_HEADER);
                return e.fitTo(t.text.width), new cleverapps.Layout([e, s], {
                    margin: t.margin,
                    direction: cleverapps.UI.VERTICAL
                })
            },
            createButton: function () {
                var e = this.button = new TileButton(this.tileModel, {
                    textOff: this.tileModel.getDisabledPrice(),
                    text: this.tileModel.getCurrentActionText(),
                    onClicked: this.onClick.bind(this)
                });
                return e.setLocalZOrder(1), this.tileModel.isAvailable() || e.disable(), e
            },
            onClick: function () {
                this.removeFinger(), cleverapps.subscription.isRewardReady() ? cleverapps.subscription.receiveReward() : new SubscriptionWindow, this.tileModel.onClaim()
            }
        })),
        GrowthFundTile = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TILE_REWARDS: {
                name: "default",
                size: 45,
                color: cleverapps.styles.COLORS.WHITE
            },
            TILE_REWARDS_HEADER: {
                name: "default",
                size: 35,
                color: cleverapps.styles.COLORS.WHITE
            }
        }), cleverapps.styles.SubscriptionTile = {
            background: {
                adjustBackgroundCapInsets: !0,
                tileBg: bundles.tile_shop.frames.prem_tile_bg
            },
            description: {
                width: 360,
                height: 180,
                margin: 0,
                rewardsMargin: {
                    x: 5,
                    y: 5
                },
                amountMargin: 0,
                content: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    }
                },
                NATextWidth: 300,
                timer: {
                    margin: 10,
                    scale: 1.3
                },
                text: {
                    width: 350
                }
            },
            icon: {
                zOrder: -1,
                animation: {
                    zOrder: -1
                }
            }
        }, BaseProductTile.extend({
            ctor: function (e, t) {
                var s = GrowthFundTile.styles = GrowthFundTile.styles || cleverapps.overrideStyles(cleverapps.styles.BaseProductTile, cleverapps.styles.GrowthFundTile, !0);
                (t = t || {}).onClicked = this.onClick.bind(this), t.iconZOrder = s.icon.zOrder, t.iconSkipScale = !0, this._super(e, s, t)
            },
            createDescription: function () {
                var e = this.styles.description,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2(e),
                        bundles.tile_shop.frames.prem_rewards_bg && ((s = cleverapps.UI.createScale9Sprite(bundles.tile_shop.frames.prem_rewards_bg, cleverapps.UI.Scale9Rect.TwoPixelY)).setContentSize2(e), t.addChild(s), s.setPositionRound(t.width / 2, t.height / 2), this.tileModel.isAvailable() || (s.setOpacity(160), s.setColor(new cc.Color(200, 200, 200, 255)))), cleverapps.UI.generateOnlyText(this.tileModel.getProductDescription(), cleverapps.styles.FONTS.TILE_REWARDS));
                return s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.setDimensions(e.text.width, 0), s.fitTo(void 0, e.text.height), t.addChild(s), s.setPositionRound(e.text), t
            },
            getTitleImage: function () {
                return bundles.tile_shop.frames.prem_title_bg || BaseProductTile.prototype.getTitleImage.call(this)
            },
            createIcon: function () {
                var e, t = this._super();
                return this.tileModel.isAvailable() && ((e = new cleverapps.Spine(bundles.tile_shop.jsons.shop_sparkles_large_json)).setAnimation(0, "animation", !0), t.icon.addChild(e, cleverapps.styles.GrowthFundTile.icon.animation.zOrder),
                    e.setPositionRound(t.icon.width / 2, t.icon.height / 2)), t
            },
            createButton: function () {
                var e = Messages.get("TileShop.tile.level", {
                    level: cleverapps.humanReadableNumber({
                        floatLevel: GrowthFund.LEVELS.available
                    })
                }),
                    t = "TileShop.growthFund.button",
                    e = (cleverapps.growthFund.findFirst(GrowthFund.STATE.READY) && cleverapps.growthFund.isBought() && (t = "Claim"), new TileButton(this.tileModel, {
                        onClicked: this.onClick.bind(this),
                        textOff: e,
                        text: t
                    }));
                return e.setLocalZOrder(1), this.tileModel.isAvailable() || e.disable(), e
            },
            onClick: function () {
                new GrowthFundWindow
            }
        })),
        TileModel = (cleverapps.styles.GrowthFundTile = {
            width: 460,
            content: {
                margin: 10
            },
            background: {
                adjustBackgroundCapInsets: !0,
                tileBg: bundles.tile_shop.frames.prem_tile_bg
            },
            icon: {
                zOrder: -1,
                animation: {
                    zOrder: -1
                }
            },
            description: {
                height: 130,
                width: 380,
                text: {
                    width: 325,
                    height: 90,
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                }
            },
            button: {
                txtWidth: 165,
                txtHeight: 75
            }
        }, function (e) {
            this.product = e, this.onUpdateTileModel = function () { }, this.onGetView = function () { },
                this.onBuyVideoProduct = function () { }, this.onUpdateAvailability = function () { }, cleverapps.meta.showControlsWhileFocused(this.getCurrencyControl()), this.product.videoProduct && cleverapps.rewardedAdsManager.on("changeLoaderState:" + RewardedAdsManager.REWARDED, this.updateAvailability.bind(this), this)
        }),
        SoftCurrencyTileModel = (TileModel.prototype.onExit = function () {
            runCleaners(this)
        }, TileModel.prototype.getCurrencyControl = function () {
            return "hard" === this.product.currency ? "MenuBarGoldItem" : "soft" === this.product.currency ? "MenuBarCoinsItem" : []
        }, TileModel.prototype.currentVideoProgress = function () {
            return cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PRODUCT_VIDEO_PROGRESS + this.product.itemId) || 0
        }, TileModel.clearVideoProgress = function (e) {
            return cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.PRODUCT_VIDEO_PROGRESS + e.itemId)
        }, TileModel.prototype.updateModelState = function () {
            this.onUpdateTileModel()
        }, TileModel.prototype.updateAvailability = function () {
            this.onUpdateAvailability()
        },
            TileModel.prototype.getCurrentPrice = function () {
                return this.product.videoProduct ? "##" + this.currentVideoProgress() + "/" + this.product.videoPrice : this.product.getCurrentPrice()
            }, TileModel.prototype.getDisabledPrice = function () {
                return this.product.videoProduct ? this.getCurrentPrice() : "Claimed"
            }, TileModel.prototype.isAttention = function () {
                return this.isAvailable() && this.product.attention
            }, TileModel.prototype.getTitle = function () {
                return this.product.title
            }, TileModel.prototype.getDescription = function () {
                return this.product.description
            }, TileModel.prototype.getPrice = function () {
                return this.product.price
            }, TileModel.prototype.getItemId = function () {
                return this.product.itemId
            }, TileModel.prototype.getIcon = function () {
                return this.product.icon
            }, TileModel.prototype.getViewClassName = function () {
                return this.product.ViewClassName || CoinsProductTile
            }, TileModel.prototype.getProductDescription = function () { }, TileModel.prototype.getProductLimit = function () { }, TileModel.prototype.getRewardsIcon = function () {
                return bundles.reward_icons.frames[this.product.rewardsIcon]
            }, TileModel.prototype.getReward = function () {
                return this.product.reward
            }, TileModel.prototype.isEnabled = function () {
                return "unlimitedLives" === this.product.key ? !cleverapps.flags.videoAdsMainMonetization : "energyLottery" !== this.product.key || void 0 !== Game.currentGame.energyLottery
            }, TileModel.prototype.checkDisabledProducts = function () {
                if (this.product.disableProductIds)
                    for (var e = 0; e < this.product.disableProductIds.length; ++e) {
                        var t = TileModel.Create(Product.Create(this.product.disableProductIds[e]));
                        if (t.isEnabled() && t.isAvailable()) return !1
                    }
                return !0
            }, TileModel.prototype.buyVideoProduct = function (e) {
                var t = AdsLimits.TYPES.PRODUCT;
                "undefined" != typeof UnitsShopTileModel && this instanceof UnitsShopTileModel && (t = AdsLimits.TYPES.CINEMA), cleverapps.rewardedAdsManager.loadAndPlay({
                    type: RewardedAdsManager.REWARDED,
                    adLimit: t,
                    callback: function () {
                        this.incVideoProduct(e)
                    }.bind(this)
                })
            }, TileModel.prototype.incVideoProduct = function (e) {
                var t = this.currentVideoProgress();
                ++t >= this.product.videoPrice && (t = 0, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.VIDEO_PRODUCT_BUY), this.product.onBuyed && this.product.onBuyed(), e()), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PRODUCT_VIDEO_PROGRESS + this.product.itemId, t), this.onBuyVideoProduct()
            }, TileModel.prototype.buy = function (t) {
                if (!this.product.videoProduct) return this.product.buy(function (e) {
                    e && (this.product.logBuyItem(), t())
                }.bind(this));
                this.buyVideoProduct(t)
            }, TileModel.prototype.isAvailable = function () {
                return !(this.product.videoProduct && !cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED))
            }, TileModel.prototype.wantsScroll = function () {
                return this.badge
            }, TileModel.prototype.getBadge = function () {
                return PeriodicSaleLogic.NeedTileDecor(this) ? {
                    rotation: 0,
                    image: bundles.tile_shop.frames.bonussale_badge,
                    icon: new cc.Sprite(bundles.reward_icons.frames.bonussale_gift),
                    clickAction: function () {
                        cleverapps.windows.currentWindow().close(),
                            new PeriodicSaleWindow(cleverapps.missionManager.findByType(Mission.TYPE_PERIODIC_SALE))
                    }
                } : cleverapps.clans && Clans.IsAvailable() && this.product.clanGift && !this.product.videoProduct && !(this instanceof SubscriptionTileModel && cleverapps.subscription.isActive() || this instanceof GrowthFundTileModel && cleverapps.growthFund && cleverapps.growthFund.isBought()) ? {
                    icon: new cc.Sprite(bundles.reward_icons.frames.clan_gift_png),
                    tooltipText: "ClanGift.Text"
                } : this.badge || (this.product.discount ? {
                    type: "discount",
                    text: this.product.discount
                } : this.product.value ? {
                    type: "value",
                    value: this.product.value
                } : this.product.badge ? {
                    text: this.product.badge
                } : void 0)
            }, TileModel.prototype.getView = function () {
                return this.onGetView()
            }, TileModel.Create = function (e) {
                var t = TileModel;
                return new (t = e.TileModelClass ? e.TileModelClass : t)(e)
            },
            function (e) {
                cleverapps.flags.softCurrencyRealProduct && (e = Product.Create(e.realProductId), this.realProduct = !0), TileModel.call(this, e)
            }),
        BuyEnergyTileModel = (
            SoftCurrencyTileModel.prototype = Object.create(TileModel.prototype), (SoftCurrencyTileModel.prototype.constructor = SoftCurrencyTileModel).prototype.getTitle = function () {
                return this.realProduct ? this.product.title : Messages.getLocalized(this.product.title, {
                    amount: this.getReward()
                })
            }, SoftCurrencyTileModel.prototype.buy = function (t) {
                return this.realProduct ? this.product.buy(function (e) {
                    e && (this.product.logBuyItem(), t())
                }.bind(this)) : !!levels.user.spendHard(cleverapps.EVENTS.SPENT.SOFT, this.getPrice()) && (s = this.getReward(), this.product.logBuyItem(), cleverapps.meta.isFocused() ? new RewardWindow(s) : cleverapps.meta.display({
                    focus: "SoftCurrencyRewardWindow",
                    action: function (e) {
                        new RewardWindow(s), cleverapps.meta.onceNoWindowsListener = e
                    }
                }), t(), !0);
                var s
            },
            function (e) {
                TileModel.call(this, e), this.timeout = this.product.timeout || 0, this.buyTimeEnergyProducts = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ENERGY_PRODUCTS) || {}, cleverapps.config.debugMode && this.timeout && (
                    this.timeout = cleverapps.parseInterval("5 minutes"))
            }),
        EnergyLotteryTileModel = (BuyEnergyTileModel.prototype = Object.create(TileModel.prototype), (BuyEnergyTileModel.prototype.constructor = BuyEnergyTileModel).prototype.getTitle = function () {
            return Messages.getLocalized(this.product.title, {
                restoreAmount: this.getRestoreAmount()
            })
        }, BuyEnergyTileModel.prototype.isEnabled = function () {
            return !this.isAvailable() || this.checkDisabledProducts()
        }, BuyEnergyTileModel.prototype.getRestoreAmount = function () {
            return this.product.reward
        }, BuyEnergyTileModel.prototype.isAvailable = function () {
            return 0 === this.product.price || Date.now() >= this.getNextBuyTime()
        }, BuyEnergyTileModel.prototype.getBadge = function () {
            return this.badge || (this.product.price && this.product.discount ? {
                type: "discount",
                text: this.product.discount
            } : void 0)
        }, BuyEnergyTileModel.prototype.getProductDescription = function () {
            return {
                text: "BuyEnergyProduct.description",
                countdown: Math.max(0, this.getNextBuyTime() - Date.now())
            }
        },
            BuyEnergyTileModel.prototype.getNextBuyTime = function () {
                return this.timeout + (this.buyTimeEnergyProducts[this.product.key + cleverapps.lives.slot] || 0)
            }, BuyEnergyTileModel.prototype.buy = function (e) {
                return !!this.isAvailable() && (!!cleverapps.user.spendSoft(cleverapps.EVENTS.SPENT.LIVES, this.product.price, {
                    source: this.onGetView()
                }) && (0 !== this.product.price && this.timeout && (this.buyTimeEnergyProducts[this.product.key + cleverapps.lives.slot] = Date.now(), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ENERGY_PRODUCTS, this.buyTimeEnergyProducts)), this.product.logBuyItem(), cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), new RewardWindow({
                    energy: this.getRestoreAmount()
                }, {
                    event: "buy_soft",
                    softPrice: this.product.price
                }), e(), !0))
            },
            function (e) {
                TileModel.call(this, e), Game.currentGame.energyLottery && Game.currentGame.energyLottery.isAvailable() && (Game.currentGame.energyLottery.onLotteryTileChanged = this.updateModelState.bind(this))
            }),
        LimitedVideoTileModel = (
            EnergyLotteryTileModel.prototype = Object.create(TileModel.prototype), (EnergyLotteryTileModel.prototype.constructor = EnergyLotteryTileModel).prototype.getTitle = function () {
                return Messages.getLocalized(this.product.title, {
                    restoreAmount: Game.currentGame.energyLottery.maxValue()
                })
            }, EnergyLotteryTileModel.prototype.getCurrentPrice = function () {
                return "Claim"
            }, EnergyLotteryTileModel.prototype.getDisabledPrice = function () {
                return Game.currentGame.energyLottery.isAvailable() ? "Claimed" : Messages.get("TileShop.tile.level", {
                    level: cleverapps.humanReadableNumber({
                        floatLevel: EnergyLottery.AVAILABLE.level
                    })
                })
            }, EnergyLotteryTileModel.prototype.isAvailable = function () {
                return Game.currentGame.energyLottery && Game.currentGame.energyLottery.isReady()
            }, EnergyLotteryTileModel.prototype.getProductDescription = function () {
                return {
                    text: "EnergyLotteryProduct.description",
                    countdown: Game.currentGame.energyLottery.getTimeLeft()
                }
            }, EnergyLotteryTileModel.prototype.buy = function () {
                return !!this.isAvailable() && (new (-1 !== [
                    "wondermerge", "fairy"
                ].indexOf(cleverapps.config.name) ? WheelLotteryWindow : EnergyLotteryWindow)(Game.currentGame.energyLottery), !0)
            },
            function (e) {
                TileModel.call(this, e), this.baseReward = cleverapps.flags.videoAdsMainMonetization && this.product.mainMonetizationReward || this.product.reward, "function" == typeof this.baseReward && (this.baseReward = this.baseReward()), this.adsLimit = this.product.adsLimit(), cleverapps.adsLimits.on("update", this.updateModelState.bind(this), this)
            }),
        SubscriptionTileModel = (LimitedVideoTileModel.prototype = Object.create(TileModel.prototype), (LimitedVideoTileModel.prototype.constructor = LimitedVideoTileModel).prototype.getTitle = function () {
            var e = this.baseReward.hard || this.baseReward.soft || this.baseReward.lives || this.baseReward.energy;
            return Array.isArray(e) ? Messages.getLocalized(this.product.title, {
                minAmount: e[0],
                maxAmount: e[1]
            }) : Messages.getLocalized(this.product.title, {
                restoreAmount: e
            })
        }, LimitedVideoTileModel.prototype.processReward = function (e) {
            return Array.isArray(e) ? cleverapps.Random.random(e[0], e[1]) : e
        }, LimitedVideoTileModel.prototype.isEnabled = function () {
            return !!this.product.free || cleverapps.rewardedAdsManager.isEnabled()
        }, LimitedVideoTileModel.prototype.isAvailable = function () {
            return cleverapps.adsLimits.state(this.adsLimit) === AdsLimits.STATE_READY
        }, LimitedVideoTileModel.prototype.getReward = function () {
            return this.baseReward
        }, LimitedVideoTileModel.prototype.getDisabledPrice = function () {
            if (cleverapps.adsLimits.state(this.adsLimit) === AdsLimits.STATE_UNAVAILABLE) return Messages.get("TileShop.tile.level", {
                level: cleverapps.adsLimits.getLimitLevel(this.adsLimit)
            })
        }, LimitedVideoTileModel.prototype.getCurrentPrice = function () {
            return this.product.free ? "FREE" : "##Watch"
        }, LimitedVideoTileModel.prototype.getProductLimit = function () {
            var e, t;
            return {
                left: e = -1 === [AdsLimits.STATE_UNAVAILABLE, AdsLimits.STATE_LIMITED].indexOf(cleverapps.adsLimits.state(this.adsLimit)) ? Messages.getLocalized("TileShop.tile.left", {
                    amount: cleverapps.adsLimits.getLimitLeftCount(
                        this.adsLimit)
                }) : e,
                countdown: t = cleverapps.adsLimits.state(this.adsLimit) === AdsLimits.STATE_LIMITED ? cleverapps.adsLimits.getLimitLeftTime(this.adsLimit) : t
            }
        }, LimitedVideoTileModel.prototype.getProductDescription = function () {
            return "merge" !== cleverapps.config.type ? {
                reward: !0
            } : (cleverapps.adsLimits.state(this.adsLimit) === AdsLimits.STATE_LIMITED && (e = cleverapps.adsLimits.getLimitLeftTime(this.adsLimit)), {
                text: this.product.description,
                countdown: e
            });
            var e
        }, LimitedVideoTileModel.prototype.buy = function () {
            var e = function () {
                cleverapps.adsLimits.watch(this.adsLimit), cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect);
                var t = {};
                this.baseReward.hard && (t.hard = this.processReward(this.baseReward.hard)), this.baseReward.soft && (t.soft = this.processReward(this.baseReward.soft)), this.baseReward.lives && (t.lives = this.processReward(this.baseReward.lives)), this.baseReward.energy && (t.energy = this.processReward(this.baseReward.energy)), cleverapps.meta.isFocused() ? new RewardWindow(t) : cleverapps.meta.display({
                    focus: "energyRewardWindow",
                    action: function (e) {
                        new RewardWindow(t), cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }.bind(this);
            this.product.free ? e() : cleverapps.rewardedAdsManager.playRewarded(this.adsLimit, e)
        }, function (e) {
            TileModel.call(this, e), this.onClaim = function () { }, cleverapps.subscription && cleverapps.subscription.on("update", this.updateModelState.bind(this), this)
        }),
        GrowthFundTileModel = (SubscriptionTileModel.prototype = Object.create(TileModel.prototype), (SubscriptionTileModel.prototype.constructor = SubscriptionTileModel).prototype.getReward = function () {
            var e = "instant" === Subscription.calcSource() && RewardsConfig.SubscriptionInstant,
                e = cleverapps.clone(e || RewardsConfig.Subscription, !0);
            return e.worker && e.worker.subscription && !e.worker.amount && (e.worker.amount = 1), e
        }, SubscriptionTileModel.prototype.getTitle = function () {
            return Messages.get("TileShop.subscription.title")
        }, SubscriptionTileModel.prototype.getViewClassName = function () {
            return SubscriptionTile
        },
            SubscriptionTileModel.prototype.getCurrentActionText = function () {
                return cleverapps.subscription.isRewardReady() ? "Claim" : "TileShop.subscription.details"
            }, SubscriptionTileModel.prototype.isEnabled = function () {
                return Subscription.IsAvailable() && cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition() && (cleverapps.subscription.isActive() || !cleverapps.flags.videoAdsMainMonetization)
            }, SubscriptionTileModel.prototype.isAvailable = function () {
                return Subscription.IsAvailable() && !cleverapps.subscription.getLeftTime()
            }, SubscriptionTileModel.prototype.isAttention = function () {
                return cleverapps.subscription && cleverapps.subscription.needsAttention()
            }, SubscriptionTileModel.prototype.isSmall = function () {
                return !1
            }, SubscriptionTileModel.prototype.getDescription = function () {
                var e = {};
                return Subscription.IsAvailable() ? e.rewards = this.getReward() : e.title = "TileShop.subscription.reachLvl", e
            }, SubscriptionTileModel.prototype.getDisabledPrice = function () {
                return Messages.get(Subscription.IsAvailable() ? "Claim" : "TileShop.tile.level", {
                    level: cleverapps.humanReadableNumber({
                        floatLevel: Subscription.AVAILABLE.level
                    })
                })
            }, SubscriptionTileModel.prototype.getRewardsIcon = function () {
                return bundles.tile_shop.frames.prem_crown
            },
            function (e) {
                TileModel.call(this, e), cleverapps.growthFund.on("updateState", this.updateModelState.bind(this))
            }),
        VirtualProducts = (GrowthFundTileModel.prototype = Object.create(TileModel.prototype), (GrowthFundTileModel.prototype.constructor = GrowthFundTileModel).prototype.isAttention = function () {
            return cleverapps.growthFund && cleverapps.growthFund.needsAttention()
        }, GrowthFundTileModel.prototype.isEnabled = function () {
            return cleverapps.growthFund && cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition() && (cleverapps.growthFund.isBought() || !cleverapps.flags.videoAdsMainMonetization)
        }, GrowthFundTileModel.prototype.isAvailable = function () {
            return cleverapps.growthFund && cleverapps.growthFund.isActive()
        }, GrowthFundTileModel.prototype.getProductDescription = function () {
            var e, t = "",
                s = void 0;
            return cleverapps.growthFund.isBought() ? cleverapps.growthFund.findFirst(GrowthFund.STATE.READY) ? t = "TileShop.growthFund.ready" : (e = cleverapps.growthFund.findFirst(GrowthFund.STATE.INSUFFICIENT)) ? (t = "TileShop.growthFund.reachLevel", s = {
                level: e.levelNo + 1
            }) : t = "TileShop.growthFund.allReceived" : t = "TileShop.growthFund.info", Messages.get(t, s)
        }, GrowthFundTileModel.prototype.isSmall = function () {
            return !1
        }, GrowthFundTileModel.prototype.getRewardsIcon = function () {
            if ("mergecraft" === cleverapps.config.name) return bundles.tile_shop.frames.growth_key
        }, {}),
        Terms = (VirtualProducts.initialize = function () {
            for (var e in cleverapps.config.lives && (VirtualProducts.refillLives = {
                icon: "refillLives_5_png",
                title: "LivesShopWindow.products.refillLives",
                spentEvent: cleverapps.EVENTS.SPENT.LIVES,
                currency: "hard",
                price: 99,
                TileModelClass: RefillLivesTileModel,
                ViewClassName: LivesProductTile
            }, VirtualProducts.livesForVideo = {
                icon: "lives_for_video_png",
                title: "LivesShopWindow.products.livesForVideo",
                description: "LivesForVideoProduct.description",
                reward: {
                    lives: 1
                },
                adsLimit: function () {
                    return AdsLimits.TYPES.LIVES
                },
                TileModelClass: LimitedVideoTileModel,
                ViewClassName: LivesProductTile
            }, VirtualProducts.askLives = {
                icon: "askLives_png",
                title: "LivesShopWindow.products.askLives",
                TileModelClass: AskLivesTileModel,
                ViewClassName: LivesProductTile
            }, "tile3" === cleverapps.config.type && (VirtualProducts.unlimitedLives = {
                title: "UnlimitedLives.Title",
                description: "UnlimitedLives.Description",
                spentEvent: cleverapps.EVENTS.SPENT.LIVES,
                currency: "hard",
                price: 290,
                reward: {
                    unlimitedLives: "3 days"
                },
                icon: "unlimitedLives_png",
                animation: "animation",
                ViewClassName: LivesProductTile,
                TileModelClass: BuyLivesTileModel
            }, VirtualProducts.buyLife = {
                icon: "life_1_png",
                title: "LivesShopWindow.products.buyLive",
                spentEvent: cleverapps.EVENTS.SPENT.LIVES,
                currency: "soft",
                price: 249,
                reward: {
                    lives: 1
                },
                TileModelClass: BuyLivesTileModel,
                ViewClassName: LivesProductTile
            })), cleverapps.config.energy && (VirtualProducts.buyEnergy350 = {
                icon: "energy_for_coins_png",
                title: "LivesShopWindow.products.buyEnergy",
                rewardsIcon: "shop_energy_png",
                currency: "soft",
                price: 350,
                reward: 90,
                discount: "66%",
                timeout: cleverapps.parseInterval("24 hour"),
                TileModelClass: BuyEnergyTileModel,
                ViewClassName: LivesProductTile
            }, VirtualProducts.buyEnergy700 = {
                icon: "energy_for_coins_png",
                title: "LivesShopWindow.products.buyEnergy",
                rewardsIcon: "shop_energy_png",
                currency: "soft",
                price: 700,
                reward: 90,
                discount: "33%",
                disableProductIds: ["buyEnergy350"],
                timeout: cleverapps.parseInterval("24 hour"),
                TileModelClass: BuyEnergyTileModel,
                ViewClassName: LivesProductTile
            }, VirtualProducts.buyEnergy = {
                icon: "energy_for_coins_png",
                title: "LivesShopWindow.products.buyEnergy",
                rewardsIcon: "shop_energy_png",
                currency: "soft",
                price: 1050,
                reward: 90,
                disableProductIds: ["buyEnergy350", "buyEnergy700"],
                TileModelClass: BuyEnergyTileModel,
                ViewClassName: LivesProductTile
            }, VirtualProducts.energyLottery = {
                icon: "energy_lottery_png",
                title: "LivesShopWindow.products.energyLottery",
                attention: !0,
                TileModelClass: EnergyLotteryTileModel,
                ViewClassName: LivesProductTile
            }, VirtualProducts.energyForVideo = {
                icon: "energy_for_video_png",
                title: "LivesShopWindow.products.energyForVideo",
                description: "EnergyForVideoProduct.description",
                rewardsIcon: "shop_energy_png",
                reward: {
                    energy: 30
                },
                adsLimit: function () {
                    switch (cleverapps.lives && cleverapps.lives.slot) {
                        case CustomSyncers.EXPEDITION_SLOT1:
                            return AdsLimits.TYPES.ENERGY_1;
                        case CustomSyncers.EXPEDITION_SLOT2:
                            return AdsLimits.TYPES.ENERGY_2;
                        case CustomSyncers.EXPEDITION_SLOT3:
                            return AdsLimits.TYPES.ENERGY_3;
                        default:
                            return AdsLimits.TYPES.ENERGY
                    }
                },
                TileModelClass: LimitedVideoTileModel,
                ViewClassName: LivesProductTile
            }, VirtualProducts.energyForVideoShort = {
                icon: "energy_for_video_png",
                title: "LivesShopWindow.products.energyForVideoShort",
                description: "EnergyForVideoProduct.description",
                rewardsIcon: "shop_energy_png",
                reward: {
                    energy: 5
                },
                adsLimit: function () {
                    switch (cleverapps.lives && cleverapps.lives.slot) {
                        case CustomSyncers.EXPEDITION_SLOT1:
                            return AdsLimits.TYPES.ENERGY_1_SHORT;
                        case CustomSyncers.EXPEDITION_SLOT2:
                            return AdsLimits.TYPES.ENERGY_2_SHORT;
                        case CustomSyncers.EXPEDITION_SLOT3:
                            return AdsLimits.TYPES.ENERGY_3_SHORT;
                        default:
                            return AdsLimits.TYPES.ENERGY_SHORT
                    }
                },
                TileModelClass: LimitedVideoTileModel,
                ViewClassName: LivesProductTile
            }), VirtualProducts.softCurrencyVerySmall = {
                icon: "shop_coins_very_small_png",
                title: "LivesShopWindow.products.softCurrencyVerySmall",
                rewardsIcon: "shop_coin_png",
                realProductId: "coins350",
                currency: "hard",
                price: 80,
                reward: {
                    soft: 350
                },
                TileModelClass: SoftCurrencyTileModel,
                ViewClassName: SoftCurrencyTile
            }, VirtualProducts.softCurrencySmall = {
                icon: "shop_coins_small_png",
                title: "LivesShopWindow.products.softCurrencySmall",
                rewardsIcon: "shop_coin_png",
                realProductId: "coins1100",
                currency: "hard",
                price: 250,
                reward: {
                    soft: 1100
                },
                TileModelClass: SoftCurrencyTileModel,
                ViewClassName: SoftCurrencyTile
            }, VirtualProducts.softCurrencyMedium = {
                icon: "shop_coins_medium_png",
                title: "LivesShopWindow.products.softCurrencyMedium",
                rewardsIcon: "shop_coin_png",
                realProductId: "coins3000",
                currency: "hard",
                price: 600,
                reward: {
                    soft: 3e3
                },
                TileModelClass: SoftCurrencyTileModel,
                ViewClassName: SoftCurrencyTile
            }, VirtualProducts.softCurrencyLarge = {
                icon: "shop_coins_large_png",
                title: "LivesShopWindow.products.softCurrencyLarge",
                rewardsIcon: "shop_coin_png",
                realProductId: "coins7000",
                currency: "hard",
                price: 1400,
                reward: {
                    soft: 7e3
                },
                TileModelClass: SoftCurrencyTileModel,
                ViewClassName: SoftCurrencyTile
            }, VirtualProducts.hardForVideo = {
                icon: "gold_for_video_png",
                attention: !0,
                title: "TileShop.products.hardForVideo",
                rewardsIcon: "shop_gold_png",
                reward: {
                    hard: "merge" === cleverapps.config.type ? [1, 3] : 10
                },
                mainMonetizationReward: {
                    hard: "merge" === cleverapps.config.type ? [3, 8] : 10
                },
                adsLimit: function () {
                    return AdsLimits.TYPES.HARD
                },
                TileModelClass: LimitedVideoTileModel,
                ViewClassName: "heroes" === cleverapps.config.ui ? PackProductTile : CoinsProductTile
            }, "tile3" === cleverapps.config.type && (VirtualProducts.piggybankSmall = {
                title: "Shop.PiggyBank1.Title",
                description: "Shop.PiggyBank1.Description",
                currency: "hard",
                spentEvent: cleverapps.EVENTS.SPENT.PIGGY_BANK,
                price: 290,
                restoreLogic: PiggyBank,
                reward: {
                    soft: 2120
                }
            }, VirtualProducts.piggybankMedium = {
                title: "Shop.PiggyBank2.Title",
                description: "Shop.PiggyBank2.Description",
                currency: "hard",
                spentEvent: cleverapps.EVENTS.SPENT.PIGGY_BANK,
                price: 990,
                restoreLogic: PiggyBank,
                reward: {
                    soft: 7640
                }
            }, VirtualProducts.piggybankLarge = {
                title: "Shop.PiggyBank3.Title",
                description: "Shop.PiggyBank3.Description",
                currency: "hard",
                spentEvent: cleverapps.EVENTS.SPENT.PIGGY_BANK,
                price: 5990,
                restoreLogic: PiggyBank,
                reward: {
                    soft: 25450
                }
            }, VirtualProducts.piggybankHuge = {
                title: "Shop.PiggyBank4.Title",
                description: "Shop.PiggyBank4.Description",
                currency: "hard",
                spentEvent: cleverapps.EVENTS.SPENT.PIGGY_BANK,
                price: 9900,
                restoreLogic: PiggyBank,
                reward: {
                    soft: 106060
                }
            }), ["mergecraft", "wondermerge", "fairy"].includes(cleverapps.config.name) && Object.assign(VirtualProducts, {
                caravan0: {
                    order: 0,
                    title: "Caravan.Title0",
                    price: 349,
                    icon: bundles.caravan.frames.caravan_chest_0,
                    person: bundles.caravan.frames.caravan_person_0,
                    reward: {
                        unit: [{
                            code: "caravanbox",
                            stage: 0,
                            amount: 1
                        }, {
                            code: "energycup",
                            stage: 0,
                            amount: 1
                        }, {
                            code: "coinscup",
                            stage: 0,
                            amount: 1
                        }],
                        energy: 50,
                        soft: 100,
                        wands: 20
                    }
                },
                caravan1: {
                    order: 1,
                    title: "Caravan.Title1",
                    price: 699,
                    icon: bundles.caravan.frames.caravan_chest_1,
                    person: bundles.caravan.frames.caravan_person_1,
                    value: "+50%",
                    reward: {
                        unit: [{
                            code: "caravanbox",
                            stage: 1,
                            amount: 1
                        }, {
                            code: "energycup",
                            stage: 1,
                            amount: 1
                        }, {
                            code: "coinscup",
                            stage: 1,
                            amount: 1
                        }],
                        energy: 130,
                        soft: 250,
                        wands: 50
                    }
                },
                caravan2: {
                    order: 2,
                    title: "Caravan.Title2",
                    price: 1499,
                    icon: bundles.caravan.frames.caravan_chest_2,
                    person: bundles.caravan.frames.caravan_person_2,
                    value: "+100%",
                    reward: {
                        unit: [{
                            code: "caravanbox",
                            stage: 2,
                            amount: 1
                        }, {
                            code: "energycup",
                            stage: 2,
                            amount: 1
                        }, {
                            code: "coinscup",
                            stage: 2,
                            amount: 1
                        }],
                        energy: 400,
                        soft: 750,
                        wands: 130
                    }
                }
            }), "battlefield" === cleverapps.config.type && Object.assign(VirtualProducts, {
                troops900: {
                    probabilities: [.5, .5, 0],
                    price: 900,
                    points: 1,
                    stage: 0
                },
                troops1900: {
                    probabilities: [.4, .59, .01],
                    price: 1900,
                    points: 2,
                    stage: 1
                },
                troops3800: {
                    probabilities: [.17, .8, .03],
                    price: 3800,
                    points: 3,
                    stage: 2
                },
                troops7500: {
                    probabilities: [.01, .93, .06],
                    price: 7500,
                    points: 4,
                    stage: 3
                }
            }), VirtualProducts) VirtualProducts[e].key = e;
            "zenmatch" === cleverapps.config.name && (VirtualProducts.hardForVideo = void 0)
        }, cc.Node.extend({
            ctor: function () {
                this._super();
                var e = new cc.Node,
                    t = (e.addChild(cleverapps.UI.generateTTFText("Terms.TermsOfService", cleverapps.styles.FONTS.TERMS_LINK_TEXT)), cleverapps.UI.wrap(e), this.addChild(e), cleverapps.UI.generateTTFText(" " + Messages.get("Terms.and") + " ", cleverapps.styles.FONTS.TERMS_TEXT)),
                    t = (this.addChild(t), new cc.Node);
                t.addChild(cleverapps.UI.generateTTFText("Terms.PrivacyPolicy", cleverapps.styles.FONTS.TERMS_LINK_TEXT)), cleverapps.UI.wrap(t), this.addChild(t), cleverapps.UI.arrangeWithMargins(this.children, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: cleverapps.styles.Terms.margin
                }), cleverapps.UI.wrap(this), cleverapps.UI.applyHover(e),
                    cleverapps.UI.applyHover(t), cleverapps.UI.onClick(e, function () {
                        cc.sys.openURL(Terms.TERMS_URL)
                    }), cleverapps.UI.onClick(t, function () {
                        cc.sys.openURL(Terms.PRIVACY_URL)
                    })
            }
        })),
        Restore = (cleverapps.overrideColors(cleverapps.styles.COLORS, {
            TERMS_LINK_COLOR: new cc.Color(97, 167, 221, 255),
            TERMS_TEXT_COLOR: new cc.Color(55, 80, 58, 255)
        }), cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TERMS_TEXT: {
                size: 25,
                color: cleverapps.styles.COLORS.TERMS_TEXT_COLOR
            },
            TERMS_LINK_TEXT: {
                size: 25,
                color: cleverapps.styles.COLORS.TERMS_LINK_COLOR
            }
        }), Terms.TERMS_URL = "https://cleverappssg.com/legal/terms.html", Terms.PRIVACY_URL = "https://cleverappssg.com/legal/privacy.html", cleverapps.styles.Terms = {
            margin: 6
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.parentWindow = e;
                e = cleverapps.UI.generateOnlyText("RestorePurchases", cleverapps.styles.FONTS.TERMS_LINK_TEXT);
                this.addChild(e), cleverapps.UI.wrap(this), cleverapps.UI.applyHover(this), cleverapps.UI.onClick(this, this.onPressed.bind(this))
            },
            onPressed: function () {
                var e = new WaitWindow,
                    t = cleverapps.waitNoMore(5e3, function () {
                        e && (e.close(), e = void 0)
                    });
                cleverapps.payments.restoreSubscriptions(), cleverapps.subscription.on("update", this.createListener(function () {
                    t && t(), cleverapps.subscription.isActive() && (this.parentWindow.close(), new SubscriptionWindow)
                }.bind(this)), this)
            }
        })),
        CoinsRewardView = cc.Node.extend({
            ctor: function (e) {
                this._super(), this.setAnchorPoint2(), this.options = Object.assign({}, cleverapps.styles.CoinsRewardView, e)
            },
            collectCoins: function (e) {
                var t = [],
                    s = ((this.options.coins || cleverapps.styles.CoinsRewardView.coins).forEach(function (e) {
                        t = t.concat(this.drawCoinsInCircle(e))
                    }.bind(this)), e && ((e = cleverapps.UI.generateTTFText("+" + e, cleverapps.styles.FONTS.COINS_REWARD_TEXT)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setPositionRound(this.width / 2, this.height / 2), e.setScale(this.options.text.scale / 2), e.setLocalZOrder(1000001), this.addChild(e), e.replaceParentSamePlace(cleverapps.scenes.getRunningScene()), e.opacity = 0, e.runAction(
                        new cc.Sequence(new cc.FadeIn(.2), new cc.ScaleTo(this.options.showTextTime || CoinsRewardView.SHOW_TEXT_TIME, this.options.text.scale), new cc.FadeOut(.2), new cc.RemoveSelf))), this.options.target || cleverapps.aims.getTarget(["rewardHard", "hard"])),
                    e = (t.sort(function (e, t) {
                        return e.getPositionX() - t.getPositionX()
                    }).forEach(function (e, t) {
                        e.replaceParentSamePlace(cleverapps.scenes.getMovingNode()), e.runAction(new cc.Sequence(new cc.DelayTime(CoinsRewardView.APPEAR_TIME + .01 * t), new cc.CallFunc(function () {
                            cleverapps.aims.showTarget(s)
                        }), new cc.Spawn(new cc.CollectAnimation(CoinsRewardView.COLLECT_COIN_TIME, s, {
                            jump: !0
                        }), new cc.RotateBy(CoinsRewardView.COLLECT_COIN_TIME, 180)), new cc.RemoveSelf))
                    }), new cleverapps.Spine(bundles.game.jsons.coins_reward_json));
                e.setAnimation(0, "animation", !1), e.setPositionRound(this.width / 2, this.height / 2), this.addChild(e), this.runAction(new cc.Sequence(new cc.DelayTime(2), new cc.RemoveSelf))
            },
            drawCoinsInCircle: function (e) {
                for (var t = [], s = 0; s < e.count; s++) {
                    var i = new cc.Sprite(bundles.menubar.frames.gold_png),
                        n = (i.setRotation(120 * (Math.random() - .5)), i.setScale(0), i.setLocalZOrder(1e6), 2 * Math.PI * s / e.count),
                        o = (e.baseAngle || 0) * Math.PI / 180,
                        a = e.radiusX * Math.cos(n + o),
                        n = e.radiusY * Math.sin(n + o);
                    a += .5 * (Math.random() - .5) * a, n += .5 * (Math.random() - .5) * n, i.setPosition(this.width / 2 + a, this.height / 2 + n), i.runAction(new cc.Spawn(new cc.MoveBy(CoinsRewardView.APPEAR_TIME, cc.p(.2 * a, .2 * n)), new cc.ScaleTo(CoinsRewardView.APPEAR_TIME, e.scale))), this.addChild(i), t.push(i)
                }
                return t
            }
        }),
        ReloadWindow = (cleverapps.overrideStyles(cleverapps.styles.DECORATORS, {
            COINS_TEXT_STROKE: {
                size: 3,
                color: cleverapps.styles.COLORS.COINS_REWARD_STROKE_COLOR
            }
        }), cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            COINS_REWARD_TEXT: {
                size: 120,
                color: cleverapps.styles.COLORS.COINS_REWARD_YELLOW,
                stroke: cleverapps.styles.DECORATORS.COINS_TEXT_STROKE
            }
        }), CoinsRewardView.APPEAR_TIME = .4, CoinsRewardView.SHOW_TEXT_TIME = 1.2, CoinsRewardView.COLLECT_COIN_TIME = .5, cleverapps.styles.CoinsRewardView = {
            text: {
                scale: 1
            },
            coins: [{
                radiusX: 80,
                radiusY: 80,
                count: 6,
                scale: 1
            }]
        }, Window.extend({
            onWindowLoaded: function (e) {
                var t = cleverapps.styles.ReloadWindow,
                    s = this.createText("ReloadWindow.YouHaveSavedGame"),
                    i = this.createText("ReloadWindow.WeStoreGames", {
                        gameTitle: Messages.get(cleverapps.config.title)
                    });
                this.content = new cleverapps.Layout([s, i], {
                    margin: t.margin,
                    direction: cleverapps.UI.VERTICAL
                }), this.syncInCallback = e || function () { }, this._super({
                    content: this.content,
                    title: "ReloadWindow.Title",
                    name: "reloadwindow",
                    button: {
                        width: t.button.width,
                        height: t.button.height,
                        text: "ReloadWindow.UpdateNow"
                    },
                    closeButton: !1
                }), cleverapps.windows.list = [this]
            },
            createText: function (e, t) {
                var s = cleverapps.styles.ReloadWindow,
                    e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.WINDOW_TEXT, t);
                return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setDimensions(s.text.width, 0), e
            },
            onClose: function () {
                cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), this.syncInCallback()
            }
        })),
        LocalStorageDisabledWindow = (cleverapps.styles.ReloadWindow = {
            margin: 20,
            button: {
                width: 400
            },
            text: {
                width: 600
            }
        }, "horizontal" === cleverapps.config.orientation && (cleverapps.styles.ReloadWindow.text.width *= 1.5), Window.extend({
            onWindowLoaded: function () {
                function e(e) {
                    e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setDimensions(cc.size(t.width, 0)), s.addChild(e)
                }
                var t = cleverapps.styles.LocalStorageDisabledWindow,
                    s = new cc.Node;
                e(cleverapps.UI.generateTTFText("LocalStorageDisabledWindow.text2", cleverapps.styles.FONTS.WINDOW_TEXT)), e(cleverapps.UI.generateTTFText("LocalStorageDisabledWindow.text1", cleverapps.styles.FONTS.WINDOW_TEXT)), cleverapps.UI.arrangeWithMargins(s.children, {
                    direction: cleverapps.UI.VERTICAL,
                    margin: t.margin,
                    y: t.paddingY
                }), cleverapps.UI.wrap(s), s.setAnchorPoint2(), s = cleverapps.UI.wrapWithPadding(s, t.padding), this.content = s, this._super({
                    content: s,
                    title: "LocalStorageDisabledWindow.title",
                    name: "localstoragedisabledwindow",
                    button: {
                        text: "OK",
                        width: t.button.width
                    },
                    closeButton: !1
                })
            }
        })),
        RestartWindow = (cleverapps.styles.LocalStorageDisabledWindow = {
            width: 600,
            margin: 20,
            paddingY: 20,
            padding: {
                x: 0,
                y: 35
            },
            button: {
                width: 200
            }
        }, Window.extend({
            ctor: function (e) {
                RestartWindow.showed || cleverapps.environment.isSceneWithPreview() || !cleverapps.scenes.getRunningScene() || (RestartWindow.showed = !0, this.options = e = e || {}, cleverapps.versionChecker.isNewClientVersionAvailable() && (e.title = e.title || "RestartWindow.NewVersionTitle", e.contentMessage = e.contentMessage || "RestartWindow.NewVersionAvailable"), e = e && e.contentMessage ? Messages.get(e.contentMessage) : Messages.get("RestartWindow.AnErrorOccured") || "An error occurred", this.text = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.WINDOW_TEXT, !1), this.text.setDimensions(cleverapps.styles.RestartWindow.width, cleverapps.styles.RestartWindow.height), this.text.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.text.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), this._super(), this.setLocalZOrder(1001))
            },
            onWindowLoaded: function () {
                var e = this.options && this.options.title ? Messages.get(this.options.title) : Messages.get("RestartWindow.Title") || "Try again";
                this._super({
                    content: this.text,
                    name: "RestartWindow",
                    title: e,
                    button: {
                        text: Messages.get("RestartWindow.ButtonMessage") || "Reload",
                        width: cleverapps.styles.RestartWindow.button.width,
                        height: cleverapps.styles.RestartWindow.button.height,
                        onPressed: function () {
                            cleverapps.platform.oneOf(Samsung) ? GSInstant.restart() : window.location.reload()
                        }
                    },
                    closeButton: !1
                }), this.window && 0 === this.window.height && (this.text.removeFromParent(), this.windowTitle.removeFromParent())
            }
        })),
        LoaderScene = (cleverapps.styles.RestartWindow = {
            width: 590,
            height: 460,
            button: {}
        }, "horizontal" === cleverapps.config.orientation && cleverapps.increaseStylesByKoef(cleverapps.styles.RestartWindow, 1.4),
            cc._loadingImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAu4AAAU2CAMAAAD9CcM0AAADAFBMVEUCAgEDAwIEBAMFBQQGBgUHBwYICAcJCQgKCgkLCwoMDAsNDQwODg0PDw4QEA8RERASEhETExIUFBMVFRQWFhUXFxYYGBcZGRgaGhkbGxocHBsdHRweHh0fHx4gIB8hISAiIiEjIyIkJCMlJSQmJiUnJyYoKCcpKSgqKikrKyosLCstLSwuLi0vLy4wMC8xMTAyMjEzMzI0NDM1NTQ2NjU3NzY4ODc5OTg6Ojk7Ozo8PDs9PTw+Pj0/Pz5AQD9BQUBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYCCgoGDg4KEhIOFhYSGhoWHh4aIiIeJiYiKiomLi4qMjIuNjYyOjo2Pj46QkI+RkZCSkpGTk5KUlJOVlZSWlpWXl5aYmJeZmZiampmbm5qcnJudnZyenp2fn56goJ+hoaCioqGjo6KkpKOlpaSmpqWnp6aoqKepqaiqqqmrq6qsrKutrayurq2vr66wsK+xsbCysrGzs7K0tLO1tbS2trW3t7a4uLe5ubi6urm7u7q8vLu9vby+vr2/v77AwL/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///+xGNHLAABQFUlEQVR4AezSP2vVBxQA0JumCaUpdGpLW1oaCk3JkCUdSraEfoGGDoV2bad2URwE0clVlIc4OIkuDlE3CWRwcVHQVU0IakRDJGAkSv7EdzW+32/U3fvO+QwnEvpGJOgOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7ugOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76A66g+6gO+gOuoPuoDu6g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO7qD7qA76A66g+6gO+gOuoPuoDu6g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO+iO7qA76A66g+6gO+gOuoPuoDvoju6gO+gOuoPuoDvoDrqD7qA76I7uoDvoDrqD7qA76A66g+6gO+iO7qA76A66g+6gO+gOuoPuoDvo/g7oDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7ugOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO7qD7qA76A66g+6gO+gOuoPuoDu6g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO7qD7qA76A66g+6gO+gOuoPuoDvoju6gO+gOuoPuoDvoDrqD7qA76I7uoDvoDrqD7qA76A66g+6gO+iO7qA76A66g+6gO+gOuoPuoDvoju6gO+gOuoPuoDvoDrqD7qA76A66ozvoDrqD7qA76A66g+6gO+gOuqM76A66g+6gO+gOuoPuoDvoDrqjO+gOuoPuoDvoDrqD7qA76A66ozvoDrqD7qA76A66g+6gO+gOuqM76A66g+6gO+gOuoPuoDvoDrqD7ugOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76M7La2cvLmU/0J2l2c8ixs7sZnm683Qm9n1yLsvTnU70TK5mcbqzNRs9g/NZnO7cH4/GqSxOd258EY0DWZzuzH8ajT93szbdufxxNKY3sjbdmRuMxsRa1qY7V4ai8cNK1qY78yPR+Ope1qY717+Mxuc3szbduTMWjaG5rE131qaidTxr052d36P1dzdr053/ozW1nrXpzolofXsra9OdqyPR+Oh81qY7y6PROpi16c7Wb9GaeZ616c6xaH29mLXpzsJQNAYXsjbdefZrtDpZnO50ovVvN2vTnccT0Zh5kcXpzumB6BlfzeJ0Z/2X6Bl9kNXpzqXheOv75axOd7pHBnrdH2Z5urP5X+z7cTXr053Nw8MR8fN69gHd2bvwU8TkRvYF3Vk89N0/29kndOfJo1dZn+6gO+gOuoPu7HSzP+jO7aN//HVyJevTne3ON/HG9N1E9/fY28sP32v27sM9qmp9+/i9p6QHEgLSe0ERsABKQbEoFrEAHjlKEdCDRbGIooiooFgURfmJBVCxewRROYigIiAIIohKAQHphBJIQnrJZO73nZk9mT2TMnt6Qp7PlT/he032XnutZ+U9YoDdWAsrIST34ytnPvnU7LUnWbNZphjh0PckheResZ9ubRdrMMS1/c9K1mjz46G6PJdCcq9Iydx2UDX/v2LWXHvPgcrwIiskJPdvWqJM9JQi1lgT4XTpMVZESO67r4RG9IusqTY1hKrDH6yQkNzn1oNWnW9YQz0JVZ15rJCQ3IvvNsBNx02skbLPg2psKYXkXqGM6+BhYD5rok2N4ND1IIXkXrHjV8GDYTprouWJsDN+QiG5VyJvGDylrGEN9Etd2I3Mp5DcKzM1Cp7O2sGa58TZsLlmN4XkXqlV7VDOJYdZ88xpAESPPEghuVcu/3EjyhmWyxrHsvThh/+XSyG5V2XfNShHebyEQnI/Ff3TH+UYX6OQ3E9J+283wVPihwyTkiILheQePvmftIOn0xYwlApTN//24+fTn5n85INjbh1117inZ3yydMPujPyiUgrJPcR2jUmAh+Y/MiSKj/+xYPrd1/VtFacYDdBSohud0feG2x/7vwUbj5QwRAQoCub1gIcz1jPo9i+bMaxPi2gFVTI16T1m5o97Chkikrs48mg83J2zkcGUs2X2bd3rKNAp7szb399ZzNCQ3MXS8+GuxyYGy4mfJl91mhE+ajr0g51WhoLkLo6OVeCmzzYGQ/HqFy9vAL8Yu47/IYehILmLD1rAzUV7GLADn9zYGAFIHvJRBkNAchcbLoKbKw8yILkr7j3dgAAZL5qVThH83MXR+4zQunof/Zf5xY3JCAbjBW+doAh67qJkdlNoXbybfkr76MoYBIv5oo9OUgQ9d/FzX2j13UJ/ZH92SVWxR6c0PuPSm0ffef+kl2dMe/bR+0YOuujsVilxRlQqcfDKUopg5y5S7zRD45y19FnevCuiKy29Yc8xz7y7+p+0zHyWsRYXZB3c/PPX70wec1mbeFSo/oQDFMHOXRTOag6Ndsvom+LlN8WiQjGtB0784s+jxayCZd+iyTd0qYMKdPmwmCLYuYu1l0Cj1Y/0xbax9VGR2PPv/3BHHvUo2j//rjOjUE7s7X9SBDt3cWxcLFzO2UHdMmedgQok9Zq08hB9kTZ/cFOU0/GdXIog5y5KPmoPl+et1GnZNRX9KPd4cuUJ+qx43aNd4Cl+2HaKYOcudvxbgdNN2dRl5yN1UU6z2z87Sj/9/dw58HTuVxTBzl3kT2sA1agc6nDy7a4op8vjv5cwAP9M6wwPSc/lUQQ7d7HkfNhFzbHSu403xcCDqceMfQzUjgeT4M74n0MUwc5dHJ+YAsBwxzF6lftme3gw9HrnKINh9b/NcHfFVoqg5y5WPzx4xHsn6NXOW2PhofurBxkkJ2d0grtzv6cIfu6i0ELvFp4DD82n7GMQbR1hhptWX1BEIneR+lgy3CXdtoHBVfhma7g57Z1ihp3kLn68EO6UixYXMejW9oGbxOmlDC/JXeS/0gTuOrySzlA4dKcZWgmvh7d3yV3sGW2Gm8Q7tjBEil9Nhlbi6xaGj+QuVveFuz7/LWbIWD9oBa06cxgukrso/bg13CSHek/6D2dCq8GnDA/JXWQ/kwQ33b4uZYj9fDa0Wv7IcJDcxb7hcBNz2y6G3m/dodV9C4XkHnrr+sBNu9n5DIdN3aB11WEKyT3U5rWCm+v/ZJis7wqt/+RQSO4hVfB8ErTqTT3JsPm5HTQM06wUknsIZT4UDa1u34Y1uW8bQaPREgrJPXRO3K5A6+a/GV6zE6Fx4SEKyT1UDtwErTqTTzLMip8yQeOxYgrJPTQ2XwmtFh+WMuwyboZG8jcUkntI/NoDWt1XMBJ2dofGhWkUknsILOsErRu2MzIWpcDFMKWUQnIPum/bQCPq4QxGiHUyNJpvoJDcg21+M2ikzLQwYjKvhMbwHArJPbg+agiNlvMYSUtPg0v8JxSSe1B91AAanb9nZE2ExkVpFJJ7EH1yGjR6rmeE7e8GF+MbVgrJPWg+awKNy7Yz4mYb4dIjlUJyD5a59aHxrwOMvPSL4WJ8m0JyD5J3k6Ex/Birg89i4XLRcQrJPSjm1IXGmAxWCycHwCX6YwrJPRg+S4GL8f4sVhPz4uEyMJ9Ccg/c/MZwMT2Uw+oi60q4NFhJIbkHbElLbe1PFLL6mBsDl3ElFJJ7gH7tBJfoCQWsRo5dAJdOf1NI7oHZ0hMuhnF5rFamG1DGNINCcg/I333hYhyXw+plZyu4XJVJIbkHYM+lcDE+nMtqpnAUXFJ+ppDc/XfsWmg8UMhq53MjXJ6hkNz9ljECGqOzWP3s7gqXq3IoJHc/5d0PjZtOsBoqHQOX5usoJHc/vRQFl8GprJa+iEMZwwwKyd0/81Pg0v8Aq6ddXeEyMJtCcvfH8pZw6b2V1VTJCLh03EIhufthVze4nPs7q63XDSgTP5++k9xF9o1wab+G1dfqRLhMttJXkrsoegguDZewGkvtDpfrcukryV28EYsyiXNZnRXcCpf2/9BHkrtY2QxlTC9YWa09A5fk7+gbyV3sPB9llAeKWb19k4wyynT6RHIXhXfAZcARVnPb2sLlwRL6QnIXHyWizLl/sbo73g8u12bSB5K72NIBZZotY7VXPBIuZxygkNz1KxiKMjEzWQOMh0vjPygkd/1mm1Hm3kLWANMVlKm7lEJy1217e5S5+DhrgvnxKGOaSyG561U8FmWar2GNsCIZLtMoam/uWWu+/Pyr5ZuPFFCfhQlwiprOmuH3JnB5uJRVKDyeeqxIcj9VLb+mHqDUaXbuZTcOGz3mnvvGPfrEKx+t2ptVwoplXIMyg7JZM2w7Ey7DClmJg/974Y4repzV/cq7pq/KldxPQUtboTxDfINW3YdM/XZHAct5LxZOLdawhjjY2/t51YwVd7Uywyn+wjfTJPdTTUZ/VKHJNZMXH6WbtPPhZJ7GmiLrMrj0O8ryNj7bHe6ilkjup5oN9VG12LPHL8+hy/+Z4XRxOmuKoqvg0n0vPVjX3NoQngYeltxPNavqwquLd7FMahc4xS1kjVFyPVxO30U3Jd/fEINyrjn1apfc93aCN5ctL2GZN41wuq+YNUbhELi0cs9966gElDcolZL7Kcc6FVVr/WI6XU5cDKcWm1lz5A2DS7Nt1FjQGuVFP5xJyf0UlP1EfVQq+YrXD1Dry7pQKZNKWXPk3gqXJr/TZW4dlNf1Cysl91OS5YdHLm+ZoMCTqf4lz67IoZviUXDqtJU1SOFouDRayTK/1Ec5zZ7cQ0rup6zCI5u//b9xQ6+7vF+f3j179ep1Qf+hT3y0/lAhPW3rBJUygTVJ6Ri4NPiOTiVD4anNhF2k5C7I2VFQtV3PGuUOuCQtotOe9nATffEru2knuYuRcBpezBrldrjELabTlmbQaPvQz9l0kNzF3s5QJSxgzTIcLjHf0ymtD5zqXDvnOAWoEgtjoep+gjVK6WC4xC2jk3WmEXbN711upZDcNabA6QHWLLnXwiVhGctkP9vcqCRdPOsg3UjuonQ4VIlfsmZJvwIuSUvpUrj+g/fX5NKD5C7SL4HqzF2sWY5cDJf6Sygkd282tYfqhmLWLPt6wqXh9xSSuzf/S4bqIdYwO7rCpclyCsndm5lmqKazhvmrLeDLISzJXUyESvkva5i1DeHSbhOF5K77y2T8SoZE4a51f6QzFJYmwuWMPRSSuxeFA6Fqso0Byd/09SdLd+TQ3YmvR56e0nDAKobA5zFwOS+NQnL3Iv1yqE7fxwBkfXpDq4To+Bb9J6/KYpld0/pGwabt9wy+t81wuTSDQnL3IrUPVN2P0H8bB8dClXLhhE9/3JqRl73j67HtAaBhlwZA28V0Z2XAXlDgcn02heTuxT/nQHVJBv2V9mJTIO6ysY/de20LADAktuh8zlktogGYuj+zNXtpW6DFrAw6pc2fOGb4yCdXMyCWR6ExooBCcvdi65lQDcihn5ZdAuCCeVkkCze+dk19lEm84aNDJPlVU8B8+VsbDxaQ2X+92jceNvXv3ccAFP4HGmMtFJK7FxvbQXVzMf1yYsppQKOpR6jK2/zp2CvPP/uss7pd9uSqHDp8dwYAQ8Nzrx16y0VNUKbT11b6LWcgNJ6gkNy92dACqv/QL8v6A8Yb11DLWlxYUFBQWEKXP0YlwaXeoAcGRQNA7CMZ9Fd6P7gor1BI7t5sOC2gPQRHJyYDbWbm0av8pQ92STQBQFSbB1bks3h2fdgM3kc/7e8MF9MHFJK7N5tSoJpEn2V/2BtIvH0L9Tmxad7LT0+a9u0h2n3TADbnr6d/1jeGS8J3FJK7N9vqQfUCfXVylBHGy78ppp8+T4FNp5/ol2/j4dJoDYXk7s3mZKim0lfrEoBJGfTfG2bYNPuG/nhbgUvHzRSSuzcb60P1qJU++i0JeJkBsEyAXdN5VvpuAjR67qOQ3L35oy1UtxXSRxtPAy7MZABy74Ddad/SZ6W3QOPqNArJ3Zt9PaC6voA+2nMWYP6CgcgYDruWvvee0Rcao/MoJHdvci+Aqn8ufZQzCMDAwsB6HwK7tpvoo7/bQmOChUJy96o/VH2O0Ff3A2iwmgFJvQ52Vx2nb36qC403KCR3726Gqs02+uptE4DHShmQg1fA7nn6Zq4CF/PXFJK7D+sb8b/QV7/UBdD5EAOz9TzYdD1In0yFRoPfKCR372ZCZfoffXWgIwDDFwzQr45dwwvoi6I7odHpAIXk7t38aDgYnqOv8gcCwFALA/RhPAC8WHSghLplXguNS3MoJHfv1reCagR99igAtN3OAFmeB4DJX/W5der3+dRnX3dojLBSSO7eHQvkONOn8QCMsxiovFsBvDwAwEV7qc+GptCYSB0kd1E4CKomf9JXG5sDwJASBiq1H+pNSwEwNIv6zIuGi+FN6iG5iyegMiykr470A4B22xiw39oPeQoAnqROk6CR+D/qIbmLj01QPUpfWcYCgHEOA7d26aUAzHOpT9710GjxB/WQ3MX6RlD1L6KvZpgA4LYCBm7daQAaLKM+f58OjfMOUw/JXaT3DOC76up6ANB2DwM33QzgrB3U55s4aNxSQD0kd1E6Dio/djemtgeA6C8ZsLzBAHBjOvV5HlrPUh/JXXyiQPUYfZX/L9jcz4DtbAMAEwupS84t0Ij5kvpI7mJLB6j6ZdFXk2HTJ42B+i4GgHmOlbps7wKNlhupj+Quiq4uy2YDffVZPAAk/8xAvQgAsd9Rn2/qQOPio9RJchdToFLm0Feb2wGA4QUGqOBaADhtsz+r7riniDpJ7uLHOKhuyaePMi+FzcBAg9vWGAA6H6UumVdA6y3qJbmLfV2garKTPrKOh027rQzMwigA6F9AXX5tBo3ktdRLchfWW+E0i776wASbLxmYVxRf5lTOMECj1wnqJrmLuWaobi6gjzY2gc1DVgaiYLQvk8wKhkNrjIW6Se5iRxuoWu+gj052g02vkwzE/u4AEPcFddnSBRrmt6mf5C5KxkBleos+stwBm8a/MhAr6gJAqw3U5b0YyHhIyd1v/42D6vo8+uhN2CizGYh3YNPzCPUouR1afY/QB5K7ONEVqobr6aOlSbC5zcIAjIfNoCLqsaMLtMaV0BeSu3gATlPpo4M9YHPuMfovfzBs7qYuH0ZDwziPQnL3ycJYqLodp28sQwBdO9W9/15PoR5FI6HVejeF5O6To92giplPH70Ku1fov68TAMA4m3ps6QStmy0UkrtvJrnyKaJvfkiAza0F9NtLsEn4hnq8HwUN05sUkruPfk2CKmUdfbO3C2zapNJvd8LmtLXUoWg0tBr/TiG5+yj/RjhNoG8Kr4dNwgr6q2AAbNrupA7bukKrfwb9J7nL0nvX/X4d8VBeor+Od4dN7zTq8HEMNJSnrRSSu6/SesHp/3wsaLEjwOFF9NPWprAZUeT7N6Y631NI7r57Ef7e47GtHWy67A5sYcbwPHXY2Qla5xyikNx9t6MdVHW+pU8KBsEm+Xv6aYoCAAlfUod3jdC6x0IhufvOOgZONxbSJ+PtuRqepX/yh8Cm2W/0Lv8maJnmUUju/vjeDFXdNfTJguiAhhsdOV//w9DaRtDquJdCcvdHzpVwustKX2xvCJtOe+iXra1hc1EavbI+Cze3Wigkd7+8FQ1V4zX0RfqlsDGvoF9W1oPNjbn06tDF0Ip7n0Jy909qNz/fAK13we41+mWeGTZ3ltCrbxKh1XE7heTupzdMUDX/g754Kwo2N1sDuQ3tSXpluRtu7iygkNz9tK8rnO4vpQ/WNIRNj4P0x0TYvenrmGuY51FI7n57Hk6NfqcPDnaHTd2f6If8EbCJ+opevQ03XQ9RSO5+S+0Epwet1K/4P7AxzKAf9veDTf1V9Obk1XDzOIXkHoApcGqxlT6YZoDNsBL67te2sGm/jd78lACtuj9TSO4B2NIKTg9Yqd/KurC5II2+m58Imz6H6UXRQ3BzeRaF5B6A0glwavoX9UttAZvGv9F36gS8wV7j3dQRWoYXrRSSeyB2tILTQ9Qv71rYzaPvHobduGJ6Md0ErUbrKCT3wDyuQNVkA3WzToTd0/RZ6c2wMb9FL473g5sbMykk98BsaQune4qp22wzbK610FdZjooTv6MX8+Lg5h0rheQeoKkKVI1/oW7rWsDmrAP01f7OsGm6iVUrugZu2uygkNwDtbcznO62UK9jPWCTuJS++qs1bLoeZNW+i4ObsRYKyT1gz8Ip+RfqVTgKdu/QV8sbwuaiE6xS3hC4SVpGIbkHbl87OA0tpl7TYHdHMX20oA5sBueySssbw8312QwCyV28oECV/BP1WpTg57UGs6Jgc1sRq1L6oAFa5ncoJPcgP70PKaBOe5rDpuUmP5+dHrOyKn93hptuuxkUkrt4UYEq/gvqlH0BbKLmU+Xj0ZBprNJLJrh5msEhuYvU7nDqd4L6WB6G3cv0TcYA2H3Aqhw+D25a/s4gkdzFXBNUxlnU6W0f325VW8+CTdRSVuU1A9zcaWGQSO4i8xI4nX+Y+nyfApvzTtAnPzWBTf3fWYX9Z8FN0ncMGsldfBULp+eoT2oX2LT4jT75NBY27f5hFabC3TVZDBrJXRQMgVOrTdSl8ArYGD+mT6YrsOlxlJXb0hFuYucyiCR3saYOnMZRF+t42L1InzwGuyuyWamSyXDX8wiDSHIXltFwaryJusyG3ZBC+sA6EnbDilipPzvATfQMBpXkLtY0htNIfQEvTYZNl3T6IP8q2D1sZWVKxxngpncqg0pyF9YJcKq7iHrsPhM2Tf+gD9K7wUZ5mZVa3xoh3j8guYsDXeHU/yR1yLoUNlGf0ge7W8Am/jNWpuQuuOubxmCT3MX/maCKmksdisf5ce/2umTYNFvJyvzUCG6M7zPoJHeReQGczkmlDu/A7t951G9xPGzO2sZKpN8IdxemMfgkd7EgFk4TS+ndD/Vg0y2V+n0cBZv+h1mJ9+LhJuY9hoDkLoqHwanRWnqXeiZsWq7zfcjMiCxW7J/ecHfZEYaC5C5+S4HTkBJ6VXwRbMwf+n45/fgiVsjyBNzFzGVISO6i5CE4xX1Jr6wPwO556ma9G3YvlbJCy5vCXf9jFD4DhW+XmPZMpVdvwe526lZ0E2wM77JCJ6+Fu/gPGCqSu3g3Gk6T6NXXMbDplUe9stVbnf7HCr1mhrvrMhkqkrvI/xecmq6lN5vPgE373dTrcHfY1FnLivzZEu7qLmToSO7il4ZwuimXXmT21r3pQLXtDNg0384K5AyEhzFFDCHJXTwGlY5T10VDYTeTeq1pUcUIselmuOuwmaEkuYv9Z8Pp/KP04gXYPWqhTl/Xh80FJ1jeymZwF/UqQ0tyF5+Y4PQEvfjUCJv+WdTpnTjY3JDDcv65GB4GpDG0JHdRPAROTTayamsawaZDKnV6xgib0cX0lHMHPDRdylCT3MW6RnC6pYBVSu0Imwa/Up/ie2H3YCk9vRQDd8rkEoac5C6eUKCK+y+rlNMfNqaPqc/JQbB7hp4W1oeHaw4z9CR3kdoXTudV3ZxlPOxeYpWyDh7at/LD9//kob6we5se/uoED81WMhwkd7E4EU7jrazKW/B8Fi/KzSu2FmWlpaYe3vrz0qUL35pw13+uP6tRSnKsocuGPZ1hY/qK7vZcCA+G1xgWkruwPgyn5GWsykL1jtRM8thfi2c888zjdw4ddP3g6/tf0K1z5w6NYuDmtjVtYVN3Od0cGQhPg/IYHpK7OHIunK5IZxW2t4NNl9STb/RvkohyTFFxdVv3GjBw1KT3Pr0UTR9vDpumG6l14jZ46riV4SK5i//GQmWczipk94BNs2nXGwC0P+e8vr3O633pNTcOGTx45CMvvz7j/cUbN28+YKHN/2KUNvVgc/pOamTdbYSHOh8zbCR3UTgcTm13sXKWobCJTknomNBi8rb9abnZaalH0ovIooISusu5DgYjbM5LpUvuo1HwoIwvZPhI7mJbWzjdWcrKTYFDhw5XbaQXq5rC4bIMlimaGAVP16YxnCR3MSsWqjqLWbl3DbCLu0NHom8lwm5ALp1yJ8TAU5eNDCvJXeQPh1OfE16vjYyaVEDvcvrB7tyjtLPmrB1ohKd63zDMJHex8ww4TShlZf45EwCazKcemRfDLvq/JHP3LJx0SQLKiXuTYSe5i89joUpZxsqc6Aeg3SrqsqcLHK7+e/Fz/zo93oDyYp4uZNhJ7sJ6D5wuTGdlHgLabqA+21vDxqCYmsQZUCHD+AIKyT0CNNffPZmenlXKCuSMREt9tecf3T6nHrww35tFIblHxI9JUNUddMOND763Zv/JwlJqlK4bYWi5hlUpyfzn168/enPSkJ5tG0ShagbTvZkUknuETDNAK6FJh3P7XD5w5LhJz736+pxPFyxd0AVdluSWWOmp5PjahfPeffbeof1PPy0xxqhAl4Qp2RSSe6Tkj0IlFIPRFB2fFJ9y3nW3j5/62pvvzJ4z543pr097/M6hA3q1a1I/McpoUKCfYlQMxhtyKCT3yDncF05RqIICKAiEIdZojrkqj0Jyj6DNvZPNgKHxxfc8fE40QkeJNZujOh+mkNwjaeedBuC0+XuyCw/OvLyhWUGIGE1mU9NdFJJ7JB24RgHaHqNNxs8zx3RPMikIIkVx9h5lTPmDQnKPpI3tAHRMp5V2RYd+nHFn3yYxioLAKYbo+t2uNMNOMRsT11JI7pH0UwqA07OoUXh0/fwXhp6dYoICfynG+Kbn3vTUvA3HVjUoyz12GYXkHknfxwNok0N31uLsPasXTBvVq2mcCT5RDOaE5j2HTHx36e97M4tJbu0MB5MxagmF5B5J38YCaJLDClgt+ambVn418+F/9WzXqG5clNloUP4/lKPAYDBFxyU3Pf2S4U+8PX/5X4fySum0qz8cjEbzNxSSeyQtiQGQdIBelKT+tmThgi8+nfv+7JkvTbrr31dd1LfPBf36XzP436Pvf/rltz/4/MtFS39ev+N4ET3tGQEHg9E8n0Jyj6QVdQDEzGPI7L/XlfunFJJ7JG1pBUC5toChcnAcHBSjeRaF5B5J6QMAIHZBKUPk0IPO3A1Rr1FI7pFU8pYJAJp8V8zQ2H+XUpb7ixSSe0Qd6AKbuuP+tjAUDgyHyhA9tZRCco8k60exsFHO3hmS3vcPcuU+2UIhuUdU7v1m2BhHZzIE9vWHyhD1RAmF5B5ZJ4YpsGm+myGw5wLXr/vjxRSSe2RZPjbDpv4uhsDubnBQjFETiigk98jKGAa7NkcYAjs7luUePaGQQnKPrPVNYHdVPkNgW0tn7qaox4soJPeIKpljgo3hCYbClnrO3KOinyqhkNwjKn0M7MyfMBT+iivLPeq5UgrJPaL+OQ928csZAqW/msrWIaPfpJDcI2t9Y9glr2cIFH1rKMs95nMKyT2yfk6AXb0NDIHcWYoz9+g6iykk98haFgO7xBUMgcznnbkr0U3XUUjukbU8Fnamjy0MvpNlucNw7n4KyT2y1iTB4ZZ0Bl/+XDOczk6nkNwja1s72CmJ/yti0JVsbAenultKKST3iDo2RFF777nDwmCzZk00QWV4oYhCco+ogvejnDnen1Ya/N53XQSnnpkUkntEWf85H6ro6ekMuqJvjFAlbqaQ3CMr/9NYqOrOzbEyyKy7k6EyfGClkNwjynp8GJza/FnEYDvRBU73llBI7pFV+ldrON2XxmDLuR5O/bIpJPcIy3svHqpmvzPYiu+CU+sMCsk90o5NMsMh+isGm+URBaqkNArJPdJK918KB+O7DLaSsXCKTqWQ3CMu8244KHMYbEVD4GTcSSG5R9yhy+Bg+ozBlt8XToYNFJJ7xG1rBYfohQy2zLZwUlZRSO4R93sCHOJXMNh2JsJJWW6lkNwjba0ZDnXWMdgWGuFkWC25S+6R94sBDskbGWSWUShj2sjqQ3KX3Ov/wSDb1xRlYndRSO4Rt9KZe72g5z7XhDKNj7P6kNwl98TfGFwnL4dL71wKyT3i1hjhELXUyqD6PgZllHuLKCT3iPs9ylnklAIGU87VcDF+YqWQ3CNuRz2oOmy3MIg+i4NLgx0UknvkHekNlWHksRIGTWpfaAzKo5DcIy/vSQNUxtt2FzNISt4ww8U0x0ohuUeeZU1dOCkXbMwNUpc720Gj5d+sDiR3kXkzXFKeOVDMIMgfBQ3lgWJWB5K7sKypDxel++LsUgbs43ho1NvE6kFyF1kvmqGR8srxQHsv2XQWNJRheaweJHdhOXqzARrRD52wBJD64e+mDGoErZQfWF1I7qJk1wAFGlET00vpl4Lfp1/b0KzAjXJ7LqsNyV0U7RtugkbcB9n0mfX46indEw0KPDXbxGpEchclaS/UUeDSYYuFPsnb8f6/20QrqIDp1VJWJ5K7KMlc1FUTqzL2uJU6Fadvmj3yzAQFlei/n9WL5C6sBTvGJqCMecSSQ0Xeiy9K/WHqdW1jFVSu+U8WVjeSu7BkftUILtFnP7p4d26lqRZmHFwxbUiXeiZFQVUS3ypm9SO5C2v+uubQUKJaDXlj+fb9R45n5+YVFBWVlJK05GUdP7Dukwcva1fXqMCrmCmFrJYkd1G8qgXcKab45udePXLsoxMefeS+0Tdd1a9bh0Z1o9XQvYurvrVL7qL4l7NREUWx/fks5XULqy3JXRRtGmxEkJh6L7OyGpPchTX19aTgxH7G9GMUknv1Zs2dEYWAGS76aG++lUJyr+5SbzHAL67ne/MjBawJJHdRevQ2I3xniG3fUs3d8K8jrCEkd3H430b4QjHEnTFs5pKbFDicvZU1huQuDgwy6n5+iWp84dgPt+RZD440wqHpj6w5JHdh3XJlrAIbY4Mks1Jx54opofUV4+ZuOF5CkpmTTXBImFXCGkRyF4U/3xALO0OvN+dOGtK7Q5OUhNgos8lsjoqJS2rcrvdNT3++Zm+OhaqiL+vCIWpyPmsWyV3sfFTtXen4xcn8nIy048ePHTty9MiRtKPHMzJPFtJN0dq2cDAOzWBNI7mLI3cZ1d6TJ6eyatadVyuwU/rvZI0juYvS7QMMcEgYf8DCqmQ8YYRD502sgSR3Ufh7VzgosQ/uL2XlihclwqHFt6yRJHdRvKIRVDH3Hayi952d4JD0WQlrJsldZL4aC1XM2EOshPXg1XBImFFja5fchXX/KCNUxm4/ZlhYkROjFdhFP5fLGktyF5Yt3RSolJT+t97/xMtvfzR/4eJlK9es+6eAJI9+fU9LOEQ9WaNrl9xF8U8pcKdAMZqi4+vWa9CoYePGDRNNUJkfreG1S+4i61kzdDE+mMeaTXIXpfv+ZYAO5kdqfu2Suyje1EOBV8nvFrHmk9xF0S8t4WA0m4yKggp0+KGYQnI/FeQubIAqGfqsKqSQ3E8J1qyZdVCFmJG7Sikk91PF8VmnKaiQYojv9dERCsn91GHN+vb600wK3NhOM7W7esKioxYKyf2UUnxk9dyX7rn63A7NG9avl5zUoHGHnv966PVvDxVRSO6nsNKM339YsnTt4WIKyV0IyV0IyV0IyV0IyV3YSO5CSO5CSO5CSO5CSO5CSO5CSO5CSO5CSO5CSO5CSO5CgDWUWP9Iz/qIanbZMzsoJPdT28a+cFIGbKWobrkfX/Ts7QMuu2LUq7+WMjDC+pIJGtGvUFSn3DPfusQIp0bjDzAAwno3PNxtpaguuWc+mgg3sU8W02/iMZTzGEU1yX1RE5Rz/lH6ScyD6swBCpzmUlSH3AvvQEU6ptEvIrUe7JQnrXwKTnF/U0Q+92N9UbHeFvpBWPvD4X6SBY3g1MtCEencD7WHS5dnFy15Kh6qqfSD+AQOZxaR5DiUeZMiwrkf6YgyyR9bSfKXKDjEpdJnIq85HBbR5ieUSTlJEdHc87qjTNOtdHgIqrHUJ3XGTT3atOly998UZU/r59CuMBZlJlJENPehKJO4iarDMXBIyKYOhQ9FwSH6c9Z6aQlweJcOl6FM3UyKCOY+Cy7vssxwnxbPrkeZGPl9fwwOyfl0eB4uL1NELvc9iShzCV0WQXUDvdsMjRGs5XKS4HAXVT/CpVUpRcRyvwRlDH/QJd8MhzoWevU3NOpYWLvNgGoVVRnQWEIRqdy/gMsganWDajO9i4PGdtZq1tPh0MxKp9ZwuYUiQrnnt4DL79S6E6qP6R20vmetthKq+1hmEFwSCigik/urcOlNN29A9RS9yoHWl6zVRkO1lGWegcZCiojknt8ILp/SzWKobqNXxyX3MoWJcEgoZJl50BhFEZHcZ8AlpZBu/vZhaWY/tBaxNvsGqmvosgkaDUopIpB7aTu43Et3J6C6kl5tgdbPrM1GQDWNLgUGaPxBEYHcv4PGGrqzGuHQl15tgNavrMWKkqDaSI2W0HiJIgK5D4RLEys91IXDFfRqFbQ2sRZbClVyKTUuh8ZVFOHPPTMaLmPoqQEcBtKrRdDaw1rsgYqbvgcaCRaKsOc+q+r3y7pwGE2v5kNrP2uxTlBNptZL0PqLIuy594NLbH6luU+iVx9L7qr9cFpGrc+gNYci3LkfMMBlAD0V+3AA503JXTUHKkM2tVZD63aKcOf+MqrclnrEhz0Br0DrAGuvYVCdTjcHoNWNIty5XwCNdfS0FqpUejUVWidZe7WCajjdlBihEVtKEd7cT5rhklhCT3PhUE//eQbJ/RCcXqO75tDaRRHe3BdA4wqWc58Pi8T3Se4O/4XTSro7H1rfUIQ39zHQmMJyzoXDq/TuP5K7w/1wSqe7gdB6jiK8ubeAxmJ6Ombw4XTHLZK7x/tQU3oYI0szkcx9O7SO0dNsOLSjDjdAq4C1VWlipfvqnoJWP4qw5j4bGi0qL3gqdbgGWqy1dsDpEXqYCa3mFGHN/VZoDKSn7DjYJR73eU0T8qYKfEgPX0JLKaQIZ+5tq35TfR8Ok6lHL8nd7rHKt7SvhpsdFGHM/bCX43aXwK5zIfXoAg2FtdZ1UBkL6WEX3PxAEcbc50FrOz1YO8Om4S7q0gEadVlrtYOqIz2dQOQ2iUnuj0AjuoSeMiacriSOOOzLoqbknm+A6jp6shqg9SRFGHO/EBpdWJFC6pYCjaasrTbC6RGW0wBaoynCl7slARr/ZoDqQKMFa6tP4fQOy+kIrSsowpf7n9CayABBqz1rq8lwWuFt9aorRfhyfxda7zEwOdDqwtpqKJwOsZzroNWAIny5j4XWCgbmqJxdsDsPqgSWNxJuiijClnufoB4/+gdafVlbJUF1ttdN0jhMEa7cSxOgEV3KwPwlb2HuS+tDWN4kuPmDIly574BWBwZoFbQGsJbaUOW7/8vyWTVSuc+D1sVBGb4n4/q/gNMsljcLbj6jCFfuT0NrGAM0H1ojWUu9WOWFDp/DzUyKcOV+I7TGM0AfQOsu1lJ3welvr/8CMZUiXLl3gtZrDNAb0HqEtdSAKnez/wI34ynClHuRCVrzGaDnoPU0a6mzoWrECmyCmzEUYcp9K9ysCcqpBrkntz5UPVmB3XBzE0WYcv8KwZ3xcxe03mTtVFB1yofhpj9FmHJ/AW6yGKBh0PqEtdM/VT+Xn4Sb8yjClPtt0IphoK6D1lesnVbD6Q1WwAo3HSjClPsF0GrJQF0stwi7zRpYwIrEQKsZRZhybwatHgxUN2j9wtrpLTj9xookQ444RiL3IgO0rmKgOshNZG6fqg95P9ALI0V4ct8BNyMYqEY+30RWcHh3aiHDK3P37kyG0J1QGUtYkZZwU0gRltyXwM0DDFQ8tI6xajkf3twSAAxtRnxdzPD4Y2KvOgBQ58Ipexkig6Bqwgp1gQyOjUTu78DNMwyQBW5yWZXMCXXh0uoLhsGynnAx3HqMIdEHqh66cj9KEZbcJ8HN2wxQBtywKosaw93IYoZY5jC4a/gLQ6E9VDfomSyI/RRhyX0U3MxjgPZDqw6rMFWBpxssDKl/ToenuF8ZAnW8bAntK1MiI5J7f7j5kQHaBK3GrNwEVOBphtKuZiiv4XEGXSGcJrNCl0PfAlbWn8t+SWfA9q39YUsxKbl3gpsNDNBqaLVjpabDydj5dANU5i0MnbR2cKrfLQlOwxh0R+A0S88QfGxkhf64wghAOf9TKwNgmdkCABJH7pDck4O8Q2wxtM5iZX40QnXJXvKvhlBdx5CxXApV3LulLLoXKmUjg20bnL7WlfsqVmR5NFTDA+l9OFQJS2t77oVwl8YAfaxv7saRsr7PzyPJGVApOxmI1PceGHrbi3+xIk9CZVxCksVNymJisP0Cp3W6cv+ZFSg5HWW+pN++R5mmJbU89wNwVxTcw0xXshLXQhV/gDbpBqgeZwAWxVR+Gm6dEar7PcZJRecwyBbCaZ+u3Bd56RQ302+D4PIzg8O6d+2i+Ss2F9W03NfDTRwD9Sy0BnudfvCY5ztEJ1asdPuCWZ/t1blhp46FnkrOgirhhOdtMvMYZB94+146WEfuD8Pl3ABvRFPNZuBK1zzRPwl25i5DZ26vSbl/BzeNGahxevYknGwClekQHW6o+nkq+6EkAFCuOsAqWKKgSq9iNMDd5UZS38sgew2qJF23ceJzVuBquLSmv/ZB4/+xd+7xNpdZ/F97n8s5jsPJhUI4CCNOY6RM0qU0/Qq5dElF1CiXDBGhlEwTSiZTNEYNokEuaU4kF5LQxeUkXdwvJ4xcOIdzHOey916/1w/7u/azv+tZz7MP83v5zsz7/zGyP9/nWc9an7XWWLxQjo2sBSp1B232jNzfA4VfXUT7vJB1HgBhHsDz9OLWuhJ3w3mqrpd/Wl2XysEUCPOja5plCxQ4vvuXIApkz35jxOxczSbJBlIwR8w0VV6vQI5TXy2e+8mXe82pMjktum/lR/NWZJ1CM3nDywLD9TMD3pD7eFD4LcaOdEsPRY49ieotrt7cfxZbP+EywXX2mb6a+wd361Au/ZmoIzCqGgCktBihEUP2iHT4f5T7Cz8DsiXy3G2xrqa2XK9b/0xDH5ylSttpeWKqTPg9zky/Lw3O4m/c50uUWVsHNDSY7wm5j4CLPNKxNei2+BG/hzAVitwd3QMNVchWIdRAw7nKup7kSernpModclDDA85BEOBaTnvEQ5hVGEE3OE8HtKqq/tVoEnYlKVtCJKnDdIfzIum2LRhVGSLJWIgCUxNAT7tfPCD3/he7Jb4ZEJqTOjuRGTJGcn+UXw5ATEMdQ52QhzfkqrmSXHO5YZWY1Ph7eXBorNRm25v20LQA83SfWnqv3YG2EM2VqyW582+pD6tBNA+cRB1TfBCBv1nHdo0ggivWXfpyfxQUnsQLpS5EMsmQcZjNyL2DyZZ/+Wn5LGbKW0fLAGV+GLlvMTuK3nLF9OH42wcAKWp+/RbTWKkMUHhFkDvzgP+gArhJmGCW+/1KIN4VGH6lq72ujgMivv/ZId17+8WDQ/KiS17u7UBhIF4oFY1PsNNUvvfTkTgEwrRFjlv1dwbRVNeUNQoc+sci91r6ToDvwruXay7dteCLHFT4tWnOTn1Q6GuUezY6BAYDzx+Ncm+LxK4mwFKV93Hk1gAizQndvr4SHFI2XOpybwkKL+CF4odIMtHNDNZj0Ic9gYi5QFQrQh5nUn0PVAjVAaZV+ohR7keBuBcVFqeGLyMu7k83rf6pbTF542pe7kUPgUPFOx5oWQYcxqCbzzVy30xtZ75GHdo3BIcqO/hAkYhfiQ6HIiR0TfASl3sjUBiDF0gOKCyXz+leXNjQBTlKrjBPrzkAYV7ShuBwiN4QRr/5eiBuVL++xPNKGR4SV3cssAtmfJw1L4OVe3EH+istCSDiCXp/+T6S5u0rct/s/BWTn9l79phuDGEa5aKLokpA9FNyO/eAw6eXuNyrXeTJy3uNI/gO+cFhCjp0AirxszzDS48/yP6mfaimo8MmcDgudDZy5s7MBDiLfxKyOI+6lchzO6hU/8Ig95/CF5Wz4ixxYii6qAVpe2S53+xYoZ3Nrk3CZYjc5lLG4lP9YvWSrhQpXuJyTwaFaRfcB2r0cU8A4jsuVTHW4k/eaWhEXKImzy9nYxL6BZOEJB6X+V6ZJCQQlVfBBnQoOLhtw/IF0yeOGdqna4eqEIWv7ScBSe5bop/0KUvQ4UEavyfLvZXLCn1jLlWbygmOtJHCbujgk3Ceey5tuRfARV4jsQoUmILfLeCQUIwO9SDMLOS5xpTJwEGaz2EF/zqZBmEa2uSsg5QmCnfYjjZWd7cjhnbMGdG1Zc0UMFFrlSx3ZTmxPxOJg2WZOE+Qe+A252zPRWIMXTb5SFAlQVeEDvWlw+RSlvtRkK1KMfORyU982M8uXQ0mGfdyjQCisZxmilM7d54CYhbnZmtvI/cTTgYyfDT2Nq9jyxx9Z3kQ0cvoBrfcf0rl276o47husXQr3hjVSFZeORfOUJZltOR6uB2jCQ2iCYGXsNz3wUXu3ZsKCqdFk87DnBE5rsBmx9kuZGhIAbrCVUBs5l7Hw2W5q4/FUPiral6EGlZDqaghVF7Xnn0vOgnOlgFdXWGyrpuSDphVfk3w+jqlfHI5x7JgMXo9AQCaFV/act8CcldNzLxhGkTwEBAjlFemyaVWlALEm+im2Klxt1YtOkD4C9DhZggzB3k+gQi2RVkry++S7e6xcyMvd/plhjvZlG3aetjVIZPcTzlp0jaokpOsrao9DERNZNg55O6eOZd43v1LUNl84R4cefZhqCoQ/0CHdyHM46jjdoO55wfNNoxJQNRlp2P+LF8oSvScFf6oZsg+09hJXM7KncLMLc73/KLwZlolyL2W4kdNduVxHtR+NQOA8OehzKUq92UgZlJkCrcfN3hwqnOSJL7m/jWnoI4hQJQplCpRY7W71tpxE3FqoyR3dbZpYfgBeQfqCIxNhdhJ7fKjZCObhRhq5RyvriAxWJ31HJHcyfqZFacvKi6Iip6INyGCzz0q949AZR/aM7sKQN2RzAOeqO92VWlmZ1HtaYfdAtjPpTGkC7VTK5/iDsSuVnJfo1xfSTtQdu7ERtvMfLnBbyLiFClf3B3ClCvUD/7xl2DwesctcAqjyU3QlT9WQAQjPCr3f0Cpp1ll+riJ1u0Ngwh6AJEYYgYi1LMsYb2ELh7kpxTthAhGc1b/9+zlviOJwgl5cYdCfMM7Hn321Tcnz/14+fqNGzdu270YVP5k8jO9iCcqORWvEnQxCxyWCt3I/8K/QZjX+Gn//A+RFwdEY4/K/a+gsh9tyS7Lji+/2TCI4Nd8Q9oeq7pceSB+hy4cy1NCiXZl7wzmPPQfRg3fAEQVyO/Un4z0ealc0XXqpjN8jxExwNTg1wMHiz7T/eAwTNiLszHvciewyUU3z4NDthBarfem3F8D8yRa8cZOK3ZLTpgWnx8HxE3c2bQc9fwWiAohfWLman337GdMevJmu8TVosjWoPHSP6ofHNKHfyffG4JRqAtEcEd2svP9FCBDTc0hcxIi+XAk91UQi7TGpHHq7n9Pyv2l0so9y0epLP0ukPsFz5WSdu/rxJMB23mW2/QbMzvp59NRmHNYNdgIcqefvyRsUqx5BgVWOUXOd0JimET8zrTDsE53KXJWetuT1CMIIhnkGAXiDiDDIa0p+Zd4IPybPSn3YSDMp5bopllvnioPIpiu2ajdlHsgyXfR+/qX7HMYSQ2+7rXAUcdxO7lPi3hov2W50iFLfhXIgzWeUqJ/vyO1vcgxUpdf8ynJTnocmzyDraROoLs9KfcBoIKWZMfzjr8SkAcRDOM7+3LiyDQmMAdUE6rKcP4aPqmZSDxQOwuH2AYRjMczNcNhb56l8e4AatgMKjWEs0i6CIh5ujAkDVRka3JrbdFke5wa2nlQ7n0s5C7138XliR6cYeIWymnuPXW3osRXYkdEO/502wh8lamJhXEiW80FvQ3nGWy7Q/iMbTk7yTgi2WSh+16XJ7wMOKoUI8FfKYekjblXnvKg3H8v/KML5IYjwKaosgPkQQRN+FanPjRAVOIgRJBcons2JBRrr4RrKUj1hTtwQpYOuv4lYdemf5/l/N9yUpikwqhnDHCUyTOaW7sJW8+o8MzzZ3D4ClWyU9Sb23tyfwQU0mLNX/aTnqIUrvAnzTpXkqRBECWCiRDBj6hwTDGGEK/xgcD7cmcUk8Tr9gFQQVVkK1dmk715sNO4z9zksa0KfKqpNnAsRZ75ght8NETgW+M9ud9fOrk31wWAy+TVN6chkq2ue3g6ytQWBs2thDCd9Q++zq7xT42kLywEEdzzG3oly3xBni/hAlD5WjhUFGYZfxRooLPNE5WKUe5X5JKthUpDecMznpN7W5PcZTu3/xh3NhAzxa2Wh6PToY0CKKM4wIfrbuFXtP+JlFzLTxHMkEQcEClOiJKPMvOEk5hCD5WPtauIVeJz0TiYrLKuLYboalG6ftEwUfQ5z8n9zlLJvT+FDVFMAYVMFIwXUBzdcr8wpsuovS5Plqn/tV+MtpPdEEKJNAupCP2JvVFLIhjH5s0EFSU9KLlmfHw5VDqIuAv4KTa5TyR86zW5tyqN3AsraZOB4+VukffYpOBG61zuANAPxc3QVL+rqslE9cyPM/xilwPDXGsX9EjUUhVURgo2GGZWhNy7nsfbYAj/cdRRRhrntq+s8vAv+W+Q+xw6R4XZdtzb/hVWro/BWcrtRRNjIQLfKeVUiuev8hI/EI4ZbJffrnO+PhD2yw+eYN8u8p/cSyjoy8uzmEROrhCwUhaXJ110Cqjn2ViPyb2FUe6SUy/hFHPCSPb53lxSMDtRkaLETP1Uj7WaZvx/AUHhUk84S+MCq/UIKm3QREeLvOp1oNJe6qUi0gI2dr9c9udSC9o6MkS5BxTFlNnpLblnlELuh+P13qonZPv8vUows1FJhj4U85yDSXzX4HNC+bJ78Jy9Jv7cr/UdGrgN3ExAE9fTYiYtHUCluWQ0INpYmblzhWSz6ZXUSpB7uKPK4baQl+V+ZUybKWAUbzknjorDhCpmRXhXmp1GMzv0FgXqgZ3vHrVE9AghYtE5PfqoeVAWpcoPaKKORftALzDuTVknhO7y1VfCFkMJ/wnUcrNhPu4LEMk7XpZ7LbSgmeB6vksuFTYDhcprEVeknPvQ9se+J7AVP21gt9qFAiqPFeLpjoJ0pOYs2qMhU8ZisdtIUPEXC5VXYrVVZ5poFDG0Z9xlqJsWKovH0w7+h8uduk2rBk1PX34aNpH4SKe4c2rfjjJcpiSNralWYAewEk1615U2i/A7P2Rnugo1wVZBPX+DKPbId5m5Kfp9TUw6EFx0Rz038o4nYo3y+O/wHy73oXRQmv68JGGEs0K6eiLLUTGRzU1zbC2UJqXuP/nmJiba7xDOQD2Z5nP7IDN83SrIrG/6b3gT9dDh/Qby9IVI5ntI7o1jlnuQGjg+4rNYwsu3ErC0PVY608MiLgP6vJXcU6bHurrKvm9tuY23ZjNE4X5I5AoVLvEmus3kNFsnLy801BfylFOrZp535F4rZrmvEPPPlWUTdxowVHs7hLY8o3u3tdFV4/8MHHftQCveh2iSi+yXqnZDPacgitF6xw7xKuq5SROrvA0uTqKWH7U2HmIhRDLkP1nu3Zj8NpGkxihmufubv1WA9rwJfMdksKJuLOU4cFHpsW/QkmV8gUZmjJUQqoBKb6nASd+yltNJmjhtGqjICbiJ7FwUKaGcsM0zcq8dq9zzU6V++GJQyBA32WSsXTBvXe6FzMXJYN7PV4m2wgmL5y7cGkJrNkE0T8bwvh2PYp85u/RQjv12oZYF4DCPL4ILBxXX2Ss8tPcrPZqdvPpUrR/D7R5/BF0cB4Wm4mXS2Pzme7Z9z5lK8JAFDkofxzsU3Ypyn4cGgjO63P/yD9w4C1bCclF1jn2rAX2n0ss+KSD9vzrsNXgR+qGWA36rdtRREMlar8i9KXMci9wptkxmG9x7dZQ3jrGeleB6d53UmBS6aS320yGSKShz6Hp19dAZiGZZDN0Aq2JJ+iQGdINziIaoZW+87h/2C4jmL6hluPSYIM6kK8unQ560iJnlftAvLnreIstd/bqSQijyKte1VJW3saZrh7pmxuJpOpgevaylHIiDp+TiwPZYBrhBtuxoUgMeKTv4hBSQyVaek5eBwyYUmKsmIz0i91tFuUv9ZImchTQLFO6WNxIdRIk5Pq7N7EZ2Bz3dKuUDovGkH0oUtHB9p41ApQwaKfYL/aeCCj83O3Z6oY5didohAVtBgY4EuRu8dggFQjcpgVixB7uZzHIP1ZeraWtAoa1sqVmHAjvKsc+zx9jTbob+C/sJImmHEr3dBbQ7QaVRDCsiyqFEng9UJsu/juyfbwcO1UuECJPayDh2JFuX4Tb4IYK3vCH3TrHJ/TNw+ETO2/ETXAZKHTUKRc1J0vo0+uWugQpjxFqNrNZ/Ok76DeqoBukLFpxdDVGkJmvKFb2Mb9tERmNN1Sp/AHkCN4NDmSMo011JbRZ5Qu7dBLmL2YTaQe2EQeIRuUg53GKQDcRvFdr/4BApR3djlGdyOSwHKjHZnZdAXm8thbWtUeR3oNJeslPLiaWt5QC0k06LgZAzjMPVyeAyexQn8HQvThFrjiL/SmQHNBOzDHKfL/++xBIfVV+kuU2fRnV8pxYb0hs/oo6g87BI+lmZR68wOoZ9PY+iSD9j2qU/RLEIQ8v/2PWWjhMKkKC1kZpfJgFc1ZXjf3+m/S09V0ddET5wKJsd21HZ0hNy/5Nwuku5s/gDyDHDIPctlkWtI1c40tuPKjUY9b0t5Yo7iWMriDHsCb4UVKagkUGSo1Ao7ieUGKfmfREOBzOOIHHsWiDqFxr7y5vg8erngraRSiyXKPvq5bf2Di/I/Z1Y5F5AjpiHrMbF/x6jKIqHSE4gT6idPni4DyJ5MOpJN9aU334GNax3fuzk/fyUSHqyyHS2fL+thCi2GceIrXHuqtso/t7dGAjfcnO1KgO/YCYnvRsPRJMiNNNQcfN4Qe4LQaGO5XHky7Lau9eHdZcSS4xdl2UPaYe60czH/DLSTtZZYHPp5lE8MNg9NJ7YEEMt40MUOWAcUvqWW+5Pu1oUMysJUznZZGoGFoZj/XLh4C6/J0SQ+iPaWcGJW7wg929j8MwU1TSWO8aY5N5FPzGV+ClFGGX+NSgcUYw0l4eQYEc5JeSb8gwVTkha2YtG6siOQqK8sLCGfTjAknBlw+k83NkZIukYkPrL6YxwxH3V2ago9IHSeJOQiTzF+p8i6QwSHtmaXRkFJgOYquPPm+Q+EZTiM3IUNpW81EWqTTBT2XLQ1Ww9XIwcs5UUspCqPY5GEml9pcz1oNLZOGhmUUQ+J+659WsntYlTH/9FojOYDrVtzv+u3txNi4fXg0gS5yFD3ht3V4O6g/ehQ1B5FHzjAblHFcnjUE9huvkZPoSRu9DUEM/6rp+WBxjdAZEMRCy8TM7kdzC7s/fQD9c0IE6dLkEThyO23Mk8CoaX0yKm+r85AXT4hgaEWiJxBbk2OWqskZr64nvl8D/FZC/I/TqQH4/EOPPhjn1Mcg9ebjRvZPpko+qr0bv9MulrZc/eCcbXeBGds751YrIpBY1kkaoMjDGlZlZxo+7+opWp7hn9ILjHq5xuBho6HDG0o1Tfz3byPusFuXeTkwPEiYpyZZGrQQ7WDdgS2n120EGbtM3Ca7IPHzbMT/zZZ9qU3Af0O7vXxzqIZ7FUxJDbVbegygYgaPLUq35gSH0uz/SrKL6fIy2Ao/GnyFPMvDGUL6+zF+Q+FhRWWBSk4r63XaA7zDQZK60Ao8hvbKq6hqqr/vPjyfw4eeJaw19qKjhUch1tZxJjHMQzRa6iSQtYZ0ivbJrotKalu2V7bI5YS2QisqLRlSGKxHuWhlAHFTwSN3F9Urd7Qe6rQWESatgUpz8AiTuNci+uKv7AgfbgcE2RzTCMa+iI8WXr+9EEp9/KRHCYY/hYasVQueuNBoIpAGJR4JCun/XLXvTNJ2U8PnmbeUIrE7Kefvf/JFKW4rZhH+ciIYVEDfOdBiqimRfkrh5eMBB5AhTqlT8oN6TJcsdnhc5PJaxI3Gz3hVYB0/KA3LJSbmZLGojVs6dilHs/3aYec4awtbj9QR2Ns++TKeMnTp6zemcAGeR2XcquFG6aM3ns5CkLvzmGJmYD0Z0plGV4Qe7YEmyKBaPsvJ6NzHLPVjMLn2l7wv6KGkL1gOct2djLT7bcWQMcGuQafma4Go3cJ/kN5NRMJYwiXva7x1o6F4pxZorSXV6K5d6T+8s2YyXWxFGuXDpNapjljj3U4z3ERx3ShNTXgSXuEGrITtIe74evAoeUb41rZVqgkZZyzVhcvnRAaGUnz0SsfABRrEIZcwNT4lJamEiniAfk/q1FK+YRknGZ7SiQZiH3n5N1Wyve8EXo6jRqySkHHLfbzr5rQH/2rgi1+z409/M+jkbqKnkWkUVgcOSkCytV7VksuhXs6QhE0sLoo7KLB+Tumqvfg7vGWinLxQSSZblzKw/KhlVx6nEgav+CKlLx1my5PlZJHYsavlI+rmo0Aapn2LwY5qEeRRN7gKCtUsJapeuwNKyFKKZiqTheD4iEkbk5DZQUmTfkrnqAL3MXOgP3KSGGBNjIvejXao3v7L2YP6k6ENV2osSJSuCmQoH9ff7I2XpUVke7Msm4sIJ9jwTRxOkYdtSGyhp6pVqBSj20R5gkPA5jhV71hD9O7STwgNypZyPM6y61dwWHjHyUKJTkTmwtDwrX9nn0JsUJU/V7u72uCoNQogcolLu39z3qi7d/CLXkfvrqgJ49h767C83sld2l8gqPiobyf0W0RG5WHY6l5Js00HGrBxyRTEdklROocLoDOFTZhyK5otyJzDiQqL0VDQRugGgSZUNW0e0g8gJeJDbEEnh0hyh2o8LDoOILYSnIAeICF15nVQce31dekfv3fvVCVVIvu68Fh7SNKHPC9hSZnwh6Wh5EI9tcx8wTKHPyVtCT9M5FrNvJJmnZ0P4RypsIjmEpCPnsEzwmDrYElkHoFbnjY6DQlt5YBeNSwSFlFRooApXXUceyVNDg61eEFvzTBwqph9BAQXvQUecimlfXq34gme8Mw+Ofl1bJ21PBPsFjpGQEd1TdG/CO3A9XBoWKQ1flI+Kp1YOrAFF2FRqpZt3YuTUDWNJXoB0vMQP6ZYIvxwOHr8+pi99BYHfeBWvLq5del4bL21NXXnsWI9+77kn/4AB6R+44D1yUvTIFFCp/FXssukF61o66DFykvVKAloTeSwGiUwgt2MgF8LduwItKE6fRzoKx8un+rrudqTQ0c7czXRBL1IaRZusRvSR3HAAm6m+30lOcYjAJypH+i3VAodbLMYWmuzqHT+vEfrZfybJ26lWc0GElXmRmy0O4VM6ozbsp2dKgEmqljpHWoFIBL5RNf7gifEJ1+TyEHpN74H6QaZODVkzwxVST2fCn+xuc1V/cVe1HZ4UwRg5N7dv2jnuHzj2G9uTM6HtT5XM/VIsn5+bixWdiOYCGH6Idu+sBkboQVVZIsb0990EUQbxgQpunvDj0tanf0R/lHblj0UMgkDzeWolLr3as4bYnUeHR3UcD+P+XnJ9/zsN/F6ezdqM1eS9UDB/t3fe4bktQkV2W5qIDFXy9AuC/heDzPtBx11a0J7h8yF3X3dBm8IJCtOJ/FK947emeQ8YtyWfOfiBEg7bMYIhix3+r3Ill6cByy1L0KN7nOETxGJaGVyCKb/4ndzwz3i34Sn3Xo2fxPiGfMDZVRPZcfPpfLHciuPLp3ySQd+uul9aWoJfxPpVBpdWFONWJmf+T+3mKt30+b+7c+St/+L/s3c+Lr2MYx/HLbzqnbJ2zkTjEUqNkyAZLk5rJjvxomB02o1lMGguGklIskKSMjcxSU2NnNQtkhQ2hsaCZiYn0nW4baq57eXvKVV6vv+G9eXquPvdB4z93U2S3tBG70XlN7gVxZ2TnprkA3pA7BT0Q2RVtxH50npJ7QTweneM24M/oPCz3gliLzg+TnETeL/eCeCU6X7QRFyKbl3tBvDvNZsbtkd0s94L4eJrNjIXIrpF7QexF56024tHILpd7QexH5+U2Yj06v8m9HmaXRrbWRrwRne/lXhDnI1tuI7aj85ncC+K2yJam+QT4RO4FsRDZPW3Ej9H5UO4FsRLZrW3E7JLI3pR7QTwf2XXTfAK8JPeCeDuyq9uQucielXtB7ERnNskh8bLcC+Kr6Pw8yW7WktwL4o+LJhlFfTWye+VeEecj25vkP9Oc3Cvirsh224gvI7tR7lT0WGTbbcTvF0dyTu5U9GJk77Uh10ZyVu5U9FFkr7ch90Umdyr6Zprcnwm5U9/JmUg225B3IjuSOxXd0b/eNOTzyA7lTkVPR/JcGzI7E8lPcqeiD6Y57ro7ku/kTkW/nu1f1Jxg4/2yY7lT0kaccuGgjTm+Pk5Zb3KnpJP1q+JvV64ctlHfzsc/bthqcqeqo53NJx9cfGh165f2b3z9/uoji0tPvPDprMkd5A5yB7mD3EHuIHeQO3IHuYPcQe4gd5A7yB3kDnIHuYPckTvIHeQOcge5g9xB7iB3kDvIHeSO3EHuIHeQO8gd5A5yB7mD3EHuIHeIBnIHuYPcQe4gd5A7yB3kDnIHuYPckTvIHeQOcge5g9xB7iB3kDvIHeSO3EHuIHeQO8gd5A5yB7mD3EHuIHfkDnIHuYPcQe4gd5A7yB3kDnIHuSN3kDvIHeQOcge5g9xB7iB3kDvIHeSO3EHuIHeQO8gd5A5yB7mD3EHuIHfkDnIHuYPcQe4gd5A7yB3kDnIHuSN3kDvIHeQOcge5g9xB7iB3kDvIHbmD3EHuIHeQO8gd5A5yB7mD3EHuyP3/7q926VgAAAAAYJC/9Sx2FUPoDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7ugOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO7qD7qA76A66g+6gO+gOuoPuoDu6g+6gO+gOuoPuoDus3UF30B10B91Bd9AddAfdQXfQHd1Bd9AddAfdQXfQHXQH3UF30B3dQXfQHXQH3UF30B10B91Bd9Ad3UF30B10B91Bd9AddAfdQXfQHd1Bd9AddAfdQXfQHXQH3UF30B10R3fQHXQH3UF30B10B91Bd9AddEd30B10B91Bd9AddAfdQXfQHXRHd9AddAfdQXfQHXQH3UF30B10R3fQHXQH3UF30B10B91Bd9AddEd30B10B91Bd9AddAfdQXfQHXQH3dEddAfdQXfQHXQH3UF30B10B93RHXQH3UF30B10B91Bd9AddAfd0R10B91Bd9AddAfdQXfQHXQH3dEddAfdQXfQHXQH3UF30B10B90hcCKiPodek2oAAAAASUVORK5CYII=", cc.Scene.extend({
                ctor: function (e, t) {
                    this._super(), this.bundles = e, this.callback = t, this.horizontalMode = !1, this.updateSize(), this.updatePosition();
                    var e = cleverapps.UI.getBgSize(),
                        t = (this.bgContainer = new cc.Node, this.bgContainer.setAnchorPoint2(), this.bgContainer.setContentSize(e), this.bgContainer.setPositionRound(this.convertToNodeSpace(cc.p(e.width / 2, e.height / 2))), this.addChild(this.bgContainer, 10), this.bgContainer.updateSize = function () {
                            this.setContentSize2(cleverapps.UI.getBgSize())
                        }, this.bgContainer.updatePosition = function () {
                            var e = cleverapps.UI.getBgSize(),
                                t = cleverapps.scenes.getRunningScene();
                            this.setPositionRound(t.convertToNodeSpace(cc.p(e.width / 2, e.height / 2)))
                        }, this.sceneName = cleverapps.Environment.SCENE_LOADER, cleverapps.environment.setScene(this.sceneName), this.onBackgroundLoaded = [], cleverapps.wait(2, this.showAnimations.bind(this))),
                        s = (this.loadBackground(t), this.loadAnimations(t), cleverapps.platform.oneOf(Instant, Ton, WortalPlatform, Samsung));
                    s || this.createProgressBar(),
                        cleverapps.platform.oneOf(Wechat) ? (this.createAgeRestriction(), this.createDescription()) : cleverapps.platform.oneOf(Samsung) && this.createAgeRestriction(), this.needPercent = 0, LoaderScene.startLoading(this.bundles, {
                            onSuccess: function () {
                                this.callback()
                            }.bind(this),
                            onFailure: this.onLoadError,
                            onProgress: function (e) {
                                s && cleverapps.platform.reportProgress(e), cleverapps.platform.oneOf(Wechat) && this.logLoadingProgress(e), this.needPercent = e
                            }.bind(this)
                        }), window.wechatFirstScreen && (this._canvas.active = !1)
                },
                logLoadingProgress: cleverapps.accumulate(5e3, function (e) {
                    cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.LOADER_PROGRESS + e)
                }),
                whenBackgroundLoaded: function (e) {
                    this.background ? e() : this.onBackgroundLoaded.push(e)
                },
                showProgressBar: function (e, t) {
                    var t = new ScaledProgressBar({
                        progress: new cc.Sprite(t).getSpriteFrame(),
                        background: new cc.Sprite(e).getSpriteFrame()
                    }),
                        s = cleverapps.styles.LoadingScene,
                        e = cleverapps.resolution.mode !== cleverapps.WideMode.VERTICAL;
                    t.setLength(
                        e && s.bar.scale9.wideWidth ? s.bar.scale9.wideWidth : s.bar.scale9.width), t.setScale(resolutionScale), this.bgContainer.addChild(t), this.progressBar = t, this.progressBar.updatePosition = function () {
                            var e = cleverapps.scenes.getRunningScene();
                            this.setPositionRound(e.convertToWorldSpace(cc.p(e.width / 2, s.bar.y)))
                        }, this.progressBar.updatePosition()
                },
                createDescription: function () {
                    var t = cleverapps.styles.LoadingScene;
                    this.whenBackgroundLoaded(function () {
                        var e = cleverapps.UI.generateOnlyText("健康游戏忠告\n抵制不良游戏,拒绝盗版游戏,注意自我保护,谨防受骗上当.\n适度游戏益脑,沉迷游戏伤身,合理安排时间,享受健康生活.\n批准文号：新广出审[2016]4509号 软著登记号：2016SR194719\n著作权人：广州道泉网络科技有限公司 出版物号：ISBN 978-7-7979-3066-6\n出版单位名称：广州盈正信息技术有限公司 运营单位：深圳彩苻科技有限公司", cleverapps.styles.FONTS.LOADER_SCENE_DESCRIPTION);
                        this.bgContainer.addChild(e), (this.description = e).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setDimensions(t.description.width, 0), e.setPositionRound(t.description)
                    }.bind(this))
                },
                createAgeRestriction: function () {
                    var s = cleverapps.styles.LoadingScene;
                    cc.loader.loadImg(
                        ageRestrictionSrc,
                        function (e, t) {
                            this.whenBackgroundLoaded(function () {
                                var e = new cc.Sprite(t);
                                this.bgContainer.addChild(e), e.setPositionRound(s.ageRestriction)
                            }.bind(this))
                        }.bind(this))
                },
                createProgressBar: function () {
                    this.loadProgressBar();
                    var t = 0;
                    this.percentInterval = setInterval(function () {
                        var e;
                        t !== this.needPercent && (e = Math.min(this.needPercent - t, 20), t += e, this.progressBar && this.progressBar.setPercentage(t))
                    }.bind(this), 50)
                },
                createMessage: function (e) {
                    var t = cleverapps.styles.LoadingScene,
                        e = cleverapps.UI.__generateNotLocalizedText(e, cleverapps.styles.FONTS.LOADING_TEXT || cleverapps.styles.FONTS.TEXT);
                    return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.width < t.bar.scale9.width && e.setDimensions(t.bar.scale9.width, 0), e.setPositionRound(this.convertToWorldSpace(cc.p(this.width / 2, t.bar.y + t.message.y))), e.updatePosition = function () {
                        var e = cleverapps.scenes.getRunningScene();
                        this.setPositionRound(e.convertToWorldSpace(cc.p(e.width / 2, t.bar.y + t.message.y)))
                    }, e.updatePosition(), e
                },
                onLoadError: function (e, t) {
                    this.message && this.message.setString("Error loading! Retry number: " + t)
                },
                completeAnimationOnResize: function () { },
                loadAnimations: function (e) {
                    bundles.loading_scene && cleverapps.bundleLoader.loadBundle("loading_scene", {
                        onSuccess: e
                    })
                },
                showAnimations: function () {
                    this.logo = this.createLogo(), this.bgContainer.addChild(this.logo), bundles.loading_scene.jsons.bg_json && (this.customAnimation = this.createCustomAnimation(), this.background.addChild(this.customAnimation)), this.updateAnimations()
                },
                createLogo: function () {
                    var e = new cleverapps.Spine(bundles.loading_scene.jsons.logo_json),
                        t = e.hasAnimation("animation_" + cleverapps.settings.language) ? cleverapps.settings.language : cc.sys.LANGUAGE_ENGLISH,
                        s = e.hasAnimation("animation_" + t + "_" + cleverapps.platform.source) ? "_" + cleverapps.platform.source : "";
                    return e.setAnimationAndIdleAfter("animation_" + t + s, "animation_" + t + "_idle" + s), e.setLocalZOrder(10), e
                },
                createCustomAnimation: function () {
                    var e = new cleverapps.Spine(
                        bundles.loading_scene.jsons.bg_json);
                    return e.setAnimation(0, "animation", !1), e
                },
                updateAnimations: function () {
                    var e, t, s, i = cleverapps.styles.LoadingScene;
                    this.logo && (e = cleverapps.UI.getBgSize(), t = !this.horizontalMode && i.logoAnimation.posVert || i.logoAnimation.pos, this.logo.setPositionRound(e.width * t.factorX, e.height * t.factorY), t = (e = Math.max(this.background.scale, 1)) * this.logo.width, s = .9 * this.width, i.logoAnimation.canScale && s < t && (e *= s / t), this.logo.setScale(e)), this.customAnimation && this.customAnimation.setPositionRound(!this.horizontalMode && i.customAnimation.posVert || i.customAnimation.pos)
                },
                loadBackground: function (i) {
                    var e = cleverapps.UI.getBgSize(),
                        e = (this.horizontalMode = e.width / e.height > 1 / cleverapps.ASPECT_RATIO, (e.width < cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE || e.height < cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE) && (this.horizontalMode = !0), bundles.loading_scene_images_vertical),
                        t = (e = (e = this.horizontalMode ? bundles.loading_scene_images_horizontal : e) || bundles["loading_scene_images_" + cleverapps.config.orientation]).urls.background,
                        n = function (s) {
                            cc.loader.loadImg(t, function (e, t) {
                                e && 0 < s ? n(s - 1) : (this.showBackground(t), this.onBackgroundLoaded.forEach(function (e) {
                                    e()
                                }), this.onBackgroundLoaded = [], cc.game.isPaused() && cc.game.step(), i())
                            }.bind(this))
                        }.bind(this);
                    n(3)
                },
                loadProgressBar: function () {
                    var e, s = null,
                        i = null,
                        n = function () {
                            s && i && this.whenBackgroundLoaded(this.showProgressBar.bind(this, s, i))
                        }.bind(this),
                        t = cleverapps.platform instanceof Wechat ? (e = loadingA, loadingB) : (e = document.getElementById("loadingA").src, document.getElementById("loadingB").src);
                    cc.loader.loadImg(e, function (e, t) {
                        s = t, n()
                    }), cc.loader.loadImg(t, function (e, t) {
                        i = t, n()
                    })
                },
                showBackground: function (e) {
                    cleverapps.styles.LoadingScene.pattern ? this.background = cleverapps.UI.createPatternSprite(e || null, cleverapps.UI.getBgSize()) : this.background = new cc.Sprite(e || null), this.bgContainer.addChild(this.background, -1), cleverapps.resolution.showCanvas(), cleverapps.platform.oneOf(Instant) || (this.message = this.createMessage(LoaderScene.getLoadingText()), this.bgContainer.addChild(this.message, 1)), this.background.updateSize = function () {
                        var e = cleverapps.UI.getBgSize(),
                            e = Math.max(e.height / this.height, e.width / this.width);
                        this.setScale(cc.contentScaleFactor() * e)
                    }, this.background.updatePosition = function () {
                        this.setPositionRound({
                            align: "center"
                        }, {
                            align: "center"
                        })
                    }, this.background.updateSize(), this.background.updatePosition()
                },
                updateSize: function () {
                    this.setContentSize2(cleverapps.UI.getSceneSize()), this.updateAnimations()
                },
                updatePosition: function () {
                    this.setPositionRound(0, cleverapps.UI.getBgOffset())
                },
                unload: function (e) {
                    clearInterval(this.percentInterval), e.prevSceneBundles = this.bundles;
                    e = cleverapps.substract(this.bundles, e.bundles);
                    cleverapps.bundleLoader.deleteBundles(e), cleverapps.bundleLoader.deleteBundle("loading_scene"), cleverapps.resolution.showCanvas()
                },
                createTransition: function () {
                    return this.bgContainer.setLocalZOrder(1e3), this.bgContainer.transitionBundles = [
                        "loading_scene_images", "loading_scene"
                    ].filter(function (e) {
                        return bundles[e]
                    }), this.bgContainer
                }
            })),
        VictoryWindow = (LoaderScene.startLoading = function (s, i) {
            LoaderScene.start = Date.now();

            function n(t) {
                cc.loader.load(e, function (e, t, s) {
                    s = s / t * 100 | 0, s = Math.min(Math.round(s), 100);
                    o(s)
                }, function (e) {
                    e ? (t++, i.onFailure && i.onFailure(e, t), t < 10 && n(t)) : (o(100), cleverapps.bundleLoader.loadBundles(s, {
                        onSuccess: i.onSuccess
                    }))
                })
            }
            var o = (i = i || {}).onProgress,
                e = [].concat.apply([], s.map(function (e) {
                    return new Bundle(e).listUrls()
                }));
            n(0)
        }, LoaderScene.getLoadingText = function () {
            var e = {
                en: "Loading",
                ru: "Загрузка",
                ja: "読み込み中",
                zh: "载入中",
                es: "cargando",
                de: "Wird geladen",
                pt: "Carregando",
                it: "Caricamento in corso",
                ar: "جار التحميل",
                ko: "로드 중",
                tr: "Yükleniyor",
                nl: "bezig met laden",
                fr: "chargement"
            };
            return (e[cleverapps.settings.language] || e.en) + "..."
        }, cleverapps.styles.FONTS = cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            LOADER_SCENE_DESCRIPTION: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: {
                    size: 4,
                    color: new cc.Color(
                        116, 49, 161, 200)
                }
            }
        }), cleverapps.styles.LoadingScene = {
            bar: {
                y: 70,
                scale9: {
                    width: 400
                }
            },
            message: {
                y: 60
            },
            ageRestriction: {
                x: {
                    align: "right",
                    dx: -200
                },
                y: {
                    align: "top",
                    dy: -100
                }
            },
            description: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 180
                },
                width: 1450
            },
            logoAnimation: {
                canScale: !0,
                pos: {
                    factorX: .5,
                    factorY: .5
                }
            }
        }, Window.extend({
            ctor: function (e, t) {
                this.game = e, this.boatswain = t, this.next = void 0;
                var t = this.game.rewards,
                    s = (cleverapps.meta.getType() === Metha.SIMPLE && e.level.isRegular() && (t.simpleStar = cleverapps.simple.amountLevelStars(e.level)), cleverapps.meta.getType() === Metha.HOMEFIX && e.level.isRegular() && (t.homeStar = cleverapps.home.amountLevelStars(e.level)), []),
                    i = (void 0 !== e.rewards[GameBase.REWARD_PRIMARY] && ((i = e.primaryMission.type) === Mission.TYPE_TREASURE_SEARCH ? (t.mission = {
                        missionType: i,
                        amount: e.rewards[GameBase.REWARD_PRIMARY]
                    }, t[GameBase.REWARD_PRIMARY] = void 0) : s.push(new ExtraPrize("mission", {
                        type: e.primaryMission.type,
                        amount: e.rewards[GameBase.REWARD_PRIMARY]
                    }))), new RewardsList(t, {
                        event: cleverapps.EVENTS.EARN.LEVEL_REWARD
                    }));
                i.receiveRewards(), i.filter(function (e) {
                    return -1 === [GameBase.REWARD_PRIMARY, "lantern"].indexOf(e.type)
                }), this.rewards = i, void 0 !== this.game.rewards.lantern && s.push(new ExtraPrize("lantern", this.game.rewards.lantern)), this.extraPrizes = s, this._super()
            },
            onWindowLoaded: function () {
                var e = cleverapps.styles.VictoryWindow;
                this.rumble = cleverapps.isRumble() && cleverapps.meta.getRumble(), this.rumble && (this.rumbleRound = this.rumble.getPrevRound(), this.rumbleRound || cleverapps.throwAsync("can't find round for rumble [" + this.rumble.rounds.map(function (e) {
                    return e.players && e.players.join(",")
                }).join("],[") + "]")), this._super({
                    name: "victorywindow",
                    title: this.getTitleText(),
                    shareId: !this.rumble && !cleverapps.instantTournament.isInTournament() && "victory",
                    styles: e,
                    content: this.createContent(),
                    homeButton: !this.rumble,
                    fireworks: !cleverapps.isKnockoutGame() && this.game.outcome === GameBase.OUTCOME_VICTORY,
                    noBackground: !0,
                    tapToContinue: !0
                }),
                    this.boatswain && this.boatswain.setIntent(this.boatswain.canNext() ? Boatswain.NEXT_INTENT : Boatswain.RETURN_INTENT)
            },
            onShow: function () {
                var e, t;
                this.silentShow || (e = cleverapps.styles.VictoryWindow, this.runAction(new cc.Sequence(new cc.DelayTime(e.soundDelay || 0), new cc.PlaySound(bundles.victory_window.urls.win_effect), new cc.PlaySound(bundles.victory_window.urls.win_effect_2))), this.runAction(new cc.Sequence(new cc.DelayTime(2), new cc.CallFunc(function () {
                    this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.PlaySound(bundles.victory_window.urls.victory_looped_effect), new cc.DelayTime(4))))
                }.bind(this)))), t = 200, this.rewardsList.showUp(), this.extraPrizesList.forEach(function (e) {
                    e.showUp(t), t += 300
                }), this.fireworks && this.fireworks.start((t + 300) / 1e3), this.content.children.forEach(function (e) {
                    e.showUp && (t += e.showUp())
                }), this.silentShow = !0, this._super(t / 1e3 + .5))
            },
            getPerson: function () {
                return this.game.outcome === GameBase.OUTCOME_VICTORY && {
                    role: "hero",
                    emotion: "happy"
                }
            },
            getTitleText: function () {
                return this.rumble ? this.rumbleRound && this.rumbleRound.isLast() ? "KnockoutWindow.Title.Final" : Messages.get("KnockoutWindow.Title.Round", {
                    roundId: (this.rumbleRound && this.rumbleRound.id || 0) + 1
                }) : this.game.outcome === GameBase.OUTCOME_LOST ? "LoseWindow.title" : "VictoryWindow.Victory"
            },
            createContent: function () {
                var e = cleverapps.styles.VictoryWindow,
                    t = [],
                    s = ("battlefield" === cleverapps.config.type && t.push(new BattleStatsComponent), cleverapps.highscore && (t.push(new VictoryScoreComponent), t.push(new ScoreStatsComponent)), t.push(this.createRewards()), this.createExtraPrizes());
                return s && t.push(s), this.rumbleRound && (t.push(new RoundResultsComponent(this.rumbleRound, {
                    victory: !0
                })), t.push(new RoundCountdownComponent(function () {
                    this.closed || this.close()
                }.bind(this)))), new cleverapps.Layout(t, {
                    direction: cleverapps.UI.VERTICAL,
                    padding: e.padding,
                    margin: e.margin
                })
            },
            createRewards: function () {
                var e = cleverapps.styles.VictoryWindow.rewards,
                    t = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? 3 : 5,
                    t = this.rewardsList = new RewardsListComponent(this.rewards, {
                        columns: t,
                        iconWrap: e.iconWrap,
                        textMargin: e.textMargin,
                        font: cleverapps.styles.FONTS.REWARDWINDOW_VALUE_TEXT,
                        noShowControls: !1
                    });
                return t.setLocalZOrder(2), t
            },
            createExtraPrizes: function () {
                var e = cleverapps.styles.VictoryWindow.extra,
                    t = this.extraPrizesList = this.extraPrizes.map(function (e) {
                        return new ExtraPrizeView(e)
                    });
                if (t.length) return t = new cleverapps.Layout(t, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin
                }), t.setLocalZOrder(2), t
            },
            beforeCloseAnimation: function (e) {
                this.rewardsList.receiveRewardsAnimation();
                var s = this.rewardsList.targets.length,
                    i = this.extraPrizesList.length,
                    n = 300 * s;
                this.extraPrizesList.forEach(function (e, t) {
                    n += 300, e.collectReward(n, s + i - t)
                }), n += 100, this.content.children.forEach(function (e) {
                    e.beforeWinClose && e.beforeWinClose()
                }), this.runAction(new cc.Sequence(new cc.DelayTime(n / 1e3), new cc.CallFunc(function () {
                    cleverapps.aims.whenAllHidden(e)
                })))
            },
            getPreferredBundles: function () {
                return ["game"]
            },
            listBundles: function () {
                return ["victory_window"]
            }
        })),
        ExtraPrize = (cleverapps.styles.VictoryWindow = {
            margin: 40,
            padding: {
                bottom: 40
            },
            rewards: {
                textMargin: 0,
                iconWrap: {
                    width: 130,
                    height: 130
                },
                margin: 30,
                padding: {
                    x: 0,
                    y: 0
                }
            },
            extra: {
                margin: 60
            }
        }, function (e, t) {
            this.type = e, this.amount = t, "mission" === this.type ? (this.amount = t.amount, this.missionType = t.type) : "lantern" === this.type && (e = Lantern.Get(), this.amount = e && e.streak || 0, this.total = Lantern.getMaxStreak())
        }),
        ExtraPrizeView = (ExtraPrize.prototype.getIcon = function () {
            var e = {
                open: "open",
                idle: "idle"
            };
            return "mission" === this.type ? this.missionType === Mission.TYPE_SLOT_MACHINE ? e.json = bundles.extra_prizes.jsons.slot_machine_ticket_json : this.missionType === Mission.TYPE_TREASURE_SEARCH ? e.json = bundles.extra_prizes.jsons.treasure_search_shovel_json : this.missionType === Mission.TYPE_STICKERS_COLLECTION ? e.json = bundles.extra_prizes.jsons.sticker_json : (e.json = Missions[this.missionType].sideBarJson, e.open = void 0, e.idle = "animation", e.repeat = !1) : "lantern" === this.type && (
                e.json = bundles.sidebar.jsons.lantern_icon_json, e.open = void 0, e.idle = "animation", e.repeat = !1), e
        }, ExtraPrize.prototype.getText = function () {
            return {
                text: "" + (this.total ? this.amount + "/" + this.total : this.amount)
            }
        }, ExtraPrize.prototype.getDelta = function () {
            return this.delta || 0
        }, cc.Node.extend({
            ctor: function (e) {
                this.extraPrize = e, this._super();
                e = new cc.Sprite(cleverapps.skins.getSlot("sidebarBg") || bundles.extra_prizes.frames.icon_bg);
                SceneDecors.add(e, cleverapps.skins.getSlot("sidebarIcon")), this.setAnchorPoint2(), this.setContentSize(e.width, e.height), e.setPositionRound(this.width / 2, this.height / 2), this.addChild(e), this.addIcon(), this.addTitle()
            },
            addIcon: function () {
                var e, t = this.extraPrize.getIcon();
                t.json ? (e = new cleverapps.Spine(t.json), t.open ? (e.setAnimation(0, t.open, !1), e.addAnimation(0, t.idle, !1 !== t.repeat)) : e.setAnimation(0, t.idle, !1 !== t.repeat)) : (cleverapps.throwAsync("Extra prize icon is undefined - " + this.extraPrize.type), e = new cc.Node), (this.icon = e).setPositionRound(this.width / 2,
                    this.height / 2), this.addChild(e)
            },
            addTitle: function () {
                var e = cleverapps.styles.SideBarIconView.text,
                    t = this.titleBackground = cleverapps.UI.createScale9Sprite(bundles.extra_prizes.frames.icon_text_bg, cleverapps.UI.Scale9Rect.TwoPixelXY),
                    s = (t.setContentSize2(e), t.setPositionRound(e), this.addChild(t), this.title = new cc.Node);
                s.setAnchorPoint2(), s.setPositionRound(t.width / 2, t.height / 2 + e.offsetY), t.addChild(s), this.updateTitleText()
            },
            updateTitleText: function () {
                var e, t = cleverapps.styles.SideBarIconView.text,
                    s = (this.title && this.title.removeAllChildren(), this.extraPrize.getText());
                s.text && ((e = cleverapps.UI.generateTTFText(s.text, cleverapps.styles.FONTS.SIDEBAR_ICON_TEXT)).fitTo(.86 * t.width, .86 * t.height), e.baseScale = e.scale), e.setPositionRound(this.title.width / 2, this.title.height / 2), this.title.addChild(e)
            },
            showUp: function (e) {
                this.setVisible(!1), this.runAction(new cc.Sequence(new cc.DelayTime(e / 1e3), new cc.ScaleTo(0, 0), new cc.Show, new cc.ScaleTo(.23, 1.1).easing(cc.easeInOut(1.2)), new cc.PlaySound(
                    bundles.main.urls.reward_icon_show_effect, {
                    throttle: 0
                }), new cc.ScaleTo(.1, 1).easing(cc.easeInOut(1.2))))
            },
            collectReward: function (e) {
                this.setCascadeOpacityEnabledRecursively(!0), this.runAction(new cc.Sequence(new cc.DelayTime(e / 1e3), new cc.ScaleTo(.2, .9).easing(cc.easeOut(1.5)), new cc.ScaleTo(.2, 1.2).easing(cc.easeOut(1.5)), new cc.Spawn(new cc.ScaleTo(.2, .5), new cc.FadeOut(.2)), new cc.Hide)), this.icon.runAction(new cc.Sequence(new cc.DelayTime(e / 1e3), cleverapps.UI.animateCollect(this.icon, "default", {
                    duration: .7,
                    collectEffect: !0,
                    replaceParentOnStart: !0,
                    sound: bundles.menubar.urls.exp_fly_finish_effect
                }), new cc.RemoveSelf))
            }
        })),
        LoseWindow = Window.extend({
            onWindowLoaded: function (e, t) {
                this.level = e.level;
                var s, e = cleverapps.styles.LoseWindow,
                    i = {
                        name: "losewindow",
                        content: this.createContent(),
                        title: {
                            text: "LoseWindow.title",
                            font: cleverapps.styles.FONTS.LOSE_WINDOW_TITLE_TEXT
                        },
                        noBackground: e.noBackground,
                        openSound: bundles.lose_window.urls.lose_effect
                    };
                !cleverapps.isKnockoutGame() ? (
                    s = cleverapps.once(this.createListener(function () {
                        t && t.setIntent(Boatswain.REPLAY_INTENT), this.close()
                    }.bind(this))), i.button = {
                        text: "TryAgain",
                        width: e.button.width,
                        height: e.button.height,
                        onPressed: function () {
                            cleverapps.lives && cleverapps.lives.isEmpty() ? new LivesShopWindow({
                                onBought: s
                            }) : s()
                        }
                    }) : i.tapToContinue = !0, this._super(i), cleverapps.lives && (cleverapps.lives.onChangeAmountListeners.losewindow = this.createListener(this.updateWindow.bind(this))), e.hardLevel && this.level.isHard() && ((i = new HardLevelWindowIcon).setPositionRound(e.hardLevel), i.pulseAnimation(), this.window.addChild(i))
            },
            onShow: function () {
                var t = 0;
                this.content.children.forEach(function (e) {
                    e.showUp && (t += e.showUp())
                }), this._super(t / 1e3 + .5)
            },
            getPerson: function () {
                return {
                    role: "hero",
                    emotion: "sad"
                }
            },
            createAnimationNode: function () {
                var e = cleverapps.styles.LoseWindow,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2(e.animation), this.animation = new cleverapps.Spine(bundles.lose_window.jsons.lose_json),
                        cleverapps.unlimitedLives && cleverapps.unlimitedLives.checkBuyed() ? "open_unlim" : "open");
                return this.animation.setAnimationAndIdleAfter(s, "idle"), t.addChild(this.animation), this.animation.setPositionRound(e.animation), t
            },
            createLivesLayout: function (e) {
                for (var t, s, i = cleverapps.styles.LoseWindow, n = [], o = 0; o < cleverapps.lives.getMaxLives(); o++) o === cleverapps.lives.amount && e ? (s = new cleverapps.Spine(bundles.lose_window.jsons.level_failed_small_hearts_json)).setAnimation(0, "animation", !1) : (t = o < cleverapps.lives.amount ? bundles.lose_window.frames.level_failed_heart_png : bundles.lose_window.frames.level_failed_heart_empty_png, s = new cc.Sprite(t)), n.push(s);
                return new cleverapps.Layout(n, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: i.heartsMargin
                })
            },
            createLivesLeftBlock: function () {
                var e, t = cleverapps.styles.LoseWindow,
                    s = [],
                    i = cleverapps.styles.FONTS.LOSE_WINDOW_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT;
                return cleverapps.unlimitedLives && cleverapps.unlimitedLives.checkBuyed() ? ((
                    e = cleverapps.UI.generateOnlyText("LoseWindow.livesLeftUnlimited", i)).setDimensions(t.livesLeftText.width, 0), e.fitTo(void 0, t.livesLeftText.height), e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.push(e)) : ((e = cleverapps.UI.generateOnlyText("LoseWindow.livesLeft", i)).fitTo(t.livesLeftText.width, t.livesLeftText.height), s.push(e), this.heartsNode = this.createLivesLayout(!0), s.push(this.heartsNode)), new cleverapps.Layout(s, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: t.livesLeftMargin
                    })
            },
            createContent: function () {
                var e, t = cleverapps.styles.LoseWindow,
                    s = [];
                return cleverapps.lives && (e = this.createAnimationNode(), s.push(e), this.livesLeftBlock = this.createLivesLeftBlock(), s.push(this.livesLeftBlock)), cleverapps.highscore && (s.push(new VictoryScoreComponent), s.push(new ScoreStatsComponent)), new cleverapps.Layout(s, {
                    direction: cleverapps.UI.VERTICAL,
                    margin: t.content.margin,
                    padding: t.content.padding
                })
            },
            updateWindow: function () {
                var e, t, s;
                this.heartsNode && (e = this.createLivesLayout(),
                    t = this.heartsNode.getPosition(), s = this.heartsNode.getParent(), this.heartsNode.removeFromParent(), s.addChild(e), e.setPositionRound(t), this.heartsNode = e)
            },
            listBundles: function () {
                return ["lose_window"]
            }
        }),
        LevelStartWindow = (cleverapps.styles.LoseWindow = {
            heartsMargin: 5,
            livesLeftMargin: 15,
            livesLeftText: {
                width: 800,
                height: 180
            },
            content: {
                margin: 40,
                padding: {
                    x: 80,
                    bottom: 50,
                    top: 50
                }
            },
            animation: {
                width: 300,
                height: 300,
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            button: {
                width: 300,
                height: 100
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.level = e.level, this.stars = this.level.stars, cleverapps.config.features.includes("boosters_before") && WindowBoostersBefore.isAvailable() && (this.boostersBefore = new WindowBoostersBefore(this.level), cleverapps.meta.showControlsWhileFocused("MenuBarGoldItem")), this.isHardLevel = this.level.isHard() && !this.level.episode.isDailyLevel();
                var e = cleverapps.styles.LevelStartWindow,
                    t = new cleverapps.Layout(this.listContent(), {
                        direction: cleverapps.UI.VERTICAL,
                        reversed: !0,
                        margin: e.margin,
                        padding: e.padding
                    });
                this._super({
                    title: this.getTitle(),
                    name: "levelstartwindow",
                    content: t,
                    button: this.getButton(),
                    level: this.level
                }), e.hardLevel && this.isHardLevel && ((t = new HardLevelWindowIcon).setPositionRound(e.hardLevel), t.pulseAnimation(), this.window.addChild(t))
            },
            getPerson: function () {
                return "hero"
            },
            onPopUpAnimationFinished: function () {
                this.boostersBefore && this.boostersBefore.showTutorialSteps()
            },
            getTitle: function () {
                var e = "";
                return this.level.isRegular() && (e = cleverapps.meta.getType() !== Metha.HOSE || this.level.isCurrentLevel() ? cleverapps.user.getVirtualDisplayLevel() : this.level.getHumanReadableNumber()), {
                    text: this.getTitleText(),
                    font: cleverapps.styles.FONTS.WINDOW_TITLE_TEXT,
                    toReplace: {
                        levelNo: e
                    }
                }
            },
            getTitleText: function () {
                return this.level.episode.isDailyCup() ? "Cups.daily.title" : this.isHardLevel ? "message.hardLevel" : this.level.isTricky() ? "message.trickyLevel" : this.level.isBonus() ? "message.bonusLevel" : this.level.episode.isDailyLevel() ? "DailyLevelWindow.title" : cleverapps.user.isPassedAll() && cleverapps.meta.getType() === Metha.HOSE && this.level.isCurrentLevel() ? "LevelStartWindow.ComingSoonTitle" : "LevelStartWindow.title"
            },
            getButton: function () {
                var e = {
                    button_png: bundles.buttons_main.frames.play_button_png,
                    button_on_png: bundles.buttons_main.frames.play_button_on_png
                },
                    t = (this.isHardLevel && (e = {
                        button_png: bundles.buttons.frames.red_button,
                        button_on_png: bundles.buttons.frames.red_button_on
                    }), this.level.isTricky() && (e = {
                        button_png: bundles.buttons.frames.blue_button_png,
                        button_on_png: bundles.buttons.frames.blue_button_png
                    }), cleverapps.once(function () {
                        cleverapps.meta.distract({
                            focus: "LevelStartFromLevelStartWindow",
                            action: function (e) {
                                this.close(), this.level.play(e, {
                                    boostersBefore: this.boostersBefore && this.boostersBefore.listActivatedBoosters()
                                })
                            }.bind(this)
                        })
                    }.bind(this))),
                    e = {
                        width: cleverapps.styles.LevelStartWindow.Button.width,
                        height: cleverapps.styles.LevelStartWindow.Button.height,
                        type: e,
                        onPressed: function () {
                            cleverapps.lives && cleverapps.lives.isEmpty() ? new LivesShopWindow : t()
                        }
                    };
                return e.text = Messages.get("Play").toUpperCase(), e
            },
            listContent: function () {
                var e, t, s = cleverapps.styles.LevelStartWindow,
                    i = [];
                return this.boostersBefore && (e = new BoostersBeforeComponent(this.boostersBefore, this.level), i.push(e)), this.level.isBonus() && (e = new cc.Sprite(bundles.level_start_window.frames.pot_coins_png), s.coinsBg ? ((t = new cc.Scale9Sprite(bundles.level_start_window.frames.coins_bg_png)).setContentSize2(s.coinsBg), t.addChild(e), e.setPositionRound({
                    align: "center"
                }, {
                    align: "center"
                }), i.push(t)) : i.push(e)), i
            }
        })),
        ShopWindow = (LevelStartWindow.isAvailable = function (e, t) {
            return 0 !== cleverapps.boosters.listBoostersBefore().length && ((0 !== e || 0 !== t) && ("stacks" === cleverapps.config.subtype ? !cleverapps.GameSaver.load(cleverapps.GameSaver.getStoreSlot(e, t)) && WindowBoostersBefore.isAvailable() : "solitaire" !== cleverapps.config.type || WindowBoostersBefore.isAvailable()))
        }, LevelStartWindow.prototype.listBundles = function (e) {
            var t = ["level_start_window"];
            return cleverapps.config.features.includes(
                "boosters_before") && WindowBoostersBefore.isAvailable() && 0 < Lantern.GetStreak(e.level) && t.push("lantern_element"), t
        }, cleverapps.styles.LevelStartWindow = {
            Button: {
                width: 300,
                height: 100
            },
            margin: 40
        }, Window.extend({
            ctor: function (e) {
                if (this.options = e || {}, this.tab = this.options.tab, this.tab === ShopWindow.TABS.HARD_CURRENCY && cleverapps.flags.videoAdsMainMonetization && !cleverapps.rewardedAdsManager.isEnabled()) return !1;
                var t;
                e.force && e.force.productOptions && (t = e.force.productKey, this.originalProduct = cleverapps.clone(VirtualProducts[t]), VirtualProducts[t] = Object.assign(VirtualProducts[t], e.force.productOptions)), this.onFinishShowUp = function () { }, this._super.apply(this, arguments)
            },
            customize: function () {
                this._super(), this.needGoldInfo() && (this.goldInfo = new ShopUserGoldView), Lottery.addText(this)
            },
            needGoldInfo: function () {
                return ShopUserGoldView.IsAvailable() && !this.isVertical() && this.tab !== ShopWindow.TABS.LIVES
            },
            updateGoldInfo: function () {
                this.needGoldInfo() ? (
                    this.goldInfo = this.goldInfo || new ShopUserGoldView, this.goldInfo.showUp()) : this.goldInfo && this.goldInfo.hide(void 0, !0)
            },
            onWindowLoaded: function () {
                var e = cleverapps.styles.ShopWindow,
                    t = (this._super({
                        name: "shopwindow_tab" + this.tab,
                        content: this.createContent(this.tab),
                        title: this.getTitle(),
                        noBackground: !0,
                        notCloseByTouchInShadow: !0,
                        closeButtonDelay: !0,
                        styles: e
                    }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.SHOP_OPEN + this.tab, {
                        store_type: this.getTitle()
                    }), this.adjustShopWindow(), this.tiles.forEach(function (e) {
                        e.onReady && e.onReady()
                    }), this.scroll.scrollTo(cleverapps.UI.ScrollView.SCROLLS.LOWER_RIGHT), this.selectTileForScroll()),
                    s = t || cleverapps.UI.ScrollView.SCROLLS.UPPER_LEFT;
                this.runAction(new cc.Sequence(new cc.DelayTime(.8), new cc.CallFunc(function () {
                    this.scroll.scrollTo(s, .8, {
                        easing: cc.easeBackInOut(),
                        callback: this.onFinishShowUp
                    }), this.options.finger && t && this.runAction(new cc.Sequence(new cc.DelayTime(.5), new cc.CallFunc(function () {
                        t.addFinger()
                    })))
                }, this), new cc.CallFunc(
                    function () {
                        this.options.force && this.showTileForce()
                    }, this)))
            },
            showTileForce: function () {
                var e = this.tiles.find(function (e) {
                    return e.tileModel.product.key === this.options.force.productKey
                }, this);
                e && cleverapps.forces.create(e.button, {
                    pointer: !0
                }, {
                    actives: [e]
                })
            },
            getTitle: function () {
                var e = "ShopWindow.title";
                if ("merge" === cleverapps.config.type) switch (this.tab) {
                    case ShopWindow.TABS.HARD_CURRENCY:
                        e = "ShopWindow.title.ruby";
                        break;
                    case ShopWindow.TABS.LIVES:
                        e = "ShopWindow.title.energy";
                        break;
                    case ShopWindow.TABS.SOFT_CURRENCY:
                        e = "ShopWindow.title.coins";
                        break;
                    case ShopWindow.TABS.UNITS_FRUIT:
                        e = "ShopWindow.title.fruit";
                        break;
                    case ShopWindow.TABS.UNITS_RESOURCE:
                        e = "ShopWindow.title.resource";
                        break;
                    case ShopWindow.TABS.UNITS_DISCOUNT:
                        e = "ShopWindow.title.discount";
                        break;
                    case ShopWindow.TABS.UNITS_EXPEDITION_HALLOWEEN:
                        e = "ShopWindow.title.expedition.halloween";
                        break;
                    case ShopWindow.TABS.UNITS_EXPEDITION_XMAS:
                        e = "ShopWindow.title.expedition.xmas";
                        break;
                    case ShopWindow.TABS.UNITS_EXPEDITION_DRAGONIA:
                    case ShopWindow.TABS.UNITS_EXPEDITION_DRAGONIA2:
                    case ShopWindow.TABS.UNITS_EXPEDITION_DRAGONIA3:
                        e = "ShopWindow.title.expedition.dragonia";
                        break;
                    case ShopWindow.TABS.UNITS_EXPEDITION_UNDERSEA:
                        e = "ShopWindow.title.expedition.undersea";
                        break;
                    case ShopWindow.TABS.UNITS_ADS:
                        e = "ShopWindow.title.ads";
                        break;
                    case ShopWindow.TABS.UNITS_ADS_VIP:
                        e = "ShopWindow.title.ads_vip";
                        break;
                    case ShopWindow.TABS.UNITS_ADS_UNDECIDED:
                        e = "ShopWindow.title.ads";
                        break;
                    case ShopWindow.TABS.UNITS_EXPEDITION_RAPUNZEL:
                        e = "ShopWindow.title.expedition.rapunzel";
                        break;
                    case ShopWindow.TABS.UNITS_EXPEDITION_EASTER:
                        e = "ShopWindow.title.expedition.easter";
                        break;
                    case ShopWindow.TABS.UNITS_EXPEDITION_COLLECTIONS:
                        e = "ShopWindow.title.expedition.collections";
                        break;
                    case ShopWindow.TABS.UNITS_EXPEDITION_CHINA:
                        e = "ShopWindow.title.expedition.china"
                }
                return e
            },
            onHide: function () {
                this._super(), this.goldInfo && this.goldInfo.hide(void 0, !0), this.hidden = !0
            },
            buyProduct: function (e, t) {
                this.closingNow || this.hidden || (cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), e.buy(this.close.bind(this, !0), t), this.options.onBought && this.options.onBought(), this.originalProduct && (VirtualProducts[this.options.force.productKey] = this.originalProduct))
            },
            isVertical: function () {
                return cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL
            },
            adjustShopWindow: function (e) {
                this.shopLayout.scale = 1, this.windowTitle && this.windowTitle.setVisible(!this.isVertical());
                var t, s, i = cleverapps.UI.calcBoundaries(this.getOverlappingNodes()),
                    i = cc.rectSubPadding(i, this.getBackgroundPadding()),
                    n = (this.isVertical() && this.shopLayout.setScale(Math.min(this.shopLayout.scale, i.width / this.shopLayout.width)), 1),
                    o = (this.isVertical() || (this.shopLayout.setScale(Math.min(this.shopLayout.scale, i.height / this.shopLayout.height)), cleverapps.resolution.mode === cleverapps.WideMode.HORIZONTAL && cc.sys.isMobile && (n = cleverapps.styles.ShopWindow.horizontalMobile.scale, this.shopLayout.setScale(this.shopLayout.getScale() * n))), cleverapps.UI.getSceneSize()),
                    a = cleverapps.scenes.getRunningScene().getGlobalBoundingBox(),
                    r = this.shopLayout.getBoundingBox();
                r.height /= n, n = this.isVertical() ? (t = r.height + o.height - i.height, s = i.y + i.height / 2, r.height / 2 + i.y) : (t = a.height, s = this.convertToWorldSpace(0, 0).y, cc.nearestToRect(cc.rectSubPadding(i, cc.padding({
                    x: r.width / 2,
                    y: r.height / 2
                })), cc.rectGetCenter(a)).y), this.contentWrap.setContentSize2(r.width + o.width - i.width, t), e && e.changeSize || this.contentWrap.setPositionRound(this.convertToNodeSpace(cc.p(i.x + i.width / 2, s))), this.shopLayout.setPositionRound(this.convertToNodeSpace(cc.p(i.x + r.width / 2, n))), this.scroll.setContentSize2(o), this.scroll.setPositionRound({
                    align: "center"
                }, {
                    align: "center"
                }), this.scroll.updateInnerContent()
            },
            updateSize: function () {
                this._super(), (this.scroll.dir === cleverapps.UI.ScrollView.DIR_HORIZONTAL && this.isVertical() || this.scroll.dir === cleverapps.UI.ScrollView.DIR_VERTICAL && !this.isVertical()) && (this.scroll.removeFromParent(!0), this.createContent(this.tab), this.updateGoldInfo()),
                    this.windowTitle.setVisible(!this.isVertical()), this.adjustShopWindow({
                        changeSize: !0
                    })
            },
            createTilesLayout: function () {
                var e = cleverapps.styles.ShopWindow,
                    t = this.isVertical() ? 2 : this.tiles.length,
                    s = e.padding;
                cleverapps.resolution.mode === cleverapps.WideMode.HORIZONTAL && cc.sys.isMobile && (s = e.horizontalMobile.padding), this.shopLayout = new cleverapps.WrapGridLayout(this.tiles, {
                    columns: t,
                    margin: e.margin,
                    padding: s,
                    ascZOrder: !0
                })
            },
            createTiles: function (e) {
                e = ShopProductSource.listTileModels(e);
                this.tiles = e.map(function (e) {
                    var t = e.getViewClassName();
                    return e instanceof SubscriptionTileModel && (e.onClaim = this.close.bind(this)), new t(e, {
                        onClicked: this.buyProduct.bind(this),
                        cart: this.cart
                    })
                }, this)
            },
            createContent: function (e) {
                return this.createTiles(e), this.createTilesLayout(), this.contentWrap = new cc.Node, this.contentWrap.setAnchorPoint2(), this.contentWrap.addChild(this.shopLayout), this.contentWrap.visibilityCheckList = this.tiles, this.scroll = new cleverapps.UI.ScrollView(this.contentWrap, {
                    childrenVisibility: cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK,
                    childrenVisibilityPadding: cleverapps.styles.ShopWindow.tilesVisibilityPadding,
                    direction: this.isVertical() ? cleverapps.UI.ScrollView.DIR_VERTICAL : cleverapps.UI.ScrollView.DIR_HORIZONTAL,
                    clipping: !1,
                    scrollBarEnabled: !1
                }), this.scroll.setLocalZOrder(1), this.addChild(this.scroll), this.adjustShopWindow(), new cc.Node
            },
            selectTileForScroll: function () {
                var e;
                return e = (e = (e = this.options.priorityType ? this.tiles.find(function (e) {
                    return e instanceof this.options.priorityType
                }.bind(this)) : e) || this.tiles.find(function (e) {
                    return e.tileModel.isAttention()
                })) || this.tiles.find(function (e) {
                    return e.tileModel.wantsScroll()
                })
            },
            onShow: function (e) {
                this.updateGoldInfo(), this.hidden = void 0, this.tilesLayoutShowAnimation(e), this.options.force && cleverapps.meta.setEventNodes([]), this._super()
            },
            onClose: function () {
                this.tab !== ShopWindow.TABS.LIVES || "merge" !== cleverapps.config.type || cleverapps.lives.canTake(.2 * cleverapps.lives.getMaxLives()) || !Game.currentGame.specialEnergyOffer.isReady() || cleverapps.windows.currentWindow() instanceof RewardWindow || Game.currentGame.specialEnergyOffer.wantsToShow()
            },
            close: function (e) {
                var t, s;
                this.closingNow || (cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), this.goldInfo && this.goldInfo.remove(void 0, e), this.closingNow = !0, t = this._super, this.isCurrent() && cleverapps.meta.setEventNodes([]), s = cleverapps.windows.currentWindow() instanceof RewardWindow || "undefined" != typeof UnitsShopTab && UnitsShopTab.cartUnits && 0 < UnitsShopTab.cartUnits.length, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.SHOP_CLOSE, {
                    store_type: this.getTitle(),
                    stay_time: Date.now() - this.openTime <= 3e4 ? "sec0_30" : "sec30_more",
                    stay_whether_to_buy: s ? 1 : 0
                }), !0 === e ? this.closed || t.call(this) : (s = cleverapps.styles.ShopWindow, this.closeButton instanceof BandButton && this.closeButton.hide(), this.scrollBarBG && this.scrollBarBG.runAction(new cc.FadeOut(.3)), this.windowTitle && (e = cc.p(this.windowTitle.x,
                    cleverapps.UI.getSceneSize().height + this.windowTitle.height / 2), s = cc.p(this.windowTitle.x, this.windowTitle.y - s.title.hideAnimation.moveDownY), this.windowTitle.runAction(new cc.Sequence(new cc.MoveTo(.15, s), new cc.MoveTo(.3, e).easing(cc.easeIn(1))))), this.tilesLayoutCloseAnimation(t.bind(this))))
            },
            tilesLayoutShowAnimation: function (e) {
                for (var t = (e = e || 0) + .075 * Math.ceil(.5 * (this.tiles.length - 1)) + .5, s = this.tiles.length - 1; 0 <= s; s--) {
                    var i = e + .075 * Math.ceil(.5 * s),
                        n = this.tiles[s].tileBadge,
                        n = (n && (n.setVisible(!1), n.runAction(new cc.Sequence(new cc.ScaleTo(0, 0), new cc.DelayTime(t), new cc.PlaySound(bundles.tile_shop.urls.badge_appear_effect), new cc.Show, new cc.ScaleTo(.4, n.scale).easing(cc.easeBackOut())))), this.tiles[s].adsBubble);
                    n && (n.setActive(!1), n.runAction(new cc.Sequence(new cc.DelayTime(t), new cc.CallFunc(n.setActive.bind(n, !0))))), this.tiles[s].setVisible(!1), this.tiles[s].runAction(new cc.Sequence(new cc.ScaleTo(0, 0), new cc.CallFunc(function () {
                        this.beyondScroll || this.setVisible(!0)
                    }.bind(this.tiles[s])), new cc.DelayTime(i), new cc.ScaleTo(.4, this.tiles[s].scale).easing(cc.easeBackOut())))
                }
            },
            tilesLayoutCloseAnimation: function (e) {
                for (var t = cleverapps.wait(this.tiles.length, e), s = this.tiles.length - 1; 0 <= s; s--) this.tiles[s].runAction(new cc.Sequence(new cc.DelayTime(.075 * Math.ceil(.5 * s)), new cc.ScaleTo(.3, 0).easing(cc.easeBackIn()), new cc.CallFunc(t.bind(this, s))))
            },
            beforeCloseAnimation: function (e) {
                this.goldInfo && this.goldInfo.isRunning() ? this.goldInfo.addCleaner(e) : e()
            }
        })),
        LivesShopWindow = ShopWindow.extend({
            ctor: function (e) {
                this._super({
                    tab: ShopWindow.TABS.LIVES,
                    onBought: (e = e || {}).onBought,
                    force: e.force
                })
            }
        }),
        SoftCurrencyShopWindow = ShopWindow.extend({
            ctor: function (e) {
                this._super({
                    tab: ShopWindow.TABS.SOFT_CURRENCY,
                    force: (e = e || {}).force
                })
            }
        }),
        HardCurrencyShopWindow = ShopWindow.extend({
            ctor: function () {
                this._super({
                    tab: ShopWindow.TABS.HARD_CURRENCY
                })
            }
        }),
        TileBadge = (ShopWindow.prototype.listBundles = function () {
            return ["tile_shop"]
        }, ShopWindow.TABS = {
            HARD_CURRENCY: 0,
            LIVES: 1,
            SOFT_CURRENCY: 2,
            UNITS_FRUIT: 3,
            UNITS_RESOURCE: 4,
            UNITS_DISCOUNT: 5,
            UNITS_EXPEDITION_HALLOWEEN: 6,
            UNITS_EXPEDITION_XMAS: 8,
            UNITS_EXPEDITION_DRAGONIA: 10,
            UNITS_EXPEDITION_UNDERSEA: 12,
            UNITS_ADS: 14,
            UNITS_ADS_VIP: 15,
            UNITS_ADS_UNDECIDED: 19,
            FOGS_VALUABLES: 20,
            UNITS_EXPEDITION_DRAGONIA2: 21,
            UNITS_EXPEDITION_RAPUNZEL: 22,
            UNITS_EXPEDITION_EASTER: 23,
            UNITS_EXPEDITION_COLLECTIONS: 24,
            UNITS_EXPEDITION_DRAGONIA3: 25,
            UNITS_EXPEDITION_CHINA: 26
        }, cleverapps.styles.ShopWindow = {
            scrollBarBG: {
                height: 24,
                paddingX: 20,
                y: 20
            },
            title: {
                hideAnimation: {
                    moveDownY: 30
                }
            },
            margin: {
                x: 30,
                y: 30
            },
            padding: {
                x: 10,
                y: 10
            },
            tilesVisibilityPadding: 30,
            horizontalMobile: {
                scale: 1.25,
                padding: {
                    x: 0,
                    top: 140,
                    bottom: 90
                }
            },
            mouseScrollSpeed: 400
        }, cleverapps.overrideStyles(cleverapps.styles.DECORATORS, {
            TILE_SHOP_BADGE_STROKE: {
                color: new cc.Color(100, 34, 22, 255),
                size: 2
            },
            TILE_SHOP_SHADOW: {
                color: new cc.Color(100, 34, 22, 200),
                direction: cc.size(0, -3),
                blur: 1
            },
            TILE_SHOP_STROKE: {
                color: new cc.Color(100, 34, 22, 255),
                size: 3
            }
        }), cc.Sprite.extend({
            ctor: function (e) {
                this._super((
                    e = e || {}).image || bundles.badge.frames.badge_png);
                var t, s = cleverapps.styles.TileBadge,
                    i = (void 0 !== e.rotation ? e : s).rotation;
                e.icon ? (e.icon.setPositionRound(s.icon), e.icon.setRotation(-1 * i), this.addChild(e.icon)) : (t = e.largeFont ? cleverapps.styles.FONTS.TILE_SHOP_BADGE_BIG : cleverapps.styles.FONTS.TILE_SHOP_BADGE_TEXT, (t = cleverapps.UI.generateOnlyText(this.chooseText(e), t)).setPositionRound(s), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.fitTo(s.width, s.height), t.setRotation(s.text.rotation), this.addChild(t)), e.tooltipText && cleverapps.tooltipManager.create(this, {
                    text: Messages.get(e.tooltipText),
                    position: s.tooltip.position,
                    size: s.tooltip.size
                }), e.clickAction && (this.createFinger(), cleverapps.UI.applyHover(this), cleverapps.UI.onClick(this, e.clickAction)), this.setRotation(i)
            },
            disable: function () {
                this.setSpriteFrame(bundles.badge.frames.badge_off_png)
            },
            chooseText: function (e) {
                return "discount" === e.type ? Messages.get("Badge.discount", {
                    amount: e.text
                }) : "save" === e.type ? "Badge.save" : "bestSeller" === e.type ? "Badge.bestSeller" : "value" === e.type ? Messages.get("Badge.Value", {
                    amount: e.value
                }) : e.text || "default"
            },
            createIcon: function (e) {
                if ("clangift" === e.type) return new cc.Sprite(bundles.reward_icons.frames.clan_gift_png)
            },
            createFinger: function () {
                FingerView.hintClick(this, {
                    delay: .8,
                    runOnce: !0
                })
            }
        })),
        TileButton = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TILE_SHOP_BADGE_TEXT: {
                size: 25,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TILE_SHOP_BADGE_STROKE
            },
            TILE_SHOP_BADGE_BIG: {
                size: 50,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TILE_SHOP_BADGE_STROKE
            }
        }), cleverapps.styles.TileBadge = {
            x: {
                align: "center",
                dx: 0
            },
            y: {
                align: "center",
                dy: 10
            },
            width: 125,
            text: {
                rotation: 0
            },
            rotation: 30,
            tooltip: {
                position: {
                    x: {
                        align: "center",
                        dx: -75
                    },
                    y: {
                        align: "top",
                        dy: 50
                    }
                },
                size: {
                    width: 500,
                    height: 100
                }
            },
            icon: {
                x: {
                    align: "center",
                    dx: -2
                },
                y: {
                    align: "center",
                    dy: 8
                }
            }
        }, cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.tileModel = e,
                    this.options = t || {};
                var s = cleverapps.styles.TileButton,
                    t = this.button = new cleverapps.UI.Button({
                        text: t.text || this.getText(),
                        textOff: t.textOff || this.getText(!0),
                        width: t.width || s.width,
                        height: t.height || s.height,
                        type: t.type,
                        onClicked: t.onClicked.bind(t, e),
                        mark: this.tileModel.isAttention()
                    });
                e.constructor === TileModel && Lottery.addIcon(t, void 0, "gold25000" === e.product.itemId), this.setAnchorPoint2(), this.setContentSize2(t.getContentSize()), this.addChild(t), t.setPositionRound(s)
            },
            setString: function (e) {
                this.button.setString(e)
            },
            setStringOff: function (e) {
                this.button.setStringOff(e)
            },
            getText: function (e) {
                var t, s = !e && 0 === this.tileModel.getPrice();
                return this.options.buyParams && this.options.buyParams.videoBonus ? t = "##x2" : e ? t = this.tileModel.getDisabledPrice() : s && (t = "FREE"), t || this.tileModel.getCurrentPrice()
            },
            enable: function () {
                this.button.enable()
            },
            disable: function () {
                this.button.disable()
            }
        })),
        TileIcon = (cleverapps.styles.TileButton = {
            x: {
                align: "center"
            },
            y: {
                align: "center",
                dy: -5
            },
            width: 220,
            height: 90
        },
            cc.Node.extend({
                ctor: function (e, t) {
                    this._super(), t = t || {};
                    var s = cleverapps.styles.TileIcon,
                        i = (this.tileModel = e, bundles.tile_shop.frames[e.getIcon()]),
                        i = this.icon = new cc.Sprite(i),
                        n = s[e.product.itemId] && s[e.product.itemId].height || s.height,
                        n = (t.skipScale || (s.scale ? i.setScale(s.scale) : !n || (n = n / i.height) < 1 && i.setScale(n)), {
                            json: bundles.tile_shop.jsons.shop_sparkles_large_json
                        }),
                        o = ((n = t.animationOverride ? t.animationOverride : n).json && ((o = this.animation = new cleverapps.Spine(n.json)).setPosition(i.width / 2, i.height / 2), o.setLocalZOrder(n.jsonzOrder || 0), o.setAnimation(0, "animation", !0), o.setVisible(!1), i.addChild(o), n = void 0 !== n.delay ? n.delay : Math.random(), o.runAction(new cc.Sequence(new cc.DelayTime(n), new cc.Show))), s[e.product.itemId] ? s[e.product.itemId].wrap.dx || 0 : s.wrap.dx),
                        n = s[e.product.itemId] ? s[e.product.itemId].wrap.dy || 0 : s.wrap.dy;
                    this.setContentSize2(i.width, s[e.product.itemId] && s[e.product.itemId].wrap.height || s.wrap.height), this.setAnchorPoint2(), this.setLocalZOrder(t.zOrder || 0),
                        i.setAnchorPoint2(.5, 0), i.setPositionRound(this.width / 2 + o, n), this.addChild(i)
                },
                enable: function () {
                    this.icon.setColor(new cc.Color(255, 255, 255, 255)), this.icon.setOpacity(255), this.animation && this.animation.setVisible(!0)
                },
                disable: function () {
                    this.icon.setColor(new cc.Color(200, 200, 200, 255)), this.icon.setOpacity(180), this.animation && (this.animation.stopAllActions(), this.animation.setVisible(!1))
                }
            })),
        TileRewardsBlock = (cleverapps.styles.TileIcon = {
            scale: 1,
            wrap: {
                height: 270,
                dx: 0,
                dy: -24
            }
        }, cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.setAnchorPoint2(), this.tileModel = e, this.options = t || {}, this.styles = cleverapps.styles.TileRewardsBlock, this.setContentSize2(this.options.size), this.setLocalZOrder(this.styles.zOrder), this.createRewards()
            },
            createRewards: function () {
                var e = "merge" === cleverapps.config.type,
                    t = this.options.font || cleverapps.styles.FONTS.TILE_SHOP_OFFER_TEXT,
                    e = new RewardsListComponent(this.tileModel.getReward(), {
                        wrapGrid: !0,
                        noPrefix: e,
                        font: t,
                        small: !0,
                        columns: this.options.columns || 2,
                        textDirection: cleverapps.UI.HORIZONTAL,
                        textMargin: this.styles.amountMargin,
                        margin: {
                            x: this.styles.colMargin,
                            y: this.styles.rowMargin
                        },
                        icons: this.options.icons || {
                            hard: bundles.reward_icons.frames.shop_gold_png
                        }
                    }),
                    t = this.options.paddingX || this.styles.paddingX,
                    s = this.options.paddingY || 0;
                cleverapps.UI.fitToBox(e, {
                    width: this.options.size.width - t,
                    height: this.options.size.height - s
                }), e.setPositionRound(this.styles.rewardList), this.addChild(e)
            }
        })),
        LotteryIcon = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TILE_SHOP_OFFER_TEXT: {
                name: "default",
                size: 40,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.TileRewardsBlock = {
            width: 360,
            height: 180,
            rowMargin: 5,
            colMargin: 5,
            amountMargin: 5,
            zOrder: 0,
            paddingX: 0,
            bg: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            rewardList: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            }
        }, cc.Sprite.extend({
            ctor: function (e, t, s) {
                this._super();
                var i, n = this.styles = cleverapps.styles.LotteryIcon,
                    o = cleverapps.eventManager.getFeatureEvent("lottery"),
                    a = cleverapps.platform.oneOf(MobileOK, OKPlatform) && !1 !== o.options.okLottery,
                    s = a && o.options.lottery10k && s,
                    o = cleverapps.platform.oneOf(VKPlatform, MobileVk) && o.options.vkSaleDay;
                a ? n = cleverapps.overrideStyles(n, cleverapps.styles.OkLotteryIcon, !0) : o && (n = this.styles = cleverapps.overrideStyles(n, cleverapps.styles.VkLotteryIcon, !0)), o ? (i = bundles.lottery.frames.vk_lottery, n = cleverapps.overrideStyles(n, cleverapps.styles.VkLotteryIcon, !0)) : a ? (i = s ? bundles.lottery.frames.ok_lottery_10k : bundles.lottery.frames.ok_lottery, n = cleverapps.overrideStyles(n, cleverapps.styles.OkLotteryIcon, !0)) : i = bundles.lottery.frames["lottery_" + cleverapps.settings.language] || bundles.lottery.frames.lottery_en, this._super(i), e.addChild(this), this.setScale(n.positions[t = t || "bottom"].scale || n.scale || 1), this.baseScale = this.scale, this.setPositionRound(n.positions[t]), n.anchor && this.setAnchorPoint2(n.anchor.x, n.anchor.y)
            }
        })),
        Lottery = (cleverapps.styles.VkLotteryIcon = {
            anchor: {
                x: 1,
                y: 1
            },
            positions: {
                bottom: {
                    x: {
                        align: "left",
                        dx: -22
                    },
                    y: {
                        align: "top",
                        dy: 45
                    }
                },
                menu: {
                    x: {
                        align: "left",
                        dx: 15
                    },
                    y: {
                        align: "bottom",
                        dy: -20
                    }
                },
                icon: {
                    x: {
                        align: "center",
                        dx: -54
                    },
                    y: {
                        align: "bottom",
                        dy: -6
                    }
                },
                iconTimer: {
                    x: {
                        align: "left",
                        dx: -24
                    },
                    y: {
                        align: "bottom",
                        dy: 28
                    }
                }
            }
        }, cleverapps.styles.OkLotteryIcon = {}, cleverapps.styles.LotteryIcon = {
            positions: {
                menu: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -70
                    }
                },
                bottom: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -70
                    }
                },
                top: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "top",
                        dy: 55
                    }
                },
                icon: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -20
                    }
                },
                iconTimer: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -20
                    }
                },
                icon_top: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "top",
                        dy: 0
                    }
                },
                bottom_right: {
                    x: {
                        align: "right",
                        dx: 30
                    },
                    y: {
                        align: "bottom",
                        dy: -70
                    }
                }
            }
        }, {
            isActive: function () {
                return cleverapps.eventManager.isActive("lottery") && !cleverapps.flags.videoAdsMainMonetization
            },
            addIcon: function (e, t, s) {
                this.isActive() && (e.lotteryIcon = new LotteryIcon(e, t, s)).runAction(new cc.RepeatForever(new cc.Sequence(new cc.DelayTime(3),
                    new cc.RotateTo(.2, 10), new cc.RotateTo(.2, -10), new cc.RotateTo(.2, 10), new cc.RotateTo(.2, -10), new cc.RotateTo(.2, 0))))
            },
            addText: function (e) {
                var t, s, i;
                this.isActive() && (t = cleverapps.styles.Lottery, s = "Lottery.info", i = cleverapps.eventManager.getFeatureEvent("lottery"), cleverapps.platform.oneOf(MobileVk, VKPlatform) && i.options.vkSaleDay && (s = "Lottery.infoSaleDay"), i = cleverapps.UI.generateTTFText(s, t.text.font), e.addChild(i), i.setPositionRound(t.text), i.fitTo(e.width))
            }
        }),
        ShopProductSource = (cleverapps.styles.Lottery = {
            text: {
                font: cleverapps.styles.FONTS.SMALL_WHITE_TEXT,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 5
                }
            }
        }, {
            listProducts: function (e) {
                var t = ShopProductSource.ITEMS[e] || [],
                    s = ShopProductSource.ITEMS.CoinsPayer,
                    i = cleverapps.paymentsHistory.classify();
                return e === ShopWindow.TABS.HARD_CURRENCY && i > cleverapps.PaymentsHistory.BRACKET_WEAK && (t = s), t = e === ShopWindow.TABS.HARD_CURRENCY ? t.filter(function (e) {
                    e = cleverapps.config.products[e] || VirtualProducts[e];
                    return !!e && ((
                        !e.pack || "merge" !== cleverapps.config.type) && (!e.mainSceneOnly || cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition()))
                }) : t
            },
            listTileModels: function (e) {
                var t = cleverapps.unitsShop && cleverapps.unitsShop.tabs[e] ? cleverapps.unitsShop.tabs[e].generateProducts() : ShopProductSource.listProducts(e).map(function (e) {
                    return Product.Create(e)
                }),
                    s = (t = t.filter(function (e) {
                        if (!e) return !1;
                        if (e.reward && e.reward.unlimitedLives && cleverapps.unlimitedLives && cleverapps.unlimitedLives.checkBuyed()) return !1;
                        e = e.adsLimit ? e.adsLimit() : void 0;
                        return !e || cleverapps.adsLimits.state(e) !== AdsLimits.STATE_DISABLED
                    })).map(function (e) {
                        return TileModel.Create(e)
                    }).filter(function (e) {
                        return e.isEnabled()
                    });
                if (e === ShopWindow.TABS.HARD_CURRENCY && !cleverapps.flags.videoAdsMainMonetization) {
                    var i = 0;
                    s.forEach(function (e) {
                        e.getPrice && e.getPrice() > i && (i = e.getPrice())
                    });
                    for (var n = 0; n < s.length; n++)
                        if (s[n].getPrice() === i) {
                            s[n].badge = {
                                type: "save"
                            };
                            break
                        }
                }
                t = cleverapps.paymentsHistory.classify();
                if (
                    t === cleverapps.PaymentsHistory.BRACKET_UNDECIDED && (t = cleverapps.PaymentsHistory.BRACKET_NONE), e !== ShopWindow.TABS.HARD_CURRENCY || !cleverapps.flags.videoAdsMainMonetization)
                    for (var o = ShopProductSource.ITEMS.bestSellersByPayerClass[t], n = 0; n < s.length; n++)
                        if (-1 !== o.indexOf(s[n].getItemId()) && !s[n].badge) {
                            s[n].badge = {
                                type: "bestSeller"
                            };
                            break
                        } return s
            }
        }),
        Tabs = (ShopProductSource.ITEMS = {
            CoinsPayer: ["hardForVideo", "jamPack", "tastyPack", "honeyPack", "epicPack", "gold500", "gold1800", "gold3800", "gold6000", "gold25000", "subsMonth"],
            bestSellersByPayerClass: [
                ["sweetPack", "gold500"],
                ["jamPack", "gold1800"],
                ["tastyPack", "gold3800"],
                ["honeyPack", "gold6000"],
                ["honeyPack", "gold25000"]
            ]
        }, ShopProductSource.ITEMS[ShopWindow.TABS.HARD_CURRENCY] = ["hardForVideo", "sweetPack", "jamPack", "tastyPack", "honeyPack", "gold500", "gold1800", "gold3800", "gold6000", "gold25000", "subsMonth"], ShopProductSource.ITEMS[ShopWindow.TABS.LIVES] = ["refillLives", "unlimitedLives", "askLives", "livesForVideo", "buyLife"],
            ShopProductSource.ITEMS[ShopWindow.TABS.SOFT_CURRENCY] = ["softCurrencyVerySmall", "softCurrencySmall", "softCurrencyMedium", "softCurrencyLarge"], "merge" === cleverapps.config.type && (ShopProductSource.ITEMS[ShopWindow.TABS.LIVES] = ["energyLottery", "buyEnergy350", "buyEnergy700", "buyEnergy", "energyForVideo", "energyForVideoShort"], ShopProductSource.ITEMS[ShopWindow.TABS.SOFT_CURRENCY] = ["softCurrencyVerySmall", "softCurrencySmall", "softCurrencyMedium", "softCurrencyLarge"], -1 !== ["mergecraft", "wondermerge", "fairy"].indexOf(cleverapps.config.name) && (ShopProductSource.ITEMS.CoinsPayer = ["hardForVideo", "gold500", "gold1800", "gold3800", "gold6000", "gold25000", "subsMonth", "growthFund"], ShopProductSource.ITEMS[ShopWindow.TABS.HARD_CURRENCY] = ["hardForVideo", "gold500", "gold1800", "gold3800", "gold6000", "gold25000", "subsMonth", "growthFund"])), cleverapps.Layout.extend({
                ctor: function (s, i) {
                    this.buttons = {};
                    var e = cleverapps.styles.Tabs,
                        t = (this.direction = (void 0 === i.direction ? e : i).direction,
                            this.images = i.type || this.direction === cleverapps.UI.VERTICAL && Tabs.Types.tabs_vertical || Tabs.Types.tabs_horizontal, this.canChangeIconColor = !("undefined" != typeof LandMarkDonorWindow && cleverapps.windows.currentWindow() instanceof LandMarkDonorWindow && "fairy" === cleverapps.config.name), this.onTabChanged = function () { }, Object.keys(s).map(function (e, t) {
                                return this.createButton(e, s[e], -(t + 1), i)
                            }, this));
                    this._super(t, {
                        direction: this.direction,
                        margin: (void 0 === i.margin ? e : i).margin
                    })
                },
                createButton: function (e, t, p, s) {
                    var i, n, o, a = cleverapps.styles.Tabs.buttons,
                        r = s.width || a.width,
                        c = s.height || a.height,
                        l = s.margin || a.margin || 0,
                        a = cc.rectSubPadding(cc.rect(0, 0, r, c), cc.padding(a.padding, s.padding)),
                        s = this.buttons[e] = cleverapps.UI.createScale9Sprite(this.images.off_png);
                    return s.info = t, s.baseScale = 1, s.baseZOrder = p, s.setLocalZOrder(s.baseZOrder), s.setContentSize(r, c), t.icon && (i = s.icon = new cc.Sprite(t.icon)), t.node && (i = t.node), t.text && ((n = s.text = cleverapps.UI.generateOnlyText(t.text,
                        cleverapps.styles.FONTS.TABS_TEXT_FONT)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), n.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER)), i && n ? (n.setDimensions(a.width - i.width - l, 0), n.fitTo(void 0, a.height), n.setDimensions(n.width, a.height), o = new cleverapps.Layout([i, n], {
                            direction: cleverapps.UI.HORIZONTAL,
                            margin: l
                        })) : i ? o = i : n && (o = n).fitTo(a.width, a.height), n && (n.baseFontSzie = n.getFontSize()), o.setPositionRound(a.x + a.width / 2, a.y + a.height / 2), s.addChild(o), t.disabled || (s.clickHandler = cleverapps.UI.onClick(s, function () {
                            this.selectedId === e ? t.content.onClickTab && t.content.onClickTab() : this.activateTab(e)
                        }.bind(this)), cleverapps.UI.applyHover(s)), s.setRecCascadeColorEnabled(!0), s.setCascadeOpacityEnabledRecursively(!0), t.disabled && cleverapps.UI.convertToGrayScale(s), t.tooltip && cleverapps.tooltipManager.create(s, t.tooltip), t.attention && this.setAttention(e, t.attention), s
                },
                getActive: function () {
                    return this.selectedId
                },
                activeTab: function () {
                    return this.buttons[this.selectedId].info.content
                },
                activateTab: function (t, s) {
                    t = t.toString(), this.selectedId !== t && (cleverapps.audio.playSound(bundles.main.urls.click_effect), Object.keys(this.buttons).forEach(function (e) {
                        e === t ? this.onSelectTab(e, s) : this.onUnSelectTab(e)
                    }, this), this.onTabChanged(this.selectedId))
                },
                onSelectTab: function (e, t) {
                    var s = this.buttons[e],
                        i = s.info;
                    s.ignoreScale = !0, s.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(this.images.on_png)), s.setLocalZOrder(1), s.baseScale = 1.03, s.applyInteractiveScale(), i.updateTitle && i.updateTitle(), s.text && (s.text.setFont(cleverapps.styles.FONTS.TABS_TEXT_FONT), s.text.setFontSize(s.text.baseFontSzie), s.text.setOpacity(255)), s.icon && (this.canChangeIconColor && s.icon.setColor(cleverapps.styles.FONTS.TABS_TEXT_FONT.color), s.icon.setOpacity(255)), void 0 === i.content && (i.content = i.generator()), i.content.setVisible(!0), i.content.onSelectTab && i.content.onSelectTab(t), this.selectedId = e
                },
                onUnSelectTab: function (e) {
                    var e = this.buttons[e],
                        t = e.info;
                    e.ignoreScale = !1, e.setSpriteFrame(
                        cc.spriteFrameCache.getSpriteFrame(this.images.off_png)), e.setLocalZOrder(e.baseZOrder), e.baseScale = 1, e.applyInteractiveScale(), e.text && (e.text.setFont(cleverapps.styles.FONTS.TABS_TEXT_FONT_DISABLED), e.text.setFontSize(e.text.baseFontSzie), e.text.setOpacity(cleverapps.styles.Tabs.buttons.disabled.opacity)), e.icon && (this.canChangeIconColor ? (e.icon.setColor(cleverapps.styles.FONTS.TABS_TEXT_FONT_DISABLED.color), e.icon.setOpacity(cleverapps.styles.Tabs.buttons.disabled.opacity)) : e.icon.setOpacity(cleverapps.styles.Tabs.buttons.disabled.colorIconOpacity)), void 0 !== t.content && (t.content.setVisible(!1), t.content.stopAllActions(), t.content.onUnSelectTab && t.content.onUnSelectTab())
                },
                setAttention: function (e, t) {
                    var s = cleverapps.styles.Tabs.attention,
                        e = this.buttons[e];
                    e.attention && (e.attention.removeFromParent(), delete e.attention), t && (e.attention = new Attention, e.attention.setPositionRound(s), e.addChild(e.attention))
                }
            })),
        RoundTabs = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TABS_TEXT_FONT: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            TABS_TEXT_FONT_DISABLED: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), Tabs.Types = cleverapps.overrideTemplates({}, {
            tabs_vertical: {
                off_png: bundles.tabs.frames.vertical_shop_tab_off,
                on_png: bundles.tabs.frames.vertical_shop_tab_on
            },
            tabs_horizontal: {
                off_png: bundles.tabs.frames.shop_tab_off,
                on_png: bundles.tabs.frames.shop_tab_on
            },
            tabs_custom: {
                off_png: bundles.tabs.frames.custom_tab_off,
                on_png: bundles.tabs.frames.custom_tab_on
            }
        }), cleverapps.styles.Tabs = {
            margin: 0,
            direction: cleverapps.UI.HORIZONTAL,
            attention: {
                x: 0,
                y: 0
            },
            buttons: {
                width: 135,
                height: 240,
                margin: 5,
                padding: {
                    x: 15,
                    y: 10
                },
                disabled: {
                    opacity: 127,
                    colorIconOpacity: 127
                }
            }
        }, cleverapps.Layout.extend({
            ctor: function (e, t) {
                this.onClickCallback = t, this.contentByTab = {};
                t = cleverapps.styles.RoundTabs;
                this.tabs = {};
                for (var s = 0; s < e.length; s++) {
                    var i = e[s];
                    this.tabs[i.id] = this.createTab(i)
                }
                this._super(cleverapps.values(this.tabs), {
                    margin: t.margin,
                    direction: cleverapps.UI.HORIZONTAL
                })
            },
            getCurrentTab: function () {
                return this.currentTab
            },
            createTab: function (e) {
                var t = new cc.Sprite(bundles.tabs.frames.round_tab_bg),
                    s = new cc.Sprite(e.icon);
                return s.setPositionRound(t.width / 2, t.height / 2), t.addChild(s), t.icon = s, t.hoverHandler = cleverapps.UI.applyHover(t), t.clickHandler = cleverapps.UI.onClick(t, this.onClick.bind(this, e.id)), t.generator = e.generator, t
            },
            onClick: function (e) {
                this.setTab(e), this.onClickCallback && this.onClickCallback(e)
            },
            setTab: function (e) {
                void 0 !== this.currentTab && (this.tabs[this.currentTab].setSpriteFrame(bundles.tabs.frames.round_tab_bg), this.tabs[this.currentTab].icon.setColor(new cc.Color(255, 255, 255, 255)), this.tabs[this.currentTab].icon.setOpacity(255), this.tabs[this.currentTab].clickHandler = cleverapps.UI.onClick(this.tabs[this.currentTab],
                    this.setTab.bind(this, this.currentTab)), this.tabs[this.currentTab].hoverHandler || (this.tabs[this.currentTab].hoverHandler = cleverapps.UI.applyHover(this.tabs[this.currentTab]))), this.contentByTab[this.currentTab] && this.contentByTab[this.currentTab].setVisible(!1), this.currentTab = e, this.tabs[e].setSpriteFrame(bundles.tabs.frames.round_tab_bg_selected), this.tabs[e].icon.setColor(new cc.Color(180, 180, 180, 255)), this.tabs[e].icon.setOpacity(180), this.tabs[e].clickHandler && (this.tabs[e].clickHandler.remove(), this.tabs[e].clickHandler = void 0), this.tabs[e].hoverHandler && (this.tabs[e].hoverHandler.remove(), this.tabs[e].hoverHandler = void 0), this.tabs[e].generator && !this.contentByTab[e] && (this.contentByTab[e] = this.tabs[e].generator()), this.contentByTab[this.currentTab] && this.contentByTab[this.currentTab].setVisible(!0)
            },
            show: function () {
                for (var e in this.tabs) this.tabs[e].setScale(0), this.tabs[e].runAction(new cc.Sequence(new cc.DelayTime(.1), new cc.ScaleTo(.3, 1)))
            },
            hide: function () {
                for (
                    var e in this.tabs) this.tabs[e].runAction(new cc.Sequence(new cc.DelayTime(.1), new cc.ScaleTo(.2, 0)))
            }
        })),
        Buttons = (cleverapps.styles.RoundTabs = {
            margin: 50
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), 0 !== (e = Buttons.filter(e)).length && (this.buttons = {}, e.forEach(function (e) {
                    this.buttons[e.__instanceId] = e, this.addChild(e)
                }, this), this.arrange())
            },
            onEnterTransitionDidFinish: function () {
                this._super(), this.arrange()
            },
            arrange: function () {
                var t, e, s = cleverapps.styles.Buttons,
                    i = s.margin.x,
                    n = 0;
                1 < this.children.length && this.parent && (e = this.parent.width - 2 * s.padding.x, t = 0, this.children.forEach(function (e) {
                    t += e.width, n = Math.max(n, e.height / 2)
                }), e = Math.round((e - t) / (this.children.length - 1)), i = Math.max(i, e)), this.margin = i, cleverapps.UI.arrangeWithMargins(this.children, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: i,
                    y: n + s.padding.y
                }), cleverapps.UI.wrap(this), this.setAnchorPoint2()
            },
            add: function (e) {
                0 !== Buttons.filter([e]).length && (this.buttons[e.__instanceId] = e, this.addChild(e), this.arrange())
            },
            remove: function (
                t) {
                (t = this.buttons[t.__instanceId]) && (t.stopAllActions(), t.runAction(new cc.Sequence(new cc.ScaleTo(.3, 0), new cc.RemoveSelf)), this.children.forEach(function (e) {
                    e.x > t.x && (e.stopAllActions(), e.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.MoveBy(.3, -t.width - this.margin, 0))))
                }), this.stopAllActions(), this.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.MoveBy(.3, (t.width + this.margin) / 2, 0))))
            },
            removeAll: function () {
                for (var e in this.buttons) this.buttons[e].removeFromParent()
            },
            onShow: function () {
                this.children.forEach(function (e) {
                    e.stopAllActions();
                    var t = e.scale;
                    e.setScale(0), e.runAction(new cc.ScaleTo(.7, t).easing(cc.easeBackOut()))
                })
            }
        })),
        LanguageButton = (Buttons.filter = function (e) {
            return e.filter(function (e) {
                return e && e.onMouseOver
            })
        }, Buttons.choose = function (e) {
            if (0 !== (e = Buttons.filter(e)).length) return e[Math.floor(Math.random() * e.length)]
        }, Buttons.remove = function (e) {
            var t;
            e.parent instanceof Buttons && e.parent.buttons[e.__instanceId] ? 1 < (t = e.parent).children.length && t.remove(e) : e.removeFromParent()
        }, cleverapps.styles.Buttons = {
            margin: {
                x: 20
            },
            padding: {
                x: 70,
                y: 60
            }
        }, cleverapps.UI.Button.extend({
            ctor: function (e, t) {
                this.language = e, this.callback = t;
                e = cleverapps.styles.LanguageButton;
                this._super({
                    type: {
                        button_png: bundles.buttons.frames.button_png,
                        button_on_png: bundles.buttons.frames.button_on_png,
                        button_off_png: bundles.buttons.frames.button_on_png
                    },
                    text: this.language,
                    textOff: "%%" + this.language,
                    icons: {
                        "%%": bundles.checkbox.frames.check_mark_png
                    },
                    width: e.width,
                    height: e.height,
                    onClicked: this.onClicked.bind(this)
                }), this.isCurrentLanguage() && this.disable()
            },
            onClicked: function () {
                this.callback(this.language), this.disable()
            },
            isCurrentLanguage: function () {
                return cleverapps.settings.language === this.language
            },
            updateEnabled: function () {
                this.isCurrentLanguage() ? this.disable() : this.enable()
            }
        })),
        AboutWindow = (cleverapps.styles.LanguageButton = {
            width: 260,
            height: 100
        }, Window.extend({
            onWindowLoaded: function () {
                var e = [{
                    button: "AboutWindow.terms",
                    url: Terms.TERMS_URL,
                    text: "undefined" != typeof termsText && termsText
                }, {
                    button: "AboutWindow.privacy",
                    url: Terms.PRIVACY_URL,
                    text: "undefined" != typeof privacyText && privacyText
                }].map(function (e) {
                    return new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.button_green,
                        text: e.button,
                        onClicked: function () {
                            cleverapps.platform.oneOf(Wechat) ? new PrivacyWindow(e.button, e.text) : window.open(e.url, "_blank")
                        },
                        width: cleverapps.styles.AboutWindow.button.width
                    })
                }),
                    e = new cleverapps.Layout(e, {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: cleverapps.styles.AboutWindow.button.margin
                    }),
                    t = cleverapps.UI.generateTTFText("AboutWindow.text", cleverapps.styles.FONTS.WINDOW_TEXT, {
                        version: cleverapps.config.version,
                        gameTitle: Messages.get(cleverapps.config.title)
                    }),
                    t = (t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), cleverapps.UI.wrapWithPadding(t, cleverapps.styles.AboutWindow.text.padding)),
                    t = new cleverapps.Layout([t, e], {
                        direction: cleverapps.UI.VERTICAL
                    });
                this._super({
                    title: "AboutWindow.title",
                    name: "aboutwindow",
                    content: t
                })
            }
        })),
        PrivacyWindow = (cleverapps.styles.AboutWindow = {
            text: {
                padding: {
                    left: 50,
                    right: 50,
                    top: 80,
                    bottom: 80
                }
            },
            button: {
                width: 450,
                margin: 200
            }
        }, Window.extend({
            onWindowLoaded: function (e, t) {
                this._super({
                    title: e,
                    name: "privacywindow",
                    content: this.createContent(this.splitTextIntoChunks(t)),
                    foreground: bundles.windows.frames.window_foreground_png,
                    noPadding: !0
                })
            },
            splitTextIntoChunks: function (e) {
                for (var t = e.split("\n"), s = [], i = "", n = 0; n < t.length; n++) 1e3 <= (i += t[n]).length ? (s.push(i), i = "") : i += "\n";
                return i && s.push(i), s
            },
            createContent: function (e) {
                var t = cleverapps.styles.PrivacyWindow,
                    e = e.map(function (e) {
                        e = cleverapps.UI.__generateNotLocalizedText(e, cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);
                        return e.setDimensions(t.text.width, 0), e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT), e
                    }),
                    e = new cleverapps.Layout(e, {
                        margin: 0,
                        direction: cleverapps.Layout.VERTICAL
                    }),
                    e = new cleverapps.UI.ScrollView(e, {
                        direction: cleverapps.UI.ScrollView.DIR_VERTICAL
                    });
                return e.setContentSize2(t), e.setBarPadding(t.scroll.barPadding), e.scrollTo(
                    cleverapps.UI.ScrollView.SCROLLS.UPPER_LEFT), cleverapps.UI.wrapWithPadding(e, t.scroll.padding)
            }
        })),
        SettingsWindow = (cleverapps.styles.PrivacyWindow = {
            width: 2e3,
            height: 900,
            text: {
                width: 1900
            },
            scroll: {
                padding: {
                    x: 85,
                    top: 136,
                    bottom: 38,
                    left: 20,
                    right: 20
                },
                barPadding: {
                    cornerPadding: 20,
                    sidePadding: 40
                }
            }
        }, Window.extend({
            onWindowLoaded: function () {
                var e, t, s = [],
                    i = [],
                    n = (cleverapps.flags.noinvites || s.push(this.createInviteButton()), cleverapps.platform.oneOf(Mobage, SPMobage, GDCom, Plinga, Huzcom, Amazon, Pliega, Rustore, IOSCh, Yandex, Microsoft, Mygames, Ton, WortalPlatform, Wechat) || s.push(this.addHelpButton()), s.push(this.createCopyId()), cleverapps.userDelete.isAvailable() && s.push(this.addDeleteAccountButton()), i.push(this.addSoundIcons()), 1 < cleverapps.config.languages.length && ("merge" === cleverapps.config.type || !cleverapps.environment.isGameScene()) && i.push(this.addLanguages()), -1 === ["merge", "blocks"].indexOf(cleverapps.config.type) && Game.currentGame || !Chat.IsAvailable() || i.push(this.addSupportButton()),
                        SettingsWindow.IsExitButtonAvailable() && cleverapps.environment.isMainScene() && i.push(this.addExitButton()), Game.currentGame && void 0 === Game.currentGame.outcome && cleverapps.environment.isGameScene() && -1 !== ["match3", "tile3", "blocks"].indexOf(cleverapps.config.type) && i.push(this.addGiveUpButton()), cleverapps.styles.SettingsWindow),
                    o = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL,
                    s = this.createGroup(s),
                    i = this.createGroup(i),
                    s = new cleverapps.Layout(o ? [i, s] : [s, i], {
                        direction: o ? cleverapps.UI.VERTICAL : cleverapps.UI.HORIZONTAL,
                        align: cleverapps.UI.ALIGN_END,
                        margin: n.margin
                    }),
                    i = (cleverapps.flags.nologin || (cleverapps.social.isLoggedIn() ? cleverapps.platform.oneOf(TestPlatform) && (e = this.createLogoutButtons()) : t = this.createLoginButtons()), new cleverapps.Layout([s, t, e, this.createVersion()].filter(Boolean), {
                        direction: cleverapps.UI.VERTICAL,
                        margin: n.version.margin
                    }));
                this._super({
                    title: "SettingsWindow.title",
                    name: "settingswindow",
                    content: i,
                    styles: n.window,
                    help: cleverapps.platform.oneOf(
                        TestPlatform, FacebookCanvas, AndroidPlatform, IOS, Wechat) ? function () {
                            new AboutWindow
                        } : void 0
                })
            },
            getPerson: function () {
                return cleverapps.styles.SettingsWindow.person
            },
            createGroup: function (e) {
                var t = cleverapps.styles.SettingsWindow.groups,
                    e = new cleverapps.Layout(e, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: t.margin,
                        padding: t.padding
                    }),
                    t = cleverapps.UI.createScale9Sprite(bundles.windows.frames.windows_group_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY);
                return t.setContentSize(e.width, e.height), t.setPositionRound(e.width / 2, e.height / 2), e.addChild(t, -1), e
            },
            addGiveUpButton: function () {
                var e = cleverapps.styles.SettingsWindow;
                return new cleverapps.UI.Button({
                    type: cleverapps.styles.UI.Button.Images.button_red,
                    text: "%% GiveUp",
                    icons: {
                        "%%": bundles.buttons_main.frames.giveup_icon
                    },
                    onClicked: function () {
                        this.close(), cleverapps.meta.whenFreeFocus(function () {
                            cleverapps.scenes.getRunningScene().closeAction()
                        })
                    }.bind(this),
                    width: e.button.width,
                    height: e.button.height
                })
            },
            addExitButton: function () {
                var e = cleverapps.styles.SettingsWindow;
                return new cleverapps.UI.Button({
                    type: cleverapps.styles.UI.Button.Images.button_red,
                    text: "%% Exit",
                    icons: {
                        "%%": bundles.buttons_main.frames.exit_icon
                    },
                    onClicked: function () {
                        cleverapps.meta.distract({
                            focus: "ConfirmExitWindow",
                            action: function (e) {
                                new ConfirmExitWindow({
                                    action: cleverapps.platform.closeApplication
                                }), cleverapps.meta.onceNoWindowsListener = e
                            }
                        }), this.close()
                    }.bind(this),
                    width: e.button.width,
                    height: e.button.height
                })
            },
            addHelpButton: function () {
                var e = cleverapps.styles.SettingsWindow;
                return new cleverapps.UI.Button({
                    text: "%% Help",
                    icons: {
                        "%%": bundles.buttons_main.frames.community_icon
                    },
                    onClicked: function () {
                        cleverapps.platform.showOfficialPage()
                    },
                    width: e.button.width,
                    height: e.button.height,
                    type: cleverapps.styles.UI.Button.Images.button_blue
                })
            },
            addSupportButton: function () {
                var e = cleverapps.styles.SettingsWindow;
                return new cleverapps.UI.Button({
                    text: "%% SupportButton",
                    icons: {
                        "%%": bundles.buttons_main.frames.support_icon
                    },
                    onClicked: function () {
                        cleverapps.meta.distract({
                            focus: "ChatScene",
                            action: function (e) {
                                this.close(), cleverapps.scenes.replaceScene(new ChatScene(cleverapps.chat), e)
                            }.bind(this)
                        })
                    }.bind(this),
                    width: e.button.width,
                    height: e.button.height,
                    type: cleverapps.styles.UI.Button.Images.button_blue,
                    mark: cleverapps.chat.hasUnread
                })
            },
            addLanguages: function () {
                var e = cleverapps.styles.SettingsWindow;
                return new cleverapps.UI.Button({
                    text: "%% Language",
                    icons: {
                        "%%": bundles.buttons_main.frames.language_icon,
                        "##": bundles.buttons_main.frames.support_icon
                    },
                    onClicked: function () {
                        new LanguagesWindow, this.close()
                    }.bind(this),
                    width: e.button.width,
                    height: e.button.height
                })
            },
            addSoundIcons: function () {
                var e = [{
                    icons: {
                        "%%": bundles.buttons_main.frames.sound_on_png,
                        "^^": bundles.buttons_main.frames.sound_off_png
                    },
                    toggle: cleverapps.settings.toggleSound.bind(cleverapps.settings),
                    settings: "sound",
                    listener: "onChangeSoundListener"
                }, {
                    icons: {
                        "%%": bundles.buttons_main.frames.music_on_png,
                        "^^": bundles.buttons_main.frames.music_off_png
                    },
                    toggle: cleverapps.settings.toggleMusic.bind(cleverapps.settings),
                    settings: "music",
                    listener: "onChangeMusicListener"
                }],
                    s = cleverapps.styles.SettingsWindow,
                    i = this.getButtonWidth(e),
                    e = e.map(function (e) {
                        var t = new cleverapps.UI.Button({
                            text: "%%",
                            textOff: "^^",
                            icons: e.icons,
                            width: i,
                            height: s.button.height,
                            onClicked: e.toggle
                        });
                        return t.setBright(cleverapps.settings[e.settings]), cleverapps.settings[e.listener] = t.createListener(function () {
                            t.setBright(cleverapps.settings[e.settings])
                        }), t
                    });
                return new cleverapps.Layout(e, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: s.button.margin
                })
            },
            getButtonWidth: function (e) {
                var t = cleverapps.styles.SettingsWindow.button;
                return 3 === e.length ? t.width3 : 2 === e.length ? t.width2 : t.width
            },
            createLoginButtons: function () {
                var t = cleverapps.styles.SettingsWindow,
                    s = cleverapps.social.getCodes(),
                    e = s.map(function (e) {
                        return new LoginButton({
                            multiSocials: 1 < s.length,
                            width: t.loginButton.width,
                            height: t.loginButton.height,
                            source: e,
                            onSuccess: this.closeWindow.bind(this)
                        })
                    }.bind(this)),
                    i = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL,
                    n = cleverapps.UI.generateOnlyText("SettingsWindow.SignIn.Footnote", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT),
                    e = (n.setOpacity(170), n.fitTo(cleverapps.styles.SettingsWindow.button.width), new cleverapps.GridLayout(e, {
                        margin: t.loginButton.margin,
                        direction: cleverapps.UI.VERTICAL,
                        columns: i ? 1 : 2
                    }));
                return new cleverapps.Layout([n, e], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: t.loginButton.text.margin
                })
            },
            createLogoutButtons: function () {
                var e = cleverapps.styles.SettingsWindow;
                return new cleverapps.UI.Button({
                    type: cleverapps.styles.UI.Button.Images.button_blue,
                    width: e.loginButton.width,
                    height: e.loginButton.height,
                    text: "%% SettingsWindow.Logout",
                    icons: {
                        "%%": bundles.buttons_main.frames.exit_icon
                    },
                    onClicked: function () {
                        cleverapps.social.logout(), this.closeWindow()
                    }.bind(this)
                })
            },
            createInviteButton: function () {
                var e = cleverapps.styles.SettingsWindow;
                return new InviteButton({
                    width: e.button.width,
                    height: e.button.height,
                    type: cleverapps.styles.UI.Button.Images.button_blue,
                    onSuccess: this.closeWindow.bind(this)
                })
            },
            createCopyId: function () {
                var e = cleverapps.styles.SettingsWindow.button;
                return new cleverapps.UI.Button({
                    type: cleverapps.styles.UI.Button.Images.button_blue,
                    width: e.width,
                    height: e.height,
                    text: "%% SettingsWindow.UserID.copy",
                    icons: {
                        "%%": bundles.buttons_main.frames.copyid_icon
                    },
                    onClicked: function () {
                        cleverapps.copyToClipboard(cleverapps.platform.getUserID(), function () {
                            cleverapps.notification.create("SettingsWindow.UserID.copied")
                        })
                    }
                })
            },
            createVersion: function () {
                var e = cleverapps.UI.generateOnlyText("v" + cleverapps.config.version, cleverapps.styles.FONTS.SETTINGS_WINDOW_ID_TEXT || cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);
                return e.fitTo(cleverapps.styles.SettingsWindow.button.width), e.setOpacity(170), e
            },
            addDeleteAccountButton: function () {
                var e = cleverapps.styles.SettingsWindow.button;
                return new cleverapps.UI.Button({
                    type: cleverapps.styles.UI.Button.Images.button_blue,
                    text: "%% DeleteAccount",
                    icons: {
                        "%%": bundles.buttons_main.frames.delete_icon
                    },
                    onClicked: function () {
                        new DeleteAccountWindow
                    },
                    width: e.width,
                    height: e.height
                })
            },
            closeWindow: function () {
                this.closed || this.close()
            },
            listBundles: function () {
                return ["social_buttons"]
            }
        })),
        LanguagesWindow = (SettingsWindow.IsExitButtonAvailable = function () {
            return -1 !== [cc.sys.OS_ANDROID].indexOf(cc.sys.os) && cc.sys.isNative && cleverapps.platform.closeApplication
        }, cleverapps.styles.SettingsWindow = {
            margin: 20,
            groups: {
                margin: 19,
                padding: {
                    x: 30,
                    y: 30
                }
            },
            button: {
                margin: 19,
                width: 563,
                width2: 269,
                width3: 175,
                height: 125
            },
            loginButton: {
                height: 100,
                width: 475,
                margin: {
                    x: 80,
                    y: 20
                },
                text: {
                    margin: 7
                }
            },
            version: {
                margin: 10
            }
        }, Window.extend({
            onWindowLoaded: function () {
                this._super({
                    title: "Language",
                    name: "languageswindow",
                    content: this.createContent()
                })
            },
            createContent: function () {
                var e = cleverapps.styles.LanguagesWindow,
                    t = 3,
                    s = (cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && (t = 2), this.buttonsPerLanguage = {}, cleverapps.config.languages.map(function (e) {
                        var t = new LanguageButton(e,
                            this.buttonClicked.bind(this));
                        return this.buttonsPerLanguage[e] = t
                    }, this));
                return new cleverapps.GridLayout(s, {
                    columns: t,
                    margin: {
                        x: e.margin,
                        y: e.margin
                    }
                })
            },
            buttonClicked: function (t) {
                var s = cleverapps.settings.language;
                t !== s && cleverapps.meta.distract({
                    focus: "LanguageChanged",
                    action: function (e) {
                        cleverapps.settings.setLanguage(t), cleverapps.settings.updateDependents(), this.buttonsPerLanguage[s].updateEnabled(), Messages.preload(t, function () {
                            this.setTitle("Language"), cleverapps.environment.isGameScene() && "merge" !== cleverapps.config.type ? cleverapps.lives ? (e(), this.close()) : cleverapps.meta.wantsToPlay(e) : (this.close(), cleverapps.travelBook.gotoMainScene(e))
                        }.bind(this))
                    }.bind(this)
                })
            }
        })),
        RateWindow = (cleverapps.styles.LanguagesWindow = {
            margin: 20
        }, Window.extend({
            onWindowLoaded: function () {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.RATE_WINDOW);
                var e = cleverapps.styles.RateWindow,
                    t = this.createContent();
                this._super({
                    content: t,
                    title: "RateWindow.title",
                    name: "ratewindow",
                    styles: cleverapps.styles.RateWindow,
                    button: {
                        width: e.button.width,
                        height: e.button.height,
                        text: "RateUs",
                        onPressed: function () {
                            this.openRateUrl(), this.close()
                        }.bind(this)
                    },
                    contentPadding: e.contentPadding
                }), this.addPerson()
            },
            getPerson: function () {
                return "hero"
            },
            addPerson: function () {
                var e = new cc.Sprite(bundles.rate_window.frames.stars_png);
                this.window.addChild(e), e.setPositionRound(cleverapps.styles.RateWindow.stars), e.setLocalZOrder(20)
            },
            createContent: function () {
                var e, t = cleverapps.styles.RateWindow,
                    s = new cc.Node,
                    i = (s.setAnchorPoint2(), s.setContentSize(t.width, t.height), cleverapps.UI.generateOnlyText("RateWindow.text", cleverapps.styles.FONTS.RATE_WINDOW_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT, {
                        gameTitle: Messages.get(cleverapps.config.title)
                    }));
                return i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), i.setDimensions(t.text.width, 0), i.fitTo(void 0, t.text.height), s.addChild(i), i.setPositionRound(t.text), bundles.rate_window.frames.text_bg_png && (t = cc.rectAddPadding(cc.rect(0, 0, s.width,
                    t.text.height), cc.padding(t.text.padding)), (e = cleverapps.UI.createScale9Sprite(bundles.rate_window.frames.text_bg_png)).setContentSize(t.width, t.height), s.addChild(e, -1), e.setPositionRound(i.x, i.y)), s
            },
            openRateUrl: function () {
                var e;
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.RATE_SEND), cleverapps.platform.canReview() ? cleverapps.platform.requestReview() : (e = cleverapps.platform.getRateUrl()) && cc.sys.openURL(e)
            },
            onClose: function () {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.RATED, !0, {
                    raw: !0
                })
            },
            listBundles: function () {
                return ["rate_window"]
            }
        })),
        RateWindowAction = (RateWindow.CanRate = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.RATED, {
                raw: !0
            });
            return !(cleverapps.flags.norest || !levels.user.checkAvailable(RateWindow.AVAILABLE) || e || cleverapps.config.wysiwygMode) && (cleverapps.platform.canReview() || cleverapps.platform.getRateUrl())
        }, function (e) {
            this.game.outcome === GameBase.OUTCOME_VICTORY && RateWindow.CanRate() ? (new RateWindow,
                cleverapps.meta.onceNoWindowsListener = e) : e()
        }),
        ConfirmExitWindow = (cleverapps.styles.RateWindow = {
            width: 650,
            height: 300,
            stars: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "top",
                    dy: 240
                }
            },
            text: {
                width: 610,
                height: 200,
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                },
                padding: {
                    x: 10,
                    y: 20
                }
            },
            button: {
                width: 300,
                height: 100
            },
            contentPadding: {
                top: 100
            }
        }, RateWindow.AVAILABLE = {
            level: 2.4
        }, "merge" === cleverapps.config.type && (RateWindow.AVAILABLE = {
            level: 6
        }), Window.extend({
            onWindowLoaded: function (e) {
                this.action = (e = e || {}).action || function () { };
                var t, s, i, n = cleverapps.styles.ConfirmExitWindow,
                    o = this.createText(e),
                    e = (bundles.confirmexit_window.jsons.confirmexit_window_json && (t = this.createAnimation()), e.reward && (s = new RewardsListComponent(e.reward, {
                        font: cleverapps.styles.FONTS.WINDOW_TEXT,
                        margin: n.reward.margin
                    })), void 0 !== BreakViews && Game.currentGame && cleverapps.environment.isGameScene() && (i = new BreakViews), new cleverapps.Layout([t, o, i, s], {
                        direction: cleverapps.UI.VERTICAL,
                        margin: n.margin,
                        padding: n.padding
                    }));
                this._super({
                    closeByBackButton: !0,
                    title: "ConfirmExitWindow.title",
                    name: "confirmexitwindow",
                    content: e,
                    buttons: this.getButtons()
                })
            },
            getPerson: function () {
                return {
                    role: "hero",
                    emotion: "sad"
                }
            },
            createAnimation: function () {
                var e = cleverapps.styles.ConfirmExitWindow,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize(e.animation), new cleverapps.Spine(bundles.confirmexit_window.jsons.confirmexit_window_json));
                return t.addChild(s), s.hasAnimation("open") ? s.setAnimationAndIdleAfter("open", "idle") : s.setAnimation(0, "sad", !0), s.setPositionRound(e.animation), t
            },
            createText: function (e) {
                var t = cleverapps.styles.ConfirmExitWindow,
                    e = e.text || "AreYouSure",
                    e = (cleverapps.environment.isGameScene() && "merge" !== cleverapps.config.type && (cleverapps.lives && (e = "ConfirmExitWindow.message"), Game.currentGame.level.episode.isBonusRound() && (e = "ConfirmExitWindow.BonusRound.message")), cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.WINDOW_TEXT));
                return e.setAnchorPoint2(), e.setDimensions(t.text.width, 0), e.setHorizontalAlignment(
                    cc.TEXT_ALIGNMENT_CENTER), e.fitTo(void 0, t.text.height), e
            },
            getButtons: function () {
                var e = cleverapps.styles.ConfirmExitWindow,
                    t = new cleverapps.UI.Button({
                        text: "PlayOn",
                        onClicked: function () {
                            this.close()
                        }.bind(this),
                        width: e.button.width,
                        height: e.button.height
                    });
                return [new cleverapps.UI.Button({
                    type: cleverapps.styles.UI.Button.Images.button_red,
                    text: "Exit",
                    onClicked: function () {
                        this.closeAnimationCallbacks.push(this.action), this.close()
                    }.bind(this),
                    width: e.button.width,
                    height: e.button.height
                }), t]
            },
            listBundles: function () {
                return ["confirmexit_window"]
            }
        })),
        NewLeagueWindow = (cleverapps.styles.ConfirmExitWindow = {
            margin: 20,
            padding: {
                bottom: 40
            },
            animation: {
                width: 400,
                height: 400,
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            text: {
                width: 500
            },
            button: {
                width: 300,
                height: 100
            },
            reward: {
                margin: {
                    x: 100
                }
            }
        }, Window.extend({
            onWindowLoaded: function () {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.NEW_LEAGUE);
                var e = cleverapps.styles.NewLeagueWindow,
                    t = this.createText(),
                    s = new cc.Node;
                s.setAnchorPoint2(), s.setContentSize2(e),
                    s.addChild(t), t.setPositionRound(s.width / 2, s.height / 2), this._super({
                        title: "NewLeagueWindow.Title",
                        name: "newleaguewindow",
                        content: s,
                        closeButton: !1,
                        fireworks: !0,
                        button: {
                            width: e.button.width,
                            height: e.button.height,
                            text: "OK",
                            onClicked: this.close.bind(this)
                        }
                    })
            },
            getPerson: function () {
                return {
                    role: "hero",
                    emotion: "happy"
                }
            },
            createText: function () {
                var e = cleverapps.styles.NewLeagueWindow,
                    t = levels.user.league,
                    t = cleverapps.UI.generateOnlyText("NewLeagueWindow.text", cleverapps.styles.FONTS.WINDOW_TEXT, {
                        league: Messages.get("League" + t)
                    });
                return t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(e.width, 0), t.fitTo(void 0, e.height), t
            }
        })),
        NewLeagueWindowAction = function (e) {
            levels.user.isLeagueChanged && !cleverapps.flags.norest && this.game.outcome === GameBase.OUTCOME_VICTORY ? (delete levels.user.isLeagueChanged, cleverapps.meta.compound(e, [function (e) {
                new NewLeagueWindow, cleverapps.meta.onceNoWindowsListener = e
            }, function (e) {
                new LeadersWindow, cleverapps.meta.onceNoWindowsListener = e
            }])) : e()
        },
        LeadersLoading = (cleverapps.styles.NewLeagueWindow = {
            width: 550,
            height: 500,
            button: {
                width: 280,
                height: 110
            }
        }, cc.Node.extend({
            ctor: function () {
                this._super();
                var e = cleverapps.styles.WaitWindow,
                    t = this.loading = new cleverapps.Spine(bundles.main.jsons.wait_json, 1.5);
                t.setAnimation(0, "idle", !0), this.addChild(t), e.text && ((t = this.loadingText = cleverapps.UI.generateTTFText(Messages.get("Loading") || "Loading", cleverapps.styles.FONTS.WINDOW_TEXT)).setPosition(0, e.text.y), this.addChild(t))
            },
            remove: function () {
                this.loading.runAction(new cc.RemoveSelf), this.loadingText && this.loadingText.removeFromParent()
            }
        })),
        LeadersWindow = Window.extend({
            onWindowLoaded: function () {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEADERS_WINDOW_OPEN), this.currentLeague = levels.user.league, this.leaguesLeaders = {}, this.content = this.createContent(), this.addArrows(), this._super.call(this, {
                    name: "leaderswindow",
                    content: this.content,
                    title: "League" + levels.user.league
                }), this.loadData(), this.updateArrows()
            },
            addArrows: function () {
                var e = cleverapps.styles.LeadersWindow;
                this.decLeagueButton = new cleverapps.UI.Button({
                    type: {
                        button_png: bundles.main.frames.league_arrow_png,
                        button_on_png: bundles.main.frames.league_arrow_png
                    },
                    onClicked: this.decLeague.bind(this)
                }), this.decLeagueButton.baseScaleX = -1, this.decLeagueButton.baseScaley = 1, this.decLeagueButton.setPositionRound(e.arrows.dec), this.decLeagueButton.setScaleX(-1), this.decLeagueButton.setLocalZOrder(1), this.content.addChild(this.decLeagueButton), this.incLeagueButton = new cleverapps.UI.Button({
                    type: {
                        button_png: bundles.main.frames.league_arrow_png,
                        button_on_png: bundles.main.frames.league_arrow_png
                    },
                    onClicked: this.incLeague.bind(this)
                }), this.incLeagueButton.setPositionRound(e.arrows.inc), this.incLeagueButton.setLocalZOrder(1), this.content.addChild(this.incLeagueButton)
            },
            createHead: function () {
                var e = cleverapps.styles.LeadersWindow,
                    t = cleverapps.UI.generateOnlyText("LeadersWindow.rank", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT),
                    s = (t.setHorizontalAlignment(
                        cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(e.head.text.width, 0), cleverapps.UI.generateOnlyText("LeadersWindow.player", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT)),
                    i = (s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.setDimensions(e.head.text.width, 0), cleverapps.UI.generateOnlyText("LeadersWindow.rating", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT));
                return i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), i.setDimensions(e.head.text.width, 0), new cleverapps.Layout([t, s, i], {
                    margin: e.margin,
                    direction: cleverapps.UI.HORIZONTAL
                })
            },
            createContent: function () {
                var e = cleverapps.styles.LeadersWindow,
                    t = this.createHead();
                return this.table = this.createTable(), new cleverapps.Layout([t, this.table], {
                    margin: e.margin,
                    direction: cleverapps.UI.VERTICAL,
                    padding: e.padding
                })
            },
            loadData: function () {
                this.loading = new LeadersLoading, this.loading.setPositionRound(this.content.width / 2, this.content.height / 2), this.content.addChild(this.loading), this.loading.setVisible(!1), this.loading.runAction(new cc.Sequence(
                    new cc.DelayTime(.3), new cc.Show));
                var e = cleverapps.accumulate(300, this.createListener(function (t) {
                    this.loading.removeFromParent(), this.loading = void 0, this.leaguesLeaders = {};
                    for (var s = 0; s < t.length; s++) this.leaguesLeaders[t[s].leagueId] = JSON.parse(t[s].data), this.leaguesLeaders[t[s].leagueId].forEach(function (e) {
                        e.league = t[s].leagueId
                    });
                    for (s = 0; s < this.getAmountLeagues(); s++) this.leaguesLeaders[s] || (this.leaguesLeaders[s] = []);
                    this.updateArrows(), this.updateTable()
                }.bind(this))),
                    t = "/leaders/" + cleverapps.settings.language + "/";
                cleverapps.config.debugMode && (t = "https://wordsoup.labsystech.ru/wordsoup-rest" + t), cleverapps.RestClient.get(t, {}, e, function () {
                    cleverapps.notification.create("LeadersLoadFailed")
                }, {
                    ignoreNoRest: cleverapps.config.importMode
                })
            },
            decLeague: function () {
                0 < this.currentLeague && (this.currentLeague--, this.updateArrows(), this.updateTable(), this.updateTitle())
            },
            incLeague: function () {
                this.currentLeague < this.getAmountLeagues() - 1 && (this.currentLeague++, this.updateArrows(),
                    this.updateTable(), this.updateTitle())
            },
            getAmountLeagues: function () {
                var e = 1;
                return e = cleverapps.config.leagues ? cleverapps.config.leagues.length : e
            },
            updateArrows: function () {
                this.decLeagueButton && this.decLeagueButton.setVisible(!this.loading && 0 < this.currentLeague), this.incLeagueButton && this.incLeagueButton.setVisible(!this.loading && this.currentLeague < this.getAmountLeagues() - 1)
            },
            updateTitle: function () {
                this.window && this.setTitle("League" + this.currentLeague)
            },
            getTop: function () {
                var e = this.leaguesLeaders[this.currentLeague] || [];
                for (this.removePlayerFromTop(e), levels.user.league === this.currentLeague && this.addPlayerToTop(e); e.length > LeadersWindow.TOP_LIMIT && e[e.length - 1].id !== cleverapps.platform.getUserID();) e.pop();
                return e
            },
            updateTable: function () {
                var s = this.currentLeague;
                this.runAction(new cc.Sequence(new cc.DelayTime(.01), new cc.CallFunc(function () {
                    var e, t;
                    s === this.currentLeague && (e = this.table.getPosition(), t = this.table.getParent(), this.table.removeFromParent(), this.table = this.createTable(),
                        t.addChild(this.table), this.table.setPositionRound(e))
                }.bind(this))))
            },
            removePlayerFromTop: function (e) {
                for (var t = 0; t < e.length; t++)
                    if (e[t].id === cleverapps.platform.getUserID()) {
                        e.splice(t, 1);
                        break
                    }
            },
            addPlayerToTop: function (e) {
                e.push({
                    id: cleverapps.platform.getUserID(),
                    rating: levels.user.getVirtualLevel(),
                    name: cleverapps.friends.getPlayer().name,
                    avatar: cleverapps.friends.getPlayer().avatar,
                    you: !0,
                    league: levels.user.league
                }), e.sort(function (e, t) {
                    return e.rating === t.rating ? e.id === cleverapps.platform.getUserID() ? -1 : t.id === cleverapps.platform.getUserID() ? 1 : 0 : t.rating - e.rating
                })
            },
            createTable: function () {
                for (var e = this.getTop(), t = [], s = 0; s < e.length; s++) {
                    var i = {
                        text: e[s].name,
                        place: s + 1,
                        id: e[s].id,
                        avatar: {
                            id: e[s].id,
                            avatar: e[s].avatar
                        },
                        player: e[s].id === cleverapps.platform.getUserID(),
                        amount: e[s].rating
                    };
                    t.push(i)
                }
                return cleverapps.leagueLeadersTable.resetResults("leadersWindow"), cleverapps.leagueLeadersTable.createTableView({
                    id: "leadersWindow",
                    data: t,
                    rowConstructor: cleverapps.LeadersRow
                })
            }
        }),
        FakeLoginWindow = (cleverapps.styles.LeadersWindow = {
            margin: 20,
            head: {
                text: {
                    width: 200
                }
            },
            padding: {
                x: -30
            },
            arrows: {
                dec: {
                    x: {
                        align: "left",
                        dx: -45
                    },
                    y: {
                        align: "center",
                        dy: -30
                    }
                },
                inc: {
                    x: {
                        align: "right",
                        dx: 45
                    },
                    y: {
                        align: "center",
                        dy: -30
                    }
                }
            },
            window: {
                decors: {}
            }
        }, LeadersWindow.TOP_LIMIT = 100, Window.extend({
            onWindowLoaded: function (e) {
                var t = cleverapps.styles.FakeLoginWindow;
                this.userId = void 0, this.onLoginListener = cleverapps.once(e), this._super({
                    content: this.createContent(),
                    name: "FakeLoginWindow",
                    title: "FakeLoginWindow.title",
                    styles: t,
                    button: {
                        text: "FakeLoginWindow.Login",
                        width: t.loginButton.width,
                        height: t.loginButton.height,
                        onPressed: function () {
                            this.userId = this.textBox.getString(), this.close()
                        }.bind(this)
                    }
                })
            },
            createContent: function () {
                var i = cleverapps.styles.FakeLoginWindow,
                    e = this.textBox = new cc.EditBox(cc.size(i.textBox.width, i.textBox.height), new cc.Scale9Sprite(bundles.windows.frames.editbox_bg_png), !0),
                    t = (e.setInputMode(cc.EDITBOX_INPUT_MODE_SINGLELINE), e.setMaxLength(30), e.stayOnTop(!0), e.setTouchEnabled(),
                        e.setFontColor(cleverapps.styles.COLORS.WHITE), e.setFont(cleverapps.UI.getFontName(), cleverapps.styles.FONTS.WINDOW_TEXT.size), cleverapps.UI.generateOnlyText("FakeLoginWindow.CustomID", cleverapps.styles.FONTS.WINDOW_TEXT)),
                    s = cleverapps.UI.generateOnlyText("FakeLoginWindow.ChooseUser", cleverapps.styles.FONTS.WINDOW_TEXT),
                    n = cleverapps.values(TestSocial.USERS).map(function (e) {
                        var t = cleverapps.platform.getUserID() === e.id ? cleverapps.styles.UI.Button.Images.button_green : cleverapps.styles.UI.Button.Images.button_blue;
                        return new cleverapps.UI.Button({
                            type: t,
                            text: e.name,
                            width: i.buttons.width,
                            height: i.buttons.height,
                            onClicked: function () {
                                this.userId = e.id, this.close()
                            }.bind(this)
                        })
                    }.bind(this)),
                    o = cleverapps.values(TestSocial.USERS).map(function (e) {
                        var t = new cc.Scale9Sprite(bundles.windows.frames.ads_bg),
                            s = (t.setContentSize2(i.buttons.width, i.buttons.height), new cc.Sprite(bundles.windows.frames["ads_" + e.name.toLowerCase()])),
                            e = (s.setPositionRound({
                                x: {
                                    align: "left",
                                    dx: i.adsInfo.padding
                                },
                                y: {
                                    align: "center"
                                }
                            }), s.setScale(.7), cleverapps.UI.generateOnlyText({
                                alpha: "Rewarded ads enabled",
                                beta: "Rewarded and interstitial",
                                gamma: "No ads"
                            }[e.name.toLowerCase()], cleverapps.styles.FONTS.SMALL_TEXT));
                        return e.setDimensions(i.buttons.width - i.adsInfo.offset - i.adsInfo.padding, 0), e.fitTo(void 0, i.buttons.height), e.setPositionRound({
                            x: {
                                align: "left",
                                dx: i.adsInfo.offset + i.adsInfo.padding
                            },
                            y: {
                                align: "center"
                            }
                        }), t.addChild(s), t.addChild(e), t
                    }),
                    a = cleverapps.UI.generateOnlyText("FakeLoginWindow.CurrentUserID", cleverapps.styles.FONTS.WINDOW_TEXT, {
                        id: cleverapps.platform.getUserID()
                    }),
                    n = (cleverapps.UI.onClick(a, function () {
                        cleverapps.copyToClipboard(cleverapps.platform.getUserID())
                    }), new cleverapps.Layout(n, {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: i.buttons.margin
                    })),
                    o = new cleverapps.Layout(o, {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: i.buttons.margin
                    });
                return new cleverapps.Layout([a, s, n, o, t, e], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: i.layout.margin
                })
            },
            onClose: function () {
                this.onLoginListener(
                    this.userId)
            }
        })),
        projects = {
            woodenblock: {
                business: "zareef",
                type: "blocks",
                meta: "simple",
                orientation: "vertical",
                staticUrl: "https://woodenblock.gcdn.co/publish/html5/",
                ruStaticUrl: "https://dd192afc-4149-4ac7-abd1-16796f3778e7.selcdn.net/publish/html5/",
                deployment: "https://woodenblock.cleverappssg.com",
                title: "BlockBuster Adventures",
                levelsPath: "res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                ui: "riddles",
                personsMinimal: {
                    hero: "fairy_dwarf_violet_minimal"
                },
                persons: {
                    main: {
                        hero: "fairy_dwarf_violet"
                    }
                },
                features: ["boosters_before", "highscore", "prolongation"],
                stand: {
                    staticUrl: "https://woodenblock.labsystech.ru/publish/html5-staging/",
                    deployment: "https://woodenblock.labsystech.ru"
                },
                instant: {
                    appId: "1440383360100912",
                    rewarded: "1440418196764095",
                    interstitial: "1440418426764072",
                    banner: "1515818675890713",
                    groupId: "BlockBusterPuzzle"
                },
                android: {
                    business: "slimmerbits",
                    package: "com.cleverapps.woodenblock",
                    unityGameId: "",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/3666316605"
                    },
                    yandexAds: {
                        rewarded: "R-M-5887510-1"
                    }
                },
                yandex: {
                    debug: !0,
                    appId: "230625"
                },
                vk: {
                    shortname: "woodenblockgame",
                    appId: "51647351",
                    groupId: "woodenblockofficial"
                },
                ok: {
                    shortname: "woodenblock",
                    appId: "512001974110",
                    appKey: "CPFQBDLGDIHBABABA",
                    groupId: "70000002497739"
                },
                gdcom: {
                    appId: "b2cc0cd4b40a40dd84b8d452e7c5d6f8"
                },
                msstart: {
                    name: "BlockBuster Puzzle",
                    appId: "9P83G3B4H340",
                    packageId: "CleverAppsPteLtd.BlockBusterPuzzleStartGame",
                    gameUrl: "https://woodenblock.cleverappssg.com/publish/html5/msstart/"
                },
                xsolla: {
                    appId: "226855",
                    loginProjectId: "ec66f425-2295-4d72-8466-6370688f70dc"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                crazy: {
                    name: "wooden-block",
                    xsolla: {
                        appId: "250904"
                    }
                },
                ios: {
                    business: "cleverapps",
                    package: "com.cleverapps.woodenblock",
                    id: "6449209833",
                    macos: !0,
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/5636205520"
                    }
                }
            },
            zenmatch: {
                business: "cleverapps",
                type: "tile3",
                meta: "simple",
                orientation: "horizontal",
                staticUrl: "https://zenmatch.gcdn.co/publish/html5/",
                ruStaticUrl: "https://7af556be-8dd8-47c3-8922-8195e8e96877.selcdn.net/publish/html5/",
                deployment: "https://zenmatch.cleverappssg.com",
                title: "Tile Guru: Match Fun",
                levelsPath: "cleverapps/res/zenmatch/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                lives: !0,
                ui: "riddles",
                personsMinimal: {
                    hero: "fairy_dwarf_violet_minimal"
                },
                persons: {
                    main: {
                        hero: "fairy_dwarf_violet"
                    }
                },
                features: ["boosters_before", "tilegame", "letter_tournament", "achievements"],
                adjust: {
                    token: "mnuoyou5g7b4",
                    purchaseToken: "aymu9o"
                },
                stand: {
                    staticUrl: "https://zenmatch.labsystech.ru/publish/html5-staging/",
                    deployment: "https://zenmatch.labsystech.ru"
                },
                instant: {
                    appId: "758370645292118",
                    rewarded: "790892115373304",
                    banner: "790892408706608",
                    interstitial: "790892408706608",
                    groupId: "tilegurucommunity"
                },
                android: {
                    business: "slimmerbits",
                    package: "com.cleverapps.zenmatch",
                    unityGameId: "",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/6442020737"
                    },
                    yandexAds: {
                        rewarded: "R-M-5887558-1"
                    }
                },
                ok: {
                    shortname: "tileguru",
                    appId: "512001589692",
                    appKey: "CNLCENKGDIHBABABA",
                    groupId: "70000002267306",
                    stand: {
                        appId: "512001544266",
                        appKey: "CLEBJMKGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "tileguru",
                    appId: "51614608",
                    groupId: "tileguru_group",
                    stand: {
                        appId: ""
                    }
                },
                draugiem: {
                    appId: "15021150",
                    groupId: "tilegurucommunity"
                },
                gdcom: {
                    debug: !0,
                    appId: "a86369bfd41a452ebd6f24ab30333ceb"
                },
                yandex: {
                    debug: !0,
                    appId: "230597"
                },
                fotostrana: {
                    appId: "tileguru",
                    privateKey: "57d0a043c1773f6ec065fda7ce7074cf",
                    groupId: "353790"
                },
                mm: {
                    appId: "787786",
                    privateKey: "3a1c90eaad69820caac0f6831e40cb6e",
                    groupId: "tileguru",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "12027091",
                    groupId: "32881491"
                },
                microsoft: {
                    iap: {
                        testProduct: {
                            id: "9PGQ42CJ3TB6",
                            debugId: "9PN9145P3NF7"
                        },
                        gold500: "9PJ2J2BKJ89Z",
                        gold1800: "9P24QFHJFDTB",
                        gold3800: "9PCPVWF6JT9G",
                        gold6000: "9N08GBFNQPRG",
                        gold25000: "9N8JLLLQ88L7",
                        starterPack0: "9NH4KKQCZ65T",
                        starterPack: "9PGRZP03MWZQ",
                        starterPack2: "9NNRKHBND1JT"
                    }
                },
                kongregate: {
                    appId: "324225",
                    name: "tile-guru-match-fun"
                },
                xsolla: {
                    appId: "212487",
                    loginProjectId: "9692d36f-99d1-406e-be65-9ca23f4a1725"
                },
                msstart: {
                    name: "Tile Guru",
                    appId: "9PLZMG4B7Q7V",
                    packageId: "CleverAppsPteLtd.TileGuruStartGame",
                    gameUrl: "https://zenmatch.cleverappssg.com/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                crazy: {
                    name: "tile-guru-match-fun",
                    xsolla: {
                        appId: "243559"
                    }
                },
                ios: {
                    business: "cleverapps",
                    package: "com.cleverapps.zenmatch",
                    id: "6449207675",
                    macos: !0,
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/1988889966"
                    }
                }
            },
            mergecraft: {
                business: "cleverapps",
                type: "merge",
                meta: "none",
                orientation: "horizontal",
                staticUrl: "https://mergecraft.gcdn.co/publish/html5/",
                ruStaticUrl: "https://41adb578-a6e5-4c17-b011-474a44ca6796.selcdn.net/publish/html5/",
                googleAnalytics: {
                    measurementId: "G-V5D6JQLDBG"
                },
                fbPixelId: "321147649405995",
                deployment: "https://mergecraft.cleverappssg.com",
                title: "Mergest Kingdom: merge puzzle",
                levelsPath: "cleverapps/res/mergecraft/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                energy: !0,
                ui: "wooden",
                personsMinimal: {
                    hero: "mergecraft_dwarf_hogrider_minimal",
                    worker: "mergecraft_worker_gingerbeard_minimal",
                    dwarf: "mergecraft_dwarf_hogrider_minimal",
                    king: "mergecraft_king_mcarthur_minimal",
                    keeper: "mergecraft_keeper_zafira_minimal"
                },
                persons: {
                    main: {
                        hero: "mergecraft_dwarf_hogrider_redesign",
                        narrator: "mergecraft_worker_gingerbeard_redesign",
                        worker: "mergecraft_worker_gingerbeard_redesign",
                        dwarf: "mergecraft_dwarf_hogrider_redesign",
                        king: "mergecraft_king_mcarthur_redesign"
                    },
                    group1: {
                        bear: "mergecraft_bear_grizzly_redesign",
                        elf: "mergecraft_elf_emeralda_redesign",
                        warlock: "mergecraft_warlock_enchantress_redesign",
                        troll: "mergecraft_troll_redesign",
                        seller: "mergecraft_seller_merchant_redesign",
                        bonussale_person: "mergecraft_bonussale_person_redesign",
                        knight: "mergecraft_knight_mergelot_redesign",
                        hunter: "mergecraft_hunter_huntress_redesign",
                        centaur: "mergecraft_centaur_alvin_redesign",
                        keeper: "mergecraft_keeper_zafira_legs",
                        gnomes: "mergecraft_gnomes_bigbob_redesign",
                        shark: "mergecraft_pirate_shark_redesign",
                        camel: "mergecraft_camel_camel_redesign",
                        miner: "mergecraft_miner_miner_redesign",
                        jihn: "mergecraft_jihn_jihn_redesign",
                        kraken: "mergecraft_kraken_kraken",
                        capitannemo: "undersea2_capitan_nemo_redesign",
                        rapunzel: "rapunzel_rapunzel_redesign",
                        rpcentaur: "mergecraft_centaur_alvin_redesign",
                        rpgnomes: "mergecraft_gnomes_bigbob_redesign",
                        aviator: "xmas_aviator_redesign",
                        fish: "mergecraft_robo_fish_redesign",
                        panda: "mergecraft_panda_redesign"
                    }
                },
                features: ["map2d", "expeditions", "expedition_halloween", "expedition_xmas", "expedition_dragonia", "expedition_dragonia2", "expedition_dragonia3", "expedition_rapunzel", "expedition_rapunzel2", "expedition_undersea", "expedition_undersea2", "expedition_easter", "expedition_china", "expedition_collections", "expedition_adventure", "minesweeper", "clans", "achievements", "skin_xmas"],
                adjust: {
                    token: "4ck88u210vr4",
                    purchaseToken: "2hfeqa"
                },
                stand: {
                    staticUrl: "https://mergecraft.labsystech.ru/publish/html5-staging/",
                    deployment: "https://mergecraft.labsystech.ru"
                },
                ios_ch: {
                    id: "1576804516",
                    title: "合成王国：奇幻岛",
                    adjust: {
                        token: "2ssiznlyvzsw"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/7575579365"
                    }
                },
                instant: {
                    appId: "126844939376182",
                    rewarded: "129195502474459",
                    interstitial: "129195289141147",
                    banner: "774207007973302",
                    groupId: "110350677808060",
                    stand: {
                        appId: "229012888971887"
                    }
                },
                facebook: {
                    shortname: "mergecraft",
                    appId: "365815270676633",
                    groupId: "mergecraftgroup",
                    stand: {
                        appId: "616098016852174"
                    }
                },
                mbga: {
                    appId: "12026923",
                    groupId: "32869830"
                },
                vk: {
                    shortname: "mergecraft",
                    appId: "7776586",
                    groupId: "mergecraft_group",
                    stand: {
                        appId: "7776276"
                    }
                },
                ok: {
                    shortname: "mergecraft",
                    appId: "512000742814",
                    appKey: "CPJGFQJGDIHBABABA",
                    groupId: "60620856950954",
                    stand: {
                        appId: "512000870791",
                        appKey: "CIIKECKGDIHBABABA"
                    }
                },
                android: {
                    business: "slimmerbits",
                    package: "com.cleverapps.mergecraft",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2420998-2"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/1571471850"
                    },
                    appLovin: {
                        rewarded: "0518a8a3edf0e32e"
                    }
                },
                amazon: {
                    package: "com.cleverapps.mergecraft",
                    id: "B0922VXRPZ",
                    adjust: {
                        token: "koqpa6qtvuo0",
                        purchaseToken: "w3dw6v"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/9035892899"
                    }
                },
                ios: {
                    package: "com.cleverapps.mergecraft",
                    id: "1562149254",
                    macos: !0,
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/1877597767"
                    }
                },
                mm: {
                    appId: "783650",
                    privateKey: "34f0c62fb0e1d0ac35d00c75acbe6cb5",
                    groupId: "mergecraft",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                fotostrana: {
                    appId: "mergecraft",
                    privateKey: "33af4305d7414b380c3636f3b03fb70f",
                    groupId: "352927",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                gdcom: {
                    appId: "b5203bfef51242c39690c761321d769f"
                },
                yandex: {
                    appId: "171361"
                },
                draugiem: {
                    appId: "mergecraft",
                    groupId: "mergest-kingdom"
                },
                mygames: {
                    appId: "16836",
                    gcId: "0.2013937"
                },
                rustore: {
                    appId: "87802303"
                },
                microsoft: {
                    appId: "9PGVXWXRWX7S",
                    iap: {
                        gold500: "9P02CM8TVC1C",
                        testProduct: {
                            id: "9P0T1P4LN55H",
                            debugId: "9NMP9ZPCH4NQ"
                        },
                        gold1800: "9PNDQG96M004",
                        gold3800: "9PB87VBQS740",
                        gold6000: "9P228BSKP78Q",
                        gold25000: "9P529VTFQWZX",
                        starterPack0: "9NKDLJ18DHP2",
                        starterPack: "9PDZRS5HGPR3",
                        starterPack2: "9N1TLJGX49ZF",
                        growthFund: "9NNFBQBR57SV",
                        subsWeek: "9N4G27WTHCH1",
                        subsMonth: "9P2Z1VZ1SM8T",
                        subsWeekTest: "9N2DB2KMB81F",
                        subsMonthTest: "9NRNP2V46XXQ",
                        expeditionPack: "9NPDLB9XBJ81"
                    }
                },
                gpg: {},
                kongregate: {
                    appId: "324134",
                    name: "mergest-kingdom"
                },
                msstart: {
                    name: "Mergest Kingdom",
                    appId: "9PC19RXFZL82",
                    packageId: "CleverAppsPteLtd.MergestKingdomStartGame",
                    gameUrl: "https://mergecraft.cleverappssg.com/publish/html5/msstart/",
                    stand: {
                        gameUrl: "https://mergecraft.labsystech.ru/publish/html5-staging/msstart/"
                    },
                    publisherDisplayName: "Clever Apps Pte Ltd",
                    publisherId: "CN=74ABBD7D-0673-4634-97E9-9379CC797397"
                },
                xsolla: {
                    appId: "134757",
                    loginProjectId: "9e48b5cc-b306-11eb-bc85-42010aa80004",
                    stand: {
                        appId: "162900",
                        loginProjectId: "9b99f537-af3a-11eb-bc85-42010aa80004"
                    }
                },
                wechat: {
                    appId: "wxd3cc1f757d2ee522",
                    stand: {
                        appId: "wxd3cc1f757d2ee522"
                    }
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                wortal: {
                    appId: 239
                },
                crazy: {
                    name: "mergest-kingdom",
                    xsolla: {
                        appId: "238187"
                    }
                }
            },
            wondermerge: {
                business: "cleverapps",
                type: "merge",
                meta: "none",
                orientation: "horizontal",
                staticUrl: "https://wondermerge.gcdn.co/publish/html5/",
                ruStaticUrl: "https://d9c3fb10-93ed-4b82-a3a0-be23f88aa8ce.selcdn.net/publish/html5/",
                deployment: "https://wondermerge.cleverappssg.com",
                title: "Tropical Merge",
                levelsPath: ["cleverapps/res/mergecraft/levels/", "cleverapps/res/wondermerge/levels/"],
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                energy: !0,
                ui: "tropical",
                personsMinimal: {
                    hero: "wondermerge_dwarf_lisa_minimal",
                    worker: "wondermerge_worker_roger_minimal",
                    dwarf: "wondermerge_dwarf_lisa_minimal"
                },
                persons: {
                    main: {
                        hero: "wondermerge_worker_roger",
                        narrator: "wondermerge_worker_roger",
                        worker: "wondermerge_worker_roger",
                        dwarf: "wondermerge_dwarf_lisa",
                        king: "wondermerge_king_axel"
                    },
                    group1: {
                        lotteryking: "wondermerge_king_lottery",
                        bear: "wondermerge_bear_marina",
                        elf: "wondermerge_elf_gloria",
                        warlock: "wondermerge_warlock_santa",
                        bonussale_person: "wondermerge_bonussale_person",
                        troll: "wondermerge_troll_elena",
                        knight: "wondermerge_knight_bruce",
                        hunter: "wondermerge_hunter_marcel",
                        shark: "wondermerge_shark_vet",
                        keeper: "mergecraft_keeper_zafira_redesign",
                        centaur: "wondermerge_centaur_jenny",
                        gnomes: "wondermerge_gnomes_leader",
                        camel: "wondermerge_camel_horse",
                        capitannemo: "undersea2_capitan_nemo_redesign",
                        aviator: "xmas_aviator",
                        rapunzel: "rapunzel_rapunzel",
                        rpcentaur: "mergecraft_centaur_alvin",
                        rpgnomes: "mergecraft_gnomes_bigbob",
                        fish: "wondermerge_fish_kusto",
                        panda: "wondermerge_tiki_girl"
                    }
                },
                features: ["map2d", "expeditions", "expedition_halloween", "expedition_xmas", "expedition_dragonia", "expedition_dragonia2", "expedition_dragonia3", "expedition_rapunzel", "expedition_rapunzel2", "expedition_undersea", "expedition_undersea2", "expedition_easter", "expedition_china", "minesweeper", "clans", "achievements", "skin_xmas"],
                webFirebase: {
                    apiKey: "AIzaSyDhgxxFZWSDPHcpOmQ5jPy2OeHcpBC9HjE",
                    authDomain: "tropical-merge.firebaseapp.com",
                    projectId: "tropical-merge",
                    storageBucket: "tropical-merge.appspot.com",
                    messagingSenderId: "534797023379",
                    appId: "1:534797023379:web:f9d91fcbae277fc30f7566",
                    measurementId: "G-11CSJL13H8"
                },
                fbPixelId: "408907384169629",
                adjust: {
                    token: "ho4ijurrre9s",
                    purchaseToken: "28pf4d"
                },
                stand: {
                    staticUrl: "https://wondermerge.labsystech.ru/publish/html5-staging/",
                    deployment: "https://wondermerge.labsystech.ru"
                },
                instant: {
                    appId: "852666995406371",
                    rewarded: "852742225398848",
                    interstitial: "852742528732151",
                    banner: "1316664625673270",
                    groupId: "104263965419822",
                    stand: {
                        appId: "460962268710986"
                    }
                },
                facebook: {
                    shortname: "cleverwondermerge",
                    appId: "699542957221997",
                    groupId: "wondermergepage",
                    stand: {
                        appId: "597596791051962"
                    }
                },
                vk: {
                    shortname: "tropicalmerge",
                    appId: "7967808",
                    groupId: "wondermerge_group",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "784709",
                    privateKey: "dab8f04678b593f8e15e39c400407b3d",
                    groupId: "wondermerge",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                ok: {
                    shortname: "wondermerge",
                    appId: "512001029650",
                    appKey: "CDBHLEKGDIHBABABA",
                    groupId: "62868341522602",
                    stand: {
                        appId: "512001136399",
                        appKey: "CQAIFGKGDIHBABABA"
                    }
                },
                android: {
                    business: "slimmerbits",
                    package: "com.cleverapps.wondermerge",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427357-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/9633415116"
                    },
                    appLovin: {
                        rewarded: "e01c532218f535e3"
                    }
                },
                amazon: {
                    adjust: {
                        token: "vmgjb5z7x98g",
                        purchaseToken: "95za1c"
                    },
                    package: "com.cleverapps.wondermerge",
                    id: "B09MD2ZSPZ",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/4390070873"
                    }
                },
                ios: {
                    package: "com.cleverapps.wondermerge",
                    id: "1597691481",
                    macos: !0,
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/4320306856"
                    }
                },
                gdcom: {
                    appId: "4eafc18cbceb45ed884f6c5d70df3963"
                },
                mbga: {
                    appId: "12026992",
                    groupId: "32875475"
                },
                draugiem: {
                    appId: "wondermerge",
                    groupId: "tropical-merge"
                },
                yandex: {
                    appId: "179757"
                },
                rustore: {},
                microsoft: {
                    appId: "9PL2ZQTL33W8",
                    iap: {
                        gold500: "9P9XXF7P43SN",
                        testProduct: {
                            id: "9P3BLP2SNQS9",
                            debugId: "9N99RVS5C38G"
                        },
                        gold1800: "9PG4HFMDB23S",
                        gold3800: "9NBQX8RHXT26",
                        gold6000: "9NRTMC4877ZH",
                        gold25000: "9NT4KHQC5Q00",
                        starterPack2: "9MWGZZ8TWVCR",
                        starterPack0: "9PFQ0HSW1GNL",
                        starterPack: "9PF13P2BKQ5Q",
                        growthFund: "9N6SV05KL4G5",
                        expeditionPack: "9NT36TG90VDW"
                    }
                },
                gpg: {},
                kongregate: {
                    appId: "324163",
                    name: "tropical-merge"
                },
                xsolla: {
                    appId: "191184",
                    loginProjectId: "008adb0c-d1e1-11ec-8589-42010aa80004"
                },
                msstart: {
                    name: "Tropical Merge",
                    appId: "9N5TK2SN4464",
                    packageId: "CleverAppsPteLtd.TropicalMergeStartGame",
                    gameUrl: "https://wondermerge.cleverappssg.com/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                crazy: {
                    name: "tropical-merge",
                    xsolla: {
                        appId: "242627"
                    }
                }
            },
            epicart: {
                development: !0,
                type: "battlefield",
                meta: "shortmeta",
                orientation: "horizontal",
                staticUrl: "https://epicart.gcdn.co/publish/html5/",
                deployment: "https://epicart.cleverappssg.com",
                title: "Epic merge: art of war",
                levelsPath: "res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                lives: !(cleverapps.styles.FakeLoginWindow = {
                    padding: {
                        x: 85,
                        top: 100,
                        bottom: 100
                    },
                    adsInfo: {
                        offset: 70,
                        padding: 10
                    },
                    buttons: {
                        width: 260,
                        height: 100,
                        margin: 50
                    },
                    layout: {
                        margin: 50
                    },
                    loginButton: {
                        width: 280,
                        height: 110
                    },
                    textBox: {
                        width: 780,
                        height: 80
                    }
                }),
                languages: ["en"],
                ui: "wooden",
                features: [],
                persons: {
                    main: {
                        hero: "mergecraft_dwarf_hogrider"
                    }
                },
                personsMinimal: {
                    hero: "mergecraft_dwarf_hogrider_minimal"
                },
                stand: {
                    staticUrl: "https://epicart.labsystech.ru/publish/html5-staging/",
                    deployment: "https://epicart.labsystech.ru"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            differences: {
                business: "zareef",
                type: "differences",
                regime: "knockout",
                meta: "simple",
                orientation: "vertical",
                staticUrl: "https://differences.cleverappssg.com/publish/html5/",
                ruStaticUrl: "https://5118963e-15f2-4755-a52e-1cec7c816428.selcdn.net/publish/html5/",
                deployment: "https://differences.cleverappssg.com",
                title: "Differences",
                levelsPath: "res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                lives: !0,
                soft: !1,
                ui: "wooden",
                personsMinimal: {
                    hero: "differences_hero_rachel_minimal"
                },
                persons: {
                    main: {
                        hero: "differences_hero_rachel"
                    }
                },
                features: ["boosters_before", "cryptex", "weeklycup", "treasure_search", "letter_tournament"],
                adjust: {
                    token: "lmk8mnhq4xs0",
                    purchaseToken: "pnfv7v"
                },
                webFirebase: {
                    apiKey: "AIzaSyBxMJa60e33MPK5IUArcO6xpKKN-J5plsg",
                    authDomain: "rachel-holmes.firebaseapp.com",
                    projectId: "rachel-holmes",
                    storageBucket: "rachel-holmes.appspot.com",
                    messagingSenderId: "690260014762",
                    appId: "1:690260014762:web:8f573e28bc6302a21f42d3",
                    measurementId: "G-YFRS83BVYZ"
                },
                fbPixelId: "590471709343301",
                stand: {
                    staticUrl: "https://differences.labsystech.ru/publish/html5-staging/",
                    deployment: "https://differences.labsystech.ru"
                },
                xsolla: {
                    appId: "191476",
                    loginProjectId: "5efd5792-d5bd-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "466070618121604",
                    rewarded: "466072421454757",
                    interstitial: "466072581454741",
                    banner: "1212409686821023",
                    groupId: "100462882000800"
                },
                facebook: {
                    shortname: "cleverdifferences",
                    appId: "278637090036923",
                    groupId: "rachelholmesfinddifferences",
                    stand: {
                        appId: "195225751884161"
                    }
                },
                android: {
                    package: "com.cleverapps.differences",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427361-1"
                    },
                    business: "cleverapps",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/1047853593"
                    }
                },
                amazon: {
                    package: "com.cleverapps.differences",
                    id: "B08R7PCC89"
                },
                ios: {
                    business: "cleverapps",
                    package: "com.cleverapps.differences",
                    id: "1546227822",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/8898407544"
                    }
                },
                ok: {
                    shortname: "cleverdifferences",
                    appId: "512000594608",
                    appKey: "CBLDBOJGDIHBABABA",
                    groupId: "58829738606762",
                    stand: {
                        appId: "512000589370",
                        appKey: "CLDPPNJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "cleverdifferences",
                    appId: "7605538",
                    groupId: "differences_group",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "782111",
                    privateKey: "44828036769062a2148cbf76f6bd33d6",
                    groupId: "differences",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "",
                    groupId: ""
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                fotostrana: {
                    appId: "differences",
                    privateKey: "5b1ff4ce4c7e274ae98bf394d8d6dd37",
                    groupId: "352931",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                gdcom: {
                    appId: "120653a94b0a48cf9050fff4a258f5cf"
                },
                msstart: {
                    name: "Rachel Holmes",
                    appId: "9NRGLLVFNMBS",
                    packageId: "CleverAppsPteLtd.RachelHolmesStartGame",
                    gameUrl: "https://differences.cleverappssg.com/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            tripeaks: {
                business: "cleverapps",
                type: "solitaire",
                meta: "simple",
                orientation: "vertical",
                staticUrl: "https://tripeaks.gcdn.co/publish/html5/",
                ruStaticUrl: "https://eb168cc7-ecf9-4833-8d43-ce69df181a1f.selcdn.net/publish/html5/",
                deployment: "https://tripeaks.cleverappssg.com",
                title: "Kings & Queens: Solitaire Tri Peaks",
                levelsPath: "cleverapps/res/tripeaks/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                lives: !0,
                soft: !1,
                adjust: {
                    token: "ng66lafe248w",
                    purchaseToken: "6nlpft"
                },
                stand: {
                    staticUrl: "https://tripeaks.labsystech.ru/publish/html5-staging/",
                    deployment: "https://tripeaks.labsystech.ru"
                },
                webFirebase: {
                    apiKey: "AIzaSyBDc1TcFAhtuxwebrRCP5TH4BtK21hfXDs",
                    authDomain: "tri-peaks-271c6.firebaseapp.com",
                    databaseURL: "https://tri-peaks-271c6.firebaseio.com",
                    projectId: "tri-peaks-271c6",
                    storageBucket: "tri-peaks-271c6.appspot.com",
                    messagingSenderId: "234855381154",
                    appId: "1:234855381154:web:b4982abd509e577f087ffb",
                    measurementId: "G-JS24RHNSXC"
                },
                fbPixelId: "1076498066273292",
                ui: "wooden",
                leagues: [30, 60, 100, 200, 500, !1],
                personsMinimal: {
                    hero: "tripeaks_hero_angela_minimal"
                },
                persons: {
                    main: {
                        hero: "tripeaks_elf_emeralda"
                    }
                },
                features: ["boosters_before", "tilegame", "treasure_search", "letter_tournament", "achievements", "dailylevel"],
                xsolla: {
                    appId: "191315",
                    loginProjectId: "6036ff99-d356-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "582264172486698",
                    rewarded: "583410035705445",
                    interstitial: "583409625705486",
                    banner: "1301785730534535",
                    groupId: "102297708232957"
                },
                facebook: {
                    shortname: "tripeakscard",
                    appId: "1079919015696954",
                    groupId: "KingsAndQueensTripeaksCommunity",
                    stand: {
                        appId: "585880102065094"
                    }
                },
                android: {
                    package: "com.cleverapps.tripeaks",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427360-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/6473289950"
                    }
                },
                amazon: {
                    package: "com.cleverapps.tripeaks",
                    id: "B08CNK8GSB",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/6764080637"
                    }
                },
                ios: {
                    package: "com.cleverapps.tripeaks",
                    id: "1523134029",
                    macos: !0,
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/7183736397"
                    }
                },
                ok: {
                    shortname: "tripeaks",
                    appId: "512000516286",
                    appKey: "CPLBOMJGDIHBABABA",
                    groupId: "58210808561834",
                    stand: {
                        appId: "512000567965",
                        appKey: "COJLKNJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "tripeaks",
                    appId: "7522400",
                    groupId: "tripeaks_group",
                    stand: {
                        appId: "7522400"
                    }
                },
                mm: {
                    appId: "779517",
                    privateKey: "f5117307f5652c346c8a492698ec5520",
                    groupId: "tripeaks",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "12026813",
                    groupId: ""
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                fotostrana: {
                    appId: "tripeaks",
                    privateKey: "b97e8a2478376c1d7261f87ab1b2f8aa",
                    groupId: "352512",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                gdcom: {
                    appId: "344fff78cd674f62a549533551505ebb"
                },
                yandex: {
                    appId: "173184"
                },
                rustore: {},
                microsoft: {
                    appId: "9N0Q2287357F",
                    iap: {
                        testProduct: {
                            id: "9PM68L5FCK7N",
                            debugId: "9PNJ1BD5T6MG"
                        },
                        unlimitedLives: "9NZMSZSZS1LW",
                        gold500: "9P3P869D90ZN",
                        gold1800: "9N98K4ZLL0Q6",
                        gold3800: "9P8SC2QTMQ38",
                        gold6000: "9PDVH7XCR1VS",
                        gold25000: "9PHNKPMNT1Z7",
                        addMoves: "9P2NZ6LS2Z39",
                        addMoves1: "9P89SRSW3LP3",
                        addMoves2: "9PLT2KZN0X69",
                        addMoves3: "9PJD04C78CV2",
                        addMoves5: "9N01HFSMBFN1",
                        starterPack0: "9N43HCJ6MNS5",
                        starterPack: "9NB03GK0NZV0",
                        starterPack2: "9PFKGHXHLRZV",
                        sweetPack: "9N2X362QH5MD",
                        honeyPack: "9PMT7QBV33LJ",
                        jamPack: "9NSF2FLPGBC7",
                        tastyPack: "9PLSDW0LJZBC",
                        epicPack: "9P9Q07PQ3SQT",
                        piggybank500: "9P10WBJKKJLC",
                        piggybank1800: "9NM7CJ9BL4V0",
                        piggybank6000: "9NG74XLRM5KQ",
                        piggybank25000: "9NM7DZD46161"
                    }
                },
                gpg: {},
                kongregate: {
                    appId: "324223",
                    name: "kings-and-queens"
                },
                msstart: {
                    name: "Kings and Queens Start Game",
                    appId: "9PLVT8QK4HM5",
                    packageId: "CleverAppsPteLtd.KingsandQueensStartGame",
                    gameUrl: "https://tripeaks.cleverappssg.com/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                crazy: {
                    name: "kings-and-queens",
                    xsolla: {
                        appId: "243560"
                    }
                }
            },
            fairy: {
                business: "zareef",
                type: "merge",
                meta: "none",
                orientation: "horizontal",
                staticUrl: "https://fairy.gcdn.co/publish/html5/",
                ruStaticUrl: "https://c8463d60-ec57-4d31-bd06-9af683ab6e52.selcdn.net/publish/html5/",
                awsStaticUrl: "https://d30bc0r4zyqltz.cloudfront.net/publish/html5/",
                deployment: "https://fairy.cleverappssg.com",
                title: "Fairy",
                levelsPath: ["cleverapps/res/mergecraft/levels/", "cleverapps/res/fairy/levels/"],
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                energy: !0,
                ui: "riddles",
                personsMinimal: {
                    hero: "fairy_dwarf_violet_minimal",
                    worker: "fairy_worker_fairy_minimal",
                    dwarf: "fairy_dwarf_violet_minimal",
                    king: "fairy_king_christian_minimal"
                },
                persons: {
                    main: {
                        hero: "fairy_dwarf_violet",
                        narrator: "fairy_dwarf_violet",
                        worker: "fairy_worker_fairy",
                        dwarf: "fairy_dwarf_violet",
                        king: "fairy_king_christian"
                    },
                    group1: {
                        bear: "fairy_bear_cinderella",
                        elf: "fairy_elf_unicorn",
                        warlock: "fairy_warlock_leprechaun",
                        bonussale_person: "fairy_bonussale_person",
                        troll: "fairy_troll_enchantress",
                        aviator: "xmas_aviator",
                        keeper: "mergecraft_keeper_zafira_redesign",
                        camel: "wondermerge_camel_horse",
                        knight: "fairy_pinicchio",
                        gnomes: "fairy_gnomes_faun",
                        rapunzel: "rapunzel_rapunzel",
                        rpcentaur: "mergecraft_centaur_alvin",
                        rpgnomes: "mergecraft_gnomes_bigbob",
                        hunter: "fairy_hunter_huntress",
                        centaur: "fairy_centaur_watchmaker",
                        capitannemo: "undersea2_capitan_nemo_redesign",
                        shark: "fairy_shark_zeus"
                    }
                },
                features: ["map2d", "expeditions", "expedition_halloween", "expedition_dragonia", "expedition_rapunzel", "expedition_rapunzel2", "expedition_xmas", "expedition_undersea", "expedition_undersea2", "expedition_easter", "expedition_china", "expedition_collections", "clans", "achievements", "skin_xmas"],
                adjust: {
                    token: "xx364iyjz5z4",
                    purchaseToken: "ogshhr"
                },
                stand: {
                    staticUrl: "https://fairy.labsystech.ru/publish/html5-staging/",
                    deployment: "https://fairy.labsystech.ru"
                },
                webFirebase: {
                    apiKey: "AIzaSyCFmbRxQGUZBuPxZEkuYJv-EIgIy0n_bQY",
                    authDomain: "fairyland-e3604.firebaseapp.com",
                    projectId: "fairyland-e3604",
                    storageBucket: "fairyland-e3604.appspot.com",
                    messagingSenderId: "474805721503",
                    appId: "1:474805721503:web:29235ee735aeaabda785aa",
                    measurementId: "G-DQFLFRS0WQ"
                },
                fbPixelId: "2267022830131264",
                xsolla: {
                    appId: "198577",
                    loginProjectId: "b8d9c08a-21ff-11ed-94d0-42010aa80004"
                },
                instant: {
                    appId: "364648672526634",
                    rewarded: "366944665630368",
                    interstitial: "366946128963555",
                    banner: "571888631802636",
                    groupId: "102965412554291",
                    stand: {
                        appId: "624590735850442",
                        rewarded: "824930735816440",
                        banner: "780736686902512"
                    }
                },
                facebook: {
                    shortname: "cleverappsfairy",
                    appId: "1152275768461536",
                    groupId: "cleverfairycommunity",
                    stand: {
                        appId: "234186548097136"
                    }
                },
                vk: {
                    shortname: "cleverappsfairy",
                    appId: "8207300",
                    groupId: "cleverapps_fairy",
                    stand: {
                        appId: "8206743"
                    }
                },
                mm: {
                    appId: "786315",
                    privateKey: "a8640e5f97ac7c59921573f15d90af74",
                    groupId: "fairy_group"
                },
                ok: {
                    shortname: "cleverappsfairy",
                    appId: "512001461494",
                    appKey: "CHPNELKGDIHBABABA",
                    groupId: "70000000144554",
                    stand: {
                        appId: "512001435780",
                        appKey: "CFIJOKKGDIHBABABA"
                    }
                },
                android: {
                    business: "slimmerbits",
                    package: "com.cleverapps.fairy",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427358-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/6914359452"
                    },
                    appLovin: {
                        rewarded: "c8ec5be6b70921ee"
                    }
                },
                amazon: {
                    package: "",
                    id: "",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/9075211250"
                    }
                },
                ios: {
                    business: "cleverapps",
                    package: "com.cleverapps.fairy",
                    id: "1637090783",
                    macos: !0,
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/6206888228"
                    }
                },
                yandex: {
                    appId: "193645"
                },
                plng: {
                    appId: "2deee771bf534191bc4071fa571a53a3"
                },
                rustore: {},
                microsoft: {
                    appId: "9PM92ZN1W9SD",
                    iap: {
                        testProduct: "9MTT0S8KMMXH",
                        gold500: "9P8PVSFNH91G",
                        gold1800: "9N9CQ2LQGDT0",
                        gold3800: "9NNXVV7KVKLL",
                        gold6000: "9PLFD3WD19CW",
                        gold25000: "9N7VKLZBSBBQ",
                        starterPack0: "9NZ8P9WZVQ8X",
                        starterPack: "9PK1RHH7C5GW",
                        starterPack2: "9P53T0ZN3MSB",
                        growthFund: "9MTD3880J6GF",
                        expeditionPack: "9PP9892F62Q0"
                    }
                },
                msstart: {
                    name: "Fairyland",
                    appId: "9NW8M0C50K4W",
                    packageId: "CleverAppsPteLtd.FairylandStartGame",
                    gameUrl: "https://fairy.cleverappssg.com/publish/html5/msstart/"
                },
                gdcom: {
                    appId: "2deee771bf534191bc4071fa571a53a3",
                    stand: {
                        appId: "9c62a7900ada4e33a739d384d977b243"
                    }
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                wechat: {
                    appId: "wxd3cc1f757d2ee522",
                    offerId: "1450100764",
                    stand: {
                        appId: "wxd3cc1f757d2ee522"
                    },
                    rewarded: "adunit-d90212b2a22363c9",
                    thinkingData: {
                        appId: "062ff360719a431886927304e4e58e12",
                        serverUrl: "https://thinkdata.swiftjava.com"
                    },
                    gravityEngine: {
                        accessToken: "7Fvtrwwjyi0lTvNxum3gbqcB2dWoXhh5"
                    }
                },
                tencent: {
                    deployment: "https://fairyland-api.cftap.top",
                    staticUrl: "https://fairyland-api.cftap.top/publish/wechat/",
                    stand: {
                        deployment: "http://43.139.125.247",
                        staticUrl: "http://43.139.125.247/publish/wechat-staging/"
                    }
                },
                crazy: {
                    name: "fairyland-merge-and-magic",
                    xsolla: {
                        appId: "242625"
                    }
                }
            },
            riddles: {
                business: "zareef",
                meta: "hose",
                type: "match3",
                webhook: ["match3"],
                orientation: "vertical",
                lives: !0,
                soft: !1,
                staticUrl: "https://riddles.gcdn.co/publish/html5/",
                ruStaticUrl: "https://6c2aa349-453a-4a8a-9a83-b9f0944fd35c.selcdn.net/publish/html5/",
                deployment: "https://riddles.labsystech.ru",
                title: "Candy Riddles",
                levelsPath: "match3/res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                ui: "riddles",
                personsMinimal: {
                    hero: "riddles_red_marigold_minimal"
                },
                persons: {
                    main: {
                        hero: "riddles_red_marigold",
                        purple: "riddles_purple_sticky",
                        red: "riddles_red_marigold",
                        yellow: "riddles_yellow_amber",
                        green: "riddles_green_greeffin"
                    }
                },
                features: ["boosters_before", "riddlesgamefeatures", "match3_hose", "treasure_search", "achievements", "bonus_world"],
                adjust: {
                    token: "7h99civw80sg",
                    purchaseToken: "pwy8hj"
                },
                stand: {
                    staticUrl: "https://riddles-staging.labsystech.ru/publish/html5-staging/",
                    deployment: "https://riddles-staging.labsystech.ru"
                },
                webFirebase: {
                    apiKey: "AIzaSyD_-mk9xjR7Z9nL44BFibE1rC5maBqHUzs",
                    authDomain: "candy-11719.firebaseapp.com",
                    databaseURL: "https://candy-11719.firebaseio.com",
                    projectId: "candy-11719",
                    storageBucket: "candy-11719.appspot.com",
                    messagingSenderId: "749528767585",
                    appId: "1:749528767585:web:070e654828b0ddb2735e20",
                    measurementId: "G-RHKNDWD0FY"
                },
                fbPixelId: "784162022961461",
                xsolla: {
                    appId: "191229",
                    loginProjectId: "e667a2d9-d277-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "169228177248519",
                    rewarded: "171407780363892",
                    interstitial: "171665730338097",
                    groupId: "100077695696906",
                    banner: "1467771527394171",
                    stand: {
                        appId: "405961237323072",
                        rewarded: "978156936770163",
                        banner: "925394072046450"
                    }
                },
                facebook: {
                    shortname: "candyriddles",
                    appId: "1996120880405386",
                    groupId: "CandyRiddlesCommunity",
                    stand: {
                        appId: "109585006443834"
                    }
                },
                android: {
                    business: "slimmerbits",
                    package: "com.cleverapps.candyriddles",
                    unityGameId: "500007109",
                    yandexAds: {
                        rewarded: "R-M-2427365-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/3761056003"
                    }
                },
                amazon: {
                    package: "com.cleverapps.candyriddles",
                    id: "B078YB7FBX",
                    iap: {
                        prefix: "com.cleverapps.candyriddles."
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/7212471498"
                    },
                    adjust: {
                        token: "ox00ba2357uo",
                        purchaseToken: "czljtw"
                    }
                },
                ios: {
                    business: "slimmerbits",
                    package: "com.cleverapps.riddles",
                    id: "1340236132",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/4275103469"
                    }
                },
                ok: {
                    shortname: "candyriddles",
                    appId: "1269377792",
                    appKey: "CBAMCKKMEBABABABA",
                    groupId: "54360798855338",
                    stand: {
                        appId: "1270935552",
                        appKey: "CBABPBMMEBABABABA"
                    }
                },
                vk: {
                    shortname: "candy_riddles",
                    appId: "6745237",
                    groupId: "candyriddles",
                    stand: {
                        appId: "6790773"
                    }
                },
                mm: {
                    appId: "763558",
                    privateKey: "832ab94c8979ec52da1ce740f71d7ad7",
                    groupId: "candyriddles",
                    stand: {
                        appId: "763556",
                        privateKey: "40f493f6966593a1f447980cd30bd92c"
                    }
                },
                mbga: {
                    appId: "12026417",
                    groupId: "32844341"
                },
                draugiem: {
                    appId: "riddles",
                    groupId: "riddlespage",
                    stand: {
                        appId: "riddlesstaging",
                        groupId: "riddlespage"
                    }
                },
                gdcom: {
                    appId: "639df47033804f18bf39e113ef29f4fa",
                    stand: {
                        appId: "c125e4ef1daf4c6c8ecd38d02f2681e3"
                    }
                },
                fotostrana: {
                    appId: "candyriddles",
                    privateKey: "00fcabb0bbbf4de8fd200683a099dc13",
                    groupId: "352511",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                yandex: {
                    appId: "173174"
                },
                rustore: {},
                msstart: {
                    name: "Candy Riddles",
                    appId: "9P391MR74HSS",
                    packageId: "CleverAppsPteLtd.CandyRiddlesStartGame",
                    gameUrl: "https://riddles.labsystech.ru/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                crazy: {
                    name: "candyriddles",
                    xsolla: {
                        appId: "250902"
                    }
                }
            },
            heroes: {
                business: "cleverapps",
                meta: "farm",
                type: "match3",
                webhook: ["match3"],
                orientation: "vertical",
                lives: !0,
                soft: !1,
                staticUrl: "https://heroes.gcdn.co/publish/html5/",
                ruStaticUrl: "https://44164114-d925-4db3-9bed-14ad510018a0.selcdn.net/publish/html5/",
                deployment: "https://heroes.cleverappssg.com",
                title: "Sugar Heroes",
                levelsPath: "match3/res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                ui: "heroes",
                personsMinimal: {
                    hero: "heroes_green_sillybillie_minimal"
                },
                persons: {
                    main: {
                        hero: "heroes_green_sillybillie",
                        green: "heroes_green_sillybillie",
                        white: "heroes_white_donutello",
                        purple: "heroes_purple_sweetp",
                        red: "heroes_red_edroll"
                    }
                },
                features: ["boosters_before", "heroesgamefeatures", "treasure_search", "achievements", "bonus_world"],
                adjust: {
                    token: "mmimvhbjk1z4",
                    purchaseToken: "83oly9"
                },
                webFirebase: {
                    apiKey: "AIzaSyCgZXUhNC0RP-NX0r4nVOeTjDcLRBsDBio",
                    authDomain: "sugar-heroes.firebaseapp.com",
                    databaseURL: "https://sugar-heroes.firebaseio.com",
                    projectId: "sugar-heroes",
                    storageBucket: "sugar-heroes.appspot.com",
                    messagingSenderId: "106624368176",
                    appId: "1:106624368176:web:645f0f9307b2e22842b7f5",
                    measurementId: "G-X2ZDQDC4WW"
                },
                fbPixelId: "529015942095487",
                stand: {
                    staticUrl: "https://heroes.labsystech.ru/publish/html5-staging/",
                    deployment: "https://heroes.labsystech.ru"
                },
                xsolla: {
                    appId: "191314",
                    loginProjectId: "29d35a8e-d351-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "2096828893670802",
                    rewarded: "2105178429502515",
                    interstitial: "2105484592805232",
                    banner: "6822615024425475",
                    groupId: "278630749647866"
                },
                facebook: {
                    shortname: "sugarheroes",
                    appId: "205918406663140",
                    groupId: "sugarheroescommunity",
                    stand: {
                        appId: "148448049182010"
                    }
                },
                android: {
                    package: "com.cleverapps.heroes",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427364-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/8568079684"
                    }
                },
                amazon: {
                    package: "com.cleverapps.heroes",
                    id: "B07JMZLTV7",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/1113967002"
                    },
                    adjust: {
                        token: "bnq035c53pxc",
                        purchaseToken: "z321un"
                    }
                },
                ios: {
                    package: "com.cleverapps.heroes",
                    id: "1439884631",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/8586448837"
                    }
                },
                ok: {
                    shortname: "sugarheroes",
                    appId: "1271685376",
                    appKey: "CBACGNMMEBABABABA",
                    groupId: "54384511877290",
                    stand: {
                        appId: "512000694356",
                        appKey: "CFFJJPJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "sugar_heroes",
                    appId: "6830710",
                    groupId: "sugarheroes",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "763582",
                    privateKey: "8558918e7b85be33743d63b68ac7be00",
                    groupId: "sugarheroes",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "12026480",
                    groupId: "32846074"
                },
                draugiem: {
                    appId: "sugarheroes",
                    groupId: "sugarheroespage"
                },
                gdcom: {
                    appId: "b24567e39b5248eabe77a704dbb555a9"
                },
                fotostrana: {
                    appId: "sugarheroes",
                    privateKey: "5480cd9bf57b7ed5be7f2decf8541e18",
                    groupId: "352509",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                yandex: {
                    appId: "173183"
                },
                rustore: {},
                kongregate: {
                    appId: "324221",
                    name: "sugar-heroes"
                },
                msstart: {
                    name: "Sugar Heroes",
                    appId: "9NKZMT283DZC",
                    packageId: "CleverAppsPteLtd.SugarHeroesStartGame",
                    gameUrl: "https://heroes.cleverappssg.com/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                crazy: {
                    name: "sugar-heroes",
                    xsolla: {
                        appId: "250903"
                    }
                }
            },
            adventure: {
                business: "cleverapps",
                meta: "hose",
                type: "match3",
                webhook: ["match3"],
                orientation: "vertical",
                lives: !0,
                soft: !1,
                rpg: !0,
                ui: "riddles",
                staticUrl: "https://adventure.gcdn.co/publish/html5/",
                ruStaticUrl: "https://7329e60d-e6ea-42f8-bede-94dfe1efd6f6.selcdn.net/publish/html5/",
                deployment: "https://adventure.cleverappssg.com",
                title: "Secrets of Charmland",
                levelsPath: "match3/res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                webFirebase: {
                    apiKey: "AIzaSyBO7SRmTpclIT8D9stCF5DX2Aqmq73q9m4",
                    authDomain: "secrets-of-charmland.firebaseapp.com",
                    databaseURL: "https://secrets-of-charmland.firebaseio.com",
                    projectId: "secrets-of-charmland",
                    storageBucket: "secrets-of-charmland.appspot.com",
                    messagingSenderId: "520544331792",
                    appId: "1:520544331792:web:44245fa75b4668dc3e0295",
                    measurementId: "G-73Y4BKB7D1"
                },
                fbPixelId: "1036380306989912",
                adjust: {
                    token: "yxn8ttu1ydj4",
                    purchaseToken: "2th34l"
                },
                stand: {
                    staticUrl: "https://adventure.labsystech.ru/publish/html5-staging/",
                    deployment: "https://adventure.labsystech.ru"
                },
                personsMinimal: {
                    hero: "adventure_dragon_marshmellado_minimal"
                },
                persons: {
                    main: {
                        hero: "adventure_girl_emma",
                        girl: "adventure_girl_emma",
                        dragon: "adventure_dragon_marshmellado"
                    }
                },
                features: ["boosters_before", "riddlesgamefeatures", "match3_hose", "achievements", "treasure_search"],
                xsolla: {
                    appId: "191471",
                    loginProjectId: "9b978e1e-d5af-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "228942985416996",
                    rewarded: "228947032083258",
                    interstitial: "228947125416582",
                    banner: "835276584783630",
                    groupId: "secretsofcharmlandlite"
                },
                facebook: {
                    shortname: "secretsofcharmland",
                    appId: "1311019545689756",
                    groupId: "secretsofcharmland",
                    stand: {
                        appId: "247075149531781"
                    }
                },
                android: {
                    package: "com.cleverapps.adventure",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427366-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/7873626173"
                    }
                },
                amazon: {
                    package: "com.cleverapps.adventure",
                    id: "B08NXG74BD"
                },
                ios: {
                    package: "com.cleverapps.adventure",
                    id: "1541304616",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/6625478325"
                    }
                },
                ok: {
                    shortname: "secretsofcharmland",
                    appId: "512000026303",
                    appKey: "CQLHGFJGDIHBABABA",
                    groupId: "56035155116202",
                    stand: {
                        appId: "512000646929",
                        appKey: "CCBQNOJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "thesecretsofcharmland",
                    appId: "7139584",
                    groupId: "secretsofcharmland",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "766832",
                    privateKey: "6f8c46ea0f3720ee03b02083db09340b",
                    groupId: "secretsofcharmland",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                yandex: {
                    appId: "194873"
                },
                mbga: {
                    appId: "",
                    groupId: ""
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                gdcom: {
                    appId: "49d17c8657104ee2806feebe41e0f2cd"
                },
                msstart: {
                    name: "Secrets of Charmland",
                    appId: "9NZ3NT01X8GJ",
                    packageId: "CleverAppsPteLtd.SecretsofCharmlandStartGame",
                    gameUrl: "https://adventure.cleverappssg.com/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            runes: {
                business: "cleverapps",
                meta: "hose",
                type: "match3",
                webhook: ["match3"],
                orientation: "vertical",
                lives: !0,
                soft: !1,
                rpg: !0,
                staticUrl: "https://runes.gcdn.co/publish/html5/",
                ruStaticUrl: "https://80300f7a-78c3-40fc-8b75-f6fc4682935f.selcdn.net/publish/html5/",
                deployment: "https://runes.cleverappssg.com",
                title: "Heroes of Match-3",
                levelsPath: "match3/res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                ui: "wooden",
                personsMinimal: {
                    hero: "runes_purple_runespurple_minimal"
                },
                persons: {
                    main: {
                        hero: "runes_purple_runespurple",
                        smith: "runes_smith_runessmith",
                        king: "runes_king_runesking",
                        purple: "runes_purple_runespurple",
                        woodcutter: "runes_woodcutter_runeswoodcutter"
                    }
                },
                features: ["boosters_before", "heroesgamefeatures", "match3_hose", "achievements", "treasure_search"],
                adjust: {
                    token: "eolgyc1elq0w",
                    purchaseToken: "ya20wl"
                },
                webFirebase: {
                    apiKey: "AIzaSyAU85EcE6SB8U49PlKgMfmg6NrqKKWb5ys",
                    authDomain: "heroes-of-match-3.firebaseapp.com",
                    databaseURL: "https://heroes-of-match-3.firebaseio.com",
                    projectId: "heroes-of-match-3",
                    storageBucket: "heroes-of-match-3.appspot.com",
                    messagingSenderId: "970698339273",
                    appId: "1:970698339273:web:c0fae415d327fb7927ee18",
                    measurementId: "G-N3T6X4PYCM"
                },
                fbPixelId: "1016081715715373",
                stand: {
                    staticUrl: "https://runes.labsystech.ru/publish/html5-staging/",
                    deployment: "https://runes.labsystech.ru"
                },
                xsolla: {
                    appId: "191473",
                    loginProjectId: "0b494b8f-d5b4-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "346516946289630",
                    rewarded: "376156803325644",
                    interstitial: "376156129992378",
                    banner: "1392858684988779",
                    groupId: "101372134583131"
                },
                facebook: {
                    shortname: "heroesofmatch",
                    appId: "582954732182317",
                    groupId: "heroesofmatch3",
                    stand: {
                        appId: "320708625483001"
                    }
                },
                android: {
                    package: "com.cleverapps.runes",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427367-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/5471316395"
                    }
                },
                amazon: {
                    package: "com.cleverapps.runes",
                    id: "B07WPW533K"
                },
                ios: {
                    package: "com.cleverapps.runes",
                    id: "1476535667",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/9001638922"
                    }
                },
                ok: {
                    shortname: "heroesofmatch",
                    appId: "1279575808",
                    appKey: "CBAIMFENEBABABABA",
                    groupId: "55547515044010",
                    stand: {
                        appId: "512000465394",
                        appKey: "CDPKBMJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "heroesofmatch",
                    appId: "7016437",
                    groupId: "heroes_of_match",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "765770",
                    privateKey: "e52e74b4f487b2cccf2405816652956c",
                    groupId: "heroesmatch3",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                yandex: {
                    appId: "177666"
                },
                mbga: {
                    appId: "12026637",
                    groupId: "32852303"
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                gdcom: {
                    appId: "bfd6c484cdd9475f895bee03e3b633ff"
                },
                msstart: {
                    name: "Heroes of Match 3",
                    appId: "9NRFRSJPZHQN",
                    packageId: "CleverAppsPteLtd.HeroesofMatch3StartGame",
                    gameUrl: "https://runes.cleverappssg.com/publish/html5/msstart/"
                },
                kongregate: {
                    appId: "324162",
                    name: "heroes-of-match-3"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            wordsoup: {
                business: "cleverapps",
                staticUrl: "https://wordsoup.gcdn.co/publish/html5/",
                ruStaticUrl: "https://769993dc-5d8c-446c-a35c-ac45c04bf621.selcdn.net/publish/html5/",
                deployment: "https://wordsoup.labsystech.ru",
                title: "Word Sauce",
                levelsPath: "cleverapps/res/wordsoup/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                type: "board",
                soft: !1,
                meta: "homefix",
                ui: "wooden",
                orientation: "vertical",
                personsMinimal: {
                    hero: "wordsoup_person0_chloe_minimal"
                },
                persons: {
                    main: {
                        hero: "wordsoup_person0_chloe",
                        person0: "wordsoup_person0_chloe",
                        person1: "wordsoup_person1_grandpa",
                        person2: "wordsoup_person2_estelle",
                        person3: "wordsoup_person3_prince",
                        person4: "wordsoup_person4_gaspar"
                    }
                },
                features: ["map2d", "cryptex", "letter_tournament", "dailylevel", "stickers_collection"],
                webFirebase: {
                    apiKey: "AIzaSyDQ6nvtyrNMH6G_8VLs_SvtiPDzuynGRYQ",
                    authDomain: "word-soup-546b5.firebaseapp.com",
                    databaseURL: "https://word-soup-546b5.firebaseio.com",
                    projectId: "word-soup-546b5",
                    storageBucket: "word-soup-546b5.appspot.com",
                    messagingSenderId: "412297304747",
                    appId: "1:412297304747:web:1c6ba4601adb4b520435ee",
                    measurementId: "G-5BBT2RK9YY"
                },
                fbPixelId: "712270016641926",
                adjust: {
                    token: "ez2lszhmg4xs",
                    purchaseToken: "1ghfoq"
                },
                stand: {
                    staticUrl: "https://wordsoup-staging.labsystech.ru/publish/html5-staging/",
                    deployment: "https://wordsoup-staging.labsystech.ru"
                },
                xsolla: {
                    appId: "191416",
                    loginProjectId: "e163f085-d51a-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "177170139576790",
                    rewarded: "194546684505802",
                    interstitial: "194552307838573",
                    banner: "1312238029403323",
                    groupId: "wordsaucelite"
                },
                facebook: {
                    shortname: "word_soup",
                    appId: "1839614776298283",
                    groupId: "WordSoupPuzzle",
                    stand: {
                        appId: "1847284985531262"
                    }
                },
                android: {
                    package: "org.cocos2dx.wordsoup",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427372-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/9819878145"
                    }
                },
                amazon: {
                    package: "org.cocos2dx.wordsoup",
                    id: "B07192HTZ9",
                    iap: {
                        prefix: ""
                    }
                },
                ios: {
                    package: "org.cocos2dx.wordsoup",
                    id: "1236153570",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/8721105817"
                    },
                    iap: {
                        prefix: "sg.cleverapps.",
                        items: {
                            gold500: "sg.cleverapps.gold.500",
                            gold1800: "sg.cleverapps.gold.1800",
                            gold3800: "sg.cleverapps.gold.3800",
                            gold6000: "sg.cleverapps.gold.6000",
                            gold25000: "sg.cleverapps.gold.25000",
                            subsWeek: "com.cleverapps.wordsoup.subsweek",
                            subsMonth: "com.cleverapps.wordsoup.subsmonth"
                        }
                    }
                },
                ok: {
                    shortname: "wordsoup",
                    appId: "512000025924",
                    appKey: "CFEGGFJGDIHBABABA",
                    groupId: "56042597515434",
                    stand: {
                        appId: "512000436024",
                        appKey: "CJDIKLJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "wordsoup",
                    appId: "7139277",
                    groupId: "wordsauce",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "766829",
                    privateKey: "bce7dc4c706f1c0f9f53a38586ab0f14",
                    groupId: "wordsauce",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "",
                    groupId: ""
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                gdcom: {
                    appId: "8d8965a1f1af4d2b884e0bc48737925d"
                },
                fotostrana: {
                    appId: "wordsoup",
                    privateKey: "ec5a95876a991b883c9c4848dde8b6d8",
                    groupId: "352514",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                msstart: {
                    name: "Word Sauce",
                    appId: "9P2MW8CP8FX8",
                    packageId: "CleverAppsPteLtd.WordSauceStartGame",
                    gameUrl: "https://wordsoup.labsystech.ru/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            crocword: {
                business: "cleverapps",
                meta: "hose",
                orientation: "vertical",
                staticUrl: "https://crocword.gcdn.co/publish/html5/",
                ruStaticUrl: "https://bb549de8-2026-4425-8daa-900d4287a53d.selcdn.net/publish/html5/",
                deployment: "https://crocword.labsystech.ru",
                title: "Croc Word",
                levelsPath: "cleverapps/res/crocword/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                type: "board",
                soft: !1,
                adjust: {
                    token: "6c299ak7zkw0",
                    purchaseToken: "taza3r"
                },
                ui: "tropical",
                personsMinimal: {
                    hero: "crocword_hero_grandpa_minimal"
                },
                persons: {
                    main: {
                        hero: "crocword_hero_grandpa"
                    }
                },
                features: ["cryptex", "letter_tournament", "dailylevel", "stickers_collection"],
                bundles: ["/cleverapps/topack/wordhosebundles"],
                webFirebase: {
                    apiKey: "AIzaSyANvYAsFjt02NR9ZAKuZcVRwMRLGHuNSfQ",
                    authDomain: "croc-word.firebaseapp.com",
                    databaseURL: "https://croc-word.firebaseio.com",
                    projectId: "croc-word",
                    storageBucket: "croc-word.appspot.com",
                    messagingSenderId: "890067203736",
                    appId: "1:890067203736:web:254fe63c23aa0fd524c2ed",
                    measurementId: "G-V4156740P2"
                },
                fbPixelId: "752472932774164",
                stand: {
                    staticUrl: "https://crocword-staging.labsystech.ru/publish/html5-staging/",
                    deployment: "https://crocword-staging.labsystech.ru"
                },
                xsolla: {
                    appId: "191467",
                    loginProjectId: "46cfe06b-d5a6-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "156455286289887",
                    rewarded: "156461976289218",
                    interstitial: "156462162955866",
                    banner: "734767451791998",
                    groupId: "1017684138380915"
                },
                facebook: {
                    shortname: "crocword",
                    appId: "480756825591552",
                    groupId: "CrocwordPuzzleCommunity",
                    stand: {
                        appId: "2040725746155240"
                    }
                },
                android: {
                    package: "com.cleverapps.crocword",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427370-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/9979156631"
                    },
                    appLovin: {
                        rewarded: "c853f44edf8c0c70"
                    }
                },
                amazon: {
                    package: "com.cleverapps.crocword",
                    id: "B074JB1CB3"
                },
                ios: {
                    package: "com.cleverapps.crocword",
                    id: "1269673961",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/5152413356"
                    }
                },
                ok: {
                    shortname: "crocword",
                    appId: "512000231014",
                    appKey: "CHGHIIJGDIHBABABA",
                    groupId: "56496148775082",
                    stand: {
                        appId: "512000309461",
                        appKey: "CGNJLJJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "crocword",
                    appId: "7234712",
                    groupId: "crocwordgroup",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "768269",
                    privateKey: "d4754dc73b088c188a115f27a6955a30",
                    groupId: "crocwordgroup",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                fotostrana: {
                    appId: "crocword",
                    privateKey: "f520f6ab3bd7fd0800700c49352315d5",
                    groupId: "352327",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "12026781",
                    groupId: "32861692"
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                gdcom: {
                    appId: "3e314ff40f40472f9aefed5b046f6dcc"
                },
                msstart: {
                    name: "Crocword Start Game",
                    appId: "9PMQ1JW17DBR",
                    packageId: "CleverAppsPteLtd.CrocwordStartGame",
                    gameUrl: "https://crocword.labsystech.ru/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                wortal: {
                    appId: 240
                },
                crazy: {
                    name: "croc-word",
                    xsolla: {
                        appId: "254976"
                    }
                }
            },
            magicwords: {
                business: "cleverapps",
                meta: "simple",
                orientation: "vertical",
                staticUrl: "https://magicwords.gcdn.co/publish/html5/",
                ruStaticUrl: "https://d5e1296e-354b-479e-9100-401cce8aecc0.selcdn.net/publish/html5/",
                deployment: "https://magicwords.labsystech.ru",
                title: "Magic Words",
                levelsPath: "cleverapps/res/wordsoup/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                type: "board",
                soft: !1,
                ui: "heroes",
                personsMinimal: {
                    hero: "magicwords_hero_magician_minimal"
                },
                persons: {
                    main: {
                        hero: "fairy_troll_enchantress"
                    }
                },
                features: ["cryptex", "letter_tournament", "stickers_collection"],
                webFirebase: {
                    apiKey: "AIzaSyDaSh-Bc8CgZtW3iDt-zlXmFfjgT9kguNk",
                    authDomain: "magic-words-ff738.firebaseapp.com",
                    databaseURL: "https://magic-words-ff738.firebaseio.com",
                    projectId: "magic-words-ff738",
                    storageBucket: "magic-words-ff738.appspot.com",
                    messagingSenderId: "986013233391",
                    appId: "1:986013233391:web:4d7c0749d872879b59ab1a",
                    measurementId: "G-JN11WX7C7Z"
                },
                fbPixelId: "517666089834893",
                stand: {
                    staticUrl: "https://magicwords-staging.labsystech.ru/publish/html5-staging/",
                    deployment: "https://magicwords-staging.labsystech.ru"
                },
                xsolla: {
                    appId: "191474",
                    loginProjectId: "e762ff93-d5b9-11ec-8589-42010aa80004"
                },
                adjust: {
                    token: "4q2wltu8pzb4",
                    purchaseToken: "vyemc2"
                },
                instant: {
                    appId: "635365383471881",
                    rewarded: "636636986678054",
                    interstitial: "636637626677990",
                    banner: "2042276392780766",
                    groupId: "214767095976110"
                },
                facebook: {
                    shortname: "magic_words_puzzle",
                    appId: "116453995539327",
                    groupId: "MagicWordsGameCommunity",
                    stand: {
                        appId: "442317226120273"
                    }
                },
                android: {
                    package: "com.cleverapps.magicwords",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427369-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/1965468076"
                    }
                },
                amazon: {
                    package: "com.cleverapps.magicwords",
                    id: "B071KKB243"
                },
                ios: {
                    package: "com.cleverapps.magicwords",
                    id: "1256304845",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/2767166438"
                    }
                },
                ok: {
                    shortname: "magic_words",
                    appId: "512000565237",
                    appKey: "CGPQJNJGDIHBABABA",
                    groupId: "60937355722922",
                    stand: {
                        appId: "",
                        appKey: ""
                    }
                },
                vk: {
                    shortname: "cleverapps_magic_words",
                    appId: "7803436",
                    groupId: "magic_words_group",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "783608",
                    privateKey: "dc5f9696c5a5b43246a624bb0e768f82",
                    groupId: "magic_words",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "",
                    groupId: ""
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                fotostrana: {
                    appId: "magicwords",
                    privateKey: "ed4e75bb8e2fd91a8842737d2daec10a",
                    groupId: "352932",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                gdcom: {
                    appId: "bbbcbc5c5b53473f9bcabe802b2f5296"
                },
                msstart: {
                    name: "Circus Words",
                    appId: "9NX77LJ8V3B0",
                    packageId: "CleverAppsPteLtd.CircusWordsStartGame",
                    gameUrl: "https://magicwords.labsystech.ru/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            olympics: {
                business: "cleverapps",
                orientation: "vertical",
                staticUrl: "https://olympics.gcdn.co/publish/html5/",
                ruStaticUrl: "https://6e012579-3ec8-4b95-9baa-ab7d2b95c0d6.selcdn.net/publish/html5/",
                deployment: "https://olympics.labsystech.ru",
                title: "Word Olympics",
                levelsPath: "cleverapps/res/crocword/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                type: "board",
                regime: "knockout",
                lives: !0,
                soft: !1,
                ui: "heroes",
                personsMinimal: {
                    hero: "tripeaks_hero_angela_minimal"
                },
                persons: {
                    main: {
                        hero: "tripeaks_elf_emeralda"
                    }
                },
                features: ["cryptex", "weeklycup", "treasure_search", "letter_tournament", "dailylevel"],
                meta: "shortmeta",
                webFirebase: {
                    apiKey: "AIzaSyBi_GhKU1kG57ivAaNAKJMH4__klCQrOKM",
                    authDomain: "olympics-6f485.firebaseapp.com",
                    databaseURL: "https://olympics-6f485.firebaseio.com",
                    projectId: "olympics-6f485",
                    storageBucket: "olympics-6f485.appspot.com",
                    messagingSenderId: "404847769770",
                    appId: "1:404847769770:web:8cacd1f8120c654a7fb8d3",
                    measurementId: "G-RPK680B8SZ"
                },
                fbPixelId: "377886100963872",
                adjust: {
                    token: "oq5rkne31atc",
                    purchaseToken: "1jir4j"
                },
                stand: {
                    staticUrl: "https://olympics-staging.labsystech.ru/publish/html5-staging/",
                    deployment: "https://olympics-staging.labsystech.ru"
                },
                xsolla: {
                    appId: "191468",
                    loginProjectId: "a5508aca-d5a9-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "403603626714071",
                    rewarded: "404667946607639",
                    interstitial: "404667353274365"
                },
                facebook: {
                    shortname: "word_olympics",
                    appId: "404908173269801",
                    groupId: "WordOlympicsPuzzle",
                    stand: {
                        appId: "144582389701216"
                    }
                },
                android: {
                    package: "com.cleverapps.olympics",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427371-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/6612167745"
                    }
                },
                amazon: {
                    package: "com.cleverapps.olympics",
                    id: "B07DGGRN8K"
                },
                ios: {
                    package: "com.cleverapps.olympics",
                    id: "1394966990",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/5308493236"
                    }
                },
                ok: {
                    shortname: "olympics",
                    appId: "512000487372",
                    appKey: "CNMQGMJGDIHBABABA",
                    groupId: "57516329402562",
                    stand: {
                        appId: "512000563796",
                        appKey: "CFFLJNJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "wordolympics",
                    appId: "7394144",
                    groupId: "wordolympicsgoup",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "771991",
                    privateKey: "21595777945c95784a620c87da88c1df",
                    groupId: "wordolympicsgroup",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "",
                    groupId: ""
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                fotostrana: {
                    appId: "olympics",
                    privateKey: "11f5cd81d3000cdff01280a75074394a",
                    groupId: "352515",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                msstart: {
                    name: "Crossword Online",
                    appId: "9NF1720Z8C3H",
                    packageId: "CleverAppsPteLtd.CrosswordOnlineStartGame",
                    gameUrl: "https://olympics.labsystech.ru/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            scramble: {
                business: "cleverapps",
                meta: "simple",
                orientation: "vertical",
                staticUrl: "https://scramble.gcdn.co/publish/html5/",
                ruStaticUrl: "https://4ba0739a-246b-4027-9634-9309c193c09a.selcdn.net/publish/html5/",
                deployment: "https://scramble.labsystech.ru",
                title: "Kitty Scramble",
                levelsPath: "res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                type: "board",
                soft: !1,
                subtype: "stacks",
                languages: ["en", "fr", "ru", "it", "de", "es", "nl", "pt", "ja", "ko"],
                changeLevelsDisabled: !0,
                ui: "tropical",
                personsMinimal: {
                    hero: "scramble_hero_cat_minimal"
                },
                persons: {
                    main: {
                        hero: "scramble_hero_cat"
                    }
                },
                features: ["boosters_before", "cryptex", "slotmachine", "treasure_search", "letter_tournament"],
                webFirebase: {
                    apiKey: "AIzaSyArMI-EEUaxznTmBeZqriIMPVqTx3BhYks",
                    authDomain: "kitty-scramble.firebaseapp.com",
                    databaseURL: "https://kitty-scramble.firebaseio.com",
                    projectId: "kitty-scramble",
                    storageBucket: "kitty-scramble.appspot.com",
                    messagingSenderId: "748420110976",
                    appId: "1:748420110976:web:ffd6a174efad2994ed2465",
                    measurementId: "G-1Q7RDD1P5J"
                },
                fbPixelId: "573411700724706",
                adjust: {
                    token: "tyz2dqp6yt4w",
                    purchaseToken: "iyhfum"
                },
                stand: {
                    staticUrl: "https://scramble-staging.labsystech.ru/publish/html5-staging/",
                    deployment: "https://scramble-staging.labsystech.ru"
                },
                xsolla: {
                    appId: "191319",
                    loginProjectId: "154a6027-d35a-11ec-8589-42010aa80004"
                },
                instant: {
                    appId: "170256430308082",
                    rewarded: "170975370236188",
                    interstitial: "170976206902771",
                    banner: "1292187124781668",
                    groupId: "kittyscramblelite"
                },
                facebook: {
                    shortname: "kittyscramble",
                    appId: "229294690917786",
                    groupId: "kittyscramblecommunity",
                    stand: {
                        appId: "540455343011567"
                    }
                },
                android: {
                    package: "com.cleverapps.scramble",
                    unityGameId: "",
                    yandexAds: {
                        rewarded: "R-M-2427368-1"
                    },
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/2890487189"
                    },
                    iap: {
                        items: {
                            gold25000: "com.cleverapps.scramble.25000gold"
                        }
                    }
                },
                amazon: {
                    package: "com.cleverapps.scramble",
                    id: "B073RHS2TQ",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/5607197042"
                    }
                },
                ios: {
                    package: "com.cleverapps.scramble",
                    id: "1256286028",
                    adMob: {
                        rewarded: "ca-app-pub-9277187477340577/8114893707"
                    }
                },
                ok: {
                    shortname: "kittyscramble",
                    appId: "512000595430",
                    appKey: "CHOGBOJGDIHBABABA",
                    groupId: "58437883658410",
                    stand: {
                        appId: "512000542947",
                        appKey: "CEOJENJGDIHBABABA"
                    }
                },
                vk: {
                    shortname: "kittyscramble",
                    appId: "7559026",
                    groupId: "kittyscramble_group",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "781640",
                    privateKey: "ea277cd8e592c36afdc068eef84052ba",
                    groupId: "kittyscramble",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                mbga: {
                    appId: "12026922",
                    groupId: "32869232"
                },
                draugiem: {
                    appId: "",
                    groupId: ""
                },
                gdcom: {
                    appId: "944186abe50e452dac7f0e8d3e0a8814"
                },
                fotostrana: {
                    appId: "scramble",
                    privateKey: "e2f2fa801cdd8f976a50b78561587172",
                    groupId: "352513",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                yandex: {
                    appId: "173180"
                },
                kongregate: {
                    appId: "324164",
                    name: "kitty-scramble"
                },
                msstart: {
                    name: "Kitty Scramble Start Game",
                    appId: "9PM1VJLZ459J",
                    packageId: "CleverAppsPteLtd.KittyScrambleStartGame",
                    gameUrl: "https://scramble.labsystech.ru/publish/html5/msstart/"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                },
                crazy: {
                    name: "kitty-scramble",
                    xsolla: {
                        appId: "250975"
                    }
                }
            },
            spades: {
                business: "zareef",
                type: "solitaire",
                meta: "simple",
                staticUrl: "https://spades.gcdn.co/publish/html5/",
                ruStaticUrl: "https://11a6e9ed-b4b7-4ce2-85e5-286a9f76eb93.selcdn.net/publish/html5/",
                deployment: "https://spades.cleverappssg.com",
                title: "Solitaria",
                levelsPath: "cleverapps/res/tripeaks/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                lives: !0,
                soft: !1,
                orientation: "vertical",
                stand: {
                    staticUrl: "https://spades.labsystech.ru/publish/html5-staging/",
                    deployment: "https://spades.labsystech.ru"
                },
                ui: "tropical",
                leagues: [30, 60, 100, 200, 500, !1],
                personsMinimal: {
                    hero: "wondermerge_dwarf_lisa_minimal"
                },
                persons: {
                    main: {
                        hero: "wondermerge_dwarf_lisa"
                    }
                },
                bundles: ["/topack/spadesbundles"],
                features: ["boosters_before", "tilegame", "treasure_search", "letter_tournament", "dailylevel"],
                instant: {
                    appId: "3255116861409850",
                    rewarded: "3261074834147386",
                    interstitial: "3261075157480687",
                    banner: "3436368703284664",
                    groupId: "solitariapage"
                },
                facebook: {
                    shortname: "cleverspades",
                    appId: "299923727721026",
                    groupId: "solitariatripeakssaga",
                    stand: {
                        appId: "882180112794499"
                    }
                },
                ok: {
                    shortname: "spades",
                    appId: "512001347501",
                    appKey: "COKQIJKGDIHBABABA",
                    groupId: "",
                    stand: {
                        appId: "",
                        appKey: ""
                    }
                },
                vk: {
                    shortname: "",
                    appId: "51499008",
                    groupId: "",
                    stand: {
                        appId: ""
                    }
                },
                mm: {
                    appId: "787097",
                    privateKey: "b04a3884179c070606116a6a08be44b2",
                    groupId: "",
                    stand: {
                        appId: "",
                        privateKey: ""
                    }
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            klondike: {
                development: !0,
                type: "klondike",
                meta: "simple",
                staticUrl: "https://klondike.gcdn.co/publish/html5/",
                deployment: "https://klondike.cleverappssg.com",
                title: "Klondike",
                levelsPath: "res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                soft: !1,
                leagues: [],
                orientation: "horizontal",
                languages: ["en"],
                stand: {
                    staticUrl: "https://klondike.labsystech.ru/publish/html5-staging/",
                    deployment: "https://klondike.labsystech.ru"
                },
                ui: "tropical",
                personsMinimal: {
                    hero: "wondermerge_dwarf_lisa_minimal"
                },
                persons: {
                    main: {
                        hero: "wondermerge_king_lottery"
                    }
                },
                features: ["boosters_before",
                    "tilegame", "highscore"
                ],
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            tetris: {
                development: !0,
                type: "blocks",
                meta: "simple",
                orientation: "vertical",
                deployment: "https://tetris.cleverappssg.com",
                title: "WoodCraft Saga",
                levelsPath: "res/levels/",
                adsense: {
                    client: "ca-pub-9277187477340577",
                    slot: "2518779793"
                },
                languages: ["en"],
                ui: "wooden",
                personsMinimal: {
                    hero: "mergecraft_king_mcarthur_minimal"
                },
                persons: {
                    main: {
                        hero: "mergecraft_king_mcarthur"
                    }
                },
                features: ["boosters_before", "highscore", "prolongation"],
                stand: {
                    staticUrl: "https://tetris.labsystech.ru/publish/html5-staging/",
                    deployment: "https://tetris.labsystech.ru"
                },
                xiaomi: {
                    adsense: {
                        client: "ca-pub-5038666584748769",
                        slot: "9823512604"
                    }
                }
            },
            tilehero: {
                business: "cleverapps",
                type: "tile3",
                meta: "simple",
                orientation: "horizontal",
                deployment: "tilehero.cleverappssg.com",
                title: "Tilehero",
                levelsPath: "cleverapps/res/zenmatch/levels/",
                lives: !0,
                languages: ["en"],
                ui: "heroes",
                personsMinimal: {
                    hero: "fairy_dwarf_violet_minimal"
                },
                persons: {
                    main: {
                        hero: "fairy_dwarf_violet"
                    }
                },
                features: ["boosters_before", "tilegame", "letter_tournament", "achievements"],
                stand: {
                    staticUrl: "https://tilehero.labsystech.ru/publish/html5-staging/",
                    deployment: "https://tilehero.labsystech.ru"
                },
                instant: {}
            },
            hustlemerge: {
                business: "cleverapps",
                type: "merge",
                meta: "none",
                orientation: "horizontal",
                staticUrl: "https://hustlemerge.gcdn.co/publish/html5/",
                deployment: "https://hustlemerge.cleverappssg.com",
                title: "Hustlemerge",
                levelsPath: ["cleverapps/res/mergecraft/levels/", "cleverapps/res/hustlemerge/levels/"],
                energy: !0,
                ui: "heroes",
                personsMinimal: {
                    hero: "hustlemerge_king_princess_minimal",
                    worker: "hustlemerge_worker_minimal",
                    dwarf: "hustlemerge_dwarf_minimal",
                    king: "mergecraft_king_mcarthur_minimal",
                    keeper: "mergecraft_keeper_zafira_minimal"
                },
                persons: {
                    main: {
                        hero: "hustlemerge_dwarf_hillbilly",
                        narrator: "mergecraft_worker_gingerbeard_redesign",
                        worker: "hustlemerge_worker",
                        dwarf: "hustlemerge_dwarf_hillbilly",
                        king: "hustlemerge_king_princess"
                    },
                    group1: {
                        bear: "mergecraft_bear_grizzly_redesign",
                        elf: "mergecraft_elf_emeralda_redesign",
                        warlock: "mergecraft_warlock_enchantress_redesign",
                        troll: "mergecraft_troll_redesign",
                        seller: "mergecraft_seller_merchant_redesign",
                        bonussale_person: "mergecraft_bonussale_person_redesign",
                        knight: "mergecraft_knight_mergelot_redesign",
                        hunter: "mergecraft_hunter_huntress_redesign",
                        centaur: "mergecraft_centaur_alvin_redesign",
                        keeper: "mergecraft_keeper_zafira_legs",
                        gnomes: "mergecraft_gnomes_bigbob_redesign",
                        shark: "mergecraft_pirate_shark_redesign",
                        camel: "mergecraft_camel_camel_redesign",
                        miner: "mergecraft_miner_miner_redesign",
                        jihn: "mergecraft_jihn_jihn_redesign",
                        kraken: "mergecraft_kraken_kraken",
                        capitannemo: "undersea2_capitan_nemo_redesign",
                        rapunzel: "rapunzel_rapunzel_redesign",
                        rpcentaur: "mergecraft_centaur_alvin_redesign",
                        rpgnomes: "mergecraft_gnomes_bigbob_redesign",
                        aviator: "xmas_aviator",
                        fish: "mergecraft_robo_fish_redesign",
                        panda: "mergecraft_panda_redesign"
                    }
                },
                features: ["map2d", "minesweeper", "clans", "achievements"],
                stand: {
                    staticUrl: "https://hustlemerge.labsystech.ru/publish/html5-staging/",
                    deployment: "https://hustlemerge.labsystech.ru"
                }
            }
        },
        CrossPromoWindow = (! function () {
            var t = {
                wordsoup: 3e3,
                scramble: 3001,
                tripeaks: 3002,
                magicwords: 3003,
                differences: 3004,
                crocword: 3005,
                mergecraft: 3006,
                riddles: 3007,
                heroes: 3008,
                olympics: 3009,
                adventure: 3010,
                runes: 3011,
                wondermerge: 3012,
                zenmatch: 3013,
                fairy: 3014,
                spades: 3015,
                epicart: 3018,
                klondike: 3019,
                woodenblock: 3020,
                tetris: 3022,
                tilehero: 3024,
                hustlemerge: 3025
            };
            Object.keys(t).forEach(function (e) {
                projects[e].restPort = t[e]
            })
        }(), "undefined" == typeof cc && (module.exports = projects), cleverapps.CrossPromo = function () {
            var e = this.load();
            e ? this.processed = e.processed : this.reset()
        }, cleverapps.CrossPromo.prototype.reset = function () {
            this.processed = [], this.save()
        }, cleverapps.CrossPromo.prototype.getFirstAvailable = function () {
            var t = void 0;
            return this.listPromotions().forEach(function (e) {
                t || -1 !== this.processed.indexOf(e.id) || (t = e)
            }, this), void 0 !== t ? t : 0 < this.processed.length ? (this.processed = [],
                this.save(), this.getFirstAvailable()) : void 0
        }, cleverapps.CrossPromo.prototype.listPromotions = function () {
            var n = [];
            return Object.keys(projects).forEach(function (e) {
                if (e !== cleverapps.config.name) {
                    var t = Platform.getPlatformConfig(e, cleverapps.platform.source);
                    if (cleverapps.config.debugMode || !t || !t.debug) {
                        var t = "crosspromo_" + e + "_" + cleverapps.settings.language,
                            s = "crosspromo_" + e + "_" + cc.sys.LANGUAGE_ENGLISH;
                        if (bundles[s]) {
                            t = {
                                id: e,
                                title: e + "PromoTitle",
                                description: e + "Promo",
                                bundleName: bundles[t] ? t : s,
                                link: Platform.guessPlatformURL(projects[e], cleverapps.config.debugMode, cleverapps.platform.source)
                            };
                            if ("crazy" !== cleverapps.platform.source && "msstart" !== cleverapps.platform.source) {
                                if ("instant" === cleverapps.platform.source || cleverapps.config.debugMode) {
                                    var s = projects[cleverapps.config.name],
                                        s = s.instant && s.instant.business || s.business,
                                        i = projects[e];
                                    if (s !== (i.instant && i.instant.business || i.business)) return
                                } !t.link && "instant" !== cleverapps.platform.source || "instant" === cleverapps.platform.source && (
                                    t.link = projects[e].instant && projects[e].instant.appId, !t.link) || ("facebook" === cleverapps.platform.source && (t.link += "?channel=" + cleverapps.config.name), "android" === cleverapps.platform.source && (t.link += "&utm_source=" + cleverapps.config.name), n.push(t))
                            }
                        }
                    }
                }
            }), n
        }, cleverapps.CrossPromo.prototype.isReady = function () {
            return !!cleverapps.user.checkAvailable(cleverapps.CrossPromo.AVAILABLE) && void 0 !== this.getFirstAvailable()
        }, cleverapps.CrossPromo.prototype.setProcessed = function (e) {
            this.processed.push(e.id), this.save()
        }, cleverapps.CrossPromo.prototype.load = function () {
            return cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PROMOTION)
        }, cleverapps.CrossPromo.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PROMOTION, {
                processed: this.processed
            })
        }, cleverapps.CrossPromo.ShowFirstAvailable = function () {
            var e = cleverapps.crossPromo.getFirstAvailable();
            new CrossPromoWindow(e)
        }, cleverapps.CrossPromo.BONUS = 10, cleverapps.CrossPromo.AVAILABLE = {
            level: 3.33
        },
            "merge" === cleverapps.config.type && (cleverapps.CrossPromo.AVAILABLE = {
                level: 8.2
            }), Window.extend({
                onWindowLoaded: function (e) {
                    this.promotion = e, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PROMO_SHOW + this.promotion.id), cleverapps.crossPromo.setProcessed(this.promotion);
                    var t = cleverapps.styles.CrossPromoWindow,
                        s = new cc.Sprite(bundles[e.bundleName].urls.image),
                        i = (cleverapps.UI.onClick(s, this.onPressed.bind(this)), cleverapps.UI.wrapWithPadding(this.createText(), {
                            bottom: t.text.padding
                        })),
                        s = new cleverapps.Layout([s, i], {
                            margin: t.margin,
                            direction: cleverapps.UI.VERTICAL
                        });
                    this._super({
                        title: e.title,
                        name: "crosspromowindow",
                        content: s,
                        button: {
                            width: t.button.width,
                            height: t.button.height,
                            text: "Play",
                            onPressed: this.onPressed.bind(this)
                        }
                    }), this.addBadge()
                },
                createText: function () {
                    var e = cleverapps.styles.CrossPromoWindow,
                        t = cleverapps.UI.generateOnlyText(this.promotion.description, cleverapps.styles.FONTS.PROMOTION_TEXT);
                    return t.setDimensions(e.text.width, 0), t.setHorizontalAlignment(
                        cc.TEXT_ALIGNMENT_CENTER), t
                },
                isRewardAvailable: function () {
                    return !(cleverapps.platform instanceof MobileVk)
                },
                onPressed: function () {
                    var e = this.promotion.link;
                    cleverapps.platform.oneOf(Instant) ? FBInstant.switchGameAsync(e, {
                        channel: cleverapps.config.name
                    }).catch(function (e) {
                        console.log("FBInstant.switchGameAsync error", e);
                        e = "USER_INPUT" === e.code ? "cancel" : "error";
                        cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PROMO + e + "_" + this.promotion.id), "error" == e && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PROMO_ERROR + cleverapps.config.platform)
                    }.bind(this)) : cc.sys.openURL(e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PROMO + this.promotion.id), this.isRewardAvailable() && new RewardWindow({
                        hard: cleverapps.CrossPromo.BONUS
                    }, {
                        event: cleverapps.EVENTS.EARN.PROMO
                    }), this.close()
                },
                addBadge: function () {
                    var e, t, s;
                    this.isRewardAvailable() && (e = new cc.Sprite(bundles.crosspromo_window.frames.badge), t = new TextWithIcon("+" + cleverapps.CrossPromo.BONUS + "$$", {
                        font: cleverapps.styles.FONTS.BADGE_TEXT
                    }), s = cleverapps.styles.CrossPromoWindow, t.setPositionRound(e.width / 2 + s.badge.price.dx, e.height / 2 + s.badge.price.dy), t.setRotation(s.badge.rotation), e.addChild(t), e.setPositionRound(this.buttons.width + s.badge.dx, this.buttons.height + s.badge.dy), this.buttons.addChild(e))
                },
                listBundles: function (e) {
                    return [e.bundleName]
                }
            })),
        Decors = (cleverapps.styles.FONTS = cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PROMOTION_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            BADGE_TEXT: {
                size: 28,
                color: cleverapps.styles.COLORS.WHITE
            }
        }), cleverapps.styles.CrossPromoWindow = {
            margin: 40,
            text: {
                width: 620,
                margin: 20,
                padding: 60
            },
            button: {
                width: 250,
                height: 80,
                margin: 0
            },
            badge: {
                dx: 20,
                dy: -33,
                rotation: 34,
                price: {
                    dx: 10,
                    dy: 0
                }
            }
        }, function (t, s) {
            var e;
            s = s || {}, this.styles = s, this.decors = {}, this.parent = t, cleverapps.styles.Decorators && (e = Object.keys(s).filter(function (e) {
                if (!0 !== s[e]) return !1;
                e = cleverapps.styles.Decorators[e];
                if (!e) return !1;
                if (e.lovesBackground && !t.withBg) return !1;
                if (
                    e.lovesBackgroundAndForeground && !t.withBg && !t.foreground) return !1;
                if (e.fearHigh && t.window && .8 < t.window.height * t.window.scale / cleverapps.UI.getSceneSize().height) return !1;
                return !(e.lovesTitle && (!t.windowTitle || !0 !== e.lovesTitle && t.windowTitle.type !== cleverapps.styles.WindowTitle.Types[e.lovesTitle]))
            }), this.init(e))
        }),
        GuideWindow = (Decors.prototype.add = function (e) {
            var t = cleverapps.styles.Decorators[e];
            if (t) {
                var s, i, n = this.getParent(t);
                switch (t.type) {
                    case Decors.TYPE_IMAGE:
                        s = this.addImage(t);
                        break;
                    case Decors.TYPE_ANIMATION:
                        s = this.addAnimation(t);
                        break;
                    case Decors.TYPE_SCALE9:
                        s = this.addScale9(t, n);
                        break;
                    case Decors.TYPE_REPEATABLE:
                        s = this.addPattern(t)
                }
                if (s) return i = this.getPos(t), n.addChild(s), s.setPositionRound(i), this.decors[e] = s
            }
        }, Decors.prototype.init = function (e) {
            e.forEach(this.add, this)
        }, Decors.prototype.initTitleDecorators = function () {
            var e = Object.keys(this.styles).filter(function (e) {
                return !0 === this.styles[e] && cleverapps.styles.Decorators[e] && cleverapps.styles.Decorators[e].lovesTitle
            }.bind(this));
            this.init(e)
        }, Decors.prototype.getDecorById = function (e) {
            if (this.decors[e]) return this.decors[e]
        }, Decors.prototype.setVisible = function (e, t) {
            e = this.getDecorById(e);
            return !!e && (t || e.stopAllActions(), e.setVisible(t), !0)
        }, Decors.prototype.getParent = function (e) {
            return e.lovesTitle ? this.parent.windowTitle : e.lovesBackground ? this.parent.bg : e.lovesBackgroundAndForeground && (this.parent.foreground || this.parent.bg) ? this.parent.foreground || this.parent.bg : e.lovesWindow ? this.parent : e.lovesButton && this.parent.button ? this.parent.button : this.parent.window
        }, Decors.prototype.addScale9 = function (e, t) {
            var s = cleverapps.UI.createScale9Sprite(bundles.main.frames[e.image] || e.image);
            return s.setContentSize2(("parent" === e.width ? t : s).width, ("parent" === e.height ? t : s).height), s.setScale(Array.isArray(e.scale) ? e.scale[cleverapps.resolution.mode] : e.scale), s.baseScale = s.scale, s.setLocalZOrder(e.zOrder),
                void 0 !== e.rotation && s.setRotation(e.rotation), s
        }, Decors.prototype.addImage = function (e) {
            var t = new cc.Sprite(bundles.main.frames[e.image] || e.image),
                s = e.scale;
            return "number" == typeof (s = Array.isArray(s) ? s[cleverapps.resolution.mode] : s) ? t.scale = s : (t.scaleX = s.x, t.scaleY = s.y), t.baseScale = Math.abs(t.scaleX), t.baseScaleX = t.scaleX, t.baseScaleY = t.scaleY, t.setLocalZOrder(e.zOrder), void 0 !== e.rotation && t.setRotation(e.rotation), t
        }, Decors.prototype.addAnimation = function (e) {
            var t = bundles.main.jsons[e.json] || e.json,
                s = new cleverapps.Spine(t),
                i = (e.scale && (e.scale.x ? s.setScale(e.scale.x, e.scale.y) : s.setScale(e.scale)), void 0 === e.looped || e.looped);
            return s.setLocalZOrder(e.zOrder), s.setVisible(!0), void 0 !== e.delay ? s.runAction(new cc.Sequence(new cc.DelayTime(e.delay), new cc.CallFunc(function () {
                s.setAnimation(0, e.animation, i)
            }))) : e.idle ? s.setAnimationAndIdleAfter(e.animation, e.idle) : s.setAnimation(0, e.animation, i), s
        }, Decors.prototype.addPattern = function (e) {
            var t, s, i = bundles.main.frames[e.image] || e.image,
                n = this.getParent(e),
                o = e.direction === cleverapps.UI.HORIZONTAL ? (t = Math.ceil(n.width / e.step) - 1, s = e.step, 0) : (t = Math.ceil(n.height / e.step) - 1, s = 0, e.step),
                a = new cc.Node;
            a.setAnchorPoint2(), a.setLocalZOrder(e.zOrder || 0);
            for (var r = 0; r < t; ++r) {
                var c = new cc.Sprite(i);
                c.setAnchorPoint2(), c.setPositionRound(r * s, -r * o), a.addChild(c)
            }
            return a
        }, Decors.prototype.getPos = function (e) {
            return e.position && Array.isArray(e.position) ? e.position[cleverapps.resolution.mode] : cc.p(e.x, e.y)
        }, Decors.prototype.updateAll = function () {
            for (var e in this.decors) {
                var t = this.decors[e],
                    e = cleverapps.styles.Decorators[e],
                    e = this.getPos(e);
                t.setPositionRound(e.x, e.y)
            }
        }, Decors.prototype.hideAll = function () {
            for (var e in this.decors) {
                var t = cleverapps.styles.Decorators[e];
                t && t.type === Decors.TYPE_ANIMATION && (e = this.decors[e], t = t.animation + "_fadeout", e && e.hasAnimation && e.hasAnimation(t) && (e.setAnimation(0, t, !1), e.setCompleteListenerRemove()))
            }
        }, Decors.TYPE_IMAGE = 0, Decors.TYPE_ANIMATION = 1, Decors.TYPE_SCALE9 = 2, Decors.TYPE_REPEATABLE = 3,
            cleverapps.styles.Decorators = {}, Window.extend({
                onWindowLoaded: function (e, t) {
                    this.stages = [], this.arrows = [], this.unit = t, this.bundleName = this.listBundles(e, t)[0], this.name = e.name, this.stagesContent = e.stagesContent ? e.stagesContent.call(this, t) : this.createSpineStages(), this._super({
                        name: e.name,
                        title: this.unit ? cleverapps.unitsLibrary.getUnitName(this.unit) : e.title || e.name + ".title",
                        content: this.createContent(),
                        noBackground: !0,
                        closeButton: !0
                    })
                },
                isVertical: function () {
                    return cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL
                },
                onShow: function () {
                    this._super(), this.showStages(), this.showArrows(), this.description && (this.description.setVisible(!1), this.description.runAction(new cc.Sequence(new cc.ScaleTo(0, 0), new cc.Show, new cc.ScaleTo(.5, this.description.scale).easing(cc.easeBackOut()))))
                },
                showStages: function () {
                    var t = .3;
                    this.stages.forEach(function (e) {
                        e.setVisible(!1), e.runAction(new cc.Sequence(new cc.ScaleTo(0, 0), new cc.Show, new cc.DelayTime(t), new cc.ScaleTo(.5, e.scale).easing(
                            cc.easeBackOut()))), t += .2
                    }, this)
                },
                showArrows: function () {
                    var i = 0;
                    this.arrows.forEach(function (e, t) {
                        var s = this.isVertical() ? "vertical" : "horizontal";
                        1 === t && cleverapps.resolution.mode === cleverapps.WideMode.SQUARE && (s = "diagonal"), e.runAction(new cc.Sequence(new cc.Hide, new cc.DelayTime(i), new cc.CallFunc(function () {
                            e.setAnimation(0, s)
                        }), new cc.Show)), i += .2
                    }, this)
                },
                createContent: function () {
                    var e, t, s = cleverapps.styles.GuideWindow,
                        i = this.createStage(this.stagesContent[0], this.name + ".firstStage"),
                        n = this.createStage(this.stagesContent[1], this.name + ".secondStage"),
                        o = this.createStage(this.stagesContent[2], this.name + ".thirdStage"),
                        a = this.createArrow(),
                        r = this.createArrow();
                    return this.stages = [i, n, o], this.arrows = [a, r], t = cleverapps.resolution.mode === cleverapps.WideMode.SQUARE ? (t = new cleverapps.Layout([i, a, n], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: s.stages.margin
                    }), (e = new cc.Node).setContentSize(r.getContentSize()), e = new cleverapps.Layout([e, o, r], {
                        direction: cleverapps.UI.HORIZONTAL,
                        align: cleverapps.UI.ALIGN_END
                    }), new cleverapps.Layout([t, e], {
                        direction: cleverapps.UI.VERTICAL
                    })) : new cleverapps.Layout([i, a, n, r, o], {
                        direction: this.isVertical() ? cleverapps.UI.VERTICAL : cleverapps.UI.HORIZONTAL,
                        margin: s.stages.margin
                    }), cleverapps.UI.onClick(t, this.close.bind(this), {
                        ignoreScale: !0
                    }), t
                },
                createArrow: function () {
                    var e = cleverapps.styles.GuideWindow.arrow,
                        t = new cleverapps.Spine(bundles[this.bundleName].jsons.arrows);
                    return t.setAnchorPoint2(), t.setPositionRound(e), t.setLocalZOrder(10), t
                },
                createStage: function (e, t) {
                    var s = cleverapps.styles.GuideWindow.stages,
                        t = cleverapps.UI.generateOnlyText(t, cleverapps.styles.FONTS.GUIDE_WINDOW_STAGE_TEXT),
                        e = (t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(this.isVertical() ? s.description.verticalWidth : s.description.width, 0), t.fitTo(void 0, s.description.height), t.setAnchorPoint2(), new cleverapps.Layout([e, t], {
                            direction: cleverapps.UI.VERTICAL,
                            margin: s.margin
                        }));
                    return e.setLocalZOrder(11), e
                },
                initStage: function (e, t) {
                    var s = new cc.Node,
                        i = (s.setAnchorPoint2(), s.setContentSize2(cleverapps.styles.GuideWindow.stages), new cc.Node);
                    return i.setAnchorPoint2(), i.setPositionRound(e.container.x, e.container.y), s.addChild(i), t(e, i), s
                },
                addUnitIcon: function (e, t, s, i) {
                    t = UnitView.getUnitImage({
                        code: t,
                        stage: s
                    }, {
                        alignAnchorX: !0,
                        preferStatic: !0,
                        alignAnchorY: i.alignAnchorY
                    }), t.setPositionRound(i), s = cc.size(i.width, i.height);
                    return (s = i.padding ? cc.rectSubPadding(cc.rect(0, 0, cleverapps.styles.GuideWindow.stages.width, cleverapps.styles.GuideWindow.stages.height), cc.padding(i.padding)) : s).width || s.height ? cleverapps.UI.fitToBox(t, {
                        width: s.width,
                        height: s.height,
                        maxScale: i.scale
                    }) : i.scale && t.setScale(i.scale), e.addChild(t), t
                },
                addSprite: function (e, t, s) {
                    if (!1 === s || !s) return new cc.Node;
                    t = new cc.Sprite(t);
                    return t.setAnchorPoint2(), t.setPositionRound(s.x, s.y), s.scale && t.setScale(s.scale), s.rotation && t.setRotation(s.rotation), e.addChild(t, s.zOrder), t
                },
                createSpineStages: function (s) {
                    var i = 0,
                        n = 0;
                    return [1, 2, 3].map(function (e) {
                        var t = new cleverapps.Spine(s && s[e - 1] || bundles[this.bundleName].jsons["guide_stages_" + e] || bundles[this.bundleName].jsons.guide_stages),
                            e = (t.setAnimation(0, "stage" + e, !0), t.setAnchorPoint2(), t.getContentSize());
                        return e.width > i && (i = e.width), e.height > n && (n = e.height), t
                    }, this).map(function (e) {
                        var t = new cc.Node;
                        return t.setContentSize(i, n), t.setAnchorPoint2(), t.addChild(e), e.setPosition(t.width / 2, t.height / 2), t
                    })
                },
                listBundles: function (e) {
                    return [e.getBundleName ? e.getBundleName() : e.name.toLowerCase()]
                }
            })),
        HardLevelWindowIcon = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            GUIDE_WINDOW_STAGE_TEXT: {
                size: 35,
                color: cleverapps.styles.COLORS.WHITE,
                lineHeight: 40
            },
            GUIDE_WINDOW_CLOSE_TEXT: {
                size: 26,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            GUIDEWINDOW_DESCRIPTION_TEXT: {
                size: 35,
                color: cleverapps.styles.COLORS.WHITE,
                lineHeight: 40
            }
        }), cleverapps.styles.GuideWindow = {
            stages: {
                width: 400,
                height: 520,
                margin: 30,
                description: {
                    width: 320,
                    verticalWidth: 500,
                    height: 156
                }
            },
            arrow: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 20
                }
            },
            closeText: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: -126
                }
            },
            description: {
                width: 1160,
                verticalWidth: 700
            }
        }, cc.Sprite.extend({
            ctor: function () {
                this._super(bundles.hard_level_icon.frames.hard_level_icon);
                var e = cleverapps.styles.HardLevelWindowIcon;
                e.rotation && this.setRotation(e.rotation)
            },
            pulseAnimation: function () {
                this.stopAllActions(), this.setScale(.1), this.setVisible(!1), this.runAction(new cc.Sequence(new cc.DelayTime(.4), new cc.CallFunc(function () {
                    this.setVisible(!0)
                }.bind(this)), new cc.ScaleTo(.5, 1.1).easing(cc.easeBackOut()), new cc.CallFunc(function () {
                    this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.5, .9).easing(cc.easeIn(1)), new cc.ScaleTo(.5, 1.1))))
                }.bind(this))))
            }
        })),
        RewardsListComponent = (cleverapps.styles.HardLevelWindowIcon = {
            rotation: -18
        }, cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.reward = e instanceof RewardsList ? e : new RewardsList(e, t),
                    this.options = t || {}, this.createContent(), t.noShowControls || cleverapps.meta.showControlsWhileFocused(this.reward.listControls())
            },
            createContent: function () {
                var e = cleverapps.styles.RewardsListComponent,
                    t = this.targets = [];
                this.reward.listRewards().forEach(function (e) {
                    e.getAmount() && t.push(this.createOneReward(e))
                }, this), this.content = new cleverapps.WrapGridLayout(t, {
                    columns: this.options.columns || this.calcColumnsCount(t.length),
                    margin: {
                        x: (this.options.margin && void 0 !== this.options.margin.x ? this.options : e).margin.x,
                        y: (this.options.margin && void 0 !== this.options.margin.y ? this.options : e).margin.y
                    }
                }), this.addChild(this.content), this.setContentSize2(this.content), this.setAnchorPoint2(), this.content.setAnchorPoint2(), this.content.setPositionRound(this.width / 2, this.height / 2)
            },
            createIcon: function (e) {
                e = this.options.small ? e.getSmallIcon() : e.getIcon();
                return e
            },
            createOneReward: function (e) {
                var t, s = cleverapps.styles.RewardsListComponent,
                    i = this.createIcon(e),
                    n = this.options.noPrefix ? "" : "x",
                    n = cleverapps.UI.generateTTFText(e.getText(n), this.options.font || cleverapps.styles.FONTS.REWARDS_LIST_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT),
                    o = (this.options.iconWrap && (cleverapps.UI.fitToBox(i, {
                        height: this.options.iconWrap.height,
                        maxScale: i.scale
                    }), (o = new cc.Node).setAnchorPoint2(), o.setContentSize(this.options.iconWrap.width || i.width * i.scale, this.options.iconWrap.height || i.height * i.scale), o.addChild(i), i.setPositionRound(o.width / 2, o.height / 2)), this.options.textWrap && ((t = new cc.Node).setAnchorPoint2(), t.setContentSize(this.options.textWrap), t.addChild(n), n.setPositionRound(t.width / 2, t.height / 2)), new cleverapps.Layout([o || i, t || n], {
                        direction: void 0 !== this.options.textDirection ? this.options.textDirection : cleverapps.UI.VERTICAL,
                        margin: (void 0 !== this.options.textMargin ? this.options : s).textMargin
                    }));
                return o.icon = i, o.text = n, o.reward = e, this.options.shine && ((t = o.shine = new cleverapps.Spine(bundles.main.jsons.reward_shine_json)).setAnimationAndIdleAfter("open", "idle"), t.setPositionRound(
                    s.shine), t.setLocalZOrder(-1), o.addChild(t)), "units" === e.type && (o.getPreferredBundles = function () {
                        return ["units"]
                    }), o
            },
            showUp: function () {
                var t = cleverapps.styles.RewardsListComponent.showUp;
                this.targets.forEach(function (e) {
                    e.shine && e.shine.setVisible(!1), e.setCascadeOpacityEnabledRecursively(!0), e.setOpacity(0), e.setPositionRound(e.x, e.y - t.startOffsetY), e.runAction(new cc.Spawn(new cc.Spawn(new cc.MoveBy(.6, 0, t.startOffsetY).easing(cc.easeOut(2)), new cc.FadeIn(.6).easing(cc.easeIn(2))), new cc.Sequence(new cc.DelayTime(.7), new cc.CallFunc(function () {
                        e.shine && (e.shine.setVisible(!0), e.shine.setAnimationAndIdleAfter("open", "idle"))
                    }))))
                })
            },
            receiveRewards: function () {
                this.reward.receiveRewards()
            },
            receiveRewardsAnimation: function (s) {
                s = s || {};
                var i = cleverapps.wait(this.targets.length, s.callback || function () { });
                cleverapps.audio.playSound(bundles.main.urls.win_reward_effect), this.targets.forEach(function (e, t) {
                    e.shine && e.shine.runAction(new cc.Sequence(new cc.DelayTime(.3 * t), new cc.CallFunc(
                        e.shine.setAnimation.bind(e.shine, 1, "close", !1)))), e.text && !s.noFadeOut && (e.text.setCascadeOpacityEnabledRecursively(!0), e.text.runAction(new cc.Sequence(new cc.DelayTime(.3 * t), new cc.FadeOut(.75)))), e.icon.setLocalZOrder(this.targets.length - t), e.reward.collectRewardsAnimation(e.icon, {
                            delay: 300 * t,
                            callback: i,
                            beginScale: e.icon.adjustScaleTo(cleverapps.scenes.getMovingNode(e.icon)).y,
                            hideSource: !s.noFadeOut,
                            small: Boolean(this.options.small)
                        })
                }.bind(this))
            },
            calcColumnsCount: function (e) {
                return e <= 3 ? e : cleverapps.resolution.mode === cleverapps.WideMode.HORIZONTAL ? 4 : 4 === e && cleverapps.resolution.mode !== cleverapps.WideMode.HORIZONTAL ? 2 : 3
            }
        })),
        RoundResultsComponent = (cleverapps.styles.RewardsListComponent = {
            margin: {
                x: 30,
                y: 30
            },
            shine: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 40
                }
            },
            showUp: {
                startOffsetY: 25,
                floatingOffset: 4
            },
            textMargin: 10
        }, cc.Node.extend({
            ctor: function (e, r) {
                this._super(), this.round = e, r = r || {}, this.setAnchorPoint2();
                var c = cleverapps.styles.RoundResultsComponent,
                    e = Game.currentGame.competition.getResults().sort(function (e) {
                        return e.player ? -1 : 1
                    });
                this.perWordTime = .05, this.maxWords = Math.max(e[0].amount, e[1].amount), this.views = e.map(function (e) {
                    var t, s = cleverapps.UI.generateTTFText(GridPlayerNameView.FormatName(e.name), r.victory ? cleverapps.styles.FONTS.SMALL_WHITE_TEXT : cleverapps.styles.FONTS.WINDOW_SMALL_TEXT),
                        i = new cleverapps.UI.Avatar(e),
                        n = e.amount,
                        o = 0,
                        a = (.2 < (o = 0 < n ? this.perWordTime * (this.maxWords / n) : o) && (o = .2), this.round.isWinner(e.id)),
                        n = new AnimatedCounterComponent({
                            from: 0,
                            to: n,
                            font: r.victory ? cleverapps.styles.FONTS.WHITE_TEXT : cleverapps.styles.FONTS.WINDOW_TEXT,
                            time: o,
                            onFinish: function () {
                                a ? this.runWinAnimation(t) : this.runLoseAnimation(t)
                            }.bind(this)
                        });
                    return a || (i.setCascadeColorEnabled(!0), i.runAction(new cc.TintTo(this.perWordTime * this.maxWords, 120, 120, 120))), (t = new cleverapps.Layout([s, i, n], {
                        direction: cleverapps.UI.VERTICAL,
                        margin: c.view.margin
                    })).avatar = i, t.words = n, t.name = s, t.player = e, t
                }, this), this.user = this.views[0],
                    this.opponent = this.views[1], this.content = new cleverapps.Layout(this.views, {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: c.margin,
                        padding: c.padding
                    }), this.setContentSize2(this.content.getContentSize()), this.addChild(this.content), this.content.setPositionRound(this.width / 2, this.height / 2), this.runAnimation()
            },
            runAnimation: function () {
                this.views.forEach(function (e) {
                    e.words.runAnimation()
                }, this)
            },
            runWinAnimation: function (e) {
                var t = cleverapps.styles.RoundResultsComponent.animation.user;
                e.runAction(new cc.Sequence(new cc.DelayTime(.5), new cc.Spawn(new cc.ScaleTo(.4, 1.3).easing(cc.easeOut(2)), new cc.MoveTo(.6, cc.p(this.content.width / 2, e.y + t.dy)))))
            },
            runLoseAnimation: function (e) {
                var t = cleverapps.scenes.getRunningScene(),
                    s = 0;
                0 === e.player.amount && (s = this.perWordTime * this.maxWords), e.runAction(new cc.Sequence(new cc.DelayTime(s), new cc.CallFunc(function () {
                    e.name.setVisible(!1), e.words.setVisible(!1), e.avatar.replaceParentSamePlace(t), e.avatar.setLocalZOrder(100), e.avatar.runAction(new cc.RepeatForever(
                        new cc.RotateBy(1, 180))), e.avatar.runAction(new cc.Sequence(new cc.MoveTo(1.2, cc.p(e.avatar.x, -e.avatar.height / 2)).easing(cc.easeIn(2)), new cc.RemoveSelf)), cleverapps.audio.playSound(bundles.game.urls.tournament_player_lose_effect)
                })))
            }
        })),
        AnimatedCounterComponent = (cleverapps.styles.RoundResultsComponent = {
            animation: {
                user: {
                    dy: -30
                }
            },
            view: {
                margin: 10
            },
            margin: 90,
            padding: {
                bottom: 80
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.setAnchorPoint2(), this.options = e, this.options.scale = this.options.scale || 1.3, this.options.onFinish = this.options.onFinish || function () { }, this.options.time = this.options.time || .3;
                e = this.options.to - this.options.from;
                this.increment = 0 < e ? 1 : 0 == e ? 0 : -1, this.text = cleverapps.UI.generateTTFText(this.options.from, this.options.font), this.addChild(this.text), this.setContentSize2(this.text.getContentSize()), this.text.setPositionRound(this.width / 2, this.height / 2), this.current = this.options.from, this.paused = !1, this.started = !1
            },
            runAnimation: function () {
                this.started = !0,
                    this.current = this.options.from, this.paused || this._animateStep()
            },
            _animateStep: function () {
                !this.paused && this.started && (this.current !== this.options.to + this.increment ? this.text.runAction(new cc.Sequence(new cc.ScaleTo(this.options.time, this.options.scale), new cc.CallFunc(function () {
                    this.text.setString(this.current), this.options.sfx && cleverapps.audio.playSound(bundles.main.urls["countdown_effect_" + this.current])
                }.bind(this)), new cc.ScaleTo(this.options.time, 1), new cc.DelayTime(this.options.time), new cc.CallFunc(function () {
                    this.current += this.increment, this._animateStep()
                }.bind(this)))) : this.options.onFinish())
            }
        })),
        RoundCountdownComponent = (cleverapps.styles.AnimatedCounterComponent = {}, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.text = cleverapps.UI.generateTTFText("RoundCountdownComponent.text", cleverapps.styles.FONTS.WHITE_TEXT), this.addChild(this.text), this.countdown = new AnimatedCounterComponent({
                    from: 3,
                    to: 1,
                    font: cleverapps.styles.FONTS.WHITE_TEXT,
                    scale: 1.5,
                    sfx: !0,
                    onFinish: function () {
                        e(), this.countdown.setVisible(!1)
                    }.bind(this)
                }), this.addChild(this.countdown), cleverapps.UI.wrap(this), cleverapps.UI.wrapWithPadding(this, cleverapps.styles.RoundCountdownComponent.padding, !0)
            },
            showUp: function () {
                this.text.setVisible(!1), this.countdown.setVisible(!1), this.runAction(new cc.Sequence(new cc.DelayTime(3), new cc.CallFunc(function () {
                    this.text.setVisible(!0)
                }.bind(this)), new cc.DelayTime(1.5), new cc.CallFunc(function () {
                    this.text.setVisible(!1), this.countdown.setVisible(!0), this.countdown.runAnimation()
                }.bind(this))))
            }
        })),
        WordsListComponent = (cleverapps.styles.RoundCountdownComponent = {
            padding: {
                bottom: 30
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.options = e, this.setAnchorPoint2();
                var e = cleverapps.styles.WordsListComponent,
                    t = this.options.width - 2 * e.word.padding.x,
                    s = e.word.height,
                    i = this.options.words,
                    n = this.options.minimalWordsAmount;
                if (i.length < n)
                    for (var o = n - i.length, a = 0; a < o; a++) i.push("");
                var n = i.map(function (e) {
                    return this.createWord(e, t, s)
                }.bind(this)),
                    n = new cleverapps.GridLayout(n, {
                        columns: 2,
                        direction: cleverapps.UI.VERTICAL,
                        reversed: !0,
                        margin: e.words.margin,
                        padding: e.words.padding
                    }),
                    r = this.createScroll(n),
                    c = new cc.Node,
                    e = (c.setAnchorPoint2(), c.setContentSize2(r.width, this.options.height), c.addChild(r), this.setContentSize2(c.width, c.height + 2 * e.topPadding), this.addChild(c), r.setPositionRound(this.width / 2, this.height / 2), c.setPositionRound(this.width / 2, this.height / 2), new cc.Scale9Sprite(bundles.wordlist.frames.words_border_png));
                e.setContentSize(2 * t, Math.min(this.options.height, n.height)), e.setPositionRound(this.width / 2, this.height / 2), c.addChild(e)
            },
            createWord: function (e, t, s) {
                var i = cleverapps.styles.WordsListComponent,
                    n = new cc.Node,
                    t = (n.setAnchorPoint2(), n.setContentSize2(t, s), this.createWordBg(t, s)),
                    s = (n.addChild(t), t.setPositionRound(n.width / 2, n.height / 2), cleverapps.UI.generateOnlyText(e.toUpperCase(), cleverapps.styles.FONTS.WHITE_TEXT));
                return n.addChild(s), s.setPositionRound(i.word.text), n
            },
            createScroll: function (e) {
                var t = cleverapps.styles.WordsListComponent,
                    e = new cleverapps.UI.ScrollView(e, {
                        childrenVisibility: cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK,
                        outOfBoundaryScale: !1
                    });
                return e.setBarPadding(t.scroll.barPadding), e.setContentSize2(2 * this.options.width + t.scroll.barPadding.sidePadding, t.scroll.height), e.scrollToPercent(100), e
            },
            createWordBg: function (e, t) {
                var s = cleverapps.styles.WordsListComponent.word.bg.padding,
                    i = new cc.Scale9Sprite(bundles.wordlist.frames.words_bg_png);
                return i.setContentSize2(e - s, t - s), i
            }
        })),
        PrizeBarComponent = (cleverapps.styles.WordsListComponent = {
            word: {
                height: 70,
                padding: {
                    x: 25
                },
                text: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: -5
                    }
                },
                bg: {
                    padding: 3
                }
            },
            scroll: {
                height: 300,
                padding: {
                    x: 30
                },
                barPadding: {
                    sidePadding: 20
                }
            },
            words: {
                margin: 200,
                padding: {
                    x: 0,
                    y: 5
                }
            },
            topPadding: 4
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.options = e, this.addProgressBar(), this.setAnchorPoint2(), this.setContentSize2(this.progressBar.getContentSize()), this.options.collected && this.setCollected(),
                    this.updateProgress(this.options.currentValue, this.options.goalValue)
            },
            setCollected: function () {
                this.setState(PrizeBarComponent.STATE_COLLECTED)
            },
            setState: function (e) {
                this.state !== e && this.state !== PrizeBarComponent.STATE_COLLECTED && (this.state = e, this.state === PrizeBarComponent.STATE_COLLECTED ? this.onCollect() : (this.prize || this.addPrize(), this.state === PrizeBarComponent.STATE_FULL && this.onFull()))
            },
            onCollect: function () {
                this.addMark(), this.removeLighting(), this.removePrize()
            },
            onFull: function () {
                this.runAction(new cc.Sequence(new cc.DelayTime(.1), new cc.CallFunc(function () {
                    cleverapps.tooltipManager.remove(this.prize), cleverapps.audio.playSound(bundles.prize.urls.prize_view_created_effect), this.addLighting(), this.addFinger(), this.addShine(), cleverapps.UI.applyHover(this.present), cleverapps.UI.onClick(this.prize, this.options.onCollect), this.present.setAnimation(0, "animation", !0)
                }.bind(this))))
            },
            addMark: function () {
                var e = this.mark = new cc.Sprite(bundles.prize.frames.mark_png);
                e.setPositionRound(
                    cleverapps.styles.PrizeBarComponent.mark), this.addChild(e)
            },
            addLighting: function () {
                var e = this.lightning = new cleverapps.Spine(bundles.progress_bar.jsons.flash_json);
                return e.setAnimation(0, "animation"), this.progressBar.addChild(e), e.runAction(new cc.RepeatForever(new cc.Sequence(new cc.CallFunc(function () {
                    e.setVisible(!0), e.setPositionRound(e.width / 2, this.progressBar.height / 2), e.setAnimation(0, "animation")
                }.bind(this)), new cc.MoveTo(.4, this.progressBar.width + this.prize.width / 2 - e.width / 2, this.progressBar.height / 2), new cc.CallFunc(function () {
                    e.setVisible(!1)
                }), new cc.DelayTime(2)))), e
            },
            removeLighting: function () {
                this.lightning && (this.lightning.removeFromParent(), delete this.lightning)
            },
            addProgressBar: function () {
                var e = cleverapps.styles.PrizeBarComponent,
                    t = this.progressBar = new ScaledProgressBar({
                        progress: bundles.progress_bar.frames.bar_dailytask,
                        background: bundles.progress_bar.frames.bg_dailytask,
                        barText: {
                            text: this.options.currentValue + "/" + this.options.goalValue,
                            font: cleverapps.styles.FONTS.SMALL_WHITE_TEXT
                        }
                    });
                t.setLength(this.options.width || e.progressBar.length), t.setPositionRound(t.width / 2, t.height / 2), this.addChild(t)
            },
            addPrize: function () {
                var e = cleverapps.styles.PrizeBarComponent.prize,
                    t = this.prize = new cc.Node;
                this.present = new cleverapps.Spine(bundles.prize.jsons.prize_json), this.present.setAnimation(0, "idle", !0), t.addChild(this.present), t.setAnchorPoint2(), t.setContentSize2(e), cleverapps.UI.fitToBox(this.present, e), this.present.setPositionRound(t.width / 2, t.height / 2 + e.present.dy), cleverapps.tooltipManager.create(t, {
                    text: "Reward",
                    rewards: this.options.reward,
                    position: cleverapps.styles.UI.Tooltip.LOCATION.below,
                    size: cleverapps.styles.UI.Tooltip.SIZE.short
                }), t.setPositionRound(e), this.addChild(t)
            },
            removePrize: function () {
                this.prize && (this.stopAllActions(), this.prize.removeFromParent(), delete this.prize)
            },
            addFinger: function () {
                var e = cleverapps.styles.PrizeBarComponent.prize;
                FingerView.hintClick(this.present, {
                    delay: .8,
                    scale: e.finger.scale,
                    rotation: e.finger.rotation
                })
            },
            addShine: function () {
                var e = this.shine = new cleverapps.Spine(bundles.prize.jsons.prize_shine_json);
                e.setPositionRound(this.prize.width / 2, this.prize.height / 2), e.setAnimation(0, "idle", !0), this.prize.addChild(e, -1)
            },
            updateProgress: function (e, t) {
                this.progressBar.setPercentage(e / t * 100), this.progressBar.updateBarText(e + "/" + t), this.state !== PrizeBarComponent.STATE_COLLECTED && this.setState(t <= e ? PrizeBarComponent.STATE_FULL : PrizeBarComponent.STATE_ACTIVE)
            }
        })),
        Base80 = (PrizeBarComponent.STATE_ACTIVE = 0, PrizeBarComponent.STATE_FULL = 1, PrizeBarComponent.STATE_COLLECTED = 2, cleverapps.styles.PrizeBarComponent = {
            progressBar: {
                length: 400
            },
            prize: {
                x: {
                    align: "right",
                    dx: 50
                },
                y: {
                    align: "center",
                    dy: 0
                },
                width: 110,
                height: 110,
                maxScale: 1.4,
                flyY: 10,
                finger: {
                    scale: .7,
                    rotation: 20
                },
                present: {
                    dy: 0
                }
            },
            mark: {
                x: {
                    align: "right",
                    dx: 80
                },
                y: {
                    align: "center",
                    dy: 0
                }
            }
        }, cleverapps.ConsoleStream = function () {
            this.messages = [], this.enabled = !1, (cleverapps.ConsoleStream.DEBUG_USERS[cleverapps.platform.getUserID()] || cleverapps.platform.oneOf(Samsung) && cleverapps.config.debugMode && !cleverapps.isLocalhost()) && (this.permanent = !0), (this.permanent || cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.CONSOLE_STREAM_START_TIME)) && this.enable()
        }, cleverapps.ConsoleStream.prototype.enable = function (e) {
            var t = cleverapps.castType(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.CONSOLE_STREAM_START_TIME, {
                raw: !0
            }));
            t || (t = Date.now(), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.CONSOLE_STREAM_START_TIME, t)), this.permanent || t + cleverapps.ConsoleStream.CONSOLE_STREAM_MAX_DURATION > Date.now() ? this.enabled || (this.enabled = !0, this.overrideConsole()) : e && e()
        }, cleverapps.ConsoleStream.prototype.disable = function () {
            this.permanent || (cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.CONSOLE_STREAM_START_TIME), this.enabled && (this.enabled = !1, this.baseConsoleLog && (console.log = this.baseConsoleLog, this.baseConsoleLog = void 0), this.baseConsoleError && (console.error = this.baseConsoleError,
                this.baseConsoleError = void 0)))
        }, cleverapps.ConsoleStream.prototype.sendMessages = function () {
            0 !== this.messages.length && (cleverapps.ConsoleStream.sendMessages("CONSOLE OUTPUT REDIRECT", this.messages), this.baseConsoleLog && this.baseConsoleLog("sended console " + this.messages.length + " messages"), this.messages = [])
        }, cleverapps.ConsoleStream.sendMessages = function (e, t) {
            e = cleverapps.ErrorHandler.formatMessage([e].concat(t));
            cleverapps.isLocalhost() || cleverapps.RestClient.sendRaw(cleverapps.RestClient.METHODS.POST, cleverapps.LOG_ERROR_URL, e)
        }, cleverapps.ConsoleStream.sendLoadingTime = function (e) {
            cleverapps.config.sendLoadingTime && (cleverapps.ConsoleStream.sendMessages("LOADING TIME", [e]), console.log(e))
        }, cleverapps.ConsoleStream.prototype.overrideConsole = function () {
            this.baseConsoleLog = console.log, this.baseConsoleError = console.error, console.error = console.log = function () {
                for (var e = 0; e < arguments.length; e++)
                    if (cleverapps.isNodeOrElement(arguments[e])) return;
                var t = Array.from(arguments).map(function (e) {
                    return JSON.stringify(e, cleverapps.ConsoleStream.serializer())
                }).join("\n");
                this.messages.push(t), this.sendMessages(), this.baseConsoleLog.apply(this, arguments)
            }.bind(this)
        }, cleverapps.ConsoleStream.serializer = function (i, n) {
            var o = [],
                a = [];
            return null == n && (n = function (e, t) {
                return o[0] === t ? "[Circular ~]" : "[Circular ~." + a.slice(0, o.indexOf(t)).join(".") + "]"
            }),
                function (e, t) {
                    var s;
                    return t instanceof cc.Node && (t = "[cc.Node " + t.__instanceId + "]"), 0 < o.length ? (~(s = o.indexOf(this)) ? o.splice(s + 1) : o.push(this), ~s ? a.splice(s, 1 / 0, e) : a.push(e), ~o.indexOf(t) && (t = n.call(this, e, t))) : o.push(t), null == i ? t : i.call(this, e, t)
                }
        }, cleverapps.ConsoleStream.CONSOLE_STREAM_MAX_DURATION = cleverapps.parseInterval("3 day"), cleverapps.ConsoleStream.DEBUG_USERS = cleverapps.createSet(["4993716770646895", "6644221842301610", "534942129934", "580731438762", "577203420866", "585959187481", "564566964211", "573870870859", "590442871830", "519644122", "59691942", "__259527704018596"]), cleverapps.DataLoader = {
            enabled: !0,
            corrupted: !1,
            _onSavedCallbacks: [],
            data: {},
            checksum: 0,
            _queue: {},
            localStorage: window.localStorage,
            setAlerted: function (e) {
                this.alerted = e
            },
            setEnabled: function (e) {
                this.enabled = e
            },
            setCorrupted: function (e) {
                this.corrupted = e
            },
            haveSavedData: function () {
                var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ID);
                return cleverapps.platform.oneOf(GDCom) ? Boolean(e && e.id === cleverapps.platform.getUserID()) : void 0 !== e
            },
            save: function (e, t, s) {
                this._queue[e] = {
                    data: t,
                    options: s
                }, this._runSaveTimeout()
            },
            onSaved: function (e) {
                void 0 === this._saveTimeout ? e() : this._onSavedCallbacks.push(e)
            },
            processSaveQueue: function () {
                for (var e in this._queue) this._queue[e].data === cleverapps.DataLoader.REMOVE ? this._removeProcess(e, this._queue[e].options) : this._saveProcess(e, this._queue[e].data, this._queue[e].options);
                this._queue = {}, this._saveTimeout = void 0;
                for (var t = 0; t < this._onSavedCallbacks.length; t++) this._onSavedCallbacks[t]();
                this._onSavedCallbacks = [], this.saveChecksum()
            },
            _runSaveTimeout: function () {
                void 0 === this._saveTimeout && (
                    this._saveTimeout = setTimeout(this.processSaveQueue.bind(this), 1e3))
            },
            _saveProcess: function (e, t, s) {
                var i = (s = s || {}).limit || cleverapps.DataLoader.FIFO_LIMIT,
                    n = s.fifoKey,
                    s = s.raw;
                if (n && !this.hasKey(e)) {
                    for (var o = this.load(n) || []; o.length >= i;) this.remove(o[0], n), o = this.load(n);
                    o.push(e), this._saveProcess(n, o), this._saveProcess(e, t)
                } else {
                    s = s ? t + "" : JSON.stringify(t);
                    if ((this.addChecksum(e, this.data[e]), this.addChecksum(e, s), this.data[e] = s, e === cleverapps.DataLoaderTypes.GIT || this.enabled && !this.corrupted) && (e === cleverapps.DataLoaderTypes.CLIENT_SESSION || (this.checkClientSession(), !this.corrupted))) try {
                        if (void 0 !== cleverapps.DataLoader.CLIENT_SESSION && e !== cleverapps.DataLoaderTypes.CLIENT_SESSION && !cleverapps.DataLoader.localStorage.getItem(cleverapps.DataLoaderTypes.CLIENT_SESSION)) throw cleverapps.eventLogger && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.CLEARANCE.LOCALSTORAGE_CLEARED), 1;
                        if (s && s.length > cleverapps.DataLoader.VALUE_LENGTH_LIMIT && cleverapps.throwAsync(
                            "Attempt to save huge value (" + s.length + ") to localstorage key - " + e), cleverapps.DataLoader.localStorage.setItem(e, s), !cc.sys.isNative && cleverapps.DataLoader.localStorage.getItem(e) !== s) throw e !== cleverapps.DataLoaderTypes.CLIENT_SESSION && cleverapps.eventLogger && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.CLEARANCE.LOCALSTORAGE_ERROR_SET_ITEM), 2
                    } catch (e) {
                        cleverapps.DataLoader.localStorage.removeItem(cleverapps.DataLoaderTypes.SESSION_SAVE_KEY), this.corrupted = !0
                    }
                }
            },
            getCharValues: function (e) {
                for (var t, s = [], i = 0; i < e.str.length; i++) t = e.str.charCodeAt(i), e.encode ? s.push(t <= 65517 ? t + 18 : t) : s.push(t <= 65535 ? t - 18 : t);
                return s
            },
            hasKey: function (e) {
                e = this._queue[e] ? this._queue[e].data : (this.data.hasOwnProperty(e) || (this.data[e] = cleverapps.DataLoader.localStorage.getItem(e)), this.data[e]);
                return null != e
            },
            checkClientSession: function () {
                if (cleverapps.isLocalhost()) return !0;
                if (void 0 !== cleverapps.DataLoader.CLIENT_SESSION) {
                    var e = cleverapps.DataLoader.localStorage.getItem(
                        cleverapps.DataLoaderTypes.CLIENT_SESSION);
                    if (e !== cleverapps.DataLoader.CLIENT_SESSION && e) return this.corrupted = !0, cleverapps.eventLogger && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.CLEARANCE.LOCALSTORAGE_SESSION_EXPIRED), cleverapps.synchronizer && cleverapps.synchronizer.clientSessionExpired(), !1
                }
                return !0
            },
            load: function (e, t) {
                if (this._queue[e]) {
                    if ((i = this._queue[e].data) === cleverapps.DataLoader.REMOVE) return;
                    var s = this._queue[e].options && this._queue[e].options.raw,
                        i = s ? i + "" : i;
                    return t && t.raw && !s ? JSON.stringify(i) : i
                }
                this.data.hasOwnProperty(e) || !this.enabled && e !== cleverapps.DataLoaderTypes.GIT || (this.data[e] = cleverapps.DataLoader.localStorage.getItem(e));
                s = this.data[e];
                if (null != s && "undefined" !== s && !(cleverapps.platform instanceof Wechat && "" === s)) {
                    if (t && t.raw) return s;
                    i = JSON.parse(s);
                    return i.dataCodes && (e = this.getCharValues({
                        str: i.dataCodes
                    }), i = JSON.parse(String.fromCharCode.apply(null, e))), i
                }
            },
            remove: function (e, t) {
                this._queue[e] = {
                    data: cleverapps.DataLoader.REMOVE,
                    options: t
                },
                    this._runSaveTimeout()
            },
            _removeProcess: function (e, t) {
                var s;
                this._queue[e] && delete this._queue[e], this.addChecksum(e, this.data[e]), delete this.data[e], this.enabled && !this.corrupted && cleverapps.DataLoader.localStorage.removeItem(e), t && (!(s = this.load(t)) || 0 <= (e = s.indexOf(e)) && (s.splice(e, 1), this.save(t, s)))
            },
            cleanAll: function () {
                if (clearTimeout(this._saveTimeout), this._saveTimeout = void 0, this._queue = {}, this.data = {}, this.checksum = 0, this.saveChecksum(), console.log("Clearing LOCALSTORAGE"), cleverapps.DataLoader.localStorage !== window.localStorage) cleverapps.DataLoader.localStorage.clear();
                else {
                    var e, t = this.getLocalStoragePrefix();
                    for (e in window.localStorage) 0 === e.indexOf(t) && (console.log("Clearing LOCALSTORAGE:" + e), cleverapps.DataLoader.localStorage.removeItem(e))
                }
                this.resetClientSession()
            },
            isEnabled: function () {
                if (!cc.sys.isNative) try {
                    return (window.localStorage.setItem("test", "testValue"), "testValue" !== window.localStorage.getItem("test")) ? !1 : (window.localStorage.removeItem("test"), !0)
                } catch (e) {
                    return !1
                }
                return !0
            },
            addChecksum: function (e, t) {
                e !== cleverapps.DataLoaderTypes.CHECKSUM && (this.checksum ^= cleverapps.hashCode(t))
            },
            loadChecksum: function () {
                return cleverapps.castType(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.CHECKSUM))
            },
            saveChecksum: function () {
                cleverapps.DataLoader._saveProcess(cleverapps.DataLoaderTypes.CHECKSUM, this.checksum)
            },
            getLocalStoragePrefix: function () {
                return cleverapps.config.name + cleverapps.platform.getLocalStoragePreffix()
            }
        }, cleverapps.DataLoader.REMOVE = -12345, cleverapps.DataLoader.FIFO_LIMIT = 10, cleverapps.DataLoader.VALUE_LENGTH_LIMIT = 1e7, cleverapps.DataLoader.resetClientSession = function () {
            cleverapps.DataLoader.CLIENT_SESSION = void 0, cleverapps.DataLoader.setEnabled(!0), cleverapps.DataLoader.setCorrupted(!1), cc.sys.isNative || (cleverapps.DataLoader.CLIENT_SESSION = Math.floor(1e9 * Math.random()) + 1 + "", cleverapps.DataLoader._saveProcess(cleverapps.DataLoaderTypes.CLIENT_SESSION, cleverapps.DataLoader.CLIENT_SESSION, {
                raw: !0
            }),
                cleverapps.DataLoader.saveChecksum(), cleverapps.DataLoader.corrupted && (cleverapps.DataLoader.setEnabled(!1), cleverapps.DataLoader.setCorrupted(!1), cleverapps.DataLoader.CLIENT_SESSION = void 0))
        }, cleverapps.DataLoaderTypes = {
            ID: "",
            HISTORY: "_history",
            CLIENT_SESSION: "_client_session",
            USERS_SYNCS: "_users_syncs",
            CHECKSUM: "_checksum",
            SETTINGS: "_settings",
            DAILY_CHEST: "_periodicBonus",
            BONUS_GAME_CHEST: "_bonus_game_chest",
            TUTORIAL: "_tutorial",
            LEVEL_HINTS: "_level_hints",
            PRODUCT_VIDEO_PROGRESS: "_v_p_",
            GAME_SAVE_FIFO: "_game_save_fifo",
            USER_IDS_HISTORY: "_ids_history",
            PAYMENTS_HISTORY_5_PRICE: "_my_payments_5_price",
            SALE_MANAGER: "_sale_manager",
            SALE: "_sale",
            SERVER_VERSION: "_server_version",
            SESSION_SAVE_KEY: "_session",
            PROMOTION: "_promotion",
            LOCALIZATION_MANAGER: "_localization_manager",
            LIVES: "_lives",
            BOOSTERS: "_boosters_counter",
            STAR_CHEST: "_star_chest",
            BONUS_EPISODES_PROGRESS: "_bonus_episodes_progress",
            VIP_LEVEL: "vip_level",
            SERVER_FLAGS: "_server_flags",
            BUY_MOVES_WINDOW: "_buy_moves_window",
            FORCES: "_forces",
            FREE_BOMB_MOVES: "_free_bomb_moves",
            UNLIMITED_LIVES: "_temp_goods",
            SORTER: "_sorter",
            FRIEND_REQUESTS: "_friend_requests",
            FAKE_REQUESTS: "_fake_request_time",
            ASKED_LIVES: "_asked_lives",
            ASKED_STARS: "_asked_stars",
            PACK: "_pack",
            DAILY_TASKS: "_daily_tasks",
            ACHIEVEMENTS: "_achievements",
            WIN_STREAK: "_win_seria",
            LOCAL_PUSHES: "_local_pushes",
            TOURNAMENT_COMPETITORS: "_tournament_competitors",
            TOURNAMENT_PLAYERS: "_tournament_players",
            TOURNAMENT_RECORD: "_tournament_record",
            PLAY_SESSION: "_play_session",
            AD_ICON: "_adicon",
            SPECIAL_LIVES_OFFER_LAST_TIME: "_special_energy_offer_last_time",
            SPECIAL_OFFER_LAST_TIME: "_special_offer_last_time",
            LEVEL_ATTEMPTS: "_level_attempts",
            MONSTER_PLANNER: "_monster_planner",
            GROWINGS_PLANNER: "_growings_planner",
            LAST_VIEWED_FRIEND_REQUEST: "_last_viewed_friend_request",
            MISSIONS: "_missions",
            COMPETITION: "_competition",
            COMPETITION_PLAYERS: "_competition_players",
            COMPETITION_STATISTICS: "_competition_statistics",
            PLACEMENTS: "_placements",
            PIGGY_BANK: "_piggy_bank",
            SUBSCRIPTION: "_subscription",
            GROWTHFUND: "_growthfund",
            INSTANT_BOT_CREATED: "_instant_bot_created",
            HEROES: "_heroes",
            CUP: "_cup",
            CUP_RULES: "cup_rules",
            MINI_GAME_RECORD: "_mini_game_record",
            INFORMATION: "_info",
            SYNC: "_sync",
            LAST_SYNC_IN: "_last_sync_in",
            FRIDAY_SALE: "_friday_sale",
            LANTERN: "_lantern",
            FARM: "_clockmaker_a",
            FISHDOM: "_fishdom",
            HOMEFIX: "_home",
            DAILY_LEVEL: "_daily_level",
            KNOCKOUT: "_knockout",
            SHORTMETA: "_short",
            COOKIE_JAR: "_cookie_jar",
            RATED: "_rated",
            SIMPLE: "_simple",
            HIGHSCORE: "_loop",
            JACKPOT_LAST_APPEAR_TIME: "_jackpot_last_appear_time",
            ADMIN_CHART: "_admin_chart",
            SCROLL: "_scroll",
            MAP2D: "_map2d",
            QUESTS: "_quests",
            QUESTS_LOCAL: "_quests_local",
            UNIT_SAVER_KICKOUTS: "_unit_saver_kickouts",
            UNITS_LIBRARY: "_units_library",
            UNITS_SHOP: "_units_shop",
            WORKERS: "_workers",
            HARVESTED: "_harvested",
            FOGS: "_fogs",
            POCKET: "_pocket",
            ARMY_LIBRARY: "_armylib",
            CHAT: "_chat",
            CONSOLE_STREAM_START_TIME: "_console_stream_start_time",
            RESET_REPORT: "_reset_report",
            ADS_LIMITS_DATA: "_ads_limits_data",
            ENERGY_PRODUCTS: "_energy_products",
            GAME_DATA: "_game_data",
            ABTEST: "_abtest",
            BARREL_PLANNER: "_barrel_planner",
            PIXELS_PLANNER: "_pixels_planner",
            SPECIALOFFERS_PLANNER: "_specialoffers_planner",
            BUBBLES: "_bubbles",
            TRAVEL_BOOK_EVENTS: "_travel_book_events_",
            TRAVEL_BOOK_ATTENTION: "_travel_book_attention_",
            EXPEDITION_PUSH_PLANNING_TIME: "_expedition_push_planning_time",
            UNKNOWN_UNIT_TEST: "_unknown_unit_test",
            USER_CLAN: "_user_clan",
            SNAPSHOT_TIME_DELTA: "_snapshot_time_delta",
            ARMY: "_army",
            TROOP_CARDS: "_troop_cards",
            TRAVEL_BOOK_HINT_TIME: "_travel_book_hint_time",
            USER_DELETE: "_user_delete",
            OFFER_PURCHASE_TIME: "_offer_purchase_time_",
            GAME_MODES: "_game_modes",
            ADS_SKINS: "_ads_skins",
            LANDMARK_INFO: "_landmark_info",
            INSTANT_TOURNAMENT: "_instcup",
            THROWERROR: "_debug_throwerror",
            TEST_SOUNDS: "_test_sounds",
            LAST_SUCCESSFUL_SHARE: "_last_successful_share",
            AD_OCEAN_TOKEN: "_ad_ocean_token",
            GIT: "_git",
            UNLOCKED_TILES_STAGES: "_unlocked_tiles_number"
        }, cleverapps.DataLoader.init = function () {
            var t = cleverapps.DataLoader.getLocalStoragePrefix();
            if (Object.keys(cleverapps.DataLoaderTypes).forEach(function (e) {
                cleverapps.DataLoaderTypes[e] = t + cleverapps.DataLoaderTypes[e]
            }), "function" == typeof cleverapps.DataLoader.localStorage.getData) console.log("DataLoader.getData read single batch"), cleverapps.DataLoader.data = cleverapps.DataLoader.localStorage.getData();
            else if (!cc.sys.isNative || cleverapps.platform.oneOf(Microsoft, Mygames)) try {
                void 0 !== window.localStorage && window.localStorage && Object.keys(window.localStorage).forEach(function (e) {
                    0 === e.indexOf(t) && (this.data[e] = cleverapps.DataLoader.localStorage.getItem(e))
                }.bind(this))
            } catch (e) {
                console.warn("DataLoader.getData cant read all data", e)
            } else console.log("DataLoader.getData cant read all data");
            var e, s = this.loadChecksum();
            for (e in this.data) this.addChecksum(e, this.data[e]);
            var i = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ID);
            (cleverapps.DataLoader.hasKey(cleverapps.DataLoaderTypes.CHECKSUM) || Version.compare("1.237.0",
                i && i.version) < 0) && (this.checksumMatch = this.checksum === s, this.checksumMatch || (cleverapps.config.debugMode ? console.error("checksum different storage - " + s + ", actual - " + this.checksum) : console.log("checksum different"))), this.saveChecksum(), cleverapps.DataLoader.resetClientSession()
        }, cleverapps.Availables = {
            LEADER_BOARD: {
                level: 1.2
            },
            BONUS_ROUND: {
                level: .67
            },
            DAILY_TASKS: {
                level: 2.87
            },
            INVITE_FRIENDS_ICON: {
                level: .93
            },
            CREATE_SHORTCUT: {
                level: .33
            },
            JOIN_GROUP: {
                level: 6
            },
            CLANS: {
                level: 8.5,
                source: ["facebook", "instant", "android", "amazon", "microsoft"],
                projectName: ["mergecraft", "wondermerge", "fairy"],
                cleverapps: {
                    debugMode: !0,
                    level: 8.5,
                    projectName: ["mergecraft", "wondermerge", "fairy"]
                }
            },
            EXPEDITIONS: {
                level: 7
            }
        }, "merge" === cleverapps.config.type && (cleverapps.Availables.DAILY_TASKS = {
            level: 6
        }, cleverapps.Availables.INVITE_FRIENDS_ICON = {
            level: 6.8
        }, cleverapps.Availables.CREATE_SHORTCUT = {
            level: 3
        }, cleverapps.Availables.PIXELS = {
            level: 4.5
        }), cleverapps.Settings = function () {
            cleverapps.EventEmitter.call(this),
                this.onChangeSoundListener = function () { }, this.onChangeMusicListener = function () { }, this.load()
        }, cleverapps.Settings.prototype = Object.create(cleverapps.EventEmitter.prototype), cleverapps.Settings.prototype.constructor = cleverapps.Settings, cleverapps.Settings.getDefaultLanguage = function () {
            var e = cleverapps.config.languages;
            if (1 === e.length) return e[0];
            var t = cc.sys.language;
            if (-1 !== e.indexOf(t) && t !== cc.sys.LANGUAGE_ENGLISH) return t;
            for (var s = cleverapps.platform.getSuggestedLanguage(), i = 0; i < s.length; i++) {
                var n = s[i];
                if (-1 !== e.indexOf(n)) return n
            }
            return cc.sys.LANGUAGE_ENGLISH
        }, cleverapps.Settings.prototype.getSaveInfo = function () {
            return {
                sound: this.sound,
                music: this.music,
                language: this.language
            }
        }, cleverapps.Settings.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SETTINGS, this.getSaveInfo()), cleverapps.synchronizer.addUpdateTask("settings")
        }, cleverapps.Settings.prototype.loadData = function (e) {
            void 0 === e ? (this.sound = !0, this.music = !0,
                this.language = cleverapps.Settings.getDefaultLanguage(), this.save()) : (this.sound = e.sound, this.music = e.music, this.language = e.language, this.manualResolution = e.manualResolution, this.manualResolution && (cleverapps.resolution.resolutionName = this.manualResolution)), void 0 === this.language && (this.language = cleverapps.Settings.getDefaultLanguage())
        }, cleverapps.Settings.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SETTINGS);
            this.loadData(e)
        }, cleverapps.Settings.prototype.toggleSound = function () {
            this.sound = !this.sound, console.log("Settings toggle sound", this.sound, cc.game.isPaused()), this.save(), this.onChangeSoundListener()
        }, cleverapps.Settings.prototype.toggleMusic = function () {
            this.music = !this.music, cleverapps.audio.onChangeMusic(), console.log("Settings toggle music", this.music, cc.game.isPaused()), this.save(), this.onChangeMusicListener()
        }, cleverapps.Settings.prototype.setLanguage = function (e) {
            this.language = e, this.save()
        },
            cleverapps.Settings.prototype.updateDependents = function () {
                this.language === cc.sys.LANGUAGE_RUSSIAN && cleverapps.dailyLevel && !cleverapps.dailyLevel.currentEvent && cleverapps.dailyLevel.load(), "board" === cleverapps.config.type && (cleverapps.episodes.reset(), cleverapps.hose && cleverapps.hose.reset()), cleverapps.paymentsCountry.update()
            }, cleverapps.Settings.prototype.setManualResolution = function (e) {
                this.manualResolution = e;
                e = this.getSaveInfo();
                e.manualResolution = this.manualResolution, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SETTINGS, e), cleverapps.DataLoader.processSaveQueue(), window.location.reload()
            }, {
            expandNumber: function (e) {
                var t = 0,
                    s = 1;
                return e.split("").reverse().forEach(function (e) {
                    void 0 === Base80.DECODE_NUMBERS[e] && (t = NaN), t += Base80.DECODE_NUMBERS[e] * s, s *= 80
                }), t
            },
            compactNumber: function (e, t) {
                var s = "";
                if (0 === e) s = Base80.STR.charAt(0);
                else
                    for (; 0 < e || !s;) s += Base80.ENCODE_NUMBERS[e % 80], e = Math.floor((e - e % 80) / 80);
                if (t)
                    for (; s.length < t;) s += Base80.STR.charAt(0);
                return s.split("").reverse().join("")
            }
        }),
        EventManager = (Base80.STR = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=!#$%&()*-<>?@^|", Base80.ENCODE_NUMBERS = {}, Base80.DECODE_NUMBERS = {}, Base80.STR.split("").forEach(function (e, t) {
            Base80.ENCODE_NUMBERS[t] = e, Base80.DECODE_NUMBERS[e] = t
        }), "undefined" == typeof cc && (module.exports = Base80), cleverapps.Event = function (e) {
            this.features = e.features || [], this.options = e.options || {}, this.projects = e.projects, this.networks = e.networks, this.start = this.convertTimezone(e.start), this.finish = this.convertTimezone(e.finish), this.toolApplicable = e.toolApplicable
        }, cleverapps.Event.prototype.convertTimezone = function (e) {
            e = new Date(e);
            return e.setMinutes(e.getMinutes() + e.getTimezoneOffset()), e
        }, cleverapps.Event.prototype.isRunning = function () {
            return this.start.getTime() <= Date.now() && Date.now() <= this.finish.getTime()
        }, cleverapps.Event.prototype.getTimeBeforeStart = function () {
            return Math.max(0, this.start.getTime() - Date.now())
        }, cleverapps.Event.prototype.getTimeAfterFinish = function () {
            return Math.max(0, Date.now() - this.finish.getTime())
        }, cleverapps.Event.prototype.getTimeLeft = function () {
            return this.finish.getTime() - Date.now()
        }, cleverapps.Event.prototype.getStartTime = function () {
            return this.start.getTime()
        }, cleverapps.Event.prototype.isAvailable = function () {
            if (this.networks) {
                if (Array.isArray(this.networks) && !this.networks.includes(cleverapps.platform.source)) return !1;
                if (this.networks.except && this.networks.except.includes(cleverapps.platform.source)) return !1
            }
            return !this.projects || -1 !== this.projects.indexOf(cleverapps.config.name)
        }, function () {
            this.currentFeatures = {}, this.events = [], bundles.main.jsons.friday_schedule && (this.events = cc.loader.getRes(bundles.main.jsons.friday_schedule).filter(function (e) {
                return !e.debug || cleverapps.config.debugMode
            }).map(function (e) {
                return new cleverapps.Event(e)
            })), this.setCurrentFeatures()
        }),
        Placements = (EventManager.prototype.isActive = function (e) {
            return this.currentFeatures[e] && this.currentFeatures[e].isRunning()
        },
            EventManager.prototype.listCurrentFeatures = function () {
                return Object.keys(this.currentFeatures).filter(function (e) {
                    return this.currentFeatures[e].isRunning()
                }, this)
            }, EventManager.prototype.getFeatureEvent = function (e) {
                return this.currentFeatures[e]
            }, EventManager.prototype.isEventApplicable = function (e) {
                return cleverapps.config.debugMode && void 0 !== e.toolApplicable ? e.toolApplicable : e.isRunning() && e.isAvailable()
            }, EventManager.prototype.setCurrentFeatures = function () {
                var e = this.events.filter(this.isEventApplicable.bind(this));
                this.currentFeatures = {}, e.forEach(function (t) {
                    t.features.forEach(function (e) {
                        this.currentFeatures[e] = t
                    }.bind(this))
                }, this)
            }, EventManager.prototype.listFeatureEvents = function (t) {
                return this.events.filter(function (e) {
                    return e.features.includes(t) && e.isAvailable()
                })
            }, EventManager.prototype.getNextFeatureEvent = function (e) {
                return this.listFeatureEvents(e).filter(function (e) {
                    return 0 < e.getTimeBeforeStart()
                }).sort(function (e, t) {
                    return e.getTimeBeforeStart() - t.getTimeBeforeStart()
                })[0]
            }, EventManager.prototype.getLastFeatureEvent = function (e) {
                return this.listFeatureEvents(e).filter(function (e) {
                    return 0 < e.getTimeAfterFinish()
                }).sort(function (e, t) {
                    return e.getTimeAfterFinish() - t.getTimeAfterFinish()
                })[0]
            }, EventManager.prototype.setCustomFeature = function (t, e) {
                var s = {
                    features: [t],
                    start: void 0,
                    finish: void 0
                },
                    i = new Date,
                    e = (i.setMinutes(i.getMinutes() - i.getTimezoneOffset()), i.setSeconds(i.getSeconds() - 1), s.start = i.toISOString(), i.setMilliseconds(i.getMilliseconds() + e), s.finish = i.toISOString(), this.events.filter(function (e) {
                        return -1 !== e.features.indexOf(t)
                    }));
                e.length ? e.forEach(function (e) {
                    e.start = e.convertTimezone(s.start), e.finish = e.convertTimezone(s.finish)
                }) : this.events.push(new cleverapps.Event(s)), this.setCurrentFeatures()
            },
            function () {
                this.data = this.initialize(), this.sortKeys(), this.load(), cleverapps.whenAllInitialized(function () {
                    this.run(Placements.STARTUP)
                }.bind(this)), cleverapps.meta.onFocusLostListenerPlacements = function () {
                    cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition() ? this.run(Placements.FREE_FOCUS_MAIN) : cleverapps.environment.isGameScene() ? this.run(Placements.FREE_FOCUS_GAME) : this.run(Placements.FREE_FOCUS_OTHER)
                }.bind(this), cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, cleverapps.throttle(1e3, function () {
                    this.run(Placements.ONSHOW)
                }.bind(this)))
            }),
        PlaySession = (Placements.prototype.sortKeys = function () {
            this.sortedKeys = Object.keys(this.data), this.sortedKeys.sort(function (e, t) {
                return e = this.data[e], ((t = this.data[t]).priority || 0) - (e.priority || 0)
            }.bind(this)), this.keysByType = {}
        }, Placements.prototype.listKeys = function (t) {
            if (this.keysByType[t]) return this.keysByType[t];
            var e = this.sortedKeys.filter(function (e) {
                return 0 != (this.data[e].type & t)
            }, this);
            return this.keysByType[t] = e
        }, Placements.prototype.initialize = function () {
            var t = "merge" === cleverapps.config.type;
            return {
                recalculateFlags: {
                    type: Placements.ONSHOW_OR_STARTUP | Placements.INTERMEDIATE_OR_AFTER_FINISH,
                    action: function () {
                        cleverapps.flags.update()
                    }
                },
                versionCheck: {
                    type: Placements.ONSHOW_OR_STARTUP,
                    action: function () {
                        cleverapps.versionChecker.check()
                    },
                    interval: "1 hour"
                },
                versionCheckAlert: {
                    type: Placements.FREE_FOCUS,
                    priority: 11,
                    filter: function () {
                        return cleverapps.versionChecker.needUpdate()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "VersionChecker.Alert",
                            action: function (e) {
                                new NewVersionWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    }
                },
                displaySceneIntro: {
                    type: Placements.FREE_FOCUS,
                    priority: -1e3,
                    filter: function () {
                        return !cleverapps.scenes.getRunningScene().introShown
                    },
                    action: function () {
                        var t = cleverapps.scenes.getRunningScene(),
                            s = [];
                        !cleverapps.config.wysiwygMode && cleverapps.silentIntro && cleverapps.loadedSnapshot && cleverapps.loadedSnapshot.actions && (s = cleverapps.loadedSnapshot.actions), cleverapps.meta.display({
                            focus: "Scene.intro",
                            control: t.introControls(),
                            actions: [function (e) {
                                t.introShown = !0, t.playIntro(e, cleverapps.silentIntro), cleverapps.silentIntro = !1
                            }, function (e) {
                                cleverapps.restoreProgress.update(), e(), s.length && (console.log("loaded snapshot played"), cleverapps.snapshots.playActions(s)), cleverapps.clipPlayer && cleverapps.clipPlayer.run()
                            }]
                        })
                    }
                },
                packManager: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: 3,
                    filter: function () {
                        return cleverapps.packManager.needDisplayWindow()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "showPackWindow",
                            action: function (e) {
                                new PackWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    },
                    delayFromStart: "5 minutes"
                },
                interstitialNoOutcomeGames: {
                    type: Placements.FREE_FOCUS,
                    priority: 0,
                    filter: function () {
                        return !cleverapps.config.wysiwygMode && t && cleverapps.rewardedAdsManager.canShowInterstitial() && !cleverapps.platform.oneOf(Crazy)
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "PlacementInterstitial",
                            action: function (e) {
                                cleverapps.rewardedAdsManager.showInterstitial(e)
                            }
                        })
                    },
                    interval: "1 minutes",
                    delayFromStart: "3 minutes"
                },
                createShortcut: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.platform.canCreateShortcut() && levels.user.checkAvailable(cleverapps.Availables.CREATE_SHORTCUT)
                    },
                    action: function () {
                        cleverapps.platform.createShortcut()
                    },
                    interval: "10 minutes"
                },
                joinGroup: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return levels.user.checkAvailable(cleverapps.Availables.JOIN_GROUP)
                    },
                    action: function () {
                        cleverapps.platform.followOfficialPage()
                    },
                    interval: "7 days",
                    delayFromStart: "10 minutes"
                },
                canUpgradeHeroes: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: -1,
                    filter: function () {
                        return "undefined" != typeof match3 && void 0 !== match3.heroes && (match3.heroes.available() && cleverapps.forces.isShown(Forces.HEROES_AVAILABLE.id) && match3.heroes.canUpgradeSomebody())
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "CanUpgradeHeroWindow",
                            action: function (e) {
                                new CanUpgradeHeroWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    },
                    interval: "10 minutes"
                },
                piggyBankFull: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.piggyBank && cleverapps.piggyBank.isActive() && cleverapps.piggyBank.isFull()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "PiggyBankWindow",
                            control: "MenuBarGoldItem",
                            action: function (e) {
                                new PiggyBankWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    },
                    interval: "1 hour"
                },
                showRestore: {
                    type: Placements.FREE_FOCUS,
                    action: function () {
                        cleverapps.paymentsManager.showRestore()
                    }
                },
                subscriptionOffer: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.subscription.needDisplayWindow()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "SubscriptionWindow",
                            action: function (e) {
                                new SubscriptionWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    },
                    interval: cleverapps.platform.oneOf(MobileOK, OKPlatform) ? "1 day" : "3 day",
                    delayFromStart: "10 minutes"
                },
                promotion: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: -1,
                    filter: function () {
                        return cleverapps.crossPromo.isReady()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "CrossPromoWindow",
                            action: function (e) {
                                cleverapps.CrossPromo.ShowFirstAvailable(), cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    },
                    interval: "3 days",
                    delayFromStart: "10 seconds"
                },
                starChest: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.starChest && !cleverapps.starChest.locked
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "StarChestWindow",
                            action: function (e) {
                                new StarChestWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    }
                },
                unlimitedLivesStart: {
                    type: Placements.ONSHOW_OR_STARTUP,
                    filter: function () {
                        return 0 === levels.user.episode && cleverapps.unlimitedLives && !cleverapps.unlimitedLives.checkBuyed()
                    },
                    action: function () {
                        cleverapps.unlimitedLives.buy("3 hours"), cleverapps.lives.onBuyUnlimitedLivesListener()
                    }
                },
                unlimitedLivesWindow: {
                    type: Placements.FREE_FOCUS,
                    priority: 0,
                    filter: function () {
                        return cleverapps.unlimitedLives && cleverapps.environment.hasScene([cleverapps.Environment.SCENE_MAIN, cleverapps.Environment.SCENE_DAILY_CUP])
                    },
                    action: function () {
                        cleverapps.unlimitedLives.displayPromotionOnFinish()
                    }
                },
                minigameNudge: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: 4,
                    filter: function () {
                        return 0 < cleverapps.missionManager.getPlayableMissions().length
                    },
                    action: function () {
                        for (var e = cleverapps.missionManager.getPlayableMissions(), t = 0; t < e.length; t++) {
                            var s = e[t];
                            if (s.nudgeWindow && s.started && (void 0 === s.needShowStartWindow || s.needShowStartWindow)) return void cleverapps.meta.display({
                                focus: "NudgeWindow",
                                action: function (e) {
                                    new s.nudgeWindow(s), cleverapps.meta.onceNoWindowsListener = e
                                }
                            })
                        }
                    },
                    interval: "10 minutes"
                },
                localstorageDisabled: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: 8,
                    filter: function () {
                        return !cleverapps.DataLoader.enabled && !cleverapps.DataLoader.alerted
                    },
                    action: function () {
                        cleverapps.DataLoader.setAlerted(!0), cleverapps.meta.display({
                            focus: "LocalStorageDisabledWindow",
                            action: function (e) {
                                new LocalStorageDisabledWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    }
                },
                sideBarIcons: {
                    type: Placements.FREE_FOCUS,
                    action: function () {
                        "undefined" != typeof ClansCupIcon && cleverapps.sideBar.resetByClassName(ClansCupIcon), cleverapps.sideBar.resetByClassName(LandmarkDonorIcon)
                    }
                },
                sideBarForce: {
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return !cleverapps.environment.isGameScene() && void 0 !== cleverapps.sideBar.anyIconWithForceIndex()
                    },
                    action: function () {
                        cleverapps.sideBar.showAnyForce()
                    }
                },
                cryptexForce: {
                    type: Placements.FREE_FOCUS_GAME,
                    priority: -1001,
                    filter: function () {
                        return Game.currentGame && Game.currentGame.cryptex && Game.currentGame.cryptex.canShowForce()
                    },
                    action: function () {
                        Game.currentGame.cryptex.showForce()
                    }
                },
                playChangeOutcome: {
                    type: Placements.FREE_FOCUS_GAME,
                    priority: 0,
                    filter: function () {
                        return cleverapps.scenes.getRunningScene().wantPlayChangeOutcome
                    },
                    action: function () {
                        cleverapps.scenes.getRunningScene().playChangeOutcome()
                    }
                },
                heroesTutorial: {
                    type: Placements.FREE_FOCUS_OTHER,
                    filter: function () {
                        return cleverapps.environment.isHeroesScene() && "undefined" != typeof match3 && match3.heroes && (match3.heroes.getUnlockTutorialHero() || match3.heroes.getUpgradeTutorialHero())
                    },
                    action: function () {
                        match3.heroes.displayHeroForce(match3.heroes.getUnlockTutorialHero() || match3.heroes.getUpgradeTutorialHero())
                    }
                },
                homefixNewTask: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.meta.getType() === Metha.HOMEFIX && cleverapps.home.needNewTask()
                    },
                    action: function () {
                        var e = cleverapps.home.furniture.filter(function (e) {
                            return e.readyToOpen()
                        });
                        cleverapps.meta.display({
                            focus: "homefixNewTask",
                            actions: e.map(function (t) {
                                return function (e) {
                                    cleverapps.home.giveNewTask(e, t)
                                }
                            })
                        })
                    }
                },
                toolbarForce: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.toolbar.anyItemWithForce()
                    },
                    action: function () {
                        cleverapps.toolbar.showAnyForce()
                    }
                },
                keypadForce: {
                    priority: -1001,
                    type: Placements.FREE_FOCUS_GAME,
                    filter: function () {
                        return Game.currentGame && Game.currentGame.keypad && Game.currentGame.keypad.getAvailableForce()
                    },
                    action: function () {
                        var t = Game.currentGame.keypad.getAvailableForce();
                        t && cleverapps.meta.display({
                            focus: "Keypad.force",
                            action: function (e) {
                                Game.currentGame.keypad.showForce(e, t)
                            }
                        })
                    }
                },
                knockoutTutorial: {
                    priority: -1001,
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return cleverapps.isKnockoutGame() && cleverapps.knockoutTutorial.isAvailable()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "KnockoutTutorialStep" + cleverapps.knockoutTutorial.step,
                            control: cleverapps.knockoutTutorial.control,
                            action: function (e) {
                                cleverapps.knockoutTutorial.run(e)
                            }
                        })
                    }
                },
                missionFinished: {
                    type: Placements.FREE_FOCUS,
                    priority: 5,
                    filter: function () {
                        if (!cleverapps.config.demoMode && (cleverapps.missionManager.removeSilents(), cleverapps.environment.isMainScene())) return cleverapps.missionManager.wantsToShowCompleted()
                    },
                    action: function () {
                        var t = cleverapps.missionManager.wantsToShowCompleted();
                        t && cleverapps.meta.display({
                            focus: "missionCompleted" + t.name,
                            action: function (e) {
                                t.displayCompleted(e)
                            }
                        })
                    }
                },
                missionManagerProcess: {
                    type: Placements.FREE_FOCUS,
                    priority: 5,
                    filter: function () {
                        return cleverapps.environment.isMainScene() && !cleverapps.config.demoMode
                    },
                    action: function () {
                        cleverapps.missionManager.run();
                        var e = cleverapps.missionManager.pendingStartWindow();
                        e && cleverapps.missionManager.showStartWindow(e)
                    },
                    delayFromStart: "1 minutes"
                },
                missionStartWindow: {
                    type: Placements.FREE_FOCUS,
                    priority: 6,
                    filter: function () {
                        return cleverapps.environment.isMainScene() && cleverapps.missionManager.pendingStartWindow()
                    },
                    action: function () {
                        cleverapps.missionManager.showStartWindow(cleverapps.missionManager.pendingStartWindow())
                    }
                },
                missionReplaceOld: {
                    type: Placements.FREE_FOCUS,
                    priority: 7,
                    filter: function () {
                        return cleverapps.missionManager.getUnfinishedOldMission()
                    },
                    action: function () {
                        cleverapps.missionManager.replaceOldMission()
                    }
                },
                displayPassWindow: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        var e = cleverapps.missionManager.findLocalPass();
                        return e && e.logic.needDisplayWindow() && !cleverapps.config.demoMode
                    },
                    action: function () {
                        var t = cleverapps.missionManager.findLocalPass();
                        t.isRunning() ? t.logic.displayWindow() : cleverapps.meta.display({
                            focus: "missionCompleted" + t.name,
                            action: function (e) {
                                t.displayCompleted(e)
                            }
                        })
                    }
                },
                friendsCache: {
                    type: Placements.ONSHOW_OR_STARTUP,
                    filter: function () {
                        return cc.sys.isNative
                    },
                    action: function () {
                        cleverapps.friends.reload(), cleverapps.invitalbleFriends.reload()
                    }
                },
                localPushes: {
                    type: Placements.ONSHOW_OR_STARTUP,
                    action: function () {
                        cleverapps.localPushes.onShow()
                    }
                },
                syncClientSessionExpiredWindow: {
                    type: Placements.FREE_FOCUS,
                    priority: 1e4,
                    filter: function () {
                        return cleverapps.synchronizer.needClientSessionExpiredWindow()
                    },
                    action: function () {
                        cleverapps.synchronizer.showClientSessionExpiredWindow()
                    }
                },
                syncReloadWindow: {
                    type: Placements.FREE_FOCUS,
                    priority: 10001,
                    filter: function () {
                        return cleverapps.synchronizer._syncIn.needShowReloadWindow()
                    },
                    action: function () {
                        cleverapps.synchronizer._syncIn.showReloadWindow()
                    }
                },
                syncSocialConnectWindow: {
                    type: Placements.FREE_FOCUS,
                    priority: 11,
                    filter: function () {
                        return cleverapps.synchronizer.wantsSocialConnectWindow
                    },
                    action: function () {
                        cleverapps.synchronizer.displaySocialConnectWindow()
                    }
                },
                sync: {
                    type: Placements.ONSHOW,
                    action: function () {
                        cleverapps.synchronizer.syncWhenReady()
                    },
                    interval: "30 seconds"
                },
                checkConnection: {
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        var e = t ? {
                            level: 5
                        } : {
                            level: 1.13
                        };
                        return !cleverapps.flags.nologin && !cleverapps.social.isLoggedIn() && cleverapps.user.checkAvailable(e)
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "checkConnection",
                            action: function (e) {
                                cleverapps.social.checkConnection(e, e, {
                                    withWindow: !0
                                })
                            }
                        })
                    },
                    interval: "7 days"
                },
                checkConnectionStartup: {
                    type: Placements.FREE_FOCUS,
                    once: !0,
                    filter: function () {
                        return !cleverapps.flags.nologin && !cleverapps.social.isLoggedIn() && cleverapps.social instanceof CrazySocial
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "checkConnection",
                            action: function (e) {
                                cleverapps.social.checkConnection(e, e, {
                                    withWindow: !0
                                })
                            }
                        })
                    }
                },
                mergeRateWindow: {
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return t && RateWindow.CanRate()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "nativePlacementRate",
                            action: function (e) {
                                new RateWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    }
                },
                subscriptionReload: {
                    type: Placements.ONSHOW_OR_STARTUP,
                    filter: function () {
                        return cleverapps.subscription
                    },
                    action: function () {
                        cleverapps.subscription.reload()
                    }
                },
                animatePassLevel: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: -2,
                    filter: function () {
                        return PlayButton.IsAvailable() && cleverapps.playButton.passedLevel && cleverapps.isLevels()
                    },
                    action: function () {
                        cleverapps.playButton.animatePassLevel()
                    }
                },
                simpleForce: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: 9,
                    filter: function () {
                        return cleverapps.meta.getType() === Metha.SIMPLE && cleverapps.simple.isForceAvailable()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "simpleForce",
                            control: ["play_button"],
                            actions: [function (e) {
                                PlayButton.IsAvailable() && cleverapps.playButton.passedLevel && cleverapps.playButton.animatePassLevel(), 0 < cleverapps.simple.pendingsStars ? cleverapps.simple.updateProgress(e) : e()
                            }, function (e) {
                                cleverapps.simple.showForce(e)
                            }]
                        })
                    }
                },
                simpleUpdateProgress: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: -2,
                    filter: function () {
                        return cleverapps.meta.getType() === Metha.SIMPLE && 0 < cleverapps.simple.pendingsStars && !cleverapps.simple.canMoveNext()
                    },
                    action: function () {
                        cleverapps.simple.updateProgress()
                    }
                },
                simpleMoveNext: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: 10,
                    filter: function () {
                        return cleverapps.meta.getType() === Metha.SIMPLE && cleverapps.simple.canMoveNext()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "simpleMoveNext",
                            control: ["play_button"],
                            actions: [function (e) {
                                PlayButton.IsAvailable() && cleverapps.playButton.passedLevel && "woodenblock" !== cleverapps.config.name && cleverapps.playButton.animatePassLevel(), 0 < cleverapps.simple.pendingsStars ? cleverapps.simple.updateProgress(e) : e()
                            }, function (e) {
                                cleverapps.simple.moveNext(e)
                            }]
                        })
                    }
                },
                bonusWorldFinished: {
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return cleverapps.environment.isBonusWorldScene() && cleverapps.scenes.getRunningScene().bonusWorld.isFinished()
                    },
                    action: function () {
                        var t = cleverapps.scenes.getRunningScene().bonusWorld;
                        cleverapps.meta.display({
                            focus: "bonusWorldFinished",
                            action: function (e) {
                                t.finish(e)
                            }
                        })
                    }
                },
                bonusWorldReward: {
                    type: Placements.FREE_FOCUS,
                    priority: 2,
                    filter: function () {
                        return cleverapps.environment.isBonusWorldScene() && cleverapps.scenes.getRunningScene().bonusWorld.getAvailableReward()
                    },
                    action: function () {
                        var t = cleverapps.scenes.getRunningScene().bonusWorld;
                        cleverapps.meta.display({
                            focus: "bonusWorldReward",
                            actions: [function (e) {
                                t.levelPassed ? (t.animateChangeProgress(), setTimeout(e, 2e3)) : e()
                            }, function (e) {
                                t.giveReward(e)
                            }]
                        })
                    }
                },
                bonusWorldProgress: {
                    type: Placements.FREE_FOCUS,
                    priority: 1,
                    filter: function () {
                        return cleverapps.environment.isBonusWorldScene() && cleverapps.scenes.getRunningScene().bonusWorld.levelPassed
                    },
                    action: function () {
                        cleverapps.scenes.getRunningScene().bonusWorld.animateChangeProgress()
                    }
                },
                runCounterStages: {
                    type: Placements.FREE_FOCUS,
                    priority: 1,
                    action: function () {
                        t && Game.currentGame && Game.currentGame.showUpFinished && !Game.currentGame.counter.isActive() && Game.currentGame.counter.trigger()
                    }
                },
                repeatedQuests: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: 1,
                    filter: function () {
                        return t && cleverapps.environment.isMainScene() && Game.currentGame && Game.currentGame.quests.isRepeatedQuestsAvailable()
                    },
                    action: function () {
                        Game.currentGame.quests.runRepeatedQuests()
                    },
                    interval: cleverapps.config.debugMode ? "10 seconds" : "1 hour"
                },
                slotMachineForce: {
                    type: Placements.FREE_FOCUS_OTHER,
                    filter: function () {
                        var e = cleverapps.missionManager.findByType(Mission.TYPE_SLOT_MACHINE);
                        return cleverapps.environment.isSlotMachineScene() && e && e.logic.isForceAvailable()
                    },
                    action: function () {
                        var e = cleverapps.missionManager.findByType(Mission.TYPE_SLOT_MACHINE);
                        e && e.logic.showForce()
                    }
                },
                slotMachineHelpForce: {
                    priority: -10,
                    type: Placements.FREE_FOCUS_OTHER,
                    filter: function () {
                        var e = cleverapps.missionManager.findByType(Mission.TYPE_SLOT_MACHINE);
                        return cleverapps.environment.isSlotMachineScene() && e && e.logic.isHelpForceAvailable()
                    },
                    action: function () {
                        var e = cleverapps.missionManager.findByType(Mission.TYPE_SLOT_MACHINE);
                        e && e.logic.showHelpForce()
                    }
                },
                runSpecialEnergyOffer: {
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return t && cleverapps.environment.isMainScene() && Game.currentGame.specialEnergyOffer.showPlacement
                    },
                    action: function () {
                        Game.currentGame.specialEnergyOffer.showPlacement = !1, Game.currentGame.specialEnergyOffer.displayWindow()
                    }
                },
                showChatPresents: {
                    priority: 1,
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return void 0 !== cleverapps.chatPresents && (cleverapps.environment.isMainScene() || cleverapps.environment.isGameScene())
                    },
                    action: function () {
                        cleverapps.chat.giveRewards()
                    }
                },
                growthFund: {
                    type: Placements.FREE_FOCUS_MAIN,
                    priority: -2,
                    filter: function () {
                        return cleverapps.growthFund && cleverapps.growthFund.wantsAttention && cleverapps.growthFund.isActive()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "GrowthFundNudge",
                            action: function (e) {
                                new GrowthFundWindow, cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    }
                },
                flyingAd: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.flyingAd && cleverapps.flyingAd.needUpdate()
                    },
                    action: function () {
                        cleverapps.flyingAd.update()
                    }
                },
                subscriptionReward: {
                    type: Placements.FREE_FOCUS_MAIN,
                    interval: "1 day",
                    filter: function () {
                        return cleverapps.subscription && cleverapps.subscription.isRewardReady() && Subscription.IsAvailable()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "SubscriptionReward",
                            action: function (e) {
                                new ShopWindow({
                                    tab: ShopWindow.TABS.HARD_CURRENCY,
                                    priorityType: SubscriptionTile,
                                    finger: !0
                                }), cleverapps.meta.onceNoWindowsListener = e
                            }
                        })
                    }
                },
                updateMissionTreeUnit: {
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return "undefined" != typeof MissionTree && MissionTree.wantsToUpdateUnitStage
                    },
                    action: function () {
                        MissionTree.processStateChange()
                    }
                },
                seasonWindow: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return Game.currentGame && Game.currentGame.season && Game.currentGame.season.hasFresh()
                    },
                    action: function () {
                        Game.currentGame.season.processFresh()
                    }
                },
                returnBonus: {
                    type: Placements.FREE_FOCUS,
                    priority: 50,
                    filter: function () {
                        return cleverapps.returnBonus.shouldReward()
                    },
                    action: function () {
                        cleverapps.returnBonus.giveReward()
                    }
                },
                dailyCupReward: {
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return cleverapps.dailyCup.getReward()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "dailyCupReward",
                            action: function (e) {
                                cleverapps.dailyCup.receiveReward(e)
                            }
                        })
                    }
                },
                weeklyCupReward: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.weeklyCup.getReward()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "weeklyCupReward",
                            action: function (e) {
                                cleverapps.weeklyCup.receiveReward(e)
                            }
                        })
                    }
                },
                clanCupReward: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.clanCup.getReward()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "clanCupReward",
                            action: function (e) {
                                cleverapps.clanCup.receiveReward(e)
                            }
                        })
                    }
                },
                clanCupWindow: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.clanCup.wantsToShow
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "ClansCupIcon",
                            actions: [function (e) {
                                new GuideWindow({
                                    name: "ClanCupGuideWindow"
                                }),
                                    cleverapps.meta.onceNoWindowsListener = e
                            }, function (e) {
                                new ClansCupWindow, cleverapps.meta.onceNoWindowsListener = e
                            }]
                        })
                    }
                },
                travelBook: {
                    type: Placements.FREE_FOCUS,
                    priority: 5,
                    filter: function () {
                        return t && cleverapps.environment.isMainScene()
                    },
                    action: function () {
                        cleverapps.travelBook.updatePages(), cleverapps.toolbar.resetByType(ToolbarItem.TRAVEL_BOOK)
                    }
                },
                luckyBonus: {
                    type: Placements.FREE_FOCUS_GAME,
                    filter: function () {
                        return cleverapps.troopCards && cleverapps.troopCards.isLuckyBonusReady()
                    },
                    action: function () {
                        cleverapps.troopCards.showLuckyBonus()
                    }
                },
                troopCardsForce: {
                    type: Placements.FREE_FOCUS,
                    priority: -1001,
                    filter: function () {
                        return cleverapps.troopCards && Game.currentGame && cleverapps.troopCards.isForceAvailable()
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "TroopCardsForce",
                            control: ["MenuBarCoinsItem"],
                            action: function (e) {
                                cleverapps.troopCards.showForce(e, Forces.TROOP_CARDS_FORCE), cleverapps.forces.onceForceClosed = e
                            }
                        })
                    }
                },
                newTroopWindow: {
                    type: Placements.FREE_FOCUS_GAME,
                    filter: function () {
                        return "battlefield" === cleverapps.config.type && void 0 !== cleverapps.armyLibrary.getUnopenedAvailable()
                    },
                    action: function () {
                        var t = cleverapps.armyLibrary.getUnopenedAvailable();
                        cleverapps.meta.display({
                            focus: "NewTroopWindow",
                            actions: [function (e) {
                                new NewTroopWindow(t), cleverapps.meta.onceNoWindowsListener = e
                            }, function (e) {
                                cleverapps.troopCards.showNewUnitForce(e, t)
                            }]
                        })
                    }
                },
                softForce: {
                    type: Placements.FREE_FOCUS_GAME,
                    filter: function () {
                        return "battlefield" === cleverapps.config.type && !cleverapps.forces.isShown(Forces.MENU_BAR_SOFT_FORCE.id) && cleverapps.user.checkAvailable(Forces.MENU_BAR_SOFT_FORCE.available)
                    },
                    action: function () {
                        cleverapps.menuBar.showForce("CoinsItem")
                    }
                },
                playButtonForce: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return "battlefield" === cleverapps.config.type && !cleverapps.forces.isShown(Forces.METHA_PLAY_BUTTON.id)
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "PlayButtonForce",
                            action: function (e) {
                                cleverapps.scenes.getRunningScene().showPlayButtonForce(e)
                            }
                        })
                    }
                },
                pastAchievements: {
                    type: Placements.FREE_FOCUS_MAIN,
                    filter: function () {
                        return cleverapps.achievements && cleverapps.achievements.wantsPastCheck
                    },
                    action: function () {
                        cleverapps.achievements.checkPastFeats()
                    }
                },
                loadOldUserId: {
                    type: Placements.ONSHOW_OR_STARTUP,
                    filter: function () {
                        return cleverapps.platform.loadOldUserId && !cleverapps.platform.oldUserId
                    },
                    action: function () {
                        cleverapps.platform.loadOldUserId(function (e) {
                            e && (console.log("old userId loaded", e), cleverapps.platform.oldUserId = e, cleverapps.userIdsHistory.add(e))
                        })
                    },
                    interval: "1 day"
                },
                syncOldUserId: {
                    type: Placements.FREE_FOCUS,
                    priority: 12,
                    filter: function () {
                        return cleverapps.platform.oldUserId && cleverapps.synchronizer.isReady()
                    },
                    action: function () {
                        cleverapps.synchronizer.getProgress(cleverapps.platform.oldUserId, {
                            acceptOnlyIfBetter: !0,
                            callback: function () {
                                cleverapps.platform.oldUserId = void 0
                            }
                        })
                    }
                },
                loginStatusChanged: {
                    type: Placements.FREE_FOCUS,
                    filter: function () {
                        return cleverapps.platform.oneOf(Samsung) && cleverapps.social.loginStatusChanged
                    },
                    action: function () {
                        cleverapps.meta.display({
                            focus: "loginStatusChanged",
                            action: function () {
                                new RestartWindow({
                                    contentMessage: "RestartWindow.OnChangeLoginStatus"
                                })
                            }
                        })
                    }
                },
                notifyLoaded: {
                    type: Placements.FREE_FOCUS,
                    priority: 10002,
                    filter: function () {
                        return cleverapps.platform.notifyLoaded && !cleverapps.platform.notifyLoadedDone && cleverapps.platform.isConnected(Platform.PLATFORM)
                    },
                    action: function () {
                        cleverapps.platform.notifyLoadedDone = !0, cleverapps.platform.notifyLoaded()
                    }
                }
            }
        }, Placements.prototype.resetAllPlacements = function () {
            this.lastStarts = {}, this.onceStarts = {}, this.save()
        }, Placements.prototype.run = function (e, t) {
            t = t || {};
            for (var s = this.listKeys(e), i = 0; i < s.length; i++) {
                var n = s[i],
                    o = this.data[n];
                if (!o.once || !this.onceStarts[n]) {
                    if (o.interval) {
                        var a = cleverapps.parseInterval(o.interval);
                        if ((this.lastStarts[n] || 0) + a > Date.now()) continue
                    }
                    if (o.delayFromStart && !t.skipDelayFromStart) {
                        a = cleverapps.parseInterval(o.delayFromStart);
                        if ((cleverapps.user.visited || 0) + a > Date.now()) continue
                    }
                    if (!o.filter || o.filter()) {
                        var r = 0 != (o.type & Placements.FREE_FOCUS);
                        if (r) {
                            if (cleverapps.meta.isFocused()) continue;
                            if (-1 === o.priority) {
                                if (cleverapps.loadedSnapshot && !this.lastFreeFocusStart) continue;
                                if (this.lastFreeFocusStart + cleverapps.parseInterval("1 minute") > Date.now()) continue
                            }
                        }
                        if (o.action(), this.lastStarts[n] = Date.now(), o.once && (this.onceStarts[n] = !0), r && cleverapps.meta.isFocused()) {
                            this.lastFreeFocusStart = Date.now();
                            break
                        }
                    }
                }
            }
            this.save()
        }, Placements.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PLACEMENTS) || {};
            this.onceStarts = e.onceStarts || {}, this.lastStarts = e.lastStarts || {}
        }, Placements.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PLACEMENTS, this.getInfo())
        }, Placements.prototype.getInfo = function () {
            return {
                lastStarts: this.lastStarts
            }
        }, Placements.STARTUP = 1, Placements.ONSHOW = 2, Placements.INTERMEDIATE = 4, Placements.AFTER_GAME_FINISH = 16, Placements.FREE_FOCUS_MAIN = 32, Placements.FREE_FOCUS_GAME = 64, Placements.FREE_FOCUS_OTHER = 128,
            Placements.ONSHOW_OR_STARTUP = Placements.ONSHOW | Placements.STARTUP, Placements.INTERMEDIATE_OR_AFTER_FINISH = Placements.INTERMEDIATE | Placements.AFTER_GAME_FINISH, Placements.FREE_FOCUS = Placements.FREE_FOCUS_MAIN | Placements.FREE_FOCUS_GAME | Placements.FREE_FOCUS_OTHER,
            function () {
                this.load(), this.onEndSessionListeners = [PlaySession.RewardedReporter, PlaySession.BannerAdReporter, PlaySession.DailyTasksReporter, PlaySession.HelpByAttemptsReporter, PlaySession.SettingsReporter, PlaySession.CupsReporter, PlaySession.MiniGameReporter, PlaySession.MissionReporter, PlaySession.BonusWorldReporter, PlaySession.GrowthFundReporter, PlaySession.ExpeditionReporter, PlaySession.DebugReporter, PlaySession.ClansReporter, PlaySession.UnitsReporter, PlaySession.ActiveTimeReporter, PlaySession.AbtestReporter, PlaySession.LocalPushesReporter, PlaySession.YooKassaReporter, PlaySession.ContextLostReporter, PlaySession.OkSessionReporter]
            }),
        ExecutorPool = (PlaySession.prototype.load = function () {
            var e = (e = cleverapps.DataLoader.load(
                cleverapps.DataLoaderTypes.PLAY_SESSION)) || {};
            this.data = e
        }, PlaySession.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PLAY_SESSION, this.data)
        }, PlaySession.prototype.endSession = function () {
            this.onEndSessionListeners.forEach(function (e) {
                e(this.data)
            }, this), this.data = {}, this.save()
        }, PlaySession.prototype.inc = function (e, t, s) {
            void 0 === t && (t = 1);
            var i = this.data[e];
            void 0 === i && (i = 0), s && ((i = i || {})[s] = i[s] ? i[s] + t : t), this.set(e, s ? i : i + t)
        }, PlaySession.prototype.set = function (e, t, s) {
            void 0 !== s ? (this.data[e] = this.data[e] || {}, this.data[e][s] = t) : this.data[e] = t, this.save()
        }, PlaySession.prototype.get = function (e) {
            return this.data[e]
        }, PlaySession.prototype.notifyActive = cleverapps.throttle(cleverapps.parseInterval("1 minute"), function () {
            this.inc(cleverapps.EVENTS.STATS.ACTIVE_TIME);
            var e = cleverapps.travelBook.getCurrentExpedition();
            e && this.inc("expActive", 1, e.id)
        }), PlaySession.AbtestReporter = function (e) {
            var t, s, i;
            for (t in e.expActive) i = (s = TravelBook.findPageById(t)) && s.prefix ? "_" + s.prefix : "", cleverapps.abTest.allLogEvent(cleverapps.EVENTS.STATS.ACTIVE_TIME + i, {
                value: e.expActive[t],
                expedition: t
            }), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.STATS.ACTIVE_TIME_DAU + i, {
                expedition: t
            });
            var n = e[cleverapps.EVENTS.STATS.ACTIVE_TIME];
            for (t in n && (cleverapps.abTest.allLogEvent(cleverapps.EVENTS.STATS.ACTIVE_TIME, {
                value: n,
                expedition: "main"
            }), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.STATS.ACTIVE_TIME_DAU, {
                expedition: "main"
            })), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.STATS.DAU, {
                expedition: "main"
            }), e[cleverapps.EVENTS.EXPEDITION_DAU]) i = (s = TravelBook.findPageById(t)) && s.prefix ? "_" + s.prefix : "", cleverapps.abTest.allLogEvent(cleverapps.EVENTS.EXPEDITION_DAU + i, {
                expedition: t
            })
        }, PlaySession.ActiveTimeReporter = function (e) {
            var e = e[cleverapps.EVENTS.STATS.ACTIVE_TIME] || 0,
                t = cleverapps.user.getDaysSinceRegistration() <= 3 ? "new" : "old";
            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.ACTIVE_TIME + "_" + t, {
                value: e
            }), cleverapps.eventLogger.logEvent(
                cleverapps.EVENTS.STATS.ACTIVE_TIME_DAU + "_" + t)
        }, PlaySession.SettingsReporter = function () {
            cleverapps.whenAllInitialized(function () {
                var e = Boolean(cleverapps.config.webpSupport);
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.RESOLUTION + cleverapps.resolution.resolutionName), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.WEBP + e)
            })
        }, PlaySession.RewardedReporter = function (e) {
            e[cleverapps.EVENTS.STATS.REWARDED_AVAILABLE_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.REWARDED_AVAILABLE_DAU), e[cleverapps.EVENTS.STATS.REWARDED_NOADS_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.REWARDED_NOADS_DAU), e[cleverapps.EVENTS.STATS.REWARDED_ERROR_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.REWARDED_ERROR_DAU), e[cleverapps.EVENTS.STATS.REWARDED_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.REWARDED_DAU), e[cleverapps.EVENTS.STATS.REWARDED_LOADED_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.REWARDED_LOADED_DAU),
                e[cleverapps.EVENTS.ADS.SESSION_FINISH + "_" + RewardedAdsManager.REWARDED] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ADS.SESSION_FINISH + "_" + RewardedAdsManager.REWARDED, {
                    value: e[cleverapps.EVENTS.ADS.SESSION_FINISH + "_" + RewardedAdsManager.REWARDED]
                }), 5 <= e[cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_ADS_COUNT] && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_ADS_COUNT, {
                    value: e[cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_ADS_COUNT]
                }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.DAY_1_ADS_COUNT_DAU)), e[cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_ADS_VALUE] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_ADS_VALUE, {
                    value: e[cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_ADS_VALUE],
                    currency: "USD"
                });
            e = e[cleverapps.EVENTS.STATS.VIP_REWARDED_WATCHED];
            e && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.VIP_REWARDED_WATCHED, {
                value: e
            }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.VIP_REWARDED_DAU))
        },
            PlaySession.BannerAdReporter = function (e) {
                e[cleverapps.EVENTS.STATS.BANNER.DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.BANNER.DAU);
                var t = cleverapps.EVENTS.ADS.TYPE + "banner";
                e[t] && cleverapps.eventLogger.logEvent(t, {
                    value: e[t],
                    impressions: e[cleverapps.EVENTS.ADS.TYPE + "banner-impressions"]
                })
            }, PlaySession.HelpByAttemptsReporter = function (e) {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HELP_BY_ATTEMPTS_DAU);
                e = e[cleverapps.EVENTS.HELP_BY_FIVE_ATTEMPTS];
                1 <= e && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HELP_BY_ATTEMPTS_ONE_AND_MORE), 3 <= e && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HELP_BY_ATTEMPTS_THREE_AND_MORE), 5 <= e && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HELP_BY_ATTEMPTS_FIVE_AND_MORE)
            }, PlaySession.DailyTasksReporter = function (e) {
                cleverapps.dailyTasks && cleverapps.dailyTasks.isAvailable() && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SESSION_DAILY_TASK_AVAILABLE),
                    e[cleverapps.EVENTS.SESSION_DAILY_TASK_OPEN_WINDOW] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SESSION_DAILY_TASK_OPEN_WINDOW), 0 < cleverapps.dailyTasks.getFinishedTasks().length && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SESSION_DAILY_TASK_FINISH + "_" + cleverapps.dailyTasks.getFinishedTasks().length), (e = e[cleverapps.EVENTS.SESSION_DAILY_TASK_REWARD]) && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SESSION_DAILY_TASK_REWARD + "_" + e))
            }, PlaySession.CupsReporter = function (t) {
                Object.keys(t).forEach(function (e) {
                    t[e] && (0 !== e.indexOf(cleverapps.EVENTS.CUP_DAU) && 0 !== e.indexOf(cleverapps.EVENTS.CUP_PLAYERS) || cleverapps.eventLogger.logEvent(e))
                })
            }, PlaySession.MiniGameReporter = function (t) {
                Object.keys(t).forEach(function (e) {
                    0 === e.indexOf(cleverapps.EVENTS.MINIGAME_FINISH) && t[e] && cleverapps.eventLogger.logEvent(e + "_dau")
                })
            }, PlaySession.MissionReporter = function (t) {
                Object.keys(t).forEach(function (e) {
                    0 === e.indexOf(cleverapps.EVENTS.MISSION_DAU) && t[e] && cleverapps.eventLogger.logEvent(e)
                })
            },
            PlaySession.BonusWorldReporter = function (e) {
                e[cleverapps.EVENTS.BONUS_WORLD_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BONUS_WORLD_DAU), e[cleverapps.EVENTS.BONUS_WORLD_LEVEL_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BONUS_WORLD_LEVEL_DAU)
            }, PlaySession.GrowthFundReporter = function (e) {
                e[cleverapps.EVENTS.FUND_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FUND_DAU)
            }, PlaySession.ExpeditionReporter = function (e) {
                for (var t in e[cleverapps.EVENTS.EXPEDITION_DAU]) {
                    t = TravelBook.findPageById(t), t = t && t.prefix ? "_" + t.prefix : "";
                    cleverapps.eventLogger.logEvent(cleverapps.EVENTS.EXPEDITION_DAU + t)
                }
            }, PlaySession.DebugReporter = function (e) {
                for (var t in e[cleverapps.EVENTS.DEBUG.MERGE.UNKNOWN_UNIT_DAU]) cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.MERGE.UNKNOWN_UNIT_DAU + "-" + t);
                e[cleverapps.EVENTS.DEBUG.UNKNOWN_MISSION_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.UNKNOWN_MISSION_DAU)
            }, PlaySession.ClansReporter = function (e) {
                e[cleverapps.EVENTS.CLANS_DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.CLANS_DAU)
            }, PlaySession.UnitsReporter = function (i) {
                var e = i[cleverapps.EVENTS.UNITS_AMOUNT];
                if (e) {
                    for (var t in e.amount) cleverapps.eventLogger.logEvent(cleverapps.EVENTS.UNITS_AMOUNT + "_" + t + "_" + e.level, {
                        value: e.amount[t]
                    });
                    cleverapps.eventLogger.logEvent(cleverapps.EVENTS.UNITS_AMOUNT_DAU + "_" + e.level)
                }
                if (i[cleverapps.EVENTS.EARNED_MAGICPLANT])
                    for (var n in i[cleverapps.EVENTS.EARNED_MAGICPLANT]) cleverapps.eventLogger.logEvent(cleverapps.EVENTS.EARNED_MAGICPLANT + "_" + n, {
                        value: i[cleverapps.EVENTS.EARNED_MAGICPLANT][n]
                    });
                if ([cleverapps.EVENTS.EARNED_COINSPLANT, cleverapps.EVENTS.EARNED_RUBIESPLANT, cleverapps.EVENTS.EARNED_ENERGYPLANT].forEach(function (e) {
                    for (var t = [0, 1, 2], s = 0; s < t.length; s++)
                        if (i[e + "_" + s])
                            for (n in i[e + "_" + s]) cleverapps.eventLogger.logEvent(e + "_" + s + "_" + n, {
                                value: i[e + "_" + s][n]
                            })
                }), i[cleverapps.EVENTS.CASTLE_PRIZES])
                    for (n in i[cleverapps.EVENTS.CASTLE_PRIZES])
                        for (
                            var s in i[cleverapps.EVENTS.CASTLE_PRIZES][n]) cleverapps.eventLogger.logEvent(cleverapps.EVENTS.CASTLE_PRIZES + "_" + s + "_" + n, {
                                value: i[cleverapps.EVENTS.CASTLE_PRIZES][n][s]
                            });
                if (i[cleverapps.EVENTS.PET_RATE])
                    for (var o in i[cleverapps.EVENTS.PET_RATE]) cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PET_RATE + o.replace("clpet", ""), {
                        value: i[cleverapps.EVENTS.PET_RATE][o]
                    })
            }, PlaySession.LocalPushesReporter = function () {
                cleverapps.localPushes.permitted && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PUSHES.PERMITTED_DAU)
            }, PlaySession.YooKassaReporter = function (e) {
                e[cleverapps.EVENTS.STATS.YOOKASSA.DAU] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.YOOKASSA.DAU)
            }, PlaySession.ContextLostReporter = function (e) {
                var t = cleverapps.EVENTS.STATS.ERROR_CONTEXT_LOST,
                    e = e[t];
                0 < e && (cleverapps.eventLogger.logEvent(t + "_dau"), 2 <= e && cleverapps.eventLogger.logEvent(t + "_2"))
            }, PlaySession.OkSessionReporter = function (e) {
                e[cleverapps.EVENTS.DEBUG.OK_SESSION_EXPIRED] && cleverapps.eventLogger.logEvent(
                    cleverapps.EVENTS.DEBUG.OK_SESSION_EXPIRED), e[cleverapps.EVENTS.DEBUG.OK_SESSION_RESTORED] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.OK_SESSION_RESTORED)
            }, PlaySession.ACTIVE_TIME_INTERVAL = "1 minute",
            function (e) {
                this.amount = (e = e || {}).amount || 1e3, this.interval = e.interval || "1 second", this.events = new cleverapps.EventsQueue(this.interval), this.delay = cleverapps.parseInterval(e.delay || "0 second"), this.tasks = [], this.timeout = void 0
            }),
        GameModes = (ExecutorPool.prototype.execute = function (e) {
            this.tasks.push({
                callback: e,
                event: Date.now()
            }), this.processFirst()
        }, ExecutorPool.prototype.processFirst = function () {
            if (void 0 !== this.timeout && (clearTimeout(this.timeout), delete this.timeout), 0 !== this.tasks.length) {
                var e = this.tasks[0],
                    t = Date.now();
                if (e.event + 100 < t && t < e.event + this.delay) this.timeout = setTimeout(this.processFirst.bind(this), t - e - this.delay);
                else {
                    if (this.events.size() >= this.amount) {
                        var s = this.events.getShrinkLeftTime();
                        if (s && 0 < s && this.events.size() >= this.amount) return void (
                            this.timeout = setTimeout(this.processFirst.bind(this), s))
                    }
                    this.tasks.shift(), e.callback() !== cleverapps.NO_ACTION && this.events.add(t), this.processFirst()
                }
            }
        }, cleverapps.Flags = function () {
            cleverapps.EventEmitter.call(this), this.init(), cleverapps.whenAllInitialized(function () {
                cleverapps.paymentsHistory.onAddPaymentListeners.flags = this.update.bind(this)
            }.bind(this))
        }, cleverapps.Flags.prototype = Object.create(cleverapps.EventEmitter.prototype), cleverapps.Flags.prototype.constructor = cleverapps.Flags, cleverapps.Flags.prototype.init = function () {
            this.norest = cleverapps.platform.oneOf(Huzcom, Pliega, Playable) || cleverapps.config.norest, this.noLogEvents = cleverapps.platform.oneOf(Huzcom, Pliega, Rustore, Playable), this.noinvites = cleverapps.platform.oneOf(Huzcom, GDCom, Plinga, Pliega, Rustore, IOSCh, CleverApps, Playable, Yandex, Microsoft, MacOS, Mygames, MSStart, PWA, Ton, Wechat, Crazy, Samsung, Xiaomi), this.norequest = this.noinvites || cleverapps.platform.oneOf(AndroidPlatform, IOS, FacebookCanvas, Instant, MSStart, PWA, Wechat),
                this.noshares = cleverapps.platform.oneOf(AndroidPlatform, Amazon, IOS, Pliega, Plinga, Rustore, SPMobage, IOSCh, Playable, Yandex, Microsoft, MacOS, Draugiem, CleverApps, PWA, Ton, Wechat, Crazy), this.nocommunity = cleverapps.platform.oneOf(Huzcom, GDCom, Plinga, Pliega, Rustore, Playable, Yandex, Microsoft, MSStart, PWA, Wechat, Crazy), this.videoAdsMainMonetization = cleverapps.platform.oneOf(GDCom, IOSCh, Xiaomi), this.nofirebase = cleverapps.platform.oneOf(Pliega, Rustore, IOSCh, Playable, Microsoft, Mygames, MSStart, PWA), this.nofacebookevents = cleverapps.platform.oneOf(Pliega, Rustore, IOSCh, Playable, Microsoft, MacOS, Mygames, MSStart, PWA, Wechat, Crazy), this.nologin = cleverapps.social instanceof cleverapps.NoSocial || cleverapps.config.nologin, this.softCurrencyRealProduct = cleverapps.platform.oneOf(Mobage, SPMobage), this.highMonetization = ["merge"].includes(cleverapps.config.type)
        }, cleverapps.Flags.prototype.toggle = function (e) {
            this.set(e, !this[e])
        }, cleverapps.Flags.prototype.get = function (e) {
            return this[e]
        },
            cleverapps.Flags.prototype.set = function (e, t) {
                !!this[e] != !!t && (this[e] = t, this.trigger("change:" + e, t))
            }, cleverapps.Flags.prototype.reset = function () {
                this.init(), this.update()
            }, cleverapps.Flags.prototype.update = function () {
                this.highMonetization = ["merge"].includes(cleverapps.config.type) || cleverapps.ABTest.HIGH_MONETIZATION();
                var e = !cleverapps.payments.isAvailable() || 0 === Object.keys(Products.ACTIVE).length;
                e && (this.highMonetization = !1), this.set("videoAdsMainMonetization", e), cleverapps.paymentsHistory.classify() === cleverapps.PaymentsHistory.BRACKET_NONE || (this.norequest = !0, levels.friendRequests.deleteFakeRequests()), this.norest = this.norest || cleverapps.user.cheater, AdsLimits.initialize()
            },
            function () {
                cleverapps.config.debugMode && (this.noControls = !1, this.noBg = !1, this.noBoosters = !1, this.noNotifications = !1, this.noMute = !1, this.noGamePause = !1, this.showAvoidRects = !1, this.showFingerAnchor = !1, this.showMenuBarGoldItem = !1, this.hideMenuBarCoinsItem = !1, "merge" === cleverapps.config.type ? Object.assign(this, {
                    skipSpecialOffer: !1,
                    skipBuildingStage: !1,
                    skipOpenChestWindow: !1,
                    skipQuests: !1,
                    skipUnitStories: !1,
                    skipRestoreLandmarks: !1,
                    automerge: !1,
                    axemerge: !1,
                    hideGuideAndProgress: !1,
                    hideFruitParticlesAnimation: !1,
                    hideUnitPointAnimation: !1,
                    fastSpawnPrizes: !1,
                    upgradeInTwoTurns: !1,
                    customAnimationDidMerged: !1,
                    unitsPulsingDisabled: !1,
                    easyChop: !1,
                    dontCollectWands: !1,
                    lightUpOnHoveredUnit: !1,
                    hideGeneratorGuideButton: !1,
                    silentInfoView: !1,
                    silentCenterHint: !1,
                    fogBlockerDisabled: !1,
                    hideTankProgress: !1,
                    initFruitWithoutPrizes: !1,
                    initMineableWithPrizes: !1,
                    multipleHeroes: !1,
                    clans: !1,
                    captureToolActions: !1,
                    skipFlyToUnitsLibrary: !1,
                    skipUnitCreatePrize: !1,
                    skipExpPrize: !1,
                    muteCupsSound: !1,
                    scrollByFinger: !1
                }) : "match3" === cleverapps.config.type ? Object.assign(this, {
                    silentGoals: !1,
                    multiColorCellDisabled: !1,
                    heroesDisabled: !1,
                    newRules: !1
                }) : "klondike" === cleverapps.config.type ? Object.assign(this, {
                    tableAcceptAll: !1
                }) : "blocks" === cleverapps.config.type ? Object.assign(this, {
                    hideScore: !1,
                    hideHighScore: !1,
                    alwaysNoMemorable: !1,
                    showHint: !1,
                    piecesAlwaysEnabled: !1,
                    hideSingleMoveHint: !1,
                    hideExplodeHint: !1,
                    hidePieces: !1
                }) : "tile3" === cleverapps.config.type ? Object.assign(this, {
                    threeOpenCards: !1,
                    skipProlongation: !1,
                    replaceTiles: !1
                }) : "board" === cleverapps.config.type && Object.assign(this, {
                    noKeypad: !1,
                    noCookieJar: !1,
                    hideKeypadControls: !1
                }))
            }),
        SuccessWait = (GameModes.prototype.load = function () {
            var e;
            cleverapps.config.debugMode && (e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.GAME_MODES) || {}, Object.assign(this, e))
        }, GameModes.prototype.save = function () {
            var e = Object.assign({}, this);
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.GAME_MODES, e)
        }, GameModes.prototype.toggle = function (e) {
            this[e] = !this[e], this.save()
        }, GameModes.prototype.listModes = function () {
            return Object.keys(this)
        }, function (e) {
            e = e.filter(function (e) {
                return e && bundles[e]
            }), this.bundles = e, this.active = !0, this.loaded = !1, this.listeners = [], this.run()
        }),
        ActionPlayer = (SuccessWait.prototype.isActive = function () {
            return this.active
        },
            SuccessWait.prototype.isLoaded = function () {
                return this.loaded
            }, SuccessWait.prototype.whenLoaded = function (e) {
                e && (this.active ? this.listeners.push(e) : e())
            }, SuccessWait.prototype.run = function () {
                this.bundles.length ? cleverapps.bundleLoader.loadBundles(this.bundles, {
                    onSuccess: this.onSuccess.bind(this),
                    onFailure: this.onFailure.bind(this)
                }) : this.onSuccess()
            }, SuccessWait.prototype.onSuccess = function () {
                this.active ? (this.loaded = !0, this.clear(), this.listeners.forEach(cleverapps.callFunc), this.listeners = []) : (cleverapps.bundleLoader.deleteBundles(this.bundles), this.bundles = [])
            }, SuccessWait.prototype.onFailure = function (e) {
                if (this.active) {
                    if (cleverapps.checkStatus(e, 404)) return console.log("receive 404"), void this.clear();
                    clearTimeout(this.retryTimeout), this.retryTimeout = setTimeout(this.run.bind(this), SuccessWait.RETRY_TIMEOUT)
                }
            }, SuccessWait.prototype.clear = function () {
                this.active = !1, clearTimeout(this.retryTimeout), this.retryTimeout = void 0
            }, SuccessWait.prototype.destructor = function () {
                this.clear(),
                    this.listeners = [], this.loaded && (this.loaded = !1, cleverapps.bundleLoader.deleteBundles(this.bundles), this.bundles = [])
            }, SuccessWait.RETRY_TIMEOUT = cleverapps.parseInterval("30 seconds"), cleverapps.Information = function () {
                this.data = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.INFORMATION), void 0 === this.data && (this.data = {}), this.diff = {}
            }, cleverapps.Information.prototype.onChangeUserId = function () {
                this.diff = this.data, this.update()
            }, cleverapps.Information.prototype.reportMaxTextureSize = function () {
                var e;
                "undefined" != typeof gl && (e = gl.getParameter(gl.MAX_TEXTURE_SIZE), this.setKeyValue("maxTextureSize", e))
            }, cleverapps.Information.prototype.reportPhone = function () {
                var e, t = {};
                t[cc.sys.OS_ANDROID] = {
                    avatar: "#avatars/android_avatar.png",
                    name: "Android"
                }, t[cc.sys.OS_IOS] = {
                    avatar: "#avatars/ios_avatar.png",
                    name: "iOS"
                }, t[cc.sys.os] && cc.sys.isNative && (e = cleverapps.social.isLoggedIn() && "applesocial" !== cleverapps.social.getCode(), this.data.avatar || e || cleverapps.info.setKeyValue("avatar",
                    t[cc.sys.os].avatar), this.data.name || cleverapps.social.isLoggedIn() || cleverapps.info.setKeyValue("name", t[cc.sys.os].name + "_" + cleverapps.platform.getUserID().substr(-3))), cleverapps.platform.oneOf(GDCom) && cleverapps.info.setKeyValue("avatar", "#avatars/game_distribution.png")
            }, cleverapps.Information.prototype.save = function () {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.INFORMATION, this.data)
            }, cleverapps.Information.prototype.getValue = function (e) {
                return this.data[e]
            }, cleverapps.Information.prototype.setKeyValue = function (e, t, s) {
                JSON.stringify(this.data[e]) === JSON.stringify(t) && !s || (this.data[e] = t, this.diff[e] = t, this.update())
            }, cleverapps.Information.prototype.update = function () {
                this.save(), this._updateInner()
            }, cleverapps.Information.prototype._updateInner = cleverapps.accumulate(5e3, function () {
                console.log("Sending information: " + JSON.stringify(this.diff)), cleverapps.RestClient.post("/info/" + encodeURIComponent(cleverapps.platform.getUserID()), this.diff, function () { }, function () { }),
                    this.diff = {}
            }), cleverapps.Information.prototype.reportUserAgent = function () {
                var e, t;
                t = cleverapps.platform.oneOf(AndroidBase, Apple) ? (e = cleverapps.platform.device.name, cleverapps.platform.device.version) : (e = (t = (new UAParser).getResult(navigator.userAgent)).browser.name, t.browser.major), this.setKeyValue("useragent", {
                    browser: e,
                    version: t
                })
            }, cleverapps.Information.prototype.reportAppVersion = function () {
                this.setKeyValue("appversion", {
                    version: cleverapps.config.version,
                    source: cleverapps.platform.source
                })
            }, cleverapps.Information.prototype.reportSysLanguage = function () {
                this.setKeyValue("syslanguage", cc.sys.language)
            },
            function (e) {
                this.options = e = e || {}, Array.isArray(e) ? e = {
                    actions: e
                } : "function" == typeof e && (e = {
                    actions: [e]
                }), this.actions = [], this.add(e.actions || [])
            }),
        NoMetha = (ActionPlayer.prototype.add = function (e) {
            Array.isArray(e) ? e.forEach(function (e) {
                this.add(e)
            }.bind(this)) : e && this.actions.push(e)
        }, ActionPlayer.prototype._playNext = function () {
            if (this.actionTimeout && (cleverapps.timeouts.clearTimeout(
                this.actionTimeout), this.actionTimeout = void 0), !this._stopped) {
                if (this.index === this.actions.length) return this._stopped = !0, this.onCompleteListener && this.onCompleteListener.call(null), void (this.onSuccessListener && this.onSuccessListener.call(null));
                var e = !0,
                    t = function () {
                        e && (e = !1, this._playNext.apply(this, arguments))
                    }.bind(this),
                    s = function () {
                        e && (e = !1, this.stop.apply(this, arguments))
                    }.bind(this);
                this.options.actionTimeout && (this.actionTimeout = cleverapps.timeouts.setTimeout(s, this.options.actionTimeout)), this.actions[this.index++](t, s)
            }
        }, ActionPlayer.prototype.onSuccess = function (e) {
            this.onSuccessListener = e
        }, ActionPlayer.prototype.onFailure = function (e) {
            this.onFailureListener = e
        }, ActionPlayer.prototype.onComplete = function (e) {
            this.onCompleteListener = e
        }, ActionPlayer.prototype.play = function (e) {
            this.index = 0, e && this.onSuccess(e), this._playNext()
        }, ActionPlayer.prototype.stop = function () {
            this._stopped || (this._stopped = !0, this.onCompleteListener && this.onCompleteListener.call(null),
                this.onFailureListener && this.onFailureListener.apply(null, arguments))
        }, ActionPlayer.prototype.isStopped = function () {
            return this._stopped
        }, ActionPlayer.prototype.isRunning = function () {
            return !this.isStopped()
        }, {
            gamePlayed: function () { }
        }),
        Metha = function () {
            this.stack = [], this.pushState({
                focus: !1,
                controls: [],
                eventNodes: []
            }), this.pushState({
                focus: "initialize",
                controls: [],
                eventNodes: []
            }), this.focusHistory = [], this.tempControls = {}, this.onceNoWindowsListener = void 0, this.lastControlsVisible = {}, this.onControlsListeners = {}, this.controlsOptions = {}, this.pendingListeners = []
        },
        Exp = (Metha.prototype.showControlsTemporary = function (e) {
            cleverapps.toArray(e).forEach(function (e) {
                this.tempControls[e] = !0, !this.lastControlsVisible[e] && this.onControlsListeners[e] && (this.onControlsListeners[e](!0), this.lastControlsVisible[e] = !0)
            }.bind(this))
        }, Metha.prototype.hideControlsTemporary = function (e) {
            cleverapps.toArray(e).forEach(function (e) {
                delete this.tempControls[e],
                    this.lastControlsVisible[e] && this.onControlsListeners[e] && -1 === this.controls.indexOf(e) && (this.onControlsListeners[e](!1), this.lastControlsVisible[e] = !1)
            }.bind(this))
        }, Metha.prototype.clearTempControls = function () {
            this.tempControls = {}
        }, Metha.prototype.registerControl = function (e, t, s) {
            "object" == typeof t && (t = t.createListener(t.toggle.bind(t))), s && (this.controlsOptions[e] = {
                hiddenByDefault: s
            }), (this.onControlsListeners[e] = t)(!1, !0), this.lastControlsVisible[e] = !1, this.setControlsVisible(!0)
        }, Metha.prototype.removeControl = function (e) {
            delete this.onControlsListeners[e], delete this.lastControlsVisible[e]
        }, Metha.prototype.updateControlsVisibility = function (e) {
            for (var t in this.onControlsListeners) {
                var s = -1 !== this.controls.indexOf(t) || this.tempControls[t];
                this.lastControlsVisible[t] !== s && (this.onControlsListeners[t](s, e), this.lastControlsVisible[t] = s)
            }
        }, Metha.prototype.setControlsVisible = function (e) {
            this.clearUpdateTimeout(), this.isFocused() || cleverapps.gameModes.noControls || this.setControls(
                Object.keys(this.onControlsListeners).filter(function (e) {
                    return this.shouldBeVisible(e)
                }.bind(this))), e ? this.updateControlsVisibility(!0) : this.updateTimeout = setTimeout(this.updateControlsVisibility.bind(this), 100)
        }, Metha.prototype.shouldBeVisible = function (e) {
            return !(this.isFocused() || this.controlsOptions[e] && this.controlsOptions[e].hiddenByDefault && cleverapps.environment.hasScene(this.controlsOptions[e].hiddenByDefault))
        }, Metha.prototype.clearUpdateTimeout = function () {
            this.updateTimeout && (clearTimeout(this.updateTimeout), this.updateTimeout = void 0)
        }, Metha.prototype.debugMessage = function (e) {
            if (cleverapps.config.debugMode && !cc.sys.isNative) throw e;
            cleverapps.throwAsync(e)
        }, Metha.prototype.displayWhenFreeFocus = function (e) {
            this.isFocused() ? this.whenFreeFocus(this.display.bind(this, e)) : this.display(e)
        }, Metha.prototype.whenFreeFocus = function (e) {
            this.isFocused() ? this.pendingListeners.push(e) : e()
        }, Metha.prototype.distract = function (e) {
            if (this.isFocused() || this.debugMessage(
                "Distract without focus! " + e.focus), this.focus !== e.focus) {
                if (!e.filter || e.filter()) {
                    if (!e.restore)
                        for (; 1 < this.stack.length;) this.popState();
                    this.grabFocus(e.focus, e), this.compound(this.freeFocus.bind(this, e.focus), e.actions || [e.action])
                }
            } else this.debugMessage("Distract same focus!" + e.focus)
        }, Metha.prototype.display = function (e) {
            this.isFocused() || e.filter && !e.filter() || (this.grabFocus(e.focus, e), this.compound(this.freeFocus.bind(this, e.focus), e.actions || [e.action]))
        }, Metha.prototype.compound = function (e, t, s, i) {
            s = s || 0, i = i || this.stack[this.stack.length - 1], this.stack[this.stack.length - 1] === i ? t.length !== s ? (this.setEventNodes([]), t[s](cleverapps.once(this.compound.bind(this, e, t, s + 1, i)))) : e() : i.action = this.compound.bind(this, e, t, s, i)
        }, Metha.prototype.showControlsWhileFocused = function (e, t) {
            cleverapps.toArray(e).forEach(function (e) {
                -1 === this.controls.indexOf(e) ? (this.controls.push(e), !this.lastControlsVisible[e] && this.onControlsListeners[e] && (this.onControlsListeners[e](!0, t),
                    this.lastControlsVisible[e] = !0)) : t && this.onControlsListeners[e] && this.onControlsListeners[e](!0, t)
            }, this)
        }, Metha.prototype.isControlEnabled = function (e) {
            return 0 < cleverapps.intersect(this.controls, e).length
        }, Metha.prototype.hideAllControls = function (e) {
            this.setControls([]), this.updateControlsVisibility(e)
        }, Metha.prototype.hideControlsWhileFocused = function (e) {
            cleverapps.toArray(e).forEach(function (e) {
                var t = this.controls.indexOf(e); - 1 === t || this.shouldBeVisible(e) || (this.controls.splice(t, 1), this.lastControlsVisible[e] && this.onControlsListeners[e] && !this.tempControls[e] && (this.onControlsListeners[e](!1), this.lastControlsVisible[e] = !1))
            }, this)
        }, Metha.prototype.trigger = cleverapps.accumulate(0, function () {
            if (!this.isFocused()) {
                for (; 0 < this.pendingListeners.length;)
                    if (this.pendingListeners.shift()(), this.isFocused()) return;
                this.onFocusLostListenerPlacements()
            }
        }), Metha.prototype.checkEventNode = function (e) {
            if (e.alwaysOn) return !0;
            var t = cleverapps.scenes.getRunningScene();
            if (!this.isFocused()) return !0;
            var s = this.eventNodes;
            if (t.toolMenu && (s = s.concat(t.toolMenu, t.toolMenu.opener)), !(s = t.snapshotBar ? s.concat(t.snapshotBar) : s).length) return !1;
            if (s[0] === t) return !0;
            for (; e;) {
                if (-1 !== s.indexOf(e)) return !0;
                e = e.parent
            }
            return !1
        }, Metha.prototype.setEventNodes = function (e) {
            this.stack[this.stack.length - 1].eventNodes = this.eventNodes = e
        }, Metha.prototype.setControls = function (e) {
            this.stack[this.stack.length - 1].controls = this.controls = e
        }, Metha.prototype.grabFocus = function (e, t) {
            t = t || {}, console.log("Grab focus: " + e);
            var s = cleverapps.toArray(t.control || []);
            t.keepControls && (s = this.controls), this.saveHistory("+" + e), this.pushState({
                focus: e,
                controls: s.slice(),
                eventNodes: []
            }), this.setControlsVisible(cleverapps.silentIntro), this.trigger(), cleverapps.eventBus.trigger("changeFocus")
        }, Metha.prototype.freeFocus = function (e) {
            this.focus === e ? (console.log("Focus freed: " + this.focus), this.saveHistory("-" + this.focus), this.popState(), this.setControlsVisible(cleverapps.silentIntro), this.trigger(),
                cleverapps.eventBus.trigger("changeFocus"), cleverapps.bundleLoader.clearUnusedResources(), this.resumeCompound()) : console.log("Wrong focus clearing: " + this.focus + " > " + e)
        }, Metha.prototype.saveHistory = function (e) {
            this.focusHistory.push(e), this.focusHistory = this.focusHistory.slice(-20)
        }, Metha.prototype.pushState = function (e) {
            this.stack.push(e), this.focus = e.focus, this.setControls(e.controls), this.setEventNodes(e.eventNodes)
        }, Metha.prototype.popState = function () {
            var e;
            1 !== this.stack.length ? ((e = this.stack.pop()).controls = [], e.eventNodes = [], e.action = void 0, e = this.stack[this.stack.length - 1], this.focus = e.focus, this.setControls(e.controls), this.setEventNodes(e.eventNodes)) : this.debugMessage("Attempt to free default state")
        }, Metha.prototype.resumeCompound = function () {
            var e = this.stack[this.stack.length - 1],
                t = e.action;
            e.action = void 0, t && t()
        }, Metha.prototype.isFocused = function () {
            return !1 !== this.focus
        }, Metha.prototype.getFocus = function () {
            return this.focus
        }, Metha.prototype.getType = function () {
            if (
                "playable" === cleverapps.config.source) return Metha.NONE;
            switch (cleverapps.config.meta) {
                case "farm":
                    return Metha.FARM;
                case "homefix":
                    return Metha.HOMEFIX;
                case "shortmeta":
                    return Metha.SHORTMETA;
                case "simple":
                    return Metha.SIMPLE;
                case "none":
                    return Metha.NONE;
                case "fishdom":
                    return Metha.FISHDOM
            }
            return Metha.HOSE
        }, Metha.prototype.getMainScene = function () {
            if ("playable" === cleverapps.config.source) return PlayableAdsScene;
            switch (this.getType()) {
                case Metha.FARM:
                    return FarmScene;
                case Metha.HOMEFIX:
                    return HomefixScene;
                case Metha.FISHDOM:
                    return FishdomScene;
                case Metha.SHORTMETA:
                    return ShortMetaScene;
                case Metha.SIMPLE:
                    return SimpleMainScene;
                case Metha.NONE:
                    return GameScene;
                default:
                    return HoseScene
            }
        }, Metha.prototype.getRumble = function () {
            return this.getMainObject().knockoutGame.rumble
        }, Metha.prototype.stopRumble = function () {
            return this.getMainObject().knockoutGame.stopRumble()
        }, Metha.prototype.getMainObject = function () {
            switch (this.getType()) {
                case Metha.FARM:
                    return cleverapps.farm;
                case Metha.FISHDOM:
                    return cleverapps.fishdom;
                case Metha.HOMEFIX:
                    return cleverapps.home;
                case Metha.SHORTMETA:
                    return cleverapps.shortmeta;
                case Metha.SIMPLE:
                    return cleverapps.simple;
                case Metha.HOSE:
                    return cleverapps.hose;
                case Metha.NONE:
                    return NoMetha
            }
        }, Metha.prototype.wantsToPlay = function (e, t) {
            if (cleverapps.lives && cleverapps.lives.isEmpty()) return new LivesShopWindow, void (cleverapps.meta.onceNoWindowsListener = e);
            var s, i = this.getMainObject();
            t = this.getType() === Metha.FARM ? (s = t && t.building && t.building.canStillProvideQuestItems() ? t.building : i.findBuildingForActiveItem() || cleverapps.Random.mathChoose(i.listAvailableProvidesBuildings()), MethaHelper.getCurrentLevel(s)) : t || MethaHelper.getCurrentLevel(), this.getType() === Metha.HOSE && (cleverapps.Plot.isPassedAllEpisodes = levels.user.isPassedAll()), i.knockoutGame ? i.knockoutGame.wantsToPlay(e, t) : MethaHelper.start(e, t)
        }, Metha.prototype.wantsToReplay = function (e, t) {
            MethaHelper.start(e, t)
        }, Metha.HOSE = 0, Metha.FARM = 1, Metha.HOMEFIX = 2, Metha.SHORTMETA = 3, Metha.SIMPLE = 4,
            Metha.NONE = 5, Metha.FISHDOM = 6,
            function (e) {
                cleverapps.EventEmitter.call(this), this.slot = e
            }),
        UserDelete = (Exp.prototype = Object.create(cleverapps.EventEmitter.prototype), (Exp.prototype.constructor = Exp).prototype.isAvailable = function () {
            return "undefined" != typeof match3 && match3.heroes && match3.heroes.available() || "merge" === cleverapps.config.type
        }, Exp.prototype.load = function (e, t) {
            if (t) return this.exp = 0, void this.save();
            this.exp = Math.floor(e) || 0
        }, Exp.prototype.save = function () {
            cleverapps.gameLevel && cleverapps.gameLevel.withOwnLevel ? Game.currentGame.storeSave() : cleverapps.user.save()
        }, Exp.prototype.getExp = function () {
            return this.exp
        }, Exp.prototype.setExp = function (e, t) {
            e = Math.floor(e), this.exp !== e && (!cleverapps.isNumber(this.exp) || cleverapps.isNumber(e) ? (this.exp = e, this.save(), t || this.onChange()) : cleverapps.throwAsync("Try set non number exp - " + e))
        }, Exp.prototype.onChange = function () {
            this.trigger("changeExp")
        }, Exp.prototype.canTakeExp = function (e) {
            return this.exp >= e
        }, Exp.prototype.takeExp = function (e, t) {
            return 0 === e || !!this.canTakeExp(e) && (this.setExp(this.exp - e, t), !0)
        }, Exp.Switch = function (e) {
            cleverapps.gameLevel.withOwnLevel ? cleverapps.exp = cleverapps.expBySlots[e] : cleverapps.exp = cleverapps.expBySlots[CustomSyncers.SLOT_MAIN]
        }, cleverapps.User = function (e) {
            cleverapps.EventEmitter.call(this), this.isNewUser = e, this.onCantTakeGold = function () {
                cleverapps.flags.videoAdsMainMonetization && !cleverapps.rewardedAdsManager.isEnabled() ? cleverapps.notification.create("NotEnoughCoins") : cleverapps.meta.isFocused() ? new HardCurrencyShopWindow : cleverapps.meta.display({
                    focus: "ShopWindow",
                    control: "MenuBarGoldItem",
                    action: function (e) {
                        new HardCurrencyShopWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }, this.onLeagueChangeListener = function () { }, e ? this.initializeNewPlayer() : (e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ID), this.loadedInfo = e, this.loadData(e), this.lastReportDAU = this.getDaysSinceRegistration(e.visited)), cleverapps.platform.oneOf(AndroidBase) && setTimeout(function () {
                0 === cleverapps.user.getDaysSinceRegistration() && cleverapps.Adversting.getInstallReferrer()
            }, 0), cleverapps.platform.calcChannel(function (e) {
                e && this.setChannel(e)
            }.bind(this)), this.save(), this.updateIDFA(), cleverapps.whenAllInitialized(this.reportDAU.bind(this)), cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, function () {
                this.updateIDFA(), this.visited < Date.now() - cleverapps.parseInterval(cleverapps.User.ON_SHOW_CHANGE_VISITED) && (this.updateVisited(), cleverapps.whenAllInitialized(this.reportDAU.bind(this)))
            }.bind(this))
        }, cleverapps.User.prototype = Object.create(cleverapps.EventEmitter.prototype), cleverapps.User.prototype.constructor = cleverapps.User, cleverapps.User.prototype.updateVisited = function () {
            this.visited = Date.now(), this.save()
        }, cleverapps.User.prototype.incProgressCompare = function (e, t) {
            this.progressCompare += e = e || 1, t || this.save()
        }, cleverapps.User.prototype.reportDAU = function () {
            var e, t = this.getDaysSinceRegistration();
            void 0 !== this.lastReportDAU && this.lastReportDAU === t || (
                this.lastReportDAU = t, cleverapps.playSession.endSession(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.DAU), "merge" !== cleverapps.config.type || (e = (e = cleverapps.GameSaver.load(CustomSyncers.SLOT_MAIN)) && cleverapps.castType(e.wands || 0) || 0) && e <= 5e4 && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.USER_WANDS_DAU_AMOUNT, {
                    value: e
                }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.USER_WANDS_DAU)), cc.sys.isNative && cleverapps.social.isLoggedIn() && (e = cleverapps.social.getCode(), cleverapps.eventLogger.logEvent(e + "_loggedin_dau")), cleverapps.paymentsHistory.isPayer() && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PAYER_DAU), t < 1 && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.DAY_1_DAU, !0), 0 < t && this.reportRetention())
        }, cleverapps.User.prototype.reportRetention = function () {
            var e = this.getDaysSinceRegistration(),
                t = cleverapps.EVENTS.STATS["RETENTION_" + e],
                t = (t && (cleverapps.eventLogger.logEvent(t), cleverapps.abTest.allLogEvent(t)),
                    cleverapps.EVENTS.TARGET_FOR_BUYING["RETENTION_" + e]);
            t && cleverapps.eventLogger.logEvent(t)
        }, cleverapps.User.prototype.getDaysSinceRegistration = function (e) {
            return Math.floor(((e || Date.now()) - this.registered) / 1e3 / 24 / 60 / 60)
        }, cleverapps.User.prototype.loadData = function (e) {
            var t = e.id;
            Version.compare(e.version, "1.300.0") < 0 && cleverapps.platform instanceof Yandex && (console.log("replace ya id " + t + " -> " + t.replace(/~/g, "/")), t = t.replace(/~/g, "/")), t && cleverapps.platform.setUserID(t), this.gold = e.gold, this.registered = e.registered, this.loggedIn = e.loggedIn, this.channel = e.channel, this.visited = Date.now(), cleverapps.expBySlots[CustomSyncers.SLOT_MAIN].load(e.exp), this.league = this.calcLeague(), e.idfa1 && (this.idfa = e.idfa1), this.progressCompare = e.progressCompare || 0, this.soft = e.soft || 0, void 0 === e.soft && "mergecraft" === cleverapps.config.name && (t = cleverapps.GameSaver.loadProperty(CustomSyncers.SLOT_MAIN, "coins"), this.soft = t || 0)
        }, cleverapps.User.prototype.isBeginner = function () {
            return this.episode <= 1
        },
            cleverapps.User.prototype.isNovice = function () {
                return this.episode <= 3 && 1 < this.episode
            }, cleverapps.User.prototype.checkAvailable = function () {
                return !0
            }, cleverapps.User.prototype.earnHard = function (e, t, s) {
                0 !== t && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.EARN.HARD, {
                    value: t
                }), cleverapps.eventLogger.logEvent("earn-" + e, {
                    value: t
                }), this.gold += t, this.incProgressCompare(3, !0), this.save(), s || this.onChangeGold())
            }, cleverapps.User.prototype.onChangeGold = function () {
                this.trigger("changeHard")
            }, cleverapps.User.prototype.canTakeHard = function (e) {
                return this.gold >= e
            }, cleverapps.User.prototype.spendHard = function (e, t) {
                return 0 === t || (this.canTakeHard(t) ? (cleverapps.eventBus.trigger("taskEvent", DailyTasks.SPEND_HARD, t), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.SPENT.HARD, {
                    value: t
                }), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.SPENT.HARD + "-" + e, {
                    value: t
                }), cleverapps.travelBook.isExpedition() && cleverapps.eventLogger.logEvent(
                    cleverapps.EVENTS.SPENT.HARD + "-" + cleverapps.travelBook.getCurrentExpedition().id + e, {
                    value: t
                }), !(Game.currentGame && Game.currentGame.level.episode.isBonusWorldLevel() || cleverapps.environment.isBonusWorldScene()) || (s = cleverapps.missionManager.findByType(Mission.TYPE_BONUS_WORLD)) && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPENT.HARD + "-" + s.bonusWorld.type + e, {
                    value: t
                }), cleverapps.eventLogger.logEvent("hard-" + e, {
                    value: t
                }), cleverapps.aims.showTarget(cleverapps.aims.getTarget("hard")), this.gold -= t, this.incProgressCompare(3, !0), this.save(), this.trigger("changeHard"), !0) : (this.onCantTakeGold(t - this.gold), !1));
                var s
            }, cleverapps.User.prototype.setSoft = function (e, t) {
                var s = e - this.soft;
                0 != s && (this.soft = e, this.incProgressCompare(1, !0), this.save(), t || this.trigger("changeSoft")), 0 < s && cleverapps.travelBook.isExpedition() && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.EARN.SOFT + "-" + cleverapps.travelBook.getCurrentExpedition().id, {
                    value: s
                })
            }, cleverapps.User.prototype.canTakeSoft = function (e) {
                return this.soft >= e
            }, cleverapps.User.prototype.spendSoft = function (e, t, s) {
                if (s = s || {}, !this.canTakeSoft(t)) return cleverapps.meta.isFocused() ? (cleverapps.meta.showControlsWhileFocused(["MenuBarGoldItem", "MenuBarCoinsItem"]), new SoftCurrencyShopWindow) : cleverapps.meta.display({
                    focus: "ShopWindow",
                    control: ["MenuBarGoldItem", "MenuBarCoinsItem"],
                    action: function (e) {
                        new SoftCurrencyShopWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                }), !1;
                this.setSoft(this.soft - t), cleverapps.travelBook.isExpedition() && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPENT.SOFT + "-" + cleverapps.travelBook.getCurrentExpedition().id, {
                    value: t
                }), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.SPENT.SOFT, {
                    value: t
                }), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.SPENT.SOFT + "-" + e, {
                    value: t
                }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPENT.SOFT + "-" + e, {
                    value: t
                }), cleverapps.eventBus.trigger("taskEvent", DailyTasks.SPEND_SOFT, t), cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect);
                e = new RewardsList({
                    mission: {
                        amount: t,
                        missionType: Mission.TYPE_SOFTFEAST
                    }
                });
                return e.receiveRewards(), cleverapps.travelBook.getCurrentPage().isMain() && e.collectRewardsAnimation(s.source, {
                    withoutDelta: !0
                }), !0
            }, cleverapps.User.prototype.setLoggedIn = function (e) {
                this.loggedIn = e
            }, cleverapps.User.prototype.getSaveInfo = function () {
                return {
                    id: cleverapps.platform.getUserID(),
                    gold: this.gold,
                    soft: this.soft,
                    registered: this.registered,
                    visited: this.visited,
                    channel: this.channel,
                    exp: cleverapps.expBySlots[CustomSyncers.SLOT_MAIN].getExp(),
                    idfa1: this.idfa,
                    progressCompare: this.progressCompare,
                    version: cleverapps.config.version,
                    loggedIn: this.loggedIn
                }
            }, cleverapps.User.prototype.afterSync = function () {
                this.league = this.calcLeague()
            }, cleverapps.User.prototype.save = function (e) {
                !1 === e && this.afterSync(), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ID, this.getSaveInfo()), !1 !== e && cleverapps.synchronizer.addUpdateTask("users")
            }, cleverapps.User.prototype.setRandomBoostersReward = function (e) {
                if (!e.randomBoosters) return e;
                e.boosters = {};
                for (
                    var t = 0; t < e.randomBoosters.amount; t++) {
                    var s = cleverapps.Random.choose(e.randomBoosters.types);
                    e.boosters[s] = e.boosters[s] ? e.boosters[s] + 1 : 1
                }
                return delete e.randomBoosters, e
            }, cleverapps.User.prototype.prepareRewardByRich = function (e, t) {
                if (!e.hard && !e.boosters && !e.randomBoosters) return e;
                e = cleverapps.clone(e, !0), e = this.setRandomBoostersReward(e);
                var s = cleverapps.paymentsHistory.getLastPaymentTime();
                if (s && s > Date.now() - cleverapps.parseInterval("1 day")) return e;
                var i = !1;
                if (e.hard && (n = !0, s && s > Date.now() - cleverapps.parseInterval("3 day") && (n = !1), s = 1, 1e3 <= this.gold && n ? (s = .1, i = !0) : 600 <= this.gold ? (i = !0, s = .25) : 300 <= this.gold && (s = .5), e.hard = Math.max(5 * Math.ceil(e.hard * s / 5), t || 0)), i) {
                    var n = [];
                    if ("match3" === cleverapps.config.type && (n = [{
                        stars: 3,
                        exp: 1
                    }, {
                        stars: 3
                    }, {
                        stars: 2,
                        exp: 1
                    }, {
                        exp: 2
                    }]), 0 < (n = !e.unlimitedLives && cleverapps.lives ? n.concat([{
                        unlimitedLives: "10 minutes"
                    }, {
                        unlimitedLives: "15 minutes"
                    }, {
                        unlimitedLives: "30 minutes"
                    }]) : n).length) {
                        var o, a = cleverapps.Random.choose(n);
                        for (o in a) e[o] ? e[o] += a[o] : e[o] = a[o]
                    }
                }
                return e
            }, cleverapps.User.calcPriceCoef = function () {
                return cleverapps.platform.oneOf(MobileVk, VKPlatform) ? .28 : cleverapps.platform.oneOf(MobileOK, OKPlatform) || cleverapps.platform.oneOf(MobileMyMailRu, MyMailRu) ? 20 / 75 : cleverapps.platform.oneOf(FotoStrana) ? .4 : cleverapps.platform.oneOf(Yandex) ? 20 / 75 : cleverapps.payments instanceof YooKassaPayments ? cleverapps.RUB_YOOKASSA_RATE / cleverapps.EXCHANGE_RATES.RUB : cleverapps.payments.oneOf(WechatPayments) ? cleverapps.WECHAT_PAYMENTS_RATE / cleverapps.EXCHANGE_RATES.CNY : 1
            }, cleverapps.User.prototype.setChannel = function (e) {
                var t;
                this.channel !== e && (t = (this.isNewUser ? "user_channel_new_" : "user_channel_old_") + e, cleverapps.eventLogger.logEvent(t), !this.isNewUser && this.loadedInfo && this.loadedInfo.visited + cleverapps.parseInterval("7 days") < Date.now() && (this.registered = Date.now()), this.channel = e, this.save())
            }, cleverapps.User.prototype.hasValidIDFA = function () {
                return cleverapps.platform.oneOf(Apple) ? this.idfa && 0 !== this.idfa.indexOf("0000") : this.idfa
            }, cleverapps.User.prototype.updateIDFA = function () {
                var t;
                this.hasValidIDFA() || (t = cleverapps.platform.device.idfa) && this.idfa !== t && (this.idfa = t, console.log("user set idfa - " + this.idfa), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ID, this.getSaveInfo()), cleverapps.RestClient.post("/users/idfa/" + cleverapps.platform.getUserID(), {
                    idfa: this.idfa
                }, function (e) {
                    e.campaign && (this.setChannel(e.campaign), cleverapps.Adversting.postbackUnity(t))
                }.bind(this), function () {
                    console.log("Failed updating idfa: " + this.idfa), delete this.idfa, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ID, this.getSaveInfo())
                }.bind(this)))
            }, cleverapps.User.prototype.initializeNewPlayerGold = function () {
                this.gold = 100, "merge" === cleverapps.config.type && (this.gold = 15), "battlefield" === cleverapps.config.type && (this.gold = 50)
            }, cleverapps.User.prototype.initializeNewPlayerSoft = function () {
                this.soft = 0, "merge" === cleverapps.config.type && (this.soft = 100), "battlefield" === cleverapps.config.type && (this.soft = 30)
            },
            cleverapps.User.prototype.initializeNewPlayer = function () {
                this.initializeNewPlayerGold(), this.initializeNewPlayerSoft(), this.registered = Date.now(), this.visited = Date.now(), cleverapps.expBySlots[CustomSyncers.SLOT_MAIN].load(0), this.league = this.calcLeague(), this.progressCompare = 0
            }, cleverapps.User.prototype.calcLeague = function () {
                var e = 0;
                if (!cleverapps.config.leagues) return e;
                for (; e < cleverapps.config.leagues.length && cleverapps.config.leagues[e] && this.getHumanReadableNumber() + (this.progress || 0) > cleverapps.config.leagues[e];) e++;
                return e
            }, cleverapps.User.ON_SHOW_CHANGE_VISITED = "1 hour", cleverapps.User.SOFT_CURRENCY = 0, cleverapps.User.HARD_CURRENCY = 1, cleverapps.giveUsersGifts = function () {
                "tripeaks" === cleverapps.config.name && cleverapps.platform.oneOf(Mobage, SPMobage) && ["mbga.jp:63100202", "sb.mbga.jp:63100202"].includes(cleverapps.platform.getUserID()) && cleverapps.user.getHumanReadableNumber() < 1e3 && (cleverapps.user.episode = Math.floor(66.6), cleverapps.user.level = 9, cleverapps.user.gold += 5e4,
                    cleverapps.user.save(), cleverapps.boosters.add(cleverapps.Boosters.TYPE_MAGNET, 20), cleverapps.boosters.add(cleverapps.Boosters.TYPE_DICE, 20), cleverapps.boosters.add(cleverapps.Boosters.TYPE_JOKERS, 20), cleverapps.unlimitedLives.buy("240 hours"))
            },
            function () {
                this.load()
            }),
        DeleteAccountWindow = (UserDelete.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.USER_DELETE) || {};
            this.planned = e.planned
        }, UserDelete.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.USER_DELETE, this.getInfo())
        }, UserDelete.prototype.getInfo = function () {
            return {
                planned: this.planned
            }
        }, UserDelete.prototype.updateInfo = function (e) {
            this.planned = e.planned, this.save()
        }, UserDelete.prototype.updateDeleted = function (e) {
            this.deleted = e && e.deleted
        }, UserDelete.prototype.isAvailable = function () {
            return cleverapps.platform.oneOf(IOS, MacOS) ? cleverapps.social.isLoggedIn() : cleverapps.config.debugMode
        }, UserDelete.prototype.startDeletion = function () {
            cleverapps.meta.distract({
                focus: "DeleteAccount",
                actions: [function (e) {
                    cleverapps.windows.reset(), cleverapps.scenes.replaceScene(new LoaderScene([], function () { }), e)
                }, function (e) {
                    cleverapps.user.incProgressCompare(100), cleverapps.synchronizer.addUpdateTask("userdelete"), this.planned = Date.now() + this.getFullTime(), this.save(), this.checkDeletion(e)
                }.bind(this)]
            })
        }, UserDelete.prototype.cancelDeletion = function () {
            var t;
            cleverapps.meta.distract({
                focus: "CancelDeleteAccount",
                actions: [function (e) {
                    t = new WaitWindow, cleverapps.synchronizer._onceNextSyncCompletedListener = cleverapps.waitNoMore(15e3, cleverapps.once(e)), cleverapps.synchronizer.syncWhenReady()
                }, function (e) {
                    t.close(), this.planned = void 0, this.save(), cleverapps.user.incProgressCompare(100), cleverapps.synchronizer.addUpdateTask("userdelete"), this.checkDeletion(e)
                }.bind(this), function (e) {
                    cleverapps.Plot.onStartup(e)
                }]
            })
        }, UserDelete.prototype.checkDeletion = function (e) {
            if (this.isDeleted()) return cleverapps.DataLoader.cleanAll(), void new DeleteAccountRestartWindow;
            this.isPlanned() ? new DeleteAccountInformationWindow : e()
        }, UserDelete.prototype.getFullTime = function () {
            return cleverapps.config.debugMode ? cleverapps.parseInterval("5 minutes") : cleverapps.parseInterval("90 days")
        }, UserDelete.prototype.getTimeLeft = function () {
            var e = this.planned - Date.now() || 0;
            return Math.max(0, e)
        }, UserDelete.prototype.isDeleted = function () {
            return this.deleted > cleverapps.user.registered || this.planned <= Date.now()
        }, UserDelete.prototype.isPlanned = function () {
            return this.planned > Date.now()
        }, Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.DeleteAccountWindow;
                this._super({
                    name: "DeleteAccountWindow",
                    title: "DeleteAccountWindow.title",
                    content: this.createContent(),
                    styles: e.window
                })
            },
            getPerson: function () {
                return cleverapps.styles.DeleteAccountWindow.person
            },
            createContent: function () {
                var e = cleverapps.styles.DeleteAccountWindow,
                    t = this.createInfo(),
                    s = this.createButtons();
                return new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin
                })
            },
            createInfo: function () {
                var t = cleverapps.styles.DeleteAccountWindow.info,
                    e = Math.floor(cleverapps.userDelete.getFullTime() / 24 / 60 / 60 / 1e3),
                    e = [Messages.get("DeleteAccountWindow.text1", {
                        newline: "\n"
                    }), Messages.get("DeleteAccountWindow.text2", {
                        days: e
                    }), Messages.get("DeleteAccountWindow.text3", {
                        days: e
                    })].map(function (e) {
                        e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.DELETE_ACCOUNT_TEXT);
                        return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setWrapWidth(t.text.size[cleverapps.resolution.mode].width), e
                    }),
                    e = new cleverapps.Layout(e, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: t.margin,
                        padding: t.padding
                    }),
                    s = (e.setPositionRound(e.width / 2, e.height / 2), cleverapps.UI.createScale9Sprite(bundles.windows.frames.windows_details_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY));
                return s.setContentSize(e.width, e.height), s.addChild(e), s
            },
            createButtons: function () {
                var e = cleverapps.styles.DeleteAccountWindow.buttons,
                    t = new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.button_red,
                        text: "Continue",
                        onClicked: function () {
                            new DeleteAccountConfirmationWindow, this.close()
                        }.bind(this),
                        width: e.width,
                        height: e.height
                    }),
                    s = new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.button_green,
                        text: "Cancel",
                        onClicked: this.close.bind(this),
                        width: e.width,
                        height: e.height
                    });
                return new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin
                })
            }
        })),
        DeleteAccountConfirmationWindow = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            DELETE_ACCOUNT_TEXT: {
                size: 35,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.styles.DeleteAccountWindow = {
            margin: 20,
            info: {
                margin: 10,
                padding: {
                    x: 40,
                    y: 40
                },
                text: {
                    size: [{
                        width: 1e3
                    }, {
                        width: 1300
                    }, {
                        width: 1300
                    }]
                }
            },
            buttons: {
                width: 340,
                height: 110,
                margin: 240
            }
        }, Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.DeleteAccountWindow;
                this._super({
                    name: "DeleteAccountConfirmationWindow",
                    title: "DeleteAccountConfirmationWindow.title",
                    content: this.createContent(),
                    styles: e.window
                })
            },
            getPerson: function () {
                return cleverapps.styles.DeleteAccountWindow.person
            },
            createContent: function () {
                var e = cleverapps.styles.DeleteAccountWindow,
                    t = this.createInfo(),
                    s = this.createButtons();
                return new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin
                })
            },
            createInfo: function () {
                var t = cleverapps.styles.DeleteAccountWindow.info,
                    e = Math.floor(cleverapps.userDelete.getFullTime() / 24 / 60 / 60 / 1e3),
                    e = [Messages.get("DeleteAccountConfirmationWindow.text1"), Messages.get("DeleteAccountConfirmationWindow.text2", {
                        days: e
                    }), Messages.get("DeleteAccountConfirmationWindow.text3", {
                        days: e,
                        newline: "\n"
                    })].map(function (e) {
                        e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.DELETE_ACCOUNT_TEXT);
                        return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setWrapWidth(t.text.size[cleverapps.resolution.mode].width), e
                    }),
                    e = new cleverapps.Layout(e, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: t.margin,
                        padding: t.padding
                    }),
                    s = (e.setPositionRound(e.width / 2, e.height / 2), cleverapps.UI.createScale9Sprite(bundles.windows.frames.windows_details_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY));
                return s.setContentSize(e.width, e.height), s.addChild(e), s
            },
            createButtons: function () {
                var e = cleverapps.styles.DeleteAccountWindow.buttons,
                    t = new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.button_red,
                        text: "Delete",
                        onClicked: function () {
                            cleverapps.userDelete.startDeletion()
                        },
                        width: e.width,
                        height: e.height
                    }),
                    s = new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.button_green,
                        text: "Cancel",
                        onClicked: this.close.bind(this),
                        width: e.width,
                        height: e.height
                    });
                return new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin
                })
            }
        })),
        DeleteAccountInformationWindow = Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.DeleteAccountWindow;
                this._super({
                    name: "DeleteAccountInformationWindow",
                    title: "DeleteAccountInformationWindow.title",
                    content: this.createContent(),
                    styles: e.window,
                    closeButton: !1
                })
            },
            createContent: function () {
                var e = cleverapps.styles.DeleteAccountWindow,
                    t = this.createInfo(),
                    s = this.createButtons();
                return new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin
                })
            },
            createInfo: function () {
                var t = cleverapps.styles.DeleteAccountWindow.info,
                    e = Math.floor((cleverapps.userDelete.getTimeLeft() - 1e3) / 24 / 60 / 60 / 1e3) + 1,
                    e = [Messages.get("DeleteAccountInformationWindow.time", {
                        days: e
                    }), Messages.get("DeleteAccountInformationWindow.text1", {
                        newline: "\n"
                    }), Messages.get("DeleteAccountInformationWindow.text2", {
                        newline: "\n"
                    })],
                    e = (cleverapps.platform.oneOf(IOS, MacOS, IOSCh) && e.push(Messages.get("DeleteAccountInformationWindow.revoke.apple", {
                        newline: "\n"
                    })), e.map(function (e) {
                        e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.DELETE_ACCOUNT_TEXT);
                        return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setWrapWidth(t.text.size[cleverapps.resolution.mode].width), e
                    })),
                    e = new cleverapps.Layout(e, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: t.margin,
                        padding: t.padding
                    }),
                    s = (e.setPositionRound(e.width / 2, e.height / 2), cleverapps.UI.createScale9Sprite(bundles.windows.frames.windows_details_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY));
                return s.setContentSize(e.width, e.height), s.addChild(e), s
            },
            createButtons: function () {
                var e, t = cleverapps.styles.DeleteAccountWindow.buttons,
                    s = new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.button_green,
                        text: "Cancel",
                        onClicked: function () {
                            this.close(), cleverapps.userDelete.cancelDeletion()
                        }.bind(this),
                        width: t.width,
                        height: t.height
                    });
                return SettingsWindow.IsExitButtonAvailable() && (e = new cleverapps.UI.Button({
                    type: cleverapps.styles.UI.Button.Images.button_red,
                    text: "Exit",
                    onClicked: cleverapps.platform.closeApplication,
                    width: t.width,
                    height: t.height
                })), new cleverapps.Layout([s, e].filter(Boolean), {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: t.margin
                })
            }
        }),
        DeleteAccountRestartWindow = Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.DeleteAccountWindow;
                this._super({
                    name: "DeleteAccountRestartWindow",
                    title: "DeleteAccountRestartWindow.title",
                    content: this.createContent(),
                    styles: e.window,
                    closeButton: !1
                })
            },
            createContent: function () {
                var e = cleverapps.styles.DeleteAccountWindow,
                    t = this.createInfo(),
                    s = this.createButtons();
                return new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin
                })
            },
            createInfo: function () {
                var t = cleverapps.styles.DeleteAccountWindow.info,
                    e = [Messages.get("DeleteAccountRestartWindow.text1", {
                        newline: "\n"
                    })].map(function (e) {
                        e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.DELETE_ACCOUNT_TEXT);
                        return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setWrapWidth(t.text.size[cleverapps.resolution.mode].width), e
                    }),
                    e = new cleverapps.Layout(e, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: t.margin,
                        padding: t.padding
                    }),
                    s = (e.setPositionRound(e.width / 2, e.height / 2), cleverapps.UI.createScale9Sprite(bundles.windows.frames.windows_details_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY));
                return s.setContentSize(e.width, e.height),
                    s.addChild(e), s
            },
            createButtons: function () {
                var e, t = cleverapps.styles.DeleteAccountWindow.buttons;
                return SettingsWindow.IsExitButtonAvailable() && (e = new cleverapps.UI.Button({
                    type: cleverapps.styles.UI.Button.Images.button_red,
                    text: "Exit",
                    onClicked: cleverapps.platform.closeApplication,
                    width: t.width,
                    height: t.height
                })), new cleverapps.Layout([e].filter(Boolean), {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: t.margin
                })
            }
        }),
        TransitionAnimation = (cleverapps.Scenes = function () {
            this.onAvoidNodeVisibilityChanged = function () { }
        }, cleverapps.refreshScene = function () {
            function e(e) {
                var t = cleverapps.scenes.getRunningScene();
                t.refreshFromTool = !0, t instanceof MainScene ? cleverapps.travelBook.gotoMainScene(e) : "undefined" != typeof EditorScene && t instanceof EditorScene ? EditorScene.open({
                    level: t.level,
                    callback: e
                }) : t instanceof GameScene ? cleverapps.config.editorMode ? (e(), LevelManager.getInstance().setLevel({
                    levelNo: cleverapps.environment.levelNo,
                    episodeNo: cleverapps.environment.episodeNo
                }), LevelManager.getInstance().editLevel()) : "merge" === cleverapps.config.type ? cleverapps.travelBook.gotoMainScene(e) : cleverapps.meta.wantsToPlay(e) : "undefined" != typeof HeroesScene && t instanceof HeroesScene ? cleverapps.scenes.replaceScene(new HeroesScene, e) : t instanceof DailyCupScene ? cleverapps.scenes.replaceScene(new DailyCupScene, e) : t instanceof BonusWorldScene && cleverapps.travelBook.gotoMainScene(function () {
                    cleverapps.scenes.replaceScene(new BonusWorldScene(cleverapps.missionManager.findRunningMission(Mission.TYPE_BONUS_WORLD)), e)
                })
            }
            cleverapps.meta.isFocused() ? cleverapps.meta.distract({
                focus: "sceneRefresh",
                action: e
            }) : cleverapps.meta.display({
                focus: "sceneRefresh",
                action: e
            })
        }, cleverapps.Scenes.prototype.getMovingNode = function (e) {
            for (; e; e = e.parent)
                if (e.movingNode) return e.movingNode;
            return cleverapps.scenes.getRunningScene().movingNode
        }, cleverapps.Scenes.prototype.getRunningScene = function () {
            return cc.director.getRunningScene()
        }, cleverapps.Scenes.prototype.replaceScene = function (i, e) {
            cleverapps.meta.isFocused() || cleverapps.meta.debugMessage("Trying to replace scene without user focus! " + i.sceneName), Game.currentGame && (Game.currentGame.stop(), Game.currentGame = void 0), cleverapps.sideBar.clearListeners(), e = e || function () { }, (cleverapps.config.editorMode || cleverapps.config.demoMode) && (cleverapps.silentIntro = !0);
            var n = cleverapps.scenes.getRunningScene(),
                t = (cleverapps.notification.clear(), FingerView.remove(FingerView.currentFinger, !0), PointerView.remove(PointerView.currentPointer), Date.now());
            cleverapps.meta.compound(e, [function (e) {
                cleverapps.menuBar.clean(), cleverapps.aims.clear(), cleverapps.meta.clearTempControls(), n.dynamicNodesDirty = !1, n.updateDynamicNodes = cleverapps.EMPTY_FUNCTION, n.performRecursive(function (e) {
                    cc.eventManager.removeListeners(e), e.stopAllActions(), e instanceof cleverapps.Spine && e.setCompleteListener()
                }), e()
            }, function (e) {
                i.prepareBundles && i.prepareBundles(), e()
            }, function (e) {
                this.createTransition(n, i), n.onTransitionAnimationDidStart && n.onTransitionAnimationDidStart(),
                    this.transition && this.transition.performRecursive(function (e) {
                        e._transitionChild = !0
                    }), n.performRecursive(function (e) {
                        e === n || e._transitionChild || (e.updateSize && (e.updateSize = cleverapps.EMPTY_FUNCTION), e.updatePosition && (e.updatePosition = cleverapps.EMPTY_FUNCTION)), delete e._transitionChild
                    }), this.transition && this.transition.closeCurtains ? this.transition.closeCurtains(e, cleverapps.silentIntro) : e()
            }.bind(this), function (e) {
                this.transition && this.transition.replaceParent(i);
                var t = n.getContentSize();
                cc.director.runScene(i), cc.director.setNextScene(), t.width === i.width && t.height === i.height || (cleverapps.resolution.setupDesignResolution(), i.setPositionRound(cleverapps.UI.getBgSize().width - i.width, cleverapps.UI.getBgSize().height - i.height)), e()
            }.bind(this), function (e) {
                n.unload && n.unload(i);
                for (var t = [n]; 0 < t.length;) {
                    var s = t.pop(),
                        t = t.concat(s.children);
                    s.iterateTiles && s.iterateTiles(function (e) {
                        e instanceof cc.Node && t.push(e)
                    }), s.removeAllChildren()
                }
                n = void 0,
                    "creator" === engine && cc.SkeletonCache.sharedCache.clear(), e()
            }, function (e) {
                e = cleverapps.wait(2, e);
                cleverapps.rewardedAdsManager.showPreroll(e), i.load ? i.load(e) : e()
            }, function (e) {
                var t;
                i.onSceneLoaded && i.onSceneLoaded(), i.setLoadingFinished && i.setLoadingFinished(), i.updateDynamicNodes && i.updateDynamicNodes(!0), i.cachedBundles && (t = i.cachedBundles().filter(function (e) {
                    return e && bundles[e]
                }), cleverapps.bundleLoader.cacheBundles(t)), e()
            }, function (e) {
                cleverapps.config.debugMode && LoaderScene.start && (console.log("scene loading time", (Date.now() - LoaderScene.start) / 1e3), LoaderScene.start = void 0), cleverapps.toolModel && "undefined" != typeof ToolView && i.movingNode && (cleverapps.toolModel.reset(), i.toolMenu = new ToolView, i.movingNode.addChild(i.toolMenu), i.toolMenu.addOpener()), this.transition && this.transition.openCurtains ? this.transition.openCurtains(e, cleverapps.silentIntro) : e()
            }.bind(this), function (e) {
                this.removeTransition(), e()
            }.bind(this), function (e) {
                cc.game.isPaused() && cc.game.step(),
                    cleverapps.ConsoleStream.sendLoadingTime("scene " + cleverapps.environment.scene + " " + (Date.now() - t) + "ms"), e()
            }])
        }, cleverapps.Scenes.prototype.createTransition = function (e, t) {
            this.removeTransition(), cleverapps.flags.noTransitionAnimation || (e.createTransition && t.canTransitionFast && t.canTransitionFast() && (this.transition = e.createTransition()), this.transition || (this.transition = new TransitionAnimation, e.addChild(this.transition), this.transition.updateSize(), this.transition.updatePosition()), this.transition.transitionBundles && cleverapps.bundleLoader.loadBundles(this.transition.transitionBundles))
        }, cleverapps.Scenes.prototype.removeTransition = function () {
            this.transition && (this.transition.removeFromParent(), this.transition.transitionBundles && cleverapps.bundleLoader.deleteBundles(this.transition.transitionBundles), this.transition = void 0)
        }, cleverapps.Scenes.prototype.reset = function () {
            this.removeTransition()
        }, cleverapps.Scenes.prototype.sceneRefresh = function () {
            cleverapps.flags.reset(),
                cleverapps.episodes.reset(), cleverapps.hose && (cleverapps.hose.reset(), cleverapps.hose.setCurrentEpisode(levels.user.episode)), levels.tutorial && levels.tutorial.stop(), cleverapps.social.isLoggedIn() ? cleverapps.social.onLogin() : cleverapps.synchronizer.syncWhenReady(), cleverapps.windows.reset(), cleverapps.scenes.reset(), cleverapps.isKnockoutGame() && cleverapps.meta.getMainObject().knockoutGame.stopRumble(), cleverapps.meta.distract({
                    focus: "sceneRefresh",
                    action: function (e) {
                        cleverapps.travelBook.gotoMainScene(e)
                    }
                })
        }, cc.Node.extend({
            ctor: function () {
                this._super(), this.setAnchorPoint2(), this.setLocalZOrder(TransitionAnimation.ZORDER), this.curtains = new cleverapps.Spine(bundles.transition.jsons.transition_curtains_json), this.addChild(this.curtains), this.person = new cleverapps.Spine(bundles.transition.jsons.transition_person_json), this.addChild(this.person);
                var e = cleverapps.Spine.getSkins(bundles.transition.jsons.transition_curtains_json);
                0 < e.length && (e = e[levels.user.getVirtualLevel() % e.length],
                    this.curtains.setSkin(e))
            },
            updateSize: function () {
                var e = cleverapps.scenes.getRunningScene(),
                    e = 1.1 * Math.max(e.height / this.curtains.height, e.width / this.curtains.width);
                1 < e && this.curtains.setScale(e)
            },
            updatePosition: function () {
                this.setPositionRound(this.parent.width / 2, this.parent.height / 2)
            },
            closeCurtains: function (e, t) {
                var s = [function (e) {
                    e = cleverapps.once(e), this.curtains.setAnimation(0, "close", !1), this.curtains.setCompleteListener(e), this.person.setAnimation(0, "close", !1), t ? (this.curtains.clearTrack(0), this.person.clearTrack(0), e()) : this.runAction(new cc.Sequence(new cc.DelayTime(cleverapps.styles.TransitionAnimation.open.delay), new cc.CallFunc(e)))
                }.bind(this), function (e) {
                    this.showLoadingAnimation(t), cc.eventManager.removeListeners(this), e()
                }.bind(this)];
                new ActionPlayer(s).play(e)
            },
            openCurtains: function (e, t) {
                e = cleverapps.once(e), this.curtains.setAnimation(0, "open", !1), this.curtains.setCompleteListener(e), this.person.setAnimation(0, "open", !1), this.hideLoading(), t ? e() : this.runAction(
                    new cc.Sequence(new cc.DelayTime(cleverapps.styles.TransitionAnimation.open.delay), new cc.CallFunc(e)))
            },
            showLoadingAnimation: function (e) {
                var t, s = bundles.main.jsons.wait_transition_json,
                    i = cleverapps.styles.TransitionAnimation.loading;
                s && cleverapps.bundleLoader.isLoaded(cleverapps.Spine.listBundles(s)) && (t = this.loading = new cc.Node, this.addChild(t), s = new cleverapps.Spine(s), t.addChild(s), s.setAnimation(0, "idle", !0), s = cleverapps.UI.generateOnlyText("Loading", cleverapps.styles.FONTS.TRANSITION_LOADING_TEXT), t.addChild(s), s.setPositionRound(i.textPos), cleverapps.UI.wrap(t), t.setAnchorPoint2(), t.setPositionRound(i), e || (t.setVisible(!1), t.setScale(0), t.runAction(new cc.Sequence(new cc.Show, new cc.ScaleTo(.3, 1)))))
            },
            hideLoading: function () {
                this.loading && (this.loading.removeFromParent(), this.loading = void 0)
            }
        })),
        WebViewAudioEngine = (TransitionAnimation.ZORDER = 1e3, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TRANSITION_LOADING_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.TransitionAnimation = {
            loading: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -400
                },
                textPos: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 60
                    }
                }
            },
            open: {
                delay: 1.5
            }
        }, cleverapps.Tutorial = function () {
            this.tutorialSteps = new cleverapps.TutorialSteps, this.steps = this.tutorialSteps.list(this.nextStep.bind(this))
        }, cleverapps.Tutorial.prototype.setGame = function (e) {
            this.game = e, this.tutorialSteps.setGame(this.game)
        }, cleverapps.Tutorial.prototype.stop = function () {
            this.running && (this.running = !1, this.step = this.steps.length, this.finishCallback(), this.finishCallback = void 0)
        }, cleverapps.Tutorial.prototype.start = function (e) {
            this.running = !0, this.finishCallback = e, this.setStep(0)
        }, cleverapps.Tutorial.prototype.remindStep = function () {
            this.isRunning() && this.steps[this.step].call(this, this.game)
        }, cleverapps.Tutorial.prototype.setStep = function (e) {
            var t = {
                step: this.step = e
            };
            if (this.step >= this.steps.length) return cleverapps.eventLogger.logEvent(
                cleverapps.EVENTS.GENERAL.TUTORIAL_COMPLETE, t), void this.stop();
            var s = cleverapps.EVENTS.STATS.TUTORIAL_STEP + (e + 1);
            cleverapps.eventLogger.logEvent(s, t), 0 === e && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.TUTORIAL_BEGIN), this.remindStep()
        }, cleverapps.Tutorial.prototype.nextStep = function () {
            this.isRunning() && this.setStep(this.step + 1)
        }, cleverapps.Tutorial.prototype.isRunning = function () {
            return this.running
        }, cleverapps.EventsLogger = function () {
            this.pool = {
                names: [],
                data: []
            }, this.externalEvents = cleverapps.createSet(cleverapps.values(cleverapps.EVENTS.GENERAL).concat(cleverapps.values(cleverapps.EVENTS.TARGET_FOR_BUYING).concat([cleverapps.EVENTS.SPENT.HARD, cleverapps.EVENTS.EARN.HARD]))), this.statsEvents = cleverapps.createSet(cleverapps.values(cleverapps.EVENTS.STATS))
        }, cleverapps.EventsLogger.prototype.logEvent = function (e, t) {
            var s, i, n;
            cleverapps.flags && cleverapps.flags.noLogEvents || (void 0 === t && (t = {}), 40 < e.length && console.log(
                "WARN: Invalid event name: " + e + "!. It must be between 1 and 40 characters, and must be contain only alphanumerics, , - or spaces, starting with alphanumeric or _."), -1 === cleverapps.EventsLogger.IGNORED_EVENTS.indexOf(e) && this._storeEvent(e, t), e = 0 === e.indexOf("hard-") ? cleverapps.EVENTS.SPENT.HARD : e, this.externalEvents[e] && (cleverapps.adjust && cleverapps.adjust.logEvent(e, t), cleverapps.adOcean && void 0 !== AdOcean.EVENTS_MAP[e] && cleverapps.adOcean.logEvent(AdOcean.EVENTS_MAP[e], t), n = cleverapps.EventsLogger.GOOGLE_EVENTS[e] || e, cleverapps.firebase && cleverapps.firebase.logEvent(n, t), cleverapps.googleAnalytics && cleverapps.googleAnalytics.logEvent(n, t), n = (s = cleverapps.EventsLogger.FACEBOOK_EVENTS[e]) ? s.eventName : e, i = {}, s ? Object.keys(s.params).forEach(function (e) {
                    i[e] = t[s.params[e]]
                }) : Object.keys(t).forEach(function (e) {
                    i["value" === e ? e : "fb_" + e] = t[e]
                }), cc.sys.isNative ? cleverapps.nativeFbEventsLogger.logEvent(n, i) : "undefined" != typeof FBInstant ? FBInstant.logEvent(n, i.value || 1, i) : "undefined" != typeof GSInstant && GSInstant.logEvent(e, "string", JSON.stringify(t))), cleverapps.thinkingData && (this.externalEvents[e] || this.statsEvents[e] || e.startsWith(cleverapps.EVENTS.STATS.SHOP_OPEN)) && ((n = cleverapps.EventsLogger.THINKINGDATA_EVENTS[e] || e).startsWith(cleverapps.EVENTS.STATS.SHOP_OPEN) && (n = "shop_enter"), cleverapps.thinkingData.logEvent(n, t)))
        }, cleverapps.EventsLogger.prototype._storeEvent = function (e, t) {
            if ((void 0 === e || e.startsWith("undefined")) && cleverapps.config.debugMode) throw 1;
            this.pool.names.push(e), this.pool.data.push(t);
            e = this.getBaseParameters();
            setTimeout(this.sendEvents.bind(this, e), 0)
        }, cleverapps.EventsLogger.prototype.sendEvents = function (e) {
            var t;
            0 < this.pool.names.length && (t = this.pool.names.join(","), console.log("Sending events - " + t), (e = Object.assign(e, this.getBaseParameters())).events = t, e.params = this.pool.data, cleverapps.RestClient.post("/events/", e, function () { }, function () {
                console.log("Failure event - " + t)
            }), this.pool.names = [], this.pool.data = [])
        },
            cleverapps.EventsLogger.prototype.getBaseParameters = function () {
                var e = {},
                    t = (cleverapps.user && cleverapps.platform.getUserID() && (e.id = cleverapps.platform.getUserID()), cleverapps.environment && (void 0 !== cleverapps.environment.levelNo && (e.level = cleverapps.environment.levelNo), void 0 !== cleverapps.environment.episodeNo && (e.episode = cleverapps.environment.episodeNo)), cleverapps.config && "merge" === cleverapps.config.type && cleverapps.user && (e.level = cleverapps.user.level), Game.currentGame && Game.currentGame.level);
                return t && t.hash && (e.hash = t.hash), e.source = cleverapps.platform.source, e
            }, cleverapps.EventsLogger.FACEBOOK_EVENTS = {}, cleverapps.EventsLogger.FACEBOOK_EVENTS[cleverapps.EVENTS.GENERAL.TUTORIAL_COMPLETE] = {
                eventName: "fb_mobile_tutorial_completion",
                params: {}
            }, cleverapps.EventsLogger.FACEBOOK_EVENTS[cleverapps.EVENTS.GENERAL.LEVEL_UP] = {
                eventName: "fb_mobile_level_achieved",
                params: {
                    fb_level: "level"
                }
            }, cleverapps.EventsLogger.FACEBOOK_EVENTS[cleverapps.EVENTS.SPENT.HARD] = {
                eventName: "fb_mobile_spent_credits",
                params: {
                    value: "value"
                }
            }, cleverapps.EventsLogger.GOOGLE_EVENTS = {}, cleverapps.EventsLogger.GOOGLE_EVENTS[cleverapps.EVENTS.SPENT.HARD] = "spend_virtual_currency", cleverapps.EventsLogger.GOOGLE_EVENTS[cleverapps.EVENTS.EARN.HARD] = "earn_virtual_currency", cleverapps.EventsLogger.THINKINGDATA_EVENTS = {}, cleverapps.EventsLogger.THINKINGDATA_EVENTS[cleverapps.EVENTS.STATS.SHOP_OPEN] = "shop_enter", cleverapps.EventsLogger.THINKINGDATA_EVENTS[cleverapps.EVENTS.STATS.SHOP_CLOSE] = "shop_stay", cleverapps.EventsLogger.IGNORED_EVENTS = [cleverapps.EVENTS.GENERAL.LEVEL_UP], cleverapps.NativeFbEventsLogger = function () {
                this.batch = []
            }, cleverapps.NativeFbEventsLogger.prototype.logEvent = function (e, t) {
                cleverapps.flags.nofacebookevents || (this.batch.push({
                    name: e,
                    params: t
                }), this.logEventsBatch())
            }, cleverapps.NativeFbEventsLogger.prototype.logEventsBatch = cleverapps.accumulate(1e3, function () {
                cleverapps.flags.nofacebookevents || (cleverapps.platform.oneOf(AndroidBase, IOS, IOSCh) && cleverapps.platform.callNative("FacebookPlugin.logEventsBatch", {
                    events: this.batch
                }), this.batch = [])
            }), cleverapps.FbPixel = function () {
                cleverapps.platform.oneOf(CleverApps) && cleverapps.config.fbPixelId && !cleverapps.config.debugMode || cleverapps.override(this, cleverapps.FakeFbPixel), this.initialize()
            }, cleverapps.FbPixel.prototype.initialize = function () {
                var e, t, s;
                t = window, s = document, t.fbq || (e = t.fbq = function () {
                    e.callMethod ? e.callMethod.apply(e, arguments) : e.queue.push(arguments)
                }, t._fbq || (t._fbq = e), (e.push = e).loaded = !0, e.version = "2.0", e.queue = [], (t = s.createElement("script")).async = !0, t.src = "https://connect.facebook.net/en_US/fbevents.js", (s = s.getElementsByTagName("script")[0]).parentNode.insertBefore(t, s)), fbq("init", cleverapps.config.fbPixelId), this.logEvent("PageView")
            }, cleverapps.FbPixel.prototype.logEvent = function (e, t) {
                fbq("track", e, t)
            }, cleverapps.FakeFbPixel = {
                initialize: function () { },
                logEvent: function () { }
            }, (cleverapps = "undefined" != typeof module && void 0 === cleverapps ? require("./utils") : cleverapps).Random = {
                state: 0,
                m: 2147483648,
                a: 1103515245,
                c: 12345,
                seed: function (e) {
                    return "number" == typeof e ? (cleverapps.Random.state = Math.abs(parseInt(e) || 0) % cleverapps.Random.m, cleverapps.Random.state) : "string" == typeof e ? cleverapps.Random.seed(cleverapps.hashCode(e)) : void cleverapps.throwAsync("Expecting string as seed")
                },
                randomSeed: function () {
                    cleverapps.Random.state = Math.floor(Math.random() * cleverapps.Random.m);
                    for (var e = cleverapps.Random.state, t = [], s = 0; s < 100; s++) {
                        if (x = this.nextInt(), 0 <= t.indexOf(x)) return void this.randomSeed();
                        t.push(x)
                    }
                    cleverapps.Random.state = e
                },
                shuffle: function (e, t) {
                    for (var s, i = [], n = [], o = 0; o < e.length; o++) n.push(o);
                    for (void 0 !== t && (s = cleverapps.Random.state, cleverapps.Random.seed(t)), o = 0; o < e.length; o++) {
                        var a = cleverapps.Random.random(n.length);
                        i.push(e[n[a]]), n.splice(a, 1)
                    }
                    return void 0 !== s && cleverapps.Random.seed(s), i
                },
                nextInt: function () {
                    return cleverapps.Random.state = (cleverapps.Random.a * cleverapps.Random.state + cleverapps.Random.c) % cleverapps.Random.m,
                        cleverapps.Random.state
                },
                nextDouble: function () {
                    return cleverapps.Random.nextInt() / cleverapps.Random.m
                },
                seededDouble: function (e) {
                    var t = cleverapps.Random.state,
                        e = (cleverapps.Random.seed(e), cleverapps.Random.nextDouble());
                    return void 0 !== t && cleverapps.Random.seed(t), e
                },
                mathChoose: function (e) {
                    if (0 !== e.length) return e[Math.floor(Math.random() * e.length)]
                },
                chooseAmount: function (e, t, s) {
                    var i, n = [];
                    void 0 !== s && (i = cleverapps.Random.state, cleverapps.Random.seed(!1 !== s ? s : Math.floor(1e6 * Math.random())));
                    for (var o = 0; o < t && e.length; o++) {
                        var a = this.choose(e);
                        n.push(a), e.splice(e.indexOf(a), 1)
                    }
                    return void 0 !== i && cleverapps.Random.seed(i), n
                },
                choose: function (e, t) {
                    if (0 !== e.length) return e[cleverapps.Random.random(0, e.length - 1, t)]
                },
                probability: function (e, t, s) {
                    if (Array.isArray(e) && (e = cleverapps.Random.random(e[0], e[1])), t.length < s.length) {
                        for (var i = s.length - t.length, n = 0, o = 0; o < t.length; o++) n += t[o];
                        for (var a = 0; a < i; a++) t.push((1 - n) / i)
                    }
                    for (var r = [], c = 0; c < e; c++) {
                        var l = cleverapps.Random.pickOne(t);
                        void 0 !== l && r.push(l)
                    }
                    return r.sort(), r.map(function (e) {
                        return s[e]
                    })
                },
                pickOne: function (e) {
                    for (var t = cleverapps.Random.nextDouble(), s = 0; s < e.length; s++)
                        if ((t -= e[s]) < 0) return s
                },
                random: function (e, t, s) {
                    void 0 !== s && (i = cleverapps.Random.state, cleverapps.Random.seed(!1 !== s ? s : Math.floor(1e6 * Math.random()))), void 0 === t && (t = e - 1, e = 0);
                    var i, s = t - e + 1,
                        t = cleverapps.Random.nextInt() / cleverapps.Random.m,
                        e = e + Math.floor(t * s);
                    return void 0 !== i && cleverapps.Random.seed(i), e
                }
            }, cleverapps.Random.randomSeed(), "undefined" != typeof module && (module.exports = cleverapps.Random), cleverapps.Audio = function () {
                this.cache = {}, WebViewAudioEngine.IsApplicable() && (cc.sys.isWebViewAudio = !0, cc.audioEngine = new WebViewAudioEngine), this.disk = void 0, this.muted = !1, this.volume = 1, this.currentFade = void 0
            }, cleverapps.Audio.prototype.insertDisk = function (e) {
                this.eject(), this.disk = processVirtualUrl(e), this.onChangeMusic()
            }, cleverapps.Audio.prototype.eject = function () {
                this.setVolume(1), this.stopFade(), this.disk && (this.disk = void 0,
                    this.onChangeMusic())
            }, cleverapps.Audio.prototype.mute = function () {
                this.muted || cleverapps.gameModes.noMute || cleverapps.platform.oneOf(Instant) && cc.sys.os === cc.sys.OS_IOS && cc.sys.isInApp || (console.log("Audio mute"), this.muted = !0, this.onChangeMusic(), cc.Audio.gainNode && (cc.Audio.gainNode.gain.value = 0))
            }, cleverapps.Audio.prototype.unmute = function () {
                !this.muted || cleverapps.gameModes.noMute || cleverapps.platform.oneOf(Instant) && cc.sys.os === cc.sys.OS_IOS && cc.sys.isInApp || (console.log("Audio unmute"), this.muted = !1, this.onChangeMusic(), cc.Audio.gainNode && (cc.Audio.gainNode.gain.value = 1))
            }, cleverapps.Audio.prototype.onChangeMusic = function () {
                var e;
                this.disk && !this.muted && cleverapps.settings.music && !cc.game.isPaused() ? (this.logSound(this.disk), this.volume !== this.realVolume && this.setVolume(this.volume), e = cc.loader.getRes(this.disk), (cc.sys.isWebViewAudio || e && (!e.isLoaded || e.isLoaded())) && cc.audioEngine.playMusic(this.disk, !0)) : cc.audioEngine.stopMusic()
            },
            cleverapps.Audio.prototype.onSoundsLoaded = function (e) {
                this.disk && -1 !== e.indexOf(this.disk) && this.onChangeMusic()
            }, cleverapps.Audio.prototype.stopFade = function () {
                this.currentFade && (cleverapps.timeouts.clearInterval(this.currentFade), delete this.currentFade)
            }, cleverapps.Audio.prototype.setVolume = function (e) {
                this.volume = e, cc.audioEngine.canChangeMusicVolume() && !this.muted && cleverapps.settings.music && !cc.game.isPaused() && (this.realVolume = e, cc.audioEngine.setMusicVolume(e))
            }, cleverapps.Audio.prototype.fadeOut = function (e) {
                this.setVolume(1), this.stopFade(), this.disk && this._fade(e, -1)
            }, cleverapps.Audio.prototype.fadeIn = function (e) {
                this.stopFade(), e ? (this.setVolume(0), this.disk && this._fade(e, 1)) : this.setVolume(1)
            }, cleverapps.Audio.prototype._fade = function (e, t) {
                var s = (1e3 * e || 400) / 20,
                    i = 1 / s * t;
                this.currentFade = cleverapps.timeouts.setInterval(function () {
                    var e = Math.max(0, Math.min(1, Math.floor(1e3 * (this.volume + i)) / 1e3));
                    this.setVolume(e), 0 === --s && (t < 0 && this.eject(), this.stopFade())
                }.bind(this), 20)
            },
            cleverapps.Audio.prototype.playSound = function (e, t) {
                if (cleverapps.settings.sound && !cc.game.isPaused() && !this.muted && cleverapps.platform.isAudioContextRunning())
                    if (e = processVirtualUrl(e)) {
                        this.logSound(e, t = t || {});
                        var s = this.cache[e],
                            i = void 0 !== t.throttle ? t.throttle : cleverapps.Audio.THROTTLE_AUDIO;
                        if (!(s && s.getPlaying() && s.startPlaying + i > Date.now())) return (i = (cc.audioEngine._audioPool[e] || []).filter(function (e) {
                            return !e.getPlaying()
                        })[0]) && cc.audioEngine.stopEffect(i), s = cc.loader.getRes(e), cc.sys.isWebViewAudio || s && (!s.isLoaded || s.isLoaded()) ? ((s = cc.audioEngine.playEffect(e, t.loop)).startPlaying = Date.now(), this.cache[e] = s) : void 0
                    } else cleverapps.config.debugMode
            }, cleverapps.Audio.prototype.stopSound = function (e) {
                cc.audioEngine.stopEffect(e)
            }, cleverapps.Audio.THROTTLE_AUDIO = 250, cleverapps.Audio.prototype.logSound = function (e, t) {
                cleverapps.config.debugMode && cleverapps.keyboardController.isPressed(cc.KEY.s) && (console.log("--------------------- sound logging ----------------------"),
                    console.log("sound file", e), t && console.log("sound options", t), console.log("----------------------------------------------------------"))
            }, cc.audioEngine.canChangeMusicVolume = function () {
                return cc.audioEngine._currMusic && cc.audioEngine._currMusic.setVolume
            }, cc.Audio.prototype.isLoaded = function () {
                return !!this._element
            }, cc.Audio.prototype.play = cleverapps.extendFunc(cc.Audio.prototype.play, function () {
                this._super.apply(this, arguments), cc.game.isPaused() && (cleverapps.throwAsync("Play audio error: game is paused - " + this.src), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.AUDIO_PLAY_PAUSED_GAME))
            }),
            function () {
                this._musicVolume = 1, this._musicUrl = void 0, this._audioPool = {}, this.batch = {}, this.sendBatch = cleverapps.accumulate(0, this._sendBatch.bind(this))
            }),
        WebViewAudio = (WebViewAudioEngine.prototype._pausePlaying = function () { }, WebViewAudioEngine.prototype._resumePlaying = function () { }, WebViewAudioEngine.prototype.setMusicVolume = function (e) {
            e -= 0, isNaN(e) && (e = 1), this._musicVolume = e = (e = 1 < e ? 1 : e) < 0 ? 0 : e, this.batch.setMusicVolume = {
                action: "setMusicVolume",
                volume: e
            }, this.sendBatch()
        }, WebViewAudioEngine.prototype._sendBatch = function () {
            var e = cleverapps.values(this.batch);
            cleverapps.platform.callNative("AudioPlugin.sendBatch", {
                batch: e
            }), this.batch = {}
        }, WebViewAudioEngine.prototype.getMusicVolume = function () {
            return this._musicVolume
        }, WebViewAudioEngine.prototype.playMusic = function (e, t) {
            e && (this._musicUrl = e, this.batch.musicAction = {
                action: "playMusic",
                url: e,
                loop: Boolean(t)
            }, this.sendBatch())
        }, WebViewAudioEngine.prototype.stopMusic = function () {
            this._musicUrl = void 0, this.batch.musicAction = {
                action: "stopMusic"
            }, this.sendBatch()
        }, WebViewAudioEngine.prototype.stopEffect = function (e) {
            e && e.url && (this.batch["effect_" + e.url] = {
                action: "stopEffect",
                url: e.url
            }, this.sendBatch())
        }, WebViewAudioEngine.prototype.stopAllEffects = function () { }, WebViewAudioEngine.prototype.playEffect = function (e, t) {
            if (e) return this.batch["effect_" + e] = {
                action: "playEffect",
                url: e,
                loop: Boolean(t)
            }, this.sendBatch(), new WebViewAudio(e, t)
        }, WebViewAudioEngine.prototype.canChangeMusicVolume = function () {
            return !0
        }, WebViewAudioEngine.IsApplicable = function () {
            return (cleverapps.platform.oneOf(Apple) || cleverapps.platform.audioPluginAvailable && cleverapps.platform.oneOf(AndroidBase)) && cc.sys.isNative && !cc.sys.isNativeFlight && cc.sys.isMobile
        }, function (e, t) {
            this.url = e, this.loop = t, this.startPlaying = Date.now()
        }),
        Alarm = (WebViewAudio.prototype.getPlaying = function () {
            return Date.now() < this.startPlaying + cleverapps.parseInterval(WebViewAudio.FAKE_DURATION)
        }, WebViewAudio.FAKE_DURATION = "1 second", (cleverapps = "undefined" == typeof cc ? require("../utils") : cleverapps).ABTest = function () {
            this.groups = {}, this.updateGroups()
        }, cleverapps.ABTest.A = 0, cleverapps.ABTest.B = 1, cleverapps.ABTest.C = 2, cleverapps.ABTest.D = 3, cleverapps.ABTest.groupEventNames = {}, Object.keys(cleverapps.ABTest).forEach(function (e) {
            var t = cleverapps.ABTest[e];
            "number" == typeof t && (cleverapps.ABTest.groupEventNames[t] = e.toLowerCase())
        }), cleverapps.ABTest.prototype.updateGroups = function (e) {
            this.groups = {};
            var t, s = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ABTEST) || {};
            for (t in cleverapps.ABTest.Tests) {
                var i, n = cleverapps.ABTest.Tests[t];
                cleverapps.user.checkAvailable(n.available) && (void 0 === s[t] ? cleverapps.isLocalhost() ? this.setGroup(n, cleverapps.ABTest.A) : (i = cleverapps.ABTest.A, cleverapps.Random.seededDouble((e || cleverapps.platform.getUserID()) + n.id) > n.AWeight && (i = cleverapps.ABTest.B), this.setGroup(n, i)) : this.setGroup(n, s[t]))
            }
        }, cleverapps.ABTest.prototype.forceGroup = function (e, t) {
            var s = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ABTEST) || {};
            s[e.id] = t, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ABTEST, s), this.updateGroups()
        }, cleverapps.ABTest.prototype.getGroup = function (e) {
            return this.groups[e.id]
        }, cleverapps.ABTest.prototype.setGroup = function (e, t) {
            this.groups[e.id] = t
        }, cleverapps.ABTest.prototype.logEvent = function (e, t, s) {
            var i = this.getGroup(e);
            void 0 !== i && (i = cleverapps.ABTest.groupEventNames[i], cleverapps.eventLogger.logEvent(
                "ab_" + e.id + "_" + i + "_" + t, s))
        }, cleverapps.ABTest.prototype.allLogEvent = function (e, t) {
            t = t || {};
            var s, i = cleverapps.travelBook.getCurrentExpedition(),
                n = t.expedition || i && i.id;
            for (s in this.groups) {
                var o, a = cleverapps.ABTest.Tests[s];
                a.expeditions && -1 === a.expeditions.indexOf(n) || (o = cleverapps.ABTest.groupEventNames[this.getGroup(a)], cleverapps.eventLogger.logEvent("ab_" + a.id + "_" + o + "_" + e, t))
            }
        }, cleverapps.ABTest.HIGH_MONETIZATION = function () {
            return cleverapps.abTest.getGroup(cleverapps.ABTest.Tests.highMonet) === cleverapps.ABTest.A
        }, cleverapps.ABTest.APP_LOVIN = function () {
            return cleverapps.abTest.getGroup(cleverapps.ABTest.Tests.appLovin) === cleverapps.ABTest.A
        }, cleverapps.ABTest.BUY_INGREDIENTS = function () {
            return cleverapps.abTest.getGroup(cleverapps.ABTest.Tests.buyIng) === cleverapps.ABTest.A
        }, cleverapps.ABTest.Tests = {
            highMonet: {
                AWeight: .3,
                available: {
                    registeredDate: "2024-01-10",
                    source: ["instant", "yandex", "web_ok", "mobile_ok", "test"],
                    projectName: ["riddles", "heroes", "woodenblock", "tripeaks"]
                }
            },
            appLovin: {
                available: {
                    source: ["android"],
                    projectName: ["mergecraft", "wondermerge"],
                    paymentsCountry: "other"
                }
            },
            buyIng: {
                expeditions: ["dragonia3"],
                available: {
                    projectName: ["mergecraft", "wondermerge", "fairy"]
                }
            }
        }, cleverapps.ABTest.ChangeConfigsForAB = function () { }, function () {
            for (var e in cleverapps.ABTest.Tests) {
                var t = cleverapps.ABTest.Tests[e];
                t.id = e, t.groups = t.groups || [cleverapps.ABTest.A, cleverapps.ABTest.B], t.AWeight = t.AWeight || .5
            }
        }(), "undefined" == typeof cc && (module.exports = cleverapps.ABTest.Tests), function () {
            this.on = !1, this.alarms = {}, this.priority = 0, this.onChangeListeners = {}
        }),
        Mission = (Alarm.prototype.isOn = function () {
            return 0 < this.priority
        }, Alarm.prototype.start = function (e, t) {
            this.alarms[e] = t || 1, this.onChange()
        }, Alarm.prototype.stop = function (e) {
            delete this.alarms[e], this.onChange()
        }, Alarm.prototype.clear = function () {
            this.alarms = {}, this.onChange()
        }, Alarm.prototype.onChange = function () {
            var e = 0;
            for (t in this.alarms) this.alarms[t] > e && (e = this.alarms[t]);
            if (e !== this.priority)
                for (
                    var t in this.priority = e, this.onChangeListeners) this.onChangeListeners[t](e)
        }, "undefined" == typeof cc && (cleverapps = require("../utils")), function (e, t, s) {
            this.started = void 0, this.type = e, this.state = Mission.STATE_RUNNING, this.details = {}, this.result = 0, this.onChangeResults = function () { }, Object.assign(this, Missions[this.type]), this.isMinigameMission() && (this.currency = this.getStartCurrency()), this.type === Mission.TYPE_LANTERN && (this.result = 1);
            e = !t;
            e ? (this.started = Date.now(), this.needShowStartWindow = !0) : this.load(t), this.oncePerEvent && (t = cleverapps.eventManager.getFeatureEvent(this.feature), this.eventFinishTime = t ? t.finish.getTime() : Date.now()), this.startCompetition(e || s), this.logic && (this.logic = new this.logic(this, e)), this.onUpdateState()
        }),
        MissionManager = (Mission.STATE_RUNNING = 0, Mission.STATE_COMPLETED = 1, Mission.prototype.displayCompleted = function (e) {
            cleverapps.meta.compound(e, [function (e) {
                this.wasDisplayedCompleted = !0, this.finishWindow ? (new this.finishWindow(this),
                    cleverapps.meta.onceNoWindowsListener = e) : e()
            }.bind(this), function (e) {
                this.logic && this.logic.blowUp ? this.logic.blowUp(e) : e()
            }.bind(this), function (e) {
                !this.lastChanceUsed && this.hasLastChance() ? (this.lastChanceUsed = !0, new this.lastChanceView(this), cleverapps.meta.onceNoWindowsListener = e) : e()
            }.bind(this), function (e) {
                for (var t = this.runningCompetition && this.place < 3, s = this.receiveReward(), i = !1; s;) RewardWindow.createMissionWindow(s, this, {
                    shareId: t && "tournament"
                }), i = !0, s = this.receiveReward();
                (this.canRemove() || this.manualFinish) && (this.logic && this.logic.beforeRemove && this.logic.beforeRemove(), cleverapps.missionManager.remove(this, !1)), i ? cleverapps.meta.onceNoWindowsListener = e : e()
            }.bind(this)])
        }, Mission.prototype.onUpdateState = function () {
            var e;
            this.countdown && (this.countdown.remove(), delete this.countdown), this.isRunning() ? 0 < (e = this.getTimeLeft()) && (this.countdown = new cleverapps.CountDown(e, {
                onFinish: this.onUpdateState.bind(this),
                permanent: !0
            })) : (this.complete(),
                this.runningCompetition && this.runningCompetition.stop(), this.logic && this.logic.stop && this.logic.stop()), this.updateMissionIcon()
        }, Mission.prototype.updateMissionIcon = function () {
            var e = cleverapps.sideBar.findMissionIcon(this.type);
            e && e.resetState()
        }, Mission.prototype.userInfoChanged = function (e) {
            this.runningCompetition.onUserInfoChanged(e), cleverapps.missionManager.table.resetResults(this.type), this.resultsChanged()
        }, Mission.prototype.resultsChanged = function () {
            this.onChangeResults(), this.logic && this.logic.onChangeResults && this.logic.onChangeResults()
        }, Mission.prototype.beforeRemove = function () {
            this.countdown && (this.countdown.remove(), delete this.countdown), this.runningCompetition && this.runningCompetition.stop(), this.logic && this.logic.stop && this.logic.stop(!0), this.removeChildMissions()
        }, Mission.prototype.load = function (e) {
            this.started = e.started, this.result = e.result, this.details = e.details, this.currency = e.currency
        }, Mission.prototype.update = function (e, t, s) {
            this.isRunning() || (t = e = void 0),
                this.increaseResult(e, t, s)
        }, Mission.prototype.increaseResult = function (e, t, s) {
            (e || t) && (this.result += e, t && (this.details = t), cleverapps.user.incProgressCompare()), this.runningCompetition && e && this.runningCompetition.updatePlayerResult(cleverapps.platform.getUserID(), this.result), cleverapps.missionManager.save(), s || this.onUpdateMission(e)
        }, Mission.prototype.onUpdateMission = function (e) {
            this.onUpdateState(), this.onChangeResults(), this.logic && this.logic.onUpdateMission && this.logic.onUpdateMission(e)
        }, Mission.prototype.canRemoveSilently = function () {
            return this.logic ? !!this.logic.canRemoveSilently && this.logic.canRemoveSilently() : 0 === this.result || "?" === this.getSummary().place
        }, Mission.prototype.canRemove = function () {
            return !this.manualFinish && (this.logic && this.logic.canRemove ? this.logic.canRemove() : this.rewardsReceived)
        }, Mission.prototype.hasLastChance = function () {
            return !!this.lastChanceView && (!(!this.canRemove() && !this.manualFinish) && (!(!this.logic || !this.logic.hasLastChance) && this.logic.hasLastChance()))
        }, Mission.prototype.receiveReward = function () {
            if (this.logic && this.logic.receiveReward) return this.logic.receiveReward();
            if (!this.rewardsReceived) {
                var e = this.getPrize();
                if (e && e.unit && !this.mainWorldReward) {
                    var t = cleverapps.toArray(e.unit).length - Game.currentGame.map.countEmptySlots();
                    if (0 < t) return void Game.currentGame.centerHint.createTextHint("Spawn.nospace", {
                        left: t
                    })
                }
                this.rewardsReceived = !0;
                var t = e ? "_prize" : "_lost",
                    s = (this.runningCompetition && 0 === this.place && (t = "_first"), cleverapps.EVENTS.MISSION_FINISH);
                return cleverapps.travelBook.isExpedition() && (s += "_" + cleverapps.travelBook.getCurrentPage().id), cleverapps.eventLogger.logEvent(s + t), cleverapps.eventLogger.logEvent(s + "_" + this.type + t), e
            }
        }, Mission.prototype.skipNext = function () {
            return this.logic && this.logic.skipNext && this.logic.skipNext()
        }, Mission.prototype.useMissionIntent = function (e) {
            var t = this.getViewClass();
            cleverapps.scenes.replaceScene(new t(this), e)
        }, Mission.prototype.updateCurrency = function (e, t) {
            0 !== e && void 0 !== this.currency && (this.currency += e, t && (this.details = t), this.onUpdateState(), cleverapps.missionManager.save())
        }, Mission.prototype.getSummary = function () {
            return this.runningCompetition ? {
                place: this.runningCompetition.calcPlace(),
                points: this.runningCompetition.player.amount
            } : {
                place: "?",
                points: this.result
            }
        }, Mission.prototype.getResults = function () {
            if (!this.runningCompetition) return [];
            var e = this.runningCompetition.getResults().map(function (e) {
                return {
                    id: e.id,
                    player: e.player,
                    text: e.name,
                    avatar: {
                        id: e.id,
                        avatar: e.avatar
                    },
                    amount: e.amount
                }
            });
            return e.sort(function (e, t) {
                return e.amount === t.amount && (e.player || t.player) ? e.player ? -1 : 1 : t.amount - e.amount
            }), e.forEach(function (e, t) {
                e.place = t + 1
            }), e
        }, Mission.prototype.save = function () {
            return this.logic && this.logic.save && this.logic.save(this.details), {
                started: this.started,
                type: this.type,
                result: this.result,
                currency: this.currency,
                details: this.details,
                semaphore: this.semaphore
            }
        }, Mission.prototype.getName = function () {
            return this.name
        },
            Mission.prototype.getWindowBundleName = function () {
                return this.bundle
            }, Mission.prototype.isMinigameMission = function () {
                return void 0 !== this.minigame
            }, Mission.prototype.isPassMission = function () {
                return this.logic && this.logic instanceof PassMissionLogic
            }, Mission.prototype.isExpedition = function () {
                return this.logic && this.logic instanceof ExpeditionMissionLogic
            }, Mission.prototype.isSlotMachineMission = function () {
                return this.logic && "undefined" != typeof SlotMachineMissionLogic && this.logic instanceof SlotMachineMissionLogic
            }, Mission.prototype.isTreasureSearchMission = function () {
                return this.logic && "undefined" != typeof TreasureSearchMissionLogic && this.logic instanceof TreasureSearchMissionLogic
            }, Mission.prototype.isCompetitionMission = function () {
                return void 0 !== this.competition
            }, Mission.prototype.getViewClass = function () {
                return this.view
            }, Mission.prototype.getViewConstructor = function () {
                return this.viewConstructor
            }, Mission.prototype.complete = function () {
                this.state === Mission.STATE_RUNNING && (
                    this.state = Mission.STATE_COMPLETED, cleverapps.missionManager.refreshOffer(this))
            }, Mission.prototype.getIcon = function () {
                return Mission.getCollectIcon(this.type)
            }, Mission.prototype.finishTime = function () {
                if (this.feature) {
                    if (this.oncePerEvent) return this.eventFinishTime;
                    var e = cleverapps.eventManager.getFeatureEvent(this.feature) || cleverapps.eventManager.getLastFeatureEvent(this.feature);
                    return e ? e.finish.getTime() : 0
                }
                return this.manualFinish ? 0 : this.started + cleverapps.parseInterval(this.duration)
            }, Mission.prototype.getTimeLeft = function () {
                return Math.max(0, this.finishTime() - Date.now())
            }, Mission.prototype.isRunning = function () {
                return !(this.state !== Mission.STATE_RUNNING || !(this.manualFinish || 0 < this.getTimeLeft()))
            }, Mission.prototype.isCompleted = function () {
                return this.state === Mission.STATE_COMPLETED
            }, Mission.prototype.canPlayMinigame = function () {
                return this.isMinigameMission() && this.currency && this.currency >= this.getMinigamePrice()
            }, Mission.prototype.getMinigamePrice = function () {
                return this.minigame.price
            }, Mission.prototype.isMinigameReadyToFinish = function () {
                return this.isMinigameMission() && this.logic && this.logic.isMinigameReadyToFinish && this.logic.isMinigameReadyToFinish()
            }, Mission.prototype.getStartCurrency = function () {
                return void 0 !== this.startCurrency ? this.startCurrency : this.getMinigamePrice()
            }, Mission.prototype.getMinigameClass = function () {
                return this.minigame.className
            }, Mission.prototype.getChildMissionTypes = function () {
                return (this.childMissions || []).map(function (e) {
                    return Mission.CompoundType(e, this.type)
                }, this)
            }, Mission.prototype.getChildMissions = function () {
                return this.getChildMissionTypes().map(function (e) {
                    return cleverapps.missionManager.findByType(e)
                }).filter(function (e) {
                    return e
                })
            }, Mission.prototype.removeChildMissions = function () {
                this.getChildMissions().forEach(function (e) {
                    cleverapps.missionManager.remove(e)
                })
            }, Mission.prototype.getLevelReward = function () {
                return -1 !== [Mission.TYPE_TREASURE_SEARCH].indexOf(this.type) ? [1, 3, 2] : -1 !== [Mission.TYPE_LEVELPASS].indexOf(this.type) ? [3, 6, 4] : [1, 1, 1]
            }, Mission.prototype.getPrize = function () {
                return this.logic && this.logic.getPrize ? this.logic.getPrize() : this.prize ? this.minigame ? this.logic.isFinished() ? -1 !== ["board", "match3"].indexOf(cleverapps.config.type) && -1 !== [Mission.TYPE_TREASURE_SEARCH, Mission.TYPE_STICKERS_COLLECTION].indexOf(this.type) ? cleverapps.user.prepareRewardByRich(this.prize) : this.prize : void 0 : (this.place = this.getSummary().place, this.place < this.prize.length ? this.getPrizeByPlace(this.place) : void 0) : void 0
            }, Mission.prototype.getPrizeByPlace = function (e) {
                return "merge" !== cleverapps.config.type ? cleverapps.user.prepareRewardByRich(this.prize[e]) : this.prize[e]
            }, Mission.prototype.updateCompetitionResults = function () {
                this.runningCompetition && this.runningCompetition.updatePlayerResult(cleverapps.platform.getUserID(), this.result)
            }, Mission.prototype.startCompetition = function (e) {
                this.isCompetitionMission() && (e && Competition.CLEAN_SAVED(this.type), e = Competition.optionsByMission(this),
                    this.runningCompetition = new Competition(e), this.runningCompetition.onChangeResultsListeners.mission = this.resultsChanged.bind(this), this.runningCompetition.onChangePlaceListener = this.updateMissionIcon.bind(this), cleverapps.friends.playerInfoChangedListeners.mission = this.userInfoChanged.bind(this), this.runningCompetition.start())
            }, Mission.prototype.isAvailable = function () {
                return !this.logic || !this.logic.isAvailable || this.logic.isAvailable()
            }, Mission.ParseCompoundType = function (e) {
                return e = String(e).split("_"), {
                    type: cleverapps.castType(e[0]),
                    parentType: cleverapps.castType(e[1])
                }
            }, Mission.GetParentType = function (e) {
                return Mission.ParseCompoundType(e).parentType
            }, Mission.GetChildType = function (e) {
                return Mission.ParseCompoundType(e).type
            }, Mission.CompoundType = function (e, t) {
                return e = Mission.GetChildType(e), void 0 !== t ? e + "_" + t : e
            }, Mission.ParseTypeVersion = function (e) {
                return e = Mission.ParseCompoundType(e), String(e.type).split("v")[1] || 0
            }, Mission.VersionType = function (e, t) {
                return (
                    e = Mission.ParseCompoundType(e)).type = cleverapps.castType(String(e.type).split("v")[0]), 0 < t && (e.type += "v" + t), Mission.CompoundType(e.type, e.parentType)
            }, Mission.getCollectIcon = function (e) {
                return cleverapps.skins.getSlot("missionIcon", {
                    type: e
                })
            }, "undefined" == typeof cc && (module.exports = {
                Mission: Mission
            }),
            function () {
                this.missions = [], this.teaser = void 0, this.unknownMissionsData = [], this.oldMissions = [], this.lastRemoved = {}, this.table = new cleverapps.Table, this.semaphoresOnHold = 0
            }),
        Offers = (MissionManager.prototype.isObsoleteMissionType = function (e) {
            var t = Mission.GetParentType(e);
            return !(void 0 === t || !this.isObsoleteMissionType(t)) || -1 !== Mission.OBSOLETE_TYPES.indexOf(Mission.GetChildType(e))
        }, MissionManager.prototype.isPastEventMission = function (e, t) {
            e = Missions[e].feature, e = e && cleverapps.eventManager.getFeatureEvent(e);
            return e && e.isRunning() && t < e.getStartTime()
        }, MissionManager.prototype.canCreateType = function (e) {
            var t = Missions[e];
            if (!t) return !1;
            if (!cleverapps.createSet(this.getExistingTypes())[e]) return !1;
            t = t.available || {};
            if (t.projectName && -1 === cleverapps.toArray(t.projectName).indexOf(cleverapps.config.name)) return !1;
            if (cleverapps.config.demoMode) return !0;
            if (t.debugMode && !cleverapps.config.debugMode) return !1;
            if (t.disabled) return !1;
            t = Mission.GetParentType(e);
            return !(void 0 !== t && !this.canCreateType(t))
        }, MissionManager.prototype.init = function () {
            this.reset(), this.load(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.MISSIONS))
        }, MissionManager.prototype.migrateOldData = function (t) {
            for (var e = {}, s = (-1 !== ["wondermerge", "fairy"].indexOf(cleverapps.config.name) && (e[40] = "40v1"), -1 !== ["mergecraft", "fairy"].indexOf(cleverapps.config.name) && (e[32] = "32v1", e[46] = "46v1"), Array.isArray(t) ? t : t.missions || []), i = s.filter(function (e) {
                return -1 !== [Mission.TYPE_DRAGONIA_EXPEDITION, Mission.TYPE_UNDERSEA_EXPEDITION].indexOf(e.type) && void 0 === e.lastRemoved
            })[0], n = 0; n < s.length; n++) {
                var o = s[n],
                    a = (Mission.TYPE_SLOT2_PASS === o.type && i ? o.type = Mission.CompoundType(Mission.TYPE_EXPEDITION_PASS, i.type) : Mission.TYPE_SLOT2_FEAST === o.type && i && (o.type = Mission.CompoundType(Mission.TYPE_EXPEDITION_FEAST, i.type)), Mission.ParseCompoundType(o.type));
                void 0 !== e[a.type] && (o.type = e[a.type]), void 0 !== e[a.parentType] && (o.type = Mission.CompoundType(a.type, e[a.parentType]))
            }
            return Object.keys(t.lastRemoved || {}).forEach(function (e) {
                s.push({
                    type: cleverapps.castType(e),
                    lastRemoved: t.lastRemoved[e]
                })
            }), s
        }, MissionManager.prototype.load = function (e, t) {
            if (e)
                for (var s = [], i = this.migrateOldData(e), n = 0; n < i.length; n++) {
                    var o = i[n],
                        a = Mission.GetParentType(o.type);
                    void 0 !== a && s.includes(a) || this.isObsoleteMissionType(o.type) || (this.isOldMission(o.type) ? this.pushToOldMission(o) : this.canCreateType(o.type) ? this.findByType(o.type) || (void 0 === o.lastRemoved ? -1 !== o.started ? this.canUseSemaphore(o.type) ? (this.add(o.type, o, t), delete this.lastRemoved[o.type]) : s.push(o.type) : this.teaser = o.type : this.lastRemoved[o.type] = o.lastRemoved) : this.handleUnknownType(o))
                }
        }, MissionManager.prototype.isOldMission = function (e) {
            var t = Mission.GetParentType(e);
            return void 0 !== Mission.OLD_VERSIONS[e] || void 0 !== Mission.OLD_VERSIONS[t]
        }, MissionManager.prototype.pushToOldMission = function (e) {
            for (var t = 0; t < this.oldMissions.length && this.oldMissions[t].type !== e.type; ++t);
            t === this.oldMissions.length && this.oldMissions.push(e);
            var s = this.oldMissions[t];
            void 0 !== e.lastRemoved ? this.oldMissions[t] = e : void 0 !== s.lastRemoved ? this.oldMissions[t] = s : this.oldMissions[t] = Object.assign(s, e)
        }, MissionManager.prototype.handleUnknownType = function (e) {
            this.unknownMissionsData.push(e), cleverapps.playSession.set(cleverapps.EVENTS.DEBUG.UNKNOWN_MISSION_DAU, !0)
        }, MissionManager.prototype.getPlayableMissions = function () {
            return this.missions.filter(function (e) {
                return e.isRunning() && e.canPlayMinigame()
            })
        }, MissionManager.prototype.findLocalExpedition = function () {
            for (var e = 0; e < this.missions.length; e++) {
                var t = this.missions[e];
                if (t.logic instanceof ExpeditionMissionLogic && cleverapps.travelBook.getCurrentPage().id === t.id && t.isRunning()) return t
            }
        },
            MissionManager.prototype.findLocalPass = function () {
                for (var e = 0; e < this.missions.length; e++) {
                    var t = this.missions[e];
                    if (t.logic instanceof PassMissionLogic && MissionManager.hasProperParent(t) && t.isRunning()) return t
                }
            }, MissionManager.prototype.findRunningMission = function (e) {
                for (var t = cleverapps.createSet(cleverapps.toArray(e) || []), s = 0; s < this.missions.length; s++)
                    if (this.missions[s].isRunning() && t[this.missions[s].type]) return this.missions[s]
            }, MissionManager.prototype.findBySemaphore = function (e) {
                for (var t = 0; t < this.missions.length; ++t) {
                    var s = this.missions[t];
                    if (s.isRunning() && s.semaphore & e) return s
                }
            }, MissionManager.prototype.findByType = function (e) {
                e = cleverapps.castType(e);
                for (var t = 0; t < this.missions.length; t++)
                    if (this.missions[t].type === e) return this.missions[t]
            }, MissionManager.prototype.skipNext = function () {
                return 0 < this.missions.filter(function (e) {
                    return e.skipNext()
                }).length
            }, MissionManager.prototype.getMissionWithIntent = function () {
                for (var e in this.missions) {
                    e = this.missions[e];
                    if (
                        e.logic && e.logic.hasIntent && e.logic.hasIntent()) return e
                }
            }, MissionManager.prototype.dispatchEvent = function (e, t) {
                e = "object" == typeof e ? e : this.findByType(e);
                return !(!e || !e.isRunning()) && (e.logic.processEvent(t), !0)
            }, MissionManager.prototype.reset = function () {
                for (var e = 0; e < this.missions.length; ++e) {
                    var t = this.missions[e],
                        s = cleverapps.sideBar.findMissionIcon(t.type);
                    s && cleverapps.sideBar.removeTemporaryIcon(s), this.refreshOffer(t)
                }
                this.table.reset(), this.missions = [], this.teaser = void 0, this.unknownMissionsData = [], this.oldMissions = [], this.lastRemoved = {}, this.semaphoresOnHold = 0
            }, MissionManager.prototype.save = function (e) {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.MISSIONS, this.getInfo()), e || this.addUpdateTask()
            }, MissionManager.prototype.sendUpdateTask = function () {
                void 0 !== MissionManager.sendUpdateTimeout && (clearTimeout(MissionManager.sendUpdateTimeout), MissionManager.sendUpdateTimeout = void 0), cleverapps.synchronizer.addUpdateTask("missions")
            },
            MissionManager.prototype.addUpdateTask = function () {
                if ("merge" !== cleverapps.config.type && Game.currentGame && Game.currentGame.outcome === GameBase.OUTCOME_UNKNOWN) return void 0 !== MissionManager.sendUpdateTimeout || cleverapps.environment.isSceneWithPreview() || (MissionManager.sendUpdateTimeout = setTimeout(this.sendUpdateTask.bind(this), cleverapps.parseInterval("1 minute"))), void (Game.currentGame.missionManagerStopHandler || (Game.currentGame.missionManagerStopHandler = Game.currentGame.on("stop", function () {
                    void 0 !== MissionManager.sendUpdateTimeout && this.sendUpdateTask()
                }.bind(this))));
                this.sendUpdateTask()
            }, MissionManager.prototype.getInfo = function () {
                var t = [],
                    s = {};
                return this.missions.forEach(function (e) {
                    t.push(e.save()), s[e.type] = !0
                }), this.unknownMissionsData.forEach(function (e) {
                    t.push(e)
                }), this.oldMissions.forEach(function (e) {
                    t.push(e)
                }), Object.keys(this.lastRemoved).forEach(function (e) {
                    s[e] || (t.push({
                        type: cleverapps.castType(e),
                        lastRemoved: this.lastRemoved[e]
                    }), s[e] = !0)
                }, this), t
            },
            MissionManager.prototype.updateInfo = function (e, t) {
                console.log("updateInfo", e), this.reset(), this.load(e, t), this.save(t)
            }, MissionManager.prototype.removeSilents = function () {
                for (; ;) {
                    for (var e = !1, t = 0; t < this.missions.length; t++) {
                        var s = this.missions[t];
                        if (s.isCompleted() && s.canRemoveSilently()) {
                            e = !0, this.remove(s);
                            break
                        }
                    }
                    if (!e) break
                }
            }, MissionManager.prototype.wantsToShowCompleted = function () {
                return this.missions.find(function (e) {
                    return !(!e.isCompleted() || e.canRemoveSilently() || e.wasDisplayedCompleted) && (e.logic && e.logic.canShowCompleted ? e.logic.canShowCompleted() : MissionManager.hasProperParent(e))
                })
            }, MissionManager.prototype.pendingStartWindow = function () {
                for (var e = 0; e < this.missions.length; e++) {
                    var t = this.missions[e];
                    if (this.hasPendingStartWindow(t) && (!Missions[t.type].available || cleverapps.user.checkAvailable(Missions[t.type].available))) return t
                }
            }, MissionManager.prototype.hasPendingStartWindow = function (e) {
                return e && e.needShowStartWindow && e.startWindow && MissionManager.hasProperParent(e)
            },
            MissionManager.prototype.showStartWindow = function (n) {
                cleverapps.meta.display({
                    focus: "missionStartWindow_" + n.type,
                    actions: [function (e) {
                        var t, s, i;
                        n.logic && n.logic.unitStory ? (t = n.logic.unitStory.story, s = n.logic.unitStory.unit, n.logic.unitStory = void 0, (i = s.findComponent(Ship)) && i.onCustomSpawn(cc.ScrollAction.SCROLL_TO_DURATION), Game.currentGame.unitStories.showUnitStory(e, t.dialogue, {
                            unit: s,
                            delay: 2e3
                        })) : e()
                    }, function (e) {
                        n.needShowStartWindow = !1, n.startWindow === MissionRulesOptionsBuilder ? (new GuideWindow(MissionRulesOptionsBuilder.build(n)), cleverapps.meta.onceNoWindowsListener = e) : cleverapps.meta.compound(e, [function (e) {
                            new n.startWindow(n), cleverapps.meta.onceNoWindowsListener = e
                        }, function (e) {
                            var t = cleverapps.offerManager.findOffer({
                                mission: n.type
                            });
                            t && !n.offerWindowShown ? (new MissionOfferWindow(t), cleverapps.meta.onceNoWindowsListener = e) : e()
                        }])
                    }, function (e) {
                        n.tutorial && Game.currentGame && Game.currentGame.tutorial ? Game.currentGame.tutorial.showTutorial(n.tutorial, e) : e()
                    }]
                })
            },
            MissionManager.prototype.getExistingTypes = function () {
                return this._getExistingTypes().filter(function (e) {
                    return !cleverapps.platform.oneOf(GDCom) || !cleverapps.platform.isCoolmathgames() || -1 === [Mission.TYPE_LETTER, Mission.TYPE_STICKERS_COLLECTION, Mission.TYPE_LIVESFEAST, Mission.TYPE_SOFTFEAST, Mission.TYPE_KRAKENFEAST, Mission.TYPE_SNAIL_FEAST, Mission.TYPE_EXPEDITION_FEAST, Mission.TYPE_SLOT_MACHINE].indexOf(e)
                })
            }, MissionManager.prototype._getExistingTypes = function () {
                if (this.existingTypes) return this.existingTypes;
                var e = [],
                    i = ("board" === cleverapps.config.type || "solitaire" === cleverapps.config.type || "differences" === cleverapps.config.type ? e.push(Mission.TYPE_LETTER) : "tile3" === cleverapps.config.type ? (e.push(Mission.TYPE_LETTER), e.push(Mission.TYPE_CHAIN_SALE)) : "match3" === cleverapps.config.type && (e.push(Mission.TYPE_COMBO), e.push(Mission.TYPE_COLLECT_MARK), e.push(Mission.TYPE_BURN_NEARBY), e.push(Mission.TYPE_LANTERN)), e.push(Mission.TYPE_TREASURE_SEARCH), -1 !== ["wordsoup", "crocword", "magicwords"].indexOf(cleverapps.config.name) && e.push(Mission.TYPE_STICKERS_COLLECTION), -1 !== ["scramble", "riddles", "heroes"].indexOf(cleverapps.config.name) && e.push(Mission.TYPE_BONUS_WORLD), -1 !== ["scramble"].indexOf(cleverapps.config.name) && e.push(Mission.TYPE_SLOT_MACHINE), (e = "merge" === cleverapps.config.type ? [Mission.TYPE_LIVESFEAST, Mission.TYPE_BUILDPASS, Mission.TYPE_SOFTFEAST, Mission.TYPE_BOOSTTIME, Mission.TYPE_CHESTTIME, Mission.TYPE_SALEPASS, Mission.TYPE_KRAKENFEAST, Mission.TYPE_EXPEDITION_PASS, Mission.TYPE_EXPEDITION_FEAST, Mission.TYPE_CARAVAN, Mission.TYPE_SNAIL_FEAST, Mission.TYPE_PERIODIC_PACK].concat(TravelBook.LIST_IN_ORDER_EXPEDITIONS()) : e).push(Mission.TYPE_PERIODIC_SALE), cleverapps.createSet(e)),
                    e = e.reduce(function (s, e) {
                        return Missions[e] && (Missions[e].implementations || [e]).forEach(function (e) {
                            var t = Mission.GetParentType(e);
                            (void 0 === t || i[t] && Missions[t]) && s.push(e)
                        }), s
                    }, []);
                return this.existingTypes = e, this.existingTypes
            }, MissionManager.prototype.isAvailableByType = function (e, t) {
                if (
                    t = t || {}, Missions[e].disableNew) return !1;
                var s = Missions[e].feature;
                if (s && !t.skipFeatures && !cleverapps.eventManager.isActive(s)) return !1;
                s = cleverapps.clone(Missions[e].available || {}, !0);
                return t.teaser && ("merge" === cleverapps.config.type ? s.level-- : (s.level -= .66, s.level < 0 && (s.level = 0))), cleverapps.user.checkAvailable(s)
            }, MissionManager.prototype.refreshTeaser = function () {
                var e = cleverapps.sideBar.getTeaserIcon();
                !e || e.type === this.teaser && MissionManager.hasProperParent(Missions[this.teaser]) || (cleverapps.sideBar.removeTemporaryIcon(e), e = void 0), this.teaser && !e && MissionManager.hasProperParent(Missions[this.teaser]) && (e = new TeaserIcon(this.teaser), cleverapps.sideBar.addTemporaryIcon(e))
            }, MissionManager.prototype.canUseSemaphore = function (e) {
                for (var t = 0, s = 0; s < this.missions.length; s++) t |= this.missions[s].semaphore;
                for (s = 0; s < this.unknownMissionsData.length; s++) t |= this.unknownMissionsData[s].semaphore || 0;
                return this.semaphoresOnHold && (t |= this.semaphoresOnHold), 0 == (t & Missions[e].semaphore)
            },
            MissionManager.prototype.canCreateTypes = function () {
                var e = this.getExistingTypes(),
                    t = e.filter(function (e) {
                        return this.isAvailableByType(e)
                    }.bind(this)),
                    e = e.filter(function (e) {
                        return Missions[e].teaser && -1 === t.indexOf(e) && this.isAvailableByType(e, {
                            teaser: !0
                        })
                    }.bind(this)),
                    a = cleverapps.competitionPlayers.getAmount(),
                    s = function (e) {
                        var t = Missions[e];
                        if (0 === t.semaphore && this.findByType(e)) return !1;
                        if (t.manualStart) return !1;
                        if (!MissionManager.hasProperParent(t)) return !1;
                        var s = this.getLastRemoved(e);
                        if (s) {
                            if (t.oneShot) return !1;
                            var i = t.cooldown && cleverapps.parseInterval(t.cooldown);
                            if (i && s + i > Date.now()) return !1
                        }
                        i = Missions.SEMAPHORE_COOLDOWNS[t.semaphore];
                        if (i) {
                            var n, o = 0;
                            for (n in this.lastRemoved) Missions[n].semaphore === t.semaphore && o < (s = this.getLastRemoved(n)) && (o = s);
                            if (o + cleverapps.parseInterval(i) > Date.now()) return !1
                        }
                        i = t.competition && t.competition.amount[1] || 0;
                        return this.canUseSemaphore(e) && i <= a
                    }.bind(this),
                    i = function (e, t) {
                        return this.teaser === e ? -1 : this.teaser === t ? 1 : (this.lastRemoved[e] || 0) - (
                            this.lastRemoved[t] || 0)
                    }.bind(this);
                return (t = t.filter(s)).sort(i), (e = e.filter(s)).sort(i), {
                    missions: t,
                    teasers: e
                }
            }, MissionManager.hasProperParent = function (e) {
                if (!e) return !1;
                if (cleverapps.environment.isEditorScene()) return !1;
                var t = Mission.GetParentType(e.type),
                    s = Missions[t];
                if (t && !s) return !1;
                t = cleverapps.travelBook.getCurrentExpedition();
                return "merge" === cleverapps.config.type && t ? "all" === e.episode || void 0 !== s && s.id && t.id === s.id : void 0 === s
            }, MissionManager.prototype.planMission = function (e) {
                this.next = e
            }, MissionManager.prototype.run = function () {
                var e = this.canCreateTypes(),
                    t = void 0 === this.next ? e.missions[0] : this.next,
                    e = ((this.next = void 0) !== t && (this.add(t), this.teaser === t && (this.teaser = void 0), this.save()), 0 < e.teasers.length && e.teasers[0]);
                !e || t && e.semaphore === t.semaphore || (this.teaser = e), this.refreshTeaser(), this.runManualMissions()
            }, MissionManager.prototype.runManualMissions = function () {
                this.getExistingTypes().forEach(function (e) {
                    this.manualStart(e)
                }, this)
            },
            MissionManager.prototype.manualStart = function (e, t) {
                var s = Missions[e],
                    i = s.manualStart;
                i && MissionManager.hasProperParent(s) && void 0 === this.findByType(e) && (s.available && !cleverapps.user.checkAvailable(s.available) || i(e, t) && (this.add(e), this.save()))
            }, MissionManager.prototype.remove = function (e) {
                e.beforeRemove();
                var t = this.missions.indexOf(e); - 1 !== t && (e.semaphore && (this.semaphoresOnHold |= e.semaphore, setTimeout(function () {
                    this.semaphoresOnHold & e.semaphore && (this.semaphoresOnHold -= e.semaphore)
                }.bind(this), cleverapps.parseInterval("1 minute"))), this.table.resetResults(e.type), this.missions.splice(t, 1), t = e.oncePerEvent ? e.eventFinishTime : Date.now(), this.lastRemoved[e.type] = t, this.updateOldMissions(e.type, t), this.clearChildLastRemoved(e), this.save(), (t = cleverapps.sideBar.findMissionIcon(e.type)) && cleverapps.sideBar.removeTemporaryIcon(t), this.refreshOffer(e), cleverapps.toolModel && cleverapps.toolModel.refresh())
            }, MissionManager.prototype.add = function (e, t, s) {
                t = new Mission(e, t, s);
                return this.missions.push(t), this.updateOldMissions(e, Date.now()), t.logic && t.logic.onAdded && t.logic.onAdded(), !1 !== t.sideBarJson && (s = new MissionIcon(t), cleverapps.sideBar.addTemporaryIcon(s)), this.refreshOffer(t), this.clearChildLastRemoved(t), cleverapps.playSession.set(cleverapps.EVENTS.MISSION_DAU + "_" + t.getName(), !0), cleverapps.toolModel && cleverapps.toolModel.refresh(), t
            }, MissionManager.prototype.clearChildLastRemoved = function (e) {
                e.getChildMissionTypes().forEach(function (e) {
                    delete this.lastRemoved[e]
                }, this)
            }, MissionManager.prototype.refreshOffer = function (e) {
                cleverapps.offerManager.refreshByMission(e.type)
            }, MissionManager.prototype.isMissionPassed = function (e) {
                return Missions[e] && Missions[e].oneShot && Boolean(this.getLastRemoved(e))
            }, MissionManager.prototype.getLastRemoved = function (e) {
                var t = this.lastRemoved[e];
                if (void 0 !== t) return t;
                var s = Mission.ParseTypeVersion(e);
                if (s) {
                    var i = {};
                    for (this.oldMissions.forEach(function (e) {
                        i[e.type] = e
                    }), --s; 0 <= s; --s) {
                        var n = i[Mission.VersionType(e, s)];
                        if (
                            n && n.lastRemoved < MissionManager.COMPATIBILITY_DATE) return n.lastRemoved
                    }
                }
                return 0
            }, MissionManager.prototype.updateOldMissions = function (e, t) {
                for (var s = Mission.ParseTypeVersion(e) - 1; 0 <= s; --s) this.pushToOldMission({
                    type: Mission.VersionType(e, s),
                    lastRemoved: MissionManager.COMPATIBILITY_DATE + t
                })
            }, MissionManager.prototype.getUnfinishedOldMission = function () {
                return this.oldMissions.find(function (e) {
                    return void 0 === e.lastRemoved
                })
            }, MissionManager.prototype.replaceOldMission = function () {
                var t, s, i = this.getUnfinishedOldMission();
                if (i) return t = Mission.OLD_VERSIONS[i.type], void 0 === t ? (this.oldMissions = this.oldMissions.filter(function (e) {
                    return e !== i
                }), void this.save()) : this.findByType(t) || this.lastRemoved[t] ? (this.updateOldMissions(t, Date.now()), this.save(), void cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.MISSION_REPLACED_REMOVED + i.type + "-" + t)) : this.isAvailableByType(t) ? this.isPastEventMission(t, i.started) ? (this.updateOldMissions(t, Date.now()), this.save(),
                    void cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.MISSION_REPLACED_PAST + i.type + "-" + t)) : void cleverapps.meta.display({
                        focus: "replaceOldMission" + i.type,
                        actions: [function (e) {
                            new ReplaceOldMissionWindow(t), cleverapps.meta.onceNoWindowsListener = e
                        }, function (e) {
                            this.planMission(t), this.run(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.MISSION_REPLACED + i.type + "-" + t), e(), s = this.findByType(t), this.hasPendingStartWindow(s) && this.showStartWindow(s)
                        }.bind(this)]
                    }) : (this.updateOldMissions(t, Date.now()), this.save(), void cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.MISSION_REPLACED_UNAVAILABLE + i.type + "-" + t))
            }, MissionManager.COMPATIBILITY_DATE = 41024448e5, {
            TYPES: {}
        }),
        Offer = (Offers.TYPES.LIVESFEAST = 1, Offers.TYPES.SOFTFEAST = 2, Offers.TYPES.KRAKENFEAST = 3, Offers.TYPES.BUILDPASS = 4, Offers.TYPES.SALEPASS = 5, Offers.TYPES.DRAGONIA = 6, Offers.TYPES.UNDERSEA = 7, Offers.TYPES.UNDERSEA2 = 8, Offers.TYPES.SNAILFEAST = 9, Offers.TYPES.HALLOWEEN = 10, Offers.TYPES.SNAILFEAST_DRAGONIA2 = 11,
            Offers.TYPES.RAPUNZEL = 12, Offers.TYPES.XMAS = 13, Offers.TYPES.RAPUNZEL2 = 14, Offers.TYPES.PERIODIC_PACK = 15, Offers.TYPES.EASTER = 16, Offers.TYPES.DRAGONIA2 = 17, Offers.TYPES.DRAGONIA3 = 18, Offers.TYPES.SNAILFEAST_DRAGONIA3 = 19, Offers.TYPES.CHINA = 20, Offers.initialize = function () {
                for (var e in "merge" === cleverapps.config.type && (Offers[Offers.TYPES.LIVESFEAST] = {
                    mission: Mission.TYPE_LIVESFEAST,
                    price: 250,
                    reward: RewardsConfig.LivesFeast.offer,
                    sideBarJson: bundles.sidebar.jsons.lives_feast_offer,
                    name: "LivesFeastOffer",
                    bundle: "lives_offer"
                }, Offers[Offers.TYPES.BUILDPASS] = {
                    mission: Mission.TYPE_BUILDPASS,
                    price: 299,
                    reward: RewardsConfig.BuildPass.offer,
                    sideBarJson: bundles.sidebar.jsons.buildpass_offer,
                    name: "BuildPassOffer",
                    bundle: "buildpass_offer"
                }, Offers[Offers.TYPES.SALEPASS] = {
                    mission: Mission.TYPE_SALEPASS,
                    price: 299,
                    reward: RewardsConfig.SalePass.offer,
                    sideBarJson: bundles.sidebar.jsons.salepass_offer,
                    name: "SalePassOffer",
                    bundle: "salepass_offer"
                }, -1 === ["mbga", "sp_mbga"].indexOf(cleverapps.config.source) && (
                    Offers[Offers.TYPES.SOFTFEAST] = {
                        mission: Mission.TYPE_SOFTFEAST,
                        price: 250,
                        reward: RewardsConfig.SoftFeast.offer,
                        sideBarJson: bundles.sidebar.jsons.soft_feast_offer,
                        name: "SoftFeastOffer",
                        bundle: "soft_offer"
                    }), Offers[Offers.TYPES.KRAKENFEAST] = {
                        mission: Mission.TYPE_KRAKENFEAST,
                        reward: RewardsConfig.KrakenFeast.offer,
                        price: 299,
                        sideBarJson: bundles.sidebar.jsons.kraken_offer,
                        name: "KrakenFeastOffer",
                        bundle: "kraken_offer"
                    }, Offers[Offers.TYPES.DRAGONIA] = {
                        mission: Mission.TYPE_DRAGONIA_EXPEDITION,
                        hero: {
                            code: "dragonpack",
                            stage: 0
                        },
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT2,
                        fog: "fog4",
                        reward: RewardsConfig.DragoniaPack,
                        sideBarJson: bundles.sidebar.jsons.dragonia_offer,
                        name: "DragoniaPack",
                        bundle: "dragonia_offer"
                    }, Offers[Offers.TYPES.UNDERSEA] = {
                        mission: Mission.TYPE_UNDERSEA_EXPEDITION,
                        hero: {
                            code: "underseapack",
                            stage: 0
                        },
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT2,
                        fog: "fog4",
                        reward: RewardsConfig.UnderseaPack,
                        sideBarJson: bundles.sidebar.jsons.undersea_offer,
                        name: "UnderseaPack",
                        bundle: "undersea_offer"
                    }, Offers[Offers.TYPES.UNDERSEA2] = {
                        mission: Mission.TYPE_UNDERSEA2_EXPEDITION,
                        hero: {
                            code: "sea2pack",
                            stage: 0
                        },
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT2,
                        fog: "fog4",
                        reward: RewardsConfig.Undersea2Pack,
                        sideBarJson: bundles.sidebar.jsons.undersea_offer,
                        name: "Undersea2Pack",
                        bundle: "undersea_offer"
                    }, Offers[Offers.TYPES.SNAILFEAST] = {
                        mission: Mission.CompoundType(Mission.TYPE_SNAIL_FEAST, Mission.TYPE_UNDERSEA2_EXPEDITION),
                        price: 49,
                        force: Forces.OFFER_ICON_SLOT2,
                        sideBarJson: bundles.sidebar.jsons.snailhouse_offer_json,
                        reward: RewardsConfig.SnailPack,
                        name: "SnailPack",
                        bundle: "snailhouse_offer"
                    }, Offers[Offers.TYPES.SNAILFEAST_DRAGONIA2] = {
                        mission: Mission.CompoundType(Mission.TYPE_SNAIL_FEAST, Mission.TYPE_DRAGONIA2_EXPEDITION),
                        price: 49,
                        force: Forces.OFFER_ICON_SLOT2,
                        sideBarJson: bundles.sidebar.jsons.snailhouse_offer_json,
                        reward: RewardsConfig.SnailHouseDragoniaPack,
                        name: "SnailPack",
                        bundle: "snailhouse_offer"
                    }, Offers[Offers.TYPES.SNAILFEAST_DRAGONIA3] = {
                        mission: Mission.CompoundType(Mission.TYPE_SNAIL_FEAST, Mission.TYPE_DRAGONIA3_EXPEDITION),
                        price: 49,
                        force: Forces.OFFER_ICON_SLOT2,
                        sideBarJson: bundles.sidebar.jsons.snailhouse_offer_json,
                        reward: RewardsConfig.SnailHouseDragoniaPack,
                        name: "SnailPack",
                        bundle: "snailhouse_offer"
                    }, Offers[Offers.TYPES.HALLOWEEN] = {
                        mission: Mission.TYPE_HALLOWEEN_2023_EXPEDITION,
                        hero: {
                            code: "hlpack",
                            stage: 0
                        },
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT1,
                        fog: "fog4",
                        reward: RewardsConfig.HalloweenPack,
                        sideBarJson: bundles.sidebar.jsons.halloween_offer,
                        name: "HalloweenPack",
                        bundle: "halloween_offer"
                    }, Offers[Offers.TYPES.RAPUNZEL] = {
                        mission: Mission.TYPE_RAPUNZEL_EXPEDITION,
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT2,
                        fog: "fog2",
                        cooldown: cleverapps.config.debugMode ? "2 minutes" : "24 hours",
                        reward: RewardsConfig.RapunzelPack,
                        sideBarJson: bundles.sidebar.jsons.rapunzel_offer,
                        name: "RapunzelPack",
                        bundle: "rapunzel_offer"
                    }, Offers[Offers.TYPES.RAPUNZEL2] = {
                        mission: Mission.TYPE_RAPUNZEL2_EXPEDITION,
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT2,
                        fog: "fog2",
                        cooldown: cleverapps.config.debugMode ? "2 minutes" : "24 hours",
                        reward: RewardsConfig.RapunzelPack,
                        sideBarJson: bundles.sidebar.jsons.rapunzel_offer,
                        name: "Rapunzel2Pack",
                        bundle: "rapunzel_offer"
                    }, Offers[Offers.TYPES.XMAS] = {
                        mission: Mission.TYPE_XMAS_EXPEDITION,
                        hero: {
                            code: "xmpack",
                            stage: 0
                        },
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT1,
                        fog: "fog4",
                        reward: RewardsConfig.XmasPack,
                        sideBarJson: bundles.sidebar.jsons.xmas_offer,
                        name: "XmasPack",
                        bundle: "xmas_offer"
                    }, Offers[Offers.TYPES.PERIODIC_PACK] = {
                        mission: Mission.TYPE_PERIODIC_PACK,
                        product: "expeditionPack",
                        reward: RewardsConfig.PeriodicPack,
                        sideBarJson: bundles.sidebar.jsons.periodic_pack_json,
                        name: "periodicOffer",
                        bundle: "periodic_pack",
                        force: Forces.PERIODIC_PACK
                    }, Offers[Offers.TYPES.EASTER] = {
                        mission: Mission.TYPE_EASTER_EXPEDITION,
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT1,
                        fog: "fog2",
                        cooldown: cleverapps.config.debugMode ? "2 minutes" : "24 hours",
                        reward: RewardsConfig.EasterPack,
                        sideBarJson: bundles.sidebar.jsons.easter_offer,
                        name: "EasterPack",
                        bundle: "easter_offer"
                    }, Offers[Offers.TYPES.DRAGONIA2] = {
                        mission: Mission.TYPE_DRAGONIA2_EXPEDITION,
                        hero: {
                            code: "dr2dragonpack",
                            stage: 0
                        },
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT2,
                        fog: "fog4",
                        reward: RewardsConfig.Dragonia2Pack,
                        sideBarJson: bundles.sidebar.jsons.dragonia_offer,
                        name: "Dragonia2Pack",
                        bundle: "dragonia_offer"
                    }, Offers[Offers.TYPES.DRAGONIA3] = {
                        mission: Mission.TYPE_DRAGONIA3_EXPEDITION,
                        hero: {
                            code: "dr2dragonpack",
                            stage: 0
                        },
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT2,
                        fog: "fog10",
                        reward: RewardsConfig.Dragonia2Pack,
                        sideBarJson: bundles.sidebar.jsons.dragonia_offer,
                        name: "Dragonia2Pack",
                        bundle: "dragonia_offer"
                    }, Offers[Offers.TYPES.CHINA] = {
                        mission: Mission.TYPE_CHINA_EXPEDITION,
                        product: "expeditionPack",
                        force: Forces.OFFER_ICON_SLOT1,
                        fog: "fog2",
                        cooldown: cleverapps.config.debugMode ? "2 minutes" : "24 hours",
                        reward: RewardsConfig.ChinaPack,
                        sideBarJson: bundles.sidebar.jsons.china_offer,
                        name: "ChinaPack",
                        bundle: "china_offer"
                    }), Offers.offerByMission = {}, Offers.offerByHero = {}, Offers.offersByFog = {}, Offers.TYPES) {
                    var t = Offers.TYPES[e],
                        s = Offers[t];
                    s && (Missions.checkIllegal(s.mission) && cleverapps.throwAsync("Undefined offer mission " + s.mission + " offer: " + e), s.type = t, (Offers.offerByMission[s.mission] = s).hero && (Offers.offerByHero[Unit.GetKey(s.hero)] = s), s.fog && (Offers.offersByFog[s.fog] ? Offers.offersByFog[s.fog].push(s) : Offers.offersByFog[s.fog] = [s]))
                }
            },
            function (e) {
                e = Offers[e];
                this.type = e.type, this.mission = e.mission, this.hero = e.hero, this.product = e.product, this.force = e.force, this.price = e.price, this.reward = e.reward, this.sideBarJson = e.sideBarJson, this.name = e.name, this.bundle = e.bundle, this.onBought = function () { }
            }),
        OfferManager = (Offer.prototype.getPriceText = function () {
            return this.product ? Product.Create(this.product).getCurrentPrice() : "$$" + this.price
        }, Offer.prototype.hasProperMission = function () {
            var e = Mission.GetParentType(this.mission) || Mission.GetChildType(this.mission),
                t = Missions[e];
            if (!t) return !1;
            var s = cleverapps.travelBook.getCurrentExpedition();
            return s ? s.missionType === e : !cleverapps.travelBook.getPageById(t.id)
        }, Offer.prototype.getTimeLeft = function () {
            var e = cleverapps.missionManager.findByType(this.mission);
            return e && e.getTimeLeft() || 0
        }, Offer.prototype.buy = function () {
            if (this.reward.unit) {
                var e = this.reward.unit.reduce(function (e, t) {
                    return e + (t.amount || 0)
                }, 0) - Game.currentGame.map.countEmptySlots();
                if (0 < e) return void Game.currentGame.centerHint.createTextHint("Spawn.nospace", {
                    left: e
                })
            }
            var t = function () {
                this.product || new RewardWindow(this.reward);
                var e = cleverapps.missionManager.findByType(this.mission);
                e && e.logic && e.logic.offerBought && e.logic.offerBought(), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.OFFER_PURCHASE_TIME + this.type, Date.now()), cleverapps.offerManager.refreshOffer(this.type), this.onBought()
            }.bind(this),
                s = cleverapps.EVENTS.SPENT.MISSION_OFFER + this.name;
            if (this.product) return (e = Product.Create(
                this.product)).reward = this.reward, void e.buy(function (e) {
                    e && (cleverapps.eventLogger.logEvent(s), t())
                });
            cleverapps.user.spendHard(s, this.price) && t()
        }, Offer.GetRestoreReward = function (e) {
            var t, s, i, n, o, e = cleverapps.offerManager.findOffer({
                product: e.key
            });
            if (e) return t = cleverapps.clone(e.reward, !0), t.unit && (s = cleverapps.missionManager.findByType(e.mission), i = Game.currentGame && Game.currentGame.level, n = [], o = [], cleverapps.toArray(t.unit).forEach(function (e) {
                i && i.families[e.code] ? n.push(e) : s && o.push(e)
            }), s && o.length && new Pocket(s.slot).addUnits(o), delete t.unit, n.length && (t.unit = n)), Object.keys(t).length ? t : void 0
        }, Offer.OnRestoreSuccess = function (e) {
            e = cleverapps.offerManager.findOffer({
                product: e.key
            });
            e && cleverapps.offerManager.refreshOffer(e.type)
        }, function () {
            this.offers = {}, cleverapps.flags.on("change:videoAdsMainMonetization", this.refreshProductOffers.bind(this))
        }),
        MissionOfferWindow = (OfferManager.prototype.initialize = function () {
            this.inited = !0, this.refreshAll()
        },
            OfferManager.prototype.refreshAll = function () {
                for (var e in Offers.TYPES) this.refreshOffer(Offers.TYPES[e])
            }, OfferManager.prototype.refreshProductOffers = function () {
                for (var e in Offers.TYPES) {
                    e = Offers.TYPES[e];
                    Offers[e] && Offers[e].product && this.refreshOffer(e)
                }
            }, OfferManager.prototype.refreshOffer = function (e) {
                Offers[e] && (this.isOfferAvailable(e) ? this.offers[e] || this.addOffer(e) : this.offers[e] && this.removeOffer(e))
            }, OfferManager.prototype.refreshByMission = function (e) {
                e = Offers.offerByMission[e] || Offers.offerByMission[Mission.GetChildType(e)];
                e && this.refreshOffer(e.type)
            }, OfferManager.prototype.refreshByHero = function (e) {
                e = Offers.offerByHero[Unit.GetKey(e)];
                e && this.refreshOffer(e.type)
            }, OfferManager.prototype.refreshByFog = function (e) {
                e = Offers.offersByFog[e];
                e && e.forEach(function (e) {
                    this.refreshOffer(e.type)
                }.bind(this))
            }, OfferManager.prototype.clearForceByMission = function (e) {
                Offers.offerByMission[e] && Offers.offerByMission[e].force && cleverapps.forces.clearForce(
                    Offers.offerByMission[e].force.id)
            }, OfferManager.prototype.addOffer = function (e) {
                var t = new Offer(e),
                    e = (this.offers[e] = t, new OfferIcon(t));
                cleverapps.sideBar.addTemporaryIcon(e)
            }, OfferManager.prototype.removeOffer = function (e) {
                delete this.offers[e];
                e = cleverapps.sideBar.findOfferIcon(e);
                e && cleverapps.sideBar.removeTemporaryIcon(e)
            }, OfferManager.prototype.findOffer = function (e) {
                var t, s = e.product,
                    i = void 0 === e.mission ? void 0 : Mission.GetChildType(e.mission);
                for (t in this.offers) {
                    var n = this.offers[t];
                    if ((void 0 === s || s === n.product) && (void 0 === i || i === n.mission || e.mission === n.mission)) return n
                }
            }, OfferManager.prototype.isOfferAvailable = function (e) {
                var t = Offers[e];
                if (!this.inited || !t) return !1;
                if (t.mission) {
                    var s = cleverapps.missionManager.findByType(t.mission);
                    if (!s || s.isCompleted()) return !1
                }
                if (t.debugMode && !cleverapps.config.debugMode) return !1;
                if (t.hero && cleverapps.unitsLibrary.isOpened(t.hero)) return !1;
                if (t.product && (!cleverapps.payments.isProductExists(t.product) || cleverapps.flags.videoAdsMainMonetization)) return !1;
                if (Missions[t.mission].id && cleverapps.travelBook.getCurrentPage().id !== Missions[t.mission].id) return !1;
                s = Game.currentGame;
                if (t.fog && (!s || !s.fogs || !s.fogs.isOpened(t.fog))) return !1;
                if (t.cooldown) {
                    s = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.OFFER_PURCHASE_TIME + e) || 0;
                    if (Date.now() <= s + cleverapps.parseInterval(t.cooldown)) return !1
                }
                return !0
            }, Window.extend({
                ctor: function (e) {
                    this.offerType = e.type, this._super.apply(this, arguments)
                },
                onWindowLoaded: function (e) {
                    this.offer = e, this.bundle = bundles[e.bundle];
                    var t = cleverapps.styles.MissionOfferWindow[this.offerType],
                        s = (this.withCustomTitle = -1 === [Offers.TYPES.KRAKENFEAST, Offers.TYPES.BUILDPASS, Offers.TYPES.SALEPASS, Offers.TYPES.DRAGONIA, Offers.TYPES.DRAGONIA2, Offers.TYPES.DRAGONIA3, Offers.TYPES.UNDERSEA, Offers.TYPES.UNDERSEA2, Offers.TYPES.SNAILFEAST, Offers.TYPES.SNAILFEAST_DRAGONIA2, Offers.TYPES.SNAILFEAST_DRAGONIA3, Offers.TYPES.HALLOWEEN, Offers.TYPES.RAPUNZEL, Offers.TYPES.RAPUNZEL2,
                        Offers.TYPES.XMAS, Offers.TYPES.EASTER, Offers.TYPES.PERIODIC_PACK, Offers.TYPES.CHINA
                        ].indexOf(this.offer.type), "tropical" === cleverapps.config.ui && -1 !== [Offers.TYPES.LIVESFEAST, Offers.TYPES.SOFTFEAST].indexOf(this.offer.type) && (this.withCustomTitle = !1), cleverapps.missionManager.findRunningMission(e.mission)),
                        s = (s && (s.offerWindowShown = !0), this._super({
                            name: "MissionOfferWindow",
                            content: this.createContent(),
                            noBackground: !0,
                            notCloseByTouchInShadow: !0,
                            closeButtonDelay: !0,
                            title: !this.withCustomTitle && "MissionOfferWindow." + this.offer.name + ".title",
                            openSound: this.bundle.urls.offer_showup_effect
                        }), this.title || this.windowTitle),
                        s = (s.setOpacity(0), s.runAction(new cc.Spawn(new cc.FadeIn(.7), new cc.Sequence(new cc.ScaleTo(.23, 1.1), new cc.ScaleTo(.21, 1)), new cc.Sequence(new cc.MoveBy(.23, 0, t.title.offsetY), new cc.MoveBy(.21, 0, -t.title.offsetY)))), ["MenuBarCoinsItem", "MenuBarLivesItem"]),
                        t = ["MenuBarGoldItem"];
                    e.reward.energy && t.push(s.pop()), cleverapps.meta.showControlsWhileFocused(t),
                        cleverapps.meta.hideControlsWhileFocused(s), this.offer.onBought = this.createListener(this.close.bind(this))
                },
                getPerson: function () {
                    var e = cleverapps.styles.MissionOfferWindow[this.offerType].person;
                    return e = e && (PersonsLibrary.hasRole(e.role) ? e : {
                        role: "worker",
                        emotion: "happy"
                    })
                },
                createContent: function () {
                    var e = cleverapps.styles.MissionOfferWindow[this.offerType],
                        t = this.content = new cc.Node;
                    return t.setAnchorPoint2(), t.setContentSize2(e.width, e.height), this.createOffer(), this.withCustomTitle && this.createTitle(), this.createBuyButton(), this.createFootnote(), this.createBadges(), t
                },
                createTitle: function () {
                    var e = cleverapps.styles.MissionOfferWindow[this.offerType];
                    this.title = cleverapps.UI.generateOnlyText("MissionOfferWindow." + this.offer.name + ".title", e.title.font), this.title.setPositionRound(e.title), this.title.fitTo(e.title.width), this.content.addChild(this.title, 1)
                },
                createOffer: function () {
                    var t, s = cleverapps.styles.MissionOfferWindow[this.offerType],
                        e = new cleverapps.Spine(
                            this.bundle.jsons.offer_json);
                    for (t in this.offerType === Offers.TYPES.KRAKENFEAST && "mergecraft" === cleverapps.config.name && e.setSkin("0"), e.setAnimationAndIdleAfter("open", "idle"), e.setPositionRound(s.offer), this.content.addChild(e), this.offer.reward) "unit" === t && s.rewards[t] ? this.offer.reward[t].forEach(function (e) {
                        s.rewards[t][e.code] && this.createReward(t, e)
                    }, this) : this.createReward(t, this.offer.reward[t])
                },
                createReward: function (e, t) {
                    var s = cleverapps.styles.MissionOfferWindow[this.offerType],
                        i = s.rewards[e];
                    i && ("worker" === e && (t = t.title), "unit" === e && (i = i[t.code], t = t.pointsValue || t.amount || 1), t = "number" == typeof t ? "x" + t : t, Messages.has("MissionOfferWindow." + this.offer.name + ".reward." + e) && (t = Messages.get("MissionOfferWindow." + this.offer.name + ".reward." + e)), (e = cleverapps.UI.ImageFont.IsApplicable(s.rewards.font, t) ? cleverapps.UI.generateImageText(t, s.rewards.font) : cleverapps.UI.generateOnlyText(t, s.rewards.font)).setPositionRound(i), e.fitTo(i.width), e.setRotation(i.rotation),
                        this.content.addChild(e), i.delay && (e.setOpacity(0), e.runAction(new cc.Sequence(new cc.DelayTime(i.delay), new cc.FadeIn(.5)))))
                },
                createBuyButton: function () {
                    var e = cleverapps.styles.MissionOfferWindow[this.offerType],
                        t = new cleverapps.UI.Button({
                            text: this.offer.getPriceText(),
                            width: e.button.width,
                            height: e.button.height,
                            onClicked: this.offer.buy.bind(this.offer)
                        });
                    t.performRecursive(function (e) {
                        e.setCascadeOpacityEnabled(!0)
                    }), t.setOpacity(0), t.setScale(.3), t.runAction(new cc.Sequence(new cc.DelayTime(.4), new cc.Spawn(new cc.FadeIn(.3), new cc.ScaleTo(.3, 1).easing(cc.easeBackOut())))), this.content.addChild(t), t.setPositionRound(e.button)
                },
                createFootnote: function () {
                    var e, t = "MissionOfferWindow." + this.offer.name + ".footnote";
                    Messages.has(t) && (e = cleverapps.styles.MissionOfferWindow[this.offerType], (t = cleverapps.UI.generateOnlyText(t, cleverapps.styles.FONTS.WHITE_TEXT)).setPositionRound(e.footNote), t.setDimensions(e.footNote.width, 0), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.fitTo(void 0, e.footNote.height), this.content.addChild(t), t.setOpacity(0), t.runAction(new cc.Sequence(new cc.DelayTime(e.footNote.delay), new cc.FadeIn(.7))))
                },
                createBadges: function () {
                    var e = cleverapps.styles.MissionOfferWindow[this.offerType];
                    if (e.badges)
                        for (var t = 0; t < e.badges.length; t++) {
                            var s = e.badges[t],
                                i = new TileBadge({
                                    text: "MissionOfferWindow." + this.offer.name + ".badge" + (t + 1),
                                    rotation: s.rotation,
                                    largeFont: s.largeFont
                                });
                            i.setPositionRound(s), this.content.addChild(i)
                        }
                },
                chooseAnimation: function () { },
                listBundles: function (e) {
                    return [e.bundle]
                }
            })),
        AppTracking = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            MISSION_OFFER_ENERGY_TITLE: {
                size: 75,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.BROWN_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            MISSION_OFFER_DESCRIPTION: {
                size: 35,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            MISSION_OFFER_SOFT_TITLE: {
                size: 115,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.BROWN_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            MISSION_OFFER_REWARD: {
                name: "default",
                size: 80,
                color: cleverapps.styles.COLORS.COLOR_BROWN_2,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            MISSION_OFFER_REWARD2: {
                name: "default",
                size: 80,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            MISSION_OFFER_SALE_REWARD: {
                name: "default",
                size: 72,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            MISSION_OFFER_BADGE: {
                name: "default",
                size: 40,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.styles.MissionOfferWindowTemplate = {
            width: 800,
            height: 840,
            title: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 570
                },
                width: 480,
                offsetY: 23,
                font: cleverapps.styles.FONTS.WINDOW_TITLE_TEXT,
                background: {
                    x: {
                        align: "center",
                        dx: 10
                    },
                    y: {
                        align: "top",
                        dy: 120
                    },
                    scale: 1.3
                }
            },
            offer: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            rewards: {
                font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD
            },
            button: {
                width: 300,
                height: 125,
                x: {
                    align: "center",
                    dx: -5
                },
                y: {
                    align: "bottom",
                    dy: -50
                }
            },
            footNote: {
                delay: 2.5,
                width: 920,
                height: 85,
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -170
                }
            }
        }, cleverapps.styles.MissionOfferWindow = {}, cleverapps.styles.MissionOfferWindow[Offers.TYPES.LIVESFEAST] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
            width: 1400,
            title: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 325
                },
                width: 600,
                font: cleverapps.styles.FONTS.MISSION_OFFER_ENERGY_TITLE,
                background: void 0
            },
            person: {
                role: "seller",
                emotion: "idle"
            },
            rewards: {
                energy: {
                    x: {
                        align: "center",
                        dx: -535
                    },
                    y: {
                        align: "center",
                        dy: -195
                    },
                    width: 170,
                    rotation: -5
                },
                worker: {
                    x: {
                        align: "center",
                        dx: 535
                    },
                    y: {
                        align: "center",
                        dy: -195
                    },
                    width: 170,
                    rotation: 5
                }
            }
        }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.SOFTFEAST] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
            width: 1400,
            title: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 325
                },
                width: 600,
                font: cleverapps.styles.FONTS.MISSION_OFFER_SOFT_TITLE,
                background: void 0
            },
            person: {
                role: "seller",
                emotion: "idle"
            },
            rewards: {
                energy: {
                    x: {
                        align: "center",
                        dx: -535
                    },
                    y: {
                        align: "center",
                        dy: -195
                    },
                    width: 170,
                    rotation: -5
                },
                soft: {
                    x: {
                        align: "center",
                        dx: 535
                    },
                    y: {
                        align: "center",
                        dy: -195
                    },
                    width: 170,
                    rotation: 5
                }
            },
            button: {
                x: {
                    align: "center",
                    dx: -5
                },
                y: {
                    align: "bottom",
                    dy: -95
                }
            }
        }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.KRAKENFEAST] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
            height: 740,
            button: {
                y: {
                    align: "bottom",
                    dy: -25
                }
            },
            footNote: {
                y: {
                    align: "bottom",
                    dy: -140
                }
            }
        }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.BUILDPASS] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
            badges: [{
                x: {
                    align: "left",
                    dx: 66
                },
                y: {
                    align: "top",
                    dy: -11
                },
                width: 125,
                rotation: 10
            }]
        }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.SALEPASS] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
            offer: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 210
                }
            },
            badges: [{
                x: {
                    align: "right",
                    dx: -22
                },
                y: {
                    align: "top",
                    dy: -58
                },
                width: 125,
                rotation: 10
            }],
            rewards: {
                font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                unit: {
                    bppointscrystal: {
                        x: {
                            align: "center",
                            dx: -284
                        },
                        y: {
                            align: "center",
                            dy: -262
                        },
                        width: 250,
                        font: cleverapps.styles.FONTS.MISSION_OFFER_SALE_REWARD,
                        rotation: 0
                    }
                },
                soft: {
                    x: {
                        align: "center",
                        dx: 273
                    },
                    y: {
                        align: "center",
                        dy: -262
                    },
                    width: 250,
                    font: cleverapps.styles.FONTS.MISSION_OFFER_SALE_REWARD,
                    rotation: 0
                }
            },
            person: {
                role: "hunter",
                emotion: "happy"
            },
            button: {
                x: {
                    align: "center",
                    dx: -9
                },
                y: {
                    align: "bottom",
                    dy: -60
                }
            }
        }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.DRAGONIA] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
            button: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -40
                }
            },
            badges: [{
                x: {
                    align: "center",
                    dx: 613
                },
                y: {
                    align: "center",
                    dy: -250
                },
                width: 125
            }],
            rewards: {
                font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                unit: {
                    dragonpack: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: -440
                        },
                        y: {
                            align: "center",
                            dy: -370
                        },
                        width: 240,
                        rotation: 4
                    }
                },
                hard: {
                    delay: .8,
                    x: {
                        align: "center",
                        dx: 440
                    },
                    y: {
                        align: "center",
                        dy: -350
                    },
                    width: 240,
                    rotation: -2
                }
            }
        }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.DRAGONIA2] = cleverapps.styles.MissionOfferWindow[Offers.TYPES.DRAGONIA3] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
            button: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -40
                }
            },
            badges: [{
                x: {
                    align: "center",
                    dx: 613
                },
                y: {
                    align: "center",
                    dy: -250
                },
                width: 125
            }],
            rewards: {
                font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                unit: {
                    dr2dragonpack: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: -440
                        },
                        y: {
                            align: "center",
                            dy: -370
                        },
                        width: 240,
                        rotation: 4
                    }
                },
                hard: {
                    delay: .8,
                    x: {
                        align: "center",
                        dx: 440
                    },
                    y: {
                        align: "center",
                        dy: -350
                    },
                    width: 240,
                    rotation: -2
                }
            }
        }, !0),
            cleverapps.styles.MissionOfferWindow[Offers.TYPES.UNDERSEA] = cleverapps.styles.MissionOfferWindow[Offers.TYPES.UNDERSEA2] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                width: 1600,
                button: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -30
                    }
                },
                badges: !1,
                offer: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 100
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    unit: {
                        underseapack: {
                            delay: .8,
                            x: {
                                align: "center",
                                dx: -625
                            },
                            y: {
                                align: "center",
                                dy: -315
                            },
                            width: 240,
                            rotation: 0
                        },
                        sea2pack: {
                            delay: .8,
                            x: {
                                align: "center",
                                dx: -625
                            },
                            y: {
                                align: "center",
                                dy: -315
                            },
                            width: 240,
                            rotation: 0
                        }
                    },
                    hard: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: 673
                        },
                        y: {
                            align: "center",
                            dy: -315
                        },
                        width: 240,
                        rotation: 0
                    }
                }
            }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.SNAILFEAST] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                width: 1600,
                button: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom",
                        dy: -50
                    }
                },
                badges: !1,
                person: {
                    role: "capitannemo"
                },
                offer: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 5
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    unit: {
                        seasnailhouse: {
                            delay: .8,
                            x: {
                                align: "center"
                            },
                            y: {
                                align: "center",
                                dy: -325
                            },
                            width: 240,
                            rotation: 0
                        }
                    }
                },
                footNote: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: -48
                    },
                    height: 90
                }
            }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.SNAILFEAST_DRAGONIA2] = cleverapps.styles.MissionOfferWindow[Offers.TYPES.SNAILFEAST_DRAGONIA3] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                width: 1600,
                button: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom",
                        dy: -50
                    }
                },
                badges: !1,
                person: {
                    role: "hero"
                },
                offer: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 5
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    unit: {
                        drsnailhouse: {
                            delay: .8,
                            x: {
                                align: "center"
                            },
                            y: {
                                align: "center",
                                dy: -325
                            },
                            width: 240,
                            rotation: 0
                        }
                    }
                },
                footNote: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: -48
                    },
                    height: 90
                }
            }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.HALLOWEEN] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                width: 1650,
                offer: {
                    y: {
                        align: "center",
                        dy: 2
                    }
                },
                button: {
                    x: {
                        align: "center",
                        dx: -197
                    },
                    y: {
                        align: "bottom",
                        dy: -20
                    }
                },
                title: {
                    y: {
                        align: "center",
                        dy: 460
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    unit: {
                        hlpack: {
                            delay: .8,
                            x: {
                                align: "center",
                                dx: -604
                            },
                            y: {
                                align: "center",
                                dy: -298
                            },
                            width: 240,
                            rotation: 0
                        }
                    },
                    hard: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: 608
                        },
                        y: {
                            align: "center",
                            dy: -298
                        },
                        width: 240,
                        rotation: 0
                    }
                }
            }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.RAPUNZEL] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                width: 1650,
                offer: {
                    y: {
                        align: "center",
                        dy: 25
                    }
                },
                button: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom",
                        dy: -50
                    },
                    height: 115
                },
                title: {
                    y: {
                        align: "center",
                        dy: 460
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    energy: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: -477
                        },
                        y: {
                            align: "center",
                            dy: -365
                        },
                        width: 240,
                        rotation: 0
                    },
                    hard: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: 477
                        },
                        y: {
                            align: "center",
                            dy: -365
                        },
                        width: 240,
                        rotation: 0
                    }
                }
            }, !0),
            cleverapps.styles.MissionOfferWindow[Offers.TYPES.RAPUNZEL2] = cleverapps.styles.MissionOfferWindow[Offers.TYPES.RAPUNZEL], cleverapps.styles.MissionOfferWindow[Offers.TYPES.XMAS] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                width: 1650,
                offer: {
                    y: {
                        align: "center",
                        dy: -70
                    }
                },
                button: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -20
                    }
                },
                title: {
                    y: {
                        align: "center",
                        dy: 460
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    unit: {
                        xmpack: {
                            delay: .8,
                            x: {
                                align: "center",
                                dx: -609
                            },
                            y: {
                                align: "center",
                                dy: -268
                            },
                            width: 240,
                            rotation: 0
                        }
                    },
                    hard: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: 621
                        },
                        y: {
                            align: "center",
                            dy: -268
                        },
                        width: 240,
                        rotation: 0
                    }
                }
            }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.PERIODIC_PACK] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                width: 1650,
                badges: [{
                    x: {
                        align: "right",
                        dx: -324
                    },
                    y: {
                        align: "top",
                        dy: 30
                    },
                    rotation: 15,
                    largeFont: !0
                }],
                button: {
                    x: {
                        align: "center",
                        dx: 60
                    },
                    y: {
                        align: "bottom",
                        dy: -140
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    hard: {
                        x: {
                            align: "center",
                            dx: -228
                        },
                        y: {
                            align: "center",
                            dy: -303
                        },
                        width: 220,
                        rotation: 0
                    },
                    soft: {
                        x: {
                            align: "center",
                            dx: 340
                        },
                        y: {
                            align: "center",
                            dy: -303
                        },
                        width: 220,
                        rotation: 0
                    }
                }
            }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.EASTER] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                width: 1650,
                offer: {
                    y: {
                        align: "center",
                        dy: 25
                    }
                },
                button: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom",
                        dy: -50
                    },
                    height: 115
                },
                title: {
                    y: {
                        align: "center",
                        dy: 460
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    energy: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: -477
                        },
                        y: {
                            align: "center",
                            dy: -365
                        },
                        width: 240,
                        rotation: 0
                    },
                    hard: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: 477
                        },
                        y: {
                            align: "center",
                            dy: -365
                        },
                        width: 240,
                        rotation: 0
                    }
                }
            }, !0), cleverapps.styles.MissionOfferWindow[Offers.TYPES.CHINA] = cleverapps.overrideStyles(cleverapps.styles.MissionOfferWindowTemplate, {
                button: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -40
                    }
                },
                rewards: {
                    font: cleverapps.styles.FONTS.MISSION_OFFER_REWARD2,
                    energy: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: -544
                        },
                        y: {
                            align: "center",
                            dy: -395
                        },
                        width: 240,
                        rotation: 5
                    },
                    hard: {
                        delay: .8,
                        x: {
                            align: "center",
                            dx: 573
                        },
                        y: {
                            align: "center",
                            dy: -372
                        },
                        width: 240,
                        rotation: -2
                    }
                }
            }, !0), cleverapps.Adversting = {
                postbackUnity: function (e) {
                    var t;
                    cleverapps.platform.oneOf(Amazon, AndroidPlatform) && (t = cleverapps.config.android.unityGameId, t = "https://postback.unityads.unity3d.com/games/" + (t = cleverapps.platform.oneOf(IOS) ? cleverapps.config.ios.unityGameId : t) + "/install?advertisingTrackingId=" + e, cleverapps.RestClient.get(t, {}, function () { }))
                },
                getInstallReferrer: function () {
                    cleverapps.platform.oneOf(AndroidPlatform, Amazon) && cleverapps.platform.callNative("AdverstingPlugin.getInstallReferrer", function (e, t) {
                        t = t && t.referrerUrl;
                        t && -1 !== t.indexOf("&") && t.split("&").forEach(function (e) {
                            var t, s; - 1 !== e.indexOf("utm_campaign") ? (t = e.split("=")[1], console.log("channel extracted " + t), cleverapps.user.setChannel(t)) : -1 !== e.indexOf("utm_content") && (s = e.split("=")[1], console.log("Encrytped Referrer Data " + s),
                                "mergecraft" === cleverapps.config.name && cleverapps.RestClient.post("/users/decodereferrer", {
                                    content: s
                                }, function (e) {
                                    e.channel ? cleverapps.user.setChannel(e.channel) : console.log("Failed decode referrer: " + s)
                                }))
                        })
                    })
                }
            },
            function () {
                cleverapps.platform.nativeEventListeners.AppTracking = this.onNativeEvent.bind(this)
            }),
        GoogleAnalyticsManager = (AppTracking.prototype.askPermission = function (s) {
            AppTracking.isApplicable() ? cleverapps.platform.callNative("AppTrackingPlugin.askPermissions", function (e, t) {
                t = t.value;
                console.log("AppTracking setStatus " + typeof t + " - " + t), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.APP_TRACKING + t), s()
            }) : s()
        }, AppTracking.prototype.onNativeEvent = function (e) {
            console.log("AppTracking.onNativeEvent - " + e), "inactiveState" === e && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.APP_TRACKING + "inactive")
        }, AppTracking.isApplicable = function () {
            return cleverapps.platform.oneOf(Apple)
        }, AppTracking.PERMISSIONS = {
            NOT_DETERMINED: 0,
            RESTRICTED: 1,
            DENIED: 2,
            AUTHORIZED: 3
        },
            cleverapps.Adjust = function () {
                this.settings = cleverapps.config.adjust, this.eventsConfig = cleverapps.Adjust.EVENTS_BY_PROJECTS[cleverapps.config.name + "_" + cleverapps.platform.source] || cleverapps.Adjust.EVENTS_BY_PROJECTS[cleverapps.config.name] || {}
            }, cleverapps.Adjust.IS_AVAILABLE = function () {
                return cleverapps.platform.oneOf(AndroidPlatform, Amazon, IOS, Microsoft) && cleverapps.config.adjust
            }, cleverapps.Adjust.prototype.logPurchase = function (e, t, s) {
                this.settings.purchaseToken && cleverapps.platform.callNative("AdjustPlugin.logPurchase", {
                    eventToken: this.settings.purchaseToken,
                    transactionID: e,
                    amount: t,
                    currency: s
                })
            }, cleverapps.Adjust.prototype.logEvent = function (e) {
                e = this.eventsConfig[e];
                e && cleverapps.platform.callNative("AdjustPlugin.logEvent", {
                    eventToken: e
                })
            }, cleverapps.Adjust.prototype.logAdRevenue = function (e, t) {
                cleverapps.platform.callNative("AdjustPlugin.logAdRevenue", {
                    revenue: e,
                    source: t || "AdMobAds"
                })
            }, cleverapps.Adjust.EVENTS_BY_PROJECTS = {
                mergecraft: {
                    day_1_watched_15_ads: "jbccgp",
                    day_1_ads_count: "6xw1qz",
                    day_1_ads_value: "kid7ic",
                    base_watch_5: "u22jkd",
                    base_reach_5: "6470zz",
                    base_reach_6: "upyoby",
                    base_reach_7: "wch8v0",
                    base_reach_8: "97cixp",
                    base_reach_10: "z14ntv",
                    base_reach_15: "ezxyfw",
                    base_reach_20: "1ir1u1",
                    base_reach_25: "1xdrb6",
                    base_reach_30: "abl702",
                    base_reach_35: "irqus4",
                    base_reach_40: "p3r40w",
                    base_reach_45: "piecy9",
                    base_reach_50: "t42txk",
                    base_reach_60: "dhj4c6",
                    base_reach_70: "lkx6h2",
                    base_reach_80: "a36r2c",
                    base_reach_90: "l1mdo9",
                    base_reach_100: "fl6p6g",
                    base_play_watch: "iqx5xq",
                    ret1: "mbhq11",
                    ret2: "rwcfsk",
                    ret3: "snngl1",
                    ad_start: "1t7xx4",
                    watched5: "dct97c",
                    watched10: "n7ogon",
                    watched20: "xxuejp",
                    watched30: "nucbks"
                },
                mergecraft_amazon: {
                    day_1_watched_15_ads: "t78aq9",
                    day_1_ads_count: "yxvwzo",
                    day_1_ads_value: "yxvwzo",
                    base_watch_5: "dw2scx",
                    base_reach_5: "gfq0ra",
                    base_reach_6: "5oktsr",
                    base_reach_7: "91qkri",
                    base_reach_8: "bl7nxj",
                    base_reach_10: "j5fd5d",
                    base_reach_15: "dl02xp",
                    base_reach_20: "a9ig09",
                    base_reach_25: "nv47wu",
                    base_reach_30: "t3o08m",
                    base_reach_35: "edxgho",
                    base_reach_40: "la8vgi",
                    base_reach_45: "bdhvz2",
                    base_reach_50: "av0eyu",
                    base_reach_60: "pj54xe",
                    base_reach_70: "a6a2qq",
                    base_reach_80: "dyg4pv",
                    base_reach_90: "wnghr9",
                    base_reach_100: "plu5in",
                    base_play_watch: "vrsz17",
                    ret1: "hy3og3",
                    ret2: "x24une",
                    ret3: "dd2acx",
                    ad_start: "ema6q7",
                    watched5: "e1b7j9",
                    watched10: "3ojfl7",
                    watched20: "1s4gw6",
                    watched30: "o6gvsz"
                },
                wondermerge: {
                    day_1_watched_15_ads: "htv2jn",
                    day_1_ads_count: "wm0y8e",
                    day_1_ads_value: "n1d7vq",
                    base_watch_5: "9pf10s",
                    base_reach_5: "vvln22",
                    base_reach_6: "o6f6c2",
                    base_reach_7: "br2kco",
                    base_reach_8: "1jcqup",
                    base_play_watch: "495gx2",
                    ret1: "q6i4qx",
                    ret2: "mqrqsj",
                    ret3: "oq441s",
                    ad_start: "kqjc7n",
                    watched5: "za3dv7",
                    watched10: "o2ob86",
                    watched20: "93dpd6",
                    watched30: "vq5ntb"
                },
                wondermerge_amazon: {
                    day_1_watched_15_ads: "j4l46h",
                    day_1_ads_count: "htw8p9",
                    day_1_ads_value: "vv9j8k",
                    base_watch_5: "hirymi",
                    base_reach_5: "de7zzx",
                    base_reach_6: "gvqmgi",
                    base_reach_7: "t6dvno",
                    base_reach_8: "s7zgqc",
                    base_reach_10: "3skc8h",
                    base_reach_15: "cjnerg",
                    base_reach_20: "wppjs6",
                    base_reach_25: "ymv5mq",
                    base_reach_30: "aglrnj",
                    base_play_watch: "qy65f3",
                    ret1: "f1fmip",
                    ret2: "4a4ydi",
                    ret3: "gaxq5i",
                    ad_start: "usikgx",
                    watched5: "8tgmcb",
                    watched10: "g3lnov",
                    watched20: "b4rup8",
                    watched30: "z78zix"
                },
                tripeaks: {
                    day_1_watched_15_ads: "xu2pww",
                    day_1_ads_count: "l4uq69",
                    day_1_ads_value: "iiind3",
                    base_watch_5: "gtw326",
                    base_reach_5: "9fzsep",
                    base_reach_6: "un4m72",
                    base_reach_7: "ndo50w",
                    base_reach_8: "m1lggx",
                    base_play_watch: "n5v7ur",
                    ret1: "f5a3kc",
                    ret2: "b08jfl",
                    ret3: "csmp5c",
                    ad_start: "yp7j5w",
                    watched5: "xyw6kg",
                    watched10: "gs4evj",
                    watched20: "ufoucq",
                    watched30: "nvxdqh"
                },
                riddles: {
                    day_1_watched_15_ads: "bp4gic",
                    day_1_ads_count: "jbkg54",
                    day_1_ads_value: "njwxz3",
                    base_watch_5: "6poy4t",
                    base_reach_5: "kyeedj",
                    base_reach_6: "w4c4iw",
                    base_reach_7: "3lvq8m",
                    base_reach_8: "676jeo",
                    base_play_watch: "3za8bl",
                    ret1: "hbpmdx",
                    ret2: "kkpft1",
                    ret3: "p8maz9",
                    ad_start: "jbyjm9",
                    watched5: "y32egy",
                    watched10: "3c629h",
                    watched20: "jij40x",
                    watched30: "k2s6x9"
                },
                riddles_amazon: {
                    day_1_watched_15_ads: "vjnfxe",
                    day_1_ads_count: "kr6niv",
                    day_1_ads_value: "kq4qdb",
                    base_watch_5: "81q5j2",
                    base_reach_5: "mn0tug",
                    base_reach_6: "neep25",
                    base_reach_7: "23mdjd",
                    base_reach_8: "86t38p",
                    base_play_watch: "jdjv97",
                    ret1: "egpjxk",
                    ret2: "s1420b",
                    ret3: "5n9lp5",
                    ad_start: "j82z3x",
                    watched5: "wcaewo",
                    watched10: "lvp0zl",
                    watched20: "xg4lbx",
                    watched30: "q36uww"
                },
                heroes: {
                    day_1_watched_15_ads: "w4pi8k",
                    day_1_ads_count: "e1pr9m",
                    day_1_ads_value: "sh0qzk",
                    base_watch_5: "jesczs",
                    base_reach_5: "ykgs4u",
                    base_reach_6: "wo9lgc",
                    base_reach_7: "e0bcw9",
                    base_reach_8: "m9ktmt",
                    base_play_watch: "d2l0bs",
                    ret1: "fvnst9",
                    ret2: "1ubgy5",
                    ret3: "5oj8ed",
                    ad_start: "23zri0",
                    watched5: "qoiyrl",
                    watched10: "9pp9na",
                    watched20: "fdoo0k",
                    watched30: "up54p9"
                },
                heroes_amazon: {
                    day_1_watched_15_ads: "umx17z",
                    day_1_ads_count: "ch1xib",
                    day_1_ads_value: "z6uj1d",
                    base_watch_5: "ekm4jo",
                    base_reach_5: "kshark",
                    base_reach_6: "1z4f8n",
                    base_reach_7: "vckahk",
                    base_reach_8: "50ggzr",
                    base_play_watch: "w0h8qp",
                    ret1: "gdhvmk",
                    ret2: "hgyiyq",
                    ret3: "1qht0h",
                    ad_start: "2004lk",
                    watched5: "x31rb5",
                    watched10: "6kcjt5",
                    watched20: "se0yoh",
                    watched30: "7da1hh"
                },
                scramble: {
                    day_1_watched_15_ads: "hbjznw",
                    day_1_ads_count: "5795if",
                    day_1_ads_value: "mvalf2",
                    base_watch_5: "roxq3n",
                    base_reach_5: "t1h31j",
                    base_reach_6: "hxcvsu",
                    base_reach_7: "4n71e2",
                    base_reach_8: "4yh8ms",
                    base_play_watch: "8q20g4",
                    ret1: "hzo5xf",
                    ret2: "dl3h35",
                    ret3: "fadgvu",
                    ad_start: "g9t6ci",
                    watched5: "7y3w85",
                    watched10: "36e3gz",
                    watched20: "1nof2d",
                    watched30: "j1t7mn"
                },
                fairy: {
                    day_1_watched_15_ads: "oisl0k",
                    day_1_ads_count: "g2wmie",
                    day_1_ads_value: "1w4nky",
                    base_watch_5: "xg6twq",
                    base_reach_5: "k0kfhu",
                    base_reach_6: "9jw3gk",
                    base_reach_7: "yq3wqv",
                    base_reach_8: "vjlqt0",
                    base_play_watch: "i22f65",
                    ret1: "amnxju",
                    ret2: "8k14k4",
                    ret3: "102weh",
                    ad_start: "wvnqju",
                    watched5: "t287oh",
                    watched10: "pnwj95",
                    watched20: "mzfp7z",
                    watched30: "ldg8f3"
                }
            }, cleverapps.FirebaseManager = {
                run: function () {
                    return cleverapps.flags.nofirebase ? cleverapps.FakeFirebase : cleverapps.platform.oneOf(Amazon, AndroidPlatform, IOS) ? cleverapps.WebViewFirebase : cleverapps.platform.oneOf(CleverApps, MacOS) && cleverapps.config.webFirebase ? cleverapps.WebFirebase : (cc.sys.isNative && console.log("No firebase plugin found!"), cleverapps.FakeFirebase)
                }
            }, cleverapps.WebFirebase = {
                init: function () {
                    cleverapps.loadSdk("//www.gstatic.com/firebasejs/8.9.0/firebase-app.js", {
                        onSuccess: function () {
                            cleverapps.loadSdk("//www.gstatic.com/firebasejs/8.9.0/firebase-analytics.js", {
                                onSuccess: function () {
                                    firebase.initializeApp(cleverapps.config.webFirebase), firebase.analytics()
                                }
                            })
                        }
                    })
                },
                logEvent: function (e, t) {
                    "undefined" != typeof firebase && "function" == typeof firebase.analytics && firebase.analytics().logEvent(e, t)
                },
                setScreenName: function () { }
            }, cleverapps.WebViewFirebase = {
                batch: [],
                sendBatch: cleverapps.accumulate(1e3, function () {
                    var e = cleverapps.WebViewFirebase;
                    0 < e.batch.length && (cleverapps.platform.callNative("FirebasePlugin.sendBatch", {
                        batch: e.batch
                    }), e.batch = [])
                }),
                init: function () {
                    this.batch.push({
                        method: "setUserID",
                        id: cleverapps.platform.getUserID()
                    }), this.sendBatch()
                },
                logEvent: function (e, t) {
                    this.batch.push({
                        method: "logEvent",
                        name: e,
                        data: t
                    }), this.sendBatch()
                },
                setScreenName: function (e, t) {
                    this.batch.push({
                        method: "setScreenName",
                        screen: e,
                        scene: t
                    }), this.sendBatch()
                }
            }, cleverapps.FakeFirebase = {
                init: function () { },
                logEvent: function () { },
                setScreenName: function () { }
            }, {
            run: function () {
                return cleverapps.config.googleAnalytics && cleverapps.platform.oneOf(CleverApps) ? WebGoogleAnalytics : FakeGoogleAnalytics
            }
        }),
        WebGoogleAnalytics = {
            init: function () {
                function e() {
                    !s && 100 <= i.length || i.push(arguments)
                }
                var t = cleverapps.config.googleAnalytics.measurementId,
                    s = (console.log("GoogleAnalytics init"), !1),
                    i = (cleverapps.loadSdk("//www.googletagmanager.com/gtag/js?id=" + t, {
                        onSuccess: function () {
                            s = !0, console.log("GoogleAnalytics init success")
                        }
                    }), window.dataLayer || []),
                    n = (window.dataLayer = i, (window.gtag = e)("js", new Date), {});
                cleverapps.config.debugMode && (n.debug_mode = !0), e("config", t, n), this.updateUserId()
            },
            logEvent: function (e, t) {
                gtag("event", e, t), cleverapps.config.debugMode && console.log("GoogleAnalytics - " + e)
            },
            updateUserId: function () {
                gtag("set", {
                    user_id: cleverapps.platform.getUserID()
                })
            },
            logAdRevenue: function (e, t) {
                this.logEvent("ad_" + e, {
                    value: t,
                    currency: "USD"
                })
            }
        },
        FakeGoogleAnalytics = {
            init: function () { },
            logEvent: function () { },
            updateUserId: function () { },
            logAdRevenue: function () { }
        },
        FakeSender = ((cleverapps = "undefined" == typeof cc ? require("../utils") : cleverapps).LocalPushes = function () {
            this.initSender(), this.load(), this.queue = {}, this.initialized = !1, cleverapps.platform.nativeEventListeners.LocalPushes = this.onNativeEvent.bind(this)
        }, cleverapps.LocalPushes.prototype.processQueue = function () {
            var e, t = this.queue;
            for (e in t) {
                var s = t[e],
                    i = cleverapps.LocalPushes.GetTypeById(e);
                i && this.sendPush(i, s)
            }
            this.queue = {}
        }, cleverapps.LocalPushes.prototype.initialize = function () {
            this.initialized = !0, this.processQueue(), this.onShow(), cleverapps.timeouts.setInterval(this.cancelSoonPushes.bind(this), cleverapps.parseInterval("1 minutes"))
        }, cleverapps.LocalPushes.prototype.onShow = cleverapps.throttle(1e3, function () {
            this.sender && (
                this.cancelSoonPushes(), Object.keys(cleverapps.LocalPushes.TYPES).forEach(function (e) {
                    var t;
                    e.startsWith("LETS_PLAY_") && (t = e.replace("LETS_PLAY_", "") + " days", this.sendPush(cleverapps.LocalPushes.TYPES[e], cleverapps.parseInterval(t)))
                }.bind(this)))
        }), cleverapps.LocalPushes.prototype.initSender = function () {
            for (var e = [MicrosoftSender, MSStartSender, WebViewSender, SocialSender, FakeSender], t = 0; t < e.length; t++)
                if (e[t].isAppropriate()) {
                    this.sender = new e[t];
                    break
                } var s = (cleverapps.LocalPushes.GetSenderBySource(cleverapps.platform.source) || {}).days || 30;
            this.maxTimeout = cleverapps.parseInterval(s + 1 + " days")
        }, cleverapps.LocalPushes.prototype.reset = function () {
            for (var e in this.onShow(), this.data) {
                e = cleverapps.LocalPushes.GetTypeById(e);
                e && this.cancelPush(e)
            }
        }, cleverapps.LocalPushes.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LOCAL_PUSHES) || {};
            this.permitted = e.permitted, delete (e = cleverapps.clone(e)).permitted, this.data = e
        },
            cleverapps.LocalPushes.prototype.save = function () {
                var e = cleverapps.clone(this.data);
                e.permitted = this.permitted, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LOCAL_PUSHES, e)
            }, cleverapps.LocalPushes.prototype.askPermission = function (e) {
                this.sender && this.sender.askPermissions ? this.sender.askPermissions(e) : e()
            }, cleverapps.LocalPushes.prototype.setPermitted = function (e) {
                this.permitted !== e && (this.permitted = e, this.save())
            }, cleverapps.LocalPushes.ONE_MINUTE = cleverapps.parseInterval("1 minute"), cleverapps.LocalPushes.prototype.sendPush = function (e, t) {
                var s, i, n;
                this.sender && (s = e.id, this.initialized ? (this.sender.getId && (s = this.sender.getId(e)), i = this.data[s] ? this.data[s].when : 0, n = (t = t || 0) ? Date.now() + t : 0, Math.abs(i - n) < cleverapps.LocalPushes.ONE_MINUTE || this.maxTimeout <= t || (t < cleverapps.LocalPushes.TIMEOUT_THRESHOLD ? i && this.cancelPush(e) : (this.data[s] = {
                    when: n
                }, this.save(), this.sender.sendPush(e, t)))) : this.queue[s] = t)
            }, cleverapps.LocalPushes.prototype.cancelPush = function (e) {
                var t;
                this.sender && (
                    t = e.id, delete this.queue[t], this.sender.getId && (t = this.sender.getId(e)), this.data[t] && (this.data[t].when && (this.data[t].when > Date.now() ? this.sender.cancelPush(e) : this.logSendEvent(e)), delete this.data[t], this.save()))
            }, cleverapps.LocalPushes.prototype.cancelSoonPushes = function () {
                for (var e in this.data) this.data[e].when - Date.now() <= cleverapps.LocalPushes.TIMEOUT_THRESHOLD && ((e = cleverapps.LocalPushes.GetTypeById(e)) && this.cancelPush(e))
            }, cleverapps.LocalPushes.prototype.logSendEvent = function (e) {
                !cleverapps.platform.oneOf(AndroidBase, Apple, MSStart) || (e = e && e.code) && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PUSHES.SEND + e)
            }, cleverapps.LocalPushes.prototype.onNativeEvent = function (e, t) {
                console.log("LocalPushes.onNativeEvent - " + e), "clickEvent" === e && this.logClickEvent(t.code)
            }, cleverapps.LocalPushes.prototype.logClickEvent = function (e, t) {
                var s;
                console.log("LocalPushes.logClickEvent " + e), cleverapps.eventLogger.logEvent((t || cleverapps.EVENTS.STATS.PUSHES.CLICK) + e),
                    cleverapps.config.debugMode && (s = "Source Push: ", t === cleverapps.EVENTS.STATS.PUSHES.CLICK_ANDROID && (s = "Android_OK. " + s), cleverapps.timeouts.setTimeout(function () {
                        cleverapps.notification.create(s + e)
                    }, 5e3))
            }, cleverapps.LocalPushes.GetPushData = function (e) {
                var t = Messages.get(e.message),
                    e = Messages.get(e.title, {
                        gameTitle: Messages.get(cleverapps.config.title)
                    }),
                    s = (Array.isArray(t) || (t = [t]), Array.isArray(e) || (e = [e]), cleverapps.Random.random(0, t.length - 1));
                return {
                    text: t[s],
                    title: e[s] || cleverapps.Random.mathChoose(e),
                    index: s
                }
            }, cleverapps.LocalPushes.TYPES = {
                BONUS_ROUND: {
                    id: 2,
                    title: "LocalPushes.BONUS_ROUND.Title",
                    message: "LocalPushes.BONUS_ROUND"
                },
                LIVES: {
                    id: 3,
                    title: "LocalPushes.LIVES.Title",
                    message: "LocalPushes.LIVES"
                },
                MINI_GAME: {
                    id: 4,
                    title: "LocalPushes.MINI_GAME.Title",
                    message: "LocalPushes.MINI_GAME"
                },
                LETS_PLAY_1: 5,
                FREE_CHEST: {
                    id: 6,
                    title: "LocalPushes.FREE_CHEST.Title",
                    message: "LocalPushes.FREE_CHEST"
                },
                ENERGY_LOTTERY: {
                    id: 7,
                    title: "LocalPushes.LIVES_LOTTERY.Title",
                    message: "LocalPushes.LIVES_LOTTERY"
                },
                FRUIT_RIPE: {
                    id: 8,
                    title: "LocalPushes.FRUIT_RIPE.Title",
                    message: "LocalPushes.FRUIT_RIPE"
                },
                CASTLE_PRIZE: {
                    id: 9,
                    title: "LocalPushes.CASTLE_PRIZE.Title",
                    message: "LocalPushes.CASTLE_PRIZE"
                },
                ORDER_READY: {
                    id: 10,
                    title: "LocalPushes.ORDER_READY.Title",
                    message: "LocalPushes.ORDER_READY"
                },
                TREE_CHOPPED: {
                    id: 11,
                    title: "LocalPushes.TREE_CHOPPED.Title",
                    message: "LocalPushes.TREE_CHOPPED"
                },
                BUILDING_BUILT: {
                    id: 12,
                    title: "LocalPushes.BUILDING_BUILT.Title",
                    message: "LocalPushes.BUILDING_BUILT"
                },
                MAGIC_PLANT_READY: {
                    id: 13,
                    title: "LocalPushes.MAGIC_PLANT_READY.Title",
                    message: "LocalPushes.MAGIC_PLANT_READY"
                },
                MINI_GAME_PRIZE: {
                    id: 14,
                    title: "LocalPushes.MINI_GAME_PRIZE.Title",
                    message: "LocalPushes.MINI_GAME_PRIZE"
                },
                DAILY_TASKS_UNCOMPLETED: {
                    id: 15,
                    title: "LocalPushes.DAILY_TASKS_UNCOMPLETED.Title",
                    message: "LocalPushes.DAILY_TASKS_UNCOMPLETED"
                },
                PASS_UNCOMPLETED: {
                    id: 16,
                    title: "LocalPushes.PASS_UNCOMPLETED.Title",
                    message: "LocalPushes.PASS_UNCOMPLETED"
                },
                PUMPKIN_RIPE: {
                    id: 17,
                    title: "LocalPushes.PUMPKIN_RIPE.Title",
                    message: "LocalPushes.PUMPKIN_RIPE"
                },
                UNITLOCK_OPEN: {
                    id: 18,
                    title: "LocalPushes.UNITLOCK_OPEN.Title",
                    message: "LocalPushes.UNITLOCK_OPEN"
                },
                EXPEDITION: {
                    id: 19,
                    title: "LocalPushes.EXPEDITION.Title",
                    message: "LocalPushes.EXPEDITION"
                },
                EXPEDITION_TREE_CHOPPED: {
                    id: 20,
                    title: "LocalPushes.EXPEDITION_TREE_CHOPPED.Title",
                    message: "LocalPushes.EXPEDITION_TREE_CHOPPED"
                },
                EXPEDITION_PERIODIC: {
                    id: 21,
                    title: "LocalPushes.EXPEDITION_PERIODIC.Title",
                    message: "LocalPushes.EXPEDITION_PERIODIC"
                },
                LETS_PLAY_2: 22,
                LETS_PLAY_3: 23,
                LETS_PLAY_4: 24,
                LETS_PLAY_5: 25
            },
            function () {
                for (var e in Object.keys(cleverapps.LocalPushes.TYPES).forEach(function (e) {
                    var t;
                    e.startsWith("LETS_PLAY_") && (t = cleverapps.LocalPushes.TYPES[e], cleverapps.LocalPushes.TYPES[e] = {
                        id: t,
                        title: "LocalPushes.LETS_PLAY.Title",
                        message: "LocalPushes.LETS_PLAY"
                    })
                }), cleverapps.LocalPushes.TypesById = {}, cleverapps.LocalPushes.TYPES) {
                    var t = cleverapps.LocalPushes.TYPES[e];
                    t.code = e.toLowerCase(), cleverapps.LocalPushes.TypesById[t.id] = t
                }
            }(),
            cleverapps.LocalPushes.GetTypeById = function (e) {
                return cleverapps.LocalPushes.TypesById[e]
            }, cleverapps.LocalPushes.GetTypeByCode = function (e) {
                return e && e.toUpperCase && cleverapps.LocalPushes.TYPES[e.toUpperCase()]
            }, cleverapps.LocalPushes.TIMEOUT_THRESHOLD = cleverapps.parseInterval("3 minutes"), cleverapps.config.debugMode && (cleverapps.LocalPushes.TIMEOUT_THRESHOLD = cleverapps.parseInterval("10 seconds")), "undefined" == typeof cc && (module.exports = cleverapps), (cleverapps = "undefined" == typeof cc ? require("./localpushes") : cleverapps).LocalPushes.SENDERS = {
                fb: {
                    sources: ["facebook"],
                    mass: 1e4,
                    days: 10,
                    rate: {
                        playReset: !0,
                        limit: 5,
                        interval: cleverapps.parseInterval("10 days")
                    }
                },
                mw: {
                    sources: ["web_mm", "mobile_mm"],
                    mass: 1e4,
                    rate: {
                        limit: 1,
                        interval: cleverapps.parseInterval("3 days")
                    }
                },
                ok: {
                    sources: ["web_ok", "mobile_ok"],
                    length: 100,
                    days: 14,
                    rate: {
                        limit: 5,
                        interval: cleverapps.parseInterval("1 day")
                    }
                },
                vk: {
                    sources: ["web_vk", "mobile_vk"],
                    mass: 1e5,
                    rate: {
                        limit: 1,
                        interval: cleverapps.parseInterval("8 hours")
                    }
                },
                ya: {
                    sources: [
                        "yandex"
                    ]
                },
                in: {
                    sources: ["instant"],
                    mass: 1e5,
                    days: 10,
                    rate: {
                        playReset: !0,
                        limit: 5,
                        interval: cleverapps.parseInterval("10 days")
                    }
                },
                mb: {
                    sources: ["mbga", "sp_mbga"],
                    mass: 1e4
                },
                kg: {
                    sources: ["kongregate"]
                }
            },
            function () {
                for (var e in cleverapps.LocalPushes.SENDERS) {
                    var t = cleverapps.LocalPushes.SENDERS[e];
                    t.code = e, t.days = t.days || 30
                }
            }(), cleverapps.LocalPushes.GetSenderBySource = function (e) {
                for (var t in cleverapps.LocalPushes.SENDERS) {
                    t = cleverapps.LocalPushes.SENDERS[t];
                    if (t.sources.includes(e)) return t
                }
            }, cleverapps.LocalPushes.GetPushUserId = function (e, t) {
                t = cleverapps.LocalPushes.GetSenderBySource(t);
                return t ? t.code + "_" + e : e
            }, "undefined" == typeof cc && (module.exports = cleverapps),
            function () { }),
        WebViewSender = (FakeSender.prototype.sendPush = function (e, t) {
            var s;
            cleverapps.config.debugMode && (s = cleverapps.LocalPushes.GetPushData(e), e = e.id, s.text && s.title ? (cleverapps.config.wysiwygMode || cleverapps.notification.create(s.text + " [" + cleverapps.intervalToString(t) + "]", {
                noSound: !0
            }), console.log(
                "FakeSender: scheduled: " + s.text, cleverapps.intervalToString(t))) : cleverapps.throwAsync("empty fake push - " + e))
        }, FakeSender.prototype.cancelPush = function (e) {
            var t;
            cleverapps.config.debugMode && (t = cleverapps.LocalPushes.GetPushData(e), cleverapps.config.wysiwygMode, console.log("FakeSender: removed: " + t.text, e))
        }, FakeSender.isAppropriate = function () {
            return cleverapps.config.debugMode
        }, function () { }),
        SocialSender = (WebViewSender.prototype.sendPush = function (e, t) {
            var s = cleverapps.LocalPushes.GetPushData(e),
                i = e.id,
                n = e.code,
                o = s.title,
                a = s.text;
            a && o ? cleverapps.platform.callNative("LocalPushesPlugin.sendPush", {
                id: i,
                title: o,
                message: a,
                timeout: t,
                code: n
            }) : cleverapps.throwAsync("empty push - " + i + "\ninfo: " + JSON.stringify(e) + "\ndata: " + JSON.stringify(s) + "\nMessages length: " + Messages && Messages.dictionary && Object.keys(Messages.dictionary).length)
        }, WebViewSender.prototype.cancelPush = function (e) {
            cleverapps.platform.callNative("LocalPushesPlugin.cancelPush", {
                id: e.id,
                code: e.code
            })
        },
            WebViewSender.prototype.askPermissions = function (s) {
                cleverapps.platform.callNative("LocalPushesPlugin.askPermissions", function (e, t) {
                    cleverapps.CODE_SUCCEED === e && cleverapps.localPushes.setPermitted(Boolean(t && t.permitted)), s()
                })
            }, WebViewSender.isAppropriate = function () {
                return cleverapps.platform.oneOf(Amazon, AndroidPlatform, Pliega, Rustore, Apple)
            },
            function () {
                this.batch = {}, this.sendBatch = cleverapps.accumulate(cleverapps.parseInterval("10 seconds"), this._sendBatch.bind(this))
            }),
        MicrosoftSender = (SocialSender.prototype._sendBatch = function () {
            var e = cleverapps.RestClient.getBase() + "/" + cleverapps.config.name + "-push/sendBatch",
                t = this.batch,
                s = {
                    userId: cleverapps.LocalPushes.GetPushUserId(cleverapps.platform.getUserID(), cleverapps.platform.source),
                    language: cleverapps.settings.language,
                    batch: t
                };
            this.batch = {}, console.log("Sending batch - ", t), cleverapps.RestClient.post(e, s, function () {
                console.log("Success push", t)
            }, function () {
                console.log("Failure push", t)
            }, {
                fullPath: !0
            })
        },
            SocialSender.prototype.sendPush = function (e, t) {
                cleverapps.platform.haveTmpId() || cleverapps.platform.oneOf(Yandex) && void 0 === cleverapps.YandexPushesMap[cleverapps.config.name][e.code.toUpperCase()] || (this.batch[e.id] = Math.floor(t / 1e3), this.sendBatch())
            }, SocialSender.prototype.cancelPush = function (e) {
                cleverapps.platform.haveTmpId() || (this.batch[e.id] = 0, this.sendBatch())
            }, SocialSender.isAppropriate = function () {
                return cleverapps.platform.oneOf(Yandex) ? cleverapps.YandexPushesMap[cleverapps.config.name] : cleverapps.platform.oneOf(OKPlatform, MobileOK, FacebookCanvas, Instant, Kongregate, Mobage, MyMailRu, MobileMyMailRu, VKPlatform, MobileVk)
            },
            function () { }),
        MSStartSender = (MicrosoftSender.prototype.sendPush = function (e, t) {
            var s = cleverapps.LocalPushes.GetPushData(e),
                i = s.title,
                s = s.text,
                n = e.id;
            s ? cleverapps.platform.callNative("localPushes.send", {
                title: i,
                message: s,
                timeout: t,
                id: "" + n
            }) : cleverapps.throwAsync("empty microsoft push - " + e.code)
        }, MicrosoftSender.prototype.cancelPush = function (e) {
            console.log(
                "Cancel push - " + e.code), cleverapps.platform.callNative("localPushes.cancel", {
                    id: "" + e.id
                })
        }, MicrosoftSender.isAppropriate = function () {
            return cleverapps.platform.oneOf(Microsoft)
        }, function () { }),
        Connectable = (MSStartSender.prototype.sendPush = function (e, t) {
            var s, i, n, o, a;
            cleverapps.platform.isConnected(Platform.PLATFORM) && (t > cleverapps.parseInterval("7 days") || (n = cleverapps.LocalPushes.GetPushData(e), s = cleverapps.config.debugMode && cleverapps.config.msstart && cleverapps.config.msstart.appId || void 0, i = n.title, n = n.text, o = this.getId(e), a = JSON.stringify({
                push_code: e.id
            }), n ? (console.log("Sending push - " + o, {
                gameId: s,
                title: i,
                message: n,
                id: o,
                image: void 0,
                payload: a,
                timeout: Math.round(t / 1e3),
                callToAction: void 0
            }), $msstart.scheduleNotificationAsync({
                gameId: s,
                title: i,
                description: n,
                type: o,
                image: void 0,
                payload: a,
                minDelayInSeconds: Math.round(t / 1e3),
                callToAction: void 0
            }).then(function (e) {
                console.log("MSStartSender - " + e)
            }).catch(function (e) {
                console.log("MSStartSender error - " + JSON.stringify(e))
            })) : cleverapps.throwAsync("empty msstart push - " + e.code)))
        }, MSStartSender.prototype.cancelPush = function () { }, MSStartSender.prototype.getId = function (e) {
            return e && e.id % 16
        }, MSStartSender.isAppropriate = function () {
            return cleverapps.platform.oneOf(MSStart)
        }, (cleverapps = "undefined" == typeof cc ? require("../utils") : cleverapps).YandexPushesMap = {
            mergecraft: {
                BONUS_ROUND: void 0,
                LIVES: void 0,
                MINI_GAME: void 0,
                LETS_PLAY_1: void 0,
                FREE_CHEST: void 0,
                ENERGY_LOTTERY: void 0,
                FRUIT_RIPE: 1,
                CASTLE_PRIZE: void 0,
                ORDER_READY: 3,
                TREE_CHOPPED: void 0,
                BUILDING_BUILT: 5,
                MAGIC_PLANT_READY: void 0,
                MINI_GAME_PRIZE: void 0,
                DAILY_TASKS_UNCOMPLETED: void 0,
                PASS_UNCOMPLETED: void 0,
                PUMPKIN_RIPE: void 0,
                UNITLOCK_OPEN: void 0,
                EXPEDITION: void 0,
                EXPEDITION_TREE_CHOPPED: void 0,
                EXPEDITION_PERIODIC: void 0
            },
            wondermerge_debug: {
                BONUS_ROUND: void 0,
                LIVES: void 0,
                MINI_GAME: void 0,
                LETS_PLAY_1: 8,
                FREE_CHEST: 9,
                ENERGY_LOTTERY: void 0,
                FRUIT_RIPE: 1,
                CASTLE_PRIZE: 2,
                ORDER_READY: 3,
                TREE_CHOPPED: 4,
                BUILDING_BUILT: 5,
                MAGIC_PLANT_READY: 6,
                MINI_GAME_PRIZE: 7,
                DAILY_TASKS_UNCOMPLETED: 10,
                PASS_UNCOMPLETED: 11,
                PUMPKIN_RIPE: 12,
                UNITLOCK_OPEN: 13,
                EXPEDITION: 14,
                EXPEDITION_TREE_CHOPPED: 15,
                EXPEDITION_PERIODIC: 16
            },
            riddles_debug: {
                BONUS_ROUND: void 0,
                LIVES: 1,
                MINI_GAME: 2,
                LETS_PLAY_1: 3,
                FREE_CHEST: void 0,
                ENERGY_LOTTERY: void 0,
                FRUIT_RIPE: void 0,
                CASTLE_PRIZE: void 0,
                ORDER_READY: void 0,
                TREE_CHOPPED: void 0,
                BUILDING_BUILT: void 0,
                MAGIC_PLANT_READY: void 0,
                MINI_GAME_PRIZE: void 0,
                DAILY_TASKS_UNCOMPLETED: 4,
                PASS_UNCOMPLETED: 5,
                PUMPKIN_RIPE: void 0,
                UNITLOCK_OPEN: void 0,
                EXPEDITION: void 0,
                EXPEDITION_TREE_CHOPPED: void 0,
                EXPEDITION_PERIODIC: void 0
            },
            heroes_debug: {
                BONUS_ROUND: void 0,
                LIVES: 1,
                MINI_GAME: 2,
                LETS_PLAY_1: 3,
                FREE_CHEST: void 0,
                ENERGY_LOTTERY: void 0,
                FRUIT_RIPE: void 0,
                CASTLE_PRIZE: void 0,
                ORDER_READY: void 0,
                TREE_CHOPPED: void 0,
                BUILDING_BUILT: void 0,
                MAGIC_PLANT_READY: void 0,
                MINI_GAME_PRIZE: void 0,
                DAILY_TASKS_UNCOMPLETED: 4,
                PASS_UNCOMPLETED: 5,
                PUMPKIN_RIPE: void 0,
                UNITLOCK_OPEN: void 0,
                EXPEDITION: void 0,
                EXPEDITION_TREE_CHOPPED: void 0,
                EXPEDITION_PERIODIC: void 0
            },
            scramble_debug: {
                BONUS_ROUND: 1,
                LIVES: void 0,
                MINI_GAME: 2,
                LETS_PLAY_1: 3,
                FREE_CHEST: void 0,
                ENERGY_LOTTERY: void 0,
                FRUIT_RIPE: void 0,
                CASTLE_PRIZE: void 0,
                ORDER_READY: void 0,
                TREE_CHOPPED: void 0,
                BUILDING_BUILT: void 0,
                MAGIC_PLANT_READY: void 0,
                MINI_GAME_PRIZE: void 0,
                DAILY_TASKS_UNCOMPLETED: 4,
                PASS_UNCOMPLETED: void 0,
                PUMPKIN_RIPE: void 0,
                UNITLOCK_OPEN: void 0,
                EXPEDITION: void 0,
                EXPEDITION_TREE_CHOPPED: void 0,
                EXPEDITION_PERIODIC: void 0
            },
            tripeaks_debug: {
                BONUS_ROUND: void 0,
                LIVES: 1,
                MINI_GAME: 2,
                LETS_PLAY_1: 3,
                FREE_CHEST: void 0,
                ENERGY_LOTTERY: void 0,
                FRUIT_RIPE: void 0,
                CASTLE_PRIZE: void 0,
                ORDER_READY: void 0,
                TREE_CHOPPED: void 0,
                BUILDING_BUILT: void 0,
                MAGIC_PLANT_READY: void 0,
                MINI_GAME_PRIZE: void 0,
                DAILY_TASKS_UNCOMPLETED: 4,
                PASS_UNCOMPLETED: void 0,
                PUMPKIN_RIPE: void 0,
                UNITLOCK_OPEN: void 0,
                EXPEDITION: void 0,
                EXPEDITION_TREE_CHOPPED: void 0,
                EXPEDITION_PERIODIC: void 0
            }
        }, "undefined" == typeof cc && (module.exports = cleverapps.YandexPushesMap), function () {
            cleverapps.EventEmitter.call(this)
        }),
        FriendsCache = (Connectable.prototype = Object.create(
            cleverapps.EventEmitter.prototype), (Connectable.prototype.constructor = Connectable).prototype.connect = function (t) {
                this.connecting || (this.connecting = !0, this._connect(cleverapps.waitNoMore(Platform.WAIT_CONNECT_TIMEOUT, function (e) {
                    this.connecting = !1, t(e)
                }.bind(this))))
            }, Connectable.prototype._connect = function (e) {
                e(Platform.STATUS_CONNECTED)
            }, cleverapps.Social = function () {
                Connectable.call(this)
            }, cleverapps.Social.prototype = Object.create(Connectable.prototype), cleverapps.Social.prototype.constructor = cleverapps.Social, cleverapps.Social.prototype.connect = function (t) {
                this.connecting || (this.connecting = !0, this._connect(cleverapps.waitNoMore(Platform.WAIT_CONNECT_TIMEOUT, function (e) {
                    this.connecting = !1, t(e), console.log("Social.connect, isLoggedIn: " + this.isLoggedIn()), this.isLoggedIn() ? this.onLogin() : (e = cleverapps.platform.getDeviceId()) && cleverapps.platform.setUserID(e)
                }.bind(this))))
            }, cleverapps.Social.prototype.isLoggedIn = function () { }, cleverapps.Social.prototype._getUserID = function () { },
            cleverapps.Social.prototype.getAccessToken = function () { }, cleverapps.Social.prototype.onLogin = function () {
                var e = cleverapps.platform.getUserID(),
                    t = this._getUserID();
                console.log("Social.onLogin", e, t), cleverapps.platform.setUserID(t), cleverapps.platform.trigger("login", {
                    oldId: e,
                    newId: t
                })
            }, cleverapps.Social.prototype.login = function (e) {
                console.log("Social.login"), this._login(function () {
                    this.isLoggedIn() ? (console.log("Social.login success"), this.onLogin(), e(cleverapps.CODE_SUCCEED)) : (console.log("Social.login fail"), e(cleverapps.CODE_FAILED))
                }.bind(this))
            }, cleverapps.Social.prototype._login = function (e) {
                e()
            }, cleverapps.Social.prototype.logout = function () { }, cleverapps.Social.prototype.inviteFriends = function (e, t) {
                cleverapps.platform.isConnected(Platform.SOCIAL) ? this._inviteFriends(e, t) : t(cleverapps.CODE_FAILED)
            }, cleverapps.Social.prototype._inviteFriends = function (e, t) {
                t(cleverapps.CODE_FAILED)
            }, cleverapps.Social.prototype.request = function (e, t) {
                cleverapps.platform.isConnected(Platform.SOCIAL) ? this._request(e, t) : t(cleverapps.CODE_FAILED)
            }, cleverapps.Social.prototype._request = function (e, t) {
                t(cleverapps.CODE_FAILED)
            }, cleverapps.Social.prototype.shareDialog = function (e, t) {
                cleverapps.platform.isConnected(Platform.SOCIAL) ? this._shareDialog(e, t) : t(cleverapps.CODE_FAILED)
            }, cleverapps.Social.prototype._shareDialog = function (e, t) {
                t(cleverapps.CODE_FAILED)
            }, cleverapps.Social.prototype.listFriends = function (e) {
                cleverapps.platform.isConnected(Platform.SOCIAL) ? this._listFriends(e) : e(cleverapps.CODE_FAILED, [])
            }, cleverapps.Social.prototype._listFriends = function (e) {
                e(cleverapps.CODE_SUCCEED, [])
            }, cleverapps.Social.prototype.listInvitableFriends = function (e) {
                cleverapps.platform.isConnected(Platform.SOCIAL) ? this._listInvitableFriends(e) : e(cleverapps.CODE_FAILED, [])
            }, cleverapps.Social.prototype._listInvitableFriends = function (e) {
                e(cleverapps.CODE_SUCCEED, [])
            }, cleverapps.Social.prototype.aboutMe = function (e) {
                cleverapps.platform.isConnected(Platform.SOCIAL) ? this._aboutMe(e) : e({})
            },
            cleverapps.Social.prototype._aboutMe = function (e) {
                this.aboutUser("me", e)
            }, cleverapps.Social.prototype.aboutUser = function (e, t) {
                cleverapps.platform.isConnected(Platform.SOCIAL) ? this._aboutUser(e, t) : t({})
            }, cleverapps.Social.prototype._aboutUser = function () { }, cleverapps.Social.prototype.deleteAllRequests = function () { }, cleverapps.Social.prototype.api = function () { }, cleverapps.Social.prototype.sendActivity = function () { }, cleverapps.Social.prototype.markAchievement = function () { }, cleverapps.Social.prototype.hasPromoGift = function (e) {
                e(!1)
            }, cleverapps.Social.prototype.usePromoGift = function () { }, cleverapps.Social.prepareId = function (e) {
                return "" + e
            }, cleverapps.Social.prototype.checkConnection = function (e, t, s) {
                function i() {
                    e && e()
                }
                if (cleverapps.flags.nologin) i();
                else {
                    if ("object" == typeof t && (s = t, t = function () { }), t = t || function () { }, s = s || {}, !cleverapps.platform.isConnected(Platform.SOCIAL)) return cleverapps.notification.create("SocialManager.Initialization"), void t();
                    (s = Object.assign({}, s)).onSuccess = i, s.onFailure = t, this.isLoggedIn() ? i() : s.withWindow || cleverapps.platform.needWindowForLogin() ? new FbConnectWindow(s) : this.login(i, t)
                }
            }, cleverapps.Social.prototype.sendRequest = function (i, n, o) {
                Array.isArray(i) || (i = [i]), this.checkConnection(function () {
                    this.request({
                        to: i,
                        message: Messages.get(n + ".message"),
                        title: Messages.get(n + ".title")
                    }, function (e) {
                        var t, s;
                        e === cleverapps.CODE_SUCCEED ? (levels.friendSorter.markUsed(i), t = cleverapps.friends.listIds(), 0 < (s = i.filter(function (e) {
                            return -1 !== t.indexOf(e)
                        })).length && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MESSAGE_SENT_FRIEND, {
                            value: s.length
                        }), 0 < i.length - s.length && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MESSAGE_SENT_INVITE, {
                            value: i.length - s.length
                        }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MESSAGE_SENT_PREFIX + n, {
                            value: i.length
                        }), o && o()) : (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MESSAGE_CANCEL_PREFIX + n, {
                            value: i.length
                        }), [cleverapps.CODE_CANCELLED, cleverapps.CODE_CANCELLED_FACEBOOK_DIALOG].includes(e) && (
                            s = cleverapps.EVENTS.MESSAGE_ERROR + "_" + cleverapps.platform.source, "number" == typeof e && (s += "_" + e), cleverapps.eventLogger.logEvent(s)))
                    })
                }.bind(this))
            }, cleverapps.Social.prototype.getCodes = function () {
                return this.getCode().split("-").sort()
            }, cleverapps.Social.prototype.getCode = function () {
                return cleverapps.platform.source
            }, cleverapps.Social.prototype.getName = function () {
                return ""
            }, cleverapps.Social.prototype.waitWindowCallback = function (e) {
                var t = void 0;
                return cleverapps.meta.isFocused() ? t = new WaitWindow : cleverapps.meta.display({
                    focus: "waitWindowCallback",
                    action: function (e) {
                        t = new WaitWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                }),
                    function () {
                        t && t.close(), e.apply(this, arguments)
                    }
            }, cleverapps.Social.prototype.drawBase64 = function (e) {
                var t = document.createElement("canvas");
                return t.height = e.naturalHeight, t.width = e.naturalWidth, t.getContext("2d").drawImage(e, 0, 0), t.toDataURL("image/jpg")
            }, cleverapps.Social.prototype.getBase64Image = function (e, t) {
                var s = this.waitWindowCallback(t);
                cc.loader.load(e,
                    function (e, t) {
                        t = t && Array.isArray(t) && 0 < t.length ? t[0] : void 0;
                        e || void 0 !== t || (e = cleverapps.CODE_FAILED), s(e, e ? void 0 : this.drawBase64(t.getHtmlElementObj()))
                    }.bind(this))
            }, cleverapps.Social.MAX_INVITE_RANDOM_FRIENDS = 10, cleverapps.Social.ACTIVITY = {
                LVL_PASSED: 0,
                DAILY_TASK: 1
            }, cleverapps.Social.ACTIVITIES_CONFIG = {}, cleverapps.Social.ACTIVITIES_CONFIG[cleverapps.Social.ACTIVITY.LVL_PASSED] = {
                probability: .25,
                messages: [{
                    title: "Activity.PassLevel.title",
                    body: "Activity.PassLevel.body1"
                }, {
                    title: "Activity.PassLevel.title",
                    body: "Activity.PassLevel.body2"
                }, {
                    title: "Activity.PassLevel.title",
                    body: "Activity.PassLevel.body3"
                }]
            }, cleverapps.Social.ACTIVITIES_CONFIG[cleverapps.Social.ACTIVITY.DAILY_TASK] = {
                probability: .5,
                messages: [{
                    title: "Activity.DailyTask.title",
                    body: "Activity.DailyTask.body1"
                }, {
                    title: "Activity.DailyTask.title",
                    body: "Activity.DailyTask.body2"
                }]
            }, cleverapps.BaseFB = function () {
                cleverapps.Social.call(this)
            }, cleverapps.BaseFB.prototype = Object.create(cleverapps.Social.prototype),
            cleverapps.BaseFB.prototype.constructor = cleverapps.BaseFB, cleverapps.BaseFB.prototype.pagingLoading = function (s, i, n, e, o) {
                o = o || [], e = e || "", (n = n || 0) >= cleverapps.BaseFB.MAX_PAGE ? i(cleverapps.CODE_SUCCEED, o) : this.api(s + "&limit=100" + e, function (e, t) {
                    e === cleverapps.CODE_SUCCEED ? (t.data && (o = o.concat(t.data)), t.paging && t.paging.cursors && t.paging.next && t.paging.cursors.after ? this.pagingLoading(s, i, n + 1, "&after=" + t.paging.cursors.after, o) : i(cleverapps.CODE_SUCCEED, o)) : o.length ? i(cleverapps.CODE_SUCCEED, o) : i(e, o)
                }.bind(this))
            }, cleverapps.BaseFB.prototype.getShareDialogLink = function (e) {
                return cleverapps.config.deployment + cleverapps.config.restApiURL + "/share/?name=" + encodeURIComponent(e.name) + "&description=" + encodeURIComponent(e.description) + "&picture=" + encodeURIComponent(e.picture)
            }, cleverapps.BaseFB.prototype._listFriends = function (e) {
                this.pagingLoading("/me/friends?fields=first_name,id,picture.type(large)", e)
            }, cleverapps.BaseFB.prototype._listInvitableFriends = function (e) {
                e([])
            },
            cleverapps.BaseFB.prototype._aboutMe = function (e) {
                this.aboutUser("me", e)
            }, cleverapps.BaseFB.prototype._aboutUser = function (s, i, n) {
                var e = "currency,first_name,name,picture.type(large)";
                "me" === s && (e += ",email"), this.api("/" + s + "/?fields=" + e, function (e, t) {
                    e === cleverapps.CODE_SUCCEED ? i(t) : (console.log("Error: " + e), console.log(t), n && n(e, t), 0 <= cleverapps.BaseFB.USERS_BLACK_LIST_ERROR_CODES.indexOf(e) && cleverapps.RestClient.post("/users/blacklist/add/" + s, {
                        code: e,
                        data: t
                    }, function () {
                        console.log("Success add to black list:" + s)
                    }, function () {
                        console.log("Failure add to black list:" + s)
                    }))
                })
            }, cleverapps.BaseFB.prototype.deleteAllRequests = function () {
                this.api("me/apprequests", function (e, t) {
                    if (e === cleverapps.CODE_SUCCEED) {
                        if (t.data)
                            for (var s = 0; s < t.data.length; s++) console.log("START DELETE REQUEST", t.data[s].id), this.api(t.data[s].id, "delete", function (e, t) {
                                console.log("DELETE REQUEST", e, t)
                            })
                    } else console.log("Error: " + e), console.log(t)
                }.bind(this))
            }, cleverapps.BaseFB.MAX_PAGE = 20,
            cleverapps.BaseFB.USERS_BLACK_LIST_ERROR_CODES = [100], cleverapps.BaseFB.PERMISSIONS = "public_profile", cleverapps.SelectSocial = function () {
                console.log("Choosing SelectSocial"), this.socials = {}, cleverapps.Social.call(this)
            }, cleverapps.SelectSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.SelectSocial.prototype.constructor = cleverapps.SelectSocial, cleverapps.SelectSocial.prototype._connect = function (i) {
                this.createSocials();
                var e = Object.keys(this.socials).map(function (s) {
                    return function (e) {
                        var t = this.socials[s];
                        t.connect(function () {
                            return t.isLoggedIn() ? (cleverapps.platform.plugins[Platform.SOCIAL] = t, cleverapps.social = t, console.log("Change social to " + s), void i(Platform.STATUS_CONNECTED)) : void e()
                        })
                    }.bind(this)
                }, this);
                new ActionPlayer(e).play(function () {
                    i(Platform.STATUS_CONNECTED)
                })
            }, cleverapps.SelectSocial.prototype.createSocials = function () {
                var e = cleverapps.platform.haveTmpId(),
                    t = cleverapps.AndroidSocial.isAndroidUserId(cleverapps.platform.getUserID()),
                    s = cleverapps.AppleSocial.isAppleUserId(cleverapps.platform.getUserID());
                !e && (e || t || s) || (this.socials.facebook = cleverapps.SelectSocial.selectMobileFB()), (e && cleverapps.AndroidSocial.isAvailable() || t) && (this.socials.androidsocial = new cleverapps.AndroidSocial), (e && cleverapps.AppleSocial.isAvailable() || s) && (this.socials.applesocial = new cleverapps.AppleSocial), console.log("SelectSocial.createSocials - " + cleverapps.platform.getUserID() + " - " + Object.keys(this.socials).join(","))
            }, cleverapps.SelectSocial.selectMobileFB = function () {
                return new WebViewFacebook
            }, cleverapps.SelectSocial.prototype.login = function (t, e) {
                var s = e.source,
                    i = this.socials[s];
                i.login(function (e) {
                    cleverapps.social = i, cleverapps.platform.plugins[Platform.SOCIAL] = i, console.log("Change social to " + s), t(e)
                })
            }, cleverapps.SelectSocial.prototype.getCode = function () {
                return Object.keys(this.socials).sort().join("-")
            },
            function (e) {
                this.data = {}, this.player = void 0, this.lastUpdateTime = 0, this.isInvitable = e, this.load(),
                    this.onUserUpdatedListener = function () { }, this.playerInfoChangedListeners = {}
            }),
        SpPlatformButtons = (FriendsCache.prototype.getStoreKey = function () {
            return this.isInvitable ? SimpleDataLoader.TYPES.INVITABLE_FRIENDS : SimpleDataLoader.TYPES.FRIENDS
        }, FriendsCache.prototype.reset = function () {
            this.data = {}, this.player = void 0, this.lastUpdateTime = 0, this.save()
        }, FriendsCache.prototype.load = function () {
            var e = cleverapps.platform.dataLoader.load(this.getStoreKey());
            e && (this.data = e.data, this.player = e.player, this.lastUpdateTime = e.when)
        }, FriendsCache.prototype.save = function () {
            var e = {
                data: this.data,
                player: this.player,
                when: this.lastUpdateTime
            };
            cleverapps.platform.dataLoader.save(this.getStoreKey(), e)
        }, FriendsCache.prototype.isEmpty = function () {
            return 0 === this.lastUpdateTime || 0 === this.data.length
        }, FriendsCache.prototype.haveData = function () {
            return 0 !== this.lastUpdateTime
        }, FriendsCache.prototype.setData = function (e) {
            this.data = {}, e.forEach(function (e) {
                this.data[e.id] = {
                    id: e.id,
                    name: e.first_name,
                    avatar: e.picture && e.picture.data && e.picture.data.url
                }
            }, this), this.lastUpdateTime = Date.now(), this.save()
        }, FriendsCache.prototype.getPlayer = function () {
            var e = FriendsCache.DEFAULT_PLAYER_INFO();
            return this.player ? {
                id: this.player.id || e.id,
                self: !0,
                name: this.player.name || e.name,
                avatar: this.player.avatar || e.avatar
            } : e
        }, FriendsCache.prototype.updatePlayerInfo = function (e) {
            var t = this.getPlayer();
            this.player = {
                id: cleverapps.platform.getUserID(),
                self: !0,
                name: e.first_name,
                avatar: e.picture && e.picture.data && e.picture.data.url
            }, this.save(), t.id === this.player.id && t.name === this.player.name && t.avatar === this.player.avatar || (this.onUserUpdatedListener(), cleverapps.values(this.playerInfoChangedListeners).forEach(function (e) {
                e(t.id)
            }))
        }, FriendsCache.prototype.getById = function (e) {
            return this.data[e]
        }, FriendsCache.prototype.listIds = function () {
            return Object.keys(this.data)
        }, FriendsCache.prototype.listFriends = function () {
            return cleverapps.values(this.data)
        }, FriendsCache.prototype.inApp = function (e) {
            return void 0 !== this.data[e]
        }, FriendsCache.prototype.reload = function () {
            cleverapps.social.isLoggedIn() && (this.isInvitable ? cleverapps.social.listInvitableFriends(function (e, t) {
                void 0 !== t && this.setData(t)
            }.bind(this)) : cleverapps.social.listFriends(function (e, t) {
                void 0 !== t && this.setData(t)
            }.bind(this)))
        }, FriendsCache.RELOAD_INTERVAL = cleverapps.parseInterval("1 hour"), FriendsCache.DEFAULT_PLAYER_INFO = function () {
            return {
                id: cleverapps.platform.getUserID(),
                self: !0,
                name: Messages.get("Friends.You"),
                avatar: "#avatars/default_avatar.png"
            }
        }, cleverapps.AndroidSocial = function () {
            console.log("Choosing Android Social"), cleverapps.Social.call(this), cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, this.refresh.bind(this)), cleverapps.timeouts.setInterval(this.refresh.bind(this), cleverapps.parseInterval("10 minutes"))
        }, cleverapps.AndroidSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.AndroidSocial.prototype.constructor = cleverapps.AndroidSocial,
            cleverapps.AndroidSocial.prototype._connect = function (s) {
                cleverapps.platform.callNative("AndroidSocialPlugin.refresh", function (e, t) {
                    this.onAuthDetails(t), s(Platform.STATUS_CONNECTED)
                }.bind(this))
            }, cleverapps.AndroidSocial.prototype.refresh = function () {
                cleverapps.social === this && cleverapps.platform.connectPlugin(Platform.SOCIAL)
            }, cleverapps.AndroidSocial.prototype.isLoggedIn = function () {
                return Boolean(this.userId && this.accessToken)
            }, cleverapps.AndroidSocial.prototype._getUserID = function () {
                return this.userId
            }, cleverapps.AndroidSocial.isAndroidUserId = function (e) {
                return e && 0 === e.indexOf("android_")
            }, cleverapps.AndroidSocial.prototype.getAccessToken = function () {
                return this.accessToken
            }, cleverapps.AndroidSocial.prototype._login = function (s) {
                cleverapps.platform.callNative("AndroidSocialPlugin.login", function (e, t) {
                    this.onAuthDetails(t), s()
                }.bind(this))
            }, cleverapps.AndroidSocial.prototype.onAuthDetails = function (e) {
                e.userId && e.accessToken ? (this.userId = "android_" + e.userId, this.accessToken = e.accessToken) : (this.userId = void 0, this.accessToken = void 0)
            }, cleverapps.AndroidSocial.prototype._aboutMe = function (s) {
                cleverapps.platform.callNative("AndroidSocialPlugin.aboutMe", function (e, t) {
                    s(t)
                })
            }, cleverapps.AndroidSocial.prototype.getCode = function () {
                return cleverapps.AndroidSocial.CODE
            }, cleverapps.AndroidSocial.isAvailable = function () {
                return cleverapps.platform.oneOf(AndroidPlatform, GPG)
            }, cleverapps.AndroidSocial.CODE = "androidsocial", cleverapps.AppleSocial = function () {
                console.log("Choosing Apple Social"), cleverapps.Social.call(this)
            }, cleverapps.AppleSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.AppleSocial.prototype.constructor = cleverapps.AppleSocial, cleverapps.AppleSocial.prototype.onTokenValidateFailure = function () {
                this.id = "", this.token = "", this.save()
            }, cleverapps.AppleSocial.prototype.updateNameFromServer = function (t) {
                console.log("AppleSocial.updateNameFromServer"), cleverapps.RestClient.get("/info/name/" + cleverapps.platform.getUserID(), {}, function (e) {
                    e = e.name || "";
                    console.log("AppleSocial.updateNameFromServer success - " + e), this.name = e, this.save(), t(Platform.STATUS_CONNECTED)
                }.bind(this), function (e) {
                    console.log("AppleSocial.updateNameFromServer failure - " + e), t(Platform.STATUS_CONNECTED)
                })
            }, cleverapps.AppleSocial.prototype.onAuthDetails = function (e, t) {
                console.log("AppleSocial.prepareData - " + JSON.stringify(e)), this.id = e.id || "", this.token = e.token || "", e.name && (this.name = e.name), this.save(), this.id && !this.name ? this.updateNameFromServer(t) : t(Platform.STATUS_CONNECTED)
            }, cleverapps.AppleSocial.prototype.save = function () {
                cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.APPLE_SOCIAL, {
                    id: this.id,
                    token: this.token,
                    name: this.name
                })
            }, cleverapps.AppleSocial.prototype._connect = function (s) {
                var e = cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.APPLE_SOCIAL);
                cleverapps.platform.callNative("AppleSocialPlugin.init", {
                    data: e
                }, function (e, t) {
                    this.onAuthDetails(t, s)
                }.bind(this))
            }, cleverapps.AppleSocial.prototype.isLoggedIn = function () {
                return this._getUserID() && this.getAccessToken()
            }, cleverapps.AppleSocial.prototype._getUserID = function () {
                if (this.id) return "apple_" + this.id
            }, cleverapps.AppleSocial.isAppleUserId = function (e) {
                return e && 0 === e.indexOf("apple_")
            }, cleverapps.AppleSocial.prototype.getAccessToken = function () {
                return this.token
            }, cleverapps.AppleSocial.prototype._login = function (s) {
                cleverapps.platform.callNative("AppleSocialPlugin.login", function (e, t) {
                    this.onAuthDetails(t, s)
                }.bind(this))
            }, cleverapps.AppleSocial.prototype._aboutMe = function (e) {
                var t = {
                    id: cleverapps.platform.getUserID(),
                    first_name: this.name,
                    name: this.name
                };
                console.log("AppleSocial.aboutMe - " + JSON.stringify(t)), e(t)
            }, cleverapps.AppleSocial.prototype.getCode = function () {
                return cleverapps.AppleSocial.CODE
            }, cleverapps.AppleSocial.isAvailable = function () {
                return cleverapps.platform.appleSocialAvailable && cleverapps.platform.oneOf(IOS, MacOS)
            }, cleverapps.AppleSocial.CODE = "applesocial", cleverapps.StartFacebook = function () {
                plugin.extend("facebook", {
                    name: "",
                    version: "",
                    _userInfo: null,
                    _isLoggedIn: void 0,
                    HttpMethod: {
                        GET: "get",
                        POST: "post",
                        DELETE: "delete"
                    },
                    CODE_SUCCEED: 0,
                    AppEvent: {
                        ACTIVATED_APP: FB.AppEvents.EventNames.ACTIVATED_APP,
                        COMPLETED_REGISTRATION: FB.AppEvents.EventNames.COMPLETED_REGISTRATION,
                        VIEWED_CONTENT: FB.AppEvents.EventNames.VIEWED_CONTENT,
                        SEARCHED: FB.AppEvents.EventNames.SEARCHED,
                        RATED: FB.AppEvents.EventNames.RATED,
                        COMPLETED_TUTORIAL: FB.AppEvents.EventNames.COMPLETED_TUTORIAL,
                        ADDED_TO_CART: FB.AppEvents.EventNames.ADDED_TO_CART,
                        ADDED_TO_WISHLIST: FB.AppEvents.EventNames.ADDED_TO_WISHLIST,
                        INITIATED_CHECKOUT: FB.AppEvents.EventNames.INITIATED_CHECKOUT,
                        ADDED_PAYMENT_INFO: FB.AppEvents.EventNames.ADDED_PAYMENT_INFO,
                        PURCHASED: FB.AppEvents.EventNames.PURCHASED,
                        ACHIEVED_LEVEL: FB.AppEvents.EventNames.ACHIEVED_LEVEL,
                        UNLOCKED_ACHIEVEMENT: FB.AppEvents.EventNames.UNLOCKED_ACHIEVEMENT,
                        SPENT_CREDITS: FB.AppEvents.EventNames.SPENT_CREDITS
                    },
                    AppEventParam: {
                        CURRENCY: FB.AppEvents.ParameterNames.CURRENCY,
                        REGISTRATION_METHOD: FB.AppEvents.ParameterNames.REGISTRATION_METHOD,
                        CONTENT_TYPE: FB.AppEvents.ParameterNames.CONTENT_TYPE,
                        CONTENT_ID: FB.AppEvents.ParameterNames.CONTENT_ID,
                        SEARCH_STRING: FB.AppEvents.ParameterNames.SEARCH_STRING,
                        SUCCESS: FB.AppEvents.ParameterNames.SUCCESS,
                        MAX_RATING_VALUE: FB.AppEvents.ParameterNames.MAX_RATING_VALUE,
                        PAYMENT_INFO_AVAILABLE: FB.AppEvents.ParameterNames.PAYMENT_INFO_AVAILABLE,
                        NUM_ITEMS: FB.AppEvents.ParameterNames.NUM_ITEMS,
                        LEVEL: FB.AppEvents.ParameterNames.LEVEL,
                        DESCRIPTION: FB.AppEvents.ParameterNames.DESCRIPTION
                    },
                    AppEventParamValue: {
                        VALUE_YES: "1",
                        VALUE_NO: "0"
                    },
                    _checkLoginStatus: function (e) {
                        var t = this;
                        FB.getLoginStatus(function (e) {
                            e && "connected" === e.status ? (t._isLoggedIn = !0, t._userInfo = e.authResponse) : (t._isLoggedIn = !1, t._userInfo = {})
                        })
                    },
                    ctor: function (e) {
                        this.name = "facebook", this.version = "1.0", this._userInfo = {}, this._isLoggedIn = void 0, FB && (FB.init(e), this._checkLoginStatus(!0), plugin.FacebookAgent = this)
                    },
                    getInstance: function () {
                        return this
                    },
                    login: function (e,
                        s) {
                        e = {
                            scope: e,
                            return_scopes: !0
                        };
                        FB.login(function (e) {
                            var t;
                            e.authResponse ? (this._isLoggedIn = !0, this._userInfo = e.authResponse, t = e.authResponse.grantedScopes.split(","), "function" == typeof s && s(0, {
                                accessToken: e.authResponse.accessToken,
                                permissions: t
                            })) : (this._isLoggedIn = !1, this._userInfo = {}, "function" == typeof s && s(e.error_code || 1, {
                                error_message: e.error_message || "Unknown error"
                            }))
                        }.bind(this), e)
                    },
                    isLoggedIn: function () {
                        return this._isLoggedIn
                    },
                    logout: function (t) {
                        var s = this;
                        FB.logout(function (e) {
                            e.authResponse ? (s._isLoggedIn = !1, s._userInfo = {}, "function" == typeof t && t(0, {
                                isLoggedIn: !1
                            })) : "function" == typeof t && t(e.error_code || 1, {
                                error_message: e.error_message || "Unknown error"
                            })
                        })
                    },
                    _requestPermissions: function (e, s) {
                        var e = e.join(","),
                            i = this;
                        FB.login(function (e) {
                            var t;
                            e.authResponse ? (t = e.authResponse.grantedScopes.split(","), i._isLoggedIn = !0, i._userInfo = e.authResponse, "function" == typeof s && s(0, {
                                permissions: t
                            })) : (i._isLoggedIn = !1, i._userInfo = {}, "function" == typeof s && s(e.error_code || 1, {
                                error_message: e.error_message || "Unknown error"
                            }))
                        }, {
                            scope: e,
                            return_scopes: !0
                        })
                    },
                    getAccessToken: function () {
                        return this._userInfo ? this._userInfo.accessToken : null
                    },
                    getUserID: function () {
                        return this._userInfo ? this._userInfo.userID : null
                    },
                    _share: function (e, t) {
                        FB.ui({
                            method: "share",
                            caption: e.caption,
                            href: e.link
                        }, function (e) {
                            e ? e.post_id ? "function" == typeof t && t(0, {
                                didComplete: !0,
                                post_id: e.post_id
                            }) : "function" == typeof t && t(e.error_code || 1, {
                                error_message: e.error_message || "Unknown error"
                            }) : "function" == typeof t && t(1, {
                                error_message: "Unknown error"
                            })
                        })
                    },
                    dialog: function (e, t) {
                        if (e)
                            if (this.canPresentDialog(e)) {
                                e.name = e.name || e.site, delete e.site, e.href = e.href || e.link || e.siteUrl, delete e.siteUrl, delete e.link, e.picture = e.picture || e.image || e.photo || e.imageUrl || e.imagePath, delete e.imageUrl, delete e.imagePath, delete e.photo, delete e.image, e.caption = e.title || e.caption, delete e.title, e.description = e.text || e.description, delete e.text;
                                var s = e.dialog;
                                if (delete e.dialog, "shareLink" === s || "feedDialog" == s) e.method = "share";
                                else if ("messageLink" == s) e.method = "send", e.link = e.href;
                                else if ("shareOpenGraph" == s && (e.method = "share_open_graph", e.url)) {
                                    var i, n = {};
                                    for (i in e.preview_property_name ? n[e.preview_property_name] = e.url : n.object = e.url, e) "method" != i && "action_type" != i && "action_properties" != i && (e[i] && (n[i] = e[i]), delete e[i]);
                                    e.action_properties = JSON.stringify(n)
                                }
                                FB.ui(e, function (e) {
                                    e && "function" == typeof t ? e.post_id || e.success ? t(0, {
                                        didComplete: !0,
                                        post_id: e.post_id || ""
                                    }) : e.error_code ? t(e.error_code, {
                                        error_message: e.error_message || "Unknown error"
                                    }) : t(0, e) : null == e && "function" == typeof t && t(1, {
                                        error_message: "Unknown error"
                                    })
                                })
                            } else "function" == typeof t && t(1, {
                                error_message: "The requested dialog: " + e.dialog + " can not be presented on Web"
                            });
                        else "function" == typeof t && t(1, {
                            error_message: "No info parameter provided"
                        })
                    },
                    canPresentDialog: function (e) {
                        return !(!e || !e.dialog || "shareLink" !== e.dialog && "feedDialog" !== e.dialog && "shareOpenGraph" !== e.dialog && "messageLink" !== e.dialog)
                    },
                    api: function (e, t, s, i) {
                        "function" == typeof s && (i = s, s = {}), FB.api(e, t, s, function (e) {
                            e.error ? "function" == typeof i && i(e.error.code, {
                                error_message: e.error.message || "Unknown error"
                            }) : "function" == typeof i && i(0, e)
                        })
                    },
                    _getPermissionList: function (i) {
                        FB.api("/me/permissions", function (e) {
                            if (e.data) {
                                for (var t = [], s = 0; s < e.data.length; s++) "granted" == e.data[s].status && t.push(e.data[s].permission);
                                "function" == typeof i && i(0, {
                                    permissions: t
                                })
                            } else e.error || (e.error = {}), "function" == typeof i && i(e.error.code || 1, {
                                error_message: e.error.message || "Unknown error"
                            })
                        })
                    },
                    destroyInstance: function () { },
                    canvas: {
                        pay: function (e, t) {
                            var s = {
                                method: "pay",
                                action: "purchaseitem",
                                product: e.product
                            };
                            "subscription" === e.type && (s.action = "create_subscription"), -1 !== ["cancel_subscription", "reactivate_subscription", "change_subscription"].indexOf(e.action) && (s.action = e.action, s.subscription_id = e.subscription_id), FB.ui(s, function (e) {
                                e ? e.error_code ? t(e.error_code || 1, {
                                    error_message: e.error_message || e.error_msg || "Unknown error"
                                }) : t(0, e) : (
                                    "create_subscription" !== s.action && setTimeout(function () {
                                        throw "no response in FB.ui callback " + s.action + " " + s.product + " " + s.subscription_id
                                    }, 0), t(1, {
                                        error_message: "Unknown error"
                                    }))
                            })
                        }
                    },
                    appRequest: function (e, t) {
                        e ? (e.method = "apprequests", FB.ui(e, function (e) {
                            e ? e.error_code ? "function" == typeof t && t(e.error_code, {
                                error_message: e.error_message || "Unknown error"
                            }) : "function" == typeof t && t(0, e) : "function" == typeof t && t(1, {
                                error_message: "Unknown error"
                            })
                        })) : "function" == typeof t && t(1, {
                            error_message: "No info parameter provided"
                        })
                    },
                    logEvent: function (e, t, s) {
                        null != e && (void 0 === t && void 0 === s ? FB.AppEvents.logEvent(e, null, null) : "number" == typeof t && void 0 === s ? FB.AppEvents.logEvent(e, t) : "object" == typeof t && void 0 === s ? FB.AppEvents.logEvent(e, null, t) : FB.AppEvents.logEvent(e, t, s))
                    },
                    activateApp: function () {
                        FB.AppEvents.activateApp()
                    },
                    logPurchase: function (e, t, s) {
                        FB.AppEvents.logPurchase(e, t, s)
                    }
                })
            }, cleverapps.VKSocial = function () {
                this instanceof cleverapps.MobileVkSocial || console.log("Choosing vkBridge-web"),
                    cleverapps.Social.MAX_INVITE_RANDOM_FRIENDS = 1, cleverapps.Social.call(this), cleverapps.config.debugMode && !cleverapps.VKSocial.DEBUG_USERS[cleverapps.platform.getUserID()] && (document.body.innerHTML = "приложение недоступно")
            }, cleverapps.VKSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.VKSocial.prototype.constructor = cleverapps.VKSocial, cleverapps.VKSocial.prototype._connect = function (s) {
                this.api("VKWebAppGetAuthToken", {
                    app_id: parseInt(cleverapps.config.vk.appId),
                    scope: "friends"
                }, function (e, t) {
                    console.log("VKWebAppGetAuthToken result: " + e + " " + (t ? JSON.stringify(t) : "")), e === cleverapps.CODE_SUCCEED && (this.accessToken = t.access_token, this.scope = t.scope), this.resetCounter(), s(Platform.STATUS_CONNECTED)
                }.bind(this))
            }, cleverapps.VKSocial.prototype.subscribe = function (t, s, i) {
                function n(e) {
                    console.log("vkBridge response", e), e.detail.type === t && (i(cleverapps.CODE_SUCCEED, e.detail.data), vkBridge.unsubscribe(n)), e.detail.type === s && (i(cleverapps.CODE_FAILED, e.detail.data),
                        vkBridge.unsubscribe(n))
                }
                vkBridge.subscribe(n)
            }, cleverapps.VKSocial.prototype.sendActivity = function (e, t) {
                if (e === cleverapps.Social.ACTIVITY.LVL_PASSED) {
                    var s, i = {
                        user_id: cleverapps.platform.getUserID(),
                        v: cleverapps.VKSocial.API_VERSION
                    },
                        n = (void 0 !== t.vkId ? i.activity_id = t.vkId : (i.activity_id = 1, i.value = t.levelNo, cleverapps.Random.mathChoose([0, 1]) && void 0 !== t.score && (i.activity_id = 2, i.value = t.score)), []);
                    for (s in i) n.push(s + "=" + i[s]);
                    cleverapps.RestClient.get("/vkappevents?" + n.join("&"), {})
                }
            }, cleverapps.VKSocial.prototype.markAchievement = function (e) {
                void 0 !== e.vkId && this.sendActivity(cleverapps.Social.ACTIVITY.LVL_PASSED, e)
            }, cleverapps.VKSocial.prototype.hasPromoGift = function (s) {
                var e = new Date(cleverapps.VKSocial.START_DATE).getTime();
                cleverapps.VKSocial.DEBUG_USERS[cleverapps.platform.getUserID()] && (e = new Date(cleverapps.VKSocial.START_DATE_DEBUG).getTime()), Date.now() < e || Date.now() > new Date(cleverapps.VKSocial.END_DATE).getTime() ? s(!1) : (cleverapps.eventLogger.logEvent(
                    cleverapps.EVENTS.RETURNBONUS_CHECK), this.api("apps.promoHasActiveGift", {
                        promo_id: cleverapps.VKSocial.RETURN_BONUS_ID
                    }, function (e, t) {
                        console.log("promoHasActiveGift result: " + e + " " + (t ? JSON.stringify(t) : "")), e === cleverapps.CODE_SUCCEED && 1 === t.response ? s(!0) : s(!1)
                    }))
            }, cleverapps.VKSocial.prototype.usePromoGift = function () {
                this.api("apps.promoUseGift", {
                    promo_id: cleverapps.VKSocial.RETURN_BONUS_ID
                })
            }, cleverapps.VKSocial.prototype.isLoggedIn = function () {
                return !0
            }, cleverapps.VKSocial.prototype._getUserID = function () {
                return cleverapps.getRequestParameters().viewer_id
            }, cleverapps.VKSocial.prototype.getAccessToken = function () {
                return "VK_" + cleverapps.getRequestParameters().auth_key
            }, cleverapps.VKSocial.prototype._login = function (e) {
                e()
            }, cleverapps.VKSocial.prototype._inviteFriends = function (e, t) {
                this.api("VKWebAppShowInviteBox", {}, t)
            }, cleverapps.VKSocial.prototype.requestToOne = function (e, t, s) {
                this.api("VKWebAppShowRequestBox", {
                    uid: parseInt(e),
                    message: t.message,
                    requestKey: "key"
                }, s)
            },
            cleverapps.VKSocial.prototype.showOrderBox = function (e, t) {
                this.api("VKWebAppShowOrderBox", {
                    type: e.type,
                    item: e.item
                }, t)
            }, cleverapps.VKSocial.prototype._request = function (e, s) {
                var i = e.to,
                    n = (Array.isArray(i) || (i = [i]), []),
                    o = function (t) {
                        t === i.length ? s(n.length > Math.floor(i.length / 2) ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED, n) : this.requestToOne(i[t], e, function (e) {
                            e === cleverapps.CODE_SUCCEED && n.push(i[t]), o(t + 1)
                        })
                    }.bind(this);
                o(0)
            }, cleverapps.VKSocial.prototype.api = function (e, t, s) {
                cleverapps.platform.isConnected(Platform.SOCIAL) || "VKWebAppGetAuthToken" === e ? (e.startsWith("apps.") && (t = {
                    method: e,
                    params: Object.assign({
                        v: cleverapps.VKSocial.API_VERSION,
                        access_token: this.accessToken
                    }, t)
                }, e = "VKWebAppCallAPIMethod"), void 0 !== s && this.subscribe("VKWebAppGetAuthToken" === e ? "VKWebAppAccessTokenReceived" : e + "Result", "VKWebAppGetAuthToken" === e ? "VKWebAppAccessTokenFailed" : e + "Failed", s), vkBridge.send(e, t)) : s && s(cleverapps.CODE_FAILED)
            }, cleverapps.VKSocial.prototype._shareDialog = function (e, t) {
                if (!e.vk) throw "No vk data to share!";
                this.api("VKWebAppShowWallPostBox", {
                    message: e.description + "\n" + cleverapps.platform.getGameUrl(),
                    attachments: e.vk + ",https://vk.com/app" + cleverapps.config.vk.appId
                }, t)
            }, cleverapps.VKSocial.prototype.listFriendsByApp = function (i, n) {
                var e = function (e, t) {
                    var s;
                    e === cleverapps.CODE_SUCCEED && t && t.response && t.response.map ? (s = t.response.map(cleverapps.VKSocial.prepareId), this.api("VKWebAppCallAPIMethod", {
                        method: "friends.get",
                        params: {
                            v: cleverapps.VKSocial.API_VERSION,
                            access_token: this.accessToken,
                            count: 1e3,
                            fields: "photo_200"
                        }
                    }, function (e, t) {
                        e === cleverapps.CODE_SUCCEED ? n(cleverapps.CODE_SUCCEED, this.prepareFriendsData(t.response && t.response.items, s, i)) : n(cleverapps.CODE_FAILED, [])
                    }.bind(this))) : n(cleverapps.CODE_FAILED, [])
                }.bind(this);
                this.api("VKWebAppCallAPIMethod", {
                    method: "friends.getAppUsers",
                    params: {
                        v: cleverapps.VKSocial.API_VERSION,
                        access_token: this.accessToken
                    }
                }, e)
            }, cleverapps.VKSocial.prototype.prepareFriendsData = function (e, t, s) {
                return (e || []).filter(function (e) {
                    return void 0 === e.deactivated
                }).map(cleverapps.VKSocial.formatUserData).filter(function (e) {
                    return s === (-1 !== t.indexOf(e.id))
                })
            }, cleverapps.VKSocial.prototype._listFriends = function (e) {
                this.listFriendsByApp(!0, e)
            }, cleverapps.VKSocial.prototype._listInvitableFriends = function (e) {
                this.listFriendsByApp(!1, e)
            }, cleverapps.VKSocial.prototype._aboutMe = function (s) {
                this.api("VKWebAppGetUserInfo", {}, function (e, t) {
                    e === cleverapps.CODE_SUCCEED && s(cleverapps.VKSocial.formatUserData(t))
                })
            }, cleverapps.VKSocial.prototype.resetCounter = function () {
                this.api("VKWebAppCallAPIMethod", {
                    method: "setCounter",
                    params: {
                        v: cleverapps.VKSocial.API_VERSION,
                        access_token: this.accessToken,
                        counter: 0,
                        increment: 0
                    }
                }, function (e) {
                    e === cleverapps.CODE_FAILED && console.log("VK.resetCounter error")
                })
            }, cleverapps.VKSocial.prototype.getName = function () {
                return Messages.get("vk")
            }, cleverapps.VKSocial.prepareId = function (e) {
                return "" + e
            }, cleverapps.VKSocial.formatUserData = function (e) {
                return {
                    id: cleverapps.VKSocial.prepareId(e.id),
                    name: e.first_name + " " + e.last_name,
                    first_name: e.first_name,
                    picture: {
                        data: {
                            url: e.photo_200 && -1 === e.photo_200.indexOf("camera_200.png") ? e.photo_200 : void 0
                        }
                    }
                }
            }, cleverapps.VKSocial.DEFAULT_HEIGHT = 720, cleverapps.VKSocial.DEFAULT_WIDTH = 800, cleverapps.VKSocial.MIN_HEIGHT = 480, cleverapps.VKSocial.SCREEN_HEIGHT_RESERVED = 230, cleverapps.VKSocial.API_VERSION = "5.107", cleverapps.VKSocial.DEBUG_USERS = cleverapps.createSet(["8593874", "519644122", "559432346", "120601236", "13506358", "662073098", "4252816", "575473277", "512342080", "201054870", "9938687", "241941018", "153901140", "16681526", "59691942", "9933151", "159103233", "122220961", "99189882", "807887621", "451315686", "244780021", "62287676", "547943773"]), cleverapps.VKSocial.START_DATE = "2024-02-05", cleverapps.VKSocial.START_DATE_DEBUG = "2024-02-01", cleverapps.VKSocial.END_DATE = "2024-08-06", cleverapps.VKSocial.RETURN_BONUS_ID = 33, cleverapps.VKSocial.MISSIONS = [{
                id: 3,
                level: 1
            }, {
                id: 4,
                level: 2
            }, {
                id: 5,
                level: 3
            }, {
                id: 6,
                level: 4
            }, {
                id: 7,
                level: 5
            }, {
                id: 8,
                level: 6
            }, {
                id: 9,
                level: 10
            }, {
                id: 10,
                level: 20
            }, {
                id: 11,
                level: 50
            }, {
                id: 12,
                level: 100
            }, {
                id: 13,
                level: 150
            }, {
                id: 14,
                level: 200
            }, {
                id: 15,
                level: 300
            }, {
                id: 16,
                level: 500
            }, {
                id: 17,
                level: 750
            }, {
                id: 18,
                level: 1e3
            }, {
                id: 19,
                level: 1500
            }, {
                id: 20,
                level: 2e3
            }], cleverapps.MobileVkSocial = function () {
                console.log("Choosing vkBridge-mobile"), cc.sys.openURL = function (e) {
                    var t = document.createElement("a");
                    t.setAttribute("target", "_blank"), t.setAttribute("href", e), t.click()
                }, cleverapps.VKSocial.call(this)
            }, cleverapps.MobileVkSocial.prototype = Object.create(cleverapps.VKSocial.prototype), cleverapps.MobileVkSocial.prototype.constructor = cleverapps.MobileVkSocial, cleverapps.MobileVkSocial.getPlatfrom = function () {
                return cleverapps.getRequestParameters().platform
            }, cleverapps.MobileVkSocial.prototype.showLeaderBoardBox = function (e, t) {
                this.api("VKWebAppShowLeaderBoardBox", {
                    user_result: e.userResult
                }, t)
            }, cleverapps.MobileVkSocial.prototype._listInvitableFriends = function (e) {
                e(cleverapps.CODE_SUCCEED, [])
            }, cleverapps.OKSocial = function () {
                console.log("Choosing html5-ok"),
                    cleverapps.Social.call(this)
            }, cleverapps.OKSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.OKSocial.prototype.constructor = cleverapps.OKSocial, cleverapps.OKSocial.prototype.isLoggedIn = function () {
                return cleverapps.platform.isConnected(Platform.SOCIAL)
            }, cleverapps.OKSocial.prototype.setStatus = function (n, o) {
                cleverapps.platform.isConnected(Platform.PLATFORM) && (console.log("setStatus", n, o), FAPI.Client.call({
                    method: "sdk.setStatus",
                    event: n,
                    status: o
                }, cleverapps.platform.createFAPICallback(function (e, t, s) {
                    console.log("sdk.setStatus response", JSON.stringify(arguments));
                    var i = "set_status_ok";
                    e !== cleverapps.OKSocial.CODE_SUCCEED && (i = "set_status_error", s && (s.error_msg || s.error_code) && cleverapps.throwAsync("sdk.setStatus event: '" + n + "' status: '" + o + "' error: " + JSON.stringify(s))), cleverapps.eventLogger.logEvent(i)
                })))
            }, cleverapps.OKSocial.prototype._getUserID = function () {
                if (cleverapps.platform.isConnected(Platform.SOCIAL)) return FAPI.Util.getRequestParameters().logged_user_id
            },
            cleverapps.OKSocial.prototype.getAccessToken = function () {
                if (cleverapps.platform.isConnected(Platform.SOCIAL)) return "OK_" + FAPI.Util.getRequestParameters().session_key + "_" + FAPI.Util.getRequestParameters().auth_sig
            }, cleverapps.OKSocial.prototype._login = function (e) {
                e()
            }, cleverapps.OKSocial.prototype._inviteFriends = function (e, s) {
                cleverapps.platform.listeners.showInvite = function (e, t) {
                    "noUsers" === t && cleverapps.notification.create("inviteFriends.noUsers"), e === cleverapps.OKSocial.CODE_SUCCEED ? s(cleverapps.CODE_SUCCEED) : s(cleverapps.CODE_CANCELLED, t)
                }, cleverapps.platform.exitFullscreen(function () {
                    FAPI.UI.showInvite(e.message)
                })
            }, cleverapps.OKSocial.prototype._request = function (e, s) {
                "object" == typeof e.to && (e.to = e.to.join(";")), cleverapps.platform.listeners.showNotification = function (e, t) {
                    "error" !== e || "noUsers" !== t ? e === cleverapps.OKSocial.CODE_SUCCEED ? (t = t.split(","), s(cleverapps.CODE_SUCCEED, t)) : s(cleverapps.CODE_CANCELLED, t) : s(cleverapps.CODE_SUCCEED, [])
                }, cleverapps.platform.exitFullscreen(
                    function () {
                        FAPI.UI.showNotification(e.message, "", e.to)
                    })
            }, cleverapps.OKSocial.prototype._shareDialog = function (e, s) {
                var t = [{
                    type: "app",
                    text: e.description,
                    images: [{
                        url: e.picture,
                        title: e.name
                    }],
                    actions: [{
                        text: e.name,
                        mark: e.name
                    }]
                }];
                cleverapps.platform.listeners.postMediatopic = function (e, t) {
                    e === cleverapps.OKSocial.CODE_SUCCEED ? s(cleverapps.CODE_SUCCEED) : s(cleverapps.CODE_CANCELLED, t)
                }, cleverapps.platform.exitFullscreen(function () {
                    FAPI.UI.postMediatopic({
                        media: t
                    }, !0)
                })
            }, cleverapps.OKSocial.prototype.loadFriendsPerPage = function (e, t) {
                e = e.slice(0, 1e3);
                for (var s = [], i = 0; i < e.length; i += 100) s.push(e.slice(i, i + 100));

                function n(e) {
                    e !== cleverapps.CODE_CANCELLED && (a = a.concat(e)), 0 === --o && t(cleverapps.CODE_SUCCEED, a)
                }
                var o = s.length,
                    a = [];
                s.forEach(function (e) {
                    this.aboutUser(e, n, n)
                }.bind(this))
            }, cleverapps.OKSocial.prototype._listFriends = function (i) {
                FAPI.Client.call({
                    method: "friends.getAppUsers"
                }, cleverapps.platform.createFAPICallback(function (e, t, s) {
                    if (e !== cleverapps.OKSocial.CODE_SUCCEED) return console.log("list friends error: " + s), void i(cleverapps.CODE_CANCELLED);
                    e = t.uids;
                    cleverapps.social.loadFriendsPerPage(e, i)
                }))
            }, cleverapps.OKSocial.prototype._listInvitableFriends = function (n) {
                FAPI.Client.call({
                    method: "friends.get",
                    sort_type: "PRESENT"
                }, cleverapps.platform.createFAPICallback(function (e, t, s) {
                    if (e !== cleverapps.OKSocial.CODE_SUCCEED) return console.log("list ivitable friends error: " + s), void n(cleverapps.CODE_CANCELLED);
                    var i = t;
                    FAPI.Client.call({
                        method: "friends.getAppUsers"
                    }, cleverapps.platform.createFAPICallback(function (e, t, s) {
                        if (e !== cleverapps.OKSocial.CODE_SUCCEED) return console.log("list friends error: " + s), void n(cleverapps.CODE_CANCELLED);
                        e = t.uids;
                        cleverapps.social.loadFriendsPerPage(cleverapps.substract(i, e), n)
                    }))
                }))
            }, cleverapps.OKSocial.formatUserData = function (e) {
                return -1 !== e.pic128x128.indexOf("stub_128x128.gif") && (e.pic128x128 = ""), -1 !== e.pic128x128.indexOf("stub/user") && (e.pic128x128 = ""), {
                    id: e.uid,
                    name: e.first_name + " " + e.last_name,
                    first_name: e.first_name,
                    picture: {
                        data: {
                            url: e.pic128x128
                        }
                    }
                }
            }, cleverapps.OKSocial.prototype._aboutUser = function (e, i, n) {
                var o = !Array.isArray(e);
                o || (e = e.join(",")), FAPI.Client.call({
                    uids: e,
                    fields: "first_name,last_name,uid,pic128x128",
                    method: "users.getInfo"
                }, cleverapps.platform.createFAPICallback(function (e, t, s) {
                    e === cleverapps.OKSocial.CODE_SUCCEED ? (e = t.map(function (e) {
                        return cleverapps.OKSocial.formatUserData(e)
                    }), i(o ? e[0] : e)) : n && n(cleverapps.CODE_CANCELLED, s)
                }))
            }, cleverapps.OKSocial.prototype.getName = function () {
                return Messages.get("ok")
            }, cleverapps.OKSocial.prototype._aboutMe = function (e) {
                this.aboutUser(cleverapps.platform.getUserID(), e)
            }, cleverapps.OKSocial.CODE_SUCCEED = "ok", cleverapps.MyMailRuSocial = function () {
                this instanceof cleverapps.MobileMyMailRuSocial || console.log("Choosing html5-MyMailRu"), cleverapps.Social.call(this)
            }, cleverapps.MyMailRuSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.MyMailRuSocial.prototype.constructor = cleverapps.MyMailRuSocial,
            cleverapps.MyMailRuSocial.prototype._connect = function (e) {
                this.listeners = {
                    friendsInvitation: function () { },
                    friendsRequest: function () { },
                    streamPublish: function () { }
                }, mailru.events.listen(mailru.app.events.friendsInvitation, function (e) {
                    this.listeners.friendsInvitation(e)
                }.bind(this)), mailru.events.listen(mailru.app.events.friendsRequest, function (e) {
                    this.listeners.friendsRequest(e)
                }.bind(this)), mailru.events.listen(mailru.common.events.streamPublish, function (e) {
                    this.listeners.streamPublish(e)
                }.bind(this)), e(Platform.STATUS_CONNECTED)
            }, cleverapps.MyMailRuSocial.prototype.isLoggedIn = function () {
                return !0
            }, cleverapps.MyMailRuSocial.prototype._getUserID = function () {
                return cleverapps.getRequestParameters().vid
            }, cleverapps.MyMailRuSocial.prototype.getAccessToken = function () {
                var e, t = [],
                    s = cleverapps.getRequestParameters();
                for (e in s) "sig" !== e && t.push(e);
                t.sort();
                for (var i = "", n = 0; n < t.length; n++) i += t[n] + "=" + s[t[n]];
                return "MM_" + s.sig + "_" + i
            }, cleverapps.MyMailRuSocial.prototype._login = function (e) {
                e()
            },
            cleverapps.MyMailRuSocial.prototype._inviteFriends = function (e, t) {
                this.listeners.friendsInvitation = function (e) {
                    "opened" !== e.status && t(e.data && e.data.length ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED)
                }, cleverapps.platform.exitFullscreen(function () {
                    mailru.app.friends.invite({
                        text: e.message
                    })
                })
            }, cleverapps.MyMailRuSocial.prototype._request = function (e, t) {
                this.listeners.friendsRequest = function (e) {
                    "opened" !== e.status && (e.data && e.data.length ? t(cleverapps.CODE_SUCCEED, e.data) : t(cleverapps.CODE_CANCELLED))
                }, cleverapps.platform.exitFullscreen(function () {
                    mailru.app.friends.request({
                        text: e.message,
                        image_url: Share.getData("default").picture,
                        friends: e.to
                    })
                })
            }, cleverapps.MyMailRuSocial.prototype._shareDialog = function (e, t) {
                this.listeners.streamPublish = function (e) {
                    "opened" !== e.status && ("publishSuccess" === e.status ? t(cleverapps.CODE_SUCCEED) : (console.log(e.status), t(cleverapps.CODE_CANCELLED)))
                };
                var s = {
                    title: e.name,
                    text: e.description,
                    img_url: e.picture
                };
                cleverapps.platform.exitFullscreen(function () {
                    mailru.common.stream.post(s)
                })
            }, cleverapps.MyMailRuSocial.prototype._listFriends = function (i) {
                mailru.common.friends.getAppUsers(function (e) {
                    for (var t = [], s = 0; s < e.length; s++) t.push(cleverapps.MyMailRuSocial.formatUserData(e[s]));
                    i(cleverapps.CODE_SUCCEED, t)
                }, !0)
            }, cleverapps.MyMailRuSocial.prototype._listInvitableFriends = function (i) {
                mailru.common.friends.getExtended(function (e) {
                    for (var t = [], s = 0; s < e.length; s++) e[s].app_installed || t.push(cleverapps.MyMailRuSocial.formatUserData(e[s]));
                    i(cleverapps.CODE_SUCCEED, t)
                })
            }, cleverapps.MyMailRuSocial.formatUserData = function (e) {
                return {
                    id: e.uid,
                    name: e.first_name + " " + e.last_name,
                    first_name: e.first_name,
                    picture: {
                        data: {
                            url: e.pic_128
                        }
                    }
                }
            }, cleverapps.MyMailRuSocial.prototype._aboutUser = function (e, t, s) {
                var i = !Array.isArray(e);
                mailru.common.users.getInfo(function (e) {
                    e.error ? s && s(cleverapps.CODE_FAILED, e.error) : (e && "function" == typeof e.map || cleverapps.throwAsync("MailRU aboutUser response - " + JSON.stringify(e)), e = e.map(function (e) {
                        return cleverapps.MyMailRuSocial.formatUserData(e)
                    }), t(i ? e[0] : e))
                }, e)
            }, cleverapps.MyMailRuSocial.prototype._aboutMe = function (e) {
                this.aboutUser(cleverapps.platform.getUserID(), e)
            }, cleverapps.MobileMyMailRuSocial = function () {
                console.log("Choosing mobile-MyMailRu"), cleverapps.MyMailRuSocial.call(this)
            }, cleverapps.MobileMyMailRuSocial.prototype = Object.create(cleverapps.MyMailRuSocial.prototype), cleverapps.MobileMyMailRuSocial.prototype.constructor = cleverapps.MobileMyMailRuSocial, cleverapps.MobileMyMailRuSocial.prototype._connect = function (e) {
                e(Platform.STATUS_CONNECTED)
            }, cleverapps.MobileMyMailRuSocial.prototype._inviteFriends = function (e, t) {
                cleverapps.notification.create("mobileNotAvailable"), t(cleverapps.CODE_CANCELLED)
            }, cleverapps.MobileMyMailRuSocial.prototype._request = function (e, t) {
                cleverapps.notification.create("mobileNotAvailable"), t(cleverapps.CODE_CANCELLED)
            }, cleverapps.MobileMyMailRuSocial.prototype._shareDialog = function (e, t) {
                cleverapps.notification.create("mobileNotAvailable"), t(
                    cleverapps.CODE_CANCELLED)
            }, cleverapps.MobageSocial = function () {
                this instanceof cleverapps.SPMobageSocial || console.log("Choosing html5-mobage"), cleverapps.Social.call(this), this.increaseViralBonuses()
            }, cleverapps.MobageSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.MobageSocial.prototype.constructor = cleverapps.MobageSocial, cleverapps.MobageSocial.prototype.increaseViralBonuses = function () {
                TacticalExtendWindow.AMOUNT = 5
            }, cleverapps.MobageSocial.HEIGHT = 860, cleverapps.MobageSocial.prototype._connect = function (i) {
                gadgets.window.adjustHeight(cleverapps.MobageSocial.HEIGHT);
                var e = opensocial.newDataRequest();
                e.add(e.newFetchPersonRequest(opensocial.IdSpec.PersonId.VIEWER), "viewer"), e.send(function (e) {
                    var t, s;
                    e.hadError() || (t = e.get("viewer")).hadError() || "mbga.jp:-1" === (s = t.getData()).getId() ? i(Platform.STATUS_DISCONNECTED) : (this.user = cleverapps.MobageSocial.formatUserData(s), console.log(this.user), i(Platform.STATUS_CONNECTED))
                }.bind(this))
            },
            cleverapps.MobageSocial.prototype.isLoggedIn = function () {
                return !0
            }, cleverapps.MobageSocial.prototype._getUserID = function () {
                return this.user && this.user.id
            }, cleverapps.MobageSocial.prototype.getAccessToken = function () {
                return "mbga"
            }, cleverapps.MobageSocial.prototype._login = function (e) {
                e()
            }, cleverapps.MobageSocial.prototype.sendActivity = function (e, t) {
                var s, e = cleverapps.Social.ACTIVITIES_CONFIG[e];
                e.probability > Math.random() && (e = cleverapps.Random.mathChoose(e.messages), (s = {})[opensocial.Activity.Field.TITLE] = Messages.get(e.title), s[opensocial.Activity.Field.BODY] = Messages.get(e.body, t), e = opensocial.newActivity(s), opensocial.requestCreateActivity(e, opensocial.CreateActivityPriority.LOW, function (e) {
                    e.hadError()
                }))
            }, cleverapps.MobageSocial.prototype._inviteFriends = function (e, t) {
                var s = {},
                    e = (s[opensocial.Message.Field.TITLE] = e.title, opensocial.newMessage(e.message, s));
                opensocial.requestShareApp("VIEWER_FRIENDS", e, function (e) {
                    e.hadError() ? t(cleverapps.CODE_CANCELLED, e) : t(cleverapps.CODE_SUCCEED)
                })
            }, cleverapps.MobageSocial.prototype.requestToOne = function (e, t, s) {
                var i = {},
                    t = (i[opensocial.Message.Field.TITLE] = t.title, t.message),
                    t = opensocial.newMessage(t, i);
                opensocial.requestSendMessage(e, t, function (e) {
                    var t;
                    !e.hadError() && (t = e.getData()).recipientIds && 0 < t.recipientIds.length ? s(cleverapps.CODE_SUCCEED) : s(cleverapps.CODE_CANCELLED)
                })
            }, cleverapps.MobageSocial.prototype._request = function (e, s) {
                var i = e.to,
                    n = (Array.isArray(i) || (i = [i]), []),
                    o = function (t) {
                        t === i.length ? s(0 < n.length ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED, n) : this.requestToOne(i[t], e, function (e) {
                            e === cleverapps.CODE_SUCCEED && n.push(i[t]), setTimeout(function () {
                                o(t + 1)
                            }, 500)
                        })
                    }.bind(this);
                o(0)
            }, cleverapps.MobageSocial.prototype._shareDialog = function (e, t) {
                var s = opensocial.newMediaItem("image/jpg", e.picture),
                    i = (s.setField(opensocial.MediaItem.Field.TYPE, opensocial.MediaItem.Type.IMAGE), {}),
                    e = (i[mbga.Diary.Field.TITLE] = e.name, i[mbga.Diary.Field.CONTENT] = e.description, i[mbga.Diary.Field.MEDIA_ITEMS] = [s], mbga.newCreateDiary(i));
                mbga.requestCreateDiary(e, function (e) {
                    e.hadError() ? t(cleverapps.CODE_FAILED, e) : (e = e.getData().getEntryURL(), console.log(e), t(e ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED))
                })
            }, cleverapps.MobageSocial.prototype.listFriendsByApp = function (t, s) {
                var e = {},
                    i = (e[opensocial.DataRequest.PeopleRequestFields.MAX] = 1e3, e[opensocial.DataRequest.PeopleRequestFields.PROFILE_DETAILS] = [opensocial.Person.Field.HAS_APP], {}),
                    i = (i[opensocial.IdSpec.Field.USER_ID] = opensocial.IdSpec.PersonId.VIEWER, i[opensocial.IdSpec.Field.GROUP_ID] = opensocial.IdSpec.GroupId.FRIENDS, opensocial.newIdSpec(i)),
                    n = opensocial.newDataRequest();
                n.add(n.newFetchPeopleRequest(i, e), "friends"), n.send(function (e) {
                    e.hadError() ? s(cleverapps.CODE_FAILED) : (e = (e = e.get("friends").getData().asArray()).filter(function (e) {
                        return e.getField(opensocial.Person.Field.HAS_APP) === t
                    }), s(cleverapps.CODE_SUCCEED, e.map(cleverapps.MobageSocial.formatUserData)))
                })
            }, cleverapps.MobageSocial.prototype._listFriends = function (e) {
                this.listFriendsByApp(!0, e)
            },
            cleverapps.MobageSocial.prototype._listInvitableFriends = function (e) {
                this.listFriendsByApp(!1, e)
            }, cleverapps.MobageSocial.formatUserData = function (t) {
                var s = "",
                    i = {
                        id: t.getId(),
                        name: t.getDisplayName(),
                        first_name: t.getDisplayName()
                    };
                try {
                    return s = cleverapps.MobageSocial.proxyAvatar(t.getField(opensocial.Person.Field.THUMBNAIL_URL)), i.picture = {
                        data: {
                            url: s
                        }
                    }, i
                } catch (e) {
                    throw e instanceof TypeError || e.message && -1 !== e.message.indexOf("of null") ? (t = e.message + " avatarUrl - " + s + " reqUserId - " + i.id + " reqUserName - " + i.name + " stack - " + JSON.stringify(e.stack), new Error(t)) : e
                }
            }, cleverapps.MobageSocial.proxyAvatar = function (e) {
                return cleverapps.platform.getExternalUrl("proxy") + e.match(/.*profile(.*)/)[1]
            }, cleverapps.MobageSocial.prototype._aboutMe = function (e) {
                e(this.user)
            }, cleverapps.MobageSocial.prototype.getName = function () {
                return Messages.get("mbga")
            }, cleverapps.MobageSocial.CODE_SUCCEED = "ok", cleverapps.SPMobageSocial = function () {
                console.log("Choosing sp-mobage"), cleverapps.MobageSocial.call(this),
                    this.clientData = {
                        clientId: cleverapps.config.mbga.appId + "-4",
                        state: "mobage-connect_" + Math.random().toString(36).slice(-16),
                        code: null,
                        connected: !1,
                        platformLogin: !1
                    };
                var e = cleverapps.config.deployment;
                this.clientData.redirectUrl = e + "/publish/html5" + (cleverapps.config.debugMode ? "-staging" : "") + "/index.html", cleverapps.timeouts.setInterval(this.periodicCheck.bind(this), cleverapps.parseInterval(cleverapps.SPMobageSocial.CHECK_STATUS_INTERVAL))
            }, cleverapps.SPMobageSocial.prototype = Object.create(cleverapps.MobageSocial.prototype), cleverapps.SPMobageSocial.prototype.constructor = cleverapps.SPMobageSocial, cleverapps.SPMobageSocial.prototype.needTokenRefresh = function () {
                return !this.clientData.token || !this.clientData.token.expireTime || this.clientData.token.expireTime <= Date.now()
            }, cleverapps.SPMobageSocial.prototype.checkAccessToken = function (i) {
                i = i || function () { };
                var e = function (e) {
                    var t, s = [];
                    for (t in e) e.hasOwnProperty(t) && s.push(t + "=" + e[t]);
                    cleverapps.RestClient.get(e.path + "?" + s.join("&"), {}, function (e) {
                        this.clientData.token.accessToken = e.accessToken, this.clientData.token.refreshToken = e.refreshToken, this.clientData.token.expireTime = Date.now() + 1e3 * e.expiresIn, i()
                    }.bind(this))
                }.bind(this),
                    t = {
                        redirect_uri: this.clientData.redirectUrl
                    };
                this.clientData.token ? this.needTokenRefresh() ? (t.path = "/spmbgatoken/refresh", t.refresh_token = this.clientData.token.refreshToken, e(t)) : i() : (this.clientData.token = {}, t.path = "/spmbgatoken/get", t.code = this.clientData.code, e(t))
            }, cleverapps.SPMobageSocial.prototype._connect = function (e) {
                this.loggedIn = !1, this.checkLoginStatus(e)
            }, cleverapps.SPMobageSocial.prototype.getPlayerInfo = function (s) {
                mobage.api.people.get({
                    userId: "@me",
                    groupId: "@self",
                    fields: ["id", "displayName", "thumbnailUrl"]
                }, function (e, t) {
                    e ? (console.log("Failed requesting user info", e), s(Platform.STATUS_DISCONNECTED)) : (this.user = cleverapps.SPMobageSocial.formatUserData(t), s(Platform.STATUS_CONNECTED))
                }.bind(this))
            }, cleverapps.SPMobageSocial.prototype._login = function (e) {
                e()
            },
            cleverapps.SPMobageSocial.prototype.checkLoginStatus = function (t) {
                t = t || function () { };
                var s = function () {
                    this.loggedIn = !0, this.getPlayerInfo(t)
                }.bind(this);
                try {
                    mobage.oauth.getConnectedStatus({
                        state: this.clientData.state
                    }, function (e, t) {
                        e ? (this.clientData.platformLogin = e.login, this.clientData.connected = e.connected, this.processAutoLogin(s)) : (this.clientData.platformLogin = !0, this.clientData.connected = !0, this.clientData.code = t.response.code, s())
                    }.bind(this))
                } catch (e) {
                    console.log("Get connect status error", e), t(Platform.STATUS_DISCONNECTED)
                }
            }, cleverapps.SPMobageSocial.prototype.periodicCheck = function () {
                if (cleverapps.platform.isConnected(Platform.SOCIAL) && !this.checkInProcess) {
                    this.checkInProcess = !0;
                    try {
                        mobage.oauth.getConnectedStatus({
                            state: this.clientData.state
                        }, function (e, t) {
                            this.checkInProcess = !1, t && (this.clientData.code = t.response.code, this.checkAccessToken())
                        }.bind(this))
                    } catch (e) {
                        this.checkInProcess = !1, console.log("Get connect status error", e)
                    }
                }
            },
            cleverapps.SPMobageSocial.prototype.processAutoLogin = function (e) {
                var s = ResourceProcessor.calcAlwaysNeed(),
                    i = setInterval(function () {
                        var t;
                        cleverapps.bundleLoader.isLoaded(s) && (clearInterval(i), (t = this.createAutoLoginScreen(e)).updateSize = function () {
                            var e = cleverapps.UI.getSceneSize();
                            t.setContentSize2(e), t.buttonNode.setPositionRound(e.width / 2, e.height / 2)
                        })
                    }.bind(this), 300)
            }, cleverapps.SPMobageSocial.prototype.createAutoLoginScreen = function (e) {
                var t = cleverapps.UI.getSceneSize(),
                    s = new cc.LayerColor(cleverapps.styles.COLORS.WHITE, t.width, t.height),
                    i = (cleverapps.scenes.getRunningScene().addChild(s, 9999), s.buttonNode = new SpPlatformButtons(t.width, function () {
                        s.removeFromParent(), e()
                    }));
                return s.addChild(i), i.setPositionRound(t.width / 2, t.height / 2), s
            }, cleverapps.SPMobageSocial.prototype.isLoggedIn = function () {
                return this.loggedIn
            }, cleverapps.SPMobageSocial.formatUserData = function (e) {
                return {
                    id: e.id,
                    name: e.displayName,
                    first_name: e.displayName,
                    picture: {
                        data: {
                            url: cleverapps.SPMobageSocial.proxyAvatar(e.thumbnailUrl)
                        }
                    }
                }
            }, cleverapps.SPMobageSocial.proxyAvatar = function (e) {
                return cleverapps.config.deployment + "/proxy/sp" + e.match(/.*img_u(.*)/)[1]
            }, cleverapps.SPMobageSocial.prototype.listFriendsByApp = function (s, i) {
                mobage.api.people.get({
                    userId: "@me",
                    groupId: "@friends",
                    fields: ["id", "displayName", "thumbnailUrl", "hasApp"]
                }, function (e, t) {
                    e ? (console.log("Failed fetching friends", e), i(cleverapps.CODE_FAILED)) : (e = (e = t.entry).filter(function (e) {
                        return e.hasApp === s
                    }), i(cleverapps.CODE_SUCCEED, e.map(cleverapps.SPMobageSocial.formatUserData)))
                })
            }, cleverapps.SPMobageSocial.prototype._inviteFriends = function (e, s) {
                mobage.ui.open("invitation", {}, function (e, t) {
                    e ? s(cleverapps.CODE_FAILED, e) : "mobage" === t.response.result.channel ? s(cleverapps.CODE_SUCCEED) : s(cleverapps.CODE_CANCELLED)
                })
            }, cleverapps.SPMobageSocial.prototype._request = function (e, t) {
                t(cleverapps.CODE_SUCCEED)
            }, cleverapps.SPMobageSocial.prototype._shareDialog = function (e, t) {
                t(cleverapps.CODE_SUCCEED)
            },
            cleverapps.SPMobageSocial.prototype.sendActivity = function (e, t) { }, cleverapps.SPMobageSocial.MOBAGE_API = {
                SANDBOX: "https://cdn-sb-connect.mobage.jp/jssdk/mobage-jssdk-client.3.9.1.min.js",
                PRODUCTION: "https://cdn-connect.mobage.jp/jssdk/mobage-jssdk-client.3.9.1.min.js"
            }, cleverapps.SPMobageSocial.CHECK_STATUS_INTERVAL = "10 minutes", cleverapps.Layout.extend({
                ctor: function (e, t) {
                    this.buttonWidth = Math.min(e, cleverapps.styles.SpPlatformButtons.maxButtonWidth), this.callback = t, this._super(this.createItems(), {
                        direction: cleverapps.UI.VERTICAL,
                        margin: cleverapps.styles.SpPlatformButtons.buttonsMargin
                    }), cleverapps.meta.setEventNodes([this])
                },
                createItems: function () {
                    return -1 === SpPlatformButtons.EASY_REGISTRATION_UNAVAILABLE.indexOf(cleverapps.config.name) ? this.createNewFormItems() : this.createOldFormItems()
                },
                createNewFormItems: function () {
                    var e = [];
                    return cleverapps.social.clientData.platformLogin ? e.push(this.createOneButton("ゲームを始める", this.createLink("同意事項等（必読)"))) : (e.push(this.createOneButton("モバゲーIDで始める",
                        this.createLink("同意事項等（必読)"))), e.push(this.createOneButton("新規かんたん会員で始める", this.createLink("会員規約等（必読)", !0), !0))), e
                },
                createOldFormItems: function () {
                    var e = [],
                        t = (cleverapps.social.clientData.platformLogin ? e.push(this.createOneButton("インストール")) : e.push(this.createOneButton("ログイン")), "ゲームをスタートするには" + (cleverapps.social.clientData.platformLogin ? "ゲームをインストール" : "ログイン") + "してください。"),
                        t = cleverapps.UI.__generateNotLocalizedText(t, cleverapps.styles.FONTS.BLACK_LINK_TEXT);
                    return t.setDimensions(Math.min(cleverapps.styles.SpPlatformButtons.maxTextWidth, .7 * cleverapps.UI.getSceneSize().width), 0), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.push(t), e
                },
                createOneButton: function (e, t, s) {
                    var i = function (e, t) {
                        e ? console.log("Authorization failed:", e) : (cleverapps.social.clientData.platformLogin = !0, cleverapps.social.clientData.connected = !0, cleverapps.social.clientData.code = t.response.code, cleverapps.social.checkAccessToken(), this.callback())
                    }.bind(this),
                        e = cleverapps.UI.__generateNotLocalizedText(e,
                            cleverapps.styles.FONTS.BUTTON_TEXT),
                        t = [t, new cleverapps.UI.Button({
                            content: e,
                            width: this.buttonWidth,
                            onClicked: function () {
                                var e = {
                                    state: cleverapps.social.clientData.state
                                };
                                s && (e.easyRegistration = !0, e.requestType = "window"), mobage.oauth.connect(e, i)
                            }
                        })].filter(function (e) {
                            return e
                        });
                    return new cleverapps.Layout(t, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: cleverapps.styles.SpPlatformButtons.linkMargin
                    })
                },
                createLink: function (e, t) {
                    var e = cleverapps.UI.__generateNotLocalizedText(e, cleverapps.styles.FONTS.BLUE_LINK_TEXT),
                        s = cleverapps.UI.__generateNotLocalizedText(" に同意して", cleverapps.styles.FONTS.BLACK_LINK_TEXT),
                        e = new cleverapps.Layout([e, s], {
                            direction: cleverapps.UI.HORIZONTAL,
                            margin: cleverapps.styles.SpPlatformButtons.textMargin
                        });
                    return cleverapps.UI.applyHover(e), cleverapps.UI.onClick(e, function () {
                        t ? mobage.ui.show("client_agreement_menu", {
                            isEasyRegistration: !0
                        }) : mobage.ui.show("client_agreement_menu")
                    }), e
                }
            })),
        CrazySocial = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            BLUE_LINK_TEXT: {
                size: 40,
                color: new cc.Color(62, 158, 254)
            },
            BLACK_LINK_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.BLACK
            }
        }), SpPlatformButtons.EASY_REGISTRATION_UNAVAILABLE = ["riddles", "heroes", "tripeaks", "crocword", "runes"], cleverapps.styles.SpPlatformButtons = {
            buttonsMargin: 50,
            linkMargin: 10,
            textMargin: 5,
            maxButtonWidth: 600,
            maxTextWidth: 600
        }, cleverapps.XsollaSocial = function () {
            console.log("Choosing Xsolla"), this.accessToken = void 0, this.user = void 0, cleverapps.Social.call(this)
        }, cleverapps.XsollaSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.XsollaSocial.prototype.constructor = cleverapps.XsollaSocial, cleverapps.XsollaSocial.prototype._connect = function (t) {
            var e = document.createElement("div");
            e.id = "xsollaLoginLayout", e.style.width = "100%", e.style.height = "100%", e.style.left = "0px", e.style.top = "0px", e.style.position = "absolute", e.style.backgroundColor = "#00000050", e.style.zIndex = "1000000000", e.style.visibility = "hidden", document.body.appendChild(e),
                this.accessToken = cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.XSOLLA_ACCESS_TOKEN), this.accessToken ? this.loadUser(function (e) {
                    e === cleverapps.CODE_SUCCEED ? t(Platform.STATUS_CONNECTED) : (this.accessToken = void 0, cleverapps.platform.dataLoader.remove(SimpleDataLoader.TYPES.XSOLLA_ACCESS_TOKEN), t(Platform.STATUS_DISCONNECTED))
                }.bind(this)) : t(Platform.STATUS_CONNECTED)
        }, cleverapps.XsollaSocial.prototype.loadUser = function (t) {
            cleverapps.RestClient.get("https://login.xsolla.com/api/users/me", {}, function (e) {
                this.user = e, t(cleverapps.CODE_SUCCEED)
            }.bind(this), function () {
                t(cleverapps.CODE_FAILED)
            }, {
                authorization: "Bearer " + this.accessToken
            })
        }, cleverapps.XsollaSocial.prototype._login = function (t) {
            function s() {
                window.removeEventListener("message", i, !1), document.getElementById("xsollaLoginLayout").style.visibility = "hidden", clearInterval(e)
            }
            var e, i = function (e) {
                e.origin === location.origin && (this.accessToken = e.data, cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.XSOLLA_ACCESS_TOKEN,
                    this.accessToken), s(), this.loadUser(t))
            }.bind(this),
                n = Math.max(800, .5 * screen.width),
                o = Math.max(600, .6 * screen.height),
                a = (screen.width - n) / 2,
                r = (screen.height - o) / 2,
                c = (c = location.href).substr(0, c.lastIndexOf("/") + 1) + "xsolla-login.html",
                l = window.open(c, "popup", "toolbar=no, location=no, directories=no, status=no, menubar=no, copyhistory=no, width=" + n + ", height=" + o + ", top=" + r + ", left=" + a);
            l ? (window.addEventListener("message", i, !1), document.getElementById("xsollaLoginLayout").style.visibility = "visible", e = setInterval(function () {
                l.closed && (s(), t())
            }, 100)) : t()
        }, cleverapps.XsollaSocial.prototype._getUserID = function () {
            return this.user ? this.user.id : void 0
        }, cleverapps.XsollaSocial.prototype.isLoggedIn = function () {
            return this.user
        }, cleverapps.XsollaSocial.prototype.getAccessToken = function () {
            return "XS_" + (this.accessToken || 0)
        }, cleverapps.XsollaSocial.prototype._aboutMe = function (t) {
            cleverapps.RestClient.get("https://login.xsolla.com/api/users/me/social_providers", {}, function (e) {
                e && 0 < e.length ? (e = e[0], t({
                    id: cleverapps.platform.getUserID(),
                    name: e.full_name,
                    first_name: e.nickname,
                    picture: {
                        data: {
                            url: e.picture
                        }
                    }
                })) : console.log("Error: " + JSON.stringify(e))
            }, function () {
                console.log("Failed loading aboutMe")
            }, {
                authorization: "Bearer " + this.accessToken
            })
        }, cleverapps.FacebookCanvasSocial = function () {
            console.log("Choosing html5-facebook"), cleverapps.BaseFB.call(this)
        }, cleverapps.FacebookCanvasSocial.prototype = Object.create(cleverapps.BaseFB.prototype), cleverapps.FacebookCanvasSocial.prototype.constructor = cleverapps.FacebookCanvasSocial, cleverapps.FacebookCanvasSocial.prototype.isLoggedIn = function () {
            return cleverapps.platform.isConnected(Platform.SOCIAL) && plugin.FacebookAgent.getInstance().isLoggedIn()
        }, cleverapps.FacebookCanvasSocial.prototype._getUserID = function () {
            if (cleverapps.platform.isConnected(Platform.SOCIAL)) return plugin.FacebookAgent.getInstance().getUserID()
        }, cleverapps.FacebookCanvasSocial.prototype.getAccessToken = function () {
            if (cleverapps.platform.isConnected(Platform.SOCIAL)) return plugin.FacebookAgent.getInstance().getAccessToken()
        }, cleverapps.FacebookCanvasSocial.prototype._login = function (e) {
            cleverapps.platform.exitFullscreen(function () {
                plugin.FacebookAgent.getInstance().login(cleverapps.BaseFB.PERMISSIONS, function () {
                    e()
                })
            })
        }, cleverapps.FacebookCanvasSocial.prototype._inviteFriends = function (e, t) {
            this.request(e, t)
        }, cleverapps.FacebookCanvasSocial.prototype._request = function (e, t) {
            cleverapps.platform.isConnected(Platform.SOCIAL) ? (delete e.element, "object" == typeof e.to && (e.to = e.to.join(",")), cleverapps.platform.exitFullscreen(function () {
                plugin.FacebookAgent.getInstance().appRequest(e, t)
            })) : t && t(cleverapps.CODE_FAILED)
        }, cleverapps.FacebookCanvasSocial.prototype._shareDialog = function (e, t) {
            var e = this.getShareDialogLink(e),
                s = (console.log("share link", e), {
                    dialog: "feedDialog",
                    link: e,
                    caption: Messages.get(cleverapps.config.title)
                });
            cleverapps.platform.exitFullscreen(function () {
                plugin.FacebookAgent.getInstance().dialog(s, t)
            })
        },
            cleverapps.FacebookCanvasSocial.prototype.api = function (e, t, s, i) {
                if (cleverapps.platform.isConnected(Platform.SOCIAL)) {
                    if ("function" == typeof (s = s || {}) && (i = s, s = {}), !this.isLoggedIn()) return console.log("Not logged in!"), void (i && i(cleverapps.CODE_CANCELLED));
                    void 0 === t ? (t = plugin.FacebookAgent.HttpMethod.GET, i = function () { }) : "function" == typeof t && (i = t, t = plugin.FacebookAgent.HttpMethod.GET);
                    try {
                        plugin.FacebookAgent.getInstance().api(e, t, s, i)
                    } catch (e) {
                        console.log(e), i && i(cleverapps.CODE_CANCELLED)
                    }
                } else i && i(cleverapps.CODE_FAILED)
            }, cleverapps.FacebookCanvasSocial.prototype.getName = function () {
                return Messages.get("facebook")
            }, cleverapps.MicrosoftFacebook = function () {
                console.log("Choosing microsoft-facebook"), cleverapps.Social.call(this)
            }, cleverapps.MicrosoftFacebook.prototype = Object.create(cleverapps.Social.prototype), cleverapps.MicrosoftFacebook.prototype.constructor = cleverapps.MicrosoftFacebook, cleverapps.MicrosoftFacebook.prototype._connect = function (e) {
                this.loadUser(), e(
                    Platform.STATUS_CONNECTED)
            }, cleverapps.MicrosoftFacebook.prototype.saveUser = function () {
                cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.MS_SOCIAL, {
                    user: this.user
                })
            }, cleverapps.MicrosoftFacebook.prototype.loadUser = function () {
                var e = cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.MS_SOCIAL);
                e && e.user && (this.user = e.user)
            }, cleverapps.MicrosoftFacebook.prototype._login = function (e) {
                var t = new WaitWindow,
                    s = function () {
                        t.close(), e(), this.isLoggedIn() && this.saveUser()
                    }.bind(this);
                cleverapps.platform.callNative("social.FBLogin", {
                    FBAppId: cleverapps.config.instant.appId
                }, function (e, t) {
                    t = t && t.authUrl, t = new URLSearchParams(t.substring(t.indexOf("#") + 1));
                    t.has("access_token") ? (this.accessToken = t.get("access_token"), this.initPlayer(s)) : s()
                }.bind(this))
            }, cleverapps.MicrosoftFacebook.prototype.initPlayer = function (t) {
                var e = function (e) {
                    e && e.id ? (this.user = cleverapps.MicrosoftFacebook.formatUserData(e), t(cleverapps.CODE_SUCCEED)) : t(cleverapps.CODE_FAILED)
                }.bind(this);
                this.api(
                    "me?fields=instant_game_player_id,first_name,name,picture", e,
                    function () {
                        t(cleverapps.CODE_FAILED)
                    })
            }, cleverapps.MicrosoftFacebook.prototype.api = function (e, t, s) {
                -1 === e.indexOf("?") && (e += "?");
                e = "https://graph.fb.gg/" + e + "&access_token=" + this.accessToken;
                cleverapps.RestClient.get(e, {}, function (e) {
                    t(e)
                }, function () {
                    s && s()
                })
            }, cleverapps.MicrosoftFacebook.prototype._aboutMe = function (e) {
                this.user && e(this.user)
            }, cleverapps.MicrosoftFacebook.prototype.getAccessToken = function () {
                return "microsoft"
            }, cleverapps.MicrosoftFacebook.prototype.isLoggedIn = function () {
                return this.user && void 0 !== this.user.id
            }, cleverapps.MicrosoftFacebook.prototype._getUserID = function () {
                return this.user && this.user.id
            }, cleverapps.MicrosoftFacebook.prototype.getName = function () {
                return Messages.get("facebook")
            }, cleverapps.MicrosoftFacebook.formatUserData = function (e) {
                return {
                    id: "" + e.instant_game_player_id,
                    fbId: "" + e.id,
                    name: e.name,
                    first_name: e.first_name,
                    picture: {
                        data: {
                            url: e.url
                        }
                    }
                }
            }, cleverapps.MSStartSocial = function () {
                console.log(
                    "Choosing msstart"), cleverapps.Social.call(this)
            }, cleverapps.MSStartSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.MSStartSocial.prototype.constructor = cleverapps.MSStartSocial, cleverapps.MSStartSocial.prototype._connect = function (t) {
                $msstart.getSignedInUserAsync().then(function (e) {
                    this.playerId = e.publisherPlayerId || e.playerId, console.log("MSStart getSignedInUserAsync", e), t(Platform.STATUS_CONNECTED)
                }.bind(this)).catch(function (e) {
                    console.log("MSStart getSignedInUserAsync error", e), t(Platform.STATUS_CONNECTED)
                })
            }, cleverapps.MSStartSocial.prototype.isLoggedIn = function () {
                return !!this.playerId
            }, cleverapps.MSStartSocial.prototype._getUserID = function () {
                return this.playerId
            }, cleverapps.MSStartSocial.prototype._login = function (t) {
                $msstart.signInAsync().then(function (e) {
                    this.playerId = e.publisherPlayerId || e.playerId, console.log("MSStart login", e), t()
                }.bind(this)).catch(function (e) {
                    console.log("MSStart login error", e), t()
                })
            },
            cleverapps.MSStartSocial.prototype._shareDialog = function (e, t) {
                console.log("MS Start share", e), $msstart.shareAsync({
                    title: e.name,
                    text: e.description,
                    image: e.picture
                }).then(function () {
                    console.log("MSStart share: success!"), t(cleverapps.CODE_SUCCEED)
                }).catch(function (e) {
                    console.log("MSStart share error", e), t(cleverapps.CODE_FAILED)
                })
            }, cleverapps.MSStartSocial.prototype._aboutMe = function (e) {
                e({
                    name: "MSN Player " + (cleverapps.platform.getUserID() + "").substring(0, 18),
                    first_name: "MSN Player"
                })
            }, cleverapps.MSStartSocial.prototype.getAccessToken = function () {
                return "msstart"
            }, cleverapps.InstantSocial = function () {
                console.log("Choosing Instant-facebook"), cleverapps.Social.call(this), SelectFriendWindow.MAX_SELECTED = 1
            }, cleverapps.InstantSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.InstantSocial.prototype.constructor = cleverapps.InstantSocial, cleverapps.InstantSocial.prototype._update = function (s, i) {
                this.getBase64Image(Share.getData("default").picture, function (e, t) {
                    e ? (console.log(e), i(cleverapps.CODE_FAILED)) : (i(cleverapps.CODE_SUCCEED), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.REQUEST), FBInstant.updateAsync({
                        action: "CUSTOM",
                        image: t,
                        text: {
                            default: s.message
                        },
                        template: s.template,
                        strategy: "IMMEDIATE",
                        notification: "PUSH"
                    }))
                })
            }, cleverapps.InstantSocial.prototype.isLoggedIn = function () {
                return !!this._getUserID()
            }, cleverapps.InstantSocial.prototype._getUserID = function () {
                if (cleverapps.platform.isConnected(Platform.SOCIAL)) return FBInstant.player.getID()
            }, cleverapps.InstantSocial.prototype._request = function (t, s) {
                FBInstant.context.createAsync(t.to[0]).then(function () {
                    this._update({
                        template: "request",
                        message: t.message
                    }, s)
                }.bind(this)).catch(function (e) {
                    console.log("send request to " + t.to[0] + " failed", e), -1 === ["SAME_CONTEXT", "INVALID_PARAM"].indexOf(e.code) ? s(cleverapps.CODE_FAILED) : s(cleverapps.CODE_SUCCEED)
                })
            }, cleverapps.InstantSocial.prototype._inviteFriends = function (s, i) {
                this.getBase64Image(Share.getData("default").picture, function (e, t) {
                    e ? (
                        console.log(e), i(cleverapps.CODE_FAILED)) : FBInstant.inviteAsync({
                            image: t,
                            text: s.message,
                            cta: s.title
                        }).then(function () {
                            i(cleverapps.CODE_SUCCEED)
                        }).catch(function () {
                            i(cleverapps.CODE_FAILED)
                        })
                })
            }, cleverapps.InstantSocial.prototype._shareDialog = function (s, i) {
                this.getBase64Image(s.picture, function (e, t) {
                    e ? (console.log(e), i(cleverapps.CODE_FAILED)) : cleverapps.countPendingRequests(FBInstant.shareAsync({
                        image: t,
                        text: s.description,
                        cta: s.title,
                        shareDestination: ["NEWSFEED"],
                        switchContext: !1
                    })).then(function () {
                        i(cleverapps.CODE_SUCCEED)
                    }).catch(function () {
                        i(cleverapps.CODE_FAILED)
                    })
                })
            }, cleverapps.InstantSocial.prototype._listFriends = function (t) {
                FBInstant.player.getConnectedPlayersAsync().then(function (e) {
                    e = e.map(function (e) {
                        return {
                            id: e.getID(),
                            first_name: e.getName(),
                            picture: {
                                data: {
                                    url: e.getPhoto()
                                }
                            }
                        }
                    });
                    t(cleverapps.CODE_SUCCEED, e)
                }).catch(function () {
                    t(cleverapps.CODE_FAILED)
                })
            }, cleverapps.InstantSocial.prototype._listInvitableFriends = function (e) {
                e(cleverapps.CODE_SUCCEED, [])
            },
            cleverapps.InstantSocial.prototype._aboutMe = function (e) {
                e({
                    currency: {
                        user_currency: "USD"
                    },
                    name: FBInstant.player.getName(),
                    first_name: FBInstant.player.getName(),
                    picture: {
                        data: {
                            url: FBInstant.player.getPhoto()
                        }
                    }
                })
            }, cleverapps.InstantSocial.prototype.getAccessToken = function () {
                return "instant"
            }, cleverapps.InstantSocial.prototype.getName = function () {
                return Messages.get("facebook")
            }, cleverapps.SamsungSocial = function () {
                console.log("Choosing Samsung Social"), cleverapps.Social.call(this), this.pingThrottled = cleverapps.timeredThrottle(1e4, function () {
                    cleverapps.platform.isConnected(Platform.SOCIAL) && this.ping()
                }.bind(this)), cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, this.pingThrottled.bind(this)), cleverapps.timeouts.setInterval(this.pingThrottled.bind(this), cleverapps.parseInterval("1 minute"))
            }, cleverapps.SamsungSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.SamsungSocial.prototype.constructor = cleverapps.SamsungSocial,
            cleverapps.SamsungSocial.prototype._connect = function (t) {
                GSInstant.addLoginStatusEventListener(function (e) {
                    console.log("login Status Changed : ", JSON.stringify(e)), this.loginStatusChanged = !0
                }.bind(this)), this.ping(function (e) {
                    e === cleverapps.CODE_SUCCEED ? t(Platform.STATUS_CONNECTED) : t(Platform.STATUS_DISCONNECTED)
                })
            }, cleverapps.SamsungSocial.prototype.ping = function (e) {
                var t = new ActionPlayer([function (e, t) {
                    var s = GSInstant.getLoginStatus();
                    console.log("getLoginStatus", s), cleverapps.config.debugMode && cleverapps.notification.create("loginStatus - " + JSON.stringify(s)), "LOGIN" === s.result ? e() : (this.userId = void 0, t())
                }.bind(this), function (e, t) {
                    this.loadPlayer(e, t)
                }.bind(this)]);
                t.onFailure(function () {
                    e && e(cleverapps.CODE_FAILED)
                }), t.play(function () {
                    e && e(cleverapps.CODE_SUCCEED)
                })
            }, cleverapps.SamsungSocial.prototype._login = function (e) {
                var t = new ActionPlayer([function (s, i) {
                    GSInstant.loginAsync().then(function (e) {
                        console.log("login success", e),
                            cleverapps.config.debugMode && cleverapps.notification.create("login success - " + JSON.stringify(e)), s()
                    }).catch(function (e) {
                        var t = e && e.err;
                        console.log("login result", e), cleverapps.config.debugMode && cleverapps.notification.create("login catch - " + JSON.stringify(e)), ("ALREADY_LOGGED_IN" === t ? s : i)()
                    })
                }, function (e, t) {
                    this.loadPlayer(e, t)
                }.bind(this)]);
                t.onFailure(function () {
                    console.log("login failure"), e()
                }), t.play(function () {
                    console.log("login success"), e()
                })
            }, cleverapps.SamsungSocial.prototype.loadPlayer = function (t, s) {
                GSInstant.player.getPlayerIdAsync().then(function (e) {
                    console.log("loadPlayer result - " + e), cleverapps.config.debugMode && cleverapps.notification.create("loadPlayer result - " + e), this.userId = e, t && t()
                }.bind(this)).catch(function (e) {
                    console.log("loadPlayer error", e), cleverapps.config.debugMode && cleverapps.notification.create("loadPlayer error - " + e), s && s()
                })
            }, cleverapps.SamsungSocial.prototype._getUserID = function () {
                var e = this.userId;
                return e = !cleverapps.platform.haveTmpId() ? e || cleverapps.platform.getUserID() : e
            }, cleverapps.SamsungSocial.prototype.isLoggedIn = function () {
                var e = void 0 !== this.userId;
                return e = !cleverapps.paymentsManager.isPurchaseRunning() ? e || !cleverapps.platform.haveTmpId() : e
            }, cleverapps.SamsungSocial.prototype.getAccessToken = function () {
                return "samsung"
            }, cleverapps.PlingaSocial = function () {
                console.log("Choosing plinga"), cleverapps.Social.call(this)
            }, cleverapps.PlingaSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.PlingaSocial.prototype.constructor = cleverapps.PlingaSocial, cleverapps.PlingaSocial.prototype._login = function () {
                plingaRpc.invite()
            }, cleverapps.PlingaSocial.prototype._aboutUser = function (e, t) {
                var s = !Array.isArray(e);
                plingaRpc.getUsers(s ? [e] : e, function (e) {
                    e = e.map(cleverapps.PlingaSocial.formatUserData);
                    t(s ? e[0] : e)
                })
            }, cleverapps.PlingaSocial.prototype._aboutMe = function (e) {
                var t = plingaRpc.getOwner();
                e(cleverapps.PlingaSocial.formatUserData(t))
            }, cleverapps.PlingaSocial.prototype._listFriends = function (e) {
                var t = plingaRpc.getFriends().map(cleverapps.PlingaSocial.formatUserData);
                e(cleverapps.CODE_SUCCEED, t)
            }, cleverapps.PlingaSocial.formatUserData = function (e) {
                return {
                    id: e.uid,
                    name: e.firstname + " " + e.lastname,
                    first_name: e.firstname,
                    picture: {
                        data: {
                            url: e.thumbnailurl
                        }
                    }
                }
            }, cleverapps.PlingaSocial.prototype._inviteFriends = function (e, t) {
                plingaRpc.invite(e.message), t(cleverapps.CODE_SUCCEED)
            }, cleverapps.PlingaSocial.prototype._shareDialog = function (e, t) {
                e = {
                    target: cleverapps.platform.getUserID(),
                    title: e.name,
                    body: e.description,
                    linktext: Messages.get("PlayNow"),
                    pic: e.picture
                };
                plingaRpc.post(e, function (e) {
                    console.log("post callback", e), !1 === e.globalError_ ? t(cleverapps.CODE_SUCCEED) : t(cleverapps.CODE_FAILED)
                }), t(cleverapps.CODE_SUCCEED)
            }, cleverapps.PlingaSocial.prototype.sendMessage = function (e, t) {
                console.log(e), plingaRpc.sendMessage({
                    target: "userid of the receiver",
                    title: "text, which is shown as title",
                    body: "text of the post",
                    pic: "link to a picture, which is shown in the post",
                    linktext: "text to display for the link"
                }, t)
            }, cleverapps.PlingaSocial.prototype.getCode = function () {
                return cleverapps.PlingaSocial.CODE
            }, cleverapps.PlingaSocial.prototype.getAccessToken = function () {
                var e = cleverapps.getRequestParameters();
                return "PLINGA_" + e.sessionid + "_" + e.sessionkey
            }, cleverapps.PlingaSocial.prototype.isLoggedIn = function () {
                return cleverapps.platform.isConnected(Platform.SOCIAL) && !0 !== plingaRpc.getOwner().guest
            }, cleverapps.PlingaSocial.prototype._getUserID = function () {
                if (cleverapps.platform.isConnected(Platform.SOCIAL)) return plingaRpc.getOwner().uid
            }, cleverapps.PlingaSocial.CODE = "plinga", cleverapps.KongregateSocial = function () {
                console.log("Choosing kongregate"), cleverapps.Social.call(this)
            }, cleverapps.KongregateSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.KongregateSocial.prototype.constructor = cleverapps.KongregateSocial, cleverapps.KongregateSocial.prototype.api = function (e, t, s) {
                cleverapps.RestClient.get("https://api.kongregate.com/api/" + e, t, function (
                    e) {
                    e.error ? (console.log("Error response: ", e), s(cleverapps.CODE_FAILED, e)) : (console.log("Success api response: ", e), s(cleverapps.CODE_SUCCEED, e))
                })
            }, cleverapps.KongregateSocial.prototype._connect = function (e) {
                this.resendAchievements(), e(Platform.STATUS_CONNECTED)
            }, cleverapps.KongregateSocial.prototype._login = function () {
                kongregate.services.showRegistrationBox()
            }, cleverapps.KongregateSocial.prototype._aboutMe = function (e) {
                e({
                    id: cleverapps.platform.getUserID(),
                    name: kongregate.services.getUsername(),
                    first_name: kongregate.services.getUsername()
                })
            }, cleverapps.KongregateSocial.prototype._inviteFriends = function (e, t) {
                kongregate.services.showInvitationBox({
                    content: e.message,
                    filter: "not_played"
                }), t(cleverapps.CODE_SUCCEED)
            }, cleverapps.KongregateSocial.prototype._shareDialog = function (e, t) {
                e = {
                    content: e.description,
                    image_uri: e.picture
                };
                kongregate.services.showFeedPostBox(e, function (e) {
                    console.log("post callback", e), e.success ? t(cleverapps.CODE_SUCCEED) : t(cleverapps.CODE_FAILED)
                })
            },
            cleverapps.KongregateSocial.prototype.sendMessage = function (e, t) {
                console.log(e, t)
            }, cleverapps.KongregateSocial.prototype.markAchievement = function (e) {
                void 0 !== e.kongId && kongregate.stats.submit(e.kongId, 1)
            }, cleverapps.KongregateSocial.prototype.resendAchievements = function () {
                cleverapps.achievements && cleverapps.achievements.listCompleted().forEach(function (e) {
                    this.markAchievement(e.getConfig())
                }.bind(this))
            }, cleverapps.KongregateSocial.prototype.getCode = function () {
                return cleverapps.KongregateSocial.CODE
            }, cleverapps.KongregateSocial.prototype.getAccessToken = function () {
                if (cleverapps.platform.isConnected(Platform.SOCIAL)) return "KONGREGATE_" + kongregate.services.getGameAuthToken()
            }, cleverapps.KongregateSocial.prototype.isLoggedIn = function () {
                return cleverapps.platform.isConnected(Platform.SOCIAL) && !0 !== kongregate.services.isGuest()
            }, cleverapps.KongregateSocial.prototype._getUserID = function () {
                if (cleverapps.platform.isConnected(Platform.SOCIAL)) return "" + kongregate.services.getUserId()
            },
            cleverapps.KongregateSocial.CODE = "kongregate",
            function () {
                console.log("Choosing crazy"), cleverapps.Social.call(this)
            }),
        TestSocial = (CrazySocial.prototype = Object.create(cleverapps.Social.prototype), (CrazySocial.prototype.constructor = CrazySocial).prototype._connect = function (e) {
            CrazyGames.SDK.user.addAuthListener(function () {
                this.loadUser(function () {
                    e(Platform.STATUS_CONNECTED)
                })
            }.bind(this))
        }, CrazySocial.prototype._login = function (t) {
            CrazyGames.SDK.user.showAuthPrompt(function (e) {
                if (e) return console.log("CrazySocial login error:", e), void t();
                this.loadUser(t)
            }.bind(this))
        }, CrazySocial.prototype.loadUser = function (s) {
            CrazyGames.SDK.user.getUserToken(function (e, t) {
                if (e) return console.log("CrazyGames getUserToken error:", e), void s(e);
                cleverapps.RestClient.get("/crazy/decodetoken/" + t, {}, function (e) {
                    this.accessToken = t, this.user = CrazySocial.formatUserData(e), s()
                }.bind(this), function (e) {
                    s(e)
                })
            }.bind(this))
        }, CrazySocial.formatUserData = function (e) {
            if (e.userId) return {
                id: "" + e.userId,
                name: e.username,
                first_name: e.username,
                picture: {
                    data: {
                        url: e.profilePictureUrl
                    }
                }
            }
        }, CrazySocial.prototype._aboutMe = function (e) {
            e(this.user)
        }, CrazySocial.prototype.markAchievement = function () {
            CrazyGames.SDK.game.happytime()
        }, CrazySocial.prototype.getAccessToken = function () {
            return "CRAZY_" + this.accessToken
        }, CrazySocial.prototype.isLoggedIn = function () {
            return Boolean(this.user)
        }, CrazySocial.prototype._getUserID = function () {
            return this.user && this.user.id
        }, cleverapps.TonSocial = function () {
            console.log("Choosing Ton Social"), cleverapps.Social.call(this)
        }, cleverapps.TonSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.TonSocial.prototype.constructor = cleverapps.TonSocial, cleverapps.TonSocial.prototype._connect = function (s) {
            cleverapps.platform.callNative("getUser", {}, function (e, t) {
                this.id = "" + t.value.id, s(e === cleverapps.CODE_SUCCEED ? Platform.STATUS_CONNECTED : Platform.STATUS_DISCONNECTED)
            }.bind(this))
        }, cleverapps.TonSocial.prototype._getUserID = function () {
            return this.id
        },
            cleverapps.TonSocial.prototype._login = function (e) {
                e()
            }, cleverapps.TonSocial.prototype.isLoggedIn = function () {
                return !0
            }, cleverapps.TonSocial.prototype.getAccessToken = function () {
                return "ton"
            }, cleverapps.WortalSocial = function () {
                console.log("Choosing Wortal Social"), cleverapps.Social.call(this)
            }, cleverapps.WortalSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.WortalSocial.prototype.constructor = cleverapps.WortalSocial, cleverapps.WortalSocial.prototype._getUserID = function () {
                if (cleverapps.platform.isConnected(Platform.SOCIAL)) return Wortal.player.getID()
            }, cleverapps.WortalSocial.prototype._login = function (e) {
                e()
            }, cleverapps.WortalSocial.prototype.isLoggedIn = function () {
                return !!this._getUserID()
            }, cleverapps.WortalSocial.prototype._aboutMe = function (e) {
                e({
                    currency: {
                        user_currency: "USD"
                    },
                    name: Wortal.player.getName(),
                    first_name: Wortal.player.getName(),
                    picture: {
                        data: {
                            url: Wortal.player.getPhoto()
                        }
                    }
                })
            }, cleverapps.WortalSocial.prototype._request = function (t, s) {
                Wortal.context.createAsync(t.to[0]).then(function () {
                    this._update({
                        template: "request",
                        message: t.message
                    }, s)
                }.bind(this)).catch(function (e) {
                    console.log("send request to " + t.to[0] + " failed", e), -1 === ["SAME_CONTEXT", "INVALID_PARAM"].indexOf(e.code) ? s(cleverapps.CODE_FAILED) : s(cleverapps.CODE_SUCCEED)
                })
            }, cleverapps.WortalSocial.prototype._update = function (s, i) {
                this.getBase64Image(Share.getData("wortal").picture, function (e, t) {
                    e ? (console.log(e), i(cleverapps.CODE_FAILED)) : (i(cleverapps.CODE_SUCCEED), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.REQUEST), Wortal.context.updateAsync({
                        action: "CUSTOM",
                        image: t,
                        text: {
                            default: s.message
                        },
                        template: s.template,
                        strategy: "IMMEDIATE",
                        notification: "PUSH"
                    }))
                })
            }, cleverapps.WortalSocial.prototype._inviteFriends = function (s, i) {
                this.getBase64Image(Share.getData("wortal").picture, function (e, t) {
                    e ? (console.log(e), i(cleverapps.CODE_FAILED)) : Wortal.context.inviteAsync({
                        image: t,
                        text: s.message,
                        cta: s.title
                    }).then(function () {
                        i(cleverapps.CODE_SUCCEED)
                    }).catch(function (e) {
                        console.log(e), i(cleverapps.CODE_FAILED)
                    })
                })
            }, cleverapps.WortalSocial.prototype._shareDialog = function (s, i) {
                this.getBase64Image(s.picture, function (e, t) {
                    e ? (console.log(e), i(cleverapps.CODE_FAILED)) : cleverapps.countPendingRequests(Wortal.context.shareAsync({
                        image: t,
                        text: s.description,
                        cta: s.title,
                        shareDestination: ["NEWSFEED"],
                        switchContext: !1
                    })).then(function () {
                        i(cleverapps.CODE_SUCCEED)
                    }).catch(function () {
                        i(cleverapps.CODE_FAILED)
                    })
                })
            }, cleverapps.WortalSocial.prototype._listFriends = function (t) {
                Wortal.player.getConnectedPlayersAsync().then(function (e) {
                    e = e.map(function (e) {
                        return {
                            id: e.getID(),
                            first_name: e.getName(),
                            picture: {
                                data: {
                                    url: e.getPhoto()
                                }
                            }
                        }
                    });
                    t(cleverapps.CODE_SUCCEED, e)
                }).catch(function () {
                    t(cleverapps.CODE_FAILED)
                })
            }, cleverapps.WortalSocial.prototype._listInvitableFriends = function (e) {
                e(cleverapps.CODE_SUCCEED, [])
            }, cleverapps.WortalSocial.prototype.getAccessToken = function () {
                return "wortal"
            },
            function () {
                console.log("Choosing TestSocial"), cleverapps.BaseFB.call(this)
            }),
        WebViewFacebook = (TestSocial.prototype = Object.create(cleverapps.BaseFB.prototype), (TestSocial.prototype.constructor = TestSocial).prototype.updateSession = function (e) {
            var t = new Date;
            t.setMonth(t.getMonth() + 3), this.id = e, this.token = "123", this.expires = t.getTime(), document.cookie = "tsid=" + this.id + "; path=/; expires=" + t.toUTCString()
        }, TestSocial.prototype.removeSession = function () {
            this.id = void 0, this.token = void 0, this.expires = void 0, document.cookie = "tsid=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;"
        }, TestSocial.prototype.loadSession = function () {
            var e = document.cookie && document.cookie.match(/tsid=([^;]+)/);
            e && this.updateSession(e[1])
        }, TestSocial.prototype._connect = function (e) {
            this.DIALOG_CANCELLED = 2, this.id = void 0, this.expires = void 0, this.token = void 0, setTimeout(function () {
                this.loadSession(), e(Platform.STATUS_CONNECTED)
            }.bind(this), 1e3)
        }, TestSocial.prototype._shareDialog = function (n, o) {
            cc.loader.loadImg(n.picture, function (e, t) {
                function s(e) {
                    i.removeFromParent(), o(e, "TestSocial")
                }
                var i = new cc.Sprite(t),
                    t = cleverapps.scenes.getRunningScene();
                t.addChild(i), i.setPositionRound(t.width / 2, t.height / 2);
                setTimeout(function () {
                    confirm("Do you to post " + JSON.stringify(n) + "?") ? s(cleverapps.CODE_SUCCEED) : s(cleverapps.Social.DIALOG_CANCELLED)
                }, 200)
            })
        }, TestSocial.prototype.isExpired = function () {
            return !this.expires || this.expires < Date.now()
        }, TestSocial.prototype.isLoggedIn = function () {
            return Boolean(this.id)
        }, TestSocial.prototype._getUserID = function () {
            return this.id
        }, TestSocial.prototype.getAccessToken = function () {
            return this.isExpired() ? void 0 : this.token
        }, TestSocial.prototype._login = function (t) {
            new FakeLoginWindow(function (e) {
                e ? this.updateSession(e) : this.removeSession(), t()
            }.bind(this))
        }, TestSocial.prototype.logout = function () {
            this.removeSession()
        }, TestSocial.prototype._inviteFriends = function (e, t) {
            e.picture = Share.getData("default").picture, this.shareDialog(e, t)
        }, TestSocial.prototype._request = function (e, t) {
            delete e.element, t = t || function () { }, confirm("Do you to post " + JSON.stringify(e) + "?") ? t(cleverapps.CODE_SUCCEED, {
                to: [TestSocial.INVITABLE_USERS.invitable_1.id]
            }) : t(cleverapps.Social.DIALOG_CANCELLED, "TestSocial")
        }, TestSocial.prototype._listFriends = function (e) {
            setTimeout(function () {
                e(cleverapps.CODE_SUCCEED, cleverapps.values(TestSocial.USERS))
            }, 500)
        }, TestSocial.prototype._listInvitableFriends = function (e) {
            setTimeout(function () {
                e(cleverapps.CODE_SUCCEED, cleverapps.values(TestSocial.INVITABLE_USERS))
            }, 500)
        }, TestSocial.prototype.api = function (e, t) {
            "/me/?fields=is_eligible_promo" === e && (FB = {
                ui: function (e, t) {
                    t({
                        status: "completed"
                    })
                }
            }, t(cleverapps.CODE_SUCCEED, {
                is_eligible_promo: 1
            }))
        }, TestSocial.prototype._aboutMe = function (e) {
            setTimeout(function () {
                e({
                    currency: {
                        user_currency: "USD"
                    },
                    name: "FakeFB User",
                    first_name: "TestSocial",
                    picture: {
                        data: {
                            url: "https://graph.facebook.com/100001828353521/picture?height=200&width=200"
                        }
                    }
                })
            }, 500)
        }, TestSocial.isAppropriate = function () {
            return cleverapps.platform.oneOf(TestPlatform)
        }, TestSocial.USERS = {
            alpha: {
                name: "Alpha",
                first_name: "Alpha",
                picture: {
                    data: {
                        url: "https://graph.facebook.com/41803173/picture?height=200&width=200"
                    }
                }
            },
            beta: {
                name: "Beta",
                first_name: "Beta",
                picture: {
                    data: {
                        url: "https://graph.facebook.com/692982514/picture?height=200&width=200"
                    }
                }
            },
            gamma: {
                name: "Gamma",
                first_name: "Gamma",
                picture: {
                    data: {
                        url: "https://graph.facebook.com/100028444590540/picture?height=200&width=200"
                    }
                }
            }
        }, Object.keys(TestSocial.USERS).forEach(function (e) {
            TestSocial.USERS[e].id = e
        }), TestSocial.INVITABLE_USERS = {
            invitable_1: {
                name: "Invitable1",
                first_name: "Invitable1",
                picture: {
                    data: {
                        url: "https://graph.facebook.com/100001008129789/picture?height=200&width=200"
                    }
                }
            },
            invitable_2: {
                name: "Invitable2",
                first_name: "Invitable2",
                picture: {
                    data: {
                        url: "https://graph.facebook.com/100011706990070/picture?height=200&width=200"
                    }
                }
            },
            invitable_3: {
                name: "Invitable3",
                first_name: "Invitable3",
                picture: {
                    data: {
                        url: "https://graph.facebook.com/100001575006940/picture?height=200&width=200"
                    }
                }
            },
            invitable_4: {
                name: "Invitable4",
                first_name: "Invitable4",
                picture: {
                    data: {
                        url: "https://graph.facebook.com/100000318466656/picture?height=200&width=200"
                    }
                }
            }
        }, Object.keys(TestSocial.INVITABLE_USERS).forEach(function (e) {
            TestSocial.INVITABLE_USERS[e].id = e
        }), function () {
            this.constructor === WebViewFacebook && console.log("Choosing webview facebook (webview)"), this.apiJobs = [], this.apiProcessing = !1, cleverapps.BaseFB.call(this), this.listeners = {}
        }),
        PlatformLogic = (WebViewFacebook.prototype = Object.create(cleverapps.BaseFB.prototype), (WebViewFacebook.prototype.constructor = WebViewFacebook).prototype.onAuthDetails = function (e) {
            console.log("WebViewFacebook.onAuthDetails - " + JSON.stringify(e)), this.accessToken = e.accessToken, this.userID = e.userID, this.graphDomain = e.graphDomain, this.instantUserID = e.instantUserID, "gaming" === this.graphDomain && (this.userID = this.instantUserID, e.userID && e.accessToken && (this.accessToken = "instant_" + e.userID + "|" + e.accessToken))
        }, WebViewFacebook.prototype._connect = function (s) {
            cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, function () {
                this.deleteAllRequests()
            }.bind(this)), this.deleteAllRequests(), cleverapps.platform.callNative("FacebookPlugin.init", function (e, t) {
                this.onAuthDetails(t), s(Platform.STATUS_CONNECTED)
            }.bind(this))
        }, WebViewFacebook.prototype.isLoggedIn = function () {
            return this.accessToken && this.userID
        }, WebViewFacebook.prototype._getUserID = function () {
            return this.userID
        }, WebViewFacebook.prototype.getAccessToken = function () {
            return this.accessToken
        }, WebViewFacebook.prototype._login = function (s) {
            cleverapps.platform.callNative("FacebookPlugin.login", {
                permissions: cleverapps.BaseFB.PERMISSIONS
            }, function (e, t) {
                console.log("WebViewFacebook.onLogin - " + e + " - " + t), this.onAuthDetails(t), s()
            }.bind(this))
        }, WebViewFacebook.prototype.api = function (e, t, s, i) {
            if ("function" == typeof (s = s || {}) && (i = s, s = {}), !this.isLoggedIn()) return console.log("Not logged in!"), void (i && i(cleverapps.CODE_CANCELLED));
            void 0 === t ? (t = "GET", i = function () { }) : "function" == typeof t && (i = t, t = "GET"), this.apiJobs.push({
                apiMethod: e,
                httpMethod: t,
                params: s,
                callback: i
            }),
                this.processApi()
        }, WebViewFacebook.prototype.processApi = function () {
            var e, s;
            this.apiProcessing || 0 === this.apiJobs.length || (this.apiProcessing = !0, e = this.apiJobs.shift(), s = e.callback, delete e.callback, cleverapps.platform.callNative("FacebookPlugin.api", e, function (e, t) {
                s && e === cleverapps.CODE_SUCCEED && s(cleverapps.CODE_SUCCEED, t), this.apiProcessing = !1, this.processApi()
            }.bind(this)))
        }, WebViewFacebook.prototype.getCode = function () {
            return "facebook"
        }, WebViewFacebook.isAvailable = function () {
            return cleverapps.platform.oneOf(AndroidPlatform, Amazon, IOS)
        }, WebViewFacebook.APPINVITES_SDKBOX_ERROR = "Unrecognized 'com.facebook.platform.protocol.PROTOCOL_ACTION' extra: 'com.facebook.platform.action.request.APPINVITES_DIALOG'.", cleverapps.FotoStranaSocial = function () {
            console.log("Choosing fotostrana"), cleverapps.Social.call(this)
        }, cleverapps.FotoStranaSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.FotoStranaSocial.prototype.constructor = cleverapps.FotoStranaSocial,
            cleverapps.FotoStranaSocial.prototype.isLoggedIn = function () {
                return !0
            }, cleverapps.FotoStranaSocial.prototype.fromSocialUserId = function (e) {
                return "FS_" + e
            }, cleverapps.FotoStranaSocial.prototype.toSocialUserId = function (e) {
                return e.substr(3)
            }, cleverapps.FotoStranaSocial.prototype._getUserID = function () {
                return this.fromSocialUserId(cleverapps.getRequestParameters().viewerId)
            }, cleverapps.FotoStranaSocial.prototype.getAccessToken = function () {
                return "FS_" + cleverapps.getRequestParameters().authKey
            }, cleverapps.FotoStranaSocial.prototype._login = function (e) {
                e()
            }, cleverapps.FotoStranaSocial.prototype._inviteFriends = function (e, t) {
                cleverapps.platform.exitFullscreen(function () {
                    FSClient.event("invite", function (e) {
                        t(e.send ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED)
                    })
                })
            }, cleverapps.FotoStranaSocial.prototype._request = function (e, t) {
                "object" != typeof e.to && (e.to = [e.to]);
                var s = [];
                e.to.forEach(function (e) {
                    s.push(this.toSocialUserId(e))
                }.bind(this)), cleverapps.platform.exitFullscreen(function () {
                    FSClient.event("sendMessageAndInvite", function (e) {
                        t(e.messSent || e.invSent ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED)
                    }, {
                        message: e.message,
                        customIds: s.join(",")
                    })
                })
            }, cleverapps.FotoStranaSocial.prototype._shareDialog = function (e, t) {
                cleverapps.platform.exitFullscreen(function () {
                    FSClient.event("postUserEventOnWall", function (e) {
                        t("success" === e.result ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED)
                    }, {
                        title: e.title,
                        text: e.description,
                        imgUrl: e.picture
                    })
                })
            }, cleverapps.FotoStranaSocial.prototype.loadUsersData = function (e, i) {
                e && e.length ? FSClient.api("User.getProfiles", {
                    userIds: e.join(","),
                    fields: "user_name, user_lastname, photo_small"
                }, function (e) {
                    var t = [];
                    if (e.response) {
                        for (var s in e.response) t.push(this.formatUserData(e.response[s]));
                        i(cleverapps.CODE_SUCCEED, t)
                    } else i(cleverapps.CODE_FAILED, t)
                }.bind(this)) : i(cleverapps.CODE_CANCELLED, [])
            }, cleverapps.FotoStranaSocial.prototype._listFriends = function (t) {
                FSClient.api("User.getAppFriends", {
                    appId: cleverapps.config.fotostrana.appId,
                    limit: 500
                }, function (e) {
                    this.loadUsersData(e.response, t)
                }.bind(this))
            }, cleverapps.FotoStranaSocial.prototype._listInvitableFriends = function (s) {
                FSClient.api("User.getFriends", {
                    limit: 200
                }, function (e) {
                    var t;
                    e.response && e.response.length && (t = e.response, FSClient.api("User.getAppFriends", {
                        appId: cleverapps.config.fotostrana.appId,
                        limit: 500
                    }, function (e) {
                        e.response && e.response.length && (t = cleverapps.substract(t, e.response)), this.loadUsersData(t, s)
                    }.bind(this)))
                }.bind(this))
            }, cleverapps.FotoStranaSocial.prototype.formatUserData = function (e) {
                return {
                    id: this.fromSocialUserId(e.user_id),
                    name: e.user_name + " " + e.user_lastname,
                    first_name: e.user_name,
                    picture: {
                        data: {
                            url: e.photo_small
                        }
                    }
                }
            }, cleverapps.FotoStranaSocial.prototype._aboutMe = function (s) {
                this.loadUsersData([this.toSocialUserId(cleverapps.platform.getUserID())], function (e, t) {
                    e === cleverapps.CODE_SUCCEED && t.length && s(t[0])
                })
            }, cleverapps.NoSocial = function () {
                console.log("Choosing without Social"), cleverapps.Social.call(this)
            },
            cleverapps.NoSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.NoSocial.prototype.constructor = cleverapps.NoSocial, cleverapps.NoSocial.prototype._connect = function (e) {
                e(Platform.STATUS_CONNECTED)
            }, cleverapps.DraugiemSocial = function () {
                console.log("Choosing html5-draugiem"), cleverapps.Social.call(this)
            }, cleverapps.DraugiemSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.DraugiemSocial.prototype.constructor = cleverapps.DraugiemSocial, cleverapps.DraugiemSocial.prototype._connect = function (i) {
                draugiem_callback_url = cleverapps.platform.getExternalUrl("cleverapps/res/callback.html"), draugiem_domain = "www.draugiem.lv";
                var n = function (e) {
                    this.accessToken = e, cleverapps.setUrlHash({
                        saved_token: e
                    }), this.api("userdata", {}, function (e, t) {
                        this.user = cleverapps.DraugiemSocial.formatUserData(cleverapps.values(t.users)[0]), i(e === cleverapps.CODE_SUCCEED ? Platform.STATUS_CONNECTED : Platform.STATUS_DISCONNECTED)
                    }.bind(this))
                }.bind(this),
                    o = cleverapps.getRequestParameters().dr_auth_code,
                    e = cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.DRAUGIEM_AUTH_DATA);
                e && e.code === o ? n(e.token) : this.api("authorize", {
                    code: o
                }, function (e, t) {
                    if (t && !t.error && t.apikey) this.accessToken = t.apikey, this.user = cleverapps.DraugiemSocial.formatUserData(t.users[t.uid]), cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.DRAUGIEM_AUTH_DATA, {
                        code: o,
                        token: this.accessToken
                    }), cleverapps.setUrlHash({
                        saved_token: this.accessToken
                    }), i(Platform.STATUS_CONNECTED);
                    else {
                        if (t && t.error && 106 === t.error.code) {
                            var s = cleverapps.getRequestParameters(window.location.hash).saved_token;
                            if (s) return void n(s)
                        }
                        s = JSON.stringify({
                            arguments: arguments,
                            auth_code: o
                        });
                        cleverapps.throwAsync("draugiem authorize empty result " + s), this.user = cleverapps.DraugiemSocial.formatUserData({
                            uid: "1"
                        }), i(Platform.STATUS_DISCONNECTED)
                    }
                }.bind(this))
            }, cleverapps.DraugiemSocial.prototype.api = function (e, t, s) {
                t.action = e, this.accessToken && (t.apikey = this.accessToken), cleverapps.RestClient.post("/draugiem", t, function (e) {
                    e.error ? (console.log("Error response: ", e), s(cleverapps.CODE_FAILED, e)) : (console.log("Success api response: ", e), s(cleverapps.CODE_SUCCEED, e))
                })
            }, cleverapps.DraugiemSocial.prototype.isLoggedIn = function () {
                return !0
            }, cleverapps.DraugiemSocial.prototype._getUserID = function () {
                return this.user && this.user.id
            }, cleverapps.DraugiemSocial.prototype.getAccessToken = function () {
                return "DRG_" + this.accessToken
            }, cleverapps.DraugiemSocial.prototype._login = function (e) {
                e()
            }, cleverapps.DraugiemSocial.prototype.sendActivity = function (e, t) {
                this.lastActivitySent && Date.now() - this.lastActivitySent < cleverapps.parseInterval("1 day") || (e = cleverapps.Social.ACTIVITIES_CONFIG[e]).probability > Math.random() && (e = cleverapps.Random.mathChoose(e.messages), e = {
                    prefix: Messages.get(e.title),
                    text: Messages.get(e.body, t),
                    link: cleverapps.config.deployment
                }, cleverapps.social.api("add_activity", e, function (e, t) {
                    t && "OK" === t.status && (this.lastActivitySent = Date.now())
                }.bind(this)))
            },
            cleverapps.DraugiemSocial.prototype._inviteFriends = function (e, t) {
                draugiemSendInvite(e.message, "", function (e) {
                    t(e ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED)
                })
            }, cleverapps.DraugiemSocial.prototype.requestToOne = function (t, s, i) {
                cleverapps.platform.exitFullscreen(function () {
                    var e = s.message + "\n" + cleverapps.platform.getGameUrl();
                    draugiemSendMessage(t, s.title, e, function (e) {
                        i(e ? cleverapps.CODE_SUCCEED : cleverapps.CODE_FAILED)
                    })
                })
            }, cleverapps.DraugiemSocial.prototype._request = function (e, s) {
                var i = e.to,
                    n = (Array.isArray(i) || (i = [i]), []),
                    o = function (t) {
                        t === i.length ? s(0 < n.length ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED, n) : this.requestToOne(i[t], e, function (e) {
                            e === cleverapps.CODE_SUCCEED && n.push(i[t]), setTimeout(function () {
                                o(t + 1)
                            }, 500)
                        })
                    }.bind(this);
                o(0)
            }, cleverapps.DraugiemSocial.prototype._shareDialog = function (e, t) {
                cleverapps.platform.exitFullscreen(function () {
                    draugiemSay(e.name, cleverapps.platform.getGameUrl(), Messages.get("PlayNow"), e.description, function (e) {
                        t(
                            e ? cleverapps.CODE_SUCCEED : cleverapps.CODE_FAILED)
                    })
                })
            }, cleverapps.DraugiemSocial.prototype.listFriendsByApp = function () { }, cleverapps.DraugiemSocial.prototype._listFriends = function (s) {
                this.api("app_friends", {}, function (e, t) {
                    e === cleverapps.CODE_SUCCEED ? (e = [], 0 < t.total && (e = cleverapps.values(t.users).map(cleverapps.DraugiemSocial.formatUserData)), s(cleverapps.CODE_SUCCEED, e)) : s(cleverapps.CODE_FAILED)
                })
            }, cleverapps.DraugiemSocial.prototype._listInvitableFriends = function (e) {
                e()
            }, cleverapps.DraugiemSocial.formatUserData = function (e) {
                return {
                    id: "" + e.uid,
                    name: e.surname + " " + e.name,
                    first_name: e.name,
                    picture: {
                        data: {
                            url: e.img
                        }
                    }
                }
            }, cleverapps.DraugiemSocial.prototype._aboutMe = function (e) {
                e(this.user)
            }, cleverapps.YandexSocial = function () {
                console.log("Choosing html5-yandex"), cleverapps.Social.call(this), this.canReviewGame = !1, ["tripeaks", "fairy", "mergecraft"].includes(cleverapps.config.name) || (cleverapps.config.debugMode = !1)
            }, cleverapps.YandexSocial.prototype = Object.create(cleverapps.Social.prototype),
            cleverapps.YandexSocial.prototype.constructor = cleverapps.YandexSocial, cleverapps.YandexSocial.prototype._connect = function (e) {
                this.initPlayer(), e(Platform.STATUS_CONNECTED)
            }, cleverapps.YandexSocial.prototype.initPlayer = function () {
                var e = cleverapps.platform.player;
                this.playerMode = e.getMode(), this.accessToken = e.signature, "lite" !== this.playerMode ? (this.user = cleverapps.YandexSocial.formatUserData(e), console.log(this.user)) : delete this.user
            }, cleverapps.YandexSocial.prototype._login = function (t) {
                cleverapps.platform.ysdk.auth.openAuthDialog().then(function () {
                    cleverapps.platform.initPlayer(function (e) {
                        e !== cleverapps.CODE_FAILED && (this.initPlayer(), "lite" === this.playerMode && delete this.user), t()
                    }.bind(this))
                }.bind(this)).catch(t)
            }, cleverapps.YandexSocial.prototype.isLoggedIn = function () {
                return void 0 !== this.user
            }, cleverapps.YandexSocial.prototype._getUserID = function () {
                return this.user ? this.user.id : void 0
            }, cleverapps.YandexSocial.prototype.getAccessToken = function () {
                return "YA_" + (this.accessToken || 0)
            }, cleverapps.YandexSocial.prototype._aboutMe = function (e) {
                this.user && e(this.user)
            }, cleverapps.YandexSocial.formatUserData = function (e) {
                return {
                    id: e.getUniqueID(),
                    name: e.getName(),
                    first_name: e.getName(),
                    picture: {
                        data: {
                            url: e.getPhoto("small")
                        }
                    }
                }
            }, cleverapps.MygamesSocial = function () {
                console.log("Choosing mygames social"), cleverapps.Social.call(this)
            }, cleverapps.MygamesSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.MygamesSocial.prototype.constructor = cleverapps.MygamesSocial, cleverapps.MygamesSocial.prototype._connect = function (t) {
                var e = new URLSearchParams(window.location.search),
                    s = new URLSearchParams;
                s.set("uid", "" + e.get("sz_pers_id")), s.set("otp", "" + e.get("sz_token")), cleverapps.RestClient.get("/mygames/auth?" + s.toString(), {}, function (e) {
                    e.error ? (console.log("Auth error", e), t(Platform.STATUS_DISCONNECTED)) : (this.user = cleverapps.MygamesSocial.formatUserData(e), t(Platform.STATUS_CONNECTED))
                }.bind(this), function (e) {
                    console.log("Auth error", e), t(
                        Platform.STATUS_DISCONNECTED)
                })
            }, cleverapps.MygamesSocial.prototype.isLoggedIn = function () {
                return void 0 !== this.user
            }, cleverapps.MygamesSocial.prototype.getAccessToken = function () {
                return "mygames"
            }, cleverapps.MygamesSocial.prototype._getUserID = function () {
                return this.user && this.user.id
            }, cleverapps.MygamesSocial.prototype._shareDialog = function (e, t) {
                e = {
                    uid: cleverapps.platform.getUserID(),
                    title: e.name,
                    img: e.picture
                };
                cleverapps.RestClient.post("/mygames/share", e, function (e) {
                    "ok" === e.status ? t(cleverapps.CODE_SUCCEED) : t(cleverapps.CODE_FAILED)
                }, function () {
                    t(cleverapps.CODE_FAILED)
                })
            }, cleverapps.MygamesSocial.prototype._aboutMe = function (e) {
                this.user && e(this.user)
            }, cleverapps.MygamesSocial.formatUserData = function (e) {
                return {
                    id: "" + e.uid,
                    name: e.nick,
                    first_name: e.nick,
                    slug: e.slug,
                    picture: {
                        data: {
                            url: e.avatar
                        }
                    }
                }
            }, cleverapps.WechatSocial = function () {
                console.log("Choosing WechatSocial"), cleverapps.Social.call(this), this.pingThrottled = cleverapps.timeredThrottle(1e4, function () {
                    cleverapps.platform.isConnected(Platform.SOCIAL) && this.ping()
                }.bind(this)), cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, this.pingThrottled.bind(this)), cleverapps.timeouts.setInterval(this.pingThrottled.bind(this), cleverapps.parseInterval("1 minute"))
            }, cleverapps.WechatSocial.prototype = Object.create(cleverapps.Social.prototype), cleverapps.WechatSocial.prototype.constructor = cleverapps.WechatSocial, cleverapps.WechatSocial.prototype._connect = function (t) {
                this.ping(function (e) {
                    e === cleverapps.CODE_SUCCEED ? t(Platform.STATUS_CONNECTED) : t(Platform.STATUS_DISCONNECTED)
                })
            }, cleverapps.WechatSocial.prototype._login = function (e) {
                this.ping(e)
            }, cleverapps.WechatSocial.prototype._getUserID = function () {
                return this.userId
            }, cleverapps.WechatSocial.prototype.isLoggedIn = function () {
                return Boolean(this.userId)
            }, cleverapps.WechatSocial.prototype.getAccessToken = function () {
                return "wechat"
            }, cleverapps.WechatSocial.prototype.ping = function (t) {
                var a, e = new ActionPlayer([function (e) {
                    this.userId ? wx.checkSession({
                        success: function () {
                            console.log("wx checkSession success"), t && t(cleverapps.CODE_SUCCEED)
                        },
                        fail: function () {
                            console.log("wx checkSession fail"), e()
                        }
                    }) : e()
                }.bind(this), function (t, s) {
                    wx.login({
                        success: function (e) {
                            console.log("login success", e), a = e && e.code, t()
                        },
                        fail: function (e) {
                            cleverapps.config.debugMode && cleverapps.notification.create("login - " + JSON.stringify(e)), console.log("login fail", e), s()
                        }
                    })
                }, function (s, e) {
                    function i() {
                        n <= 0 ? e() : cleverapps.timeouts.setTimeout(o, 3e3)
                    }
                    var t = "/wechat/code2session/" + encodeURIComponent(cleverapps.platform.getUserID()) + "/" + encodeURIComponent(a),
                        n = 3,
                        o = function () {
                            n--, cleverapps.RestClient.get(t, {}, function (e) {
                                var t = e && e.openid;
                                if (e.errmsg || e.errcode || !t) return e = "code2Session error - " + (e.errmsg || e.errcode || "empty openid"), cleverapps.config.debugMode && cleverapps.notification.create(e), console.log(e), void i();
                                console.log("code2Session", t), this.userId = t, cleverapps.platform.isConnected(Platform.SOCIAL) && cleverapps.platform.haveTmpId() && this.onLogin(), s()
                            }.bind(
                                this), function (e) {
                                    cleverapps.config.debugMode && cleverapps.notification.create("code2session request error"), console.log("code2Session fail", e), i()
                                })
                        }.bind(this);
                    o()
                }.bind(this)]);
                e.onFailure(function () {
                    cleverapps.throwAsync("wechat login failure"), t && t(cleverapps.CODE_FAILED)
                }), e.play(function () {
                    t && t(cleverapps.CODE_SUCCEED)
                })
            }, cleverapps.WechatSocial.prototype.getUserInfo = function (e) {
                var i, t = new ActionPlayer([function (t, s) {
                    wx.getSetting({
                        success: function (e) {
                            console.log("getSetting - " + JSON.stringify(e)), i = e.authSetting, t()
                        },
                        fail: function (e) {
                            console.log("getSetting fail - " + JSON.stringify(e)), s()
                        }
                    })
                }, function (t, s) {
                    i["scope.userInfo"] ? t() : wx.authorize({
                        scope: "scope.userInfo",
                        success: function (e) {
                            console.log("authorize - " + JSON.stringify(e)), t()
                        },
                        fail: function (e) {
                            console.log("authorize fail - " + JSON.stringify(e)), s()
                        }
                    })
                }, function (t, s) {
                    wx.getUserInfo({
                        success: function (e) {
                            console.log("getUserInfo - " + JSON.stringify(e)), this.userInfo = e.userInfo, t()
                        }.bind(this),
                        fail: function (e) {
                            console.log(
                                "getUserInfo fail - " + JSON.stringify(e)), s()
                        }
                    })
                }.bind(this)]);
                t.onComplete(e), t.play()
            }, cleverapps.WechatSocial.prototype._aboutMe = function (e) {
                this.userInfo && e({
                    name: this.userInfo.nickName,
                    first_name: this.userInfo.nickName
                })
            },
            function () {
                function e() {
                    cc.sys.os = cleverapps.platform.info.os, cc.sys.isMobile = cleverapps.platform.info.isMobile, cc.sys.isNative = cleverapps.platform.info.isNative, cc.sys.isInApp = cleverapps.platform.info.isInApp, cc.sys.language = cleverapps.platform.info.language
                }
                cleverapps.platform.info.on("changed", e), e(), cc.sys.isNative && new URLSearchParams(window.location.search).has("source") && (cc.sys.isNativeFlight = !0)
            }),
        WechatLogic = (PlatformLogic.prototype.onInitialize = function () { }, PlatformLogic.prototype.onStart = function () { }, PlatformLogic.create = function () {
            return new ({
                wechat: WechatLogic,
                apple: AppleLogic,
                instant: InstantLogic,
                msstart: MSStartLogic,
                web_ok: OKLogic,
                mobile_ok: MobileOKLogic,
                yandex: YandexLogic
            }[cleverapps.platform.source] || PlatformLogic)
        }, cc.sys.LANGUAGE_LATVIAN = "lv",
            cc.sys.LANGUAGE_TURKISH = "tr", cc.sys.LANGUAGE_DUTCH = "nl",
            function () {
                PlatformLogic.call(this)
            }),
        AppleLogic = (WechatLogic.prototype = Object.create(PlatformLogic.prototype), (WechatLogic.prototype.constructor = WechatLogic).prototype.onInitialize = function () {
            cleverapps.config.sendLoadingTime = cleverapps.config.debugMode, cc.sys.isDevTools = "devtools" === wx.getSystemInfoSync().platform, cc.sys.isDevTools && (cc.assetManager.downloader.register(".png", cc.assetManager.downloader.downloadDomImage), cc.assetManager.downloader.register(".jpg", cc.assetManager.downloader.downloadDomImage), cc.assetManager.parser.register(".png", cc.assetManager.parser.parseImage), cc.assetManager.parser.register(".jpg", cc.assetManager.parser.parseImage)), cc.assetManager.cacheManager.cachedFiles.forEach(function (e, t) {
                t.includes(cleverapps.config.version) || cc.assetManager.cacheManager.removeCache(t)
            })
        }, WechatLogic.prototype.onStart = function () {
            cleverapps.resolution.setSafePadding(
                cleverapps.styles.Wechat.padding[cleverapps.platform.getOrientation()])
        }, cleverapps.styles.Wechat = {
            padding: {
                landscape: {
                    right: 260
                },
                portrait: {
                    top: 120
                }
            }
        }, function () {
            PlatformLogic.call(this)
        }),
        InstantLogic = (AppleLogic.prototype = Object.create(PlatformLogic.prototype), (AppleLogic.prototype.constructor = AppleLogic).prototype.onInitialize = function () {
            WebViewConsole.init()
        }, function () {
            PlatformLogic.call(this), cleverapps.platform.on("changeStatus:" + Platform.PLATFORM, function (e) {
                e === Platform.STATUS_CONNECTED && (console.log("Request entrypoint"), FBInstant.getEntryPointAsync().then(function (e) {
                    cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.ENTRY_POINT + (e || "empty")), cleverapps.config.debugMode && (console.log("Instant entrypoint: " + e), setTimeout(function () {
                        cleverapps.notification.create("Instant entrypoint: " + e)
                    }, 2e3))
                }), FBInstant.player.getASIDAsync().then(function (e) {
                    console.log("Instant ASID: " + e), e && cleverapps.info.setKeyValue("asid", e, !0)
                }), cleverapps.eventLogger.logEvent(
                    cleverapps.EVENTS.STATS.INSTANT.LOCALE + (FBInstant.getLocale() || "empty")), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.PLATFORM + (FBInstant.getPlatform() || "empty")), (e = FBInstant.getEntryPointData() || {}).push_code && cleverapps.localPushes.logClickEvent(e.push_code))
            })
        }),
        OKLogic = (InstantLogic.prototype = Object.create(PlatformLogic.prototype), InstantLogic.prototype.constructor = InstantLogic, function () {
            PlatformLogic.call(this), cleverapps.platform.on("changeStatus:" + Platform.PLATFORM, function (e) {
                e === Platform.STATUS_CONNECTED && this.logPushes()
            }.bind(this))
        }),
        MobileOKLogic = (OKLogic.prototype = Object.create(PlatformLogic.prototype), (OKLogic.prototype.constructor = OKLogic).prototype.logPushes = function () {
            var e, t = FAPI.Util.getRequestParameters(),
                s = cleverapps.getRequestParameters("?" + t.custom_args).push_code,
                t = t.custom_args,
                i = s ? cleverapps.LocalPushes.GetTypeByCode(s) : cleverapps.LocalPushes.GetTypeById(t);
            i && (e = s && cleverapps.EVENTS.STATS.PUSHES.CLICK_ANDROID,
                cleverapps.localPushes.logClickEvent(i.code, e), !s && t && cleverapps.platform.oneOf(MobileOK) && cleverapps.eventLogger.logEvent(cleverapps.platform.info.os === PlatformInfo.OS_ANDROID ? cleverapps.EVENTS.STATS.PUSHES.ANDROID_OK_CLICK : cleverapps.EVENTS.STATS.PUSHES.MOBILE_OK_CLICK))
        }, function () {
            OKLogic.call(this)
        }),
        MSStartLogic = (MobileOKLogic.prototype = Object.create(OKLogic.prototype), MobileOKLogic.prototype.constructor = MobileOKLogic, function () {
            PlatformLogic.call(this), cleverapps.platform.on("changeStatus:" + Platform.PLATFORM, function (e) {
                e === Platform.STATUS_CONNECTED && this.logPushes()
            }.bind(this))
        }),
        YandexLogic = (MSStartLogic.prototype = Object.create(PlatformLogic.prototype), (MSStartLogic.prototype.constructor = MSStartLogic).prototype.logPushes = function () {
            var e = cleverapps.getRequestParameters(),
                e = e && e.notificationPayload && JSON.parse(e.notificationPayload).push_code,
                e = e && cleverapps.LocalPushes.GetTypeByCode(e);
            e && cleverapps.localPushes.logClickEvent(e.code)
        }, function () {
            PlatformLogic.call(this),
                cleverapps.platform.on("changeStatus:" + Platform.PLATFORM, function (e) {
                    e === Platform.STATUS_CONNECTED && this.logPushes()
                }.bind(this))
        }),
        SimpleDataLoader = (YandexLogic.prototype = Object.create(PlatformLogic.prototype), (YandexLogic.prototype.constructor = YandexLogic).prototype.logPushes = function () {
            var e;
            "lite" !== cleverapps.platform.player.getMode() && (e = cleverapps.platform.ysdk.environment.payload && JSON.parse(cleverapps.platform.ysdk.environment.payload), console.log(e), e && e.push_code && cleverapps.localPushes.logClickEvent(e.push_code))
        }, function () {
            this.localStorage = window.localStorage, this.data = {}
        }),
        PlatformInfo = (SimpleDataLoader.prototype.load = function (e) {
            this.data.hasOwnProperty(e) || (this.data[e] = this.localStorage.getItem(e));
            e = this.data[e];
            if (null != e && "undefined" !== e && !(cleverapps.platform instanceof Wechat && "" === e)) return JSON.parse(e)
        }, SimpleDataLoader.prototype.save = function (e, t) {
            t = JSON.stringify(t);
            this.data[e] = t, this.localStorage.setItem(e, t)
        }, SimpleDataLoader.prototype.remove = function (e) {
            delete this.data[e], this.localStorage.removeItem(e)
        }, SimpleDataLoader.INIT_TYPES = function (e) {
            for (var t in SimpleDataLoader.TYPES) SimpleDataLoader.TYPES[t] = e + SimpleDataLoader.TYPES[t]
        }, SimpleDataLoader.TYPES = {
            USER_ID: "_user_id",
            SHORTCUT_CREATED: "_instant_shortcut_created",
            FRIENDS: "_friends",
            INVITABLE_FRIENDS: "_invitable_friends",
            PAYMENTS_HISTORY: "_my_payments",
            AD_WATCH_COUNTER: "_adviews",
            DRAUGIEM_AUTH_DATA: "_draugiem_auth_data",
            XSOLLA_ACCESS_TOKEN: "_xsolla_access_token",
            APPLE_SOCIAL: "_apple_social",
            MS_SOCIAL: "_ms_social",
            PAYMENTS_COUNTRY: "_payments_country",
            XSOLLA2_PAYMENTS_AUTH: "_xsolla2_payments_auth",
            PAYMENTS: "_payments",
            PREROLL_PLAYED: "_preroll_played"
        }, function (e) {
            cleverapps.EventEmitter.call(this), this.isMobile = this._detectMobile(e), this.isNative = this._detectNative(e), this.os = this._detectOS(), this.isInApp = !1, this.language = this._detectLanguage()
        }),
        Platform = (PlatformInfo.prototype = Object.create(cleverapps.EventEmitter.prototype), (PlatformInfo.prototype.constructor = PlatformInfo).nativePlatforms = ["microsoft", "gpg", "mygames", "macos"], PlatformInfo.nativeMobilePlatforms = ["android", "amazon", "ios", "pliega", "rustore", "ios_ch"], PlatformInfo.prototype.setInfo = function (e) {
            void 0 !== e.os && (this.os = e.os), void 0 !== e.isMobile && (this.isMobile = e.isMobile), void 0 !== e.isInApp && (this.isInApp = e.isInApp), void 0 !== e.language && (this.language = e.language), this.trigger("changed")
        }, PlatformInfo.prototype._detectLanguage = function () {
            var e = window.navigator.language || window.navigator.browserLanguage;
            return e ? "du" === (e = e.split("-")[0]) ? PlatformInfo.LANGUAGE_DUTCH : e : PlatformInfo.LANGUAGE_ENGLISH
        }, PlatformInfo.prototype._detectMobile = function (e) {
            if (PlatformInfo.nativeMobilePlatforms.includes(e)) return !0;
            e = window.navigator.userAgent.toLowerCase();
            return /mobile|android|iphone|ipad/.test(e)
        }, PlatformInfo.prototype._detectNative = function (e) {
            return PlatformInfo.nativePlatforms.includes(e) || PlatformInfo.nativeMobilePlatforms.includes(e)
        }, PlatformInfo.prototype._detectOS = function () {
            var e = window.navigator,
                t = e.userAgent.toLowerCase(),
                s = !1,
                i = !1,
                t = ((/android (\d+(?:\.\d+)+)/i.exec(t) || /android (\d+(?:\.\d+)+)/i.exec(e.platform)) && (s = !0), (/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(t) || /(iPhone|iPad|iPod)/.exec(e.platform)) && (i = !0), PlatformInfo.OS_UNKNOWN);
            return -1 !== e.appVersion.indexOf("Win") ? t = PlatformInfo.OS_WINDOWS : i ? t = PlatformInfo.OS_IOS : -1 !== e.appVersion.indexOf("Mac") ? t = PlatformInfo.OS_OSX : -1 !== e.appVersion.indexOf("X11") && -1 === e.appVersion.indexOf("Linux") ? t = PlatformInfo.OS_UNIX : s ? t = PlatformInfo.OS_ANDROID : -1 !== e.appVersion.indexOf("Linux") && (t = PlatformInfo.OS_LINUX), t
        }, PlatformInfo.OS_UNKNOWN = "Unknown", PlatformInfo.OS_WINDOWS = "Windows", PlatformInfo.OS_IOS = "iOS", PlatformInfo.OS_OSX = "OS X", PlatformInfo.OS_UNIX = "Unix", PlatformInfo.OS_ANDROID = "Android", PlatformInfo.OS_LINUX = "Linux", PlatformInfo.LANGUAGE_ENGLISH = "en", PlatformInfo.LANGUAGE_CHINESE = "zh", PlatformInfo.LANGUAGE_FRENCH = "fr", PlatformInfo.LANGUAGE_ITALIAN = "it", PlatformInfo.LANGUAGE_GERMAN = "de",
            PlatformInfo.LANGUAGE_SPANISH = "es", PlatformInfo.LANGUAGE_DUTCH = "nl", PlatformInfo.LANGUAGE_RUSSIAN = "ru", PlatformInfo.LANGUAGE_KOREAN = "ko", PlatformInfo.LANGUAGE_JAPANESE = "ja", PlatformInfo.LANGUAGE_HUNGARIAN = "hu", PlatformInfo.LANGUAGE_PORTUGUESE = "pt", PlatformInfo.LANGUAGE_ARABIC = "ar", PlatformInfo.LANGUAGE_NORWEGIAN = "no", PlatformInfo.LANGUAGE_POLISH = "pl", PlatformInfo.LANGUAGE_LATVIAN = "lv", PlatformInfo.LANGUAGE_TURKISH = "tr",
            function (e, t) {
                if (console.log("Choosing " + t + " platform"), cleverapps.EventEmitter.call(this), this._createLocalStorage(), this.config = e.config, SimpleDataLoader.INIT_TYPES(this.config.name + this.getLocalStoragePreffix()), this.dataLoader = e.dataLoader || new SimpleDataLoader, this.source = t, this.status = {}, this.status[Platform.PLATFORM] = void 0, this.plugins = {}, this.pluginCreators = {}, this.callbacks = {}, this.nativeEventListeners = {}, !this.oneOf(Amazon, AndroidPlatform, IOS, MacOS, FacebookCanvas, GPG, Instant, Microsoft, Ton, WortalPlatform, Mygames, Xiaomi) && "" === this.getLocalStoragePreffix()) throw "Not specified local storage prefix";
                this.info = new PlatformInfo(t), this.device = {}, cleverapps.isLocalhost() && (this.device.idfa = "localhostIDFA"), this.initGameEvents()
            }),
        PlatformManager = (Platform.prototype = Object.create(cleverapps.EventEmitter.prototype), (Platform.prototype.constructor = Platform).prototype._createLocalStorage = function () {
            try {
                this.localStorage = window.localStorage, this.localStorage.setItem("storage", ""), this.localStorage.removeItem("storage")
            } catch (e) {
                function t() {
                    console.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option")
                }
                this.localStorage = {
                    getItem: t,
                    setItem: t,
                    removeItem: t,
                    clear: t
                }
            }
        }, Platform.prototype.getHelpUrl = function () {
            switch (this.source) {
                case "web_ok":
                    return "https://ok.ru/group/" + cleverapps.config.ok.groupId;
                case "mobile_ok":
                    return "https://m.ok.ru/group/" + cleverapps.config.ok.groupId;
                case "web_vk":
                    return "https://vk.com/" + cleverapps.config.vk.groupId;
                case "mobile_vk":
                    return "https://m.vk.com/" + cleverapps.config.vk.groupId;
                case "web_mm":
                    return "https://my.mail.ru/community/" + cleverapps.config.mm.groupId;
                case "mobile_mm":
                    return "https://m.my.mail.ru/community/" + cleverapps.config.mm.groupId;
                case "mbga":
                    return "http://yahoo-mbga.jp/group/" + cleverapps.config.mbga.groupId;
                case "sp_mbga":
                    return "http://sp.mbga.jp/_grp_view?g=" + cleverapps.config.mbga.groupId;
                case "draugiem":
                    return "https://www.draugiem.lv/" + cleverapps.config.draugiem.groupId;
                case "fotostrana":
                    return "https://fotostrana.ru/public/" + cleverapps.config.fotostrana.groupId;
                default:
                    return cleverapps.config.instant.groupId ? "https://www.facebook.com/" + cleverapps.config.instant.groupId : "https://www.facebook.com/" + cleverapps.config.facebook.groupId
            }
        }, Platform.prototype.getGameUrl = function (e) {
            return Platform.guessPlatformURL(cleverapps.config, cleverapps.config.debugMode, e || this.source)
        }, Platform.prototype.getRateUrl = function () {
            switch (this.source) {
                case "test":
                    return Platform.guessPlatformURL(cleverapps.config, !0, "android");
                case "android":
                    return "market://details?id=" + cleverapps.config.android.package;
                case "amazon":
                    return "amzn://apps/android?p=" + cleverapps.config.amazon.package;
                case "macos":
                case "ios":
                    return "itms-apps://itunes.apple.com/app/id" + cleverapps.config.ios.id
            }
        }, Platform.prototype.getExternalUrl = function (e) {
            return "/" === e[0] && (e = e.substr(1)), this instanceof TestPlatform || this instanceof Instant ? e : cleverapps.config.deployment + "/" + e
        }, Platform.prototype.followOfficialPage = function () {
            cleverapps.platform.isConnected(Platform.PLATFORM) && this._followOfficialPage()
        }, Platform.prototype._followOfficialPage = function () { }, Platform.prototype.showOfficialPage = function () {
            cc.sys.openURL(this.getHelpUrl())
        }, Platform.prototype.canNativeInvite = function () {
            return this instanceof Apple || this instanceof AndroidBase
        }, Platform.prototype.inviteFriends = function (e) {
            var t = {
                message: Messages.get("InviteFriends.message"),
                title: Messages.get(cleverapps.config.title)
            };
            this.canNativeInvite() ? this.callNative("MessagesPlugin.inviteFriends", {
                title: t.title,
                message: t.message,
                link: this.getExternalUrl("res/applink.html")
            }, e) : cleverapps.social.checkConnection(function () {
                cleverapps.social.inviteFriends(t, e)
            }, function () {
                e(cleverapps.CODE_FAILED)
            })
        }, Platform.prototype.registerPlugin = function (e, t) {
            this.pluginCreators[e] = t, this.plugins[e] = t(), this.status[e] = void 0
        }, Platform.prototype.updatePlugin = function (e) {
            var t = this.pluginCreators[e]();
            t !== this.plugins[e] && (this.plugins[e] = t, this.status[e] = void 0, this.connect())
        }, Platform.prototype.isConnected = function (e) {
            return this.status[e] === Platform.STATUS_CONNECTED
        }, Platform.prototype.setStatus = function (e, t) {
            t = t || Platform.STATUS_DISCONNECTED, this.status[e] !== t && (console.log("Platform.setStatus", e, t), this.status[e] = t, this.trigger("changeStatus:" + e, t))
        }, Platform.prototype.disconnect = function () {
            for (var e in this.setStatus(Platform.PLATFORM, Platform.STATUS_DISCONNECTED), this.plugins) this.disconnectPlugin(e)
        }, Platform.prototype.disconnectPlugin = function (e) {
            this.plugins[e] && this.setStatus(e,
                Platform.STATUS_DISCONNECTED)
        }, Platform.prototype._loadUserId = function () {
            this._userID = this.dataLoader.load(SimpleDataLoader.TYPES.USER_ID), this._userID || this.setUserID(this.generateTmpId())
        }, Platform.prototype.setUserID = function (e) {
            var t;
            this._userID !== e && (console.log("Platform.setUserID", this._userID, e), t = this._userID, this._userID = e, this.dataLoader.save(SimpleDataLoader.TYPES.USER_ID, this._userID), this.trigger("userIdChanged", {
                oldId: t,
                newId: e
            }))
        }, Platform.prototype.getUserID = function () {
            return this._userID
        }, Platform.prototype.initialize = function (e) {
            this._initialize(function () {
                this._loadUserId(), e()
            }.bind(this))
        }, Platform.prototype._initialize = function (e) {
            e()
        }, Platform.prototype.start = function () {
            this.started = !0, this.connect()
        }, Platform.prototype.connect = function () {
            if (this.started && !this.connecting) {
                var e, t = "";
                for (e in this.status) t += " " + e + ":" + this.status[e];
                console.log("Platform.connect" + t), this.isConnected(Platform.PLATFORM) ? this._connectPlugins() : (this.connecting = !0, this._connect(
                    cleverapps.waitNoMore(Platform.WAIT_CONNECT_TIMEOUT, function (e) {
                        this.connecting = !1, this.setStatus(Platform.PLATFORM, e), this._connectPlugins()
                    }.bind(this))))
            }
        }, Platform.prototype._connectPlugins = function () {
            var e, t = function (e) {
                var t = this.plugins[e];
                !t || this.isConnected(e) || t.connecting || (this.isConnected(Platform.PLATFORM) || t.withSdk ? this.connectPlugin(e) : this.setStatus(e, Platform.STATUS_DISCONNECTED))
            }.bind(this);
            for (e in this.plugins) t(e)
        }, Platform.prototype.connectPlugin = function (t) {
            this.plugins[t].connect(function (e) {
                this.setStatus(t, e)
            }.bind(this))
        }, Platform.prototype._connect = function (e) {
            e(Platform.STATUS_CONNECTED)
        }, Platform.prototype.generateTmpId = function () {
            return "__" + Math.floor(1e15 * Math.random())
        }, Platform.prototype.haveTmpId = function () {
            return Platform.isTmpId(this._userID)
        }, Platform.isTmpId = function (e) {
            return e && 2 <= e.length && "__" === e.substr(0, 2)
        }, Platform.prototype.haveDeviceId = function () {
            return Platform.isDeviceId(this._userID)
        }, Platform.isDeviceId = function (e) {
            var t = cleverapps.platform.getDeviceId();
            return t && e === t
        }, Platform.prototype.getDeviceId = function () { }, Platform.prototype.canReview = function () {
            return !1
        }, Platform.prototype.getLocalStoragePreffix = function () {
            return ""
        }, Platform.prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_ENGLISH]
        }, Platform.prototype.needWindowForLogin = function () {
            return !1
        }, Platform.prototype.requestReview = function () {
            cleverapps.platform.isConnected(Platform.PLATFORM) && this._requestReview()
        }, Platform.prototype._requestReview = function () { }, Platform.prototype.canCreateShortcut = function () {
            return !!this.isConnected(Platform.PLATFORM) && this._canCreateShortcut()
        }, Platform.prototype._canCreateShortcut = function () {
            return !1
        }, Platform.prototype.createShortcut = function () { }, Platform.prototype.reportScore = function (e, t) {
            cleverapps.platform.isConnected(Platform.PLATFORM) ? this._reportScore(e, t) : t()
        }, Platform.prototype._reportScore = function (e, t) {
            t()
        }, Platform.prototype.getCurrentTournamentId = function (e) {
            e()
        },
            Platform.prototype.getAccessToken = function () { }, Platform.prototype.isFullscreenAvailable = function () {
                return !(this.info.isNative || this.info.isMobile || cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL || cleverapps.platform.oneOf(Instant)) && !!this.getFullscreener()
            }, Platform.prototype.getFullscreener = function () {
                var e = document.documentElement,
                    t = e.requestFullscreen || e.webkitRequestFullscreen || e.msRequestFullscreen || e.mozRequestFullscreen;
                if (t) return t.bind(e)
            }, Platform.prototype.goFullscreen = function () {
                var e;
                this.isFullScreen() || (e = this.getFullscreener()) && e()
            }, Platform.prototype.exitFullscreen = function (e) {
                this.isFullscreenAvailable() && this.isFullScreen() ? (document.exitFullscreen ? document.exitFullscreen() : document.webkitExitFullscreen ? document.webkitExitFullscreen() : document.msExitFullscreen ? document.msExitFullscreen() : document.mozExitFullscreen && document.mozExitFullscreen(), e && setTimeout(e, 100)) : e && e()
            }, Platform.prototype.isFullScreen = function () {
                return document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement || document.mozFullscreenElemen
            }, Platform.prototype.toggleFullScreen = function () {
                this.isFullScreen() ? this.exitFullscreen() : this.goFullscreen()
            }, Platform.prototype.oneOf = function (e) {
                return cleverapps.oneOf(this, Array.isArray(e) ? e : Array.prototype.slice.call(arguments))
            }, Platform._parseChannel = function (e, t) {
                t = cleverapps.getRequestParameters(t || location.search);
                if (t.custom_args) {
                    var s = "";
                    try {
                        s = decodeURIComponent(t.custom_args)
                    } catch (e) {
                        cleverapps.throwAsync("calcChannel decodeURIComponent error, params.custom_args - " + t.custom_args)
                    }
                    0 <= s.indexOf(e) && (t = cleverapps.getRequestParameters("?" + s))
                }
                return t[e] || ""
            }, Platform.prototype.calcChannel = function (e) {
                this.info.isNative ? e("") : e(Platform._parseChannel("channel"))
            }, Platform.prototype.showBannerAd = function (e) {
                cleverapps.platform.isConnected(Platform.PLATFORM) ? this._showBannerAd.apply(this, arguments) : e(cleverapps.CODE_FAILED)
            },
            Platform.prototype._showBannerAd = function (e) {
                e()
            }, Platform.prototype.refreshBannerAd = function (e) {
                cleverapps.platform.isConnected(Platform.PLATFORM) ? this._refreshBannerAd(e) : e(cleverapps.CODE_FAILED)
            }, Platform.prototype._refreshBannerAd = function (e) {
                e()
            }, Platform.prototype.hideBannerAd = function (e) {
                cleverapps.platform.isConnected(Platform.PLATFORM) ? this._hideBannerAd(e) : e(cleverapps.CODE_FAILED)
            }, Platform.prototype._hideBannerAd = function (e) {
                e()
            }, Platform.DecodeWebViewData = function (t) {
                if (t) try {
                    return decodeURIComponent(t)
                } catch (e) {
                    return t
                }
                return t
            }, Platform.prototype.nativeEvent = function (e, t) {
                this.oneOf(AndroidBase, Apple, Microsoft) && (t = (t = Platform.DecodeWebViewData(t)) && JSON.parse(t)), console.log("Platform.nativeEvent " + e + ": " + JSON.stringify(t));
                var s = e.split(".")[0],
                    e = e.split(".")[1];
                this.nativeEventListeners[s] && this.nativeEventListeners[s](e, t)
            }, Platform.prototype.callNative = function (e, t, s) {
                s || "function" != typeof t || (s = t, t = void 0);
                var i = t || {};
                i._hasOptions = Boolean(t),
                    i._hasCallback = Boolean(s), this.callbacks[e] = s, this._callNative(e, i)
            }, Platform.prototype._callNative = function () { }, Platform.prototype.callCallback = function (e, t, s) {
                this.oneOf(AndroidBase, Apple, Microsoft) && (s = (s = Platform.DecodeWebViewData(s)) ? JSON.parse(s) : {}), console.log("Platform.callCallback " + e + " - " + t + " - " + JSON.stringify(s));
                var i = this.callbacks[e];
                i && (delete this.callbacks[e], i(t, s))
            }, Platform.prototype.initGameEvents = function () {
                document.hidden && this.pause(), void 0 !== document.hidden && ["visibilitychange", "webkitvisibilitychange"].forEach(function (e) {
                    document.addEventListener(e, function () {
                        document.hidden ? this.pause() : this.resume()
                    }.bind(this), !1)
                }.bind(this)), window.addEventListener("pagehide", function () {
                    this.pause()
                }.bind(this), !1), window.addEventListener("pageshow", function () {
                    this.resume()
                }.bind(this), !1), cc.game.canvas.addEventListener("webglcontextlost", function () {
                    cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.ERROR_CONTEXT_LOST), cleverapps.playSession.inc(
                        cleverapps.EVENTS.STATS.ERROR_CONTEXT_LOST), setTimeout(function () {
                            window.location.reload()
                        }, 0)
                }), cc.eventManager.addListener(cc.EventListener.create({
                    event: cc.EventListener.TOUCH_ONE_BY_ONE,
                    onTouchBegan: cleverapps.accumulate(100, function () {
                        this.resumeAudioContext()
                    }.bind(this))
                }), -1)
            }, Platform.prototype.resumeAudioContext = function () {
                var e = cc.Audio._context;
                e && ("suspended" !== e.state && "interrupted" !== e.state || e.resume())
            }, Platform.prototype.isAudioContextRunning = function () {
                var e = cc.Audio._context;
                return e && "running" === e.state
            }, Platform.prototype.pause = function () {
                cc.game.isPaused() || cleverapps.gameModes && cleverapps.gameModes.noGamePause || this.oneOf(Instant) && this.info.os === PlatformInfo.OS_IOS && this.info.isInApp || (console.log("pause game"), cc.game.pause(), cleverapps.audio && cleverapps.audio.onChangeMusic(), cc.eventManager && cc.eventManager.dispatchEvent(new cc.EventCustom(cc.game.EVENT_HIDE)))
            }, Platform.prototype.resume = function () {
                this.resumeAudioContext(), !cc.game.isPaused() || cleverapps.gameModes && cleverapps.gameModes.noGamePause || (console.log("resume game"), cc.game.resume(), cleverapps.audio && cleverapps.audio.onChangeMusic(), cc.eventManager && cc.eventManager.dispatchEvent(new cc.EventCustom(cc.game.EVENT_SHOW)))
            }, Platform.WAIT_CONNECT_TIMEOUT = cleverapps.parseInterval("60 seconds"), Platform.SOCIAL = "social", Platform.PAYMENTS = "payments", Platform.ADS = "ads", Platform.PLATFORM = "platform", Platform.STATUS_CONNECTED = "connected", Platform.STATUS_DISCONNECTED = "disconnected", Platform.STATUS_DISABLED = "disabled",
            function () {
                function e(e, t, s) {
                    switch (s) {
                        case "facebook":
                            var i = e.facebook;
                            return i && "https://apps.facebook.com/" + (i.shortname || i.appId);
                        case "android":
                            return e.android && "https://play.google.com/store/apps/details?id=" + e.android.package;
                        case "amazon":
                            return e.amazon && "https://www.amazon.com/dp/" + e.amazon.id;
                        case "macos":
                        case "ios":
                            return e.ios && "https://apps.apple.com/app/id" + e.ios.id;
                        case "instant":
                            return e.instant && "https://www.facebook.com/instantgames/play/" + e.instant.appId;
                        case "web_ok":
                            return e.ok && "https://ok.ru/game/" + (e.ok.shortname || e.ok.appId);
                        case "mobile_ok":
                            return e.ok && "https://m.ok.ru/game/" + (e.ok.shortname || e.ok.appId);
                        case "web_vk":
                            return e.vk && "https://vk.com/" + (e.vk.shortname || e.vk.appId);
                        case "mobile_vk":
                            return e.vk && "vk://vk.com/" + (e.vk.shortname || e.vk.appId);
                        case "web_mm":
                            return e.mm && "https://my.mail.ru/apps/" + e.mm.appId;
                        case "mobile_mm":
                            return e.mm && "https://m.my.mail.ru/apps/" + e.mm.appId;
                        case "mbga":
                            return t ? e.mbga && "https://sb.yahoo-mbga.jp/game/" + e.mbga.appId + "/play" : e.mbga && "https://yahoo-mbga.jp/game/" + e.mbga.appId + "/play";
                        case "sp_mbga":
                            return e.mbga && "http://sp.mbga.jp/_pf_install?game_id=" + e.mbga.appId;
                        case "draugiem":
                            return e.draugiem && "https://www.draugiem.lv/" + (parseInt(e.draugiem.appId) ? "applications/" : "") + e.draugiem.appId;
                        case "fotostrana":
                            return e.fotostrana && "https://fotostrana.ru/app/" + e.fotostrana.appId;
                        case "yandex":
                            return e.yandex && "https://yandex.ru/games/play/" + e.yandex.appId;
                        case "gdcom":
                            return e.gdcom && "https://revision.gamedistribution.com/" + e.gdcom.appId;
                        case "plng":
                            return e.plng && "https://revision.gamedistribution.com/" + e.plng.appId;
                        case "msstart":
                            return e.msstart && "https://www.msn.com/en-us/play/" + (e.msstart.name.replaceAll(" ", "-") + "/cg-" + e.msstart.appId).toLowerCase();
                        case "kongregate":
                            return e.kongregate && "https://www.kongregate.com/games/CleverApps/" + e.kongregate.name;
                        case "crazy":
                            return e.crazy && "https://www.crazygames.com/game/" + e.crazy.name;
                        case "xsolla":
                            return e.deployment + (t ? "/publish/html5-staging/" : "/publish/html5/") + "?source=cleverapps";
                        case "test":
                            return e.deployment + (t ? "/publish/html5-staging/" : "/publish/html5/")
                    }
                }
                "undefined" == typeof cc ? module.exports = e : Platform.guessPlatformURL = e
            }(),
            function () {
                function e(e, t) {
                    switch (t) {
                        case "macos":
                            return projects[e].ios;
                        case "web_ok":
                        case "mobile_ok":
                            return projects[e].ok;
                        case "web_vk":
                        case "mobile_vk":
                            return projects[e].vk;
                        case "web_mm":
                        case "mobile_mm":
                            return projects[e].mm;
                        case "mbga":
                        case "sp_mbga":
                            return projects[e].mbga;
                        default:
                            return projects[e][t]
                    }
                }
                "undefined" == typeof cc ? module.exports = e : Platform.getPlatformConfig = e
            }(), {
            create: function (e) {
                var t = {
                    microsoft: Microsoft,
                    msstart: MSStart,
                    gdcom: GDCom,
                    instant: Instant,
                    mobile_ok: MobileOK,
                    web_ok: OKPlatform,
                    mobile_mm: MobileMyMailRu,
                    web_mm: MyMailRu,
                    mobile_vk: MobileVk,
                    web_vk: VKPlatform,
                    sp_mbga: SPMobage,
                    mbga: Mobage,
                    draugiem: Draugiem,
                    fotostrana: FotoStrana,
                    cleverapps: CleverApps,
                    yandex: Yandex,
                    macos: MacOS,
                    ios: IOS,
                    gpg: GPG,
                    android: AndroidPlatform,
                    pliega: Pliega,
                    plng: Plinga,
                    kongregate: Kongregate,
                    crazy: Crazy,
                    ton: Ton,
                    wortal: WortalPlatform,
                    rustore: Rustore,
                    amazon: Amazon,
                    mygames: Mygames,
                    samsung: Samsung,
                    ios_ch: IOSCh,
                    huzcom: Huzcom,
                    facebook: FacebookCanvas,
                    xiaomi: Xiaomi,
                    pwa: PWA,
                    wechat: Wechat,
                    test: TestPlatform
                },
                    s = this.getSource();
                return console.log(s), cleverapps.config[s] && void 0 !== cleverapps.config[s].adsense && (cleverapps.config.adsense = cleverapps.config[s].adsense),
                    cleverapps.config[s] && void 0 !== cleverapps.config[s].xsolla && (cleverapps.config.xsolla = cleverapps.config[s].xsolla), new (t[s] || FacebookCanvas)(e)
            },
            getSource: function () {
                function e(e) {
                    return -1 !== window.location.href.indexOf(e)
                }
                if ("msstart" === cleverapps.config.source && !e("msstart_sdk_init")) return "pwa";
                if (cleverapps.config.debugMode && "plinga" === cleverapps.config.source) return "plng";
                if (cleverapps.config.source) return cleverapps.config.source;
                var t = new URLSearchParams(window.location.search).get("source");
                if (["android", "amazon", "ios", "macos", "plng", "pliega", "rustore", "ios_ch", "gdcom", "mygames", "kongregate", "msstart", "microsoft", "crazy", "facebook", "xiaomi", "cleverapps", "wortal", "samsung"].includes(t)) return t;
                if (e("msstart_sdk_init")) return "msstart";
                if (e("dr_auth_code")) return "draugiem";
                if (e("logged_user_id")) return e("mob=true") ? "mobile_ok" : "web_ok";
                if (e("api.vk.")) return e("vkmobile=true") ? "mobile_vk" : "web_vk";
                t = cleverapps.config.yandex && cleverapps.config.yandex.appId;
                return e("yandex") || e(
                    "playhop.com") || t && e("app-id=" + t) ? "yandex" : e("fotostrana.ru") ? "fotostrana" : e("source=spmobage") ? "sp_mbga" : e("mbga-platform.jp") ? "mbga" : e("source=xsolla") ? "cleverapps" : cleverapps.config.mm && e("app_id=" + cleverapps.config.mm.appId) ? e("view=app_mobile") ? "mobile_mm" : "web_mm" : e("telegram=true") ? "ton" : cleverapps.isLocalhost() || cleverapps.isStaging() ? "test" : cleverapps.config.facebook && cleverapps.config.facebook.appId ? "facebook" : "cleverapps"
            }
        }),
        AndroidBase = function (e, t) {
            Platform.call(this, e, t), this.info.os = PlatformInfo.OS_ANDROID
        },
        Apple = (AndroidBase.prototype = Object.create(Platform.prototype), (AndroidBase.prototype.constructor = AndroidBase).prototype._callNative = function (e, t) {
            AndroidNative.callNative(e, JSON.stringify(t))
        }, AndroidBase.prototype._initialize = function (e) {
            new ActionPlayer([function (s) {
                this.callNative("AppActivityPlugin.getAppSettings", function (e, t) {
                    this.info.setInfo({
                        language: t.defaultLanguage
                    }), this.device.name = t.deviceName, this.device.version = t.deviceVersion, t.idfa && (
                        this.device.idfa = t.idfa), this.audioPluginAvailable = t.audioPluginAvailable, s()
                }.bind(this))
            }.bind(this), function (e) {
                this.dataLoader.localStorage = new WebViewLocalStorage, this.dataLoader.localStorage.initialize(e)
            }.bind(this)]).play(e)
        }, AndroidBase.prototype.needWindowForLogin = function () {
            return !0
        }, AndroidBase.prototype.closeApplication = function () {
            cleverapps.platform.callNative("AppActivityPlugin.closeApplication")
        }, function (e, t) {
            Platform.call(this, e, t), this.info.os = this.oneOf(MacOS) ? PlatformInfo.OS_OSX : PlatformInfo.OS_IOS, this.oneOf(IOSCh) && (cleverapps.config.languages = ["en", "zh"])
        }),
        AndroidPlatform = (Apple.prototype = Object.create(Platform.prototype), (Apple.prototype.constructor = Apple).prototype._initialize = function (e) {
            new ActionPlayer([function (e) {
                function t() {
                    window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.AppleNative ? e() : (setTimeout(t, 100), 60 === ++s && cleverapps.throwAsync("Wait AppleNative 1 min"))
                }
                var s = 0;
                t()
            }, function (s) {
                this.callNative(
                    "ApplePlatformPlugin.getAppSettings",
                    function (e, t) {
                        this.info.setInfo({
                            language: t.defaultLanguage
                        }), this.device.name = t.deviceName, this.device.version = t.deviceVersion, t.advertisingId && (this.device.idfa = t.advertisingId), this.appleSocialAvailable = t.appleSocialAvailable, s()
                    }.bind(this))
            }.bind(this), function (e) {
                this.dataLoader.localStorage = new WebViewLocalStorage, this.dataLoader.localStorage.initialize(e)
            }.bind(this)]).play(e)
        }, Apple.prototype.needWindowForLogin = function () {
            return !0
        }, Apple.prototype._callNative = function (t, e) {
            e = Object.assign({}, e || {}, {
                method: t
            });
            var s = window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.AppleNative;
            if (s) try {
                s.postMessage(JSON.stringify(e))
            } catch (e) {
                cleverapps.throwAsync("Apple callNative " + t + " error " + e.message, e)
            } else cleverapps.throwAsync("Empty AppleNative")
        }, function (e) {
            AndroidBase.call(this, e, "android")
        }),
        Pliega = (AndroidPlatform.prototype = Object.create(AndroidBase.prototype), (AndroidPlatform.prototype.constructor = AndroidPlatform).prototype.canReview = function () {
            return !0
        }, AndroidPlatform.prototype._requestReview = function () {
            this.callNative("ReviewPlugin.requestReview", function (e) {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.NATIVE_REVIEW + (e === cleverapps.CODE_SUCCEED ? "ok" : "failure"))
            })
        }, function (e) {
            AndroidBase.call(this, e, "pliega")
        }),
        GPG = (Pliega.prototype = Object.create(AndroidBase.prototype), (Pliega.prototype.constructor = Pliega).prototype.getLocalStoragePreffix = function () {
            return "_nosocial"
        }, function (e) {
            AndroidBase.call(this, e, "gpg")
        }),
        Rustore = (GPG.prototype = Object.create(AndroidBase.prototype), GPG.prototype.constructor = GPG, function (e) {
            AndroidBase.call(this, e, "rustore")
        }),
        Amazon = (Rustore.prototype = Object.create(AndroidBase.prototype), (Rustore.prototype.constructor = Rustore).prototype.getLocalStoragePreffix = function () {
            return "_nosocial"
        }, Rustore.prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_RUSSIAN]
        }, function (e) {
            AndroidBase.call(this, e, "amazon")
        }),
        IOS = (
            Amazon.prototype = Object.create(AndroidBase.prototype), Amazon.prototype.constructor = Amazon,
            function (e) {
                Apple.call(this, e, "ios")
            }),
        IOSCh = (IOS.prototype = Object.create(Apple.prototype), IOS.prototype.constructor = IOS, function (e) {
            Platform.call(this, e, "ios_ch")
        }),
        Draugiem = (IOSCh.prototype = Object.create(Platform.prototype), (IOSCh.prototype.constructor = IOSCh).prototype.getLocalStoragePreffix = function () {
            return "_nosocial"
        }, function (e) {
            Platform.call(this, e, "draugiem")
        }),
        FotoStrana = (Draugiem.prototype = Object.create(Platform.prototype), (Draugiem.prototype.constructor = Draugiem).prototype._connect = function (e) {
            cleverapps.loadSdk("//draugiem.lv/applications/external/draugiem.js", {
                onSuccess: function () {
                    e(Platform.STATUS_CONNECTED)
                },
                onFailure: function () {
                    console.log("Failed to load draugiem.js api"), e(Platform.STATUS_DISCONNECTED)
                },
                crossorigin: !1
            })
        }, Draugiem.prototype.getLocalStoragePreffix = function () {
            return "_draugiem"
        }, Draugiem.prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_LATVIAN,
            PlatformInfo.LANGUAGE_RUSSIAN
            ]
        }, function (e) {
            Platform.call(this, e, "fotostrana"), cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE = cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE_FS
        }),
        MacOS = (FotoStrana.prototype = Object.create(Platform.prototype), (FotoStrana.prototype.constructor = FotoStrana).prototype._connect = function (t) {
            cleverapps.loadSdk(cleverapps.getRequestParameters().fsapi, {
                onSuccess: function () {
                    window.FSClient = new fsapi(cleverapps.config.fotostrana.appId, cleverapps.config.fotostrana.privateKey), FSClient.init(function () {
                        console.log("API Error!")
                    }), t(Platform.STATUS_CONNECTED)
                },
                onFailure: function (e) {
                    t(Platform.STATUS_DISCONNECTED), "timeout" === e ? cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT) : cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR)
                },
                crossorigin: !1
            })
        }, FotoStrana.prototype.getLocalStoragePreffix = function () {
            return "_FS"
        }, FotoStrana.prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_RUSSIAN]
        }, function (e) {
            Apple.call(this, e,
                "macos")
        }),
        Microsoft = (MacOS.prototype = Object.create(Apple.prototype), MacOS.prototype.constructor = MacOS, function (e) {
            Platform.call(this, e, "microsoft"), this.info.os = PlatformInfo.OS_WINDOWS
        }),
        Mobage = (Microsoft.prototype = Object.create(Platform.prototype), (Microsoft.prototype.constructor = Microsoft).prototype.getDeviceId = function () {
            return this.deviceId
        }, Microsoft.prototype._connect = function (s) {
            this.callNative("social.getDeviceId", void 0, function (e, t) {
                this.deviceId = t && t.deviceId, s(Platform.STATUS_CONNECTED)
            }.bind(this))
        }, Microsoft.prototype.getAccessToken = function () {
            return "microsoft"
        }, Microsoft.prototype.canReview = function () {
            return !0
        }, Microsoft.prototype._requestReview = function () {
            this.callNative("store.review", void 0, function (e, t) {
                t = !t || t.error ? "failure" : "ok";
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.NATIVE_REVIEW + t)
            })
        }, Microsoft.prototype.calcChannel = function (s) {
            this.callNative("social.getCampaignId", void 0, function (e, t) {
                t && t.campaignId ? s(t.campaignId) : s()
            })
        },
            Microsoft.prototype.needWindowForLogin = function () {
                return !0
            }, Microsoft.prototype.isFullscreenAvailable = function () {
                return !0
            }, Microsoft.prototype.toggleFullScreen = function () {
                this.callNative("app.toggleFullScreen")
            }, Microsoft.prototype._callNative = function (e, t) {
                e = Object.assign({
                    method: e
                }, t || {});
                window.chrome.webview.postMessage(JSON.stringify(e))
            },
            function (e) {
                Platform.call(this, e, "mbga")
            }),
        MyMailRu = (Mobage.prototype = Object.create(Platform.prototype), (Mobage.prototype.constructor = Mobage).prototype.getLocalStoragePreffix = function () {
            return "_mbga"
        }, Mobage.prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_JAPANESE]
        }, Mobage.prototype.isFullscreenAvailable = function () {
            return !1
        }, function (e, t) {
            Platform.call(this, e, t || "web_mm")
        }),
        MobileMyMailRu = (MyMailRu.prototype = Object.create(Platform.prototype), (MyMailRu.prototype.constructor = MyMailRu).prototype._connect = function (s) {
            cleverapps.loadSdk("//connect.mail.ru/js/loader.js", {
                onSuccess: function () {
                    mailru.loader.require("api", function () {
                        var e;
                        mailru.app.init(cleverapps.config.mm.privateKey), this instanceof MobileMyMailRu ? this.createHeaderAndFooter(function () {
                            s(Platform.STATUS_CONNECTED)
                        }) : (window.outerHeight && window.innerHeight && (e = window.outerHeight - 250, mailru.app.utils.setHeight(e), cleverapps.resolution.setupDesignResolution(cc.size(window.innerWidth, e))), mailru.events.listen(mailru.app.events.readHash, function (e) {
                            e && e.channel && levels.user.setChannel(e.channel)
                        }), mailru.app.utils.hash.read(), setTimeout(function () {
                            s(Platform.STATUS_CONNECTED)
                        }, 300))
                    }.bind(this))
                },
                onFailure: function (e) {
                    var t;
                    window.outerHeight && window.innerHeight && (t = window.outerHeight - 250, cleverapps.resolution.setupDesignResolution(cc.size(window.innerWidth, t))), s(Platform.STATUS_DISCONNECTED), "timeout" === e ? cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT) : cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR)
                },
                crossorigin: !1
            })
        }, MyMailRu.prototype.getLocalStoragePreffix = function () {
            return "_MM"
        },
            MyMailRu.prototype.getSuggestedLanguage = function () {
                return [PlatformInfo.LANGUAGE_RUSSIAN]
            }, MyMailRu.prototype.calcChannel = function (e) {
                var t, s = Platform._parseChannel("channel");
                !s && document.referrer ? (t = new URL(document.referrer), e(Platform._parseChannel("channel", t.search))) : e(s)
            },
            function (e) {
                MyMailRu.call(this, e, "mobile_mm"), this.info.isInApp = !0, this.info.isMobile = !0
            }),
        OKPlatform = (MobileMyMailRu.prototype = Object.create(MyMailRu.prototype), (MobileMyMailRu.prototype.constructor = MobileMyMailRu).prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_RUSSIAN]
        }, MobileMyMailRu.prototype.createHeaderAndFooter = function (s) {
            var e = cleverapps.getRequestParameters(),
                e = (mailru.callhf = function (e) {
                    var t = document.createElement("div"),
                        t = (t.style.position = "absolute", t.style.top = "0", t.style.height = "48px", t.style.width = "100%", t.style.zIndex = "2", t.innerHTML = e.header, document.body.insertBefore(t, document.body.firstChild), document.createElement("div"));
                    t.style.position = "absolute",
                        t.style.bottom = "0", t.style.height = "27px", t.style.width = "100%", t.style.zIndex = "2", t.innerHTML = e.footer, document.body.appendChild(t), cleverapps.resolution.setContainerPadding({
                            top: 48,
                            bottom: 27
                        }), s()
                }, {
                    method: "mobile.getCanvas",
                    app_id: e.app_id,
                    cb: "mailru.callhf",
                    session_key: e.session_key,
                    mobile_spec: e.mobile_spec
                }),
                e = mailru.utils.sign(e);
            mailru.utils.apiOverJSONP(e, "https://appsmail.ru/platform/api")
        }, function (e, t) {
            Platform.call(this, e, t || "web_ok")
        }),
        MobileOK = (OKPlatform.prototype = Object.create(Platform.prototype), (OKPlatform.prototype.constructor = OKPlatform).prototype.getLocalStoragePreffix = function () {
            return "_OK"
        }, OKPlatform.prototype.updateSize = function () {
            cleverapps.platform.listeners.getPageInfo = function (e, t) {
                var s;
                try {
                    s = JSON.parse(t).innerHeight
                } catch (e) {
                    s = window && window.innerHeight || document && document.body && document.body.clientHeight || 800
                }
                t = s - 75;
                t < 600 && (t = 600), FAPI.UI.setWindowSize(760, t), cleverapps.resolution.setupDesignResolution(cc.size(cc.view.getFrameSize().width, t))
            }, [0, 5, 10, 20, 60].forEach(function (e) {
                setTimeout(FAPI.UI.getPageInfo, 1e3 * e)
            })
        }, OKPlatform.prototype._connect = function (e) {
            cleverapps.loadSdk("//api.ok.ru/js/fapi5.js", {
                crossorigin: !1,
                onSuccess: this.onInitSuccess.bind(this, e),
                onFailure: this.onInitFailure.bind(this, e)
            })
        }, OKPlatform.prototype.onInitSuccess = function (t) {
            this.listeners = {};
            var e = FAPI.Util.getRequestParameters();
            "android" === e.mob_platform && this.info.setInfo({
                os: PlatformInfo.OS_ANDROID
            }), FAPI.init(e.api_server, e.apiconnection, function () {
                window.API_callback = function (e, t, s) {
                    var i;
                    console.log("Received API callback " + e, t, s), this.listeners[e] && (i = this.listeners[e], this.listeners[e] = void 0, i.call(this, t, s))
                }.bind(this), this.updateSize(), this.initPushNotifications(), t(Platform.STATUS_CONNECTED)
            }.bind(this), function (e) {
                this.onInitFailure(t, e)
            }.bind(this))
        }, OKPlatform.prototype.onInitFailure = function (e, t) {
            e(Platform.STATUS_DISCONNECTED), "timeout" === t ? cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT) : cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR)
        }, OKPlatform.prototype.createFAPICallback = function (i) {
            return function (e, t, s) {
                s && s.error_code && 102 === parseInt(s.error_code) ? (this.sessionExpired = !0, cleverapps.playSession.set(cleverapps.EVENTS.DEBUG.OK_SESSION_EXPIRED, !0), this.disconnect(), this.once("changeStatus:" + Platform.PLATFORM, function () {
                    i(e, t, s)
                }), this.connect()) : (this.sessionExpired && cleverapps.playSession.set(cleverapps.EVENTS.DEBUG.OK_SESSION_RESTORED, !0), i(e, t, s))
            }.bind(this)
        }, OKPlatform.prototype.isMessagesAllowed = function (s) {
            FAPI.Client.call({
                method: "group.isMessagesAllowed",
                gid: cleverapps.config.ok.groupId
            }, this.createFAPICallback(function (e, t) {
                s("ok" === e && t.allowed)
            }))
        }, OKPlatform.prototype.canJoinGroup = function (t) {
            this.isInGroup(function (e) {
                e ? this.isMessagesAllowed(function (e) {
                    t(!e)
                }) : t(!0)
            }.bind(this))
        }, OKPlatform.prototype._followOfficialPage = function () {
            this.canJoinGroup(function (e) {
                e && (cleverapps.platform.listeners.joinGroup = function (e, t) {
                    t = cleverapps.EVENTS.STATS.OK.JOIN_GROUP + t;
                    cleverapps.eventLogger.logEvent(t.substr(0, 40))
                }, FAPI.UI.joinGroup(cleverapps.config.ok.groupId, !0))
            })
        }, OKPlatform.prototype.isInGroup = function (o) {
            FAPI.Client.call({
                method: "group.getUserGroupsV2"
            }, this.createFAPICallback(function (e, t) {
                for (var s = "ok" === e && t && t.groups || [], i = !1, n = 0; n < s.length; n++)
                    if (s[n].groupId === cleverapps.config.ok.groupId) {
                        i = !0;
                        break
                    } o(i)
            }))
        }, OKPlatform.prototype.initPushNotifications = function () { }, OKPlatform.prototype._showBannerAd = function (n) {
            cleverapps.platform.listeners.requestBannerAds = cleverapps.once(function () {
                cleverapps.platform.listeners.showBannerAds = cleverapps.once(function (e, t) {
                    var s, i;
                    "ok" === e && "true" === t ? (cleverapps.platform.listeners.requestBannerAds = s = function (e, t) {
                        cleverapps.platform.listeners.requestBannerAds = s, "ok" === e && "ad_shown" === t && cleverapps.bannerAd.onPaidEvent(), "hidden_by_user" === t && cleverapps.bannerAd.hide(!0)
                    },
                        i = this.info.os === PlatformInfo.OS_ANDROID && this.info.isInApp ? MobileOK.AD_BANNER_HEIGHT_ANDROID : cc.size(MobileOK.AD_BANNER_WIDTH, MobileOK.AD_BANNER_HEIGHT), n(cleverapps.CODE_SUCCEED, i)) : n({
                            code: e,
                            data: t
                        })
                }), FAPI.invokeUIMethod("showBannerAds", "bottom")
            }), FAPI.invokeUIMethod("requestBannerAds")
        }, OKPlatform.prototype._hideBannerAd = function (s) {
            cleverapps.platform.listeners.hideBannerAds = cleverapps.once(function (e, t) {
                "ok" === e ? (cleverapps.platform.listeners.isBannerAdsVisible = cleverapps.once(function (e, t) {
                    "ok" === e ? "false" === t ? (cleverapps.platform.listeners.requestBannerAds = void 0, cleverapps.platform.listeners.showBannerAds = void 0, cleverapps.platform.listeners.hideBannerAds = void 0, cleverapps.platform.listeners.isBannerAdsVisible = void 0, s(cleverapps.CODE_SUCCEED)) : s("banner still shown") : s({
                        method: "isBannerAdsVisible",
                        code: e,
                        data: t
                    })
                }), FAPI.invokeUIMethod("isBannerAdsVisible")) : s({
                    method: "hideBannerAds",
                    code: e,
                    data: t
                })
            }), FAPI.invokeUIMethod("hideBannerAds")
        }, function (e) {
            OKPlatform.call(this, e,
                "mobile_ok");
            e = window && window.navigator && window.navigator.userAgent;
            e && 0 <= e.indexOf("OkApp") && (this.info.isInApp = !0, this.info.isMobile = !0)
        }),
        Mygames = (MobileOK.prototype = Object.create(OKPlatform.prototype), (MobileOK.prototype.constructor = MobileOK).prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_RUSSIAN]
        }, MobileOK.prototype._canCreateShortcut = function () {
            return this.info.os === PlatformInfo.OS_ANDROID && !cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.SHORTCUT_CREATED)
        }, MobileOK.prototype.createShortcut = function (s) {
            cleverapps.platform.listeners.requestDesktopIcon = cleverapps.once(function (e, t) {
                console.log("requestDesktopIcon", e, t), s && s(e, t), "ok" === e && cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.SHORTCUT_CREATED, 1)
            }), FAPI.invokeUIMethod("requestDesktopIcon")
        }, MobileOK.prototype.canReview = function () {
            return this.info.os === PlatformInfo.OS_ANDROID
        }, MobileOK.prototype._requestReview = function () {
            cleverapps.platform.listeners.showRatingDialog = cleverapps.once(function (e, t) {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.SOCIAL_REVIEW + e), console.log("showRatingDialog", e, t)
            }), FAPI.invokeUIMethod("showRatingDialog")
        }, MobileOK.prototype.updateSize = function () { }, MobileOK.prototype.isFullscreenAvailable = function () {
            return !this.info.isInApp && !!this.getFullscreener()
        }, MobileOK.prototype.initPushNotifications = function () {
            this.info.os === PlatformInfo.OS_ANDROID && this.info.isInApp && (this.listeners.getPushNotificationsStatus = function (e, t) {
                "ok" === e && ("true" === (t = JSON.parse(t)).isGlobalEnabled && "true" === t.isSubscriptionEnabled ? cleverapps.info.setKeyValue("pushPermission", !0, !0) : FAPI.UI.suggestToEnablePushNotifications())
            }, this.listeners.suggestToEnablePushNotifications = function (e) {
                cleverapps.info.setKeyValue("pushPermission", "ok" === e, !0)
            }, FAPI.UI.getPushNotificationsStatus())
        }, MobileOK.AD_BANNER_HEIGHT = 96, MobileOK.AD_BANNER_WIDTH = 404, MobileOK.AD_BANNER_HEIGHT_ANDROID = 106, function (e) {
            Platform.call(this, e, "mygames")
        }),
        GDCom = (Mygames.prototype = Object.create(Platform.prototype), (Mygames.prototype.constructor = Mygames).prototype.canReview = function () {
            return !0
        }, Mygames.prototype._requestReview = function () {
            window.electronApi.showReview(cleverapps.config.mygames.gcId), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.SOCIAL_REVIEW + !0)
        }, Mygames.prototype.isFullscreenAvailable = function () {
            return !!this.getFullscreener()
        }, Mygames.prototype.getSuggestedLanguage = function () {
            switch (new URLSearchParams(window.location.search).get("ui_locale")) {
                case "en-US":
                    return [PlatformInfo.LANGUAGE_ENGLISH];
                case "de-DE":
                    return [PlatformInfo.LANGUAGE_DUTCH];
                case "es-ES":
                    return [PlatformInfo.LANGUAGE_SPANISH];
                case "fr-FR":
                    return [PlatformInfo.LANGUAGE_FRENCH];
                case "pl-PL":
                    return [PlatformInfo.LANGUAGE_POLISH];
                case "tr-TR":
                    return [PlatformInfo.LANGUAGE_TURKISH];
                case "ar-AA":
                    return [PlatformInfo.LANGUAGE_ARABIC];
                default:
                    return [PlatformInfo.LANGUAGE_RUSSIAN]
            }
        }, function (e) {
            Platform.call(this, e, "gdcom"),
                this.adsEventListener = function () { }
        }),
        MSStart = (GDCom.prototype = Object.create(Platform.prototype), (GDCom.prototype.constructor = GDCom).prototype._initialize = function (e) {
            this.setUserID(cleverapps.getRequestParameters().gdcom_userid), e()
        }, GDCom.prototype._connect = function (e) {
            cleverapps.isLocalhost() ? e(Platform.STATUS_CONNECTED) : (window.GD_OPTIONS = {
                gameId: cleverapps.config.gdcom.appId,
                onEvent: function (e) {
                    switch (console.log("gdcom event", JSON.stringify(e)), e.name) {
                        case "SDK_GAME_START":
                            this.resume();
                            break;
                        case "SDK_GAME_PAUSE":
                            this.pause()
                    }
                    this.adsEventListener(e)
                }.bind(this)
            }, this.isCoolmathgames() && (cleverapps.Availables.LEADER_BOARD = {
                debugMode: !0
            }, delete cleverapps.config.leagues, ["scramble", "crocword"].forEach(function (e) {
                CupsConfig.TYPES[CupsConfig.TYPE_DAILY].available.projectName.splice(CupsConfig.TYPES[CupsConfig.TYPE_DAILY].available.projectName.indexOf(e), 1)
            })), cleverapps.loadSdk("//html5.api.gamedistribution.com/main.min.js", {
                onSuccess: function () {
                    e(Platform.STATUS_CONNECTED)
                },
                onFailure: function () {
                    cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.GDCOM_INIT_ERROR), e(Platform.STATUS_DISCONNECTED)
                }
            }))
        }, GDCom.prototype.getLocalStoragePreffix = function () {
            return "_plinga"
        }, GDCom.prototype.isCoolmathgames = function () {
            return window.location.href.includes("coolmathgames.com")
        }, GDCom.prototype.isFullscreenAvailable = function () {
            return !this.isCoolmathgames()
        }, GDCom.prototype._showBannerAd = function (t) {
            var s = document.createElement("div"),
                i = (s.id = "gdcom-ad-banner-container", s.style.display = "block", s.style.visibility = "hidden", s.style.position = "absolute", s.style.zIndex = "2", s.style.bottom = "0", s.style.margin = "0 auto", s.style.height = GDCom.AD_BANNER_HEIGHT + "px", s.style.width = "100%", document.body.appendChild(s), cleverapps.once(function (e) {
                    return (e = e || s.getElementsByTagName("iframe").length ? e : "No fitting size banner found for slot " + s.clientWidth + "x" + s.clientHeight) ? (s.remove(), void t(e)) : (s.style.visibility = "visible", void t(cleverapps.CODE_SUCCEED, GDCom.AD_BANNER_HEIGHT))
                }));
            setTimeout(function () {
                i("gdsdk.showAd timeout")
            }, GDCom.AD_BANNER_ERROR_TIMEOUT);
            try {
                gdsdk.showAd(gdsdk.AdType.Display, {
                    containerId: "gdcom-ad-banner-container"
                }).then(function () {
                    setTimeout(i, GDCom.AD_BANNER_SUCCESS_TIMEOUT)
                }).catch(i)
            } catch (e) {
                i(e)
            }
        }, GDCom.prototype._hideBannerAd = function (e) {
            var t = document.getElementById("gdcom-ad-banner-container");
            t && t.remove(), e(cleverapps.CODE_SUCCEED)
        }, GDCom.AD_BANNER_SUCCESS_TIMEOUT = cleverapps.parseInterval("2 seconds"), GDCom.AD_BANNER_ERROR_TIMEOUT = cleverapps.parseInterval("30 seconds"), GDCom.AD_BANNER_HEIGHT = 90, function (e) {
            Platform.call(this, e, "msstart")
        }),
        PWA = (MSStart.prototype = Object.create(Platform.prototype), (MSStart.prototype.constructor = MSStart).prototype._connect = function (e) {
            cleverapps.loadSdk(cleverapps.config.staticUrl + "cleverapps/res/msstart-v1.0.0-rc-3f3c80c881.12.min.js", {
                onSuccess: function () {
                    e(Platform.STATUS_CONNECTED)
                },
                onFailure: function () {
                    console.error("MSStart Social Init failed"), e(Platform.STATUS_DISCONNECTED)
                }
            })
        },
            MSStart.prototype.getLocalStoragePreffix = function () {
                return "_msstart"
            }, MSStart.prototype.getCurrentTournamentId = function (e) {
                e(1)
            }, MSStart.prototype._reportScore = function (e, t) {
                cleverapps.social.isLoggedIn() ? $msstart.submitGameResultsAsync(e).then(function (e) {
                    t(e)
                }) : t()
            }, MSStart.prototype.isFullscreenAvailable = function () {
                return !1
            },
            function (e) {
                Platform.call(this, e, "pwa")
            }),
        Plinga = (PWA.prototype = Object.create(Platform.prototype), (PWA.prototype.constructor = PWA).prototype.getLocalStoragePreffix = function () {
            return "_pwa"
        }, function (e) {
            Platform.call(this, e, "plng")
        }),
        Ton = (Plinga.prototype = Object.create(Platform.prototype), (Plinga.prototype.constructor = Plinga).prototype._connect = function (e) {
            console.log("Plinga init"), plingaRpc_pauseGame = function () {
                this.pause()
            }.bind(this), plingaRpc_resumeGame = function () {
                this.resume()
            }.bind(this);

            function t() {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.PLINGA_INIT_ERROR), e(Platform.STATUS_DISCONNECTED)
            }
            cleverapps.loadSdk(
                "//s3.amazonaws.com/imgs3.plinga.de/general/easyXDM.min.js", {
                onSuccess: function () {
                    console.log("easyXDM loaded"), easyXDM.DomHelper.requiresJSON("//s3.amazonaws.com/imgs3.plinga.de/general/json2.min.js"), cleverapps.loadSdk("//s3.amazonaws.com/imgs3.plinga.de/plingaRpc/plingaRpc.js", {
                        onSuccess: function () {
                            plingaRpc.init(function () {
                                console.log("plingaRPC inited"), plingaRpc.setAllowFullscreen(), e(Platform.STATUS_CONNECTED)
                            })
                        },
                        onFailure: t
                    })
                },
                onFailure: t
            })
        }, Plinga.prototype.getLocalStoragePreffix = function () {
            return "_plinga"
        }, Plinga.prototype.isFullscreenAvailable = function () {
            return !1
        }, function (e) {
            Platform.call(this, e, "ton"), this.initCallback = void 0, window.addEventListener("message", function (e) {
                e = e.data, e = e && e.playdeck;
                e && ("play" !== e.method ? this.callCallback(e.method, 0, e) : this.initCallback && (this.initCallback(Platform.STATUS_CONNECTED), this.initCallback = void 0))
            }.bind(this))
        }),
        WortalPlatform = (Ton.prototype = Object.create(Platform.prototype), (Ton.prototype.constructor = Ton).prototype.reportProgress = function (e) {
            this.callNative("loading", {
                value: e
            })
        }, Ton.prototype._connect = function (e) {
            this.initCallback = e
        }, Ton.prototype._reportScore = function (e, t) {
            this.callNative("setScore", {
                value: e,
                isForce: !1
            }, t)
        }, Ton.prototype._callNative = function (e, t) {
            e = Object.assign({
                method: e
            }, t);
            window.parent[Ton.POST_MESSAGE]({
                playdeck: e
            }, "*")
        }, Ton.POST_MESSAGE = "postMessage", function (e) {
            Platform.call(this, e, "wortal")
        }),
        Kongregate = (WortalPlatform.prototype = Object.create(Platform.prototype), (WortalPlatform.prototype.constructor = WortalPlatform).prototype._connect = function (e) {
            window.addEventListener("wortal-sdk-initialized", function () {
                this.isSupportedApi("context.inviteAsync") || (cleverapps.flags.noinvites = !0), this.isSupportedApi("context.shareAsync") || (cleverapps.flags.noshares = !0), this.debugMode = "debug" === Wortal.session.getPlatform() || window.location.href.includes("/debug/") || cleverapps.config.debugMode, this.reportProgress(100), e(Platform.STATUS_CONNECTED)
            }.bind(this)), cleverapps.loadSdk(
                "//storage.googleapis.com/html5gameportal.com/wortal-sdk/wortal-core-1.6.13.js", {
                onFailure: function () {
                    console.log("Failed to load wortal sdk"), e(Platform.STATUS_DISCONNECTED)
                }
            })
        }, WortalPlatform.prototype.reportProgress = function (e) {
            this.isConnected(Platform.PLATFORM) && Wortal.setLoadingProgress(e)
        }, WortalPlatform.prototype.getCurrentTournamentId = function (s) {
            Wortal.tournament.getCurrentAsync().then(function (e) {
                var t = new Date(1e3 * e.endTime) < new Date;
                s(t ? void 0 : String(e.id))
            }).catch(function () {
                s()
            })
        }, WortalPlatform.prototype._reportScore = function (e, t) {
            Wortal.tournament.postScoreAsync(e).then(function () {
                this.getCurrentTournamentId(t)
            }.bind(this)).catch(function () {
                t()
            })
        }, WortalPlatform.prototype.isSupportedApi = function (e) {
            return -1 !== Wortal.getSupportedAPIs().indexOf(e)
        }, function (e) {
            Platform.call(this, e, "kongregate")
        }),
        Crazy = (Kongregate.prototype = Object.create(Platform.prototype), (Kongregate.prototype.constructor = Kongregate).prototype._connect = function (e) {
            console.log("Kongregate init");

            function t() {
                window.kongregate = kongregateAPI.getAPI(), e(Platform.STATUS_CONNECTED)
            }
            cleverapps.loadSdk("https://cdn1.kongregate.com/javascripts/kongregate_api.js", {
                onFailure: function () {
                    cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.KONGREGATE_INIT_ERROR), e(Platform.STATUS_DISCONNECTED)
                },
                onSuccess: function () {
                    kongregateAPI.loadAPI(t)
                },
                crossorigin: !1
            })
        }, Kongregate.prototype.getLocalStoragePreffix = function () {
            return "_kongregate"
        }, Kongregate.prototype.isFullscreenAvailable = function () {
            return !1
        }, function (e) {
            Platform.call(this, e, "crazy")
        }),
        SPMobage = (Crazy.prototype = Object.create(Platform.prototype), (Crazy.prototype.constructor = Crazy).prototype._connect = function (t) {
            function s() {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.CRAZY_INIT_ERROR), t(Platform.STATUS_DISCONNECTED)
            }
            cleverapps.loadSdk("https://sdk.crazygames.com/crazygames-sdk-v2.js", {
                onFailure: s,
                onSuccess: function () {
                    "undefined" != typeof CrazyGames ? (CrazyGames.SDK.game.sdkGameLoadingStart(), cleverapps.whenAllInitialized(
                        function () {
                            CrazyGames.SDK.game.sdkGameLoadingStop()
                        }), CrazyGames.SDK.user.isUserAccountAvailable(function (e) {
                            e ? s() : cleverapps.social.loadUser(function () {
                                t(Platform.STATUS_CONNECTED)
                            })
                        })) : s()
                }
            })
        }, Crazy.prototype.getLocalStoragePreffix = function () {
            return "_crazy"
        }, Crazy.prototype.isFullscreenAvailable = function () {
            return !1
        }, Crazy.prototype.needWindowForLogin = function () {
            return !0
        }, Crazy.prototype._showBannerAd = function (t) {
            var s = document.createElement("div");
            s.id = "crazygames-ad-banner-container", s.style.display = "block", s.style.visibility = "hidden", s.style.position = "absolute", s.style.zIndex = "2", s.style.bottom = "0", s.style.margin = "0 auto", s.style.height = Crazy.AD_BANNER_HEIGHT + "px", s.style.width = "100%", document.body.appendChild(s);
            CrazyGames.SDK.banner.requestResponsiveBanner("crazygames-ad-banner-container", function (e) {
                if (e) return s.remove(), void t(e);
                s.style.visibility = "visible", t(cleverapps.CODE_SUCCEED, Crazy.AD_BANNER_HEIGHT)
            })
        }, Crazy.prototype._refreshBannerAd = function (e) {
            CrazyGames.SDK.banner.requestResponsiveBanner("crazygames-ad-banner-container", e)
        }, Crazy.prototype._hideBannerAd = function (e) {
            CrazyGames.SDK.banner.clearAllBanners();
            var t = document.getElementById("crazygames-ad-banner-container");
            t && t.remove(), e(cleverapps.CODE_SUCCEED)
        }, Crazy.prototype.loadOldUserId = function (e) {
            cleverapps.getFrameUserId(cleverapps.config.staticUrl, {
                key: cleverapps.config.name + "_plinga",
                callback: e
            })
        }, Crazy.AD_BANNER_HEIGHT = 50, function (e) {
            Platform.call(this, e, "sp_mbga"), this.info.isInApp = !0, this.info.isMobile = !0
        }),
        CleverApps = (SPMobage.prototype = Object.create(Platform.prototype), (SPMobage.prototype.constructor = SPMobage).prototype._connect = function (t) {
            function s(e) {
                "timeout" === e ? cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT) : cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR), t(Platform.STATUS_DISCONNECTED)
            }
            var e = function () {
                this.createFooter(), t(Platform.STATUS_CONNECTED)
            }.bind(this),
                i = cleverapps.config.debugMode ? cleverapps.SPMobageSocial.MOBAGE_API.SANDBOX : cleverapps.SPMobageSocial.MOBAGE_API.PRODUCTION;
            cleverapps.loadSdk(i, {
                onFailure: s,
                crossorigin: !1
            }), document.addEventListener("mobageReady", function () {
                try {
                    mobage.init({
                        clientId: cleverapps.social.clientData.clientId,
                        redirectUri: cleverapps.social.clientData.redirectUrl
                    }), e()
                } catch (e) {
                    console.log("Mobage init fail", e), s()
                }
            })
        }, SPMobage.prototype.getLocalStoragePreffix = function () {
            return "_sp_mbga"
        }, SPMobage.prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_JAPANESE]
        }, SPMobage.prototype.createFooter = function () {
            var e, t = document.createElement("div");
            t.style.position = "absolute", t.style.zIndex = "2", t.style.bottom = "0", t.style.height = "27px", t.style.width = "100%", t.style.background = "#e3e3e3", t.style.display = "table", t.innerHTML = "<div " + (
                e = "style='display: table-cell;\nwidth: 25%;\ntext-align: center;\nvertical-align: middle;\nborder-right: 1px solid #5f5f5f;\nfont-size: 80%;\ncolor: #5f5f5f;\nline-height: normal;\nfont-weight: bold;'") + " onclick='mobage.ui.show(\"portal\", {});'>Mobage</div><div " + e + " onclick='mobage.ui.show(\"inquiry\", {});'>お問い合わせ</div><div " + e + " onclick='mobage.ui.open(\"client_configuration\", {}, function() {});'>設定変更</div><div " + e + " onclick='mobage.ui.show(\"commercial_transaction\");'>特定商取引法</div>", document.body.appendChild(t), cleverapps.resolution.setContainerPadding({
                    bottom: 27
                })
        }, function (e) {
            Platform.call(this, e, "cleverapps")
        }),
        Yandex = (CleverApps.prototype = Object.create(Platform.prototype), (CleverApps.prototype.constructor = CleverApps).prototype._showBannerAd = function (e) {
            cleverapps.rewardedAdsManager.showBanner(e)
        }, CleverApps.prototype._hideBannerAd = function (e) {
            cleverapps.rewardedAdsManager.hideBanner(e)
        }, CleverApps.prototype.getLocalStoragePreffix = function () {
            return "_cleverapps"
        },
            CleverApps.prototype.needWindowForLogin = function () {
                return !0
            }, CleverApps.prototype.loadOldUserId = function (e) {
                try {
                    var t = cleverapps.DataLoader.localStorage.getItem(cleverapps.config.name + "_xsolla");
                    e(t && JSON.parse(t).id)
                } catch (e) {
                    console.log("parse old user error - " + t, e)
                }
            },
            function (e) {
                Platform.call(this, e, "yandex")
            }),
        VKPlatform = (Yandex.prototype = Object.create(Platform.prototype), (Yandex.prototype.constructor = Yandex).prototype._connect = function (t) {
            function e() {
                cleverapps.loadSdk("//yandex.ru/games/sdk/v2", {
                    onSuccess: s,
                    onFailure: function () {
                        console.log("Failed to load yandex sdk"), t(Platform.STATUS_DISCONNECTED)
                    }
                })
            }
            var s = cleverapps.once(function () {
                "undefined" != typeof YaGames && "function" == typeof YaGames.init ? YaGames.init().then(function (e) {
                    this.ysdk = e, this.initPlayer(t)
                }.bind(this)).catch(function () {
                    t(Platform.STATUS_DISCONNECTED)
                }) : t(Platform.STATUS_DISCONNECTED)
            }.bind(this));
            "undefined" == typeof Promise ? cleverapps.loadSdk("//cdn.jsdelivr.net/bluebird/latest/bluebird.core.min.js", {
                onSuccess: e,
                onFailure: function () {
                    console.log("Failed to load bluebird"), t(Platform.STATUS_DISCONNECTED)
                }
            }) : e()
        }, Yandex.prototype.initPlayer = function (t) {
            return this.ysdk.getPlayer({
                signed: !0
            }).then(function (e) {
                "lite" !== (this.player = e).getMode() && (this.ysdk.feedback.canReview().then(function (e) {
                    this.canReviewGame = e.value
                }.bind(this)), this.ysdk.notifications.allow()), t(Platform.STATUS_CONNECTED)
            }.bind(this)).catch(function () {
                console.log("No user init"), t(Platform.STATUS_DISCONNECTED)
            })
        }, Yandex.prototype.notifyLoaded = function () {
            this.ysdk && this.ysdk.features && this.ysdk.features.LoadingAPI && (this.ysdk.features.LoadingAPI.ready(), cleverapps.config.debugMode && console.log("LoadingAPI.ready called"))
        }, Yandex.prototype.isPlayhop = function () {
            return window.location.href.includes("playhop.com")
        }, Yandex.prototype.getLocalStoragePreffix = function () {
            return "_yandex"
        }, Yandex.prototype.getSuggestedLanguage = function () {
            return cleverapps.platform.isConnected(Platform.PLATFORM) && this.ysdk.environment.i18n ? this.ysdk.environment.i18n.lang : [PlatformInfo.LANGUAGE_RUSSIAN]
        }, Yandex.prototype.canReview = function () {
            return this.canReviewGame
        }, Yandex.prototype._requestReview = function () {
            this.ysdk.feedback.requestReview().then(function (e) {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.SOCIAL_REVIEW + e.feedbackSent)
            })
        }, Yandex.prototype.calcChannel = function (e) {
            e(Platform._parseChannel("utm_source"))
        }, Yandex.prototype.needWindowForLogin = function () {
            return !0
        }, Yandex.prototype.isFullscreenAvailable = function () {
            return !1
        }, function (e, t) {
            Platform.call(this, e, t || "web_vk")
        }),
        MobileVk = (VKPlatform.prototype = Object.create(Platform.prototype), (VKPlatform.prototype.constructor = VKPlatform).prototype._connect = function (s) {
            var e = function () {
                var t;
                vkBridge.subscribe(function (e) {
                    console.log("vkBridge event", e)
                }), vkBridge.isWebView() && this.info.setInfo({
                    isInApp: !0,
                    isMobile: !0
                }), this.info.isInApp && (t = function (e) {
                    "VKWebAppInitResult" === e.detail.type && (s(Platform.STATUS_CONNECTED),
                        vkBridge.unsubscribe(t)), "VKWebAppInitFailed" === e.detail.type && (s(Platform.STATUS_DISCONNECTED), vkBridge.unsubscribe(t), vkBridge.donate(101))
                }, vkBridge.subscribe(t)), vkBridge.send("VKWebAppInit", {}), this.info.isInApp || s(Platform.STATUS_CONNECTED)
            }.bind(this);
            cleverapps.loadSdk("//unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js", {
                onSuccess: e,
                onFailure: function () {
                    s(Platform.STATUS_DISCONNECTED)
                }
            })
        }, VKPlatform.prototype.getLocalStoragePreffix = function () {
            return "_VK"
        }, VKPlatform.prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_RUSSIAN]
        }, VKPlatform.prototype._canCreateShortcut = function () {
            return !0
        }, VKPlatform.prototype.createShortcut = function () {
            cleverapps.social.api("VKWebAppAddToFavorites")
        }, VKPlatform.prototype.calcChannel = function (e) {
            e(Platform._parseChannel("hash") || Platform._parseChannel("referrer"))
        }, VKPlatform.prototype._showBannerAd = function (t) {
            this.bannerAdListener || (this.bannerAdListener = function (e) {
                (e = e && e.detail) && "VKWebAppBannerAdUpdated" === e.type && !0 === e.data.result && cleverapps.bannerAd.onPaidEvent()
            }, vkBridge.subscribe(this.bannerAdListener)), vkBridge.send("VKWebAppShowBannerAd", {
                layout_type: "resize",
                can_close: !1
            }).then(function (e) {
                e && e.result ? (t(cleverapps.CODE_SUCCEED), cleverapps.bannerAd.onPaidEvent()) : t(e || cleverapps.CODE_FAILED)
            }).catch(function (e) {
                t(e || !0)
            })
        }, VKPlatform.prototype._hideBannerAd = function (t) {
            this.isConnected(Platform.PLATFORM) ? vkBridge.send("VKWebAppHideBannerAd").then(function (e) {
                e && e.result ? (t(cleverapps.CODE_SUCCEED), this.bannerAdListener && (vkBridge.unsubscribe(this.bannerAdListener), this.bannerAdListener = void 0)) : t(e || !0)
            }).catch(function (e) {
                t(e || !0)
            }) : t(cleverapps.CODE_FAILED)
        }, function (e) {
            VKPlatform.call(this, e, "mobile_vk")
        }),
        Huzcom = (MobileVk.prototype = Object.create(VKPlatform.prototype), (MobileVk.prototype.constructor = MobileVk).prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_RUSSIAN]
        }, MobileVk.prototype._canCreateShortcut = function () {
            return !1
        }, function (e) {
            Platform.call(this, e, "huzcom")
        }),
        Playable = (Huzcom.prototype = Object.create(Platform.prototype), (Huzcom.prototype.constructor = Huzcom).prototype.getLocalStoragePreffix = function () {
            return "_nosocial"
        }, function (e) {
            Platform.call(this, e, "playable")
        }),
        FacebookCanvas = (Playable.prototype = Object.create(Platform.prototype), (Playable.prototype.constructor = Playable).prototype.getLocalStoragePreffix = function () {
            return "_nosocial"
        }, function (e) {
            Platform.call(this, e, "facebook")
        }),
        Instant = (FacebookCanvas.prototype = Object.create(Platform.prototype), (FacebookCanvas.prototype.constructor = FacebookCanvas).prototype._connect = function (t) {
            function e(e) {
                "undefined" != typeof plugin && plugin.FacebookAgent && plugin.FacebookAgent.getInstance() && void 0 !== plugin.FacebookAgent.getInstance()._isLoggedIn ? n(Platform.STATUS_CONNECTED) : (n(Platform.STATUS_DISCONNECTED), "timeout" === e ? cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT) : cleverapps.eventLogger.logEvent(
                    cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR))
            }
            var s, i, n = cleverapps.once(function (e) {
                setTimeout(function () {
                    t(e)
                }, 500), void 0 !== i && (clearInterval(i), i = void 0), void 0 !== s && (clearTimeout(s), s = void 0), cleverapps.social.deleteAllRequests()
            });
            cleverapps.loadSdk("//connect.facebook.net/en_US/sdk.js", {
                onSuccess: function () {
                    s = setTimeout(function () {
                        e("timeout")
                    }, 1e4)
                },
                onFailure: e
            }), window.fbAsyncInit = function () {
                plugin.FacebookAgent || (cleverapps.config.plugin = {
                    facebook: {
                        status: !0,
                        version: "v3.3",
                        appId: cleverapps.config.facebook.appId
                    }
                }, cleverapps.StartFacebook(), i = setInterval(function () {
                    plugin.FacebookAgent && plugin.FacebookAgent.getInstance() && void 0 !== plugin.FacebookAgent.getInstance()._isLoggedIn && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FACEBOOK_INITED), n(Platform.STATUS_CONNECTED))
                }, 50))
            }
        }, function (e) {
            Platform.call(this, e, "instant")
        }),
        Samsung = (Instant.prototype = Object.create(Platform.prototype), (Instant.prototype.constructor = Instant).prototype.removeLoadingProgress = function (t) {
            var s;
            this.isConnected(Platform.PLATFORM) ? FBInstant.startGameAsync().then(t) : s = this.on("changeStatus:" + Platform.PLATFORM, function (e) {
                e === Platform.STATUS_CONNECTED && (s.clear(), FBInstant.startGameAsync().then(t))
            })
        }, Instant.prototype.reportProgress = function (e) {
            this.isConnected(Platform.PLATFORM) && FBInstant.setLoadingProgress(e)
        }, Instant.prototype._connect = function (i) {
            cleverapps.loadSdk("//connect.facebook.net/en_US/fbinstant.7.1.js", {
                onSuccess: function () {
                    FBInstant.initializeAsync().then(function () {
                        function e() {
                            FBInstant.player.getID() || 3e4 < Date.now() - s ? t() : setTimeout(e, 100)
                        }
                        var t, s;
                        t = function () {
                            this.preparePlatform(), i(Platform.STATUS_CONNECTED)
                        }.bind(this), s = Date.now(), e()
                    }.bind(this)).catch(function () {
                        i(Platform.STATUS_DISCONNECTED)
                    })
                }.bind(this),
                onFailure: function () {
                    i(Platform.STATUS_DISCONNECTED)
                }
            })
        }, Instant.prototype.loadOldUserId = function (t) {
            var s = cleverapps.config.facebook && cleverapps.config.facebook.appId;
            s && "heroes" === cleverapps.config.name && FBInstant.graphApi.requestAsync(
                "/me/ids_for_business").then(function (e) {
                    e = e.data.find(function (e) {
                        return e.app && e.app.id === s
                    });
                    t(e && e.id)
                }).catch(function (e) {
                    console.log("my ids error", e)
                })
        }, Instant.prototype.preparePlatform = function () {
            var e = FBInstant.getPlatform();
            switch (console.log("FB platform", e), FBInstant.getPlatform()) {
                case "IOS":
                    this.info.setInfo({
                        os: PlatformInfo.OS_IOS,
                        isInApp: /\b(FB_IAB|FBAV|FBAN|FBDV|FBMD|FBSN|FBSV|FBSS|FBID)\b/.test(window && window.navigator && window.navigator.userAgent)
                    });
                    break;
                case "IOS_IAB":
                    this.info.setInfo({
                        os: PlatformInfo.OS_IOS,
                        isInApp: !0
                    });
                    break;
                case "ANDROID":
                    this.info.setInfo({
                        os: PlatformInfo.OS_ANDROID,
                        isInApp: !0
                    })
            }
        }, Instant.prototype._canCreateShortcut = function () {
            return !cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.SHORTCUT_CREATED)
        }, Instant.prototype.createShortcut = function () {
            cleverapps.pendingRequests || FBInstant.canCreateShortcutAsync().then(function (e) {
                !cleverapps.pendingRequests && e && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SHORTCUT_SHOW),
                    cleverapps.countPendingRequests(FBInstant.createShortcutAsync()).then(function () {
                        cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SHORTCUT), cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.SHORTCUT_CREATED, 1)
                    }).catch(function () { }))
            })
        }, Instant.prototype._followOfficialPage = function () {
            cleverapps.pendingRequests || FBInstant.community.canFollowOfficialPageAsync().then(function (e) {
                !cleverapps.pendingRequests && e && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.PAGE_SHOW), cleverapps.countPendingRequests(FBInstant.community.followOfficialPageAsync()).then(function () {
                    cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.PAGE)
                }).catch(function (e) {
                    switch (e.code) {
                        case "USER_INPUT":
                            break;
                        case "PAGE_NOT_LINKED":
                            if (cleverapps.config.debugMode) {
                                cleverapps.notification.create("No page linked for staging");
                                break
                            }
                        default:
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.PAGE_ERROR), cleverapps.throwAsync(
                                "followOfficialPageAsync: " + e.code + " " + e.message)
                    }
                }))
            }).catch(function (e) {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.PAGE_ERROR), cleverapps.throwAsync("canFollowOfficialPageAsync: " + e.code + " " + e.message)
            })
        }, Instant.prototype.showOfficialPage = function () {
            this.followOfficialPage()
        }, Instant.prototype.calcChannel = function (t) {
            var s;
            cleverapps.platform.isConnected(Platform.PLATFORM) ? t(this.getChannel()) : s = cleverapps.platform.on("changeStatus:" + Platform.PLATFORM, function (e) {
                e === Platform.STATUS_CONNECTED && (t(this.getChannel()), s.clear())
            }.bind(this))
        }, Instant.prototype.getChannel = function () {
            var e = FBInstant.getEntryPointData() || {};
            return e.channel || e.fb_instant_game_campaign_id || e.fb_instant_game_adset_id || e.fb_instant_game_ad_id
        }, Instant.prototype._reportScore = function (e, t) {
            FBInstant.postSessionScoreAsync(e).then(function () {
                this.getCurrentTournamentId(t)
            }.bind(this)).catch(function () {
                t()
            })
        }, Instant.prototype.getCurrentTournamentId = function (s) {
            FBInstant.getTournamentAsync().then(function (e) {
                var t = new Date(1e3 * e.getEndTime()) < new Date;
                s(t ? void 0 : String(e.getID()))
            }).catch(function () {
                s()
            })
        }, Instant.FULL_AD_ID = function (e) {
            return cleverapps.config.instant.appId + "_" + e
        }, Instant.prototype._showBannerAd = function (s) {
            s = cleverapps.once(s), setTimeout(function () {
                s("loadBannerAdAsync timeout")
            }, Instant.AD_BANNER_TIMEOUT), FBInstant.loadBannerAdAsync(Instant.FULL_AD_ID(cleverapps.config.instant.banner)).then(function () {
                var e = cleverapps.resolution.getFrameSize(),
                    t = Instant.AD_BANNER_HEIGHT;
                this.info.isMobile && this.info.isInApp && (t = Instant.AD_BANNER_HEIGHT_MOBILE, this.info.os === PlatformInfo.OS_IOS && 780 < Math.max(e.width, e.height) && (t = Instant.AD_BANNER_HEIGHT_MOBILE + Instant.IPOHNE_HOME_INDICATOR_HEIGHT)), console.log("show instant banner " + e.width + "x" + e.height, t, this.info.os, this.info.isMobile, this.info.isInApp), s(cleverapps.CODE_SUCCEED, t)
            }.bind(this)).catch(function (e) {
                s(e || !0)
            })
        }, Instant.prototype._hideBannerAd = function (t) {
            t = cleverapps.once(t), setTimeout(function () {
                t(
                    "hideBannerAdAsync timeout")
            }, Instant.AD_BANNER_TIMEOUT), FBInstant.hideBannerAdAsync().then(function () {
                t(cleverapps.CODE_SUCCEED)
            }).catch(function (e) {
                t(e || !0)
            })
        }, Instant.AD_BANNER_TIMEOUT = cleverapps.parseInterval("30 seconds"), Instant.AD_BANNER_HEIGHT = 74, Instant.AD_BANNER_HEIGHT_MOBILE = 50, Instant.IPOHNE_HOME_INDICATOR_HEIGHT = 34, function (e) {
            Platform.call(this, e, "samsung")
        }),
        TestPlatform = (Samsung.prototype = Object.create(Platform.prototype), (Samsung.prototype.constructor = Samsung).prototype.removeLoadingProgress = function (t) {
            var s;
            this.isConnected(Platform.PLATFORM) ? GSInstant.startGameAsync().then(function () {
                cleverapps.timeouts.setTimeout(t, 3e3)
            }) : s = this.on("changeStatus:" + Platform.PLATFORM, function (e) {
                e === Platform.STATUS_CONNECTED && (s.clear(), GSInstant.startGameAsync().then(function () {
                    cleverapps.timeouts.setTimeout(t, 3e3)
                }))
            })
        }, Samsung.prototype._connect = function (e) {
            GSInstant.setOnPauseCallback(this.pause.bind(this)), GSInstant.setOnResumeCallback(this.resume.bind(this)), cleverapps.loadSdk(
                "https://img.samsungapps.com/gsinstant-sdk/iapinstant.1.0.js", {
                onSuccess: function () {
                    GSInstant.initializeAsync().then(function () {
                        console.log(GSInstant.getSupportedAPIs()), e(Platform.STATUS_CONNECTED)
                    }).catch(function () {
                        e(Platform.STATUS_DISCONNECTED)
                    })
                },
                onFailure: function () {
                    console.log("Error in load sdk"), e(Platform.STATUS_DISCONNECTED)
                },
                crossorigin: !1
            })
        }, Samsung.prototype.reportProgress = function (e) {
            this.isConnected(Platform.PLATFORM) && GSInstant.setLoadingProgress(e)
        }, Samsung.prototype.getLocalStoragePreffix = function () {
            return "_samsung"
        }, Samsung.prototype._canCreateShortcut = function () {
            return !GSInstant.canCreateShortCut().err
        }, Samsung.prototype.createShortcut = function () {
            GSInstant.createShortCut()
        }, Samsung.prototype.getCurrentTournamentId = function (e) {
            e(1)
        }, Samsung.prototype._reportScore = function (e, t) {
            GSInstant.setScoreAsync(e).then(function () {
                this.getCurrentTournamentId(t)
            }.bind(this)).catch(function () {
                t()
            })
        }, function (e) {
            Platform.call(this, e, "test")
        }),
        Xiaomi = (
            TestPlatform.prototype = Object.create(Platform.prototype), (TestPlatform.prototype.constructor = TestPlatform).prototype.getLocalStoragePreffix = function () {
                return "_test"
            }, TestPlatform.prototype.getCurrentTournamentId = function (e) {
                e(1)
            }, TestPlatform.prototype._reportScore = function (e, t) {
                console.log("Report Score", e), t()
            }, TestPlatform.prototype._followOfficialPage = function () {
                function t() {
                    new ToolConfirmWindow(function () {
                        cc.sys.openURL(cleverapps.platform.getHelpUrl())
                    }, "Follow official page")
                }
                cleverapps.meta.isFocused() ? t() : cleverapps.config.wysiwygMode || cleverapps.meta.display({
                    focus: "followOfficialPage",
                    action: function (e) {
                        t(), cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }, TestPlatform.prototype.showOfficialPage = function () {
                this.followOfficialPage()
            }, TestPlatform.prototype._showBannerAd = function (e) {
                var t, s, i, n, o = this.showBannerProb || .3;
                Math.random() > o || cleverapps.config.wysiwygMode ? e && e("No Ad.") : (this.hideBannerAd(), t = (o = this.bannerSize || cc.size(Math.min(728, Math.round(
                    .95 * cleverapps.resolution.getFrameSize().width)), 90)).height, s = o.width, 
                    (i = this.testBanner = document.createElement("div")).id = "testBanner", i.style.display = "none", i.style.position = "absolute", i.style.zIndex = "2", i.style.bottom = "0", i.style.border = "solid 2px black", i.style.margin = "0 auto", i.style.height = t + "px", i.style.fontSize = t / 2 + "px", i.style.color = "red", i.style.width = s + "px", i.style.backgroundColor = "white", i.style.right = "0", i.style.left = "0", i.innerText = "BANNER", (n = document.createElement("div")).style.fontSize = "18px", n.style.color = "black", n.innerText = s + "x" + t, i.appendChild(n), document.body.appendChild(i), e && e(cleverapps.CODE_SUCCEED, o))
            }, TestPlatform.prototype._hideBannerAd = function (e) {
                var t = document.getElementById("testBanner");
                t && t.remove(), e && e(cleverapps.CODE_SUCCEED)
            },
            function (e) {
                Platform.call(this, e, "xiaomi"), this.info.isInApp = !0, this.info.isMobile = !0
            }),
        Wechat = (Xiaomi.prototype = Object.create(Platform.prototype), (Xiaomi.prototype.constructor = Xiaomi).prototype._showBannerAd = function (e) {
            cleverapps.rewardedAdsManager.showBanner(e)
        }, Xiaomi.prototype._hideBannerAd = function (e) {
            cleverapps.rewardedAdsManager.hideBanner(e)
        }, function (e) {
            Platform.call(this, e, "wechat"), this.orientation = wx.getSystemInfoSync().deviceOrientation
        }),
        AdOcean = (Wechat.prototype = Object.create(Platform.prototype), (Wechat.prototype.constructor = Wechat).prototype._initialize = function (e) {
            this.dataLoader.localStorage = new BucketsLocalStorage(this.localStorage), e()
        }, Wechat.prototype._connect = function (e) {
            wx.onDeviceOrientationChange(function (e) {
                this.orientation = e.value
            }.bind(this)), wx.onError(function (e) {
                e.message && window.onerror(e.message)
            }), e(Platform.STATUS_CONNECTED)
        }, Wechat.prototype.getLocalStoragePreffix = function () {
            return "_wechat"
        }, Wechat.prototype.getSuggestedLanguage = function () {
            return [PlatformInfo.LANGUAGE_CHINESE]
        }, Wechat.prototype.getOrientation = function () {
            return this.orientation
        }, Wechat.prototype.isAudioContextRunning = function () {
            return !0
        }, function () {
            this.queue = [],
                this.clueToken = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.AD_OCEAN_TOKEN)
        }),
        ThinkingData = (AdOcean.prototype.requestClueToken = function () {
            var t, e;
            this.clueToken || (t = wx.getLaunchOptionsSync().query.clue_token || -1, e = "/adocean/cluetoken/" + encodeURIComponent(cleverapps.platform.getUserID()) + "/" + encodeURIComponent(t), cleverapps.RestClient.get(e, {}, function (e) {
                var t;
                e.errmsg || e.errcode ? this._logError("AdOcean.requestClueToken error: " + (e.errmsg || e.errcode)) : (t = e.clueToken, console.log("AdOcean.requestClueToken success token: " + t + ", status: " + AdOcean.STATUS[e.status]), t && this.setClueToken(t))
            }.bind(this), function (e) {
                this._logError("AdOcean.requestClueToken fail clientToken: " + t + ", response: " + JSON.stringify(e))
            }.bind(this)))
        }, AdOcean.prototype.setClueToken = function (e) {
            this.clueToken = e, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.AD_OCEAN_TOKEN, e);
            for (var t = 0; t < this.queue.length; t++) this.logEvent(this.queue[t].type, this.queue[t].data);
            this.queue = []
        },
            AdOcean.prototype.logEvent = function (t, s) {
                var e, i;
                this.clueToken ? (e = "/adocean/event/" + encodeURIComponent(cleverapps.platform.getUserID()) + "/" + encodeURIComponent(this.clueToken) + "/" + t, i = {}, t === AdOcean.EVENT_ACTIVE_PAY && (i.pay_amount = Math.floor(100 * s.price)), cleverapps.RestClient.post(e, {
                    props: i
                }, function (e) {
                    e.errmsg || e.errcode ? this._logError("AdOcean.reportEvent error: " + (e.errmsg || e.errcode) + ", clueToken: " + this.clueToken) : console.log("AdOcean.reportEvent success, type: " + t + ", data: " + JSON.stringify(s) + ", clueToken: " + this.clueToken)
                }.bind(this), function (e) {
                    this._logError("AdOcean.reportEvent fail clueToken: " + this.clueToken + ", response: " + JSON.stringify(e))
                }.bind(this))) : this.queue.length < AdOcean.QUEUE_LIMIT && this.queue.push({
                    type: t,
                    data: s
                })
            }, AdOcean.prototype._logError = function (e) {
                console.log(e), cleverapps.config.debugMode && cleverapps.notification.create(e)
            }, AdOcean.STATUS = {}, AdOcean.STATUS[0] = "no clue token", AdOcean.STATUS[1] = "found saved token", AdOcean.STATUS[2] = "token activated",
            AdOcean.EVENT_REGISTRATION = 1, AdOcean.EVENT_ACTIVE_PAY = 2, AdOcean.EVENT_NEXT_DAY_OPEN = 2, AdOcean.EVENTS_MAP = {}, AdOcean.EVENTS_MAP[cleverapps.EVENTS.GENERAL.TUTORIAL_COMPLETE] = AdOcean.EVENT_REGISTRATION, AdOcean.EVENTS_MAP[cleverapps.EVENTS.STATS.PAYMENTS] = AdOcean.EVENT_ACTIVE_PAY, AdOcean.EVENTS_MAP[cleverapps.EVENTS.TARGET_FOR_BUYING.RETENTION_1] = AdOcean.EVENT_NEXT_DAY_OPEN, AdOcean.QUEUE_LIMIT = 100, AdOcean.IsAvailable = function () {
                return !1
            },
            function () {
                window.thinkingdata = new ThinkingAnalyticsAPI({
                    appId: cleverapps.config.wechat.thinkingData.appId,
                    serverUrl: cleverapps.config.wechat.thinkingData.serverUrl,
                    autoTrack: {
                        appShow: !0,
                        appHide: !0
                    }
                }), this.queue = [], this.trackedTutorials = cleverapps.createSet(ThinkingData.TUTORIALS_ORDER), thinkingdata.init(), this.initTotalAmount(), this.updateUserId()
            }),
        GravityEngine = (ThinkingData.prototype.initTotalAmount = function () {
            this.totalPriceAmount = cleverapps.paymentsHistory.price.reduce(function (e, t) {
                t = cleverapps.payments.calcLoadedPrice(t);
                return e + cleverapps.payments.getLoadedPriceAmount(t)
            }, 0)
        }, ThinkingData.prototype.updateUserId = function () {
            if (!cleverapps.platform.haveTmpId()) {
                this.initialized = !0, thinkingdata.login(cleverapps.platform.getUserID()), this.send("userSetOnce", {
                    register_time_v1: new Date(cleverapps.user.registered)
                }), cleverapps.user.channel && this.send("userSetOnce", {
                    channel: cleverapps.user.channel
                }), this.send("userSet", {
                    last_login_time: new Date,
                    current_coin: cleverapps.user.soft,
                    current_diamond: cleverapps.user.gold,
                    current_level: Math.round(cleverapps.user.getFloatLevel()),
                    current_energy: cleverapps.lives && cleverapps.lives.amount,
                    current_hero: cleverapps.unitsLibrary && cleverapps.unitsLibrary.listOpenedOfType("hero").length
                });
                for (var e = 0; e < this.queue.length; e++) this.send(this.queue[e].method, this.queue[e].properties);
                this.queue = []
            }
        }, ThinkingData.prototype.logEvent = function (e, t) {
            (t = Object.assign({}, t || {}, {
                cur_level: Math.round(cleverapps.user.getFloatLevel()),
                cur_diamond: cleverapps.user.gold,
                cur_coin: cleverapps.user.soft,
                cur_energy: cleverapps.lives && cleverapps.lives.amount,
                total_days: cleverapps.user.getDaysSinceRegistration(),
                total_purchase_amount: this.totalPriceAmount
            })).store_type && (t.store_type = t.store_type.replace("ShopWindow.title.", "")), t.eventName = e, this.send("track", t)
        }, ThinkingData.prototype.logPurchase = function (e) {
            this.totalPriceAmount += e.loadedPriceAmount, this.send("userSetOnce", {
                first_pay_time: new Date
            }), this.send("userSet", {
                last_pay_time: new Date
            }), this.send("userAdd", {
                total_pay_amount: e.loadedPriceAmount,
                total_pay_count: 1
            })
        }, ThinkingData.prototype.logTutorialStep = function (e, t) {
            if (this.trackedTutorials[e]) {
                for (var s = t, i = 0; i < ThinkingData.TUTORIALS_ORDER.length; i++) {
                    var n = ThinkingData.TUTORIALS_ORDER[i];
                    if (n === e) break;
                    s += MergeTutorials[n].steps.length
                }
                this.logEvent("new_guide", {
                    new_guide_id: s
                })
            }
        }, ThinkingData.prototype.logWatchAds = function () {
            this.send("userAdd", {
                total_ad_num: 1
            })
        }, ThinkingData.prototype.send = function (e, t) {
            if (!this.initialized) return this.queue.push({
                method: e,
                properties: t
            }), void (this.queue.length > ThinkingData.QUEUE_LIMIT && this.queue.shift());
            switch (e) {
                case "userSetOnce":
                case "userSet":
                case "userAdd":
                    thinkingdata[e](t);
                    break;
                case "track":
                    var s = t.eventName;
                    delete t.eventName, thinkingdata.track(s, t)
            }
        }, ThinkingData.TUTORIALS_ORDER = ["dwarf", "wheat_3", "dishes_0", "openfog2", "wood_1", "wood_2"], ThinkingData.IsAvailable = function () {
            return cleverapps.platform.oneOf(Wechat) && cleverapps.config.wechat && cleverapps.config.wechat.thinkingData
        }, ThinkingData.QUEUE_LIMIT = 100, function () {
            this.connected = !1, this.queue = [], this.connect(), cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, this.connect.bind(this)), cleverapps.timeouts.setInterval(this.connect.bind(this), cleverapps.parseInterval("2 minutes"))
        }),
        SocialHelper = (GravityEngine.prototype.updateUserId = function () {
            this.connected = !1, this.connect()
        }, GravityEngine.prototype.connect = function () {
            var e;
            cleverapps.platform.haveTmpId() || this.connected || this.connecting || (this.connecting = !0,
                e = {
                    accessToken: cleverapps.config.wechat.gravityEngine.accessToken,
                    clientId: cleverapps.platform.getUserID(),
                    autoTrack: {
                        appLaunch: !0,
                        appShow: !0,
                        appHide: !0
                    },
                    name: "ge",
                    sendTimeout: 2e4,
                    debugMode: cleverapps.config.debugMode && "debug"
                }, this.gravityEngine = new GravityEngineAPI(e), this.gravityEngine.setupAndStart(), this.gravityEngine.initialize({
                    name: cleverapps.platform.getUserID(),
                    version: GravityEngine.VERSION,
                    openid: cleverapps.platform.getUserID()
                }).then(function (e) {
                    this.connecting = !1, this.connected = !0, console.log("GravityEngine.initialize success " + JSON.stringify(e)), this.connectionError && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.GRAVITY_RECONNECT), this.gravityEngine.registerEvent();
                    for (var t = 0; t < this.queue.length; t++) this.send(this.queue[t].method, this.queue[t].properties);
                    this.queue = []
                }.bind(this)).catch(function (e) {
                    this.connecting = !1, this.connectionError || (this.connectionError = !0, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.GRAVITY_INIT_ERROR)), console.log(
                        "GravityEngine.initialize failed " + JSON.stringify(e)), cleverapps.config.debugMode && cleverapps.notification.create("GravityEngine.initialize failed" + JSON.stringify(e))
                }.bind(this)))
        }, GravityEngine.prototype.logPurchase = function (e, t) {
            this.send("payEvent", {
                product: e,
                purchase: t
            })
        }, GravityEngine.prototype.logAd = function (e) {
            this.send("adShowEvent", {
                name: e
            })
        }, GravityEngine.prototype.send = function (e, t) {
            if (!this.connected) return this.queue.push({
                method: e,
                properties: t
            }), void (this.queue.length > GravityEngine.QUEUE_LIMIT && this.queue.shift());
            switch (e) {
                case "payEvent":
                    var s = t.product || {},
                        i = t.purchase || {};
                    console.log("GravityEngine.payEvent", 100 * s.loadedPriceAmount, "CNY", i.paymentId, "" + s.key), this.gravityEngine.payEvent(100 * s.loadedPriceAmount, "CNY", i.paymentId, "" + s.key, "WeChat");
                    break;
                case "adShowEvent":
                    console.log("GravityEngine.adShowEvent", t.name, cleverapps.config.wechat.rewarded), this.gravityEngine.adShowEvent(t.name, cleverapps.config.wechat.rewarded)
            }
        }, GravityEngine.QUEUE_LIMIT = 100,
            GravityEngine.VERSION = 475, GravityEngine.IsAvailable = function () {
                return cleverapps.platform.oneOf(Wechat) && cleverapps.config.wechat && cleverapps.config.wechat.gravityEngine
            }, {
            NoSocialPlatforms: [Pliega, Rustore, Huzcom, IOSCh, Playable, GDCom, Xiaomi, PWA],
            create: function () {
                if (cleverapps.platform.oneOf(SocialHelper.NoSocialPlatforms)) return cleverapps.social = new cleverapps.NoSocial, cleverapps.social;
                if (WebViewFacebook.isAvailable() && (cleverapps.AndroidSocial.isAvailable() || cleverapps.AppleSocial.isAvailable())) return cleverapps.social = new cleverapps.SelectSocial, cleverapps.social;
                var e = TestSocial.isAppropriate() ? {
                    default: TestSocial
                } : {
                    instant: cleverapps.InstantSocial,
                    mobile_ok: cleverapps.OKSocial,
                    web_ok: cleverapps.OKSocial,
                    mobile_mm: cleverapps.MobileMyMailRuSocial,
                    web_mm: cleverapps.MyMailRuSocial,
                    mobile_vk: cleverapps.MobileVkSocial,
                    web_vk: cleverapps.VKSocial,
                    sp_mbga: cleverapps.SPMobageSocial,
                    mbga: cleverapps.MobageSocial,
                    draugiem: cleverapps.DraugiemSocial,
                    fotostrana: cleverapps.FotoStranaSocial,
                    cleverapps: cleverapps.XsollaSocial,
                    yandex: cleverapps.YandexSocial,
                    macos: cleverapps.AppleSocial,
                    gpg: cleverapps.AndroidSocial,
                    amazon: WebViewFacebook,
                    samsung: cleverapps.SamsungSocial,
                    mygames: cleverapps.MygamesSocial,
                    microsoft: cleverapps.MicrosoftFacebook,
                    msstart: cleverapps.MSStartSocial,
                    plng: cleverapps.PlingaSocial,
                    kongregate: cleverapps.KongregateSocial,
                    crazy: CrazySocial,
                    ton: cleverapps.TonSocial,
                    wortal: cleverapps.WortalSocial,
                    wechat: cleverapps.WechatSocial,
                    default: cleverapps.FacebookCanvasSocial
                },
                    e = e[cleverapps.platform.source] || e.default;
                return cleverapps.social = new e, cleverapps.social
            }
        }),
        Reward = (cleverapps.SocialManager = {
            onFailedLogin: function () {
                cleverapps.notification.create("SocialManager.FailedLogging")
            },
            onLogin: function (e) {
                var t = e.newId,
                    s = e.oldId;
                if (Platform.isTmpId(s) || Platform.isDeviceId(s)) cleverapps.RestClient.post("/users/off/" + s, {
                    newId: t
                }, function (e) {
                    console.log("Success marked off: " + s + ", newId: " + t + ", response " + JSON.stringify(e))
                }, function () {
                    console.log(
                        "Failed marking off: " + s + ", newId: " + t)
                }), levels.user.setLoggedIn(Date.now()), cleverapps.synchronizer.reset(), cleverapps.info.onChangeUserId(), cleverapps.userClan && (cleverapps.userClan.changeUserId(s, t), cleverapps.userClan.load()), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.LOGIN, {
                    method: cleverapps.platform.source
                });
                else if (s !== t) {
                    if (console.log("second login! old - " + s + ", new - " + t), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DEBUG.SECOND_LOGIN), cleverapps.config.debugMode && cleverapps.platform.oneOf(Wechat) && alert("second login! old - " + s + ", new - " + t), !(cleverapps.platform.info.isNative || cleverapps.platform.oneOf(MSStart, Wechat) || cleverapps.platform.oneOf(WortalPlatform) && (cleverapps.config.debugMode || cleverapps.platform.debugMode))) return cleverapps.DataLoader.cleanAll(), cleverapps.DataLoader.setEnabled(!1), void window.location.reload();
                    cleverapps.synchronizer.reset()
                }
                cleverapps.DataLoader.processSaveQueue(), cleverapps.social.deleteAllRequests(),
                    cleverapps.synchronizer.syncWhenReady(), cleverapps.whenAllInitialized(this.onLoginRefreshes.bind(this))
            },
            onLoginRefreshes: function () {
                !cleverapps.platform.oneOf(MobileVk, VKPlatform, GDCom, Plinga) && cleverapps.social.getName() && cleverapps.notification.create("SocialManager.Connected", {
                    facebook: cleverapps.social.getName()
                }), cleverapps.social.aboutMe(this.onLoadUserInfo.bind(this)), cleverapps.friends.reload(), cleverapps.invitalbleFriends.reload(), cleverapps.platform.oneOf(TestPlatform) && RewardedAdsManager.initialize(), cleverapps.restoreProgress.update(), cleverapps.adOcean && cleverapps.adOcean.requestClueToken(), cleverapps.thinkingData && cleverapps.thinkingData.updateUserId(), cleverapps.gravityEngine && cleverapps.gravityEngine.updateUserId(), cleverapps.googleAnalytics && cleverapps.googleAnalytics.updateUserId()
            },
            onLoadUserInfo: function (s) {
                var e;
                cleverapps.friends.updatePlayerInfo(s), s.currency && s.currency.user_currency && (e = s.currency.user_currency, Product.CURRENCY_SIGNS[e] && (
                    Product.CURRENCY = Product.CURRENCY_SIGNS[e], Product.CURRENCY_CODE = e)), s.first_name && !cleverapps.flags.nologin && setTimeout(function () {
                        var e, t = cleverapps.friends.getPlayer();
                        t.avatar && t.avatar !== FriendsCache.DEFAULT_PLAYER_INFO().avatar && ((e = new cleverapps.UI.Avatar(t)).width && e.height || (e = void 0)), cleverapps.notification.create("SocialManager.Welcome", {
                            toReplace: {
                                userName: s.first_name
                            },
                            image: e
                        })
                    }, 1e3), s.name && (e = s.name.substr(0, 50), cleverapps.info.setKeyValue("name", e)), s.picture && s.picture.data && s.picture.data.url && cleverapps.info.setKeyValue("avatar", s.picture.data.url), cleverapps.periodicBonus && cleverapps.periodicBonus.refreshItems()
            }
        }, function (e, t, s) {
            this.type = e, this.value = t, this.options = s || {}, this.options.onFinish && (this.options.onFinish = cleverapps.once(this.options.onFinish)), -1 !== ["unlimitedLives", "worker"].indexOf(this.type) && (this.value = Product.FormatTimePeriod(this.value))
        }),
        RewardsList = (Reward.prototype.receiveReward = function () {
            this.getAmount() && (
                this.handler = RewardTypes[this.type].handler.call(this, this.value, this.options))
        }, Reward.prototype.onAnimationFinished = function () {
            this.handler && this.handler(), this.options.onFinish && this.options.onFinish();
            var e, t = this.getAmount();
            t && ((e = cleverapps.aims.getTarget(this.getFlyingTarget())).aim.noTargetDelta || e.aim.controls && 0 === e.aim.controls.indexOf("MenuBar") || (cleverapps.scenes.getRunningScene().runAction(new cc.CollectEffect(e)), e.aim.withoutDelta || cleverapps.UI.animateDelta(+t || 0, {
                x: cleverapps.styles.Reward.sidebarDelta.x,
                y: cleverapps.styles.Reward.sidebarDelta.y,
                font: cleverapps.styles.FONTS.SCENE_ANIMATE_DELTA_TEXT,
                parent: e
            })))
        }, Reward.prototype.getAmount = function () {
            return Array.isArray(this.value) ? this.value : -1 !== ["units", "battlePass", "kraken", "growthFund", "troop"].indexOf(this.type) ? this.value.amount || 1 : "object" == typeof this.value ? this.value.amount || this.value.level || this.value.time || +this.value.subscription || 0 : this.value || 0
        }, Reward.prototype.getIcon = function (e) {
            var t,
                s = cleverapps.styles.Reward,
                i = {};
            return this.options.icons && this.options.icons[this.type] && !e ? i.frame = this.options.icons[this.type] : "mission" === this.type ? (e = Mission.ParseCompoundType(this.value.missionType).type, i.frame = RewardTypes[this.type].icon[e] || Mission.getCollectIcon(e)) : "boosters" === this.type ? i.frame = RewardTypes.boosters.icon[this.value.id] : "battlePass" === this.type ? (i.json = bundles.passbuyticket_window.jsons[this.value.missionType === Mission.TYPE_SALEPASS ? "purchase_ticket_json" : "ticket_json"], i.animation = "animation") : "units" === this.type ? i.unit = this.value : "herolevels" === this.type ? (i.json = bundles.heroes.jsons[this.value.color.toUpperCase() + "_hero_spine_json"], i.scale = 1.5, i.skin = match3.heroes.getCurrentSkin(), i.animation = "idle") : "piggyBank" === this.type ? i.frame = bundles.piggy_bank_reward.frames.piggy_bank_reward_icon : "clover" === this.type && Game.currentGame && Game.currentGame.secondaryMission ? i.frame = Game.currentGame.secondaryMission.getIcon() : "cup" === this.type ? i.frame = RewardTypes[this.type].icon[this.value.type] : "keys" === this.type ? i.key = this.value : "troop" === this.type ? i.troop = this.value : "simpleStar" === this.type || "homeStar" === this.type ? i.frame = bundles.reward_icons.frames.simple_star_png : i.frame = RewardTypes[this.type].icon, i.troop ? t = WarriorView.getUnitImage(WarriorLines[i.troop.code], i.troop.stage) : i.unit ? (t = UnitView.getUnitImage(i.unit, {
                alignAnchorX: !0,
                preferStatic: !0
            }), cleverapps.UI.fitToBox(t, s.icon)) : i.json ? ((t = new cleverapps.Spine(i.json, i.scale || 1)).setAnimation(0, i.animation, !0), i.skin && t.setSkin(i.skin)) : t = i.frame ? new cc.Sprite(i.frame) : i.key ? new QuestItemView(i.key, !0) : (cleverapps.throwAsync("Reward icon is undefined - " + this.type), new cc.Node), t
        }, Reward.prototype.getSmallIcon = function (e) {
            var t = cleverapps.styles.Reward,
                s = {};
            return this.options.icons && this.options.icons[this.type] && !e ? s.frame = this.options.icons[this.type] : "boosters" === this.type ? s.frame = RewardTypes.boosters.smallIcon[this.value.id] : "mission" === this.type ? s.frame = RewardTypes.mission.smallIcon[Mission.ParseCompoundType(this.value.missionType).type] : "cup" === this.type ? s.frame = RewardTypes[this.type].smallIcon[this.value.type] : s.frame = RewardTypes[this.type].smallIcon, s = s.frame ? new cc.Sprite(s.frame) : this.getIcon(e), cleverapps.UI.fitToBox(s, t.smallIcon), s
        }, Reward.prototype.getFlyingAmount = function () {
            var e = this.getAmount();
            if (-1 !== ["unlimitedLives", "worker"].indexOf(this.type)) return 1;
            if ("wands" === this.type) return e <= 3 ? e : Math.min(5, Math.floor(e / 50) + 3);
            if ("energy" === this.type) return Math.min(5, Math.floor(e / 5) + 1);
            if ("mission" === this.type) {
                if (this.value.missionType === Mission.TYPE_KRAKENFEAST) return Math.min(3, e);
                if (this.value.missionType === Mission.TYPE_SOFTFEAST) {
                    if (500 <= e) return 4;
                    if (150 <= e) return 3;
                    if (e) return 2
                }
                if (
                    this.value.missionType === Mission.TYPE_LIVESFEAST) {
                    if (20 <= e) return 3;
                    if (10 <= e) return 2;
                    if (e) return 1
                }
            }
            return 100 <= e ? 8 : 50 <= e ? 5 : 3 <= e ? 3 : e
        }, Reward.prototype.getFlyingTarget = function () {
            return this.options.target || ("boosters" === this.type ? "boosters" + this.value.id : "mission" === this.type ? cleverapps.resolution.mode !== cleverapps.WideMode.VERTICAL ? "mission" + this.value.missionType : void 0 : "clover" === this.type ? cleverapps.resolution.mode !== cleverapps.WideMode.VERTICAL ? "mission" + Game.currentGame.secondaryMission.type : void 0 : "units" === this.type && this.options.toMainWorld ? "mainWorld" : "cup" === this.type ? "cup" + this.value.type : "gold" === this.type || "rubies" === this.type ? "hard" : "coins" === this.type ? "soft" : "unlimitedLives" === this.type || "energy" === this.type ? "lives" : this.type)
        }, Reward.prototype.getText = function (e) {
            if ("unlimitedLives" === this.type) return this.value.title;
            if ("battlePass" === this.type) return "PassProduct.Title";
            if ("worker" === this.type) return this.value.subscription ? e + (this.value.amount || 1) : Messages.get(
                this.value.title, {
                amount: this.value.time
            });
            if ("growthFund" === this.type) return "Shop.growthFund.title";
            if ("piggyBank" === this.type && cleverapps.piggyBank.isFull()) return "VictoryWindowBase.piggyBankFull";
            e = e ? String(e) : "";
            return "boosters" === this.type || "keys" === this.type || "randomBoosters" === this.type || "mission" === this.type ? e += this.value.amount : "units" === this.type || "troop" === this.type ? e += this.value.amount || 1 : "herolevels" === this.type ? e += Math.max(0, Math.min(Heroes.HEROES_MAX_LEVEL, this.value.level)) : Array.isArray(this.value) ? e += this.value.join("-") : "kraken" === this.type ? e += "3" : e += this.value, e
        }, Reward.prototype.listControls = function () {
            return cleverapps.toArray(RewardTypes[this.type].controls) || []
        }, Reward.prototype.listBundles = function () {
            return cleverapps.toArray(RewardTypes[this.type].bundle) || []
        }, Reward.prototype.collectRewardsAnimation = function (e, t) {
            if (t = t || {}, this.getAmount()) {
                var s, i = cleverapps.scenes.getRunningScene(),
                    n = this.getFlyingTarget(),
                    o = cleverapps.aims.getTarget(n),
                    n = (t.sound || (
                        "mission" === this.type && this.value.missionType === Mission.TYPE_SOFTFEAST ? t.sound = bundles.menubar.urls.coins_effect : -1 === ["hard", "soft", "exp", "worker", "wands"].indexOf(n) && (t.sound = bundles.menubar.urls.exp_fly_finish_effect)), Reward.COLLECT_ANIMATION);
                if (t.flyingAnimation ? n = t.flyingAnimation : RewardTypes[this.type].flyingAnimation ? n = RewardTypes[this.type].flyingAnimation : o.aim.flyingAnimation && (n = o.aim.flyingAnimation), e) switch (n) {
                    case Reward.SPAWN_UNITS_ANIMATION:
                        s = this.spawnUnitsAnimation(this.spawnedUnits, e);
                        break;
                    case Reward.SPAWN_CARDS_ANIMATION:
                        s = this.spawnCardsAnimation(this.spawnedCards, e, o);
                        break;
                    case Reward.JUMP_COLLECT_ANIMATION:
                        s = this.jumpCollectAnimation(e, o, t);
                        break;
                    case Reward.COLLECT_ANIMATION:
                        s = this.collectAnimation(e, o, t)
                }
                n = new cc.CallFunc(this.onAnimationFinished.bind(this)), s && (n = new cc.Sequence(s, n)), o.aim.scrollsToTarget && o.aim.scrollsToTarget() && (n = new cc.Spawn(n, new cc.TargetedAction(i.scroll, new cc.ScrollAction(o, {
                    skipFocusReport: !0,
                    duration: 1,
                    visibleBox: {
                        left: .4,
                        right: .4,
                        top: .4,
                        bottom: .4
                    }
                })))), i.runAction(new cc.Sequence(new cc.DelayTime((t.delay || 0) / 1e3), n, new cc.CallFunc(t.callback)))
            }
        }, Reward.prototype.collectAnimation = function (e, t, s) {
            if (e = e.onGetView ? e.onGetView() : e) return e.stopAllActions(), new cc.TargetedAction(e, new cc.Sequence(cleverapps.UI.animateCollect(e, t, {
                path: s.path,
                adjustToTarget: !0,
                sound: s.sound
            }), new cc.CallFunc(function () {
                t.aim && t.aim.animate && t.aim.animate()
            }), new cc.RemoveSelf))
        }, Reward.prototype.spawnUnitsAnimation = function (e, t) {
            return t.replaceParentSamePlace(cleverapps.scenes.getMovingNode(t), {
                keepScale: !0
            }), new cc.TargetedAction(t, new cc.Sequence(new cc.CallFunc(function () {
                Game.currentGame.spawnAction(e, [], t, {
                    fromNode: !0,
                    startScale: t.adjustScaleTo(Game.currentGame.map.getView().animations),
                    startAnchors: {
                        anchorX: .5,
                        anchorY: .5
                    }
                })
            }), new cc.DelayTime(.2), new cc.Hide, new cc.DelayTime(.5), new cc.RemoveSelf))
        }, Reward.prototype.spawnCardsAnimation = function (e, t, s) {
            var i = cleverapps.scenes.getRunningScene(t),
                n = i.convertToNodeSpace(t.parent.convertToWorldSpace(t)),
                o = (cleverapps.aims.showTarget(s), []);
            return e.forEach(function (t) {
                o.push(new cc.DelayTime(.3)), o.push(new cc.CallFunc(function () {
                    cleverapps.aims.showTarget(s);
                    var e = new (t.getViewClass())(t);
                    e.setPositionRound(n), i.addChild(e), Game.currentGame.hand.push(t, {
                        insertIndex: cleverapps.Random.random(Game.currentGame.hand.stack.length)
                    }), cleverapps.audio.playSound(bundles.game.urls.plus_card_effect)
                }))
            }), new cc.Sequence(o)
        }, Reward.prototype.jumpCollectAnimation = function (a, r, c) {
            c = c || {}, a instanceof cc.Node ? (l = cleverapps.scenes.getMovingNode(a), p = l.convertToNodeSpace(a.parent.convertToWorldSpace(a.getPosition()))) : (l = Game.currentGame.map.getView().animations, p = Game.currentGame.map.getView().alignInIsometricGrid(a.x, a.y), d = !0);
            var l, p, d, t = cleverapps.styles.Reward.jumpCollect,
                v = c.beginScale || .5,
                u = t.delta.scale,
                m = c.finalScale || u,
                h = this.getFlyingAmount(),
                g = [];
            return cleverapps.arrayFill(h).forEach(function (e, t) {
                var s = !1 === c.small ? this.getIcon(!0) : this.getSmallIcon(!0),
                    i = s.scale * v,
                    n = s.scale * u,
                    o = Math.min(r.getGlobalBoundingBox().width / s.width, m);
                s.setScale(i), s.setPositionRound(p), l.addChild(s), s.setLocalZOrder(1 / (1 + t)), s.setVisible(!1), g.push(new cc.TargetedAction(s, new cc.Sequence(new cc.DelayTime(.1 * t + .1 * Math.random()), new cc.Show, new cc.CallFunc(function () {
                    c.hideSource && a.setVisible(!1)
                }), cleverapps.UI.animateJumpCollect(s, r, {
                    collectMovingNode: d && cleverapps.windows.isActive() && l,
                    jumpScale: n,
                    jumpOffset: t / h,
                    collectScale: o,
                    collectSound: c.sound
                }), new cc.CallFunc(function () {
                    cleverapps.aims.showTarget(r), r.aim && r.aim.animate && r.aim.animate()
                }), new cc.RemoveSelf)))
            }.bind(this)), new cc.Sequence(new cc.Spawn(g), new cc.CallFunc(function () {
                var e;
                d && !c.withoutDelta && ((e = this.getSmallIcon()).setScale(e.scale * u), cleverapps.UI.animateDelta(h, {
                    icon: e,
                    x: p.x,
                    y: p.y + t.delta.dy + (c.deltaOffset || 0),
                    parent: l,
                    font: cleverapps.styles.FONTS.SCENE_ANIMATE_DELTA_TEXT
                }))
            }.bind(this)))
        }, Reward.prototype.isFlyingUnderShadow = function () {
            var e = cleverapps.aims.getTarget(this.getFlyingTarget());
            return e && e.aim && e.aim.flyingUnderShadow
        }, Reward.NO_ANIMATION = 1, Reward.COLLECT_ANIMATION = 2, Reward.SPAWN_UNITS_ANIMATION = 3, Reward.SPAWN_CARDS_ANIMATION = 4, Reward.JUMP_COLLECT_ANIMATION = 5, cleverapps.styles.Reward = {
            sidebarDelta: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 75
                }
            },
            icon: {
                height: 130,
                maxScale: 1.5
            },
            smallIcon: {
                height: 70
            },
            jumpCollect: {
                delta: {
                    dy: 80,
                    scale: .8
                },
                jumpRight: {
                    x1: 50,
                    x2: 150,
                    y1: -50,
                    y2: -100
                },
                jumpLeft: {
                    x1: -50,
                    x2: -150,
                    y1: -50,
                    y2: -100
                },
                jumpBoth: {
                    x1: -50,
                    x2: 50,
                    y1: -50,
                    y2: -100
                }
            },
            flyHint: {
                speed: 3e3
            }
        }, function (i, e) {
            this.options = e || {}, this.rewards = [], Object.keys(i).forEach(function (t) {
                var s = i[t];
                if (RewardTypes[t = "unit" === t ? "units" : t])
                    if ("boosters" !== t)
                        if ("keys" !== t)
                            if ("herolevels" !== t)
                                if ("units" !== t)
                                    if ("mission" !== t) {
                                        if ("clover" !== t || Game.currentGame && Game.currentGame.secondaryMission && Game.currentGame.secondaryMission.isRunning())
                                            if ("troopCards" !== t) this.rewards.push(new Reward(t, s, this.options));
                                            else
                                                for (var e = 0; e < s.amount; e++) this.rewards.push(new Reward("troop", {
                                                    code: TroopCards.PickCode(s.probabilities),
                                                    stage: 0
                                                }))
                                    } else cleverapps.missionManager.findRunningMission(s.missionType) && this.rewards.push(new Reward(t, s, this.options));
                                else cleverapps.toArray(s).forEach(function (e) {
                                    this.rewards.push(new Reward(t, e, this.options))
                                }, this);
                            else s.forEach(function (e) {
                                this.rewards.push(new Reward(t, {
                                    color: e[0],
                                    level: e[1]
                                }, this.options))
                            }, this);
                        else Object.keys(s).filter(function (e) {
                            return s[e]
                        }).forEach(function (e) {
                            this.rewards.push(new Reward(t, {
                                name: e,
                                amount: s[e]
                            }, this.options))
                        }, this);
                    else Object.keys(s).filter(function (e) {
                        return s[e]
                    }).forEach(function (e) {
                        this.rewards.push(new Reward(t, {
                            id: e,
                            amount: s[e]
                        }, this.options))
                    }, this);
                else cleverapps.throwAsync("unknown reward type '" + t + "'")
            }, this), this.rewards = this.sortRewards()
        }),
        RewardsConfig = (RewardsList.prototype.sortRewards = function () {
            return this.rewards.filter(function (e) {
                return !e.isFlyingUnderShadow()
            }).concat(this.rewards.filter(function (e) {
                return e.isFlyingUnderShadow()
            }))
        }, RewardsList.prototype.receiveRewards = function () {
            this.received || (this.received = !0, this.rewards.forEach(function (e) {
                e.receiveReward()
            }))
        }, RewardsList.prototype.onAnimationFinished = function () {
            this.rewards.forEach(function (e) {
                e.onAnimationFinished()
            })
        }, RewardsList.prototype.listRewards = function () {
            return this.rewards
        }, RewardsList.prototype.listControls = function () {
            return this.rewards.reduce(function (e, t) {
                return e.concat(t.listControls())
            }, [])
        }, RewardsList.prototype.listBundles = function () {
            return this.rewards.reduce(function (e, t) {
                return e.concat(t.listBundles())
            }, [])
        }, RewardsList.prototype.isBigReward = function () {
            return this.rewards.some(function (e) {
                return "units" === e.type && ("coinsplant" === e.value.code || "rubiesplant" === e.value.code || "magicplant" === e.value.code && 5 === e.value.stage)
            })
        }, RewardsList.prototype.collectRewardsAnimation = function (t, s) {
            var i = ["left", "right"],
                n = (s = s || {}).delay || 0,
                o = 0,
                a = 0;
            return this.rewards.forEach(function (e) {
                s.jumpSide = i[o % i.length],
                    s.delay = n, s.deltaOffset = a, e.collectRewardsAnimation(t, s), o += 1, n += 500 + 250 * e.getFlyingAmount(), a += cleverapps.styles.RewardsList.deltaOffset
            }), n || 0
        }, RewardsList.prototype.filter = function (e) {
            this.rewards = this.rewards.filter(e)
        }, RewardsList.prototype.underShadowRewardIndex = function () {
            for (var e = 0; e < this.rewards.length; ++e)
                if (this.rewards[e].isFlyingUnderShadow()) return e;
            return e
        }, cleverapps.styles.RewardsList = {
            deltaOffset: -28
        }, {
            Packs: [],
            Tournament: {},
            DailyCup: [],
            WeeklyCup: [],
            ClanCup: [],
            BonusWorld: [{
                level: 3,
                reward: {
                    boosters: {
                        13: 1,
                        14: 1
                    }
                }
            }, {
                level: 8,
                reward: {
                    hard: 50,
                    boosters: {
                        13: 1,
                        14: 1
                    }
                }
            }, {
                level: 15,
                reward: {
                    hard: 200,
                    boosters: {
                        13: 1,
                        14: 1,
                        15: 1
                    }
                }
            }],
            ShortMeta: {
                5: {
                    hard: {
                        factor: 3
                    }
                },
                9: {
                    hard: {
                        factor: 3
                    }
                }
            },
            PeriodicBonusSale: [{
                id: 0,
                product: "gold500",
                profit: "+60%",
                reward: {
                    hard: 300
                }
            }, {
                id: 1,
                product: "gold1800",
                profit: "+56%",
                reward: {
                    hard: 1e3
                }
            }, {
                id: 2,
                product: "gold3800",
                profit: "+53%",
                reward: {
                    hard: 2e3
                }
            }, {
                id: 3,
                product: "gold6000",
                profit: "+50%",
                reward: {
                    hard: 3e3
                }
            }, {
                id: 4,
                product: "gold25000",
                profit: "+40%",
                reward: {
                    hard: 1e4
                }
            }]
        }),
        Payments = ("battlefield" === cleverapps.config.type && (RewardsConfig.ShortMeta = {
            5: {
                soft: {
                    factor: 3
                }
            },
            9: {
                soft: {
                    factor: 3
                }
            }
        }, RewardsConfig.Packs = {
            0: {
                hard: 100,
                soft: 500,
                troopCards: {
                    probabilities: [100, 0, 0],
                    amount: 5
                }
            },
            1: {
                hard: 500,
                soft: 2500,
                troopCards: {
                    probabilities: [0, 100, 0],
                    amount: 7
                }
            },
            2: {
                hard: 2e3,
                soft: 1e4,
                troopCards: {
                    probabilities: [0, 0, 100],
                    amount: 10
                }
            }
        }), "board" === cleverapps.config.type && (RewardsConfig.Tournament = {
            places: [{
                hard: 300
            }, {
                hard: 250
            }, {
                hard: 200
            }, {
                hard: 100
            }, {
                hard: 50
            }]
        }, RewardsConfig.TreasureSearch = {
            hard: 100
        }, RewardsConfig.StickersCollection = {
            hard: 100
        }, RewardsConfig.DailyTask = {
            easy: [{
                hard: 80
            }],
            medium: [{
                hard: 120
            }],
            hard: [{
                hard: 160
            }],
            completeAll: [{
                hard: 180
            }]
        }, RewardsConfig.DailyCup = [{
            hard: 400
        }, {
            hard: 250
        }, {
            hard: 150
        }, {
            hard: 50
        }, {
            hard: 50
        }, {
            hard: 50
        }, {
            hard: 50
        }, {
            hard: 50
        }, {
            hard: 50
        }, {
            hard: 50
        }], RewardsConfig.Packs = [{
            hard: 800
        }, {
            hard: 2600
        }, {
            hard: 17e3
        }], RewardsConfig.Subscription = {
            hard: 600
        }, RewardsConfig.MiniGame = [{
            hard: 50
        }, {
            hard: 100
        }], RewardsConfig.MiniGameNovice = [{
            hard: 50
        }],
            RewardsConfig.CookieJar = {
                hard: 50
            }), "match3" === cleverapps.config.type && (RewardsConfig.MiniGame = [{
                hard: 50
            }, {
                boosters: {
                    5: 1
                },
                hard: 50
            }, {
                boosters: {
                    5: 1
                }
            }, {
                hard: 50
            }, {
                boosters: {
                    6: 1
                }
            }, {
                boosters: {
                    6: 1
                },
                hard: 50
            }, {
                hard: 50
            }, {
                boosters: {
                    7: 1
                }
            }, {
                boosters: {
                    7: 1
                },
                hard: 50
            }], RewardsConfig.MiniGameBeginner = [{
                unlimitedLives: "30 minutes"
            }], RewardsConfig.MiniGameNovice = [{
                hard: 50
            }], RewardsConfig.Tournament = {
                places: [{
                    boosters: {
                        5: 2,
                        6: 2,
                        7: 2
                    },
                    unlimitedLives: "12 hours"
                }, {
                    boosters: {
                        6: 1,
                        7: 1
                    },
                    unlimitedLives: "6 hour"
                }, {
                    boosters: {
                        5: 1,
                        6: 1
                    },
                    unlimitedLives: "1 hour"
                }, {
                    boosters: {
                        6: 1
                    },
                    unlimitedLives: "45 minutes",
                    exp: 5
                }, {
                    boosters: {
                        5: 1
                    },
                    unlimitedLives: "30 minutes",
                    exp: 3
                }]
            }, RewardsConfig.DailyTask = {
                easy: [{
                    unlimitedLives: "15 minutes"
                }],
                medium: [{
                    boosters: {
                        6: 1
                    },
                    exp: 1
                }],
                hard: [{
                    unlimitedLives: "30 minutes"
                }],
                completeAll: [{
                    boosters: {
                        0: 1,
                        1: 1
                    },
                    exp: 5
                }]
            }, RewardsConfig.TreasureSearch = {
                unlimitedLives: "12 hours",
                stars: 10,
                exp: 20
            }, RewardsConfig.DailyCup = [{
                unlimitedLives: "1 day",
                boosters: {
                    5: 5,
                    6: 5,
                    7: 5
                }
            }, {
                unlimitedLives: "6 hours",
                boosters: {
                    5: 4,
                    6: 4,
                    7: 4
                }
            }, {
                unlimitedLives: "3 hours",
                boosters: {
                    5: 3,
                    6: 3,
                    7: 3
                }
            }, {
                unlimitedLives: "2 hour",
                boosters: {
                    5: 1,
                    6: 1,
                    7: 1
                }
            }, {
                boosters: {
                    5: 1,
                    6: 1
                },
                unlimitedLives: "2 hour"
            }, {
                boosters: {
                    5: 1,
                    6: 1
                },
                unlimitedLives: "2 hour"
            }, {
                boosters: {
                    5: 1,
                    6: 1
                },
                unlimitedLives: "2 hour"
            }, {
                boosters: {
                    5: 1
                },
                unlimitedLives: "1 hour"
            }, {
                boosters: {
                    5: 1
                },
                unlimitedLives: "1 hour"
            }, {
                boosters: {
                    5: 1
                },
                unlimitedLives: "1 hour"
            }], RewardsConfig.Packs = [{
                boosters: {
                    5: 1,
                    6: 1,
                    7: 1
                },
                hard: 500,
                unlimitedLives: "1 day"
            }, {
                boosters: {
                    5: 2,
                    6: 2,
                    7: 2
                },
                hard: 1800,
                unlimitedLives: "3 day"
            }, {
                boosters: {
                    5: 14,
                    6: 14,
                    7: 14
                },
                hard: 12e3,
                unlimitedLives: "9 day"
            }], RewardsConfig.Subscription = {
                hard: 300,
                exp: 1,
                unlimitedLives: "2 hours",
                boosters: {
                    0: 3
                }
            }, RewardsConfig.BonusWorld = [{
                level: 3,
                reward: {
                    unlimitedLives: "1 hour"
                }
            }, {
                level: 8,
                reward: {
                    unlimitedLives: "1 hours",
                    exp: 5,
                    boosters: {
                        5: 1,
                        6: 1
                    }
                }
            }, {
                level: 15,
                reward: {
                    hard: 150,
                    unlimitedLives: "24 hours",
                    boosters: {
                        5: 1,
                        6: 1,
                        7: 1
                    }
                }
            }], RewardsConfig.PeriodicBonusSale = [{
                id: 0,
                product: "gold500",
                profit: "+98%",
                reward: {
                    hard: 150,
                    unlimitedLives: "6 hours",
                    boosters: {
                        7: 2
                    }
                }
            }, {
                id: 1,
                product: "gold1800",
                profit: "+67%",
                reward: {
                    hard: 400,
                    unlimitedLives: "48 hours",
                    boosters: {
                        7: 3
                    }
                }
            }, {
                id: 2,
                product: "gold3800",
                profit: "+53%",
                reward: {
                    hard: 700,
                    unlimitedLives: "72 hours",
                    boosters: {
                        7: 5
                    }
                }
            }, {
                id: 3,
                product: "gold6000",
                profit: "+51%",
                reward: {
                    hard: 1e3,
                    unlimitedLives: "120 hours",
                    boosters: {
                        7: 7
                    }
                }
            }, {
                id: 4,
                product: "gold25000",
                profit: "+35%",
                reward: {
                    hard: 5e3,
                    unlimitedLives: "168 hours",
                    boosters: {
                        7: 14
                    }
                }
            }]), "solitaire" === cleverapps.config.type && (RewardsConfig.MiniGame = [{
                hard: 50,
                randomBoosters: {
                    types: [10, 11, 12],
                    amount: 1
                }
            }, {
                hard: 50,
                randomBoosters: {
                    types: [10, 11, 12],
                    amount: 2
                }
            }, {
                randomBoosters: {
                    types: [10, 11, 12],
                    amount: 1
                }
            }, {
                randomBoosters: {
                    types: [10, 11, 12],
                    amount: 2
                }
            }], RewardsConfig.MiniGameBeginner = [{
                hard: 50
            }, {
                hard: 100
            }], RewardsConfig.MiniGameNovice = [{
                hard: 50,
                randomBoosters: {
                    types: [10, 11, 12],
                    amount: 1
                }
            }], RewardsConfig.TreasureSearch = {
                unlimitedLives: "12 hours",
                boosters: {
                    10: 1,
                    11: 1,
                    12: 1
                }
            }, RewardsConfig.Tournament = {
                places: [{
                    boosters: {
                        10: 2,
                        11: 2,
                        12: 2
                    },
                    unlimitedLives: "3 hours"
                }, {
                    boosters: {
                        11: 2,
                        12: 2
                    },
                    unlimitedLives: "1 hour"
                }, {
                    boosters: {
                        10: 1,
                        11: 1,
                        12: 1
                    },
                    unlimitedLives: "30 minutes"
                }, {
                    boosters: {
                        11: 1,
                        12: 1
                    },
                    unlimitedLives: "15 minutes"
                }, {
                    boosters: {
                        10: 1,
                        11: 1
                    },
                    unlimitedLives: "15 minutes"
                }]
            }, RewardsConfig.DailyTask = {
                easy: [{
                    unlimitedLives: "15 minutes"
                }],
                medium: [{
                    boosters: {
                        12: 1
                    }
                }],
                hard: [{
                    unlimitedLives: "30 minutes"
                }],
                completeAll: [{
                    boosters: {
                        10: 1,
                        11: 1
                    },
                    unlimitedLives: "30 minutes"
                }]
            }, RewardsConfig.DailyCup = [{
                unlimitedLives: "1 day",
                boosters: {
                    10: 5,
                    11: 5,
                    12: 5
                }
            }, {
                unlimitedLives: "6 hours",
                boosters: {
                    10: 4,
                    11: 4,
                    12: 4
                }
            }, {
                unlimitedLives: "3 hours",
                boosters: {
                    10: 3,
                    11: 3,
                    12: 3
                }
            }, {
                unlimitedLives: "1 hour",
                boosters: {
                    10: 2,
                    11: 2,
                    12: 2
                }
            }, {
                unlimitedLives: "30 minutes",
                boosters: {
                    10: 1,
                    11: 1,
                    12: 1
                }
            }, {
                unlimitedLives: "30 minutes",
                boosters: {
                    10: 1,
                    11: 1,
                    12: 1
                }
            }, {
                unlimitedLives: "30 minutes",
                boosters: {
                    10: 1,
                    11: 1,
                    12: 1
                }
            }, {
                unlimitedLives: "15 minutes",
                boosters: {
                    10: 1,
                    11: 1,
                    12: 1
                }
            }, {
                unlimitedLives: "15 minutes",
                boosters: {
                    10: 1,
                    11: 1,
                    12: 1
                }
            }, {
                unlimitedLives: "15 minutes",
                boosters: {
                    10: 1,
                    11: 1,
                    12: 1
                }
            }], RewardsConfig.Packs = [{
                boosters: {
                    10: 2,
                    11: 2,
                    12: 2
                },
                hard: 200
            }, {
                boosters: {
                    10: 6,
                    11: 6,
                    12: 6
                },
                hard: 800
            }, {
                boosters: {
                    10: 30,
                    11: 30,
                    12: 30
                },
                hard: 8e3
            }], RewardsConfig.Subscription = {
                boosters: {
                    10: 2,
                    11: 2,
                    12: 2
                },
                hard: 250,
                unlimitedLives: "3 hours"
            }, RewardsConfig.PeriodicBonusSale = [{
                id: 0,
                product: "gold500",
                profit: "+98%",
                reward: {
                    hard: 150,
                    unlimitedLives: "6 hours",
                    boosters: {
                        12: 2
                    }
                }
            }, {
                id: 1,
                product: "gold1800",
                profit: "+67%",
                reward: {
                    hard: 400,
                    unlimitedLives: "48 hours",
                    boosters: {
                        12: 3
                    }
                }
            }, {
                id: 2,
                product: "gold3800",
                profit: "+53%",
                reward: {
                    hard: 700,
                    unlimitedLives: "72 hours",
                    boosters: {
                        12: 5
                    }
                }
            }, {
                id: 3,
                product: "gold6000",
                profit: "+51%",
                reward: {
                    hard: 1e3,
                    unlimitedLives: "120 hours",
                    boosters: {
                        12: 7
                    }
                }
            }, {
                id: 4,
                product: "gold25000",
                profit: "+35%",
                reward: {
                    hard: 5e3,
                    unlimitedLives: "168 hours",
                    boosters: {
                        12: 14
                    }
                }
            }]), "differences" === cleverapps.config.type && (RewardsConfig.Tournament = {
                places: [{
                    boosters: {
                        8: 3,
                        9: 3
                    },
                    unlimitedLives: "3 hours"
                }, {
                    boosters: {
                        8: 2,
                        9: 2
                    },
                    unlimitedLives: "1 hour"
                }, {
                    boosters: {
                        8: 1,
                        9: 1
                    },
                    unlimitedLives: "30 minutes"
                }, {
                    boosters: {
                        8: 1
                    },
                    unlimitedLives: "15 minutes"
                }, {
                    boosters: {
                        9: 1
                    },
                    unlimitedLives: "15 minutes"
                }]
            }, RewardsConfig.DailyTask = {
                easy: [{
                    unlimitedLives: "15 minutes"
                }],
                medium: [{
                    boosters: {
                        8: 1
                    }
                }],
                hard: [{
                    unlimitedLives: "30 minutes"
                }],
                completeAll: [{
                    unlimitedLives: "15 minutes",
                    boosters: {
                        8: 1,
                        9: 1
                    }
                }]
            }, RewardsConfig.MiniGame = [{
                hard: 50,
                randomBoosters: {
                    types: [8, 9],
                    amount: 1
                }
            }, {
                hard: 100
            }], RewardsConfig.MiniGameBeginner = [{
                hard: 50,
                randomBoosters: {
                    types: [8, 9],
                    amount: 1
                }
            }, {
                hard: 100
            }], RewardsConfig.MiniGameNovice = [{
                hard: 50,
                randomBoosters: {
                    types: [8, 9],
                    amount: 1
                }
            }], RewardsConfig.TreasureSearch = {
                unlimitedLives: "12 hours",
                boosters: {
                    8: 1,
                    9: 2
                }
            }, RewardsConfig.DailyCup = [{
                unlimitedLives: "1 day",
                boosters: {
                    2: 1
                }
            }, {
                unlimitedLives: "6 hours",
                boosters: {
                    1: 1
                }
            }, {
                unlimitedLives: "3 hours",
                boosters: {
                    0: 1
                }
            }, {
                unlimitedLives: "1 hour"
            }, {
                unlimitedLives: "30 minutes"
            }, {
                unlimitedLives: "30 minutes"
            }, {
                unlimitedLives: "30 minutes"
            }, {
                unlimitedLives: "15 minutes"
            }, {
                unlimitedLives: "15 minutes"
            }, {
                unlimitedLives: "15 minutes"
            }], RewardsConfig.Packs = [{
                boosters: {
                    8: 2,
                    9: 2
                },
                hard: 200
            }, {
                boosters: {
                    8: 6,
                    9: 6
                },
                hard: 800
            }, {
                boosters: {
                    8: 30,
                    9: 30
                },
                hard: 8e3
            }], RewardsConfig.Subscription = {
                unlimitedLives: "3 hours",
                hard: 250,
                boosters: {
                    8: 3,
                    9: 3
                }
            }), "olympics" === cleverapps.config.name && (RewardsConfig.Tournament = {
                places: [{
                    hard: 300,
                    unlimitedLives: "1 hour"
                }, {
                    hard: 250,
                    unlimitedLives: "45 minutes"
                }, {
                    hard: 200,
                    unlimitedLives: "30 minutes"
                }, {
                    hard: 100,
                    unlimitedLives: "15 minutes"
                }, {
                    hard: 50,
                    unlimitedLives: "5 minutes"
                }]
            }, RewardsConfig.Subscription = {
                hard: 600,
                unlimitedLives: "3 hours"
            }, RewardsConfig.TreasureSearch = {
                unlimitedLives: "12 hours"
            }, RewardsConfig.WeeklyCup = [{
                hard: 3e3
            }, {
                hard: 2e3
            }, {
                hard: 1e3
            }, {
                hard: 200
            }, {
                hard: 200
            }, {
                hard: 200
            }, {
                hard: 200
            }, {
                hard: 200
            }, {
                hard: 200
            }, {
                hard: 200
            }], RewardsConfig.DailyTask = {
                easy: [{
                    hard: 80,
                    unlimitedLives: "10 minutes"
                }],
                medium: [{
                    hard: 120,
                    unlimitedLives: "15 minutes"
                }],
                hard: [{
                    hard: 160,
                    unlimitedLives: "30 minutes"
                }],
                completeAll: [{
                    hard: 180,
                    unlimitedLives: "30 minutes"
                }]
            }), "scramble" === cleverapps.config.name && (RewardsConfig.Tournament = {
                places: [{
                    boosters: {
                        13: 2,
                        14: 2,
                        15: 2
                    }
                }, {
                    boosters: {
                        14: 2,
                        15: 2
                    }
                }, {
                    boosters: {
                        13: 1,
                        14: 1,
                        15: 1
                    }
                }, {
                    boosters: {
                        14: 1,
                        15: 1
                    }
                }, {
                    boosters: {
                        13: 1,
                        14: 1
                    }
                }]
            }, RewardsConfig.Packs = [{
                boosters: {
                    13: 2,
                    14: 2,
                    15: 2
                },
                hard: 200
            }, {
                boosters: {
                    13: 6,
                    14: 6,
                    15: 6
                },
                hard: 800
            }, {
                boosters: {
                    13: 30,
                    14: 30,
                    15: 30
                },
                hard: 8e3
            }], RewardsConfig.DailyTask = {
                easy: [{
                    boosters: {
                        13: 1
                    }
                }],
                medium: [{
                    boosters: {
                        14: 1
                    }
                }],
                hard: [{
                    boosters: {
                        15: 1
                    },
                    hard: 15
                }],
                completeAll: [{
                    boosters: {
                        14: 1,
                        15: 1
                    },
                    hard: 25
                }]
            }, RewardsConfig.DailyCup = [{
                boosters: {
                    13: 5,
                    14: 5,
                    15: 5
                },
                hard: 300
            }, {
                boosters: {
                    13: 4,
                    14: 4,
                    15: 4
                },
                hard: 200
            }, {
                boosters: {
                    13: 3,
                    14: 3,
                    15: 3
                },
                hard: 100
            }, {
                boosters: {
                    13: 2,
                    14: 2,
                    15: 2
                },
                hard: 50
            }, {
                boosters: {
                    13: 1,
                    14: 1,
                    15: 1
                },
                hard: 50
            }, {
                boosters: {
                    13: 1,
                    14: 1,
                    15: 1
                },
                hard: 50
            }, {
                boosters: {
                    13: 1,
                    14: 1,
                    15: 1
                },
                hard: 50
            }, {
                boosters: {
                    13: 1,
                    14: 1,
                    15: 1
                }
            }, {
                boosters: {
                    13: 1,
                    14: 1,
                    15: 1
                }
            }, {
                boosters: {
                    13: 1,
                    14: 1,
                    15: 1
                }
            }], RewardsConfig.MiniGame = [{
                hard: 50,
                randomBoosters: {
                    types: [14, 15],
                    amount: 1
                }
            }, {
                hard: 50,
                randomBoosters: {
                    types: [14, 15],
                    amount: 2
                }
            }, {
                randomBoosters: {
                    types: [14, 15],
                    amount: 1
                }
            }, {
                randomBoosters: {
                    types: [14, 15],
                    amount: 2
                }
            }], RewardsConfig.MiniGameBeginner = [{
                hard: 50
            }, {
                hard: 100
            }], RewardsConfig.MiniGameNovice = [{
                hard: 50,
                randomBoosters: {
                    types: [13, 14, 15],
                    amount: 1
                }
            }], RewardsConfig.Subscription = {
                hard: 250,
                boosters: {
                    13: 2,
                    14: 2,
                    15: 2
                }
            }, RewardsConfig.TreasureSearch = {
                hard: 100,
                boosters: {
                    13: 1,
                    14: 1,
                    15: 1
                }
            }, RewardsConfig.CookieJar = {
                hard: 15
            }), "merge" === cleverapps.config.type && (RewardsConfig.Packs = [{
                hard: 50,
                energy: 200
            }, {
                hard: 100,
                energy: 350,
                wands: 250,
                worker: "3 day"
            }, {
                hard: 1e3,
                energy: 1500,
                wands: 500,
                soft: 3e3,
                worker: "5 day"
            }], RewardsConfig.LivesFeast = {
                places: [{
                    unit: [{
                        code: "treasure",
                        stage: 2,
                        amount: 1
                    }, {
                        code: "energytree",
                        stage: 2,
                        amount: 1
                    }]
                }, {
                    unit: [{
                        code: "treasure",
                        stage: 1,
                        amount: 1
                    }, {
                        code: "energytree",
                        stage: 1,
                        amount: 1
                    }]
                }, {
                    unit: [{
                        code: "treasure",
                        stage: 0,
                        amount: 1
                    }, {
                        code: "energytree",
                        stage: 0,
                        amount: 1
                    }]
                }],
                offer: {
                    energy: 250,
                    worker: Product.FormatTimePeriod("1 day", !0)
                }
            }, RewardsConfig.SoftFeast = {
                places: [{
                    unit: [{
                        code: "treasure",
                        stage: 2,
                        amount: 1
                    }, {
                        code: "coinstree",
                        stage: 2,
                        amount: 1
                    }]
                }, {
                    unit: [{
                        code: "treasure",
                        stage: 1,
                        amount: 1
                    }, {
                        code: "coinstree",
                        stage: 1,
                        amount: 1
                    }]
                }, {
                    unit: [{
                        code: "treasure",
                        stage: 0,
                        amount: 1
                    }, {
                        code: "coinstree",
                        stage: 0,
                        amount: 1
                    }]
                }],
                offer: {
                    soft: 1e3,
                    energy: 100
                }
            }, RewardsConfig.KrakenFeast = {
                places: [{
                    unit: {
                        code: "energytree",
                        stage: 2,
                        amount: 1
                    }
                }, {
                    unit: {
                        code: "energytree",
                        stage: 1,
                        amount: 1
                    }
                }, {
                    unit: {
                        code: "energytree",
                        stage: 0,
                        amount: 1
                    }
                }],
                offer: {
                    kraken: !0,
                    unit: [{
                        code: "wands",
                        stage: 4,
                        amount: 2
                    }, {
                        code: "sacks",
                        stage: 2,
                        amount: 3
                    }]
                }
            }, RewardsConfig.ExpeditionFeast = {
                places: [{
                    unit: {
                        code: "treasure",
                        stage: 2,
                        amount: 1
                    }
                }, {
                    unit: {
                        code: "treasure",
                        stage: 1,
                        amount: 1
                    }
                }, {
                    unit: {
                        code: "treasure",
                        stage: 0,
                        amount: 1
                    }
                }]
            }, RewardsConfig.SnailFeast = {
                places: [{
                    unit: [{
                        code: "seasonchest",
                        stage: 2,
                        amount: 1
                    }, {
                        code: "sacks",
                        stage: 2,
                        amount: 1
                    }, {
                        code: "coins",
                        stage: 5,
                        amount: 1
                    }]
                }, {
                    unit: [{
                        code: "seasonchest",
                        stage: 1,
                        amount: 1
                    }, {
                        code: "sacks",
                        stage: 1,
                        amount: 1
                    }, {
                        code: "coins",
                        stage: 1,
                        amount: 1
                    }]
                }, {
                    unit: [{
                        code: "seasonchest",
                        stage: 0,
                        amount: 1
                    }, {
                        code: "sacks",
                        stage: 0,
                        amount: 1
                    }]
                }]
            }, RewardsConfig.BuildPass = {
                offer: {
                    unit: [{
                        code: "crystal",
                        stage: 3,
                        amount: 2
                    }, {
                        code: "bppointsstar",
                        stage: 0,
                        amount: 1,
                        pointsValue: 250
                    }]
                }
            }, RewardsConfig.SalePass = {
                offer: {
                    unit: [{
                        code: "bppointscrystal",
                        stage: 0,
                        amount: 1,
                        pointsValue: 250
                    }],
                    soft: 1200
                }
            }, RewardsConfig.Subscription = {
                worker: {
                    subscription: !0
                },
                energy: 100,
                unit: {
                    code: "treasure",
                    stage: 2,
                    amount: 1
                }
            }, RewardsConfig.SubscriptionInstant = {
                energy: 50,
                unit: {
                    code: "treasure",
                    stage: 1,
                    amount: 1
                }
            }, RewardsConfig.DragoniaPack = {
                hard: 1200,
                unit: [{
                    code: "dragonpack",
                    stage: 0,
                    amount: 1
                }]
            }, RewardsConfig.Dragonia2Pack = {
                hard: 1200,
                unit: [{
                    code: "dr2dragonpack",
                    stage: 0,
                    amount: 1
                }]
            }, RewardsConfig.HalloweenPack = {
                hard: 1200,
                unit: [{
                    code: "hlpack",
                    stage: 0,
                    amount: 1
                }]
            }, RewardsConfig.UnderseaPack = {
                hard: 1200,
                unit: [{
                    code: "underseapack",
                    stage: 0,
                    amount: 1
                }]
            }, RewardsConfig.Undersea2Pack = {
                hard: 1200,
                unit: [{
                    code: "sea2pack",
                    stage: 0,
                    amount: 1
                }]
            }, RewardsConfig.ClanCup = [{
                soft: 800
            }, {
                soft: 400
            }, {
                soft: 270
            }, {
                soft: 200
            }, {
                soft: 130
            }], RewardsConfig.SnailPack = {
                unit: [{
                    code: "seasnailhouse",
                    stage: 0,
                    amount: 1
                }]
            }, RewardsConfig.SnailHouseDragoniaPack = {
                unit: [{
                    code: "drsnailhouse",
                    stage: 0,
                    amount: 1
                }]
            }, RewardsConfig.RapunzelPack = {
                hard: 800,
                energy: 300
            }, RewardsConfig.XmasPack = {
                hard: 1200,
                unit: [{
                    code: "xmpack",
                    stage: 0,
                    amount: 1
                }]
            }, RewardsConfig.ChinaPack = {
                hard: 600,
                energy: 600
            }, RewardsConfig.PeriodicPack = {
                hard: 1300,
                soft: 1300
            }, RewardsConfig.EasterPack = {
                hard: 800,
                energy: 300
            }, RewardsConfig.DailyTask = {
                easy: [{
                    soft: 15
                }],
                medium: [{
                    soft: 30
                }],
                hard: [{
                    soft: 45,
                    exp: 100
                }],
                completeAll: [{
                    unit: {
                        code: "dailytaskchest",
                        stage: 0,
                        amount: 1
                    }
                }]
            }, RewardsConfig.PeriodicBonusSale = [{
                id: 0,
                product: "gold500",
                profit: "+42%",
                reward: {
                    hard: 20,
                    soft: 100,
                    energy: 100
                }
            }, {
                id: 1,
                product: "gold1800",
                profit: "+32%",
                reward: {
                    hard: 100,
                    soft: 300,
                    energy: 200
                }
            }, {
                id: 2,
                product: "gold3800",
                profit: "+37%",
                reward: {
                    hard: 300,
                    soft: 800,
                    energy: 400
                }
            }, {
                id: 3,
                product: "gold6000",
                profit: "+39%",
                reward: {
                    hard: 500,
                    soft: 1500,
                    energy: 600
                }
            }, {
                id: 4,
                product: "gold25000",
                profit: "+43%",
                reward: {
                    hard: 3e3,
                    soft: 7e3,
                    energy: 1e3
                }
            }]), "tile3" === cleverapps.config.type && (RewardsConfig.MiniGame = [{
                soft: 50
            }], RewardsConfig.MiniGameBeginner = [{
                soft: 50
            }], RewardsConfig.MiniGameNovice = [{
                soft: 50
            }], RewardsConfig.DailyTask = {
                easy: [{
                    unlimitedLives: "15 minutes"
                }],
                medium: [{
                    unlimitedLives: "15 minutes"
                }],
                hard: [{
                    unlimitedLives: "15 minutes"
                }],
                completeAll: [{
                    unlimitedLives: "15 minutes"
                }]
            }, RewardsConfig.Tournament = {
                places: [{
                    soft: 300,
                    unlimitedLives: "3 hours"
                }, {
                    soft: 200,
                    unlimitedLives: "1 hour"
                }, {
                    soft: 100,
                    unlimitedLives: "30 minutes"
                }, {
                    unlimitedLives: "15 minutes"
                }, {
                    unlimitedLives: "15 minutes"
                }]
            }, RewardsConfig.Packs = [{
                hard: 200,
                soft: 800
            }, {
                hard: 800,
                soft: 2500
            }, {
                hard: 5e3,
                soft: 1e4
            }], RewardsConfig.PeriodicBonusSale = [{
                id: 0,
                product: "gold500",
                profit: "+78%",
                reward: {
                    hard: 50,
                    soft: 500
                }
            }, {
                id: 1,
                product: "gold1800",
                profit: "+52%",
                reward: {
                    hard: 150,
                    soft: 1500
                }
            }, {
                id: 2,
                product: "gold3800",
                profit: "+45%",
                reward: {
                    hard: 300,
                    soft: 3e3
                }
            }, {
                id: 3,
                product: "gold6000",
                profit: "+43%",
                reward: {
                    hard: 550,
                    soft: 4500
                }
            }, {
                id: 4,
                product: "gold25000",
                profit: "+40%",
                reward: {
                    hard: 3e3,
                    soft: 12e3
                }
            }], RewardsConfig.kit3 = {
                soft: 300,
                boosters: {
                    17: 3,
                    23: 3
                }
            }, RewardsConfig.kit10 = {
                soft: 2e3,
                boosters: {
                    23: 5,
                    18: 5
                }
            }, RewardsConfig.ChainSale = [{
                reward: {
                    soft: 300
                }
            }, {
                reward: {
                    boosters: {
                        18: 1,
                        17: 1
                    }
                }
            }, {
                product: "kit3",
                reward: RewardsConfig.kit3
            }, {
                reward: {
                    soft: 100,
                    boosters: {
                        18: 1,
                        23: 1
                    }
                }
            }, {
                reward: {
                    soft: 150,
                    boosters: {
                        18: 3,
                        17: 1
                    }
                }
            }, {
                product: "kit10",
                reward: RewardsConfig.kit10
            }, {
                reward: {
                    hard: 200,
                    lives: 3
                }
            }, {
                reward: {
                    boosters: {
                        18: 3,
                        17: 2,
                        23: 1
                    }
                }
            }]), "blocks" === cleverapps.config.type && (RewardsConfig.PeriodicBonusSale = [{
                id: 0,
                product: "gold500",
                profit: "+78%",
                reward: {
                    hard: 50,
                    soft: 500
                }
            }, {
                id: 1,
                product: "gold1800",
                profit: "+52%",
                reward: {
                    hard: 150,
                    soft: 1500
                }
            }, {
                id: 2,
                product: "gold3800",
                profit: "+45%",
                reward: {
                    hard: 300,
                    soft: 3e3
                }
            }, {
                id: 3,
                product: "gold6000",
                profit: "+43%",
                reward: {
                    hard: 550,
                    soft: 4500
                }
            }, {
                id: 4,
                product: "gold25000",
                profit: "+40%",
                reward: {
                    hard: 3e3,
                    soft: 12e3
                }
            }]), function () {
                Connectable.call(this)
            }),
        PaymentsCountry = (Payments.prototype = Object.create(Connectable.prototype), (Payments.prototype.constructor = Payments).prototype.clear = function () { }, Payments.prototype.freeFromLoginToPay = function () {
            return (!this.oneOf(XsollaPayments) || !cleverapps.platform.oneOf(Crazy)) && this.oneOf(MicrosoftPayments, PlingaPayments, WebViewPayments, YandexPayments, YooKassaPayments,
                TestPayments, XsollaPayments)
        }, Payments.prototype.requiresEmailToPay = function () {
            return this.oneOf(YooKassaPayments)
        }, Payments.prototype.setPurchaseState = function (e) {
            this.purchaseState !== e && (this.purchaseState = e)
        }, Payments.prototype.getPurchaseState = function () {
            return this.purchaseState
        }, Payments.prototype.restore = function (e) {
            e(cleverapps.CODE_FAILED)
        }, Payments.prototype.consume = function () { }, Payments.prototype.purchase = function (e, t) {
            t(cleverapps.CODE_FAILED, e)
        }, Payments.prototype.validate = function (e, t) {
            t(cleverapps.CODE_SUCCEED, e)
        }, Payments.prototype.isProductExists = function (e) {
            return cleverapps.config.products[e]
        }, Payments.prototype.getSubscriptionStatus = function (e, t) {
            var s = Subscription.calcSource();
            ["android", "ios", "macos"].includes(s) && 0 === Object.keys(e.tokens).length || cleverapps.platform.haveTmpId() && ["facebook", "web_ok", "mobile_ok"].includes(s) || (s = {
                source: s,
                tokens: e.tokens
            }, cleverapps.RestClient.post("/subscriptions/get/" + cleverapps.platform.getUserID(), s, t))
        },
            Payments.prototype.loadProducts = function (e) {
                cleverapps.platform.isConnected(Platform.PAYMENTS) ? this._loadProducts(e) : e(cleverapps.CODE_FAILED)
            }, Payments.prototype._loadProducts = function (e) {
                e(cleverapps.CODE_SUCCEED)
            }, Payments.prototype.loadSubscriptions = function (e) {
                e(cleverapps.CODE_SUCCEED)
            }, Payments.prototype.loadSubscriptionsTokens = function (e) {
                e(cleverapps.CODE_SUCCEED)
            }, Payments.prototype.isAvailable = function () {
                return cleverapps.platform.isConnected(Platform.PAYMENTS)
            }, Payments.prototype.isRestoreAvailable = function () {
                return this.isAvailable()
            }, Payments.prototype.oneOf = function (e) {
                return cleverapps.oneOf(this, Array.isArray(e) ? e : Array.prototype.slice.call(arguments))
            }, Payments.prototype.notifyActive = function () { }, Payments.CONSUMED_STORAGE_LIMIT = 30,
            function () {
                HasInitialized.call(this), this.load(), this.update(), cleverapps.platform.oneOf(CleverApps) && this.updateIpCode(), PaymentsCountry.isApplicable() ? cleverapps.timeouts.setTimeout(this.setInitialized.bind(this, !0),
                    cleverapps.parseInterval("1 minute")) : this.setInitialized(!0)
            }),
        RestPayments = (PaymentsCountry.prototype = Object.create(HasInitialized.prototype), (PaymentsCountry.prototype.constructor = PaymentsCountry).prototype.updateIpCode = function () {
            cleverapps.RestClient.get("/country/getbyip", {}, function (e) {
                e = e && e.countryCode;
                console.log("countryCode", e), this.setIpCode(e)
            }.bind(this))
        }, PaymentsCountry.prototype.setCurrency = function (e) {
            e && this.currency !== e && (this.currency = e, this.save(), this.update()), e && this.setInitialized(!0)
        }, PaymentsCountry.prototype.setIpCode = function (e) {
            e && this.ipCode !== e && (this.ipCode = e, this.save(), this.update()), e && this.setInitialized(!0)
        }, PaymentsCountry.prototype.getCode = function () {
            return this.code
        }, PaymentsCountry.prototype.isRussia = function () {
            return "RU" === this.code
        }, PaymentsCountry.prototype.update = function () {
            var e = this.calculateCode();
            this.code !== e && (this.code = e, this.updateDependents())
        }, PaymentsCountry.prototype.setInitialized = function (e) {
            HasInitialized.prototype.setInitialized.call(this, e), this.updateDependents()
        }, PaymentsCountry.prototype.updateDependents = function () {
            PaymentsCountry.isApplicable() && (cleverapps.paymentsManager && cleverapps.paymentsManager.onUpdateCountry(), cleverapps.abTest && cleverapps.abTest.updateGroups())
        }, PaymentsCountry.prototype.calculateCode = function () {
            return WebViewPayments.DEBUG_IDFA.includes(cleverapps.platform.device.idfa) || XsollaPayments.DEBUG_IDS.includes(cleverapps.platform.getUserID()) ? cleverapps.settings.language === PlatformInfo.LANGUAGE_RUSSIAN ? PaymentsCountry.RU : PaymentsCountry.OTHER : this.ipCode || (PaymentsCountry.RUB === this.currency ? PaymentsCountry.RU : PaymentsCountry.OTHER)
        }, PaymentsCountry.prototype.load = function () {
            var e = cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.PAYMENTS_COUNTRY) || {};
            this.currency = e.currency, this.ipCode = e.ipCode
        }, PaymentsCountry.prototype.save = function () {
            cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.PAYMENTS_COUNTRY, {
                currency: this.currency,
                ipCode: this.ipCode
            })
        }, PaymentsCountry.isApplicable = function () {
            return cleverapps.platform.oneOf(AndroidPlatform, Rustore) || cleverapps.platform.oneOf(CleverApps) && !cleverapps.isLocalhost()
        }, PaymentsCountry.RUB = "RUB", PaymentsCountry.RU = "RU", PaymentsCountry.OTHER = "other", function () {
            Payments.call(this)
        }),
        TestPayments = (RestPayments.prototype = Object.create(Payments.prototype), (RestPayments.prototype.constructor = RestPayments).prototype.purchase = function (e, t) {
            this.startPurchaseChecker(e, t), this.purchaseOpen(e, t)
        }, RestPayments.prototype.purchaseOpen = function (e, t) {
            t(cleverapps.CODE_FAILED, e)
        }, RestPayments.prototype.restore = function (i) {
            var e = "/payments/restore/" + cleverapps.platform.source + "/" + encodeURIComponent(cleverapps.platform.getUserID()),
                t = {
                    version: 2,
                    yookassa: cleverapps.payments instanceof YooKassaPayments
                };
            cleverapps.RestClient.post(e, t, function (e) {
                var t = e && e.productId,
                    s = t && Product.Create(t);
                s && (s.paymentId = e.paymentId, s.productId = t), i(s ? cleverapps.CODE_SUCCEED : cleverapps.CODE_FAILED, s)
            },
                function () {
                    i(cleverapps.CODE_FAILED)
                })
        }, RestPayments.prototype.validate = function (e, t) {
            this.startPurchaseChecker(e, t), this.setCancelTimeout(cleverapps.parseInterval("3 minutes"), t)
        }, RestPayments.prototype.consume = function (e) {
            this.startChecker({
                method: "consume",
                product: e,
                timeouts: RestPayments.CONSUME_TIMEOUTS
            })
        }, RestPayments.prototype.stopPurchaseChecker = function () {
            this.purchaseChecker && (this.purchaseChecker.stop(), delete this.purchaseChecker)
        }, RestPayments.prototype.startPurchaseChecker = function (e, t, s) {
            this.stopPurchaseChecker(), s = s || {}, this.purchaseChecker = this.startChecker(Object.assign({}, s, {
                method: "validate",
                product: e,
                onSuccess: function () {
                    t(cleverapps.CODE_SUCCEED, e)
                }
            }))
        }, RestPayments.prototype.startChecker = function (i) {
            function e() {
                s && (cleverapps.timeouts.clearTimeout(s), s = void 0)
            }

            function t() {
                a(), e(), 0 < o.length && (s = cleverapps.timeouts.setTimeout(t, cleverapps.parseInterval(o.pop())))
            }
            i = i || {};
            var s, n = cleverapps.once(i.onSuccess),
                o = (o = i.timeouts || RestPayments.TIMEOUTS).slice().reverse(),
                a = i.check || function () {
                    var e = "/payments/" + i.method + "/" + cleverapps.platform.source + "/" + encodeURIComponent(cleverapps.platform.getUserID()),
                        t = i.product,
                        s = {
                            type: t.type,
                            restore: t.restore,
                            paymentId: RestPayments.IsTmpPaymentId(t.paymentId) ? void 0 : t.paymentId,
                            productId: t.loadedId,
                            itemId: t.itemId,
                            version: 3,
                            yookassa: cleverapps.payments instanceof YooKassaPayments
                        };
                    t.openTime && (s.openInterval = Math.ceil((Date.now() - t.openTime + 1) / 6e4)), cleverapps.RestClient.post(e, s, function (e) {
                        "object" == typeof e && e.paymentId && (t.paymentId && !RestPayments.IsTmpPaymentId(t.paymentId) || (t.paymentId = e.paymentId), e = "ok"), "ok" === e && (n(), r.stop())
                    })
                },
                r = (t(), {
                    stop: e
                });
            return r
        }, RestPayments.prototype.notifyActive = function () {
            this.notifyActiveListener && (console.log("Payments notifyActive"), this.notifyActiveListener(), delete this.notifyActiveListener)
        }, RestPayments.IsTmpPaymentId = function (e) {
            return (e + "").startsWith("tmp")
        }, RestPayments.prototype.setNotifyActiveListener = function (e) {
            this.notifyActiveListener = e
        },
            RestPayments.prototype.setPurchaseState = function (e) {
                this.purchaseState !== e && (this.purchaseState = e, this.stopPurchaseActions())
            }, RestPayments.prototype.stopPurchaseActions = function () {
                this.stopPurchaseChecker(), this.clearCancelTimeout(), delete this.notifyActiveListener
            }, RestPayments.prototype.setCancelTimeout = function (e, t) {
                this.clearCancelTimeout(), this.cancelTimeout = cleverapps.timeouts.setTimeout(function () {
                    console.log("Payment timeout cancel"), t(cleverapps.CODE_CANCELLED)
                }, e)
            }, RestPayments.prototype.clearCancelTimeout = function () {
                cleverapps.timeouts.clearTimeout(this.cancelTimeout), delete this.cancelTimeout
            }, RestPayments.TIMEOUTS = ["1 second", "1 second", "3 seconds"].concat(cleverapps.arrayFill(12, "5 seconds")).concat(["10 seconds", "10 seconds", "10 seconds", "20 seconds", "20 seconds", "20 seconds", "1 minute", "1 minute", "3 minutes", "5 minutes", "5 minutes"]), RestPayments.CONSUME_TIMEOUTS = ["5 seconds"].concat(cleverapps.arrayFill(6, "10 seconds")).concat(["20 seconds", "20 seconds", "20 seconds",
                "1 minute", "1 minute", "3 minutes", "5 minutes", "5 minutes"
            ]),
            function () {
                Payments.call(this)
            }),
        InstantPayments = (TestPayments.prototype = Object.create(Payments.prototype), (TestPayments.prototype.constructor = TestPayments).prototype.purchase = function (e, t) {
            setTimeout(function () {
                confirm(Messages.get("FakePayments.Buying") + " " + e.title + " for " + e.price) ? setTimeout(function () {
                    t(cleverapps.CODE_SUCCEED)
                }, TestPayments.PROCESS_TIMEOUT) : setTimeout(function () {
                    console.log(Messages.get("FakePayments.Cancelled")), t(cleverapps.CODE_CANCELLED)
                }, TestPayments.PROCESS_TIMEOUT)
            }, 1e3)
        }, TestPayments.prototype.validate = function (e, t) {
            setTimeout(function () {
                t(cleverapps.CODE_SUCCEED, e)
            }, 1e3)
        }, TestPayments.prototype.restore = function (e) {
            e(cleverapps.CODE_FAILED)
        }, TestPayments.isAppropriate = function () {
            return TestSocial.isAppropriate()
        }, TestPayments.PROCESS_TIMEOUT = 0, function () {
            for (var e in Payments.call(this), cleverapps.config.products) {
                e = cleverapps.config.products[e];
                e.loadedId = e.id.instant
            }
        }),
        SamsungPayments = (
            InstantPayments.prototype = Object.create(Payments.prototype), (InstantPayments.prototype.constructor = InstantPayments).prototype._connect = function (t) {
                cleverapps.whenAllInitialized(function () {
                    var e = FBInstant.getSupportedAPIs();
                    console.log("Searching payments.purchaseAsync", e), e.includes("payments.purchaseAsync") ? (e.includes("payments.purchaseSubscriptionAsync") && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION_API), console.log("Found payments.purchaseAsync support!"), FBInstant.payments.onReady(function () {
                        console.log("Payments ready!"), t(Platform.STATUS_CONNECTED)
                    })) : t(Platform.STATUS_DISCONNECTED)
                })
            }, InstantPayments.prototype.getSubscriptionStatus = function (e, t) {
                FBInstant.payments.getSubscriptionsAsync().then(function (e) {
                    console.log(e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION_LIST + "SUCCESS"), t({
                        active: 0 < e.length
                    })
                }).catch(function (e) {
                    switch (console.log("error listing subscriptions", e), e.code) {
                        case "CLIENT_UNSUPPORTED_OPERATION":
                        case "NETWORK_FAILURE":
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION_LIST + e.code);
                            break;
                        default:
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION_LIST + "OTHER"), cleverapps.throwAsync({
                                group: "DebugMessage",
                                message: cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION_LIST + e.code + " message: " + e.message
                            })
                    }
                    t({})
                })
            }, InstantPayments.prototype.isSubscriptionsAvailable = function () {
                if ("undefined" == typeof FBInstant) return !1;
                var e = FBInstant.getSupportedAPIs();
                return console.log("Searching payments.purchaseSubscriptionAsync", e), -1 !== e.indexOf("payments.purchaseSubscriptionAsync")
            }, InstantPayments.prototype.openSubscription = function (s, i) {
                FBInstant.payments.purchaseSubscriptionAsync(s.id.instant).then(function (e) {
                    console.log("success subscription", e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION + "SUCCESS"), e.productId = s.itemId, i(cleverapps.CODE_SUCCEED, e)
                }).catch(function (e) {
                    console.log("error purchase", e);
                    var t = cleverapps.CODE_FAILED;
                    switch (e && "USER_INPUT" === e.code && (t = cleverapps.CODE_CANCELLED), e.code) {
                        case "CLIENT_UNSUPPORTED_OPERATION":
                        case "PAYMENTS_NOT_INITIALIZED":
                        case "INVALID_PARAM":
                        case "NETWORK_FAILURE":
                        case "INVALID_OPERATION":
                        case "USER_INPUT":
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION + e.code);
                            break;
                        default:
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION + "OTHER"), cleverapps.throwAsync({
                                group: "DebugMessage",
                                message: cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION + e.code + " message: " + e.message
                            })
                    }
                    i(t, s)
                })
            }, InstantPayments.prototype.purchase = function (s, i) {
                this.isAvailable() ? "subscription" !== s.type ? FBInstant.payments.purchaseAsync({
                    productID: s.id.instant
                }).then(function (e) {
                    console.log("success purchase", e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.PAYMENT + "SUCCESS"), e.paymentId = e.paymentID, e.productId = s.itemId, i(cleverapps.CODE_SUCCEED, e)
                }).catch(function (e) {
                    console.log("error purchase", e);
                    var t = cleverapps.CODE_FAILED;
                    switch (e && "USER_INPUT" === e.code && (t = cleverapps.CODE_CANCELLED), e.code) {
                        case "CLIENT_UNSUPPORTED_OPERATION":
                        case "PAYMENTS_NOT_INITIALIZED":
                        case "INVALID_PARAM":
                        case "NETWORK_FAILURE":
                        case "INVALID_OPERATION":
                        case "USER_INPUT":
                        case "PAYMENTS_PURCHASE_CREATION_FAILED":
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.PAYMENT + e.code);
                            break;
                        default:
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.PAYMENT + "OTHER"), cleverapps.throwAsync({
                                group: "DebugMessage",
                                message: cleverapps.EVENTS.STATS.INSTANT.PAYMENT + e.code + " message: " + e.message
                            })
                    }
                    i(t, s)
                }) : this.openSubscription(s, i) : i(cleverapps.CODE_FAILED, s, "InstantPayments.NotAvailable")
            }, InstantPayments.prototype.isAvailable = function () {
                return -1 !== ["1832499670188919", "1920167364724450", "2076714912381045", "2585442014807608"].indexOf(cleverapps.platform.getUserID()) || cleverapps.platform.isConnected(Platform.PAYMENTS)
            }, InstantPayments.isAppropriate = function () {
                return cleverapps.platform.oneOf(Instant)
            }, InstantPayments.prototype._loadProducts = function (t) {
                var e = FBInstant.getSupportedAPIs();
                if (console.log("Searching payments.getCatalogAsync", e), -1 === e.indexOf("payments.getCatalogAsync")) return console.log("No support for getCatalogAsync, skip"), void t(cleverapps.CODE_SUCCEED);
                FBInstant.payments.getCatalogAsync().then(function (e) {
                    console.log(e), e.forEach(function (e) {
                        var t = cleverapps.config.products[Product.SearchProductId(e.productID)];
                        t ? t.loadedPrice = e.price : cleverapps.throwAsync({
                            group: "DebugInstantMessage",
                            message: e.productID + " not found"
                        })
                    }, this), t(cleverapps.CODE_SUCCEED)
                }.bind(this)).catch(function (e) {
                    if (!this.loadProductsErrorReported) {
                        switch (e.code) {
                            case "PENDING_REQUEST":
                            case "CLIENT_UNSUPPORTED_OPERATION":
                            case "PAYMENTS_NOT_INITIALIZED":
                            case "NETWORK_FAILURE":
                                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.CATALOG + e.code);
                                break;
                            default:
                                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.CATALOG + "OTHER"), cleverapps.throwAsync({
                                    group: "DebugMessage",
                                    message: cleverapps.EVENTS.STATS.INSTANT.CATALOG + e.code + " message: " + e.message
                                })
                        }
                        this.loadProductsErrorReported = !0
                    }
                    t(cleverapps.CODE_FAILED)
                }.bind(this))
            }, InstantPayments.prototype.loadSubscriptions = function (t) {
                var e = FBInstant.getSupportedAPIs();
                if (console.log("Searching payments.getSubscribableCatalogAsync", e), -1 === e.indexOf("payments.getSubscribableCatalogAsync")) return console.log("No support for getSubscribableCatalogAsync, skip"), void t(cleverapps.CODE_SUCCEED);
                FBInstant.payments.getSubscribableCatalogAsync().then(function (e) {
                    console.log(e), e.forEach(function (e) {
                        var t = cleverapps.config.products[Product.SearchProductId(e.productID)];
                        t ? t.loadedPrice = e.price : cleverapps.throwAsync({
                            group: "DebugInstantMessage",
                            message: e.productID + " not found"
                        })
                    }, this), t(cleverapps.CODE_SUCCEED)
                }.bind(this)).catch(function (e) {
                    if (!this.loadSubscriptionsErrorReported) {
                        switch (e.code) {
                            case "CLIENT_UNSUPPORTED_OPERATION":
                            case "NETWORK_FAILURE":
                            case "PENDING_REQUEST":
                            case "PAYMENTS_NOT_INITIALIZED":
                                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION_CATALOG + e.code);
                                break;
                            default:
                                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION_CATALOG + "OTHER"), cleverapps.throwAsync({
                                    group: "DebugMessage",
                                    message: cleverapps.EVENTS.STATS.INSTANT.SUBSCRIPTION_CATALOG + e.code + " message: " + e.message
                                })
                        }
                        this.loadSubscriptionsErrorReported = !0
                    }
                    t(cleverapps.CODE_FAILED)
                }.bind(this))
            }, InstantPayments.prototype.consume = function (e) {
                "subscription" !== Product.Create(e.productID).type ? FBInstant.payments.consumePurchaseAsync(e.purchaseToken).then(function () {
                    console.log("consume success", e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.CONSUME + "SUCCESS")
                }).catch(function (e) {
                    switch (console.log("consume error", e), e.code) {
                        case "CLIENT_UNSUPPORTED_OPERATION":
                        case "PAYMENTS_NOT_INITIALIZED":
                        case "NETWORK_FAILURE":
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.CONSUME + e.code);
                            break;
                        default:
                            cleverapps.eventLogger.logEvent(
                                cleverapps.EVENTS.STATS.INSTANT.CONSUME + "OTHER"), cleverapps.throwAsync({
                                    group: "DebugMessage",
                                    message: cleverapps.EVENTS.STATS.INSTANT.CONSUME + e.code + " message: " + e.message
                                })
                    }
                }) : cleverapps.RestClient.post("/instantpayments/addsubscriptions/", {
                    userId: cleverapps.platform.getUserID(),
                    subscription: e
                })
            }, InstantPayments.prototype._validate = function (t, s) {
                var e = {
                    signedRequest: t.signedRequest,
                    userId: cleverapps.platform.getUserID()
                };
                cleverapps.RestClient.post("/instantpayments/validate/", e, function (e) {
                    "ok" === e ? (s(cleverapps.CODE_SUCCEED, t), console.log("Purchase validation success")) : (console.log("Purchase validation error", e), s(cleverapps.CODE_FAILED, t))
                }, function () {
                    console.log("Purchase validation network error"), s(cleverapps.CODE_CANCELLED, t)
                })
            }, InstantPayments.prototype.restore = function (t) {
                this.ready ? FBInstant.payments.getPurchasesAsync().then(function (e) {
                    0 !== e.length ? ((e = e[0]).paymentId = e.paymentID, e.productId = e.productID, t(cleverapps.CODE_SUCCEED, e)) : t(cleverapps.CODE_FAILED)
                }).catch(
                    function (e) {
                        switch (t(cleverapps.CODE_FAILED), console.log("error getPurchasesAsync", e), e.code) {
                            case "CLIENT_UNSUPPORTED_OPERATION":
                            case "PAYMENTS_NOT_INITIALIZED":
                            case "NETWORK_FAILURE":
                            case "UNKNOWN":
                                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.LIST_PURCHASES + e.code);
                                break;
                            default:
                                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.LIST_PURCHASES + "OTHER"), cleverapps.throwAsync({
                                    group: "DebugMessage",
                                    message: cleverapps.EVENTS.STATS.INSTANT.LIST_PURCHASES + e.code + " message: " + e.message
                                })
                        }
                    }) : t(cleverapps.CODE_FAILED)
            },
            function () {
                for (var e in Payments.call(this), cleverapps.config.products) {
                    e = cleverapps.config.products[e];
                    e.loadedId = e.id.instant
                }
            }),
        WortalPayments = (SamsungPayments.prototype = Object.create(Payments.prototype), (SamsungPayments.prototype.constructor = SamsungPayments).prototype._connect = function (e) {
            window.addEventListener("iapReady", function () {
                console.log("Samsung iap is ready"), e(Platform.STATUS_CONNECTED)
            })
        },
            SamsungPayments.prototype._loadProducts = function (t) {
                this.isAvailable() || console.log("Iap is not ready"), GSInstantIAP.getProductListAsync().then(function (e) {
                    e.forEach(function (e) {
                        var t = cleverapps.config.products[Product.SearchProductId(e.mItemId)];
                        t ? t.loadedPrice = e.price : cleverapps.throwAsync({
                            group: "DebugInstantMessage",
                            message: e.mItemId + " not found"
                        })
                    }), t(cleverapps.CODE_SUCCEED)
                })
            }, SamsungPayments.isAppropriate = function () {
                return cleverapps.platform.oneOf(Samsung)
            }, SamsungPayments.prototype.purchase = function (t, s) {
                GSInstantIAP.purchaseItemAsync({
                    itemID: t.id.samsung
                }).then(function (e) {
                    e.paymentId = e.mPaymentId, e.productId = t.itemId, s(cleverapps.CODE_SUCCEED, e)
                }).catch(function (e) {
                    console.log("purchase error: ", e), cleverapps.config.debugMode && cleverapps.notification.create("purchase error - " + JSON.stringify(e)), s(cleverapps.CODE_FAILED, t)
                })
            }, SamsungPayments.prototype.consume = function (e) {
                GSInstantIAP.consumeItemsAsync(e.purchaseToken).then(function (e) {
                    console.log("consume success: ", e),
                        cleverapps.config.debugMode && cleverapps.notification.create("consume success - " + JSON.stringify(e))
                }).catch(function (e) {
                    console.log("consume error: ", e), cleverapps.config.debugMode && cleverapps.notification.create("consume error - " + JSON.stringify(e))
                })
            }, SamsungPayments.prototype.restore = function (t) {
                GSInstantIAP.getOwnedListAsync().then(function (e) {
                    0 !== e.length ? ((e = e[0]).paymentId = e.mPaymentId, e.productId = e.mItemId, t(cleverapps.CODE_SUCCEED, e)) : t(cleverapps.CODE_FAILED)
                }).catch(function (e) {
                    t(cleverapps.CODE_FAILED), console.log("getOwnedAsync error: ", e), cleverapps.config.debugMode && cleverapps.notification.create("getOwnedAsync error - " + JSON.stringify(e))
                })
            },
            function () {
                for (var e in Payments.call(this), cleverapps.config.products) {
                    e = cleverapps.config.products[e];
                    e.loadedId = e.id.wortal
                }
            }),
        PlingaPayments = (WortalPayments.prototype = Object.create(Payments.prototype), (WortalPayments.prototype.constructor = WortalPayments).prototype._connect = function (e) {
            e(Wortal.iap.isEnabled() ? Platform.STATUS_CONNECTED : Platform.STATUS_DISABLED)
        }, WortalPayments.prototype._loadProducts = function (t) {
            Wortal.iap.getCatalogAsync().then(function (e) {
                console.log(e), e.forEach(function (e) {
                    var t = cleverapps.config.products[Product.SearchProductId(e.productID)];
                    t ? t.loadedPrice = e.price : cleverapps.throwAsync({
                        group: "DebugInstantMessage",
                        message: e.productID + " not found"
                    })
                }, this), t(cleverapps.CODE_SUCCEED)
            }.bind(this))
        }, WortalPayments.isAppropriate = function () {
            return cleverapps.platform.oneOf(WortalPlatform)
        }, WortalPayments.prototype.purchase = function (s, i) {
            var e;
            this.isAvailable() ? (e = cleverapps.platform.debugMode ? ".test" : "", Wortal.iap.makePurchaseAsync({
                productID: s.id.wortal + e
            }).then(function (e) {
                console.log("success purchase", e), e.paymentId = e.paymentID, e.productId = s.itemId, i(cleverapps.CODE_SUCCEED, e)
            }).catch(function (e) {
                console.log("error purchase", e);
                var t = cleverapps.CODE_FAILED;
                e && "USER_INPUT" === e.code && (t = cleverapps.CODE_CANCELLED), i(t, s)
            })) : i(cleverapps.CODE_FAILED, s,
                "InstantPayments.NotAvailable")
        }, WortalPayments.prototype.consume = function (e) {
            Wortal.iap.consumePurchaseAsync(e.purchaseToken).then(function () {
                console.log("consume success", e)
            }).catch(function (e) {
                console.log("consume error", e)
            })
        }, WortalPayments.prototype.restore = function (t) {
            Wortal.iap.getPurchasesAsync().then(function (e) {
                0 !== e.length ? ((e = e[0]).paymentId = e.paymentID, e.productId = e.productID, t(cleverapps.CODE_SUCCEED, e)) : t(cleverapps.CODE_FAILED)
            }).catch(function (e) {
                t(cleverapps.CODE_FAILED), console.log("error getPurchasesAsync", e)
            })
        }, function () {
            for (var e in RestPayments.call(this), cleverapps.config.products) cleverapps.config.products[e].loadedId = e
        }),
        MobagePayments = (PlingaPayments.prototype = Object.create(RestPayments.prototype), (PlingaPayments.prototype.constructor = PlingaPayments).prototype.purchaseOpen = function (t, s) {
            cleverapps.platform.exitFullscreen(function () {
                plingaRpc.purchasePackage(t.itemId, function (e) {
                    "paid" === e.paymentStatus ? (t.packageName = e.packageName, s(cleverapps.CODE_SUCCEED, t)) : s(cleverapps.CODE_FAILED)
                })
            })
        }, PlingaPayments.isAppropriate = function () {
            return cleverapps.platform instanceof Plinga
        }, function () {
            for (var e in RestPayments.call(this), cleverapps.config.products) {
                e = cleverapps.config.products[e];
                e.loadedPrice = MobagePayments.calcLoadedPrice(e.price), e.loadedId = e.id.mbga + ""
            }
        }),
        VKPayments = (MobagePayments.prototype = Object.create(RestPayments.prototype), (MobagePayments.prototype.constructor = MobagePayments).prototype.calcLoadedPrice = function (e) {
            return MobagePayments.calcLoadedPrice(e)
        }, MobagePayments.calcLoadedPrice = function (e) {
            return -1 !== MobagePayments.TESTER_IDS.indexOf(cleverapps.platform.getUserID()) ? "1 MC" : cleverapps.formatAmount(Math.ceil(100 * e)) + " MC"
        }, MobagePayments.prototype.purchaseOpen = function (t, s) {
            var e = {},
                i = (e[opensocial.BillingItem.Field.SKU_ID] = t.id.mbga, e[opensocial.BillingItem.Field.PRICE] = parseInt(t.loadedPrice.replace(" ", "")), e[opensocial.BillingItem.Field.COUNT] = 1, e[mbga.BillingItem.Field.NAME] = t.title,
                    e[mbga.BillingItem.Field.IMAGE_URL] = cleverapps.platform.getExternalUrl(t.image), opensocial.newBillingItem(e)),
                n = {},
                i = (n[opensocial.Payment.Field.ITEMS] = [i], n[opensocial.Payment.Field.AMOUNT] = e[opensocial.BillingItem.Field.PRICE] * e[opensocial.BillingItem.Field.COUNT], opensocial.newPayment(n));
            opensocial.requestPayment(i, function (e) {
                e.hadError() ? s(cleverapps.CODE_FAILED, e) : (console.log("opensocial.requestPayment response", e.getData()), s(cleverapps.CODE_SUCCEED, t))
            })
        }, MobagePayments.isAppropriate = function () {
            return cleverapps.platform instanceof Mobage
        }, MobagePayments.TESTER_IDS = ["mbga.jp:155776208", "sb.mbga.jp:189574", "sb.mbga.jp:195164", "mbga.jp:157478302"], void 0 === cleverapps && "undefined" == typeof cc && (cleverapps = require("../../utils"), RestPayments = function () { }), function () {
            for (var e in RestPayments.call(this), cleverapps.config.products) {
                var t = cleverapps.config.products[e];
                t.loadedPrice = this.calcLoadedPrice(t.price), t.loadedId = e
            }
        }),
        MobileVkPayments = (VKPayments.prototype = Object.create(
            RestPayments.prototype), (VKPayments.prototype.constructor = VKPayments).GOLOS_TO_RUB = 7, VKPayments.CalcVkPrice = function (e) {
                return Math.floor(e * cleverapps.RUB_DISCOUNTED_RATE / VKPayments.GOLOS_TO_RUB)
            }, VKPayments.prototype.calcLoadedPrice = function (e) {
                var e = VKPayments.CalcVkPrice(e),
                    t = e % 10;
                return 1 == t ? e + " голос" : 1 < t && t < 5 && (e < 10 || 20 < e) ? e + " голоса" : e + " голосов"
            }, VKPayments.prototype.purchaseOpen = function (s, i) {
                this.isAvailable() ? cleverapps.platform.exitFullscreen(function () {
                    cleverapps.social.showOrderBox({
                        type: "item",
                        item: s.itemId + "_v2"
                    }, function (e, t) {
                        e === cleverapps.CODE_SUCCEED ? (s.paymentId = t.order_id, i(e, s)) : t && t.error_data && "User denied" === t.error_data.error_reason ? i(cleverapps.CODE_CANCELLED) : i(e, t)
                    })
                }) : i(cleverapps.CODE_FAILED, s, "InstantPayments.NotAvailable")
            }, VKPayments.isAppropriate = function () {
                return cleverapps.platform instanceof VKPlatform
            }, "undefined" == typeof cc && (module.exports = VKPayments.CalcVkPrice), function () {
                VKPayments.call(this)
            }),
        MyMailRuPayments = (
            MobileVkPayments.prototype = Object.create(VKPayments.prototype), (MobileVkPayments.prototype.constructor = MobileVkPayments).prototype._connect = function (e) {
                e("html5_ios" === cleverapps.MobileVkSocial.getPlatfrom() ? Platform.STATUS_DISABLED : Platform.STATUS_CONNECTED)
            }, MobileVkPayments.isAppropriate = function () {
                return cleverapps.platform instanceof MobileVk
            },
            function () {
                for (var e in RestPayments.call(this), cleverapps.config.products) {
                    e = cleverapps.config.products[e];
                    e.loadedPrice = this.calcLoadedPrice(e.price), e.loadedId = e.id.mymailru + ""
                }
            }),
        MobileMyMailRuPayments = (MyMailRuPayments.prototype = Object.create(RestPayments.prototype), (MyMailRuPayments.prototype.constructor = MyMailRuPayments).prototype._connect = function (e) {
            this.listeners = {
                status: function () { },
                income: function () { }
            }, mailru.events.listen(mailru.app.events.paymentDialogStatus, function (e) {
                this.listeners.status(e)
            }.bind(this)), mailru.events.listen(mailru.app.events.incomingPayment, function (e) {
                this.listeners.income(e)
            }.bind(this)), e(
                Platform.STATUS_CONNECTED)
        }, MyMailRuPayments.prototype.calcLoadedPrice = function (e) {
            var t = Math.floor(e * cleverapps.RUB_DISCOUNTED_RATE) + " млк";
            return t = cleverapps.config.debugMode && e < 10 ? "1 млк" : t
        }, MyMailRuPayments.prototype.purchaseOpen = function (t, s) {
            this.listeners.status = function (e) {
                console.log("PAYMENT DIALOG", e), "closed" === e.status && this.setCancelTimeout(500, s)
            }.bind(this), this.listeners.income = function (e) {
                console.log("INCOM", e), "success" === e.status ? s(cleverapps.CODE_SUCCEED, t) : s(cleverapps.CODE_CANCELLED)
            }, cleverapps.platform.exitFullscreen(function () {
                mailru.app.payments.showDialog({
                    service_id: t.id.mymailru,
                    service_name: t.title,
                    mailiki_price: parseInt(t.loadedPrice)
                })
            })
        }, MyMailRuPayments.isAppropriate = function () {
            return cleverapps.platform instanceof MyMailRu
        }, function () {
            MyMailRuPayments.call(this)
        }),
        OKPayments = (MobileMyMailRuPayments.prototype = Object.create(MyMailRuPayments.prototype), (MobileMyMailRuPayments.prototype.constructor = MobileMyMailRuPayments).prototype._connect = function (e) {
            e(Platform.STATUS_CONNECTED)
        }, MobileMyMailRuPayments.prototype.stopPurchaseActions = function () {
            RestPayments.prototype.stopPurchaseActions.apply(this, arguments), this.closeWidgetWindow(), this.stopWidgetChecker()
        }, MobileMyMailRuPayments.prototype.purchaseOpen = function (e, t) {
            this.setCancelTimeout(cleverapps.parseInterval("30 minutes"), t);
            var s, i, n = cleverapps.getRequestParameters(),
                o = {
                    appid: cleverapps.config.mm.appId,
                    session_key: n.session_key,
                    service_id: e.id.mymailru,
                    service_name: e.title,
                    mailiki_price: parseInt(e.loadedPrice),
                    mob: 1
                },
                a = [];
            for (s in o) "service_name" === s ? (i = s + "=" + o[s].split("").map(function (e) {
                return e.match(/[а-я]/i) ? e : encodeURIComponent(e)
            }).join(""), a.push(i)) : a.push(s + "=" + encodeURIComponent(o[s]));
            this.openWidgetWindow("http://m.my.mail.ru/cgi-bin/app/paymentm?" + a.join("&")), this.startWidgetChecker(e, t)
        }, MobileMyMailRuPayments.prototype.closeWidgetWindow = function () {
            this.widgetWindow && (this.widgetWindow.close(), delete this.widgetWindow)
        },
            MobileMyMailRuPayments.prototype.openWidgetWindow = function (e) {
                this.closeWidgetWindow(), this.widgetWindow = window.open(e)
            }, MobileMyMailRuPayments.prototype.stopWidgetChecker = function () {
                clearInterval(this.widgetChecker), delete this.widgetChecker
            }, MobileMyMailRuPayments.prototype.startWidgetChecker = function (e, t) {
                this.stopWidgetChecker();
                var s = function () {
                    this.closeWidgetWindow(), this.stopWidgetChecker(), this.getPurchaseState() === PaymentsManager.STATE_PURCHASE && (this.startPurchaseChecker(e, t, {
                        timeouts: cleverapps.arrayFill(15, "1 seconds")
                    }), this.setCancelTimeout(15e3, t))
                }.bind(this);
                this.widgetChecker = setInterval(function () {
                    try {
                        var e = this.widgetWindow;
                        e && e.location && (!e.location.href || 0 <= e.location.href.indexOf("vid=")) && s()
                    } catch (e) { }
                }.bind(this), 500)
            }, MobileMyMailRuPayments.isAppropriate = function () {
                return cleverapps.platform instanceof MobileMyMailRu
            },
            function () {
                for (var e in RestPayments.call(this), cleverapps.config.products) {
                    var t = cleverapps.config.products[e];
                    t.loadedPrice = this.calcLoadedPrice(t.price), t.loadedId = t.id.ok || e
                }
            }),
        NoPayments = (OKPayments.prototype = Object.create(RestPayments.prototype), (OKPayments.prototype.constructor = OKPayments).prototype.calcLoadedPrice = function (e) {
            var t = Math.floor(e * cleverapps.RUB_DISCOUNTED_RATE) + "**";
            return t = cleverapps.config.debugMode ? Math.max(1, Math.round(e / 3)) + "**" : t
        }, OKPayments.prototype.purchaseOpen = function (t, s) {
            var e = function (e) {
                e === cleverapps.OKSocial.CODE_SUCCEED ? "subscription" === t.type || t.paymentId ? s(cleverapps.CODE_SUCCEED, t) : (this.startPurchaseChecker(t, s, {
                    timeouts: cleverapps.arrayFill(15, "1 seconds")
                }), this.setWaitPaymentIdTimeout(5500, t, s)) : s("cancel" === e ? cleverapps.CODE_CANCELLED : cleverapps.CODE_FAILED)
            }.bind(this);
            cleverapps.platform.exitFullscreen(function () {
                "subscription" === t.type ? (cleverapps.platform.listeners.showPaymentSubscription = e, FAPI.invokeUIMethod("showPaymentSubscription", t.id.ok, parseInt(t.loadedPrice))) : (cleverapps.platform.listeners.showPayment = e, FAPI.UI.showPayment(
                    t.description, t.title, t.itemId, parseInt(t.loadedPrice), null, JSON.stringify({
                        type: cleverapps.platform.oneOf(MobileOK) ? "mobile" : "social"
                    }), "ok", "true"))
            })
        }, OKPayments.prototype.stopPurchaseActions = function () {
            RestPayments.prototype.stopPurchaseActions.call(this), this.clearWaitPaymentIdTimeout()
        }, OKPayments.prototype.clearWaitPaymentIdTimeout = function () {
            cleverapps.timeouts.clearTimeout(this.waitPaymentIdTimeout), delete this.waitPaymentIdTimeout
        }, OKPayments.prototype.setWaitPaymentIdTimeout = function (e, t, s) {
            this.clearWaitPaymentIdTimeout(), this.waitPaymentIdTimeout = cleverapps.timeouts.setTimeout(function () {
                t.paymentId = t.paymentId || "tmp" + cleverapps.platform.getUserID() + "_" + Date.now(), t.state = 0, console.log("create tmp PaymentId", t.paymentId), cleverapps.RestClient.post("/payments/add/" + cleverapps.platform.source + "/" + encodeURIComponent(cleverapps.platform.getUserID()), {
                    purchase: t,
                    price: t.price,
                    textPrice: t.getCurrentPrice(),
                    itemId: t.itemId
                }), s(cleverapps.CODE_SUCCEED, t)
            }, e)
        },
            OKPayments.isAppropriate = function () {
                return cleverapps.platform.oneOf(OKPlatform, MobileOK)
            },
            function () {
                Payments.call(this)
            }),
        SPMobagePayments = (NoPayments.prototype = Object.create(Payments.prototype), (NoPayments.prototype.constructor = NoPayments).isAppropriate = function () {
            return cleverapps.platform.oneOf(Huzcom, Pliega, IOSCh, PWA, GPG, Ton, GDCom, Xiaomi) || cleverapps.platform.oneOf(AndroidPlatform) && !WebViewPayments.isAppropriate() || cleverapps.platform.oneOf(Mobage, SPMobage) && ["mbga.jp:63100202", "sb.mbga.jp:63100202"].includes(cleverapps.platform.getUserID())
        }, NoPayments.prototype._connect = function (e) {
            e(Platform.STATUS_DISABLED)
        }, function () {
            for (var e in RestPayments.call(this), cleverapps.config.products) {
                e = cleverapps.config.products[e];
                e.loadedPrice = MobagePayments.calcLoadedPrice(e.price), e.loadedId = e.id.mbga
            }
        }),
        FacebookPayments = (SPMobagePayments.prototype = Object.create(RestPayments.prototype), (SPMobagePayments.prototype.constructor = SPMobagePayments).prototype.calcLoadedPrice = function (e) {
            return MobagePayments.calcLoadedPrice(e)
        }, SPMobagePayments.prototype.purchaseOpen = function (i, n) {
            this.createTransaction(i, function (s) {
                mobage.ui.open("payment", {
                    transactionId: s.transactionId,
                    orderId: s.orderId
                }, function (e, t) {
                    e ? (this.reportPaymentResult(s, e), mobage.bank.clearPaymentBacklog(s.transactionId), n(cleverapps.CODE_FAILED, t)) : (this.reportPaymentResult(s), n(cleverapps.CODE_SUCCEED, i))
                }.bind(this))
            }.bind(this))
        }, SPMobagePayments.prototype.createTransaction = function (i, n) {
            cleverapps.social.checkAccessToken(function () {
                var e, t = {
                    userId: cleverapps.platform.getUserID().substring(cleverapps.platform.getUserID().indexOf(":") + 1),
                    id: i.id.mbga,
                    name: i.title,
                    price: parseInt(i.loadedPrice.replace("MC", "").replace(" ", "")),
                    description: "ja" === cleverapps.settings.language ? i.description : i.description.substring(0, i.description.lastIndexOf("!")),
                    imageUrl: cleverapps.config.deployment + i.image,
                    accessToken: cleverapps.social.clientData.token.accessToken
                },
                    s = [];
                for (e in t) Object.prototype.hasOwnProperty.call(t,
                    e) && s.push(e + "=" + t[e]);
                cleverapps.RestClient.get("/spmbgapayments?" + s.join("&"), {}, function (e) {
                    n(e)
                })
            })
        }, SPMobagePayments.prototype.reportPaymentResult = function (e, t) {
            var s, i = {
                orderId: e.orderId,
                transactionId: e.transactionId
            },
                n = (t && (i.error = !0), []);
            for (s in i) Object.prototype.hasOwnProperty.call(i, s) && n.push(s + "=" + i[s]);
            cleverapps.RestClient.post("/spmbgapayments/old?" + n.join("&"), {}, function (e) {
                e && e.transactionId && mobage.bank.clearPaymentBacklog(e.transactionId)
            })
        }, SPMobagePayments.isAppropriate = function () {
            return cleverapps.platform instanceof SPMobage
        }, function () {
            for (var e in RestPayments.call(this), cleverapps.config.products) {
                e = cleverapps.config.products[e];
                e.loadedId = e.id.facebook.replace(".html", "")
            }
        }),
        FotoStranaPayments = (FacebookPayments.prototype = Object.create(RestPayments.prototype), (FacebookPayments.prototype.constructor = FacebookPayments).UserCanceled = 1383010, FacebookPayments.SuccessStatuses = ["completed", "active"], FacebookPayments.prototype.purchaseOpen = function (s, i) {
            var e;
            cleverapps.platform.isConnected(Platform.SOCIAL) ? (e = {
                product: s.id.facebook,
                type: s.type
            }, "subscription" === s.type && (e.action = "create_subscription"), cleverapps.platform.exitFullscreen(function () {
                plugin.FacebookAgent.getInstance().canvas.pay(e, function (e, t) {
                    e === FacebookPayments.UserCanceled ? (console.log("Payment " + s.itemId + " error " + t.error_message), i(cleverapps.CODE_CANCELLED, t)) : t && -1 === FacebookPayments.SuccessStatuses.indexOf(t.status) ? (console.log("Payment " + s.itemId + " status: ", t.status, t.error_message ? ", error: " + t.error_message : ""), i(cleverapps.CODE_CANCELLED, t)) : (console.log("Payment " + s.itemId + " success", t), s.paymentId = s.paymentId || t.payment_id, i(cleverapps.CODE_SUCCEED, s))
                })
            })) : i && i(cleverapps.CODE_FAILED)
        }, FacebookPayments.isAppropriate = function () {
            return !cleverapps.platform.info.isNative
        }, function () {
            for (var e in RestPayments.call(this), cleverapps.config.products) {
                var t = cleverapps.config.products[e];
                t.loadedPrice = this.calcLoadedPrice(t.price), t.loadedId = e
            }
        }),
        WebViewPayments = (
            FotoStranaPayments.prototype = Object.create(RestPayments.prototype), (FotoStranaPayments.prototype.constructor = FotoStranaPayments).prototype.calcLoadedPrice = function (e) {
                return (e + " ФМ").replace(".", ",")
            }, FotoStranaPayments.prototype.purchaseOpen = function (e, t) {
                var s = FotoStranaPayments.DEBUG_USERS.includes(cleverapps.platform.getUserID()) ? 1 : 0;
                FSClient.event("buyItemCallback", function (e) {
                    t("success" === e.result ? cleverapps.CODE_SUCCEED : cleverapps.CODE_CANCELLED)
                }, {
                    itemId: e.id.mymailru,
                    name: e.description,
                    forwardData: e.itemId,
                    picUrl: cleverapps.platform.getExternalUrl(e.image.replace("fbproducts", "fsproducts")),
                    priceFmCents: Math.floor(100 * e.price),
                    isDebug: s
                })
            }, FotoStranaPayments.isAppropriate = function () {
                return cleverapps.platform instanceof FotoStrana
            }, FotoStranaPayments.DEBUG_USERS = ["FS_113127743", "FS_113139202", "FS_113154744"],
            function () {
                for (var e in Payments.call(this), this.startTime = Date.now(), cleverapps.config.products) {
                    e = cleverapps.config.products[e];
                    e.loadedId = e.id[cleverapps.platform.oneOf(Apple) ? "ios" : cleverapps.platform.source]
                }
            }),
        RuStorePayments = (WebViewPayments.prototype = Object.create(Payments.prototype), (WebViewPayments.prototype.constructor = WebViewPayments).prototype.loadSubscriptionsTokens = function (s) {
            cleverapps.platform.oneOf(Rustore, Amazon) ? s(cleverapps.CODE_SUCCEED) : cleverapps.platform.callNative("PurchasesPlugin.loadSubscriptionsTokens", function (e, t) {
                e === cleverapps.CODE_SUCCEED && ((e = t.purchases || []) && (console.log("WebViewPayments.onLoadSubscriptionsTokensResult purchases - " + e), this.addSubscriptionTokens(e)), s(cleverapps.CODE_SUCCEED))
            }.bind(this))
        }, WebViewPayments.prototype.addSubscriptionTokens = function (e, t) {
            Array.isArray(e) || (e = [e]), cleverapps.platform.oneOf(AndroidPlatform, IOS, MacOS) && cleverapps.subscription && (0 < (e = e.map(function (e) {
                var t = Product.Create(Product.SearchProductId(e.productId));
                if (t && "subscription" === t.type) return t = {
                    name: t.key
                }, cleverapps.platform.oneOf(AndroidPlatform) ? (
                    t.purchaseToken = e.purchaseToken || e.receipt.purchaseToken, t.packageName = e.packageName || e.receipt.packageName, t.productId = e.productId || e.receipt.productId) : (t.purchaseToken = e.receipt, t.packageName = e.packageName, t.productId = e.productId), t
            }).filter(function (e) {
                return e
            })).length && cleverapps.subscription.addPurchaseTokens(e, t))
        }, WebViewPayments.prototype._connect = function (e) {
            cleverapps.platform.oneOf(Apple) ? e(Platform.STATUS_CONNECTED) : (cleverapps.platform.nativeEventListeners.WebViewPayments = this.onNativeEvent.bind(this), this.connectCallback = e, cleverapps.platform.callNative("PurchasesPlugin.connect"))
        }, WebViewPayments.prototype.clear = function () {
            delete cleverapps.platform.nativeEventListeners.WebViewPayments
        }, WebViewPayments.prototype.onNativeConnected = function (e) {
            console.log("WebViewPayments.updateConnected - " + e), this.connectCallback ? (this.connectCallback(e ? Platform.STATUS_CONNECTED : Platform.STATUS_DISCONNECTED), delete this.connectCallback) : cleverapps.platform.setStatus(Platform.PAYMENTS,
                e ? Platform.STATUS_CONNECTED : Platform.STATUS_DISCONNECTED)
        }, WebViewPayments.prototype.onNativeEvent = function (e, t) {
            switch (e) {
                case "updateConnected":
                    this.onNativeConnected(t.connected);
                    break;
                case "requestRestore":
                    cleverapps.paymentsManager.restoreThrottled()
            }
        }, WebViewPayments.prototype.getStoreProductIds = function (e) {
            var t, s = [];
            for (t in cleverapps.config.products) {
                var i = cleverapps.config.products[t];
                (i.type || "consumable") === e && s.push(i.loadedId)
            }
            return s.join(",")
        }, WebViewPayments.prototype._loadProducts = function (s) {
            cleverapps.platform.callNative("PurchasesPlugin.loadProducts", {
                productIds: this.getStoreProductIds("consumable")
            }, function (e, t) {
                this.onLoadResult(e, "consumable", t.products || []), s(e)
            }.bind(this))
        }, WebViewPayments.prototype.loadSubscriptions = function (s) {
            cleverapps.platform.oneOf(Rustore, Amazon) ? s(cleverapps.CODE_SUCCEED) : cleverapps.platform.callNative("PurchasesPlugin.loadSubscriptions", {
                productIds: this.getStoreProductIds("subscription")
            }, function (e, t) {
                this.onLoadResult(e,
                    "subscription", t.products || []), s(e)
            }.bind(this))
        }, WebViewPayments.prototype.onLoadResult = function (e, t, s) {
            var i;
            console.log("WebViewPayments.onLoadResult code - " + e + " type - " + t), e === cleverapps.CODE_SUCCEED ? (s = s || [], console.log("WebViewPayments.onLoadResult products - " + JSON.stringify(s)), s.forEach(function (e) {
                var t = cleverapps.config.products[Product.SearchProductId(e.productId)],
                    s = e.price_currency_code;
                i = i || s, void 0 !== t && (t.loadedPrice = e.price, t.loadedCurrencyCode = s, t.loadedPriceAmount = Math.round(e.price_amount_micros / 1e3) / 1e3, console.log("WebViewPayments product " + e.productId + " " + t.loadedPrice + " " + t.loadedCurrencyCode + " " + t.loadedPriceAmount))
            }), i && !this.loadedCurrencyCode && (this.loadedCurrencyCode = i, cleverapps.paymentsCountry.setCurrency(i))) : console.log("WebViewPayments.onLoadResult failure")
        }, WebViewPayments.prototype.purchase = function (e, n) {
            return cleverapps.platform.isConnected(Platform.PAYMENTS) ? e.loadedId ? void cleverapps.platform.callNative("PurchasesPlugin.purchase", {
                productId: e.loadedId
            }, function (e, t) {
                var s, i = t.product;
                switch (i && (s = Product.Create(Product.SearchProductId(i.productId)), console.log("WebViewPayments.purchase orderId - " + i.orderId), console.log("WebViewPayments.purchase product - " + JSON.stringify(i, cleverapps.cutStringsReplacer))), e) {
                    case cleverapps.CODE_SUCCEED:
                        this.addSubscriptionTokens(i), i.itemId = s && s.itemId;
                        break;
                    case cleverapps.CODE_PENDING:
                        i.pending = !0, this.validate(i)
                }
                i && (i.paymentId = (i.orderId || i.receipt.orderId || "").substring(0, 50), cleverapps.platform.oneOf(MacOS) && (i.transactionId = cleverapps.platform.getUserID() + "_" + Date.now()), i.loadedPriceAmount = s ? s.price : 0, i.loadedCurrencyCode = "USD", i.price_amount_micros && i.price_currency_code ? (i.loadedPriceAmount = Math.round(i.price_amount_micros / 1e3) / 1e3, i.loadedCurrencyCode = i.price_currency_code) : s && s.loadedPriceAmount && s.loadedCurrencyCode && (i.loadedPriceAmount = s.loadedPriceAmount, i.loadedCurrencyCode = s.loadedCurrencyCode)), n(e, i)
            }.bind(this)) : (console.log(
                "Product without loadedId: " + e.key), void n(cleverapps.CODE_FAILED)) : (console.log("WebViewPayments.purchase not connected error"), void n(cleverapps.CODE_FAILED))
        }, WebViewPayments.prototype.isAvailable = function () {
            var e = cleverapps.platform.oneOf(AndroidPlatform) && ["RUB"].includes(this.loadedCurrencyCode) && !WebViewPayments.DEBUG_IDFA.includes(cleverapps.platform.device.idfa),
                e = cleverapps.platform.isConnected(Platform.PAYMENTS) && !e;
            return e = cleverapps.platform.oneOf(Apple, AndroidPlatform) && !this.productsLoaded ? !1 : e
        }, WebViewPayments.prototype.validate = function (t, s) {
            var e, i;
            cleverapps.platform.oneOf(AndroidPlatform, IOS, MacOS, GPG) ? (e = {
                userid: cleverapps.platform.getUserID(),
                restore: t.restore,
                itemId: t.itemId,
                pending: t.pending
            }, cleverapps.platform.oneOf(IOS, MacOS) ? (e.receipt = t.receipt, e.productId = t.productId, e.packageName = t.packageName, e.platform = "apple") : (e.receipt = t.receipt.purchaseToken, e.packageName = t.receipt.packageName, e.productId = t.receipt.productId, e.platform = "google",
                e.purchaseState = t.purchaseState), t.paymentId = t.paymentId || t.orderId, e.errorInJson = !0, i = Product.Create(Product.SearchProductId(t.productId)), e.type = i && i.type, cleverapps.RestClient.post("/purchasevalidator/validate/", e, function (e) {
                    return e.error ? (console.log("WebViewPayments.validate Failure: " + e.error), void s(cleverapps.CODE_FAILED, t)) : (t.paymentId = t.paymentId || e.receipt && e.receipt.orderId || e.transaction_id || e.transactionId, console.log("WebViewPayments.validate Success: " + JSON.stringify(e)), void s(cleverapps.CODE_SUCCEED, t))
                }, function () {
                    console.log("WebViewPayments.validate onError"), s(cleverapps.CODE_CANCELLED, t)
                })) : s(cleverapps.CODE_SUCCEED, t)
        }, WebViewPayments.prototype.calcLoadedPrice = function (e) {
            var t, s = cleverapps.EXCHANGE_RATES[this.loadedCurrencyCode];
            return s ? (t = Product.CURRENCY_CODE === this.loadedCurrencyCode ? Product.CURRENCY : this.loadedCurrencyCode, Math.ceil(e * s) + ".00 " + t) : Product.CURRENCY + " " + e
        }, WebViewPayments.isAppropriate = function () {
            return cleverapps.platform.oneOf(
                AndroidPlatform, Amazon, IOS, MacOS)
        }, WebViewPayments.prototype.restore = function (i) {
            cleverapps.platform.oneOf(AndroidPlatform, GPG, IOS, MacOS) ? cleverapps.platform.callNative("PurchasesPlugin.restore", function (e, t) {
                var s, t = t.purchase;
                t && (s = t.orderId) ? (t.paymentId = s, i(cleverapps.CODE_SUCCEED, t)) : i(cleverapps.CODE_FAILED)
            }) : i(cleverapps.CODE_FAILED)
        }, WebViewPayments.prototype.consume = function (e) {
            e && e.orderId && cleverapps.platform.oneOf(AndroidPlatform, IOS, MacOS) && cleverapps.platform.callNative("PurchasesPlugin.consumePurchase", {
                orderId: e.orderId,
                productId: e.productId
            })
        }, WebViewPayments.prototype.restoreSubscriptions = function (s) {
            s = cleverapps.once(s), cleverapps.platform.isConnected(Platform.PAYMENTS) ? cleverapps.platform.callNative("PurchasesPlugin.restoreSubscriptions", function (e, t) {
                t = t.purchases;
                console.log("WebViewPayments.onRestoreSubscriptionsResult code - " + e), t && console.log("IOSPayments.onRestoreSubscriptionsResult purchases - " + t.length, t), e === cleverapps.CODE_SUCCEED ? (s(
                    cleverapps.CODE_SUCCEED), this.addSubscriptionTokens(t, !0)) : s(cleverapps.CODE_FAILED)
            }.bind(this)) : s(cleverapps.CODE_FAILED)
        }, WebViewPayments.DEBUG_IDFA = ["45f0caa5-d1ab-4b03-8e09-a0b63b17c181", "839d10f8-0da0-40fa-a4e9-02885ff0973a", "17ef0ac8-71fa-47d1-941b-70924e8a031e", "217ac5d3-6b67-48e8-8fe8-0fff1108c808", "75f21832-7a24-47cc-9e88-8c4f461fc06d", "aca92164-3f00-4115-84c3-2ab54ed7ba7b", "1572cd26-1b38-4b85-8346-258e171b388c", "b1ae8117-ff55-4159-b9ad-18e4d05a9da8", "cb3ed72f-c604-4c51-84fa-2ffaa9acb849", "85c137ac-0a55-45cd-bd8a-b8be552beea8", "d2d82613-36c4-4d5c-aef5-43e62e938a48", "2105ba80-4607-4ae3-a3a8-866aa7fb63b9", "24280e2d-6603-415e-a064-d794cbda6437", "c07beae6-3277-4c72-83ec-26cba72eeb36", "668c1ab3-456f-4f31-a734-afdbc034c759"], (cleverapps = "undefined" == typeof cc ? require("../../utils") : cleverapps).PaymentsHistory = function () {
            this.ids = [], this.time = [], this.price = [], this.load(), this.trim(), this.onAddPaymentListeners = {}
        }, cleverapps.PaymentsHistory.prototype.trim = function () {
            this.ids.length > cleverapps.PaymentsHistory.STORAGE_LIMIT && (this.ids = this.ids.slice(-cleverapps.PaymentsHistory.STORAGE_LIMIT)), this.time.length > this.ids.length && (this.time = this.time.slice(-this.ids.length)), this.price.length > this.ids.length && (this.price = this.price.slice(-this.ids.length))
        }, cleverapps.PaymentsHistory.prototype.addPayment = function (e) {
            this.ids.push(e.itemId), this.time.push(Date.now()), this.price.push(e.price), this.save(), cleverapps.values(this.onAddPaymentListeners).forEach(cleverapps.callFunc)
        }, cleverapps.PaymentsHistory.prototype.isPayer = function () {
            return 0 < this.ids.length
        }, cleverapps.PaymentsHistory.prototype.getLastPaymentTime = function () {
            return 0 < this.time.length ? this.time[this.time.length - 1] : void 0
        }, cleverapps.PaymentsHistory.prototype.load = function (e) {
            e = e || cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.PAYMENTS_HISTORY);
            if (e && e.payments || Array.isArray(e)) return this.migrateOldFormat(e), this.migratePrice(), void this.save();
            e && e.ids && (this.ids = e.ids,
                this.time = e.time.map(cleverapps.expandTime), e.price ? this.price = e.price.map(function (e) {
                    return e / 100
                }) : this.migratePrice())
        }, cleverapps.PaymentsHistory.prototype.migrateOldFormat = function (e) {
            function t(e) {
                return (e = (e = e && e.productId && e.productId.facebook) && e.substring(e.lastIndexOf("/") + 1)) && Product.SearchProductId(e)
            }
            e = (e = Array.isArray(e) ? e : e.payments).filter(t);
            this.time = e.map(function (e) {
                return e.time
            }), this.ids = e.map(t)
        }, cleverapps.PaymentsHistory.prototype.migratePrice = function () {
            this.price = this.ids.map(function (e) {
                e = cleverapps.config.products[e] || Products.DEPRECATED[e];
                return e && e.price || 0
            })
        }, cleverapps.PaymentsHistory.prototype.getInfo = function () {
            return {
                time: this.time.map(cleverapps.compactTime),
                ids: this.ids,
                price: this.price.map(function (e) {
                    return Math.floor(100 * e)
                })
            }
        }, cleverapps.PaymentsHistory.prototype.updateInfo = function (e) {
            e && (this.load(e), this.save(!0))
        }, cleverapps.PaymentsHistory.prototype.save = function (e) {
            this.trim(), cleverapps.platform.dataLoader.save(
                SimpleDataLoader.TYPES.PAYMENTS_HISTORY, this.getInfo()), e || cleverapps.synchronizer.addUpdateTask("paymentshistory")
        }, cleverapps.PaymentsHistory.BRACKET_UNDECIDED = -1, cleverapps.PaymentsHistory.BRACKET_NONE = 0, cleverapps.PaymentsHistory.BRACKET_WEAK = 1, cleverapps.PaymentsHistory.BRACKET_MEDIUM = 2, cleverapps.PaymentsHistory.BRACKET_WHALE = 3, cleverapps.PaymentsHistory.BRACKET_BIGWHALE = 4, cleverapps.PaymentsHistory.BRACKETS = [2.99, 9.99, 29.99, 99.99], cleverapps.PaymentsHistory.STORAGE_LIMIT = 25, cleverapps.PaymentsHistory.VIP_THRESHOLD = 29.99, cleverapps.PaymentsHistory.UNDECIDED_LEVEL_THRESHOLD = 6.5, cleverapps.PaymentsHistory.initialize = function () {
            cleverapps.platform.oneOf(Wechat) && (cleverapps.PaymentsHistory.UNDECIDED_LEVEL_THRESHOLD = 0)
        }, cleverapps.PaymentsHistory.prototype.isVIP = function () {
            return this.getVIPStatus().status
        }, cleverapps.PaymentsHistory.prototype.getVIPStatus = function () {
            if (cleverapps.flags.videoAdsMainMonetization) return {
                status: !1
            };
            if (
                cleverapps.subscription && cleverapps.subscription.isActive()) return {
                    status: !0,
                    end: Date.now() + cleverapps.parseInterval("1 day")
                };
            for (var e = cleverapps.parseInterval("1 month"), t = Date.now() - e, s = this.ids.length - 1, i = this.ids.length - 1, n = 0; 0 <= s && this.time[s] + e >= t; s--) {
                for (n += this.price[s]; this.time[s] + e < this.time[i];) n -= this.price[i], i--;
                if (this.time[i] < t) break;
                if (n >= cleverapps.PaymentsHistory.VIP_THRESHOLD) return {
                    status: !0,
                    end: this.time[i] + e
                }
            }
            return {
                status: !1
            }
        }, cleverapps.PaymentsHistory.prototype.calculateMinimalVipSum = function () {
            var e = Product.Create("gold6000");
            if (e.loadedPriceAmount && e.loadedCurrencyCode) return Math.ceil(e.loadedPriceAmount + .01) + " " + e.loadedCurrencyCode;
            e = Math.ceil(e.price + .01), e = cleverapps.payments.calcLoadedPrice ? cleverapps.payments.calcLoadedPrice(e) : Product.CURRENCY + " " + e;
            return Product.ReplaceIconCodes(e)
        }, cleverapps.PaymentsHistory.prototype.classify = function () {
            for (var e = 0, t = Date.now() - cleverapps.parseInterval("1 month"), s = this.ids.length - 1; 0 <= s && !(this.time[s] < t); s--) e += this.price[s];
            cleverapps.subscription && cleverapps.subscription.isActive() && (e += 9.99);
            for (var i = 0; i < cleverapps.PaymentsHistory.BRACKETS.length && !(e < cleverapps.PaymentsHistory.BRACKETS[i] + .001); i++);
            return i === cleverapps.PaymentsHistory.BRACKET_NONE && cleverapps.user.getFloatLevel() < cleverapps.PaymentsHistory.UNDECIDED_LEVEL_THRESHOLD && cleverapps.flags.highMonetization ? cleverapps.PaymentsHistory.BRACKET_UNDECIDED : i
        }, "undefined" == typeof cc && (module.exports = cleverapps.PaymentsHistory), function () {
            for (var e in WebViewPayments.call(this), this.startTime = Date.now(), cleverapps.config.products) {
                e = cleverapps.config.products[e];
                e.loadedId = e.id.rustore, e.loadedCurrencyCode = "RUB"
            }
        }),
        DraugiemProducts = (RuStorePayments.prototype = Object.create(WebViewPayments.prototype), (RuStorePayments.prototype.constructor = RuStorePayments).prototype.calcLoadedPrice = function (e) {
            return e + " RUB"
        }, RuStorePayments.prototype.onLoadResult = function (e, t, s) {
            console.log(
                "WebViewPayments.onLoadResult code - " + e + " type - " + t), e === cleverapps.CODE_SUCCEED ? (s = s || [], console.log("WebViewPayments.onLoadResult products - " + JSON.stringify(s)), s.forEach(function (e) {
                    var t = cleverapps.config.products[Product.SearchProductId(e.productId)];
                    void 0 !== t && (t.loadedPrice = this.calcLoadedPrice(e.price), console.log("WebViewPayments product " + e.productId + " " + t.loadedPrice))
                }.bind(this))) : console.log("WebViewPayments.onLoadResult failure")
        }, RuStorePayments.isAppropriate = function () {
            return cleverapps.platform.oneOf(Rustore)
        }, UserIdsHistory = function () {
            this.ids = [], this.diff = [], this.load(), this.sendToServer()
        }, UserIdsHistory.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.USER_IDS_HISTORY);
            e && (this.ids = e.ids || [], this.diff = e.diff || [])
        }, UserIdsHistory.prototype.add = function (e) {
            Platform.isTmpId(e) && 0 === cleverapps.user.getFloatLevel() && !cleverapps.paymentsHistory.isPayer() || e === cleverapps.platform.getUserID() || this.ids.includes(e) || (console.log(
                "UserIdsHistory add", e), this.ids.push(e), this.diff.push(e), this.save(), this.sendToServer())
        }, UserIdsHistory.prototype.sendToServer = function () {
            this.diff.length && cleverapps.RestClient.post("/useridshistory/" + encodeURIComponent(cleverapps.platform.getUserID()), {
                ids: this.diff
            }, function () {
                console.log("UserIdsHistory send success"), this.diff = [], this.save()
            }.bind(this), function () {
                console.log("UserIdsHistory send failed")
            })
        }, UserIdsHistory.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.USER_IDS_HISTORY, {
                ids: this.ids,
                diff: this.diff
            })
        }, {
            heroes: {
                buyExp10: 3846,
                buyExp150: 3847,
                addMoves1: 3848,
                addMoves2: 3849,
                addMoves3: 3850,
                addMoves5: 3851,
                piggybank500: 3852,
                piggybank1800: 3853,
                piggybank6000: 3854,
                piggybank25000: 3855,
                gold500: 3857,
                gold1800: 3858,
                gold3800: 3859,
                gold6000: 3860,
                gold25000: 3861,
                starterPack0: 3862,
                starterPack: 3863,
                starterPack2: 3864,
                battlepass: 3869,
                unlimitedLives: 3872,
                sweetPack: 3873,
                jamPack: 3874,
                tastyPack: 3875,
                honeyPack: 3876,
                epicPack: 3877
            },
            riddles: {
                buyExp10: 3750,
                buyExp150: 3751,
                addMoves1: 3741,
                addMoves2: 3752,
                addMoves3: 3753,
                addMoves5: 3754,
                piggybank500: 3755,
                piggybank1800: 3756,
                piggybank6000: 3757,
                piggybank25000: 3758,
                gold500: 3768,
                gold1800: 3774,
                gold3800: 3747,
                gold6000: 3775,
                gold25000: 3746,
                starterPack0: 3740,
                starterPack: 3748,
                starterPack2: 3749,
                battlepass: 3824,
                unlimitedLives: 3769,
                sweetPack: 3772,
                jamPack: 3761,
                tastyPack: 3764,
                honeyPack: 3762,
                epicPack: 3763
            },
            zenmatch: {
                gold500: 4083,
                gold1800: 4084,
                gold3800: 4085,
                gold6000: 4086,
                gold25000: 4087,
                starterPack0: 4088,
                starterPack: 4089,
                starterPack2: 4090
            },
            mergecraft: {
                gold500: 3982,
                gold1800: 3984,
                gold3800: 3988,
                gold6000: 3986,
                gold25000: 3989,
                starterPack0: 3987,
                starterPack: 3983,
                starterPack2: 3990,
                growthFund: 3985,
                expeditionPack: 4003,
                kit3: 4104,
                kit10: 4105,
                kit50: 4106
            },
            wondermerge: {
                gold500: 3992,
                gold1800: 3993,
                gold3800: 3994,
                gold6000: 3995,
                gold25000: 3996,
                starterPack0: 3997,
                starterPack: 3998,
                starterPack2: 3999,
                growthFund: 3991,
                expeditionPack: 4004
            }
        }),
        DraugiemProductsStaging = {
            riddles: {
                buyExp10: 4051,
                buyExp150: 4052,
                addMoves1: 4053,
                addMoves2: 4054,
                addMoves3: 4055,
                addMoves5: 4056,
                piggybank500: 4057,
                piggybank1800: 4058,
                piggybank6000: 4059,
                piggybank25000: 4060,
                gold500: 4061,
                gold1800: 4062,
                gold3800: 4063,
                gold6000: 4064,
                gold25000: 4065,
                starterPack0: 4066,
                starterPack: 4067,
                starterPack2: 4068,
                battlepass: 4069,
                unlimitedLives: 4070,
                sweetPack: 4071,
                jamPack: 4072,
                tastyPack: 4073,
                honeyPack: 4074,
                epicPack: 4075
            }
        },
        DraugiemPayments = (cleverapps.config.debugMode && Object.assign(DraugiemProducts, DraugiemProductsStaging), function () {
            for (var e in RestPayments.call(this), DraugiemProducts = DraugiemProducts[cleverapps.config.name], cleverapps.config.products) {
                var t = cleverapps.config.products[e];
                t.loadedPrice = this.calcLoadedPrice(t.price), t.loadedId = (DraugiemProducts[e] || "") + ""
            }
        }),
        XsollaPayments = (DraugiemPayments.prototype = Object.create(RestPayments.prototype), (DraugiemPayments.prototype.constructor = DraugiemPayments).prototype.calcLoadedPrice = function (e) {
            return e + " €"
        }, DraugiemPayments.prototype.isProductExists = function (e) {
            return cleverapps.config.products[e] && DraugiemProducts[e]
        }, DraugiemPayments.prototype.stopSocialChecker = function () {
            this.socialChecker && (this.socialChecker.stop(), delete this.socialChecker)
        }, DraugiemPayments.prototype.startSocialChecker = function (e, s, t) {
            this.stopSocialChecker();
            this.socialChecker = this.startChecker(Object.assign({}, t || {}, {
                check: function () {
                    console.log("ask transaction status: " + e.paymentId), cleverapps.social.api("transactions/check", {
                        id: e.paymentId
                    }, function (e, t) {
                        void 0 !== t && (console.log("status: ", t.status), "FAILED" === t.status ? s(cleverapps.CODE_FAILED) : "OK" === t.status && s(cleverapps.CODE_SUCCEED))
                    })
                }
            }))
        }, DraugiemPayments.prototype.purchaseOpen = function (s, i) {
            if (!DraugiemProducts[s.key]) return i(cleverapps.CODE_FAILED), void cleverapps.throwAsync("Draugiem payment configuration error for " + s.key);
            var e = {
                price: Math.round(100 * parseFloat(s.loadedPrice)),
                service: DraugiemProducts[s.key]
            };
            DraugiemPayments.TESTERS.includes(cleverapps.platform.getUserID()) && (e.price = 1),
                cleverapps.social.api("transactions/create", e, function (e, t) {
                    console.log(DraugiemProducts[s.key], e, t), e === cleverapps.CODE_SUCCEED ? (s.paymentId = t.transaction.id, this.setCancelTimeout(cleverapps.parseInterval("15 minutes"), i), this.startSocialChecker(s, i), this.setNotifyActiveListener(function () {
                        var e = cleverapps.arrayFill(15, "1 seconds");
                        this.startPurchaseChecker(s, i, {
                            timeouts: e
                        }), this.startSocialChecker(s, i, {
                            timeouts: e
                        }), this.setCancelTimeout(cleverapps.parseInterval("15 seconds"), i)
                    }.bind(this)), draugiemWindowOpen(t.transaction.link, 350, 400, function () {
                        console.log("Draugiem payment window close", s.itemId), this.notifyActive()
                    }.bind(this))) : i(cleverapps.CODE_FAILED)
                }.bind(this))
        }, DraugiemPayments.prototype.stopPurchaseActions = function () {
            RestPayments.prototype.stopPurchaseActions.call(this), this.stopSocialChecker()
        }, DraugiemPayments.isAppropriate = function () {
            return cleverapps.platform instanceof Draugiem
        }, DraugiemPayments.TESTERS = ["5531190", "5531196", "5533303", "5536860"], function () {
            for (
                var e in RestPayments.call(this), this.withSdk = !0, this.sandbox = Boolean(cleverapps.config.debugMode), cleverapps.config.products) cleverapps.config.products[e].loadedId = e;
            this.route = cleverapps.platform.oneOf(Crazy) ? "/crazypayments/" : "/xsollapayments/"
        }),
        YandexPayments = (XsollaPayments.prototype = Object.create(RestPayments.prototype), (XsollaPayments.prototype.constructor = XsollaPayments).prototype._connect = function (e) {
            cleverapps.loadSdk("//cdn.xsolla.net/embed/paystation/1.2.7/widget.min.js", {
                onSuccess: function () {
                    e(Platform.STATUS_CONNECTED)
                },
                onFailure: function () {
                    e(Platform.STATUS_DISCONNECTED)
                }
            })
        }, XsollaPayments.prototype.stopPurchaseActions = function () {
            RestPayments.prototype.stopPurchaseActions.apply(this, arguments), this.stopStatusChecker()
        }, XsollaPayments.prototype.purchase = function (s, i) {
            this.getAuthToken(function (e, t) {
                e === cleverapps.CODE_SUCCEED ? this.getPaymentToken(t, s, function (e, t) {
                    e === cleverapps.CODE_SUCCEED ? this.openWidget(s, t, i) : i(e)
                }.bind(this)) : i(e)
            }.bind(this))
        },
            XsollaPayments.prototype.getPaymentToken = function (e, t, s) {
                XsollaPayments.DEBUG_IDS.includes(cleverapps.platform.getUserID()) && t.price < 10 && (t.loadedId = t.itemId = "testProduct"), cleverapps.RestClient.post("https://store.xsolla.com/api/v2/project/" + e.project + "/payment/item/" + t.itemId, {
                    quantity: 1,
                    sandbox: this.sandbox
                }, function (e) {
                    return console.log("payment token", e), e && e.token ? void s(cleverapps.CODE_SUCCEED, e.token) : (console.log("getPaymentToken emoty token"), s(cleverapps.CODE_FAILED), void cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.XSOLLA.INIT_WIDGET_FAILED))
                }, function (e) {
                    s(cleverapps.CODE_CANCELLED), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.XSOLLA.INIT_WIDGET_FAILED), console.log("Failed to create Xsolla order: " + e)
                }, {
                    authorization: "Bearer " + e.token
                })
            }, XsollaPayments.prototype.getAuthToken = function (t) {
                var s = {
                    userid: cleverapps.platform.getUserID(),
                    name: cleverapps.info.getValue("name")
                },
                    e = cleverapps.platform.dataLoader.load(
                        SimpleDataLoader.TYPES.XSOLLA2_PAYMENTS_AUTH);
                if (e && JSON.stringify(e.data) === JSON.stringify(s) && e.created + XsollaPayments.AUTH_TOKEN_LIFETIME > Date.now() && e.created < Date.now()) return console.log("auth cache", e), void t(cleverapps.CODE_SUCCEED, e);
                cleverapps.RestClient.post(this.route + "auth/", s, function (e) {
                    if (console.log("auth response", JSON.stringify(e.error || e.auth || e)), e.error || !e.auth) return console.log("getAuthToken error - " + (e.error || "empty auth")), t(cleverapps.CODE_CANCELLED), void cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.XSOLLA.INIT_WIDGET_FAILED);
                    e = e.auth;
                    e.data = s, e.created = Date.now(), cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.XSOLLA2_PAYMENTS_AUTH, e), t(cleverapps.CODE_SUCCEED, e)
                }, function (e) {
                    console.log("getAuthToken error", e), t(cleverapps.CODE_CANCELLED), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.XSOLLA.INIT_WIDGET_FAILED)
                })
            }, XsollaPayments.prototype.openWidget = function (i, e, n) {
                var o = !1,
                    e = (XPayStationWidget.init({
                        lightbox: {
                            spinner: "round",
                            width: null,
                            height: null
                        },
                        sandbox: this.sandbox,
                        access_token: e
                    }), cleverapps.once(function () {
                        cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.XSOLLA.OPEN_WIDGET)
                    })),
                    e = (XPayStationWidget.on(XPayStationWidget.eventTypes.OPEN, e), XPayStationWidget.open(), XPayStationWidget.on(XPayStationWidget.eventTypes.STATUS, function (e, t) {
                        var s, t = t && t.paymentInfo;
                        t && (cleverapps.config.debugMode && console.log("Xsolla payment event: " + JSON.stringify(t)), s = t.status, t = t.invoice, ["invoice", "done", "delivering"].includes(s) && t && (i.paymentId = i.paymentId || t), "done" === s ? o = !0 : "troubled" === s && n(cleverapps.CODE_CANCELLED, i))
                    }), cleverapps.once(function () {
                        XPayStationWidget.off(XPayStationWidget.eventTypes.OPEN), XPayStationWidget.off(XPayStationWidget.eventTypes.CLOSE), XPayStationWidget.off(XPayStationWidget.eventTypes.STATUS), o && i.paymentId ? this.getPurchaseState() === PaymentsManager.STATE_PURCHASE && this.startStatusChecker(i, n) : n(cleverapps.CODE_CANCELLED)
                    }.bind(this)));
                XPayStationWidget.on(
                    XPayStationWidget.eventTypes.CLOSE, e)
            }, XsollaPayments.prototype.stopStatusChecker = function () {
                this.statusChecker && (this.statusChecker.stop(), delete this.statusChecker)
            }, XsollaPayments.prototype.startStatusChecker = function (i, n) {
                this.stopStatusChecker();
                var e, t = function () {
                    var s;
                    e || (e = !0, s = cleverapps.waitNoMore(1e4, cleverapps.once(function () {
                        e = !1
                    })), console.log("statusCheck: " + i.paymentId), cleverapps.RestClient.get(this.route + "get/" + i.paymentId, {}, function (e) {
                        var t;
                        s(), !e.error && e.payment ? (t = e.payment, console.log("statusCheck success: " + JSON.stringify(t)), ["paid", "done"].includes(t.status) && (i.loadedPrice = t.textPrice || i.loadedPrice, n(cleverapps.CODE_SUCCEED, i))) : console.log(e.error || "no payment")
                    }))
                }.bind(this);
                this.statusChecker = this.startChecker({
                    check: t
                })
            }, XsollaPayments.isAppropriate = function () {
                return cleverapps.platform.oneOf(MSStart, CleverApps, Crazy)
            }, XsollaPayments.AUTH_TOKEN_LIFETIME = cleverapps.parseInterval("1 hour"), cleverapps.config.debugMode && (
                XsollaPayments.AUTH_TOKEN_LIFETIME = cleverapps.parseInterval("1 second")), XsollaPayments.DEBUG_IDS = ["e913873c-3848-4155-a881-edb315e30692", "6e83dcbf-29fd-40f9-abed-83cf80d6194a", "54de395d-d6e0-4f83-8ed9-7b68e4de19e0", "c869c9f1-1729-4247-882e-fc1e0c37fbc6", "5fb5e261-5781-4730-ac0e-b5984c8e89d3"],
            function () {
                for (var e in Payments.call(this), cleverapps.config.products) {
                    e = cleverapps.config.products[e];
                    e.loadedPrice = this.calcLoadedPrice(e.price), e.loadedId = e.id.yandex
                }
            }),
        YooKassaPayments = (YandexPayments.prototype = Object.create(Payments.prototype), (YandexPayments.prototype.constructor = YandexPayments).prototype.calcLoadedPrice = function (e) {
            return Math.floor(e * cleverapps.RUB_DISCOUNTED_RATE) + (cleverapps.platform.isPlayhop() ? "}}" : "&&")
        }, YandexPayments.prototype._loadProducts = function (t) {
            cleverapps.platform.ysdk.getPayments({
                signed: !0
            }).then(function (e) {
                this.yaPayments = e, (cleverapps.config.debugMode || cleverapps.Random.nextDouble() < .01) && this.checkPrices(), t(cleverapps.CODE_SUCCEED)
            }.bind(this)).catch(function (e) {
                console.log("Payments unavailable", e)
            })
        }, YandexPayments.prototype.checkPrices = function () {
            this.yaPayments.getCatalog().then(function (e) {
                var s = [];
                this.catalogProductIds = {}, e.forEach(function (e) {
                    this.catalogProductIds[e.id] = !0;
                    var t = Product.Create(e.id);
                    t && parseInt(t.loadedPrice) !== parseInt(e.priceValue) && s.push(e.id)
                }, this), 0 < s.length && cleverapps.throwAsync("Yandex inconsistent products prices: " + s.join(","))
            }.bind(this)).catch(function (e) {
                console.log("Failed prices check", e)
            })
        }, YandexPayments.prototype.purchase = function (t, s) {
            if (this.yaPayments) return !t.id.yandex || this.catalogProductIds && !this.catalogProductIds[t.id.yandex] ? (cleverapps.throwAsync("Unregistered yandex product: " + t.itemId + ", catalogProducts - " + JSON.stringify(Object.keys(this.catalogProductIds))), void s(cleverapps.CODE_FAILED)) : void this.yaPayments.purchase({
                id: t.id.yandex,
                developerPayload: JSON.stringify({
                    userId: cleverapps.platform.getUserID(),
                    itemId: t.itemId
                })
            }).then(function (e) {
                e.paymentId = e.purchaseToken, e.productId = t.itemId, console.log("success", e), s(cleverapps.CODE_SUCCEED, e)
            }).catch(function (e) {
                console.log("error", e), s(cleverapps.CODE_FAILED)
            });
            console.log("Payments unavailable")
        }, YandexPayments.prototype.consume = function (e) {
            this.yaPayments.consumePurchase(e.purchaseToken).then(function () {
                console.log("consume success", e)
            }).catch(function (e) {
                console.log("consume error", e)
            })
        }, YandexPayments.prototype.isRestoreAvailable = function () {
            return cleverapps.social.isLoggedIn() && Boolean(this.yaPayments)
        }, YandexPayments.prototype.restore = function (i) {
            this.yaPayments.getPurchases().then(function (e) {
                var t, s;
                console.log("getPurchases", e), 0 !== e.length ? (t = e[0], s = JSON.parse(t.developerPayload), t.paymentId = t.purchaseToken, t.productId = s.itemId, t.signature = e.signature, i(cleverapps.CODE_SUCCEED, t)) : i(cleverapps.CODE_FAILED)
            }).catch(function (e) {
                i(cleverapps.CODE_FAILED), console.log("error getPurchases", e)
            })
        }, YandexPayments.prototype.validate = function (t, s) {
            var e = {
                signature: t.signature,
                purchaseToken: t.purchaseToken
            };
            cleverapps.RestClient.post("/yandexpayments/validate", e, function (e) {
                e = "ok" === e ? cleverapps.CODE_SUCCEED : cleverapps.CODE_FAILED;
                s(e, t)
            }, function () {
                s(cleverapps.CODE_CANCELLED, t)
            })
        }, YandexPayments.isAppropriate = function () {
            return cleverapps.platform instanceof Yandex
        }, function () {
            for (var e in RestPayments.call(this), cleverapps.config.products) {
                var t = cleverapps.config.products[e];
                t.loadedPrice = this.calcLoadedPrice(t.price), t.loadedPriceAmount = parseInt(t.loadedPrice), t.loadedCurrencyCode = "RUB", t.loadedId = e
            }
            cleverapps.playSession.set(cleverapps.EVENTS.STATS.YOOKASSA.DAU, !0), cleverapps.platform.nativeEventListeners.YooKassaPayments = this.onNativeEvent.bind(this)
        }),
        MicrosoftPayments = (YooKassaPayments.prototype = Object.create(RestPayments.prototype), (YooKassaPayments.prototype.constructor = YooKassaPayments).prototype.calcLoadedPrice = function (e) {
            var t = Math.floor(e * cleverapps.RUB_YOOKASSA_RATE) + " RUB";
            return t = cleverapps.config.debugMode || WebViewPayments.DEBUG_IDFA.includes(cleverapps.platform.device.idfa) || XsollaPayments.DEBUG_IDS.includes(cleverapps.platform.getUserID()) ? Math.max(1, Math.round(e / 3)) + " RUB" : t
        }, YooKassaPayments.prototype.purchase = function (t, s) {
            var e, i, n, o;
            "subscription" !== t.type ? (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.YOOKASSA.OPEN), i = cleverapps.platform.device.idfa, n = cleverapps.info.getValue("email"), e = void 0, cleverapps.platform.haveTmpId() && (!i || i.startsWith("0000")) || (e = cleverapps.platform.getUserID() + "_" + i + "_" + n), i = {
                itemId: t.loadedId,
                price: t.loadedPriceAmount,
                loadedPriceAmount: t.loadedPriceAmount,
                email: n,
                merchantCustomerId: e
            }, n = {
                userid: cleverapps.platform.getUserID(),
                source: cleverapps.platform.source,
                purchase: i
            }, console.log("YooKassaPayments.create", JSON.stringify(n)), o = function (e) {
                console.log("purchase error", e), s(cleverapps.CODE_FAILED)
            }, cleverapps.RestClient.post("/yookassapayments/create", n, function (e) {
                console.log(
                    "YooKassaPayments.create response", JSON.stringify(e.error || e.payment || e)), e.error && "receipt.customer.email" === e.parameter && (cleverapps.notification.create("PurchaseCancelled.InvalidEmail"), cleverapps.info.setKeyValue("email", "")), !e.error && e.payment ? (e = e.payment, t.paymentId = e.paymentId, t.confirmation_type = e.confirmation && e.confirmation.type, t.confirmation_url = e.confirmation && e.confirmation.confirmation_url, t.confirmation_token = e.confirmation && e.confirmation.confirmation_token, console.log("YooKassaPayments.create Success: " + JSON.stringify(e)), ["waiting_for_capture", "succeeded"].includes(e.status) ? s(cleverapps.CODE_SUCCEED, t) : ["canceled"].includes(e.status) ? s(cleverapps.CODE_CANCELLED, t) : "pending" === e.status && t.paymentId ? this.openWidget(t, s) : o()) : o(e.error || "empty payment")
            }.bind(this), o)) : s(cleverapps.CODE_FAILED)
        }, YooKassaPayments.prototype.getFinishUrl = function (e) {
            var t, s = (cleverapps.isLocalhost() ? "" : cleverapps.config.deployment) + cleverapps.config.restApiURL + "/yookassapayments/finish/" + encodeURIComponent(cleverapps.platform.getUserID()),
                i = new URLSearchParams;
            return cleverapps.platform.info.isNative && (t = "cleverapps://" + cleverapps.config.name, cleverapps.config.debugMode && (t += "staging"), i.set("app_link", t)), e && e.paymentId && i.set("paymentId", e.paymentId), 0 < i.size && (s += "?" + i.toString()), s
        }, YooKassaPayments.prototype.getWidgetUrl = function (e) {
            var t = location.href.substring(0, location.href.lastIndexOf("/") + 1);
            return (t = cleverapps.platform.info.isNative ? cleverapps.config.staticUrl || cleverapps.config.deployment + (cleverapps.config.debugMode ? "/publish/html5-staging/" : "/publish/html5/") : t) + "cleverapps/res/yookassa-widget.html?confirmation_token=" + e.confirmation_token + "&payment_id=" + e.paymentId + "&finish_url=" + encodeURIComponent(this.getFinishUrl(e)) + "&modal=" + cleverapps.platform.oneOf(CleverApps, TestPlatform)
        }, YooKassaPayments.prototype.openWidget = function (e, t) {
            this.onWidgetClosedListener = function () {
                console.log(
                    "YooKassaPayments.onWidgetClosedListener - " + this.getPurchaseState()), this.getPurchaseState() === PaymentsManager.STATE_PURCHASE && this.startStatusChecker(e, t)
            }.bind(this), this.setNotifyActiveListener(this.onWidgetClosed.bind(this));
            var s, i, n = this.getWidgetUrl(e);
            cleverapps.platform.oneOf(AndroidPlatform) ? cleverapps.platform.callNative("YooKassaPlugin.openWidget", {
                widgetUrl: n
            }) : (s = document.createElement("iframe"), s.style.height = "100%", s.style.width = "100%", s.style.zIndex = "1000000000", s.style.border = "none", s.src = n, s.id = "YooKassaFrame", s.allow = "payment", document.body.appendChild(s), i = window.addEventListener("message", function (e) {
                "close" === e.data.action && (window.removeEventListener("message", i), s.parentNode && s.parentNode.removeChild(s), this.onWidgetClosed())
            }.bind(this)))
        }, YooKassaPayments.prototype.onWidgetClosed = function () {
            this.onWidgetClosedListener && (this.onWidgetClosedListener(), delete this.onWidgetClosedListener)
        }, YooKassaPayments.prototype.stopStatusChecker = function () {
            this.statusChecker && (this.statusChecker.stop(), delete this.statusChecker)
        }, YooKassaPayments.prototype.startStatusChecker = function (s, i) {
            this.stopStatusChecker();
            var n = Date.now() + YooKassaPayments.WAIT_PURCHASE_STATE_TIMEOUT;
            this.statusChecker = this.startChecker({
                check: function () {
                    console.log("YooKassaPayments.statusCheck: " + s.paymentId), cleverapps.RestClient.get("/yookassapayments/get/" + s.paymentId, {}, function (e) {
                        var t;
                        !e.error && e.payment ? (t = e.payment, console.log("YooKassaPayments.statusCheck success: " + JSON.stringify(t)), ["waiting_for_capture", "succeeded"].includes(t.status) ? i(cleverapps.CODE_SUCCEED, s) : ["canceled"].includes(t.status) || "cancel" === t.purchaseState ? i(cleverapps.CODE_CANCELLED) : ["initialize_error", "fail"].includes(t.purchaseState) ? i(cleverapps.CODE_FAILED) : Date.now() > n && !["finished", "success"].includes(t.purchaseState) && (console.log("YooKassaPayments.statusCheck wait purchaseState timeout"), i(cleverapps.CODE_FAILED))) : console.log(e.error || "no payment")
                    })
                },
                timeouts: cleverapps.arrayFill(5, "1 seconds").concat(RestPayments.TIMEOUTS)
            }), this.setCancelTimeout(YooKassaPayments.WAIT_SUCCEEDED_TIMEOUT, i)
        }, YooKassaPayments.prototype.stopPurchaseActions = function () {
            RestPayments.prototype.stopPurchaseActions.apply(this, arguments), this.stopStatusChecker(), delete this.onWidgetClosedListener
        }, YooKassaPayments.prototype.onNativeEvent = function (e) {
            "widgetClosed" === e && this.onWidgetClosed()
        }, YooKassaPayments.isAppropriate = function () {
            return cleverapps.paymentsCountry.isInitialized() && cleverapps.paymentsCountry.isRussia() && (cleverapps.platform.oneOf(AndroidPlatform) || cleverapps.platform.oneOf(CleverApps))
        }, YooKassaPayments.WAIT_PURCHASE_STATE_TIMEOUT = cleverapps.parseInterval("2 seconds"), YooKassaPayments.WAIT_SUCCEEDED_TIMEOUT = cleverapps.parseInterval("60 seconds"), function () {
            Payments.call(this), Product.WAIT_NO_MORE = 2e4
        }),
        MygamesPayments = (MicrosoftPayments.prototype = Object.create(Payments.prototype), (MicrosoftPayments.prototype.constructor = MicrosoftPayments).prototype._connect = function (c) {
            cleverapps.platform.callNative("store.init", function (e, t) {
                if (console.log("MicrosoftPayments.onInit - " + JSON.stringify(t)), t.error) return c(Platform.STATUS_DISCONNECTED), void console.log("Error requesting microsoft products", t.error);
                var s, i = cleverapps.config.microsoft.iap,
                    n = (i.testProduct && MicrosoftPayments.Devs.includes(cleverapps.platform.getDeviceId()) && (i.gold500 = i.testProduct.id || i.testProduct, cleverapps.config.debugMode && i.testProduct.debugId && (i.gold500 = i.testProduct.debugId)), t.products);
                for (s in i) {
                    var o = i[s],
                        a = cleverapps.config.products[s],
                        r = n[o];
                    a && r && (a.loadedPrice = r.price, a.loadedCurrencyCode = r.currencyCode, a.loadedId = o, console.log("MicrosoftPayments product " + s + " " + o + " " + a.loadedPrice))
                }
                c(Platform.STATUS_CONNECTED)
            })
        }, MicrosoftPayments.prototype.purchase = function (e, n) {
            if (!e.loadedId) return console.log("MicrosoftPayments.open " + e.itemId + " loadedId not available"), void n(cleverapps.CODE_FAILED);
            cleverapps.platform.callNative("store.purchase", {
                productId: e.loadedId
            }, function (e, t) {
                var s, i = Product.Create(t.productId) || {};
                t.canceled ? (console.log("MicrosoftPayments.onPurchaseCancelled", i.key), e = cleverapps.CODE_CANCELLED) : t.error ? (console.log("MicrosoftPayments.onPurchaseFailure", i.key, t.error), e = cleverapps.CODE_FAILED) : (console.log("MicrosoftPayments.onPurchaseSuccess", i.key, t), e = cleverapps.CODE_SUCCEED, (s = i).trackingId = t.trackingId, s.loadedCurrencyCode = s.loadedCurrencyCode || "USD", s.loadedPriceAmount = parseFloat(i.loadedPrice.replace(",", ".").replace(/[^\d.]/g, "")) || i.price, s.transactionId = t.trackingId), n(e, s)
            })
        }, MicrosoftPayments.isAppropriate = function () {
            return cleverapps.platform instanceof Microsoft
        }, MicrosoftPayments.Devs = ["MS_d1005317-92e5-4a83-11a9-d927877edd08", "MS_af64328e-3371-73c1-367c-92bb6d560ed5", "MS_3c940659-7a68-99e0-0ef2-0e4369a5372f", "MS_bafafe21-499a-26aa-44dc-f74662bff405", "MS_9c82c0be-a17d-a981-11b7-4a85ec0661a4", "MS_089e6329-8b28-c5e4-7b60-1f56b5b4b126", "MS_34390e45-0500-febc-5829-27c92a3481b5",
            "MS_428f0900-1986-514e-b40e-3c8b70235374", "MS_459d1c26-a293-f56b-b56c-84f410e3830b", "MS_3ff4887f-2eaa-81d3-e99e-d6495ee64e85", "MS_13c53147-883c-b6e0-6c56-2aae159ed6d1", "MS_c8d2d30b-2a32-573b-219f-eaa7cbbd6f35"
        ], function () {
            for (var e in RestPayments.call(this), this.currency = new URLSearchParams(window.location.search).get("ui_currency") || "RUB", cleverapps.config.products) {
                var t = cleverapps.config.products[e];
                t.loadedPrice = this.calcLoadedPrice(t.price), t.loadedId = e
            }
        }),
        KongregatePayments = (MygamesPayments.prototype = Object.create(RestPayments.prototype), (MygamesPayments.prototype.constructor = MygamesPayments).prototype.calcLoadedPrice = function (e) {
            var t = cleverapps.EXCHANGE_RATES[this.currency],
                t = ("RUB" === this.currency ? e = Math.floor(e * cleverapps.RUB_DISCOUNTED_RATE) : t && (e = Math.ceil(e * t)), -1 !== MygamesPayments.TESTERS.indexOf(cleverapps.platform.getUserID()) && (e = Math.ceil(e / 1e3)), Product.CURRENCY_SIGNS[this.currency] || this.currency);
            return e + " " + t
        }, MygamesPayments.prototype.purchaseOpen = function (e, t) {
            e = {
                uid: cleverapps.platform.getUserID(),
                currency: this.currency,
                item_id: e.key,
                amount: parseFloat(e.loadedPrice),
                additional_param: "",
                description: e.description
            };
            cleverapps.RestClient.post("/mygamespayments", e, function (e) {
                e.error ? (console.log(e.error), t(cleverapps.CODE_FAILED)) : window.electronApi.showPayment(e.url)
            })
        }, MygamesPayments.isAppropriate = function () {
            return cleverapps.platform instanceof Mygames
        }, MygamesPayments.TESTERS = ["223914816", "224977482", "224977211", "224977565"], void 0 === cleverapps && "undefined" == typeof window && (cleverapps = require("../../utils"), RestPayments = function () { }), function () {
            for (var e in RestPayments.call(this), cleverapps.config.products) {
                var t = cleverapps.config.products[e];
                t.loadedPrice = this.calcLoadedPrice(t.price), t.loadedId = e
            }
        }),
        WechatPayments = (KongregatePayments.prototype = Object.create(RestPayments.prototype), (KongregatePayments.prototype.constructor = KongregatePayments).prototype.calcLoadedPrice = function (e) {
            return 10 * Math.ceil(e) + " {{"
        },
            KongregatePayments.prototype.purchaseOpen = function (e, t) {
                cleverapps.platform.exitFullscreen(function () {
                    kongregate.mtx.purchaseItemsRemote(e.itemId, function (e) {
                        e.success ? t(cleverapps.CODE_SUCCEED) : t(cleverapps.CODE_FAILED)
                    })
                })
            }, KongregatePayments.isAppropriate = function () {
                return cleverapps.platform instanceof Kongregate
            },
            function () {
                for (var e in RestPayments.call(this), console.log("wechat payments"), cleverapps.config.products) {
                    e = cleverapps.config.products[e];
                    e.loadedPrice = this.calcLoadedPrice(e.price), e.loadedPriceAmount = this.getLoadedPriceAmount(e.loadedPrice), e.loadedCurrencyCode = "CNY", e.loadedPriceGems = e.loadedPriceAmount * WechatPayments.CNY_GEMS_RATE
                }
            }),
        CustomSyncers = (WechatPayments.prototype = Object.create(RestPayments.prototype), (WechatPayments.prototype.constructor = WechatPayments).prototype._connect = function (e) {
            e(cleverapps.platform.info.os === PlatformInfo.OS_IOS ? Platform.STATUS_DISABLED : Platform.STATUS_CONNECTED)
        }, WechatPayments.prototype.calcLoadedPrice = function (e) {
            e = Math.floor(
                e * cleverapps.WECHAT_PAYMENTS_RATE), e = WechatPayments.getLevelPrice(e);
            return WechatPayments.CURRENCY + e
        }, WechatPayments.prototype.getLoadedPriceAmount = function (e) {
            return parseInt(e.replace(WechatPayments.CURRENCY, ""))
        }, WechatPayments.prototype.purchaseOpen = function (t, s) {
            var i, e = new ActionPlayer([function (t, e) {
                this.getBalance(function (e) {
                    i = e.balance || 0, t()
                }, e)
            }.bind(this), function (e) {
                i >= t.loadedPriceGems ? this.pay(t, s) : this.requestMidasPayment(i, t, s), e()
            }.bind(this)]);
            e.onFailure(function () {
                s(cleverapps.CODE_FAILED)
            }), e.play()
        }, WechatPayments.prototype.requestMidasPayment = function (e, t, s) {
            var i, n = WechatPayments.getLevelAmount(t.loadedPriceAmount - e / WechatPayments.CNY_GEMS_RATE),
                o = (console.log("requestMidasPayment - " + n), cleverapps.platform.getOrientation());
            new ActionPlayer([function (t) {
                "portrait" !== o ? (console.log("Switch to vertical"), wx.setDeviceOrientation({
                    value: "portrait",
                    success: function () {
                        console.log("Switch to vertical SUCCESS"), t()
                    },
                    fail: function (e) {
                        console.log(
                            "Switch to vertical FAIL", e), t()
                    }
                })) : t()
            }, function (t) {
                wx.requestMidasPayment({
                    mode: "game",
                    offerId: "1450100764",
                    currencyType: "CNY",
                    buyQuantity: n * WechatPayments.CNY_GEMS_RATE,
                    env: cleverapps.config.debugMode ? WechatPayments.ENV_SANDBOX : WechatPayments.ENV_RELEASE,
                    success: function (e) {
                        console.log("midas payment success", e), cleverapps.config.debugMode && cleverapps.notification.create("payment - " + JSON.stringify(e)), i = !0, t()
                    },
                    fail: function (e) {
                        console.log("midas payment fail", e), cleverapps.config.debugMode && cleverapps.notification.create("payment fail - " + JSON.stringify(e)), t()
                    }
                })
            }, function (t) {
                cleverapps.platform.getOrientation() !== o ? (console.log("Switch back to horizontal"), wx.setDeviceOrientation({
                    value: o,
                    success: function () {
                        console.log("Switch back to horizontal SUCCESS"), t()
                    },
                    fail: function (e) {
                        console.log("Switch back to horizontal FAIL", e), t()
                    }
                })) : t()
            }, function (e) {
                i ? this.waitBalance(t, s) : s(cleverapps.CODE_FAILED), e()
            }.bind(this)]).play()
        }, WechatPayments.prototype.stopPurchaseActions = function () {
            RestPayments.prototype.stopPurchaseActions.call(this), this.stopWaitBalance()
        }, WechatPayments.prototype.stopWaitBalance = function () {
            this.balanceChecker && (this.balanceChecker.stop(), delete this.balanceChecker)
        }, WechatPayments.prototype.waitBalance = function (t, s) {
            this.stopWaitBalance(), this.setCancelTimeout(cleverapps.parseInterval("30 seconds"), s), this.balanceChecker = this.startChecker({
                timeouts: cleverapps.arrayFill(15, "2 seconds"),
                check: function () {
                    this.getBalance(function (e) {
                        this.getPurchaseState() === PaymentsManager.STATE_PURCHASE && e.balance && t.loadedPriceGems <= e.balance && (this.stopWaitBalance(), this.pay(t, s))
                    }.bind(this))
                }.bind(this)
            })
        }, WechatPayments.prototype.getBalance = function (t, s) {
            var e = "/wechat/getbalance/" + encodeURIComponent(cleverapps.platform.getUserID());
            cleverapps.RestClient.post(e, {}, function (e) {
                console.log("getbalance - " + JSON.stringify(e)), e.errcode || void 0 === e.balance ? (cleverapps.config.debugMode && cleverapps.notification.create("balance - " + JSON.stringify(e)), s && s()) : t(e)
            }, function (e) {
                console.log("getbalance fail", e), s && s()
            })
        }, WechatPayments.prototype.pay = function (s, i) {
            var e = "/wechat/pay/" + encodeURIComponent(cleverapps.platform.getUserID());
            cleverapps.RestClient.post(e, {
                product: s
            }, function (e) {
                console.log("pay", e), s.paymentId = e.paymentId;
                var t = 0 === e.errcode && e.paymentId ? cleverapps.CODE_SUCCEED : cleverapps.CODE_FAILED;
                t !== cleverapps.CODE_SUCCEED && cleverapps.config.debugMode && cleverapps.notification.create("pay - " + JSON.stringify(e)), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PAY_RESULT, {
                    platform: "wechat",
                    pr_id: s.itemId,
                    name_of_the_package: s.title,
                    pay_amount: s.loadedPriceAmount,
                    currency: s.loadedCurrencyCode,
                    result: t === cleverapps.CODE_SUCCEED
                }), i(t, s)
            }, function (e) {
                console.log("pay fail", e), i(cleverapps.CODE_FAILED)
            })
        }, WechatPayments.getLevelPrice = function (e) {
            for (var t = WechatPayments.PRICE_LEVELS, s = 1; s < t.length; s++)
                if (e < t[s]) return t[s - 1];
            return t[t.length - 1]
        }, WechatPayments.getLevelAmount = function (t) {
            var e = WechatPayments.PRICE_LEVELS;
            return e.find(function (e) {
                return t <= e
            }) || e[e.length - 1]
        }, WechatPayments.isAppropriate = function () {
            return cleverapps.platform.oneOf(Wechat)
        }, WechatPayments.ENV_RELEASE = 0, WechatPayments.ENV_SANDBOX = 1, WechatPayments.CURRENCY = "￥", WechatPayments.CNY_GEMS_RATE = 10, WechatPayments.PRICE_LEVELS = [1, 3, 6, 8, 12, 18, 25, 30, 40, 45, 50, 60, 68, 73, 78, 88, 98, 108, 118, 128, 148, 168, 188, 198, 328, 648], {
            extractors: {
                users: function () {
                    if (cleverapps.user) return cleverapps.user.getInfo()
                },
                tournament: function () {
                    if (Game.currentGame && Game.currentGame.competition && Game.currentGame.competition.options && "tournament" === Game.currentGame.competition.options.type) return {
                        level: Game.currentGame.competition.options.level.getHumanReadableNumber(),
                        results: Game.currentGame.competition.options.players
                    }
                },
                userdelete: function () {
                    return cleverapps.userDelete.getInfo()
                },
                bonuses: function () {
                    if (cleverapps.periodicBonus) return {
                        event: cleverapps.periodicBonus.when
                    }
                },
                bonusgames: function () {
                    if (cleverapps.bonusRoundChest) return {
                        event: cleverapps.bonusRoundChest.when
                    }
                },
                settings: function () {
                    if (cleverapps.settings) return cleverapps.settings.getSaveInfo()
                },
                serverflags: function () {
                    if (cleverapps.serverFlags) return cleverapps.serverFlags.getInfo()
                },
                tempgoods: function () {
                    if (cleverapps.unlimitedLives) return cleverapps.unlimitedLives.getInfo()
                },
                boosters: function () {
                    if (cleverapps.boosters) return cleverapps.boosters.data
                },
                starchests: function () {
                    if (cleverapps.starChest) return {
                        stars: cleverapps.starChest.stars
                    }
                },
                packs: function () {
                    if (cleverapps.packManager) return {
                        used: cleverapps.packManager.used
                    }
                },
                dailytasks: function () {
                    if (cleverapps.dailyTasks) return cleverapps.dailyTasks.getInfo()
                },
                missions: function () {
                    if (cleverapps.missionManager) return cleverapps.missionManager.getInfo()
                },
                piggybank: function () {
                    if (cleverapps.piggyBank) return cleverapps.piggyBank.getInfo()
                },
                heroes: function () {
                    if ("undefined" != typeof match3 && match3 && match3.heroes) return match3.heroes.getInfo()
                },
                subscription: function () {
                    return cleverapps.subscription.getInfo(!0)
                },
                forces: function () {
                    if (cleverapps.forces) return cleverapps.forces.getInfo()
                },
                metha: function () {
                    if (cleverapps.meta.getMainObject().getInfo) return cleverapps.meta.getMainObject().getInfo()
                },
                cookiejar: function () {
                    if (levels && levels.cookieJar) return levels.cookieJar.getCounterValue()
                },
                competitionstatistics: function () {
                    if (cleverapps.competitionStatistics) return cleverapps.competitionStatistics.getInfo()
                },
                growthfund: function () {
                    if (cleverapps.growthFund) return cleverapps.growthFund.getInfo()
                },
                unitsshop: function () {
                    if (cleverapps.unitsShop) return cleverapps.unitsShop.getInfo()
                },
                unitslibrary: function () {
                    if (cleverapps.unitsLibrary) return cleverapps.unitsLibrary.getInfo()
                },
                paymentshistory: function () {
                    if (cleverapps.paymentsHistory) return cleverapps.paymentsHistory.getInfo()
                },
                army: function () {
                    if (cleverapps.army) return cleverapps.army.getInfo()
                },
                armylibrary: function () {
                    if (cleverapps.armyLibrary) return cleverapps.armyLibrary.getInfo()
                },
                achievements: function () {
                    if (cleverapps.achievements) return cleverapps.achievements.getInfo()
                }
            },
            importerData: {
                users: function (e) {
                    var t = cleverapps.user;
                    t && (t.updateInfo(e), cleverapps.hose && (cleverapps.hose.reset(), cleverapps.hose.setCurrentEpisode(cleverapps.user.episode)), cleverapps.playButton && cleverapps.playButton.update())
                },
                tournament: function (e) {
                    e && e.level && e.results && cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.COMPETITION + "_tournament", e)
                },
                userdelete: function (e) {
                    cleverapps.userDelete.updateInfo(e)
                },
                bonuses: function (e) {
                    var t;
                    cleverapps.periodicBonus && (t = cleverapps.periodicBonus, e.event < t.when || e.event > Date.now() + t.interval || (t.locked = !0, t.setWhenUnlock(e.event), t.save(!1), t.changeLockedListener()))
                },
                bonusgames: function (e) {
                    var t;
                    cleverapps.bonusRoundChest && (t = cleverapps.bonusRoundChest, e.event < t.when || e.event > Date.now() + t.interval || (t.locked = !0, t.setWhenUnlock(e.event), t.save(!1), t.changeLockedListener()))
                },
                settings: function () { },
                boosters: function (e) {
                    cleverapps.boosters && (cleverapps.boosters.data = e, cleverapps.boosters.save(!1), cleverapps.boosters.addInitAmount())
                },
                serverflags: function (e) {
                    cleverapps.serverFlags && cleverapps.serverFlags.updateInfo(e, !0)
                },
                tempgoods: function (e) {
                    cleverapps.unlimitedLives && cleverapps.unlimitedLives.updateInfo(e, !0)
                },
                missions: function (e) {
                    cleverapps.missionManager && (cleverapps.missionManager.updateInfo(e, !0), cleverapps.travelBook.updatePages())
                },
                piggybank: function (e) {
                    cleverapps.piggyBank && cleverapps.piggyBank.updateInfo(e, !0)
                },
                starchests: function (e) {
                    cleverapps.starChest && cleverapps.starChest.updateInfo(e, !0)
                },
                packs: function (e) {
                    cleverapps.packManager && (cleverapps.packManager.used = e.used, cleverapps.packManager.save(!1))
                },
                dailytasks: function (e) {
                    cleverapps.dailyTasks && (cleverapps.dailyTasks.load(e), cleverapps.dailyTasks.save(!1), cleverapps.dailyTasks.update())
                },
                heroes: function (e) {
                    "undefined" != typeof match3 && match3 && match3.heroes && match3.heroes.updateInfo(e, !0)
                },
                subscription: function (e) {
                    cleverapps.subscription.updateInfo(e, !0)
                },
                forces: function (e) {
                    cleverapps.forces && cleverapps.forces.updateInfo(e, !0)
                },
                metha: function (e) {
                    cleverapps.meta.getType() !== Metha.HOSE && cleverapps.meta.getMainObject().updateInfo && cleverapps.meta.getMainObject().updateInfo(e)
                },
                cookiejar: function (e) {
                    e = e && void 0 !== e.counterValue ? e.counterValue : e || 0;
                    cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.COOKIE_JAR, e), levels && levels.cookieJar && levels.cookieJar.load()
                },
                competitionstatistics: function (e) {
                    cleverapps.competitionStatistics && cleverapps.competitionStatistics.updateInfo(e, !0)
                },
                growthfund: function (e) {
                    cleverapps.growthFund && cleverapps.growthFund.updateInfo(e)
                },
                unitsshop: function (e) {
                    cleverapps.unitsShop && cleverapps.unitsShop.updateInfo(e)
                },
                unitslibrary: function (e) {
                    cleverapps.unitsLibrary && cleverapps.unitsLibrary.updateInfo(e)
                },
                paymentshistory: function (e) {
                    cleverapps.paymentsHistory && cleverapps.paymentsHistory.updateInfo(e)
                },
                army: function (e) {
                    if (cleverapps.army) return cleverapps.army.updateInfo(e)
                },
                armylibrary: function (e) {
                    if (cleverapps.armyLibrary) return cleverapps.armyLibrary.updateInfo(e)
                },
                achievements: function (e) {
                    cleverapps.achievements && (cleverapps.achievements.load(e), cleverapps.achievements.save(!1))
                }
            },
            registerBySlots: function (e, s, i) {
                CustomSyncers.SLOTS.forEach(function (t) {
                    this.extractors[e + t] = function () {
                        return s(t)
                    }, this.importerData[e + t] = function (e) {
                        return i(t, e)
                    }
                }.bind(this)), cleverapps.config.debugMode && (this.extractors[e + "_snapshot"] = s, this.importerData[e + "_snapshot"] = i, s.useSlots = !0, i.useSlots = !0)
            }
        }),
        RewardedAdsManager = (CustomSyncers.SLOT_MAIN = "", CustomSyncers.SLOTS = [CustomSyncers.SLOT_MAIN], "merge" === cleverapps.config.type && (CustomSyncers.EXPEDITION_SLOT1 = "1", CustomSyncers.EXPEDITION_SLOT2 = "2", CustomSyncers.EXPEDITION_SLOT3 = "3", CustomSyncers.SLOTS = [CustomSyncers.SLOT_MAIN, CustomSyncers.EXPEDITION_SLOT1, CustomSyncers.EXPEDITION_SLOT2, CustomSyncers.EXPEDITION_SLOT3]), cleverapps.Synchronizer = function () {
            this._session = "a";
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SESSION_SAVE_KEY, {
                raw: !0
            });
            null != e && (
                this._session = e), this._syncIn = new cleverapps.SyncIn, this._syncOut = new cleverapps.SyncOut, this._syncInProgress = !1, this._needResync = !1, this._syncId = 0, this._clientSessionExpired = !1, this._clientChecksumDifferent = !1 === cleverapps.DataLoader.checksumMatch, this.lastSyncIn = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LAST_SYNC_IN) || 0, (cleverapps.isLocalhost() || cleverapps.config.debugMode) && delete this._clientChecksumDifferent, this.synced = !1, cleverapps.DataLoader.checkClientSession() || this.clientSessionExpired()
        }, cleverapps.Synchronizer.prototype.updateLastSyncIn = function () {
            this.lastSyncIn = Date.now(), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LAST_SYNC_IN, this.lastSyncIn)
        }, cleverapps.Synchronizer.prototype._startCheckInterval = function () {
            var e;
            return !this._checkIntervalRunned && (this._checkIntervalRunned = !0, e = 0, setInterval(function () {
                e++, this.synced && e % 15 != 0 || this.syncWhenReady()
            }.bind(this), 6e4), !0)
        }, cleverapps.Synchronizer.prototype.needClientSessionExpiredWindow = function () {
            return this._clientSessionExpired
        }, cleverapps.Synchronizer.prototype.showClientSessionExpiredWindow = function () {
            cleverapps.meta.display({
                focus: "clientSessionExpired",
                action: function () {
                    new RestartWindow({
                        title: "ClientSessionExpired.title",
                        contentMessage: "ClientSessionExpired.message"
                    })
                }
            })
        }, cleverapps.Synchronizer.prototype.clientSessionExpired = function () {
            this._clientSessionExpired || (this.synced = !1, this._clientSessionExpired = !0, cleverapps.allInitialized && (cleverapps.meta.isFocused() || this.showClientSessionExpiredWindow()))
        }, cleverapps.Synchronizer.prototype.reset = function () {
            this.synced = !1, this._loadedSession = void 0, this._loadedSync = void 0, this._session = "a", this._syncInProgress = !1, this._needResync = !1, cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.SESSION_SAVE_KEY), this._syncOut.reset()
        }, cleverapps.Synchronizer.prototype.isReady = function () {
            return !this._syncIn.isReloadInProcess() && !this._syncInProgress && !this._inGetProgress
        }, cleverapps.Synchronizer.prototype.syncWhenReady = function () {
            this._syncIn.isReloadInProcess() || (cleverapps.DataLoader.checkClientSession(), this._syncInProgress ? this._needResync = !0 : this._sync())
        }, cleverapps.Synchronizer.prototype.addUpdateTask = function (e) {
            cleverapps.flags.norest || this._syncOut.addUpdateTask(e)
        }, cleverapps.Synchronizer.prototype.on = function () {
            this._clientSessionExpired || (void 0 !== this._loadedSession && (this._session = this._loadedSession, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SESSION_SAVE_KEY, this._session, {
                raw: !0
            }), cleverapps.DataLoader.processSaveQueue()), this._loadedSession = void 0, this._loadedSync = void 0, this.synced = !0, this._syncOut.run(), this._inGetProgress && (this._syncOut.sendAllData(), this._syncOut.onTasksEmptyListener = function () {
                this._syncInProgress = !1, this._inGetProgress = void 0
            }.bind(this)), this._onSyncProcessed(), this.onceSyncCompletedListener && (this.onceSyncCompletedListener(), this.onceSyncCompletedListener = void 0), this._needResync && (this._needResync = !1, this.syncWhenReady()))
        },
            cleverapps.Synchronizer.prototype._getPath = function (e) {
                return "/" + e + "/" + encodeURIComponent(cleverapps.platform.getUserID()) + "/" + this._session
            }, cleverapps.Synchronizer.prototype._syncCallback = function (e) {
                var t = this._syncId;
                return function () {
                    this._syncId !== t || this._clientSessionExpired || e.apply(this, arguments)
                }.bind(this)
            }, cleverapps.Synchronizer.prototype.getProgress = function (e, s) {
                var e = "/getprogress/" + encodeURIComponent(cleverapps.platform.getUserID()) + "/" + encodeURIComponent(e),
                    t = {
                        version: cleverapps.config.version
                    },
                    i = (s = s || {}, this._syncInProgress = !0, this._inGetProgress = !0, function (e) {
                        console.log("Error", e), this._syncInProgress = !1, this._inGetProgress = void 0, cleverapps.notification.create("Error load progress")
                    }.bind(this)),
                    n = function (e) {
                        if (s.acceptOnlyIfBetter && (!(t = e.sync.users) || !(t.episode !== cleverapps.user.episode ? t.episode > cleverapps.user.episode : t.level !== cleverapps.user.level ? t.level > cleverapps.user.level : "merge" === cleverapps.config.type && t.exp !== cleverapps.exp.getExp() && t.exp > cleverapps.exp.getExp()))) return this._syncInProgress = !1, this._inGetProgress = void 0, void (s.callback && s.callback());
                        var t;
                        this.synced = !1, this._loadedSync = e.sync, this._loadedSession = e.key, s.progressLoadOnly || this._syncIn.process(), s.callback && s.callback()
                    }.bind(this);
                cleverapps.RestClient.post(e, t, n, i)
            }, cleverapps.Synchronizer.prototype.getAccessToken = function () {
                return (cleverapps.platform.haveDeviceId() ? cleverapps.platform : cleverapps.social).getAccessToken()
            }, cleverapps.Synchronizer.prototype._sync = function () {
                var t, s, i, e, n, o, a;
                this._syncInProgress || this._clientSessionExpired || (t = this._startCheckInterval(), this._syncId++, this._syncInProgress = !0, s = this.synced, this.synced = !1, i = this.getAccessToken() || "undefined", e = this._getPath("newsync") + "/" + encodeURIComponent(i), n = {
                    episode: levels.user.episode,
                    level: levels.user.level,
                    progress: levels.user.progress,
                    source: cleverapps.platform.source,
                    progressCompare: cleverapps.user.progressCompare,
                    exp: cleverapps.expBySlots[CustomSyncers.SLOT_MAIN].getExp(),
                    registered: levels.user.registered,
                    loggedIn: levels.user.loggedIn,
                    localStorageEnabled: cleverapps.DataLoader.enabled,
                    localStorageCorrupted: cleverapps.DataLoader.corrupted,
                    version: cleverapps.config.version,
                    clientChecksumDifferent: this._clientChecksumDifferent
                }, o = this._syncCallback(function (e) {
                    this._syncInProgress = !1, delete this._clientChecksumDifferent, this._loadedSession = e.key, this._loadedSync = e.sync, this._zeroSession = e.zeroSession, e.cheater && (cleverapps.user.cheater = !0, cleverapps.flags.update()), cleverapps.userDelete.updateDeleted(e.deleted), void 0 !== this._loadedSession ? this._loadedSync ? (console.log("sync in"), this._syncIn.process(), this.updateLastSyncIn()) : this._syncOut.process() : this.on(), this._onSyncLoaded()
                }).bind(this), a = this._syncCallback(function (e) {
                    if (this._syncInProgress = !1, e && 403 === e.status) {
                        if ("undefined" === i && this.getAccessToken()) return void this.syncWhenReady();
                        cleverapps.social.onTokenValidateFailure && cleverapps.social.onTokenValidateFailure(), cleverapps.social.isLoggedIn() || (this.wantsSocialConnectWindow = !0, this.displaySocialConnectWindow())
                    } else (t || s) && cleverapps.config.debugMode && setTimeout(function () {
                        cleverapps.notification.create("Error saving progress")
                    }, t ? 2500 : 0);
                    this._onSyncProcessed(), this._onSyncLoaded()
                }).bind(this), cleverapps.RestClient.post(e, n, o, a))
            }, cleverapps.Synchronizer.prototype.overrideProgress = function (e) {
                var t = [function (e) {
                    this.whenSyncCompleted(e)
                }.bind(this), function (e) {
                    this._syncInProgress = !0, this._needResync = !1, new ReloadWindow(e)
                }.bind(this), function () {
                    cleverapps.snapshots.importData(e), cleverapps.scenes.sceneRefresh(), this._syncInProgress = !1, this._syncOut.sendAllData()
                }.bind(this)];
                cleverapps.meta.isFocused() ? cleverapps.meta.distract({
                    focus: "override",
                    actions: t
                }) : cleverapps.meta.display({
                    focus: "override",
                    actions: t
                })
            }, cleverapps.Synchronizer.prototype.displaySocialConnectWindow = function () {
                console.trace(),
                    cleverapps.meta.display({
                        focus: "SynchronizerCheckConnection",
                        actions: [function (e) {
                            cleverapps.social.checkConnection(function () {
                                e(), this.syncWhenReady()
                            }.bind(this), e, {
                                withWindow: !0,
                                errorMessage: "FbConnectWindow.TryAgain"
                            })
                        }.bind(this), function (e) {
                            this.wantsSocialConnectWindow = !1, e()
                        }.bind(this)]
                    })
            }, cleverapps.Synchronizer.prototype._onSyncProcessed = function () {
                this._onceFirstSyncCompletedListener && (console.log("first sync"), this._onceFirstSyncCompletedListener(), this._onceFirstSyncCompletedListener = void 0)
            }, cleverapps.Synchronizer.prototype._onSyncLoaded = function () {
                this._onceNextSyncCompletedListener && (this._onceNextSyncCompletedListener(), this._onceNextSyncCompletedListener = void 0)
            }, cleverapps.Synchronizer.prototype._onSyncOutCompleted = function () {
                this._onceSyncOutCompleted && (this._onceSyncOutCompleted(), this._onceSyncOutCompleted = void 0)
            }, cleverapps.Synchronizer.prototype.whenSyncCompleted = function (e) {
                this._syncInProgress ? this.onceSyncCompletedListener = e : e()
            },
            cleverapps.Synchronizer.SESSION_EXPIRED = 99, cleverapps.SyncIn = function () { }, cleverapps.SyncIn.prototype.executeSync = function (e) {
                for (var t in cleverapps.synchronizer._clientSessionExpired && (cleverapps.DataLoader.resetClientSession(), cleverapps.synchronizer._clientSessionExpired = !1), cleverapps.synchronizer._syncOut.reset(), e) {
                    var s = e[t],
                        i = CustomSyncers.importerData[t];
                    i ? i(s) : console.log("No importer for " + t)
                }
                GameDataSaver.Reset(), cleverapps.DataLoader.processSaveQueue(), cleverapps.localPushes.reset(), cleverapps.abTest.updateGroups()
            }, cleverapps.SyncIn.prototype.needShowReloadWindow = function () {
                return cleverapps.synchronizer._loadedSync
            }, cleverapps.SyncIn.prototype.isReloadInProcess = function () {
                return this._reloadInProgress
            }, cleverapps.SyncIn.prototype.reloadAction = function (e) {
                this._reloadInProgress = !0, new ReloadWindow(function () {
                    this.needShowReloadWindow() && (this.executeSync(cleverapps.synchronizer._loadedSync), cleverapps.synchronizer.on(), cleverapps.scenes.sceneRefresh(),
                        this._reloadInProgress = !1), e()
                }.bind(this))
            }, cleverapps.SyncIn.prototype.distractToReloadWindow = function () {
                cleverapps.config.wysiwygMode || cleverapps.meta.distract({
                    focus: "ReloadWindow",
                    action: function (e) {
                        this.reloadAction(e)
                    }.bind(this)
                })
            }, cleverapps.SyncIn.prototype.showReloadWindow = function () {
                cleverapps.config.wysiwygMode || cleverapps.meta.display({
                    focus: "ReloadWindow",
                    action: function (e) {
                        this.reloadAction(e)
                    }.bind(this)
                })
            }, cleverapps.SyncIn.prototype.process = function () {
                cleverapps.allInitialized ? cleverapps.meta.isFocused() ? this.isReloadInProcess() || cleverapps.windows.findWindow(FbConnectWindow) || this.distractToReloadWindow() : this.showReloadWindow() : (this.executeSync(cleverapps.synchronizer._loadedSync), cleverapps.synchronizer.on())
            }, cleverapps.SyncOut = function () {
                this.task = {}, this.currentTask = {}, this.onTasksEmptyListener = function () { }, this.inProgress = !1, this.sendNextUpdate = cleverapps.accumulate(cleverapps.SyncOut.FAST_ACCUMULATE_TIMEOUT, this._sendUpdateInner.bind(this)), (
                    cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SYNC) || []).forEach(function (e) {
                        CustomSyncers.extractors[e] && (this.task[e] = !0)
                    }, this)
            }, cleverapps.SyncOut.prototype.getAccumulateTimeout = function () {
                var e = cleverapps.paymentsHistory.isPayer(),
                    t = cleverapps.user.registered + cleverapps.parseInterval("3 days") > Date.now(),
                    s = cleverapps.SyncOut.MEDIUM_ACCUMULATE_TIMEOUT;
                return cleverapps.config.debugMode || e || t ? s = cleverapps.SyncOut.FAST_ACCUMULATE_TIMEOUT : (cleverapps.synchronizer._zeroSession || cleverapps.platform.oneOf(GDCom)) && (s = cleverapps.SyncOut.SLOW_ACCUMULATE_TIMEOUT), s
            }, cleverapps.SyncOut.prototype.run = function () {
                this.sendNextUpdate()
            }, cleverapps.SyncOut.prototype.save = function () {
                var e = Object.assign(this.currentTask, this.task);
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SYNC, Object.keys(e))
            }, cleverapps.SyncOut.prototype.reset = function () {
                this.task = {}, this.currentTask = {}, this.save()
            }, cleverapps.SyncOut.prototype.nextTask = function () {
                this.currentTask = this.task, this.task = {}
            },
            cleverapps.SyncOut.prototype.addUpdateTask = function (e) {
                !CustomSyncers.extractors[e] || this.task[e] || cleverapps.userDelete.isPlanned() || (this.task[e] = !0, this.save(), cleverapps.synchronizer.synced && cleverapps.allInitialized && this.sendNextUpdate())
            }, cleverapps.SyncOut.prototype.onSuccess = function (e) {
                if (this.inProgress = !1, cleverapps.synchronizer.synced) {
                    if (e.error && e.error === cleverapps.Synchronizer.SESSION_EXPIRED) return console.log("onUpdate: session needs renewal"), cleverapps.synchronizer.reset(), void cleverapps.synchronizer.syncWhenReady();
                    0 === e && console.log("error saving object"), this.currentTask = {}, this.save(), cleverapps.synchronizer._onSyncOutCompleted(), this.sendNextUpdate()
                }
            }, cleverapps.SyncOut.prototype.onFailure = function (e) {
                this.inProgress = !1, cleverapps.synchronizer.synced && (console.log("Failure: ", e), this.task = Object.assign(this.currentTask, this.task), this.currentTask = {}, cleverapps.synchronizer._onSyncOutCompleted(), setTimeout(this.sendNextUpdate.bind(this),
                    cleverapps.SyncOut.RETRY_TIMEOUT))
            }, cleverapps.SyncOut.prototype._sendUpdateInner = function () {
                cleverapps.DataLoader.onSaved(function () {
                    if (!this.inProgress && cleverapps.synchronizer.synced && !cleverapps.userDelete.isDeleted() && (cleverapps.DataLoader.checkClientSession(), !cleverapps.synchronizer._clientSessionExpired))
                        if (this.nextTask(), 0 !== Object.keys(this.currentTask).length) {
                            var e, t = {};
                            for (e in this.currentTask) {
                                var s = CustomSyncers.extractors[e]();
                                t[e] = s
                            }
                            this.inProgress = !0, console.log("Sending update ", t), t.version = cleverapps.config.version, cleverapps.RestClient.post(cleverapps.synchronizer._getPath("sync"), t, this.onSuccess.bind(this), this.onFailure.bind(this));
                            var i, n = JSON.stringify(t).length;
                            65536 < n && (i = Object.keys(t).map(function (e) {
                                return e + " - " + JSON.stringify(t[e]).length
                            }).join(", "), cleverapps.throwAsync("synchronizer sync entity too large - " + n + ", " + i))
                        } else this.onTasksEmptyListener()
                }.bind(this)), this.sendNextUpdate = cleverapps.accumulate(this.getAccumulateTimeout(),
                    this._sendUpdateInner.bind(this))
            }, cleverapps.SyncOut.prototype.sendAllData = function () {
                for (var e in CustomSyncers.extractors) this.addUpdateTask(e)
            }, cleverapps.SyncOut.prototype.getAllData = function () {
                try {
                    var e, t = {};
                    for (e in CustomSyncers.extractors) t[e] = CustomSyncers.extractors[e] && CustomSyncers.extractors[e]();
                    return t
                } catch (e) {
                    cleverapps.throwAsync("SyncOut.getAllData error", e)
                }
            }, cleverapps.SyncOut.prototype.process = function () {
                if (!cleverapps.userDelete.isPlanned())
                    for (var e in CustomSyncers.extractors) this.task[e] = !0;
                cleverapps.synchronizer.on()
            }, cleverapps.SyncOut.RETRY_TIMEOUT = 6e4, cleverapps.SyncOut.FAST_ACCUMULATE_TIMEOUT = 2e3, cleverapps.SyncOut.MEDIUM_ACCUMULATE_TIMEOUT = 1e4, cleverapps.SyncOut.SLOW_ACCUMULATE_TIMEOUT = 6e4,
            function () {
                cleverapps.EventEmitter.call(this), this.plugin = void 0, this.baseWatchCounter = 0, this.totalWatchCounter = cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.AD_WATCH_COUNTER) || 0, this.lastAdStarter = void 0, this.lastPlay = {}, this.lastAvailable = {},
                    this.lastAvailable[RewardedAdsManager.REWARDED] = Date.now(), this.lastAvailable[RewardedAdsManager.INTERSTITIAL] = Date.now(), cleverapps.platform.on("changeStatus:" + Platform.ADS, function (e) {
                        e === Platform.STATUS_CONNECTED && this.onConnected()
                    }.bind(this))
            }),
        RewardedAdOverlay = (RewardedAdsManager.prototype = Object.create(cleverapps.EventEmitter.prototype), (RewardedAdsManager.prototype.constructor = RewardedAdsManager).prototype.onConnected = function () {
            cleverapps.paymentsHistory.isVIP() && RewardedAdsManager.ACTIVE_ADS.forEach(function (e) {
                e === RewardedAdsManager.REWARDED && this.trigger("changeLoaderState:" + e, this.plugin.loaderState[e])
            }.bind(this)), this.checkCacheQueue(), new cleverapps.Interval(this.checkCacheQueue.bind(this), cleverapps.parseInterval("30 seconds"))
        }, RewardedAdsManager.prototype.createPlugin = function () {
            MultiAdsPlugin.isAppropriate() ? e = MultiAdsPlugin : GDComAds.isAppropriate() ? e = GDComAds : CrazyAds.isAppropriate() ? e = CrazyAds : PlingaAds.isAppropriate() ? e = PlingaAds : YandexAppAds.isAppropriate() ? e = YandexAppAds : AppLovinAds.isAppropriate() ? e = AppLovinAds : AdMobAds.isAppropriate() ? e = AdMobAds : OKAds.isAppropriate() ? e = OKAds : VKAds.isAppropriate() ? e = VKAds : InstantAds.isAppropriate() ? e = InstantAds : GoogleWebAds.isAppropriate() ? e = GoogleWebAds : YandexAds.isAppropriate() ? e = YandexAds : MSStartAds.isAppropriate() ? e = MSStartAds : WortalAds.isAppropriate() ? e = WortalAds : SamsungAds.isAppropriate() ? e = SamsungAds : WechatAds.isAppropriate() ? e = WechatAds : VideoAds.isAppropriate() && (e = VideoAds);
            var e, t = this.plugin && this.plugin.constructor;
            if (e && e !== t) return this.plugin = new e, this.plugin
        }, RewardedAdsManager.prototype.askPermission = function (e) {
            this.plugin ? this.plugin.askPermission(e) : e()
        }, RewardedAdsManager.prototype.init = function () {
            this.isEnabled() && (cleverapps.playSession.set(cleverapps.EVENTS.STATS.REWARDED_AVAILABLE_DAU, !0), this.noadsTimeout = new cleverapps.LongTimeout(function () {
                cleverapps.playSession.set(cleverapps.EVENTS.STATS.REWARDED_NOADS_DAU, !0), this.plugin.loadErrorCode && cleverapps.eventLogger.logEvent(
                    cleverapps.EVENTS.STATS.NOADS_ERROR + this.plugin.loadErrorCode)
            }.bind(this), cleverapps.parseInterval(RewardedAdsManager.REWARDED_NOADS_TIMEOUT)), this.plugin.onChangeLoaderState = this.onChangeLoaderState.bind(this), this.plugin.onChangeVideoState = this.onChangeVideoState.bind(this), this.plugin._onCancel = this.onCancel.bind(this))
        }, RewardedAdsManager.prototype.onChangeLoaderState = function (e) {
            console.log("onChangeLoaderState " + e, this.plugin.loaderState[e]), this.trigger("changeLoaderState:" + e, this.plugin.loaderState[e]), this.plugin.loaderState[e] === AdsPlugin.LOADER_STATE.READY && (this.lastAvailable[e] = Date.now(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ADS.READY), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.ADS.READY)), e === RewardedAdsManager.REWARDED && this.plugin.loaderState[e] === AdsPlugin.LOADER_STATE.READY && (this.noadsTimeout && (clearTimeout(this.noadsTimeout), delete this.noadsTimeout), cleverapps.playSession.set(cleverapps.EVENTS.STATS.REWARDED_LOADED_DAU, !0))
        },
            RewardedAdsManager.prototype.onChangeVideoState = function (e) {
                var t;
                console.log("onChangeVideoState " + e, this.plugin.videoState[e]), this.trigger("changeVideoState:" + e, this.plugin.videoState[e]), this.plugin.videoState[e] === AdsPlugin.VIDEO_STATE.PLAY ? (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ADS.START + "_" + e), e === RewardedAdsManager.INTERSTITIAL && (cleverapps.eventBus.trigger("taskEvent", DailyTasks.WATCH_ADS), cleverapps.thinkingData && cleverapps.thinkingData.logWatchAds()), e === RewardedAdsManager.REWARDED && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TARGET_FOR_BUYING.AD_START), cleverapps.gravityEngine && cleverapps.gravityEngine.logAd(e)) : (e !== RewardedAdsManager.INTERSTITIAL || this.plugin.isFakeImpression() || (t = (this.plugin.getECPM() || 0) / 1e3, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ADS.TYPE + e, {
                    value: t
                })), this.removeAdOverlay(), this.cacheNextAd(e))
            }, RewardedAdsManager.prototype.onCancel = function () {
                console.log("AdsPlugin._onCancel"), this.removeAdOverlay(), this.onFinish(!1)
            },
            RewardedAdsManager.prototype.checkCacheQueue = function () {
                this.isEnabled() && cleverapps.platform.isConnected(Platform.ADS) && RewardedAdsManager.ACTIVE_ADS.forEach(function (e) {
                    this.isAvailable(e) ? this.plugin.expired(e) && (this.plugin.reset(e), this.cacheNextAd(e)) : this.cacheNextAd(e)
                }.bind(this))
            }, RewardedAdsManager.prototype.cacheNextAd = function (e) {
                !cleverapps.paymentsHistory.isVIP() && cleverapps.platform.isConnected(Platform.ADS) && this.plugin.canCache(e) && (console.log("RewardedAdsManager caching " + e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ADS.CACHE), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.ADS.CACHE), this.plugin.cache(e))
            }, RewardedAdsManager.prototype.isEnabled = function () {
                return void 0 !== this.plugin
            }, RewardedAdsManager.prototype.isAvailable = function (e) {
                return !(!this.isEnabled() || !cleverapps.platform.isConnected(Platform.ADS)) && (cleverapps.paymentsHistory.isVIP() ? e === RewardedAdsManager.REWARDED : !!this.plugin.isAvailable(e) && (
                    e !== RewardedAdsManager.INTERSTITIAL || levels.user.checkAvailable(RewardedAdsManager.INTERSTITIAL_AVAILABLE)))
            }, RewardedAdsManager.prototype.loadAndPlay = function (t) {
                var s, i, e, n, o = cleverapps.once(t.onCancelCallback);
                if (this.adIsRunning()) return o(), void cleverapps.notification.create("AdsRunning");
                RewardedAdsManager.ACTIVE_ADS.includes(t.type) && (t.type !== RewardedAdsManager.INTERSTITIAL || !cleverapps.paymentsHistory.isVIP() && levels.user.checkAvailable(RewardedAdsManager.INTERSTITIAL_AVAILABLE) && cleverapps.paymentsHistory.classify() === cleverapps.PaymentsHistory.BRACKET_NONE) ? this.isAvailable(t.type) ? t.type === RewardedAdsManager.REWARDED ? this.playRewarded(t.adLimit, t.callback, o) : this.showInterstitial(t.callback) : (cleverapps.rewardedAdsManager.cacheNextAd(t.type), cleverapps.meta.isFocused() ? s = new WaitWindow : cleverapps.meta.display({
                    focus: "LoadingAds",
                    action: function (e) {
                        s = new WaitWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                }), i = function () {
                    n.clear(), clearTimeout(e), s.close(!0)
                }, e = setTimeout(
                    function () {
                        i(), cleverapps.platform.isConnected(Platform.ADS) ? this.isAvailable(t.type) || cleverapps.notification.create("NoAdsFound") : cleverapps.notification.create("PluginNotInited"), o()
                    }.bind(this), 1e4), n = this.on("changeLoaderState:" + t.type, function (e) {
                        e === AdsPlugin.LOADER_STATE.READY && (i(), t.type === RewardedAdsManager.REWARDED ? this.playRewarded(t.adLimit, t.callback, o) : this.canShowInterstitial() ? this.showInterstitial(t.callback) : o())
                    }.bind(this))) : o()
            }, RewardedAdsManager.prototype.removeAdOverlay = function (e) {
                cleverapps.audio.unmute(), cleverapps.CountDownManager.unmute(), e && e !== this.rewardOverlay || (e = this.rewardOverlay, this.rewardOverlay = void 0), e && e.removeFromParent(), RewardedAdsManager.onceOnRemoveOverlay && (RewardedAdsManager.onceOnRemoveOverlay(), RewardedAdsManager.onceOnRemoveOverlay = void 0)
            }, RewardedAdsManager.prototype.createVipRewarded = function () {
                var t = function () {
                    this.plugin.rewardAndFinish(!0)
                }.bind(this),
                    s = function () {
                        this.onFinish(!1), this.plugin.setFinished(
                            RewardedAdsManager.REWARDED, !0)
                    }.bind(this);
                this.plugin.setPlaying(RewardedAdsManager.REWARDED), cleverapps.meta.isFocused() ? new VIPRewardedWindow(t, s) : cleverapps.meta.display({
                    focus: "VIPRewardWindow",
                    action: function (e) {
                        new VIPRewardedWindow(t, s), cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }, RewardedAdsManager.prototype.createAdOverlay = function (s) {
                cleverapps.audio.mute(), cleverapps.CountDownManager.mute(), this.lastPlay[s] = Date.now();
                var t = function () {
                    var e = cleverapps.once(function (e) {
                        e = e && e.cancel;
                        this.plugin.adIsRunning(s) ? s !== RewardedAdsManager.REWARDED || e ? (this.plugin.setFinished(s), this.plugin._onCancel()) : this.plugin.rewardAndFinish() : this.removeAdOverlay(t)
                    }.bind(this)),
                        t = new RewardedAdOverlay(e);
                    this.rewardOverlay = t, cleverapps.scenes.getRunningScene().addChild(this.rewardOverlay)
                }.bind(this);
                cleverapps.meta.isFocused() ? t() : cleverapps.meta.display({
                    focus: "ShowReward",
                    action: function (e) {
                        t(), RewardedAdsManager.onceOnRemoveOverlay = e
                    }
                })
            }, RewardedAdsManager.prototype.adIsRunning = function () {
                if (!this.isEnabled()) return !1;
                var t = !1;
                return RewardedAdsManager.ACTIVE_ADS.forEach(function (e) {
                    this.plugin.adIsRunning(e) && (t = !0)
                }.bind(this)), t
            }, RewardedAdsManager.prototype.onReward = function () {
                cleverapps.paymentsHistory.isVIP() || (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ADS.FINISH + "_" + RewardedAdsManager.REWARDED), cleverapps.playSession.set(cleverapps.EVENTS.STATS.REWARDED_DAU, !0), cleverapps.playSession.inc(cleverapps.EVENTS.ADS.SESSION_FINISH + "_" + RewardedAdsManager.REWARDED), cleverapps.user.getDaysSinceRegistration() < 1 && (cleverapps.playSession.inc(cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_WATCHED_15_ADS), 15 <= cleverapps.playSession.get(cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_WATCHED_15_ADS) && (cleverapps.playSession.set(cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_WATCHED_15_ADS, -1e3), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_WATCHED_15_ADS)), cleverapps.playSession.inc(cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_ADS_COUNT)),
                    cleverapps.abTest.allLogEvent(cleverapps.EVENTS.ADS.FINISH)), this.baseWatchCounter++, this.baseWatchCounter % 5 == 0 && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TARGET_FOR_BUYING.BASE_WATCH_5), this.baseWatchCounter % 3 == 0 && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TARGET_FOR_BUYING.BASE_PLAY_WATCH), this.totalWatchCounter++, cleverapps.EVENTS.TARGET_FOR_BUYING["WATCHED_" + this.totalWatchCounter] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TARGET_FOR_BUYING["WATCHED_" + this.totalWatchCounter]), cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.AD_WATCH_COUNTER, this.totalWatchCounter), cleverapps.eventBus.trigger("taskEvent", DailyTasks.WATCH_ADS), cleverapps.thinkingData && cleverapps.thinkingData.logWatchAds();
                var e = cleverapps.paymentsHistory.isVIP() ? void 0 : this.plugin.getECPM(),
                    t = this.plugin.isFakeImpression();
                if (e && !t && (e /= 1e3, cleverapps.user.getDaysSinceRegistration() < 1 && cleverapps.playSession.inc(cleverapps.EVENTS.TARGET_FOR_BUYING.DAY_1_ADS_VALUE, e),
                    cleverapps.abTest.allLogEvent(cleverapps.EVENTS.ADS.COST, {
                        value: e
                    }), cleverapps.adjust && cleverapps.adjust.logAdRevenue(e, this.plugin.code), cleverapps.googleAnalytics && cleverapps.googleAnalytics.logAdRevenue(RewardedAdsManager.REWARDED, e)), !this.lastAdStarter && cleverapps.config.debugMode) throw "No ad starter placement defined!";
                t || cleverapps.eventLogger.logEvent(this.lastAdStarter, {
                    value: e || 0
                }), this.onFinish(!0)
            }, RewardedAdsManager.prototype.getLastAdStarter = function (e) {
                [AdsLimits.TYPES.ENERGY_SHORT, AdsLimits.TYPES.ENERGY_1_SHORT, AdsLimits.TYPES.ENERGY_2_SHORT].includes(e = e || "none") && (e = "lives_short"), [AdsLimits.TYPES.ENERGY, AdsLimits.TYPES.ENERGY_1, AdsLimits.TYPES.ENERGY_2].includes(e) && (e = AdsLimits.TYPES.LIVES);
                var t = cleverapps.travelBook.isExpedition() ? cleverapps.travelBook.getCurrentPage().id + "_" : "";
                return cleverapps.EVENTS.ADS.TYPE + t + e
            }, RewardedAdsManager.prototype.onFinish = function (e) {
                var t = this.onRewardListener || function () { },
                    s = this.onCancelListener || function () { };
                this.onRewardListener = void 0, this.onCancelListener = void 0, (e ? t : s)()
            }, RewardedAdsManager.prototype.playRewarded = function (e, t, s) {
                return t = t || function () { }, s = s || function () { }, this.adIsRunning() ? (s(), void cleverapps.notification.create("AdsRunning")) : (this.lastAdStarter = this.getLastAdStarter(e), cleverapps.paymentsHistory.isVIP() ? (this.onRewardListener = t, this.onCancelListener = s, void this.createVipRewarded()) : this.isAvailable(RewardedAdsManager.REWARDED) ? void cleverapps.whenGameActive(function () {
                    this.onRewardListener = t, this.onCancelListener = s, this.createAdOverlay(RewardedAdsManager.REWARDED), this.plugin.playAd(RewardedAdsManager.REWARDED), this.cacheNextAd(RewardedAdsManager.REWARDED)
                }.bind(this)) : (s(), void cleverapps.notification.create("NoAdsFound")))
            }, RewardedAdsManager.prototype.canShowInterstitial = function () {
                return !(!this.isEnabled() || -1 === RewardedAdsManager.ACTIVE_ADS.indexOf(RewardedAdsManager.INTERSTITIAL) || !this.isAvailable(RewardedAdsManager.INTERSTITIAL)) && (!![
                    cleverapps.PaymentsHistory.BRACKET_NONE
                ].includes(cleverapps.paymentsHistory.classify()) && !((this.lastPlay[RewardedAdsManager.INTERSTITIAL] || 0) + cleverapps.parseInterval(RewardedAdsManager.INTERSTITIAL_INTERVAL) > Date.now()))
            }, RewardedAdsManager.prototype.showInterstitial = function (e) {
                if (e = e || function () { }, this.adIsRunning()) return cleverapps.notification.create("AdsRunning"), void e();
                this.canShowInterstitial() ? cleverapps.whenGameActive(function () {
                    this.onCancelListener = e, this.onRewardListener = e, this.createAdOverlay(RewardedAdsManager.INTERSTITIAL), this.plugin.playAd(RewardedAdsManager.INTERSTITIAL), this.cacheNextAd(RewardedAdsManager.INTERSTITIAL)
                }.bind(this)) : e()
            }, RewardedAdsManager.prototype.showPreroll = function (e) {
                var t, s;
                e = cleverapps.once(e), this.prerollPlayed ? e() : (this.prerollPlayed = !0, s = cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.PREROLL_PLAYED) || 0,
                    cleverapps.config.editorMode || cleverapps.config.adminMode || cleverapps.config.wysiwygMode || cleverapps.loadedSnapshot || s + cleverapps.parseInterval(RewardedAdsManager.PREROLL_TIMEOUT) > Date.now() ? e() : (t = this.on("changeVideoState:" + RewardedAdsManager.INTERSTITIAL, function (e) {
                        e === AdsPlugin.VIDEO_STATE.PLAY && (cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.PREROLL_PLAYED, Date.now()), t.clear())
                    }), s = cleverapps.once(function () {
                        t.clear(), e()
                    }), cleverapps.rewardedAdsManager.loadAndPlay({
                        type: RewardedAdsManager.INTERSTITIAL,
                        callback: s,
                        onCancelCallback: s
                    })))
            }, RewardedAdsManager.prototype.getNoAdsTime = function (e) {
                return Date.now() - this.lastAvailable[e]
            }, RewardedAdsManager.prototype.showBanner = function (e) {
                cleverapps.platform.isConnected(Platform.ADS) ? this.plugin && this.plugin.showBanner && this.plugin.showBanner(e) : e(cleverapps.CODE_FAILED)
            }, RewardedAdsManager.prototype.hideBanner = function (e) {
                cleverapps.platform.isConnected(Platform.ADS) ? this.plugin && this.plugin.hideBanner && this.plugin.hideBanner(e) : e(cleverapps.CODE_FAILED)
            }, RewardedAdsManager.REWARDED = "rewarded", RewardedAdsManager.INTERSTITIAL = "interstitial", RewardedAdsManager.ACTIVE_ADS = [RewardedAdsManager.REWARDED], RewardedAdsManager.INTERSTITIAL_AVAILABLE = {
                level: 1.5
            }, RewardedAdsManager.INTERSTITIAL_INTERVAL = "15 minutes", RewardedAdsManager.PREROLL_TIMEOUT = "10 minutes", RewardedAdsManager.REWARDED_NOADS_TIMEOUT = "3 minutes", RewardedAdsManager.initialize = function () {
                cleverapps.platform.oneOf(TestPlatform) ? cleverapps.platform.getUserID() === TestSocial.USERS.beta.id ? RewardedAdsManager.ACTIVE_ADS = [RewardedAdsManager.REWARDED, RewardedAdsManager.INTERSTITIAL] : cleverapps.platform.getUserID() === TestSocial.USERS.gamma.id ? RewardedAdsManager.ACTIVE_ADS = [] : RewardedAdsManager.ACTIVE_ADS = [RewardedAdsManager.REWARDED] : ((cleverapps.platform.oneOf(VKPlatform, OKPlatform, GDCom, Yandex, Plinga, Crazy, MSStart) || cleverapps.platform.oneOf(Instant) && cleverapps.platform.info.isMobile && "merge" !== cleverapps.config.type) && (RewardedAdsManager.ACTIVE_ADS = [RewardedAdsManager.REWARDED, RewardedAdsManager.INTERSTITIAL]), cleverapps.platform.oneOf(GDCom) && (RewardedAdsManager.INTERSTITIAL_AVAILABLE = {
                    level: 0
                }))
            }, RewardedAdsManager.eCPM = {
                Instant: 2.06,
                WEB_OK: 50 / cleverapps.EXCHANGE_RATES.RUB,
                MOBILE_OK: 58 / cleverapps.EXCHANGE_RATES.RUB,
                GDCom: .85 / cleverapps.EXCHANGE_RATES.EUR,
                Plinga: .85 / cleverapps.EXCHANGE_RATES.EUR,
                VK: 75 / cleverapps.EXCHANGE_RATES.RUB,
                Yandex: 68 / cleverapps.EXCHANGE_RATES.RUB,
                YandexApp: 143 / cleverapps.EXCHANGE_RATES.RUB,
                GoogleWeb: 2.66 / cleverapps.EXCHANGE_RATES.SGD,
                MSStart: 2,
                Crazy: 2,
                Wechat: 50 / cleverapps.EXCHANGE_RATES.CNY
            }, cc.Scale9Sprite.extend({
                ctor: function (e) {
                    this._super(bundles.pixel.frames.pixel_png), this.setColor(cleverapps.styles.COLORS.BLACK), this.setOpacity(80), this.setLocalZOrder(TransitionAnimation.ZORDER + 1), this.timeLeft = cleverapps.parseInterval(RewardedAdOverlay.TIMEOUT);
                    var t = new cleverapps.CountDown(this.timeLeft, {
                        onTick: this.onTick.bind(this),
                        onFinish: function () {
                            this.isAutoCloseAvailable() && e()
                        }.bind(this),
                        ignorePaused: !0
                    });
                    addCleaner(this, function () {
                        t.remove()
                    }), cleverapps.UI.onClick(this, function () {
                        this.isCloseAvailable() && e({
                            cancel: cleverapps.platform.oneOf(Yandex, GDCom, FacebookCanvas, TestPlatform)
                        })
                    }.bind(this), {
                        ignoreScale: !0,
                        swallowEvents: !0
                    }), this.addLoadText(), this.addAutoCloseText(), this.addCloseText(), this.updatePosition()
                },
                updatePosition: function () {
                    var e = cleverapps.UI.getBgSize();
                    this.setContentSize2(e.width + 4, e.height + 4), this.setPositionRound(e.width / 2, e.height / 2 - cleverapps.UI.getBgOffset()), this.setAnchorPoint2(), this.autoCloseText && this.autoCloseText.setPositionRound(cleverapps.styles.RewardedAdOverlay.autoClose), this.loadText && this.loadText.setPositionRound(cleverapps.styles.RewardedAdOverlay.text), this.closeText && (this.closeText.setDimensions(e.width, 0), this.closeText.fitTo(e.width), this.closeText.setPositionRound(cleverapps.styles.RewardedAdOverlay.text))
                },
                onTick: function (e) {
                    this.timeLeft = e, this.isAutoCloseAvailable() && this.autoCloseText && (this.autoCloseText.visible || this.showAutoCloseText(), this.autoCloseText.setString("RewardAutoClose", {
                        timeout: Math.ceil(e / 1e3)
                    })), this.loadText && this.isCloseAvailable() && (this.loadText.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.CallFunc(this.showCloseText.bind(this)), new cc.RemoveSelf)), this.loadText = void 0)
                },
                addAutoCloseText: function () {
                    var e = cleverapps.UI.generateOnlyText("", cleverapps.styles.FONTS.REWARDED_AD_OVERLAY_AUTO_CLOSE_TEXT);
                    e.setPositionRound(cleverapps.styles.RewardedAdOverlay.autoClose), e.visible = !1, this.autoCloseText = e, this.addChild(e)
                },
                showAutoCloseText: function () {
                    var e = this.autoCloseText;
                    e && !e.visible && (e.visible = !0, e.setOpacity(0), e.runAction(new cc.Sequence(new cc.DelayTime(1), new cc.FadeIn(.3))))
                },
                addLoadText: function () {
                    var e = this.loadText = cleverapps.UI.generateOnlyText("Loading", cleverapps.styles.FONTS.REWARDED_AD_OVERLAY_TEXT);
                    e.setPositionRound(cleverapps.styles.RewardedAdOverlay.text),
                        this.addChild(e), e.setOpacity(0), e.runAction(new cc.FadeIn(.3))
                },
                addCloseText: function () {
                    var e = this.closeText = cleverapps.UI.generateOnlyText("Window.ClickToClose", cleverapps.styles.FONTS.REWARDED_AD_OVERLAY_TEXT);
                    e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setDimensions(cleverapps.UI.getSceneSize().width, 0), e.fitTo(cleverapps.UI.getSceneSize().width), e.setPositionRound(cleverapps.styles.RewardedAdOverlay.text), e.visible = !1, this.addChild(e)
                },
                showCloseText: function () {
                    var e = this.closeText;
                    e && !e.visible && (e.visible = !0, e.setOpacity(0), e.runAction(new cc.FadeIn(.3)))
                },
                isCloseAvailable: function () {
                    return this.timeLeft <= cleverapps.parseInterval(RewardedAdOverlay.CLOSE_AVAILABLE)
                },
                isAutoCloseAvailable: function () {
                    return !cleverapps.platform.oneOf(Instant, GDCom, Yandex) && this.isCloseAvailable()
                }
            })),
        VIPRewardedWindow = (RewardedAdOverlay.initialize = function () {
            var e = "60 seconds";
            cleverapps.platform.oneOf(GDCom) && (e = "50 seconds"), RewardedAdOverlay.TIMEOUT = "65 seconds",
                RewardedAdOverlay.CLOSE_AVAILABLE = e
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            REWARDED_AD_OVERLAY_AUTO_CLOSE_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            REWARDED_AD_OVERLAY_TEXT: {
                size: 60,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.RewardedAdOverlay = {
            text: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            autoClose: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -100
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e, t) {
                this.onReward = e, this.onCancel = t, this.isVertical = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL;
                e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.VIP_LEVEL) || {
                    l: 0,
                    t: 0
                };
                this.level = Math.max(e.l - Math.floor(Math.max(Date.now() - e.t, 0) / VIPRewardedWindow.LEVEL_INTERVAL), 0), this._super({
                    name: "VIPRewardedWindow",
                    title: "VIPRewardedWindow.title",
                    content: this.createContent(),
                    noBackground: !0
                }), cleverapps.meta.showControlsWhileFocused("MenuBarGoldItem")
            },
            getPerson: function () {
                return {
                    role: PersonsLibrary.hasRole("king") ? "king" : "hero",
                    emotion: "happy"
                }
            },
            skip: function (e) {
                cleverapps.user.spendHard(cleverapps.EVENTS.SPENT.SKIP_VIP, e) && (this.onReward && this.onReward(), this.incLevel(), this.onReward = void 0, this.onCancel = void 0, this.close())
            },
            incLevel: function () {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.VIP_LEVEL, {
                    l: this.level + 1,
                    t: Date.now()
                })
            },
            createContent: function () {
                var e = cleverapps.styles.VIPRewardedWindow,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2(e.animation), new cleverapps.Spine(bundles.vip_window.jsons.vip_icon_json)),
                    s = (s.setAnimation(0, "animation", !0), t.addChild(s), s.setPositionRound(t.width / 2, t.height / 2), cleverapps.UI.generateOnlyText("VIPRewardedWindow.description", cleverapps.styles.FONTS.VIPREWARDEDWINDOW_DESCRIPTION_TEXT)),
                    i = (s.setDimensions(this.isVertical ? e.description.verticalWidth : e.description.width, 0), s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.createProgress()),
                    n = new cleverapps.UI.Button({
                        width: e.button.width,
                        height: e.button.height,
                        text: "Cancel",
                        onClicked: this.close.bind(this),
                        type: cleverapps.styles.UI.Button.Images.button_red
                    }),
                    o = this.calcPrice(),
                    a = new cleverapps.UI.Button({
                        width: e.button.width,
                        height: e.button.height,
                        text: "Skip$$" + o,
                        onClicked: this.skip.bind(this, o),
                        type: cleverapps.styles.UI.Button.Images.button_green
                    }),
                    o = (cleverapps.user.canTakeHard(o) || a.disable(), new cleverapps.Layout([a, n], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: e.button.margin
                    })),
                    a = cleverapps.paymentsHistory.getVIPStatus().end,
                    n = Math.ceil((a - Date.now()) / cleverapps.parseInterval("1 day")),
                    a = (30 < n && (n = 30), cleverapps.UI.generateOnlyText("VIPRewardedWindow.note", cleverapps.styles.FONTS.VIPREWARDEDWINDOW_NOTE_TEXT, {
                        price: cleverapps.paymentsHistory.calculateMinimalVipSum(),
                        remaining: n
                    })),
                    n = (a.setOpacity(200), a.setDimensions(this.isVertical ? e.note.verticalWidth : e.note.width, 0), a.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), new cleverapps.Layout([t, s, i, o, a], {
                        direction: cleverapps.UI.VERTICAL,
                        padding: e.padding,
                        margin: this.isVertical ? e.verticalMargin : e.margin
                    }));
                return n.y += 200, n
            },
            onClose: function () {
                this.onCancel && this.onCancel(), this.onReward = void 0, this.onCancel = void 0
            },
            calcDuration: function () {
                return VIPRewardedWindow.BASE_DURATION + VIPRewardedWindow.LEVEL_DURATION * this.level
            },
            calcPrice: function () {
                return Math.round(this.calcDuration() / cleverapps.parseInterval("1 second") * ("merge" === cleverapps.config.type ? VIPRewardedWindow.SKIP_SECOND_PRICE : VIPRewardedWindow.SKIP_WHEN_NO_SOFT_SECOND_PRICE))
            },
            createProgress: function () {
                var e = cleverapps.styles.VIPRewardedWindow.progress,
                    t = new ScaledProgressBar({
                        background: bundles.progress_bar.frames.bg_vip,
                        progress: bundles.progress_bar.frames.bar_vip
                    }),
                    s = (t.setLength(e.width), t.setPercentage(10), this.calcDuration()),
                    s = (t.runAction(new ScaledProgressBarProgressTo(s / 1e3, 100)), new cleverapps.CountDown(s, {
                        onFinish: function () {
                            this.onReward && this.onReward(), this.incLevel(), cleverapps.playSession.inc(cleverapps.EVENTS.STATS.VIP_REWARDED_WATCHED),
                                this.onReward = void 0, this.onCancel = void 0, this.close()
                        }.bind(this)
                    })),
                    s = new cleverapps.CountDownView(s, {
                        font: cleverapps.styles.FONTS.VIPREWARDEDWINDOW_TIMER_TEXT
                    });
                return s.setPositionRound(e.timer), t.addChild(s), t
            },
            listBundles: function () {
                return ["vip_window"]
            }
        })),
        FlyingAd = (VIPRewardedWindow.BASE_DURATION = cleverapps.parseInterval("12 seconds"), VIPRewardedWindow.LEVEL_DURATION = cleverapps.parseInterval("2 seconds"), VIPRewardedWindow.SKIP_SECOND_PRICE = 1 / 7, VIPRewardedWindow.SKIP_WHEN_NO_SOFT_SECOND_PRICE = 1.25, VIPRewardedWindow.LEVEL_INTERVAL = cleverapps.parseInterval("300 seconds"), cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            VIPREWARDEDWINDOW_DESCRIPTION_TEXT: {
                size: 42
            },
            VIPREWARDEDWINDOW_TIMER_TEXT: {
                size: 60
            },
            VIPREWARDEDWINDOW_NOTE_TEXT: {
                size: 22
            }
        }), cleverapps.styles.VIPRewardedWindow = {
            margin: 40,
            verticalMargin: 80,
            padding: {
                top: 60
            },
            animation: {
                width: 300,
                height: 300
            },
            description: {
                width: 1e3,
                verticalWidth: 800
            },
            progress: {
                width: 600,
                timer: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 2
                    }
                }
            },
            button: {
                width: 300,
                height: 100,
                margin: 80
            },
            note: {
                width: 1e3,
                verticalWidth: 800
            }
        }, function () {
            cleverapps.EventEmitter.call(this), this.nextTime = 0, cleverapps.meta.registerControl("flyingAd", function (e) {
                this.enabled && this.trigger("toggle", e)
            }.bind(this))
        }),
        FlyingAdView = (FlyingAd.prototype = Object.create(cleverapps.EventEmitter.prototype), (FlyingAd.prototype.constructor = FlyingAd).prototype.setGame = function (e) {
            e.userStatus.on("inactive_very_short", this.update.bind(this))
        }, FlyingAd.prototype.reset = function () {
            this.disable(), this.purge(), this.type = void 0, cleverapps.environment.isGameScene() && "board" === cleverapps.config.type && this.setDelay(cleverapps.parseInterval(FlyingAd.GAMESCENE_DELAY))
        }, FlyingAd.prototype.getSkin = function () {
            return FlyingAd.DATA[this.type].skin
        }, FlyingAd.prototype.needUpdate = function () {
            return !this.enabled && this.isReady()
        }, FlyingAd.prototype.setDelay = function (e) {
            this.nextTime = Date.now() + e
        }, FlyingAd.prototype.isReady = function () {
            return Date.now() >= this.nextTime
        },
            FlyingAd.prototype.update = function () {
                var e;
                this.enabled || this.isReady() && (void 0 !== (e = this.selectType()) ? (this.setType(e), this.enable()) : this.disable())
            }, FlyingAd.prototype.isClickAvailable = function () {
                return !!this.enabled && (!Game.currentGame || !Game.currentGame.counter.isActive())
            }, FlyingAd.prototype.onClick = function () {
                this.isClickAvailable() && this.playAds()
            }, FlyingAd.prototype.selectType = function () {
                if (cleverapps.config.debugMode && void 0 !== FlyingAd.DEBUG_TYPE) return e = FlyingAd.DEBUG_TYPE, delete FlyingAd.DEBUG_TYPE, e;
                var e = cleverapps.values(FlyingAd.TYPES).filter(function (e) {
                    return FlyingAd.DATA[e] && cleverapps.adsLimits.state(FlyingAd.DATA[e].limit) === AdsLimits.STATE_READY && FlyingAd.DATA[e].filter()
                });
                return cleverapps.Random.mathChoose(e)
            }, FlyingAd.prototype.setType = function (e) {
                this.type !== e && (this.type = e, this.trigger("changeType"))
            }, FlyingAd.prototype.playAds = function () {
                var e = FlyingAd.DATA[this.type];
                cleverapps.rewardedAdsManager.loadAndPlay({
                    type: RewardedAdsManager.REWARDED,
                    adLimit: e.limit,
                    callback: function () {
                        cleverapps.adsLimits.watch(e.limit), this.reward()
                    }.bind(this)
                }), this.clearTimeout(), this.setDelay(cleverapps.parseInterval(FlyingAd.COOLDOWN)), this.enabled = !1, this.trigger("disappear")
            }, FlyingAd.prototype.enable = function () {
                this.enabled || cleverapps.meta.isFocused() || (this.enabled = !0, cleverapps.environment.isGameScene() && (this.timeout = cleverapps.timeouts.setTimeout(function () {
                    this.setDelay(cleverapps.parseInterval(FlyingAd.DIDNT_CLICK_COOLDOWN)), this.clearTimeout(), this.enabled = !1, this.trigger("disappear")
                }.bind(this), cleverapps.parseInterval(FlyingAd.DURATION))), this.trigger("enable"))
            }, FlyingAd.prototype.disable = function () {
                this.enabled && (this.clearTimeout(), this.enabled = !1, this.trigger("disable"))
            }, FlyingAd.prototype.clearTimeout = function () {
                this.timeout && (clearTimeout(this.timeout), delete this.timeout)
            }, FlyingAd.prototype.giveHint = function () {
                var e = {};
                e[cleverapps.Boosters.TYPE_HINT] = 1, this.rewardProcess({
                    boosters: e
                }, function () {
                    cleverapps.timeouts.setTimeout(function () {
                        var e;
                        cleverapps.boosters.take(cleverapps.Boosters.TYPE_HINT), !Game.currentGame || Game.currentGame.outcome !== GameBase.OUTCOME_UNKNOWN || (e = Game.currentGame.hintBooster.findHint()) && Game.currentGame.hintBooster.addHint(e)
                    }, 300)
                })
            }, FlyingAd.prototype.giveCombo = function () {
                var e = {};
                e[cleverapps.Boosters.TYPE_COMBO] = 1, this.rewardProcess({
                    boosters: e
                }, function () {
                    cleverapps.boosters.take(cleverapps.Boosters.TYPE_COMBO), Game.currentGame && Game.currentGame.field.addRandomCombo(1)
                }, "field")
            }, FlyingAd.prototype.giveDiscover = function () {
                var e = {};
                e[cleverapps.Boosters.TYPE_DISCOVER] = 1, this.rewardProcess({
                    boosters: e
                }, function () {
                    cleverapps.timeouts.setTimeout(function () {
                        cleverapps.boosters.take(cleverapps.Boosters.TYPE_DISCOVER), Game.currentGame && Game.currentGame.boosterDiscover()
                    }, 300)
                })
            }, FlyingAd.prototype.giveCards = function () {
                this.rewardProcess({
                    cards: 2
                })
            }, FlyingAd.prototype.giveStar = function () {
                this.rewardProcess({
                    simpleStar: 1
                })
            },
            FlyingAd.prototype.giveMoves = function () {
                var e = {};
                e[cleverapps.Boosters.TYPE_MOVES] = 1, this.rewardProcess({
                    boosters: e
                }, function () {
                    cleverapps.boosters.take(cleverapps.Boosters.TYPE_MOVES), Game.currentGame && Game.currentGame.setMoves(Game.currentGame.moves + 3, {
                        delay: 0
                    })
                }, "moves")
            }, FlyingAd.prototype.giveSoftHardReward = function () {
                var e = {};
                e[cleverapps.config.soft ? "soft" : "hard"] = 10, this.rewardProcess(e)
            }, FlyingAd.prototype.rewardProcess = function (t, s, i) {
                cleverapps.meta.displayWhenFreeFocus({
                    focus: "FlyingAdReward",
                    action: function (e) {
                        new RewardWindow(t, {
                            event: cleverapps.EVENTS.EARN.FLYING,
                            target: i,
                            onFinish: s
                        }), cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }, FlyingAd.prototype.reward = function () {
                this.type === FlyingAd.TYPES.TYPE_STAR ? this.giveStar() : this.type === FlyingAd.TYPES.TYPE_HINT ? this.giveHint() : this.type === FlyingAd.TYPES.TYPE_COMBO ? this.giveCombo() : this.type === FlyingAd.TYPES.TYPE_DISCOVER ? this.giveDiscover() : this.type === FlyingAd.TYPES.TYPE_CARDS ? this.giveCards() : this.type === FlyingAd.TYPES.TYPE_MOVES ? this.giveMoves() : this.type === FlyingAd.TYPES.TYPE_HARD_SOFT ? this.giveSoftHardReward() : void 0 === this.type && cleverapps.throwAsync("flyingad reward is undefined")
            }, FlyingAd.IsAvailable = function () {
                return -1 === ["merge"].indexOf(cleverapps.config.type) && !cleverapps.config.wysiwygMode
            }, FlyingAd.COOLDOWN = "15 seconds", FlyingAd.GAMESCENE_DELAY = "1 minute", FlyingAd.DURATION = "45 seconds", FlyingAd.DIDNT_CLICK_COOLDOWN = "1 minutes", cleverapps.config.debugMode && (FlyingAd.DIDNT_CLICK_COOLDOWN = "30 seconds"), FlyingAd.TYPES = {
                TYPE_HINT: 0,
                TYPE_STAR: 1,
                TYPE_COMBO: 3,
                TYPE_DISCOVER: 4,
                TYPE_CARDS: 5,
                TYPE_HARD_SOFT: 7,
                TYPE_MOVES: 8
            }, FlyingAd.DATA = {}, FlyingAd.DATA[FlyingAd.TYPES.TYPE_HINT] = {
                limit: AdsLimits.TYPES.FLYING_HINT,
                skin: "hint",
                filter: function () {
                    return cleverapps.environment.isGameScene()
                }
            }, FlyingAd.DATA[FlyingAd.TYPES.TYPE_STAR] = {
                limit: AdsLimits.TYPES.FLYING_STAR,
                skin: "star",
                filter: function () {
                    return cleverapps.environment.isMainScene()
                }
            },
            FlyingAd.DATA[FlyingAd.TYPES.TYPE_COMBO] = {
                limit: AdsLimits.TYPES.FLYING_BOOSTER,
                skin: "heroes",
                filter: function () {
                    var e = Game.currentGame;
                    return cleverapps.environment.isGameScene() && e && 3 <= e.beginMoves - e.moves
                }
            }, FlyingAd.DATA[FlyingAd.TYPES.TYPE_DISCOVER] = {
                limit: AdsLimits.TYPES.FLYING_DISCOVER,
                skin: "hint",
                filter: function () {
                    var e = Game.currentGame;
                    return !!(cleverapps.environment.isGameScene() && e && e.discoverBooster) && (!!e.inflamer.hasMistakes() || (1 <= e.level.episodeNo || 3 <= e.level.levelNo))
                }
            }, FlyingAd.DATA[FlyingAd.TYPES.TYPE_CARDS] = {
                limit: AdsLimits.TYPES.FLYING_MOVES,
                skin: "cards",
                filter: function () {
                    return cleverapps.environment.isGameScene() && "solitaire" === cleverapps.config.type
                }
            }, FlyingAd.DATA[FlyingAd.TYPES.TYPE_MOVES] = {
                limit: AdsLimits.TYPES.FLYING_MOVES,
                skin: "moves",
                filter: function () {
                    var e = Game.currentGame;
                    return cleverapps.environment.isGameScene() && "match3" === cleverapps.config.type && e && 3 <= e.beginMoves - e.moves
                }
            }, FlyingAd.DATA[FlyingAd.TYPES.TYPE_HARD_SOFT] = {
                limit: AdsLimits.TYPES.FLYING_HARD_SOFT,
                skin: "coin",
                filter: function () {
                    return cleverapps.environment.isMainScene()
                }
            }, cc.Node.extend({
                ctor: function () {
                    this._super(), this.setAnchorPoint2();
                    var e = cleverapps.styles.FlyingAdView;
                    this.setContentSize2(e), this.createAnimation(), cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && (this.setScale(e.mobile.scale), this.baseScale = this.scale), cleverapps.UI.applyHover(this, {
                        filter: this.isClickAvailable.bind(this),
                        onMouseOver: function () {
                            this.animation.setSkin(cleverapps.flyingAd.getSkin() + "_hover")
                        }.bind(this),
                        onMouseOut: function () {
                            this.animation.setSkin(cleverapps.flyingAd.getSkin() + "_normal")
                        }.bind(this)
                    }), cleverapps.UI.onClick(this, cleverapps.flyingAd.onClick.bind(cleverapps.flyingAd), {
                        filter: this.isClickAvailable.bind(this)
                    }), this.setLocalZOrder(10), cleverapps.flyingAd.enabled ? this.enable() : this.disable(), cleverapps.flyingAd.on("disable", this.createListener(this.disable.bind(this))), cleverapps.flyingAd.on("enable", this.createListener(
                        this.enable.bind(this))), cleverapps.flyingAd.on("disappear", this.createListener(this.disappear.bind(this))), cleverapps.flyingAd.on("toggle", this.createListener(this.toggle.bind(this))), cleverapps.flyingAd.on("changeType", this.createListener(this.changeType.bind(this)))
                },
                isClickAvailable: function () {
                    return this.isVisible() && cleverapps.flyingAd.isClickAvailable()
                },
                updatePosition: function () {
                    var e;
                    cleverapps.flyingAd.enabled && (e = this.getPosition(), this.stopAllActions(), this.runMoveAnimation(e))
                },
                createAnimation: function () {
                    var e = cleverapps.styles.FlyingAdView;
                    this.animation = new cleverapps.Spine(bundles.flying_ad.jsons.flying_ad_json), this.addChild(this.animation), this.animation.setPositionRound(e.animation)
                },
                changeType: function () {
                    this.animation.setSkin(cleverapps.flyingAd.getSkin() + "_normal")
                },
                toggle: function (e) {
                    this.isVisible() !== e && (this.setVisible(e), e ? this.animation.runAction(new cc.RepeatForever(new cc.Sequence(new cc.PlaySound(bundles.flying_ad.urls.fly_effect), new cc.DelayTime(3.8)))) : this.animation.stopAllActions())
                },
                disappear: function () {
                    this.stopAllActions(), this.animation.setAnimation(0, "application", !1), this.animation.setCompleteListener(function () {
                        this.animation.setCompleteListener(), this.toggle(!1)
                    }.bind(this))
                },
                runMoveAnimation: function (e) {
                    var t = cleverapps.scenes.getRunningScene();
                    (e = e || {
                        x: t.width / 2,
                        y: t.height / 2 + cleverapps.styles.FlyingAdView.yOffset
                    }).x > t.width - cleverapps.styles.FlyingAdView.xBorderOffset && (e.x = t.width - cleverapps.styles.FlyingAdView.xBorderOffset), this.setPositionRound(e), this._runMoveAnimation(1)
                },
                _runMoveAnimation: function (p) {
                    var e = cleverapps.scenes.getRunningScene(),
                        t = cleverapps.styles.FlyingAdView,
                        s = cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition() && cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL,
                        i = (cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? t.mobile : t).xBorderOffset,
                        n = t.yOffsetBottom,
                        t = t.yOffsetTop,
                        t = 0 < p ? s ? cc.p(e.width / 2, e.height - t) : cc.p(e.width - i, this.y) : s ? cc.p(e.width / 2, n) : cc.p(i,
                            this.y),
                        e = cleverapps.styles.FlyingAdView.speed,
                        n = cc.pDistance(this.getPosition(), t) / e,
                        o = Math.round(n / 7),
                        i = new cc.MoveBy(n, cc.p(t.x - this.x, t.y - this.y)),
                        a = 0,
                        r = 0;
                    if (s ? a = cleverapps.styles.FlyingAdView.animation.dx : r = cleverapps.styles.FlyingAdView.animation.dy, 0 < o) {
                        for (var c = [], l = n / o / 2, d = 0; d < o; d++) c.push(new cc.MoveBy(l / 2, cc.p(a / 2, r / 2))), c.push(new cc.MoveBy(l, cc.p(-a, -r))), c.push(new cc.MoveBy(l / 2, cc.p(a / 2, r / 2)));
                        i = new cc.Spawn(i, new cc.Sequence(c))
                    }
                    this.runAction(new cc.Sequence(i, new cc.CallFunc(function () {
                        this._runMoveAnimation(-p)
                    }.bind(this))))
                },
                enable: function () {
                    this.stopAllActions(), this.animation.setCompleteListener(), this.toggle(!cleverapps.meta.isFocused()), this.animation.setAnimationAndIdleAfter("appearance", "idle"), this.runMoveAnimation(), cleverapps.audio.playSound(bundles.flying_ad.urls.show_up_effect)
                },
                disable: function () {
                    this.stopAllActions(), this.toggle(!1)
                }
            })),
        AdsPlugin = (cleverapps.styles.FlyingAdView = {
            width: 200,
            height: 200,
            mobile: {
                xBorderOffset: 160,
                scale: .8
            },
            animation: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -30
                },
                dy: 60,
                dx: 200
            },
            yOffset: 375,
            xBorderOffset: 300,
            yOffsetBottom: 500,
            yOffsetTop: 150,
            speed: 80
        }, function (e) {
            Connectable.call(this), this.cached = {}, this.cachedTime = {}, this.cachedErrorTime = {}, this.cantLoadAndPlayInParallel = e && e.cantLoadAndPlayInParallel, this.loaderState = {}, this.videoState = {}, this.finishTime = {}, this.onChangeLoaderState = function () { }, this.onChangeVideoState = function () { }
        }),
        MultiAdsPlugin = (AdsPlugin.prototype = Object.create(Connectable.prototype), (AdsPlugin.prototype.constructor = AdsPlugin).prototype.setWaitLoading = function (e) {
            this.loaderState[e] = AdsPlugin.LOADER_STATE.WAIT, this.onChangeLoaderState(e)
        }, AdsPlugin.prototype.setSuccessLoading = function (e) {
            this.loaderState[e] = AdsPlugin.LOADER_STATE.READY, this.onChangeLoaderState(e)
        }, AdsPlugin.prototype.setLoading = function (e) {
            this.loaderState[e] = AdsPlugin.LOADER_STATE.LOADING, this.onChangeLoaderState(e)
        }, AdsPlugin.prototype.setPlaying = function (e, t) {
            this.videoState[e] = AdsPlugin.VIDEO_STATE.PLAY,
                t || this.onChangeVideoState(e)
        }, AdsPlugin.prototype.whichIsPlaying = function () {
            for (var e = 0; e < RewardedAdsManager.ACTIVE_ADS.length; e++) {
                var t = RewardedAdsManager.ACTIVE_ADS[e];
                if (this.videoState[t] === AdsPlugin.VIDEO_STATE.PLAY) return t
            }
        }, AdsPlugin.prototype.rewardAndFinish = function (e) {
            this.setFinished(RewardedAdsManager.REWARDED, e), cleverapps.rewardedAdsManager.onReward()
        }, AdsPlugin.prototype.setFinished = function (e, t) {
            this.videoState[e] !== AdsPlugin.VIDEO_STATE.STOP && (this.videoState[e] = AdsPlugin.VIDEO_STATE.STOP, this.finishTime[e] = Date.now(), t || this.onChangeVideoState(e))
        }, AdsPlugin.LOADER_STATE = {
            WAIT: 0,
            LOADING: 1,
            READY: 2
        }, AdsPlugin.VIDEO_STATE = {
            STOP: 0,
            PLAY: 1
        }, AdsPlugin.EXPIRATION_TIME = cleverapps.parseInterval("55 minutes"), AdsPlugin.LOAD_AFTER_PLAY_TIME = cleverapps.parseInterval("15 seconds"), AdsPlugin.LOAD_AFTER_ERROR_TIME = cleverapps.parseInterval("2 minutes"), AdsPlugin.prototype._connect = function (e) {
            setTimeout(function () {
                e(Platform.STATUS_CONNECTED)
            }, 2e3)
        },
            AdsPlugin.prototype.expired = function (e) {
                return void 0 !== this.cachedTime[e] && this.cachedTime[e] < Date.now() - AdsPlugin.EXPIRATION_TIME
            }, AdsPlugin.prototype.isAvailable = function (e) {
                return cleverapps.platform.isConnected(Platform.ADS) && this.cached[e]
            }, AdsPlugin.prototype._cache = function (e, t) {
                t(AdsPlugin.CODE_SUCCEED, !0)
            }, AdsPlugin.prototype.adIsRunning = function (e) {
                return this.videoState[e] === AdsPlugin.VIDEO_STATE.PLAY
            }, AdsPlugin.prototype.askPermission = function (e) {
                e()
            }, AdsPlugin.CODE_SUCCEED = 0, AdsPlugin.CODE_FAILED = 1, AdsPlugin.CODE_REWARD = 2, AdsPlugin.prototype.canCache = function (e) {
                var t = this.finishTime[e] || 0,
                    s = this.cachedErrorTime[e] || 0;
                return (!this.cantLoadAndPlayInParallel || !(this.adIsRunning(e) || t + AdsPlugin.LOAD_AFTER_PLAY_TIME > Date.now())) && (!(s + AdsPlugin.LOAD_AFTER_ERROR_TIME > Date.now()) && (cleverapps.platform.isConnected(Platform.ADS) && -1 === [AdsPlugin.LOADER_STATE.LOADING, AdsPlugin.LOADER_STATE.READY].indexOf(this.loaderState[e])))
            }, AdsPlugin.prototype.cache = function (s) {
                this.canCache(s) && (this.setLoading(s), this._cache(s, function (e, t) {
                    e === AdsPlugin.CODE_SUCCEED ? (this.cached[s] = t, this.cachedTime[s] = Date.now(), this.setSuccessLoading(s)) : (this.cachedErrorTime[s] = Date.now(), this.setWaitLoading(s))
                }.bind(this)))
            }, AdsPlugin.prototype._playAd = function (e, t, s) {
                s(AdsPlugin.CODE_REWARD)
            }, AdsPlugin.prototype.reset = function (e) {
                this.cached[e] = void 0, this.cachedTime[e] = void 0, this.cachedErrorTime[e] = void 0, this.setWaitLoading(e)
            }, AdsPlugin.prototype.playAd = function (t) {
                cleverapps.platform.isConnected(Platform.ADS) && this.cached[t] && !this.adIsRunning(t) ? (this.setPlaying(t), this._playAd(t, this.cached[t], cleverapps.once(function (e) {
                    this.setFinished(t), e === AdsPlugin.CODE_REWARD ? cleverapps.rewardedAdsManager.onReward() : this._onCancel()
                }.bind(this))), this.reset(t)) : this._onCancel()
            }, AdsPlugin.prototype.getECPM = function () { }, AdsPlugin.prototype.isFakeImpression = function () { },
            function () {
                this.plugins = {
                    ads_msstart: new MSStartAds,
                    ads_google: new GoogleWebAds
                }, AdsPlugin.call(this, {
                    cantLoadAndPlayInParallel: !0
                }), Object.keys(this.plugins).forEach(function (t) {
                    var e = this.plugins[t];
                    cleverapps.platform.registerPlugin(t, function () {
                        return e
                    }), e._onCancel = function () {
                        this._onCancel()
                    }.bind(this), e.onChangeLoaderState = function (e) {
                        this.onPluginChangeLoaderState(t, e)
                    }.bind(this), e.onChangeVideoState = function (e) {
                        this.onPluginChangeVideoState(t, e)
                    }.bind(this)
                }, this), this._cacheCallbacks = {}, this._playCallbacks = {}
            }),
        VideoAds = (MultiAdsPlugin.prototype = Object.create(AdsPlugin.prototype), (MultiAdsPlugin.prototype.constructor = MultiAdsPlugin).prototype._connect = function (t) {
            for (var e in this.plugins) {
                if (cleverapps.platform.isConnected(e)) return void t(Platform.STATUS_CONNECTED);
                cleverapps.platform.once("changeStatus:" + e, function (e) {
                    e === Platform.STATUS_CONNECTED && t(Platform.STATUS_CONNECTED)
                })
            }
        }, MultiAdsPlugin.prototype.onPluginChangeLoaderState = function (e, t) {
            this.plugins[e].loaderState[t] === AdsPlugin.LOADER_STATE.READY && this._cacheCallbacks[t]()
        },
            MultiAdsPlugin.prototype._cache = function (e, t) {
                for (var s in this._cacheCallbacks[e] = cleverapps.once(function () {
                    console.log("Ads cached - " + e), t(AdsPlugin.CODE_SUCCEED, !0)
                }), this.plugins) {
                    var i = this.plugins[s];
                    cleverapps.platform.isConnected(s) && (i.isAvailable(e) && i.expired(e) && i.reset(e), i.isAvailable() ? this._cacheCallbacks[e](s) : i.cache(e))
                }
            }, MultiAdsPlugin.prototype.onPluginChangeVideoState = function (e, t) {
                this.plugins[e].videoState[t] === AdsPlugin.VIDEO_STATE.STOP && this._playCallbacks[t]()
            }, MultiAdsPlugin.prototype.getPlayReadyPlugin = function (e) {
                for (var t in this.plugins) {
                    var s = this.plugins[t];
                    if (cleverapps.platform.isConnected(t) && s.isAvailable(e)) return s
                }
            }, MultiAdsPlugin.prototype.playAd = function (e) {
                this._playPlugin = this.getPlayReadyPlugin(e), cleverapps.platform.isConnected(Platform.ADS) && !this.adIsRunning(e) && this._playPlugin ? (console.log("Ads play - " + this._playPlugin.code), this.setPlaying(e), this._playCallbacks[e] = cleverapps.once(this.setFinished.bind(this, e)),
                    this._playPlugin.playAd(e), this.reset(e)) : this._onCancel()
            }, MultiAdsPlugin.prototype.getECPM = function () {
                return this._playPlugin ? this._playPlugin.getECPM() : 0
            }, MultiAdsPlugin.isAppropriate = function () {
                return MSStartAds.isAppropriate() && cleverapps.config.adsense.client && cleverapps.config.debugMode
            },
            function () {
                AdsPlugin.call(this, {
                    cantLoadAndPlayInParallel: !0
                })
            }),
        OKAds = (VideoAds.prototype = Object.create(AdsPlugin.prototype), (VideoAds.prototype.constructor = VideoAds).isAppropriate = function () {
            return cleverapps.platform instanceof TestPlatform
        }, VideoAds.prototype._connect = function (e) {
            setTimeout(function () {
                cleverapps.rewardedAdsManager.isEnabled() ? e(Platform.STATUS_CONNECTED) : e(Platform.STATUS_DISABLED)
            }, cleverapps.silentIntro ? 0 : 2e3)
        }, VideoAds.prototype._cache = function (e, t) {
            setTimeout(function () {
                t(AdsPlugin.CODE_SUCCEED, !0)
            }, 5e3)
        }, VideoAds.prototype._playAd = function (e, t, s) {
            var i = new cc.Scale9Sprite(bundles.pixel.frames.pixel_png),
                n = (i.setAnchorPoint(0, 0), i.setContentSize2(cleverapps.UI.getBgSize()), i.setColor(new cc.Color(200, 200, 255, 255)), i.setLocalZOrder(TransitionAnimation.ZORDER + 1), cleverapps.scenes.getRunningScene()),
                o = (i.setPositionRound(0, -n.y), cleverapps.meta.eventNodes),
                a = (cleverapps.meta.setEventNodes([i]), n.addChild(i), setTimeout(function () {
                    r(e === RewardedAdsManager.REWARDED)
                }, 3e3)),
                r = cleverapps.once(function (e) {
                    cleverapps.meta.setEventNodes(o), e ? s(AdsPlugin.CODE_REWARD) : s(), clearTimeout(a), i.removeFromParent(!0)
                }),
                n = {
                    width: 300 * resolutionScale,
                    height: 100 * resolutionScale,
                    onClicked: function () {
                        r()
                    },
                    text: "SkipButton"
                },
                c = new cleverapps.UI.Button(n);
            c.setPositionRound(i.width / 2, 200), c.disable(), c.runAction(new cc.Sequence(new cc.DelayTime(1), new cc.CallFunc(function () {
                c.enable()
            }))), i.addChild(c)
        }, VideoAds.prototype.getECPM = function () {
            return 1
        }, function () {
            AdsPlugin.call(this, {
                cantLoadAndPlayInParallel: !0
            }), this.loggedEvents = {}
        }),
        VKAds = (OKAds.prototype = Object.create(AdsPlugin.prototype), (OKAds.prototype.constructor = OKAds).isAppropriate = function () {
            return cleverapps.platform.oneOf(MobileOK, OKPlatform)
        }, OKAds.prototype._connect = function (e) {
            cleverapps.whenAllInitialized(function () {
                if ("undefined" != typeof FAPI && FAPI.UI.showAd && FAPI.UI.showLoadedAd) {
                    if (cleverapps.platform instanceof MobileOK && cleverapps.platform.info.isInApp)
                        if (!(FAPI.UI.isNativeAdSupported && FAPI.UI.isNativeAdSupported())) return void e(Platform.STATUS_DISCONNECTED);
                    e(Platform.STATUS_CONNECTED)
                } else e(Platform.STATUS_DISCONNECTED)
            })
        }, OKAds.prototype.windowApiLoadAdCallbackRewarded = function (e, t) {
            console.log("window.API_callback " + e + " " + JSON.stringify(t)), t = t || "", "error" === e ? this._cacheCallback(AdsPlugin.CODE_FAILED) : -1 !== ["ad_prepared", "ready"].indexOf(t) && this._cacheCallback(AdsPlugin.CODE_SUCCEED, !0), this.logResult(e, t)
        }, OKAds.prototype.logResult = function (e, t) {
            e = e + "_" + t;
            this.loggedEvents[e] || (this.loggedEvents[e] = !0, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.OKADS.RESULT + e))
        }, OKAds.prototype._cache = function (e, t) {
            RewardedAdsManager.REWARDED === e ? (
                this._cacheCallback = cleverapps.once(t), cleverapps.platform.listeners.loadAd = this.windowApiLoadAdCallbackRewarded.bind(this), FAPI.UI.loadAd()) : RewardedAdsManager.INTERSTITIAL === e && t(AdsPlugin.CODE_SUCCEED, !0)
        }, OKAds.prototype.windowApiPlayAdCallbackRewarded = function (e, t) {
            console.log("window.API_callback " + e + " " + JSON.stringify(t)), -1 !== ["ad_prepared", "ready"].indexOf(t) ? cleverapps.platform.listeners.showAd = this.windowApiCallbackInterstitial.bind(this) : "error" === e ? ("skip" !== t && cleverapps.notification.create("NoAdsFound"), this._playCallback()) : -1 !== ["ad_shown", "complete"].indexOf(t) ? this._playCallback(AdsPlugin.CODE_REWARD) : cleverapps.throwAsync({
                group: "DebugMessage",
                message: cleverapps.EVENTS.STATS.OKADS.PLAY + "rewarded " + e + " data: " + t
            }), this.logResult(e, t)
        }, OKAds.prototype.windowApiCallbackInterstitial = function (e, t) {
            console.log("window.API_callback " + e + " " + JSON.stringify(t)), -1 !== ["ad_prepared", "ready"].indexOf(t) ? cleverapps.platform.listeners.showAd = this.windowApiCallbackInterstitial.bind(this) : "error" === e || -1 !== ["no_ads", "skip", "ad_shown", "complete"].indexOf(t) ? this._playCallback() : cleverapps.throwAsync({
                group: "DebugMessage",
                message: cleverapps.EVENTS.STATS.OKADS.PLAY + "interstitial " + e + " data: " + t
            }), this.logResult(e, t)
        }, OKAds.prototype._playAd = function (e, t, s) {
            cleverapps.platform.exitFullscreen(function () {
                this._playCallback = cleverapps.once(s), e === RewardedAdsManager.REWARDED ? (cleverapps.platform.listeners.showLoadedAd = this.windowApiPlayAdCallbackRewarded.bind(this), FAPI.UI.showLoadedAd()) : e === RewardedAdsManager.INTERSTITIAL && (cleverapps.platform.listeners.showAd = this.windowApiCallbackInterstitial.bind(this), FAPI.UI.showAd(), this._playCallback())
            }.bind(this))
        }, OKAds.prototype.getECPM = function () {
            return cleverapps.platform.oneOf(OKPlatform) ? RewardedAdsManager.eCPM.WEB_OK : RewardedAdsManager.eCPM.MOBILE_OK
        }, function () {
            AdsPlugin.call(this)
        }),
        GDComAds = (VKAds.prototype = Object.create(AdsPlugin.prototype), (VKAds.prototype.constructor = VKAds).isAppropriate = function () {
            return cleverapps.platform instanceof VKPlatform
        }, VKAds.prototype._cache = function (t, s) {
            vkBridge.send("VKWebAppCheckNativeAds", {
                ad_format: t === RewardedAdsManager.REWARDED ? "reward" : "interstitial"
            }).then(function (e) {
                e.result ? (console.log("VKWebAppCheckNativeAds: have ads!", t), s(AdsPlugin.CODE_SUCCEED, !0)) : (console.log("VKWebAppCheckNativeAds: no ads!", t, e), s(AdsPlugin.CODE_FAILED))
            }).catch(function (e) {
                console.log("VKWebAppCheckNativeAds: error", t, e), s(AdsPlugin.CODE_FAILED)
            })
        }, VKAds.prototype._playAd = function (t, e, s) {
            vkBridge.send("VKWebAppShowNativeAds", {
                ad_format: t === RewardedAdsManager.REWARDED ? "reward" : "interstitial"
            }).then(function (e) {
                e.result ? (console.log("VKWebAppShowNativeAds: shown", t), s(t === RewardedAdsManager.REWARDED ? AdsPlugin.CODE_REWARD : void 0)) : (console.log("VKWebAppShowNativeAds: canceled", t, e), s())
            }).catch(function (e) {
                console.log("VKWebAppShowNativeAds: error", t, e), s()
            })
        }, VKAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.VK
        }, function () {
            this.fakeImpression = !0, AdsPlugin.call(this)
        }),
        CrazyAds = (GDComAds.prototype = Object.create(AdsPlugin.prototype), (GDComAds.prototype.constructor = GDComAds).isAppropriate = function () {
            return cleverapps.platform instanceof GDCom
        }, GDComAds.prototype._connect = function (e) {
            cleverapps.whenAllInitialized(function () {
                "undefined" != typeof gdsdk && "undefined" !== gdsdk.preloadAd && "undefined" !== gdsdk.showAd ? (console.log("gdcom social inited - cache ads"), cleverapps.platform.adsEventListener = this.onEvent.bind(this), e(Platform.STATUS_CONNECTED)) : e(Platform.STATUS_DISCONNECTED)
            }.bind(this))
        }, GDComAds.prototype.onEvent = function (e) {
            var t = this.whichIsPlaying();
            if (void 0 !== t)
                if ("LOG" === e.name && e.message && e.message.adError) cleverapps.notification.create("NoAdsFound");
                else {
                    switch (e.name) {
                        case "AD_ERROR":
                            this._playCallbackErrorDelayed && this._playCallbackErrorDelayed();
                            break;
                        case "IMPRESSION":
                        case "SDK_GAME_PAUSE":
                            this.started = !0;
                            break;
                        case "STARTED":
                        case "FIRST_QUARTILE":
                        case "MIDPOINT":
                        case "THIRD_QUARTILE":
                            this.fakeImpression = !1, this.started = !0;
                            break;
                        case "USER_CLOSE":
                        case "SKIPPED":
                            this._playCallback();
                            break;
                        case "ALL_ADS_COMPLETED":
                        case "COMPLETE":
                            t === RewardedAdsManager.REWARDED ? this._playCallbackDelayed() : this._playCallback();
                            break;
                        case "SDK_REWARDED_WATCH_COMPLETE":
                            this._playCallback(AdsPlugin.CODE_REWARD)
                    }
                    e.name && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.GDCOM.ADS_EVENT + e.name.toLowerCase())
                }
        }, GDComAds.prototype._cache = function (t, s) {
            try {
                gdsdk.preloadAd(t).then(function (e) {
                    console.log("GDCom ads: have ads!", t, e), s(AdsPlugin.CODE_SUCCEED, !0)
                }).catch(function (e) {
                    console.log("GDCom ads: NO ads!", e), s(AdsPlugin.CODE_FAILED)
                })
            } catch (e) {
                console.log("Error gdsdk.preloadAd", e), s(AdsPlugin.CODE_FAILED)
            }
        }, GDComAds.prototype._playAd = function (e, t, s) {
            this._playCallback = cleverapps.once(s), this._playCallbackDelayed = cleverapps.once(cleverapps.accumulate(3e3, this._playCallback));
            var i = this._playCallback;
            this._playCallbackErrorDelayed = cleverapps.postpone(
                5e3,
                function () {
                    this.started || i()
                }.bind(this)), this.started = !1, this.fakeImpression = !0;
            try {
                gdsdk.showAd(e).then(function () { }).catch(function (e) {
                    this._playCallback(), console.log("GDCom showAd error:", e)
                }.bind(this))
            } catch (e) {
                console.log("GDCom showAd error:", e)
            }
        }, GDComAds.prototype.isFakeImpression = function () {
            return this.fakeImpression
        }, GDComAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.GDCom
        }, function () {
            AdsPlugin.call(this)
        }),
        PlingaAds = (CrazyAds.prototype = Object.create(AdsPlugin.prototype), (CrazyAds.prototype.constructor = CrazyAds).isAppropriate = function () {
            return cleverapps.platform.oneOf(Crazy)
        }, CrazyAds.prototype._connect = function (e) {
            e(Platform.STATUS_CONNECTED)
        }, CrazyAds.prototype._playAd = function (e, t, s) {
            CrazyGames.SDK.ad.requestAd("rewarded" === e ? e : "midgame", {
                adStarted: function () { },
                adFinished: function () {
                    s("rewarded" === e ? AdsPlugin.CODE_REWARD : void 0)
                },
                adError: function (e, t) {
                    cleverapps.notification.create("NoAdsFound"), console.log("CrazyGames showAd error: ",
                        JSON.stringify(t)), s()
                }
            })
        }, CrazyAds.prototype._cache = function (e, s) {
            CrazyGames.SDK.ad.hasAdblock(function (e, t) {
                e || t ? (console.log("CrazyGames hasAdblock"), s(AdsPlugin.CODE_FAILED)) : s(AdsPlugin.CODE_SUCCEED, !0)
            })
        }, function () {
            AdsPlugin.call(this)
        }),
        InstantAds = (PlingaAds.prototype = Object.create(AdsPlugin.prototype), (PlingaAds.prototype.constructor = PlingaAds).isAppropriate = function () {
            return cleverapps.platform instanceof Plinga
        }, PlingaAds.prototype._connect = function (e) {
            cleverapps.whenAllInitialized(function () {
                "undefined" != typeof plingaRpc && "undefined" !== plingaRpc.requestRewardedAdvertisement && "undefined" !== plingaRpc.requestAdvertisement ? (console.log("PlingaAds inited"), e(Platform.STATUS_CONNECTED)) : e(Platform.STATUS_DISCONNECTED)
            })
        }, PlingaAds.prototype._playAd = function (e, t, s) {
            this._playCallback = cleverapps.once(s);
            try {
                console.log("PlingaAds playAd:", e), "rewarded" === e ? plingaRpc.requestRewardedAdvertisement(function () {
                    this._playCallback(AdsPlugin.CODE_REWARD)
                }.bind(this), function () {
                    cleverapps.notification.create("NoAdsFound"), this._playCallback()
                }.bind(this)) : plingaRpc.requestAdvertisement(function () {
                    this._playCallback()
                }.bind(this), function () {
                    cleverapps.notification.create("NoAdsFound"), this._playCallback()
                }.bind(this))
            } catch (e) {
                console.log("Plinga showAd error:", e)
            }
        }, PlingaAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.Plinga
        }, function () {
            console.log("Choose InstantAds"), AdsPlugin.call(this, {
                cantLoadAndPlayInParallel: !0
            }), this.adInstances = {}
        }),
        AdMobAds = (InstantAds.prototype = Object.create(AdsPlugin.prototype), (InstantAds.prototype.constructor = InstantAds).prototype._connect = function (e) {
            cleverapps.whenAllInitialized(function () {
                -1 === FBInstant.getSupportedAPIs().indexOf("getRewardedVideoAsync") ? (console.log("FBInstant getRewardedVideoAsync is not supported!"), e(Platform.STATUS_DISCONNECTED)) : (console.log("Found support for FBInstant getRewardedVideoAsync"), e(Platform.STATUS_CONNECTED))
            })
        }, InstantAds.prototype._cache = function (t, s) {
            var e = FBInstant.getRewardedVideoAsync,
                i = "getRewardedVideoAsync";
            if (t === RewardedAdsManager.INTERSTITIAL && (e = FBInstant.getInterstitialAdAsync, i = "getInterstitialAdAsync"), console.log("Searching " + i), -1 === FBInstant.getSupportedAPIs().indexOf(i)) return console.log("No support for " + i + ", skip"), void s(AdsPlugin.CODE_FAILED);
            var n = function (e) {
                e.loadAsync().then(function () {
                    console.log("Loaded instant ad video: " + t), this.loadErrorCode = void 0, delete this.adInstances[t], s(AdsPlugin.CODE_SUCCEED, e)
                }.bind(this)).catch(function (e) {
                    switch (console.log("Instant ads: NO ads!", e.message, e.code), s(AdsPlugin.CODE_FAILED), "ADS_NO_FILL" !== e.code && cleverapps.playSession.set(cleverapps.EVENTS.STATS.REWARDED_ERROR_DAU, !0), e.code) {
                        case "INVALID_OPERATION":
                        case "ADS_FREQUENT_LOAD":
                        case "ADS_TOO_MANY_INSTANCES":
                        case "ADS_NO_FILL":
                        case "NETWORK_FAILURE":
                        case "UNKNOWN":
                        case "CLIENT_UNSUPPORTED_OPERATION":
                        case "INVALID_PARAM":
                            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.ADS_LOAD + e.code),
                                this.loadErrorCode = e.code;
                            break;
                        default:
                            cleverapps.throwAsync(cleverapps.EVENTS.STATS.INSTANT.ADS_LOAD + e.code + " message: " + e.message)
                    }
                }.bind(this))
            }.bind(this);
            this.adInstances[t] ? (console.log("Exists instant ad config: " + t), n(this.adInstances[t])) : e.call(FBInstant, Instant.FULL_AD_ID(cleverapps.config.instant[t])).then(function (e) {
                console.log("Loaded instant ad config: " + t), this.adInstances[t] = e, n(e, s)
            }.bind(this))
        }, InstantAds.prototype.playAd = function () {
            cleverapps.pendingRequests ? this._onCancel() : AdsPlugin.prototype.playAd.apply(this, arguments)
        }, InstantAds.prototype._playAd = function (e, t, s) {
            cleverapps.countPendingRequests(t.showAsync()).then(function () {
                e === RewardedAdsManager.REWARDED ? s(AdsPlugin.CODE_REWARD) : s()
            }).catch(function (e) {
                console.error(e.message), s(), "USER_INPUT" !== e.code && cleverapps.playSession.set(cleverapps.EVENTS.STATS.REWARDED_ERROR_DAU, !0);
                var t = cleverapps.EVENTS.STATS.INSTANT.ADS_PLAY + e.code + " message: " + e.message;
                switch (e.code) {
                    case "PENDING_REQUEST":
                        cleverapps.throwAsync(t);
                    case "ADS_NOT_LOADED":
                    case "INVALID_PARAM":
                    case "NETWORK_FAILURE":
                    case "INVALID_OPERATION":
                    case "RATE_LIMITED":
                    case "USER_INPUT":
                    case "PAYMENTS_NOT_INITIALIZED":
                    case "ADS_EXPIRED":
                    case "UNKNOWN":
                        cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.ADS_PLAY + e.code);
                        break;
                    default:
                        cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.INSTANT.ADS_PLAY + "OTHER"), cleverapps.cleverapps.throwAsync(t)
                }
            })
        }, InstantAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.Instant
        }, InstantAds.isAppropriate = function () {
            return cleverapps.platform.oneOf(Instant)
        }, function () {
            AdsPlugin.call(this, {
                cantLoadAndPlayInParallel: !0
            }), this.code = "AdMobAds", this.onAdLoadedCallback = {}, this.savedImpressionCost = void 0, this._playCallback = function () { }
        }),
        AppLovinAds = (AdMobAds.prototype = Object.create(AdsPlugin.prototype), (AdMobAds.prototype.constructor = AdMobAds).prototype._connect = function (e) {
            console.log("AdMobAds.init");
            var t = AdMobAds.getConfig();
            cleverapps.config.debugMode && (t = {
                rewarded: "ca-app-pub-3940256099942544/5224354917"
            }), cleverapps.platform.callNative("AdMobPlugin.init", {
                adMob: t,
                isTest: Boolean(cleverapps.config.debugMode),
                testDevices: (AdMobAds.TEST_DEVICES[cleverapps.config.source] || []).join(",")
            }, function () {
                console.log("AdMobAds.onInit"), cleverapps.platform.nativeEventListeners.AdMobAds = this.onNativeEvent.bind(this), e(Platform.STATUS_CONNECTED)
            }.bind(this))
        }, AdMobAds.prototype._cache = function (e, t) {
            console.log("AdMobAds._cache"), this.onAdLoadedCallback[e] = t, cleverapps.platform.callNative("AdMobPlugin.cache", {
                name: e
            })
        }, AdMobAds.prototype.onAdLoadResult = function (e, t) {
            console.log("AdMobAds.onAdLoaded"), this.onAdLoadedCallback[e] && (this.onAdLoadedCallback[e](t, !0), this.onAdLoadedCallback[e] = void 0)
        }, AdMobAds.prototype._playAd = function (e, t, s) {
            console.log("AdMobAds._playAd"), this.success = !1, this._playCallback = s, cleverapps.platform.callNative("AdMobPlugin.show", {
                name: e
            })
        }, AdMobAds.isAppropriate = function () {
            return cleverapps.platform.oneOf(Amazon,
                AndroidPlatform, IOS, IOSCh) && AdMobAds.getConfig()
        }, AdMobAds.getConfig = function (e) {
            return e = e || cleverapps.platform.source, cleverapps.config[e] && cleverapps.config[e].adMob ? cleverapps.config[e].adMob : "amazon" === e ? AdMobAds.getConfig("android") : void 0
        }, AdMobAds.prototype.getECPM = function () {
            return 1e3 * this.savedImpressionCost
        }, AdMobAds.prototype.onNativeEvent = function (e, t) {
            switch (console.log("AdMobAds.onNativeEvent - " + e), e) {
                case "onPaidEvent":
                    this.savedImpressionCost = t.cost, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.ADMOB_ADS, {
                        value: this.savedImpressionCost
                    });
                    break;
                case "onAdOpened":
                    break;
                case "onAdClosed":
                    var s = t.name === RewardedAdsManager.REWARDED && this.success ? AdsPlugin.CODE_REWARD : void 0;
                    this._playCallback(s);
                    break;
                case "onAdLoaded":
                    this.onAdLoadResult(t.name, AdsPlugin.CODE_SUCCEED);
                    break;
                case "onAdFailedToLoad":
                    this.onAdLoadResult(t.name, AdsPlugin.CODE_FAILED);
                    break;
                case "onReward":
                    this.success = !0
            }
        }, AdMobAds.prototype.askPermission = function (t) {
            cleverapps.platform.callNative(
                "GDPRPlugin.askPermission",
                function (e) {
                    console.log("GDPR setStatus " + e), t()
                })
        }, AdMobAds.TEST_DEVICES = {
            ios: [],
            android: ["80CEB8C9DEDE042AF04B1FBBBE040596", "kGADSimulatorID", "FE20924C46522E2E204587EB339897C6", "6D5FBD67BE15A16F114AA62F6BA3075E"]
        }, AdMobAds.TEST_DEVICES.amazon = AdMobAds.TEST_DEVICES.android, function () {
            AdsPlugin.call(this, {
                cantLoadAndPlayInParallel: !0
            }), this.code = "AppLovinAds", this.onAdLoadedCallback = {}, this.savedImpressionCost = void 0, this._playCallback = function () { }
        }),
        YandexAppAds = (AppLovinAds.prototype = Object.create(AdsPlugin.prototype), (AppLovinAds.prototype.constructor = AppLovinAds).prototype._connect = function (e) {
            console.log("AppLovinAds.init");
            var t = AppLovinAds.getConfig();
            cleverapps.platform.callNative("AppLovinPlugin.init", t, function () {
                console.log("AppLovinPlugin.onInit"), cleverapps.platform.nativeEventListeners.AppLovinPlugin = this.onNativeEvent.bind(this), e(Platform.STATUS_CONNECTED)
            }.bind(this))
        }, AppLovinAds.prototype._cache = function (e, t) {
            console.log(
                "AppLovinAds._cache"), this.onAdLoadedCallback[e] = t, cleverapps.platform.callNative("AppLovinPlugin.cache", {
                    name: e
                })
        }, AppLovinAds.prototype.onAdLoadResult = function (e, t) {
            console.log("AppLovinAds.onAdLoaded"), this.onAdLoadedCallback[e] && (this.onAdLoadedCallback[e](t, !0), this.onAdLoadedCallback[e] = void 0)
        }, AppLovinAds.prototype._playAd = function (e, t, s) {
            console.log("AppLovinAds._playAd"), this.success = !1, this._playCallback = s, cleverapps.platform.callNative("AppLovinPlugin.show", {
                name: e
            })
        }, AppLovinAds.isAppropriate = function () {
            var e = AdMobAds.getConfig();
            return cleverapps.platform.oneOf(AndroidPlatform) && e && e.rewarded && (cleverapps.ABTest.APP_LOVIN() || ["fairy"].includes(cleverapps.config.name))
        }, AppLovinAds.getConfig = function (e) {
            return e = e || cleverapps.platform.source, cleverapps.config[e] && cleverapps.config[e].appLovin
        }, AppLovinAds.prototype.getECPM = function () {
            return 1e3 * this.savedImpressionCost
        }, AppLovinAds.prototype.onNativeEvent = function (e, t) {
            switch (console.log("AppLovinAds.onNativeEvent - " + e), e) {
                case "onAdRevenuePaid":
                    this.savedImpressionCost = t.cost || (cleverapps.config.debugMode ? 1e-6 : 0), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.APP_LOVIN_ADS, {
                        value: this.savedImpressionCost
                    });
                    break;
                case "onAdDisplayed":
                    break;
                case "onAdDisplayFailed":
                case "onAdHidden":
                    var s = t.name === RewardedAdsManager.REWARDED && this.success ? AdsPlugin.CODE_REWARD : void 0;
                    this._playCallback(s);
                    break;
                case "onAdLoaded":
                    this.onAdLoadResult(t.name, AdsPlugin.CODE_SUCCEED);
                    break;
                case "onAdLoadFailed":
                    this.onAdLoadResult(t.name, AdsPlugin.CODE_FAILED);
                    break;
                case "onUserRewarded":
                    this.success = !0
            }
        }, AppLovinAds.prototype.askPermission = function (e) {
            var t = "slimmerbits" === (cleverapps.config.android.business || cleverapps.config.business) ? "slimmerbits.com" : "cleverappssg.com";
            cleverapps.platform.callNative("AppLovinPlugin.askPermission", {
                privacy: "https://" + t + "/legal/privacy.html",
                terms: "https://" + t + "/legal/terms.html"
            }, e)
        }, function () {
            AdsPlugin.call(this, {
                cantLoadAndPlayInParallel: !0
            }), this.code = "YandexAppAds",
                this._playCallback = function () { }
        }),
        YandexAds = (YandexAppAds.prototype = Object.create(AdsPlugin.prototype), (YandexAppAds.prototype.constructor = YandexAppAds).prototype._connect = function (e) {
            console.log("YandexAppAds.init");
            var t = cleverapps.config.android.yandexAds.rewarded;
            cleverapps.config.debugMode && (t = YandexAppAds.YANDEX_AD_UNIT_ID), cleverapps.platform.callNative("YandexAdsPlugin.init", {
                adUnitId: t
            }, function () {
                console.log("YandexAppAds.onInit"), cleverapps.platform.nativeEventListeners.YandexAppAds = this.onNativeEvent.bind(this), e(Platform.STATUS_CONNECTED)
            }.bind(this))
        }, YandexAppAds.prototype.onNativeEvent = function (e) {
            switch (e) {
                case "onAdLoaded":
                    this.onAdLoaded();
                    break;
                case "onAdFailedToLoad":
                    this.onAdFailedToLoad();
                    break;
                case "onAdFailedToShow":
                    console.log("YandexAppAds.onAdFailedToShow"), this._playCallback();
                    break;
                case "onReward":
                    this.success = !0;
                    break;
                case "onAdClosed":
                    console.log("YandexAppAds.onAdClosed"), this._playCallback(this.success ? AdsPlugin.CODE_REWARD : void 0),
                        this.success && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.YANDEX_APP_ADS, {
                            value: this.getECPM() / 1e3
                        })
            }
        }, YandexAppAds.prototype._cache = function (e, t) {
            e === RewardedAdsManager.REWARDED ? (console.log("YandexAppAds._cache"), this._cacheCallback = t, cleverapps.platform.callNative("YandexAdsPlugin.cache", {
                name: e
            })) : t(AdsPlugin.CODE_FAILED)
        }, YandexAppAds.prototype.onAdLoaded = function () {
            console.log("YandexAppAds.onAdLoaded"), this._cacheCallback && (this._cacheCallback(AdsPlugin.CODE_SUCCEED, !0), this._cacheCallback = void 0)
        }, YandexAppAds.prototype.onAdFailedToLoad = function () {
            console.log("YandexAppAds.onAdFailedToLoad"), this._cacheCallback && (this._cacheCallback(AdsPlugin.CODE_FAILED), this._cacheCallback = void 0)
        }, YandexAppAds.prototype._playAd = function (e, t, s) {
            console.log("YandexAppAds._playAd"), this.success = !1, this._playCallback = s, cleverapps.platform.callNative("YandexAdsPlugin.show", {
                name: e
            })
        }, YandexAppAds.isAppropriate = function () {
            return (cleverapps.platform.oneOf(AndroidPlatform) && cleverapps.paymentsCountry.isRussia() || cleverapps.platform.oneOf(Rustore)) && cleverapps.config.android.yandexAds && cleverapps.config.android.yandexAds.rewarded
        }, YandexAppAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.YandexApp
        }, YandexAppAds.YANDEX_AD_UNIT_ID = "demo-rewarded-yandex", YandexAppAds.MINTEGRAL_AD_UNIT_ID = "demo-rewarded-mintegral", YandexAppAds.MYTARGET_AD_UNIT_ID = "demo-rewarded-mytarget", function () {
            AdsPlugin.call(this), this.playTime = 0
        }),
        GoogleWebAds = (YandexAds.prototype = Object.create(AdsPlugin.prototype), (YandexAds.prototype.constructor = YandexAds).isAppropriate = function () {
            return cleverapps.platform instanceof Yandex
        }, YandexAds.prototype.playAd = function (t) {
            if (cleverapps.platform.isConnected(Platform.ADS) && this.cached[t] && !this.adIsRunning(t)) {
                if (this.playTime + AdsPlugin.LOAD_AFTER_PLAY_TIME > Date.now()) return t === RewardedAdsManager.REWARDED && cleverapps.notification.create("WaitNextAd"), void this._onCancel();
                this.setPlaying(t),
                    RewardedAdsManager.ACTIVE_ADS.forEach(function (e) {
                        this.reset(e)
                    }.bind(this)), this.playTime = Date.now();
                var e = function (e) {
                    this.setFinished(t), e === AdsPlugin.CODE_REWARD ? cleverapps.rewardedAdsManager.onReward() : this._onCancel()
                }.bind(this);
                t === RewardedAdsManager.REWARDED ? this._playRewardedAd(e) : this._playInterstitialAd(e)
            } else this._onCancel()
        }, YandexAds.prototype._playRewardedAd = function (t) {
            var e = !1;
            t = cleverapps.once(t), cleverapps.platform.ysdk.adv.showRewardedVideo({
                callbacks: {
                    onRewarded: function () {
                        e = !0
                    },
                    onClose: function () {
                        e ? t(AdsPlugin.CODE_REWARD) : t()
                    },
                    onError: function (e) {
                        t(), this._processError(RewardedAdsManager.REWARDED, e)
                    }.bind(this)
                }
            })
        }, YandexAds.prototype._playInterstitialAd = function (t) {
            t = cleverapps.once(t), cleverapps.platform.ysdk.adv.showFullscreenAdv({
                callbacks: {
                    onClose: t,
                    onError: function (e) {
                        t(), this._processError(RewardedAdsManager.INTERSTITIAL, e)
                    }.bind(this)
                }
            })
        }, YandexAds.prototype._processError = function (e, t) {
            var s = String(t);
            console.log(e + " onError: " + s);
            (t = [{
                match: [
                    "No rewarded video to show now", "No adv to show now"
                ],
                group: "noads",
                notification: "NoAdsError"
            }, {
                match: ["AdBlock prevents yandex ad to show"],
                group: "adblock",
                notification: "AdBlockError"
            }, {
                match: [/Container with id .+? is not found/],
                group: "container_not_found",
                notification: "PlayAdError"
            }, {
                match: [/Container with id .+? is hidden/],
                group: "container_hidden",
                notification: "PlayAdError"
            }, {
                match: ["Too narrow container."],
                group: "container_too_narrow",
                notification: "PlayAdError"
            }, {
                match: ["The received format doesn't match the expected type"],
                group: "format_mismatch",
                notification: "PlayAdError"
            }, {
                match: ["Current domain is not allowed on the page"],
                group: "not_allowed",
                notification: "PlayAdError"
            }, {
                match: ["Another ad already opened"],
                group: "already_opened",
                notification: "AdAlreadyOpenedError"
            }, {
                match: ["Rewarded Video timeout", "Message rejected by timeout"],
                group: "timeout",
                notification: "AdVideoTimeoutError"
            }, {
                match: ["Ad script init timeout"],
                group: "init_timeout",
                notification: "AdInitTimeoutError"
            }, {
                match: [/^Error$/],
                group: "no_description",
                notification: "PlayAdError"
            }].find(function (e) {
                return e.match.some(function (e) {
                    return s.match(e)
                })
            })) || (t = {
                group: "other",
                notification: "PlayAdError"
            }, cleverapps.throwAsync({
                group: "yandexRewardedError",
                message: e + " " + s
            })), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.YANDEX.ADS_PLAY + e + "-" + t.group), e !== RewardedAdsManager.INTERSTITIAL && cleverapps.notification.create(t.notification)
        }, YandexAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.Yandex
        }, function () {
            AdsPlugin.call(this, {
                cantLoadAndPlayInParallel: !0
            }), AdsPlugin.EXPIRATION_TIME = cleverapps.parseInterval("100 days"), this.withSdk = !0, this.code = "GoogleWebAds"
        }),
        WortalAds = (GoogleWebAds.prototype = Object.create(AdsPlugin.prototype), (GoogleWebAds.prototype.constructor = GoogleWebAds).isAppropriate = function () {
            return cleverapps.platform.oneOf(CleverApps, Xiaomi)
        }, GoogleWebAds.prototype._connect = function (e) {
            console.log("Initing GoogleWebAds");
            var t = {
                "data-ad-client": cleverapps.config.adsense.client,
                "data-ad-frequency-hint": "5s"
            };
            cleverapps.config.debugMode && (t["data-adbreak-test"] = "on"), cleverapps.loadSdk("//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=" + cleverapps.config.adsense.client, {
                attrs: t,
                onSuccess: function () {
                    console.log("GoogleWebAds API loaded"), window.adsbygoogle = window.adsbygoogle || [], window.adsbygoogle.push({
                        preloadAdBreaks: "on",
                        sound: "on",
                        onReady: function () {
                            console.log("GoogleWebAds ready"), e(Platform.STATUS_CONNECTED)
                        }
                    })
                },
                onFailure: function () {
                    console.log("Failed load adsbygoogle.js"), e(Platform.STATUS_DISCONNECTED)
                }
            })
        }, GoogleWebAds.prototype._cache = function (e, t) {
            var s;
            e === RewardedAdsManager.REWARDED ? (s = !1, window.adsbygoogle.push({
                name: e,
                type: "reward",
                beforeReward: function (e) {
                    t(AdsPlugin.CODE_SUCCEED, e)
                },
                adViewed: function () {
                    s = !0
                },
                adDismissed: function () {
                    s = !1
                },
                adBreakDone: function () {
                    this._callback ? (this._callback(s ? AdsPlugin.CODE_REWARD : void 0), this._callback = void 0) : t()
                }.bind(this)
            })) : t(
                AdsPlugin.CODE_FAILED)
        }, GoogleWebAds.prototype._playAd = function (e, t, s) {
            "function" == typeof t ? e === RewardedAdsManager.REWARDED && (this._callback = s, t()) : s && s()
        }, GoogleWebAds.prototype.addBannerContainer = function () {
            var e, t;
            this.bannerContainer || ((e = this.bannerContainer = document.createElement("div")).style.display = "block", e.style.position = "absolute", e.style.bottom = "0", e.style.margin = "0 auto", e.style.right = "0", e.style.left = "0", e.style.height = GoogleWebAds.AD_BANNER_HEIGHT + "px", e.style.width = "728px", e.style.zIndex = "2", e.style.backgroundColor = "white", (t = this.bannerIns = document.createElement("ins")).id = "google-ad-banner-container", t.className = "adsbygoogle", t.style.zIndex = "2", t.setAttribute("data-ad-client", cleverapps.config.adsense.client), t.setAttribute("data-ad-slot", cleverapps.config.adsense.slot), cleverapps.config.debugMode && t.setAttribute("data-adbreak-test", "on"), t.style.display = "inline-block", t.style.position = "relative", t.style.margin = "0 auto",
                t.style.height = GoogleWebAds.AD_BANNER_HEIGHT + "px", t.style.width = "728px", document.body.appendChild(e), e.appendChild(t), (window.adsbygoogle = window.adsbygoogle || []).push({}))
        }, GoogleWebAds.prototype.removeBannerContainer = function () {
            this.bannerObserver && (this.bannerObserver.disconnect(), this.bannerObserver = void 0), this.bannerIns && (this.bannerIns.remove(), this.bannerIns = void 0), this.bannerContainer && (this.bannerContainer.remove(), this.bannerContainer = void 0)
        }, GoogleWebAds.prototype.showBanner = function (e) {
            this.addBannerContainer(), e(cleverapps.CODE_SUCCEED, GoogleWebAds.AD_BANNER_HEIGHT)
        }, GoogleWebAds.prototype.hideBanner = function (e) {
            this.removeBannerContainer(), e(cleverapps.CODE_SUCCEED)
        }, GoogleWebAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.GoogleWeb
        }, GoogleWebAds.AD_BANNER_HEIGHT = 90, function () {
            console.log("Choose WortalAds"), AdsPlugin.call(this)
        }),
        SamsungAds = (WortalAds.prototype = Object.create(AdsPlugin.prototype), (WortalAds.prototype.constructor = WortalAds).isAppropriate = function () {
            return cleverapps.platform.oneOf(WortalPlatform)
        }, WortalAds.prototype._connect = function (e) {
            e(Platform.STATUS_CONNECTED)
        }, WortalAds.prototype._playAd = function (e, t, s) {
            function i() {
                cleverapps.notification.create("NoAdsFound"), s()
            }

            function n() { }

            function o() { }
            e === RewardedAdsManager.REWARDED ? Wortal.ads.showRewarded(cleverapps.rewardedAdsManager.lastAdStarter, n, o, function () {
                s()
            }, function () {
                s(AdsPlugin.CODE_REWARD)
            }, i) : Wortal.ads.showInterstitial("interstitial", "ShowInterstitial", n, o, i)
        }, WortalAds.prototype._cache = function (e, t) {
            if (Wortal.ads.isAdBlocked()) return console.log("AdBlockError"), void t(AdsPlugin.CODE_FAILED);
            t(AdsPlugin.CODE_SUCCEED, 1)
        }, function () {
            console.log("Choose SamsungAds"), AdsPlugin.call(this)
        }),
        MSStartAds = (SamsungAds.prototype = Object.create(AdsPlugin.prototype), (SamsungAds.prototype.constructor = SamsungAds).prototype._connect = function (e) {
            var t = SamsungAds.ids;
            GSInstant.advertisement2.initAd({
                samsungInterstitialAdPlacementId: t.interstitial,
                samsungRewardedAdPlacementId: t.rewarded,
                admobInterstitialAdUnitId: t.adMob && t.adMob.interstitial,
                admobRewardedAdUnitId: t.adMob && t.adMob.rewarded,
                gameTitle: cleverapps.config.title
            }), ["AD_LOADED", "AD_LOAD_ERROR", "AD_SKIP", "AD_CLOSE", "AD_VIDEO_ERROR", "AD_SHOW_ERROR", "AD_COMPLETE"].forEach(function (e) {
                GSInstant.advertisement2.addEventListener(e, function () {
                    this.onEvent(e)
                }.bind(this))
            }.bind(this)), e(Platform.STATUS_CONNECTED)
        }, SamsungAds.prototype._cache = function (e, t) {
            this.loadAdCallback = t, GSInstant.advertisement2.loadAd({
                adFormat: SamsungAds.adFormats[e]
            })
        }, SamsungAds.prototype.onEvent = function (e) {
            var t = this.whichIsPlaying();
            switch (e) {
                case "AD_LOADED":
                    this.loadAdCallback(AdsPlugin.CODE_SUCCEED, !0);
                    break;
                case "AD_LOAD_ERROR":
                    this.loadAdCallback(AdsPlugin.CODE_FAILED);
                    break;
                case "AD_SKIP":
                case "AD_CLOSE":
                case "AD_VIDEO_ERROR":
                case "AD_SHOW_ERROR":
                    this.playAdCallback();
                    break;
                case "AD_COMPLETE":
                    t === RewardedAdsManager.REWARDED ? this.playAdCallback(AdsPlugin.CODE_REWARD) : this.playAdCallback()
            }
        },
            SamsungAds.prototype._playAd = function (e, t, s) {
                this.playAdCallback = s, GSInstant.advertisement2.showAd({
                    adFormat: SamsungAds.adFormats[e]
                })
            }, SamsungAds.isAppropriate = function () {
                return cleverapps.platform.oneOf(Samsung)
            }, SamsungAds.adFormats = {}, SamsungAds.adFormats[RewardedAdsManager.REWARDED] = "REWARD", SamsungAds.adFormats[RewardedAdsManager.INTERSTITIAL] = "INTERSTITIAL", SamsungAds.ids = {
                interstitial: "fd210d27178e4542a4fe2972f899903c",
                rewarded: "0d370a9a087049a7ab82879b21b69a57",
                adMob: {
                    interstitial: "ca-app-pub-3940256099942544/1033173712",
                    rewarded: "ca-app-pub-3940256099942544/5354046379"
                }
            },
            function () {
                AdsPlugin.call(this, {
                    cantLoadAndPlayInParallel: !0
                }), this.code = "MSStartAds"
            }),
        WechatAds = (MSStartAds.prototype = Object.create(AdsPlugin.prototype), (MSStartAds.prototype.constructor = MSStartAds).isAppropriate = function () {
            return cleverapps.platform.oneOf(MSStart)
        }, MSStartAds.prototype._connect = function (e) {
            cleverapps.timeouts.setTimeout(function () {
                e(Platform.STATUS_CONNECTED)
            },
                MSStartAds.LOAD_AFTER_INIT_TIME)
        }, MSStartAds.prototype._cache = function (e, t) {
            $msstart.loadAdsAsync(e === RewardedAdsManager.REWARDED).then(function (e) {
                console.log("MSStart ads: have ads!", e), t(AdsPlugin.CODE_SUCCEED, e)
            }).catch(function () {
                console.log("MSStart ads: NO ads!"), t(AdsPlugin.CODE_FAILED)
            })
        }, MSStartAds.prototype._playAd = function (t, e, s) {
            $msstart.showAdsAsync(e.instanceId).then(function (e) {
                e.showAdsCompletedAsync.then(function () {
                    t === RewardedAdsManager.REWARDED ? s(AdsPlugin.CODE_REWARD) : s()
                }).catch(function (e) {
                    console.log("showAdsCompletedAsync", e), s()
                })
            }).catch(function (e) {
                console.log("showAdsAsync error", e), s()
            })
        }, MSStartAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.MSStart
        }, MSStartAds.LOAD_AFTER_INIT_TIME = cleverapps.parseInterval("10 seconds"), function () {
            AdsPlugin.call(this), this._loadCallback = function () { }, this._playCallback = function () { }
        }),
        BannerAd = (WechatAds.prototype = Object.create(AdsPlugin.prototype), (WechatAds.prototype.constructor = WechatAds).prototype._connect = function (e) {
            var t = cleverapps.config.wechat.rewarded;
            console.log("wechatads init - " + t), this.rewarded = wx.createRewardedVideoAd({
                adUnitId: t
            }), this.rewarded.onLoad(this.onLoad.bind(this)), this.rewarded.onError(this.onError.bind(this)), this.rewarded.onClose(this.onClose.bind(this)), e(Platform.STATUS_CONNECTED)
        }, WechatAds.prototype._cache = function (e, t) {
            if (e !== RewardedAdsManager.REWARDED) return console.log("wechatads only rewarded"), void t(AdsPlugin.CODE_FAILED);
            this._loadCallback = cleverapps.once(t), this.rewarded.load().then(this.onLoad.bind(this)).catch(this.onError.bind(this))
        }, WechatAds.prototype._playAd = function (e, t, s) {
            this._playCallback = cleverapps.once(s), t.show().catch(this.onError.bind(this))
        }, WechatAds.prototype.onLoad = function () {
            console.log("wechatads loaded"), this._loadCallback(AdsPlugin.CODE_SUCCEED, this.rewarded)
        }, WechatAds.prototype.onError = function (e) {
            this.whichIsPlaying() ? (console.log("wechatads show error", e), this._playCallback()) : (console.log(
                "wechatads load fail", e), this._loadCallback(AdsPlugin.CODE_FAILED))
        }, WechatAds.prototype.onClose = function (e) {
            e && e.isEnded ? (console.log("wechatads shown"), this._playCallback(AdsPlugin.CODE_REWARD)) : (console.log("wechatads cancelled"), this._playCallback())
        }, WechatAds.prototype.getECPM = function () {
            return RewardedAdsManager.eCPM.Wechat
        }, WechatAds.isAppropriate = function () {
            return cleverapps.platform.oneOf(Wechat) && cleverapps.config.wechat.rewarded
        }, function () {
            this.state = BannerAd.STATE_HIDDEN, this.show(), cleverapps.timeouts.setInterval(this.check.bind(this), BannerAd.CHECK_INTERVAL), cleverapps.platform.isConnected(Platform.ADS) && this.check(), cleverapps.platform.on("changeStatus:" + Platform.ADS, function (e) {
                e === Platform.STATUS_CONNECTED && this.check()
            }.bind(this))
        }),
        PackManager = (BannerAd.prototype.canShow = function () {
            if (cleverapps.paymentsHistory.classify() !== cleverapps.PaymentsHistory.BRACKET_NONE) return !1;
            if (cleverapps.environment.isLoaderScene() || cleverapps.environment.isChatScene() || cleverapps.environment.isMineScene() || cleverapps.environment.isBonusWorldScene() || cleverapps.environment.isAtlasAnalyzerScene() || cleverapps.environment.isSceneWithPreview()) return !1;
            if (cleverapps.snapshotBar && cleverapps.snapshotBar.isRecording) return !1;
            if (cc.sys.isMobile && (cleverapps.resolution.isLandscapeOrientation() || "horizontal" === cleverapps.config.orientation)) return !1;
            if (cleverapps.platform.oneOf(Instant)) {
                if (void 0 === cleverapps.config.instant.banner && cleverapps.config.debugMode) throw "No instant banner config";
                if (!cc.sys.isInApp) return !1;
                if (void 0 === cleverapps.config.instant.banner) return !1
            }
            if (!cleverapps.platform.oneOf(CleverApps, Xiaomi) || cleverapps.config.adsense && cleverapps.config.adsense.slot) return (!cleverapps.platform.oneOf(Crazy) || !cleverapps.flags.highMonetization) && ((!cleverapps.platform.oneOf(OKPlatform) || !cleverapps.platform.isFullScreen()) && cleverapps.platform.oneOf(Instant, VKPlatform, OKPlatform, CleverApps, Xiaomi, Crazy, TestPlatform));
            if (cleverapps.config.debugMode) throw "No adsense config or slot";
            return !1
        }, BannerAd.prototype.show = function () {
            this.processing || this.state !== BannerAd.STATE_HIDDEN || this.canShow() && (this.processing = !0, console.log("showBannerAd loading"), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.BANNER.LOADING), cleverapps.platform.showBannerAd(function (e, t) {
                this.processing = !1, e === cleverapps.CODE_SUCCEED ? (this.bannerWidth = void 0, "object" == typeof t && (this.bannerWidth = t.width, t = t.height), cleverapps.resolution.setBottomBgPadding(t), this.state = BannerAd.STATE_SHOWN, console.log("showBannerAd success"), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.BANNER.SHOWN), cleverapps.playSession.set(cleverapps.EVENTS.STATS.BANNER.DAU, !0), cleverapps.platform.oneOf(Instant, Yandex, MSStart) && (this.removePaidEventInterval(), this.paidEventInterval = cleverapps.timeouts.setInterval(this.onPaidEvent.bind(this), BannerAd.PAID_EVENT_INTERVAL)), this.refreshInterval = cleverapps.timeouts.setInterval(this.refresh.bind(this), BannerAd.REFRESH_INTERVAL), this.check()) : console.log("showBannerAd error", e)
            }.bind(this)))
        }, BannerAd.prototype.hide = function (t) {
            this.processing || this.state !== BannerAd.STATE_SHOWN || (this.processing = !0, console.log("hideBannerAd loading"), cleverapps.platform.hideBannerAd(function (e) {
                this.processing = !1, e === cleverapps.CODE_SUCCEED ? ((t || cleverapps.platform.isFullScreen()) && cleverapps.resolution.setBottomBgPadding(), this.state = BannerAd.STATE_HIDDEN, console.log("hideBannerAd success"), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.BANNER.HIDDEN), this.removePaidEventInterval(), this.removeRefreshInterval()) : console.log("hideBannerAd error", e)
            }.bind(this)))
        }, BannerAd.prototype.removePaidEventInterval = function () {
            this.paidEventInterval && (cleverapps.timeouts.clearInterval(this.paidEventInterval), delete this.paidEventInterval)
        }, BannerAd.prototype.removeRefreshInterval = function () {
            this.refreshInterval && (cleverapps.timeouts.clearInterval(this.refreshInterval), delete this.refreshInterval)
        },
            BannerAd.prototype.refresh = function () {
                this.processing || (this.processing = !0, cleverapps.platform.refreshBannerAd(function (e) {
                    this.processing = !1, !e && this.canShow() || this.hide()
                }.bind(this)))
            }, BannerAd.prototype.check = function (e) {
                this.processing || (this.state === BannerAd.STATE_SHOWN ? this.canShow() || this.hide(e) : this.state === BannerAd.STATE_HIDDEN && (this.canShow() ? this.show() : e && cleverapps.resolution.setBottomBgPadding()))
            }, BannerAd.prototype.onResize = cleverapps.accumulate(300, function () {
                this.check()
            }), BannerAd.prototype.getECPM = function () {
                return cleverapps.platform.oneOf(MobileVk) && "html5_mobile" === cleverapps.MobileVkSocial.getPlatfrom() ? BannerAd.eCPM.iab_vk : BannerAd.eCPM[cleverapps.platform.source]
            }, BannerAd.prototype.onPaidEvent = function () {
                var e = this.getECPM() / 1e3;
                e && (cleverapps.playSession.inc(cleverapps.EVENTS.ADS.TYPE + "banner", e), cleverapps.playSession.inc(cleverapps.EVENTS.ADS.TYPE + "banner-impressions", 1))
            }, BannerAd.prototype.getGlobalBoundingBox = function () {
                var e,
                    t = cleverapps.UI.getBgSize(),
                    s = cleverapps.UI.getBgOffset();
                if (this.state === BannerAd.STATE_SHOWN && 0 < s) return e = this.bannerWidth ? Math.round(t.width * this.bannerWidth / cleverapps.resolution.getFrameSize().width) : t.width, cc.rect(t.width / 2 - e / 2, 0, e, s)
            }, BannerAd.STATE_HIDDEN = "hidden", BannerAd.STATE_SHOWN = "shown", BannerAd.PAID_EVENT_INTERVAL = cleverapps.parseInterval("1 minute"), BannerAd.CHECK_INTERVAL = cleverapps.parseInterval("1 minute"), BannerAd.REFRESH_INTERVAL = cleverapps.parseInterval("1 minute"), BannerAd.eCPM = {
                web_ok: 20 / cleverapps.EXCHANGE_RATES.RUB,
                mobile_ok: 30 / cleverapps.EXCHANGE_RATES.RUB,
                web_vk: 25 / cleverapps.EXCHANGE_RATES.RUB,
                mobile_vk: 25 / cleverapps.EXCHANGE_RATES.RUB,
                iab_vk: 30 / cleverapps.EXCHANGE_RATES.RUB,
                instant: 7.57,
                yandex: 30 / cleverapps.EXCHANGE_RATES.RUB,
                msstart: 5
            },
            function (e) {
                e ? (this.whenBuy = -1, this.used = 0, this.save()) : this.load()
            }),
        PackWindow = (PackManager.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PACK) || {};
            this.lastShown = e.lastShown || 0,
                this.whenBuy = e.whenBuy && e.whenBuy < Date.now() ? e.whenBuy : -1, this.used = e.used || 0
        }, PackManager.prototype.save = function (e) {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PACK, {
                lastShown: this.lastShown,
                whenBuy: this.whenBuy,
                used: this.used
            }), !1 !== e && cleverapps.synchronizer.addUpdateTask("packs")
        }, PackManager.prototype.getTimeLeft = function () {
            return Math.max(0, this.whenBuy + cleverapps.parseInterval(PackManager.NEXT_STAGE_INTERVAL) - Date.now())
        }, PackManager.prototype.get = function () {
            if (PackManager.PACKS[this.used]) return Product.Create(PackManager.PACKS[this.used])
        }, PackManager.prototype.nextPack = function () {
            this.used++;
            var e = PackManager.PACKS.length;
            this.used > e && (this.used = e), this.whenBuy = Date.now(), this.save(), cleverapps.sideBar.resetByClassName(PackIcon), clearTimeout(this.nextTimeout), this.nextTimeout = setTimeout(function () {
                cleverapps.sideBar.resetByClassName(PackIcon)
            }, this.getTimeLeft())
        }, PackManager.prototype.isAvailable = function () {
            var e = this.get();
            if (!e) return !1;
            if (
                cleverapps.flags.videoAdsMainMonetization) return !1;
            if (e.available) {
                e = e.available;
                if (!levels.user.checkAvailable(e)) return !1
            }
            return !this.getTimeLeft() && (!("merge" === cleverapps.config.type && (!cleverapps.environment.isMainScene() || cleverapps.travelBook.isExpedition())) && "woodenblock" !== cleverapps.config.name)
        }, PackManager.prototype.updateShowTime = function () {
            this.lastShown = Date.now(), this.save()
        }, PackManager.prototype.needDisplayWindow = function () {
            return !!this.isAvailable() && (!!cleverapps.sideBar.getIconByClassName(PackIcon) && (cleverapps.user.gold < 100 && this.lastShown + cleverapps.parseInterval("merge" === cleverapps.config.type ? "1 hour" : "5 minute") < Date.now() || this.lastShown + cleverapps.parseInterval("3 day") < Date.now()))
        }, PackManager.OnRestoreSuccess = function (e) {
            var t = cleverapps.packManager.get();
            t && t.itemId === e.itemId && cleverapps.packManager.nextPack()
        }, PackManager.NEXT_STAGE_INTERVAL = "1 day", cleverapps.config.debugMode && (PackManager.NEXT_STAGE_INTERVAL = "10 seconds"), PackManager.PACKS = [
            "starterPack0", "starterPack", "starterPack2"
        ], Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.packManager.get(),
                    t = (cleverapps.packManager.updateShowTime(), cleverapps.styles.PackWindow),
                    s = t.button,
                    i = (s.text = e.getCurrentPrice(), s.onPressed = function () {
                        this.buyPackProduct()
                    }.bind(this), this.generateContent(e));
                this._super({
                    name: "packwindow",
                    title: t.title ? {
                        text: e.title,
                        margin: {
                            x: 0,
                            y: t.title.margin.y
                        },
                        font: cleverapps.styles.FONTS.PACKWINDOW_TITLE_TEXT
                    } : "",
                    content: i,
                    button: s,
                    styles: t,
                    notCloseByTouchInShadow: !0,
                    closeButtonDelay: !0
                }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PACKWINDOW_OPENED), Lottery.addIcon(this.buttons), Lottery.addText(this), t.button.delay && (this.buttons.setVisible(!1), this.buttons.setScale(0), this.buttons.runAction(new cc.Sequence(new cc.DelayTime(t.button.delay), new cc.Show, new cc.ScaleTo(.2, 1))))
            },
            getPerson: function () {
                return "merge" === cleverapps.config.type && {
                    role: "king",
                    emotion: "happy"
                }
            },
            onShow: function () {
                this._super();
                var t = cleverapps.styles.PackWindow,
                    e = this.content;
                this.runAction(new cc.Sequence(new cc.DelayTime(.1), new cc.PlaySound(bundles.starter_pack.urls.starter_pack_effect))), e.rewards && e.rewards.children.forEach(function (e) {
                    e.setOpacity(0), e.runAction(new cc.Sequence(new cc.DelayTime(t.rewards.delay || 0), new cc.FadeIn(t.rewards.duration || 0)))
                }), e.discountLabel && (e.discountLabel.setOpacity(0), e.discountLabel.runAction(new cc.Sequence(new cc.DelayTime(t.discountLabel.delay || 0), new cc.FadeIn(t.discountLabel.duration || 0)))), e.title && (e.title.setOpacity(0), e.title.runAction(new cc.Sequence(new cc.DelayTime(t.Title.delay || 0), new cc.FadeIn(t.Title.duration || 0))))
            },
            generateContent: function (e) {
                var t = cleverapps.styles.PackWindow,
                    s = this.content = new cc.Node;
                return s.setAnchorPoint2(), s.setPositionRound({
                    align: "center"
                }, {
                    align: "center"
                }), t.animation && (s.animation = this.generateAnimation(e, t.animation), s.setContentSize2(s.animation.getContentSize()), s.addChild(s.animation)), t.rewards && (s.rewards = this.generateRewards(e, t.rewards), s.addChild(
                    s.rewards)), t.discountLabel && (s.discountLabel = this.generateText("-70%", t.discountLabel), s.addChild(s.discountLabel)), t.Title && (s.title = this.generateText(e.title, t.Title), s.addChild(s.title)), s
            },
            applyTextStyles: function (e, t) {
                t.fitTo && e.fitTo(t.fitTo.width, t.fitTo.height), t.lineHeight && e.setLineHeight && e.setLineHeight(t.lineHeight)
            },
            generateAnimation: function (e, t) {
                t = Object.assign({}, t.default || {}, t[e.key] || {});
                e = new cleverapps.Spine(bundles.starter_pack.jsons.pack_json);
                return e.setPositionRound({
                    align: "center",
                    dx: t.dx || 0
                }, {
                    align: "center",
                    dy: t.dy || 0
                }), t.introAnimation ? e.setAnimationAndIdleAfter(t.introAnimation, t.idleAnimation) : e.setAnimation(0, t.idleAnimation, !0), e
            },
            generateText: function (e, t) {
                e = cleverapps.UI.generateTTFText(e, cleverapps.styles.FONTS.PACKWINDOW_TEXT);
                return this.applyTextStyles(e, t), e.setAnchorPoint2(), e.setPositionRound({
                    align: "center",
                    dx: t.dx || 0
                }, {
                    align: "center",
                    dy: t.dy || 0
                }), e
            },
            generateRewards: function (e, s) {
                s = cleverapps.clone(s);

                function t(e, t) {
                    e = cleverapps.UI.generateTTFText(e, cleverapps.styles.FONTS.PACKWINDOW_LABEL_TEXT), t.rotation && e.setRotation(t.rotation), this.applyTextStyles(e, s), e.setAnchorPoint2(), e.setPositionRound(t), o.addChild(e)
                }
                var i, n = Object.assign({}, s.positions.default || {}, s.positions[e.key] || {}),
                    o = new cc.Node;
                o.setAnchorPoint2(), o.setPositionRound({
                    align: "center"
                }, {
                    align: "center"
                });
                for (i in e.reward) {
                    var a = e.reward[i],
                        r = n[i];
                    if (void 0 !== r)
                        if ("boosters" === i)
                            for (var c in a) {
                                var l = a[c],
                                    c = r[c];
                                void 0 !== c && t.call(this, "x" + l, c)
                            } else t.call(this, "unlimitedLives" === i || "worker" === i ? Product.FormatTimePeriod(a).title : "troopCards" === i ? "x" + a.amount : "x" + a, r)
                }
                return o
            },
            buyPackProduct: function () {
                cleverapps.packManager.get().buy(function (e) {
                    e && (this.closed || this.close(), cleverapps.packManager.nextPack())
                }.bind(this))
            }
        })),
        Share = (PackWindow.prototype.listBundles = function () {
            return ["starter_pack"]
        }, cleverapps.styles.COLORS = cleverapps.overrideColors(cleverapps.styles.COLORS, {
            PACKWINDOW_TITLE_SHADOW: new cc.Color(0, 0, 0, 100)
        }),
            cleverapps.styles.DECORATORS = cleverapps.overrideStyles(cleverapps.styles.DECORATORS, {
                PACKWINDOW_TITLE_STROKE: {
                    size: 1,
                    color: cleverapps.styles.COLORS.PACKWINDOW_TITLE_SHADOW
                },
                PACKWINDOW_LABEL_STROKE: {
                    color: cleverapps.styles.COLORS.BLACK,
                    size: 3
                }
            }), cleverapps.overrideFonts(cleverapps.styles.FONTS, {
                PACKWINDOW_TITLE_TEXT: {
                    size: 70,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.PACKWINDOW_TITLE_STROKE
                },
                PACKWINDOW_LABEL_TEXT: {
                    size: 60,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.PACKWINDOW_LABEL_STROKE
                },
                PACKWINDOW_TEXT: {
                    size: 80,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: {
                        color: new cc.Color(85, 1, 91),
                        size: 3
                    },
                    shadow: {
                        color: new cc.Color(85, 1, 91),
                        direction: cc.size(0, -5),
                        blur: 1
                    }
                }
            }), cleverapps.styles.PackWindow = {
                noBackground: !0,
                title: void 0,
                button: {
                    width: 300,
                    height: 100,
                    x: 0,
                    y: 50
                },
                Title: void 0,
                discountLabel: void 0,
                animation: void 0,
                rewards: void 0
            }, {
            show: function (t, s) {
                s = cleverapps.once(s || function () { }), cleverapps.social.checkConnection(function () {
                    var e = this.getData(t);
                    cleverapps.social.shareDialog(e, function (e) {
                        e === cleverapps.CODE_SUCCEED ? (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SHARE + t), this.save()) : console.log(Messages.get("Share.ShareFailed") + e), s()
                    }.bind(this))
                }.bind(this), s)
            },
            getData: function (e) {
                for (var t = cc.loader.getRes(bundles.main.jsons.vk_json), t = t[e] || t.default, s = e + "_" + cleverapps.settings.language, i = (bundles.shares.urls[s + "_1"] || (s = e + "_en"), bundles.shares.urls[s + "_1"] || (s = "default_en"), []), n = 1; n < 15; n++) {
                    var o = bundles.shares.urls[s + "_" + n];
                    if (!o) break;
                    i.push(o)
                }
                return {
                    name: Messages.get("Share." + e + ".Name"),
                    description: Messages.get("Share." + e + ".Description"),
                    picture: cleverapps.Random.mathChoose(i),
                    vk: cleverapps.Random.mathChoose(t)
                }
            },
            isEnoughTimePassed: function () {
                var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LAST_SUCCESSFUL_SHARE) || {};
                return !e.date || Date.now() - e.date >= Share.INTERVAL
            },
            isAvailable: function () {
                return !cleverapps.flags.noshares && (this.isEnoughTimePassed() && cleverapps.social.isLoggedIn() && cleverapps.user.checkAvailable(Share.AVAILABLE))
            },
            save: function () {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LAST_SUCCESSFUL_SHARE, {
                    date: Date.now()
                })
            }
        }),
        ShareCheckBox = (Share.INTERVAL = cleverapps.parseInterval(cleverapps.config.debugMode ? "3 minute" : "3 days"), Share.AVAILABLE = {
            level: .93
        }, "merge" === cleverapps.config.type && (Share.AVAILABLE = {
            level: 4
        }), cleverapps.UI.CheckBox.extend({
            ctor: function (e, t) {
                this.window = t, this.shareId = e, this._super({
                    onChange: this.onChange.bind(this),
                    isSelected: this.isWindowChecked(),
                    label: {
                        text: "Share",
                        font: this.window.withBg ? cleverapps.styles.FONTS.WINDOW_TEXT : cleverapps.styles.FONTS.WHITE_TEXT,
                        clickable: !0
                    },
                    styles: cleverapps.styles.ShareCheckBox
                }), this.updateState(), this.setCascadeOpacityEnabledRecursively(!0), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SHARE_PROPOSED + e)
            },
            onChange: function (e) {
                ShareCheckBox.UNCHECKED[this.window.name] = !e
            },
            updateState: function () {
                this.setSelected(this.isWindowChecked())
            },
            onWindowClose: function (e) {
                this.isWindowChecked() ? Share.show(this.shareId, e) : e && e()
            },
            isWindowChecked: function () {
                return !ShareCheckBox.UNCHECKED[this.window.name]
            },
            hide: function (e) {
                this.stopAllActions(), e ? this.setVisible(!1) : this.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide))
            },
            show: function () {
                this.stopAllActions(), this.setOpacity(0), this.runAction(new cc.Sequence(new cc.DelayTime(1.5), new cc.Show, new cc.FadeTo(.3, 200)))
            }
        })),
        Messages = (ShareCheckBox.UNCHECKED = {}, cleverapps.styles.ShareCheckBox = {
            margin: 15,
            padding: {
                x: 0,
                y: 0
            }
        }, {
            dictionary: void 0,
            debugTextCodes: {},
            isInitialized: function () {
                return this.dictionary
            },
            get: function (e, t) {
                if (!Messages.dictionary || !e) return e || "";
                t = t || {};
                var s = e = cleverapps.skins.getSlot("localization", e) || e;
                if (Messages.dictionary[s] ? s = Messages.dictionary[s] : 10 < s.length && cleverapps.config.debugMode && s.includes(".") && Game.currentGame && !t.ignoreWarning && console.log("Non-existent key: ", s), Array.isArray(s))
                    for (var i = 0; i < s.length; i++) s[i] = Messages.replace(s[i], t);
                else s = Messages.replace(s, t);
                return cleverapps.config.debugMode && Messages.dictionary[e] && "string" == typeof s && (Messages.debugTextCodes[s.toLowerCase().replace(/\s/g, ".")] = e), s
            },
            has: function (e) {
                return !!Messages.dictionary && Messages.dictionary[e]
            },
            replace: function (e, t) {
                if (t = t || {}, "string" == typeof e)
                    for (var s in t)
                        for (var i = t[s], n = ("string" == typeof i && (i = Messages.get(i)), "%{" + s + "}"); - 1 !== e.indexOf(n);) e = e.replace(n, i);
                return e
            },
            getLocalized: function (e, t) {
                if ("string" == typeof e) return Messages.get(e, t);
                if ("object" == typeof e && 0 < cleverapps.intersect(Object.keys(e), cleverapps.config.languages).length) return e = void 0 !== e[cleverapps.settings.language] ? e[cleverapps.settings.language] : e[cc.sys.LANGUAGE_ENGLISH], Messages.getLocalized(e, t);
                if ("object" != typeof e) return e;
                for (var s in e = cleverapps.clone(e)) e[s] = Messages.getLocalized(e[s], t);
                return e
            },
            preload: function (e, t) {
                cleverapps.bundleLoader.loadBundle("language_" + e, {
                    onSuccess: function (s) {
                        Messages.dictionary = {}, cleverapps.config.debugMode && (Messages.debugTextCodes = {},
                            Messages.debugMapping = {}), Object.keys(cleverapps.config.dictionaries).forEach(function (t) {
                                var e;
                                s.jsons[t] && (e = cc.loader.getRes(s.jsons[t]), Messages.validate(e), Object.assign(Messages.dictionary, e), cleverapps.config.debugMode && Object.keys(e).forEach(function (e) {
                                    Messages.debugMapping[e] = s.jsons[t]
                                }))
                            }), cleverapps.bundleLoader.deleteBundle("language_" + e), t()
                    },
                    blocked: !0
                })
            }
        }),
        RecursiveHasher = (Messages.validate = function (n) {
            var e = Object.keys(Messages.validateTypes).map(e => Messages.validateTypes[e]);
            Object.keys(n).forEach(function (i) {
                e.forEach(function (s) {
                    s.filter(i) && (Array.isArray(n[i]) ? n[i].forEach(function (e, t) {
                        n[i][t] = s.action(e)
                    }) : n[i] = s.action(n[i]))
                })
            })
        }, Messages.validateTypes = {
            localPushes: {
                filter: function (e) {
                    return e.includes("LocalPushes")
                },
                action: function (e) {
                    return 100 < e.length ? (cleverapps.config.debugMode && cleverapps.throwAsync("Messages.validate error " + e), e.substring(0, 100)) : e
                }
            }
        }, cleverapps.LocalizationManager = {
            run: function () {
                (void 0 === cleverapps.DataLoader.load(
                    cleverapps.DataLoaderTypes.LOCALIZATION_MANAGER) && this.hasInconsistentLanguage() || this.hasFirstInitLanguageWindow()) && this.displayLanguageWindow()
            },
            hasInconsistentLanguage: function () {
                var e = cleverapps.settings.language,
                    t = cleverapps.config.languages,
                    s = cleverapps.Settings.getDefaultLanguage();
                return e !== s && 0 <= t.indexOf(s)
            },
            hasFirstInitLanguageWindow: function () {
                return 0 === levels.user.episode && 0 === levels.user.level && cleverapps.platform.oneOf(GDCom) && "riddles" === cleverapps.config.name
            },
            displayLanguageWindow: function () {
                cleverapps.meta.displayWhenFreeFocus({
                    focus: "displayInconsistentLanguage",
                    filter: function () {
                        return "playable" !== cleverapps.config.source && !cleverapps.config.importMode && !cleverapps.config.wysiwygMode
                    },
                    action: function (e) {
                        cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LOCALIZATION_MANAGER, 1), new LanguagesWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }
        }, function (l, d) {
            "use strict";

            function n(e, t) {
                if ("object" == typeof e && (t = e, e = d), !(this instanceof n)) return new n(e, t).getResult();
                var s = e || (l && l.navigator && l.navigator.userAgent ? l.navigator.userAgent : ""),
                    i = t ? m.extend(_, t) : _;
                return this.getBrowser = function () {
                    var e = {
                        name: d,
                        version: d
                    };
                    return c.rgx.call(e, s, i.browser), e.major = m.major(e.version), e
                }, this.getCPU = function () {
                    var e = {
                        architecture: d
                    };
                    return c.rgx.call(e, s, i.cpu), e
                }, this.getDevice = function () {
                    var e = {
                        vendor: d,
                        model: d,
                        type: d
                    };
                    return c.rgx.call(e, s, i.device), e
                }, this.getEngine = function () {
                    var e = {
                        name: d,
                        version: d
                    };
                    return c.rgx.call(e, s, i.engine), e
                }, this.getOS = function () {
                    var e = {
                        name: d,
                        version: d
                    };
                    return c.rgx.call(e, s, i.os), e
                }, this.getResult = function () {
                    return {
                        ua: this.getUA(),
                        browser: this.getBrowser(),
                        engine: this.getEngine(),
                        os: this.getOS(),
                        device: this.getDevice(),
                        cpu: this.getCPU()
                    }
                }, this.getUA = function () {
                    return s
                }, this.setUA = function (e) {
                    return s = e, this
                }, this
            }
            var p, e = "model",
                t = "name",
                s = "type",
                i = "vendor",
                o = "version",
                u = "architecture",
                h = "console",
                a = "mobile",
                r = "tablet",
                g = "smarttv",
                v = "wearable",
                m = {
                    extend: function (e, t) {
                        var s, i = {};
                        for (s in e) t[s] && t[s].length % 2 == 0 ? i[s] = t[s].concat(e[s]) : i[s] = e[s];
                        return i
                    },
                    has: function (e, t) {
                        return "string" == typeof e && -1 !== t.toLowerCase().indexOf(e.toLowerCase())
                    },
                    lowerize: function (e) {
                        return e.toLowerCase()
                    },
                    major: function (e) {
                        return "string" == typeof e ? e.replace(/[^\d\.]/g, "").split(".")[0] : d
                    },
                    trim: function (e) {
                        return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, "")
                    }
                },
                c = {
                    rgx: function (p, e) {
                        for (var t, s, i, n, o, a = 0; a < e.length && !n;) {
                            for (var r = e[a], c = e[a + 1], l = t = 0; l < r.length && !n;)
                                if (n = r[l++].exec(p))
                                    for (s = 0; s < c.length; s++) o = n[++t], "object" == typeof (i = c[s]) && 0 < i.length ? 2 == i.length ? "function" == typeof i[1] ? this[i[0]] = i[1].call(this, o) : this[i[0]] = i[1] : 3 == i.length ? "function" != typeof i[1] || i[1].exec && i[1].test ? this[i[0]] = o ? o.replace(i[1], i[2]) : d : this[i[0]] = o ? i[1].call(this, o, i[2]) : d : 4 == i.length && (this[i[0]] = o ? i[3].call(this, o.replace(i[1], i[2])) : d) : this[i] = o || d;
                            a += 2
                        }
                    },
                    str: function (e, t) {
                        for (var s in t)
                            if ("object" == typeof t[s] && 0 < t[s].length) {
                                for (var i = 0; i < t[s].length; i++)
                                    if (m.has(t[s][i], e)) return "?" === s ? d : s
                            } else if (m.has(t[s], e)) return "?" === s ? d : s;
                        return e
                    }
                },
                f = {
                    browser: {
                        oldsafari: {
                            version: {
                                "1.0": "/8",
                                1.2: "/1",
                                1.3: "/3",
                                "2.0": "/412",
                                "2.0.2": "/416",
                                "2.0.3": "/417",
                                "2.0.4": "/419",
                                "?": "/"
                            }
                        }
                    },
                    device: {
                        amazon: {
                            model: {
                                "Fire Phone": ["SD", "KF"]
                            }
                        },
                        sprint: {
                            model: {
                                "Evo Shift 4G": "7373KT"
                            },
                            vendor: {
                                HTC: "APA",
                                Sprint: "Sprint"
                            }
                        }
                    },
                    os: {
                        windows: {
                            version: {
                                ME: "4.90",
                                "NT 3.11": "NT3.51",
                                "NT 4.0": "NT4.0",
                                2e3: "NT 5.0",
                                XP: ["NT 5.1", "NT 5.2"],
                                Vista: "NT 6.0",
                                7: "NT 6.1",
                                8: "NT 6.2",
                                8.1: "NT 6.3",
                                10: ["NT 6.4", "NT 10.0"],
                                RT: "ARM"
                            }
                        }
                    }
                },
                _ = {
                    browser: [
                        [/(opera\smini)\/([\w\.-]+)/i, /(opera\s[mobiletab]+).+version\/([\w\.-]+)/i, /(opera).+version\/([\w\.]+)/i, /(opera)[\/\s]+([\w\.]+)/i],
                        [t, o],
                        [/(opios)[\/\s]+([\w\.]+)/i],
                        [
                            [t, "Opera Mini"], o
                        ],
                        [/\s(opr)\/([\w\.]+)/i],
                        [
                            [t, "Opera"], o
                        ],
                        [/(kindle)\/([\w\.]+)/i, /(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i, /(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i, /(?:ms|\()(ie)\s([\w\.]+)/i, /(rekonq)\/([\w\.]+)*/i,
                            /(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\/([\w\.-]+)/i
                        ],
                        [t, o],
                        [/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],
                        [
                            [t, "IE"], o
                        ],
                        [/(edge)\/((\d+)?[\w\.]+)/i],
                        [t, o],
                        [/(yabrowser)\/([\w\.]+)/i],
                        [
                            [t, "Yandex"], o
                        ],
                        [/(puffin)\/([\w\.]+)/i],
                        [
                            [t, "Puffin"], o
                        ],
                        [/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],
                        [
                            [t, "UCBrowser"], o
                        ],
                        [/(comodo_dragon)\/([\w\.]+)/i],
                        [
                            [t, /_/g, " "], o
                        ],
                        [/(micromessenger)\/([\w\.]+)/i],
                        [
                            [t, "WeChat"], o
                        ],
                        [/(QQ)\/([\d\.]+)/i],
                        [t, o],
                        [/m?(qqbrowser)[\/\s]?([\w\.]+)/i],
                        [t, o],
                        [/xiaomi\/miuibrowser\/([\w\.]+)/i],
                        [o, [t, "MIUI Browser"]],
                        [/;fbav\/([\w\.]+);/i],
                        [o, [t, "Facebook"]],
                        [/headlesschrome(?:\/([\w\.]+)|\s)/i],
                        [o, [t, "Chrome Headless"]],
                        [/\swv\).+(chrome)\/([\w\.]+)/i],
                        [
                            [t, /(.+)/, "$1 WebView"], o
                        ],
                        [/((?:oculus|samsung)browser)\/([\w\.]+)/i],
                        [
                            [t, /(.+(?:g|us))(.+)/, "$1 $2"], o
                        ],
                        [/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],
                        [o, [t, "Android Browser"]],
                        [
                            /(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i
                        ],
                        [t, o],
                        [/(dolfin)\/([\w\.]+)/i],
                        [
                            [t, "Dolphin"], o
                        ],
                        [/((?:android.+)crmo|crios)\/([\w\.]+)/i],
                        [
                            [t, "Chrome"], o
                        ],
                        [/(coast)\/([\w\.]+)/i],
                        [
                            [t, "Opera Coast"], o
                        ],
                        [/fxios\/([\w\.-]+)/i],
                        [o, [t, "Firefox"]],
                        [/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],
                        [o, [t, "Mobile Safari"]],
                        [/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],
                        [o, t],
                        [/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],
                        [
                            [t, "GSA"], o
                        ],
                        [/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],
                        [t, [o, c.str, f.browser.oldsafari.version]],
                        [/(konqueror)\/([\w\.]+)/i, /(webkit|khtml)\/([\w\.]+)/i],
                        [t, o],
                        [/(navigator|netscape)\/([\w\.-]+)/i],
                        [
                            [t, "Netscape"], o
                        ],
                        [/(swiftfox)/i, /(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i, /(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i, /(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,
                            /(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i, /(links)\s\(([\w\.]+)/i, /(gobrowser)\/?([\w\.]+)*/i, /(ice\s?browser)\/v?([\w\._]+)/i, /(mosaic)[\/\s]([\w\.]+)/i
                        ],
                        [t, o]
                    ],
                    cpu: [
                        [/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],
                        [
                            [u, "amd64"]
                        ],
                        [/(ia32(?=;))/i],
                        [
                            [u, m.lowerize]
                        ],
                        [/((?:i[346]|x)86)[;\)]/i],
                        [
                            [u, "ia32"]
                        ],
                        [/windows\s(ce|mobile);\sppc;/i],
                        [
                            [u, "arm"]
                        ],
                        [/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],
                        [
                            [u, /ower/, "", m.lowerize]
                        ],
                        [/(sun4\w)[;\)]/i],
                        [
                            [u, "sparc"]
                        ],
                        [/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],
                        [
                            [u, m.lowerize]
                        ]
                    ],
                    device: [
                        [/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],
                        [e, i, [s, r]],
                        [/applecoremedia\/[\w\.]+ \((ipad)/],
                        [e, [i, "Apple"],
                            [s, r]
                        ],
                        [/(apple\s{0,1}tv)/i],
                        [
                            [e, "Apple TV"],
                            [i, "Apple"]
                        ],
                        [/(archos)\s(gamepad2?)/i, /(hp).+(touchpad)/i, /(hp).+(tablet)/i, /(kindle)\/([\w\.]+)/i, /\s(nook)[\w\s]+build\/(\w+)/i, /(dell)\s(strea[kpr\s\d]*[\dko])/i],
                        [i, e, [s, r]],
                        [/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],
                        [e, [i, "Amazon"],
                            [s, r]
                        ],
                        [/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],
                        [
                            [e, c.str, f.device.amazon.model],
                            [i, "Amazon"],
                            [s, a]
                        ],
                        [/\((ip[honed|\s\w*]+);.+(apple)/i],
                        [e, i, [s, a]],
                        [/\((ip[honed|\s\w*]+);/i],
                        [e, [i, "Apple"],
                            [s, a]
                        ],
                        [/(blackberry)[\s-]?(\w+)/i, /(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i, /(hp)\s([\w\s]+\w)/i, /(asus)-?(\w+)/i],
                        [i, e, [s, a]],
                        [/\(bb10;\s(\w+)/i],
                        [e, [i, "BlackBerry"],
                            [s, a]
                        ],
                        [/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],
                        [e, [i, "Asus"],
                            [s, r]
                        ],
                        [/(sony)\s(tablet\s[ps])\sbuild\//i, /(sony)?(?:sgp.+)\sbuild\//i],
                        [
                            [i, "Sony"],
                            [e, "Xperia Tablet"],
                            [s, r]
                        ],
                        [/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],
                        [e, [i, "Sony"],
                            [s, a]
                        ],
                        [/\s(ouya)\s/i, /(nintendo)\s([wids3u]+)/i],
                        [i, e, [s, h]],
                        [/android.+;\s(shield)\sbuild/i],
                        [e, [i, "Nvidia"],
                            [s, h]
                        ],
                        [/(playstation\s[34portablevi]+)/i],
                        [e, [i, "Sony"],
                            [s, h]
                        ],
                        [/(sprint\s(\w+))/i],
                        [
                            [i, c.str, f.device.sprint.vendor],
                            [e, c.str, f.device.sprint.model],
                            [s, a]
                        ],
                        [
                            /(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i
                        ],
                        [i, e, [s, r]],
                        [/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i, /(zte)-(\w+)*/i, /(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],
                        [i, [e, /_/g, " "],
                            [s, a]
                        ],
                        [/(nexus\s9)/i],
                        [e, [i, "HTC"],
                            [s, r]
                        ],
                        [/d\/huawei([\w\s-]+)[;\)]/i, /(nexus\s6p)/i],
                        [e, [i, "Huawei"],
                            [s, a]
                        ],
                        [/(microsoft);\s(lumia[\s\w]+)/i],
                        [i, e, [s, a]],
                        [/[\s\(;](xbox(?:\sone)?)[\s\);]/i],
                        [e, [i, "Microsoft"],
                            [s, h]
                        ],
                        [/(kin\.[onetw]{3})/i],
                        [
                            [e, /\./g, " "],
                            [i, "Microsoft"],
                            [s, a]
                        ],
                        [/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i, /mot[\s-]?(\w+)*/i, /(XT\d{3,4}) build\//i, /(nexus\s6)/i],
                        [e, [i, "Motorola"],
                            [s, a]
                        ],
                        [/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],
                        [e, [i, "Motorola"],
                            [s, r]
                        ],
                        [/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],
                        [
                            [i, m.trim],
                            [e, m.trim],
                            [s, g]
                        ],
                        [/hbbtv.+maple;(\d+)/i],
                        [
                            [e, /^/, "SmartTV"],
                            [i, "Samsung"],
                            [s, g]
                        ],
                        [/\(dtv[\);].+(aquos)/i],
                        [e, [i, "Sharp"],
                            [s, g]
                        ],
                        [
                            /android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i, /((SM-T\w+))/i
                        ],
                        [
                            [i, "Samsung"], e, [s, r]
                        ],
                        [/smart-tv.+(samsung)/i],
                        [i, [s, g], e],
                        [/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i, /(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i, /sec-((sgh\w+))/i],
                        [
                            [i, "Samsung"], e, [s, a]
                        ],
                        [/sie-(\w+)*/i],
                        [e, [i, "Siemens"],
                            [s, a]
                        ],
                        [/(maemo|nokia).*(n900|lumia\s\d+)/i, /(nokia)[\s_-]?([\w-]+)*/i],
                        [
                            [i, "Nokia"], e, [s, a]
                        ],
                        [/android\s3\.[\s\w;-]{10}(a\d{3})/i],
                        [e, [i, "Acer"],
                            [s, r]
                        ],
                        [/android.+([vl]k\-?\d{3})\s+build/i],
                        [e, [i, "LG"],
                            [s, r]
                        ],
                        [/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],
                        [
                            [i, "LG"], e, [s, r]
                        ],
                        [/(lg) netcast\.tv/i],
                        [i, e, [s, g]],
                        [/(nexus\s[45])/i, /lg[e;\s\/-]+(\w+)*/i, /android.+lg(\-?[\d\w]+)\s+build/i],
                        [e, [i, "LG"],
                            [s, a]
                        ],
                        [/android.+(ideatab[a-z0-9\-\s]+)/i],
                        [e, [i, "Lenovo"],
                            [s, r]
                        ],
                        [/linux;.+((jolla));/i],
                        [i, e, [s, a]],
                        [/((pebble))app\/[\d\.]+\s/i],
                        [i, e, [s, v]],
                        [/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],
                        [i, e, [s, a]],
                        [/crkey/i],
                        [
                            [e, "Chromecast"],
                            [i, "Google"]
                        ],
                        [/android.+;\s(glass)\s\d/i],
                        [e, [i,
                            "Google"
                        ],
                            [s, v]
                        ],
                        [/android.+;\s(pixel c)\s/i],
                        [e, [i, "Google"],
                            [s, r]
                        ],
                        [/android.+;\s(pixel xl|pixel)\s/i],
                        [e, [i, "Google"],
                            [s, a]
                        ],
                        [/android.+(\w+)\s+build\/hm\1/i, /android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i, /android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i, /android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+)?)\s+build/i],
                        [
                            [e, /_/g, " "],
                            [i, "Xiaomi"],
                            [s, a]
                        ],
                        [/android.+(mi[\s\-_]*(?:pad)?(?:[\s_]*[\w\s]+)?)\s+build/i],
                        [
                            [e, /_/g, " "],
                            [i, "Xiaomi"],
                            [s, r]
                        ],
                        [/android.+;\s(m[1-5]\snote)\sbuild/i],
                        [e, [i, "Meizu"],
                            [s, r]
                        ],
                        [/android.+a000(1)\s+build/i],
                        [e, [i, "OnePlus"],
                            [s, a]
                        ],
                        [/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],
                        [e, [i, "RCA"],
                            [s, r]
                        ],
                        [/android.+[;\/]\s*(Venue[\d\s]*)\s+build/i],
                        [e, [i, "Dell"],
                            [s, r]
                        ],
                        [/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],
                        [e, [i, "Verizon"],
                            [s, r]
                        ],
                        [/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],
                        [
                            [i, "Barnes & Noble"], e, [s, r]
                        ],
                        [/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],
                        [e, [i, "NuVision"],
                            [s, r]
                        ],
                        [
                            /android.+[;\/]\s*(zte)?.+(k\d{2})\s+build/i
                        ],
                        [
                            [i, "ZTE"], e, [s, r]
                        ],
                        [/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],
                        [e, [i, "Swiss"],
                            [s, a]
                        ],
                        [/android.+[;\/]\s*(zur\d{3})\s+build/i],
                        [e, [i, "Swiss"],
                            [s, r]
                        ],
                        [/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],
                        [e, [i, "Zeki"],
                            [s, r]
                        ],
                        [/(android).+[;\/]\s+([YR]\d{2}x?.*)\s+build/i, /android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(.+)\s+build/i],
                        [
                            [i, "Dragon Touch"], e, [s, r]
                        ],
                        [/android.+[;\/]\s*(NS-?.+)\s+build/i],
                        [e, [i, "Insignia"],
                            [s, r]
                        ],
                        [/android.+[;\/]\s*((NX|Next)-?.+)\s+build/i],
                        [e, [i, "NextBook"],
                            [s, r]
                        ],
                        [/android.+[;\/]\s*(Xtreme\_?)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],
                        [
                            [i, "Voice"], e, [s, a]
                        ],
                        [/android.+[;\/]\s*(LVTEL\-?)?(V1[12])\s+build/i],
                        [
                            [i, "LvTel"], e, [s, a]
                        ],
                        [/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],
                        [e, [i, "Envizen"],
                            [s, r]
                        ],
                        [/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(.*\b)\s+build/i],
                        [i, e, [s, r]],
                        [/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],
                        [e, [i, "MachSpeed"],
                            [s, r]
                        ],
                        [/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],
                        [i, e, [s, r]],
                        [/android.+[;\/]\s*TU_(1491)\s+build/i],
                        [e, [i, "Rotor"],
                            [s, r]
                        ],
                        [/android.+(KS(.+))\s+build/i],
                        [e, [i, "Amazon"],
                            [s, r]
                        ],
                        [/android.+(Gigaset)[\s\-]+(Q.+)\s+build/i],
                        [i, e, [s, r]],
                        [/\s(tablet|tab)[;\/]/i, /\s(mobile)(?:[;\/]|\ssafari)/i],
                        [
                            [s, m.lowerize], i, e
                        ],
                        [/(android.+)[;\/].+build/i],
                        [e, [i, "Generic"]]
                    ],
                    engine: [
                        [/windows.+\sedge\/([\w\.]+)/i],
                        [o, [t, "EdgeHTML"]],
                        [/(presto)\/([\w\.]+)/i, /(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i, /(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i, /(icab)[\/\s]([23]\.[\d\.]+)/i],
                        [t, o],
                        [/rv\:([\w\.]+).*(gecko)/i],
                        [o, t]
                    ],
                    os: [
                        [/microsoft\s(windows)\s(vista|xp)/i],
                        [t, o],
                        [/(windows)\snt\s6\.2;\s(arm)/i, /(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i, /(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],
                        [t, [o, c.str, f.os.windows.version]],
                        [/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],
                        [
                            [t, "Windows"],
                            [o, c.str, f.os.windows.version]
                        ],
                        [/\((bb)(10);/i],
                        [
                            [t, "BlackBerry"], o
                        ],
                        [/(blackberry)\w*\/?([\w\.]+)*/i, /(tizen)[\/\s]([\w\.]+)/i,
                            /(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i, /linux;.+(sailfish);/i
                        ],
                        [t, o],
                        [/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],
                        [
                            [t, "Symbian"], o
                        ],
                        [/\((series40);/i],
                        [t],
                        [/mozilla.+\(mobile;.+gecko.+firefox/i],
                        [
                            [t, "Firefox OS"], o
                        ],
                        [/(nintendo|playstation)\s([wids34portablevu]+)/i, /(mint)[\/\s\(]?(\w+)*/i, /(mageia|vectorlinux)[;\s]/i, /(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i, /(hurd|linux)\s?([\w\.]+)*/i, /(gnu)\s?([\w\.]+)*/i],
                        [t, o],
                        [/(cros)\s[\w]+\s([\w\.]+\w)/i],
                        [
                            [t, "Chromium OS"], o
                        ],
                        [/(sunos)\s?([\w\.]+\d)*/i],
                        [
                            [t, "Solaris"], o
                        ],
                        [/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
                        [t, o],
                        [/(haiku)\s(\w+)/i],
                        [t, o],
                        [/cfnetwork\/.+darwin/i, /ip[honead]+(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],
                        [
                            [o, /_/g, "."],
                            [t, "iOS"]
                        ],
                        [/(mac\sos\sx)\s?([\w\s\.]+\w)*/i, /(macintosh|mac(?=_powerpc)\s)/i],
                        [
                            [t, "Mac OS"],
                            [o, /_/g, "."]
                        ],
                        [
                            /((?:open)?solaris)[\/\s-]?([\w\.]+)*/i, /(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i, /(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i, /(unix)\s?([\w\.]+)*/i
                        ],
                        [t, o]
                    ]
                },
                y = (n.VERSION = "0.7.17", n.BROWSER = {
                    NAME: t,
                    MAJOR: "major",
                    VERSION: o
                }, n.CPU = {
                    ARCHITECTURE: u
                }, n.DEVICE = {
                    MODEL: e,
                    VENDOR: i,
                    TYPE: s,
                    CONSOLE: h,
                    MOBILE: a,
                    SMARTTV: g,
                    TABLET: r,
                    WEARABLE: v,
                    EMBEDDED: "embedded"
                }, n.ENGINE = {
                    NAME: t,
                    VERSION: o
                }, n.OS = {
                    NAME: t,
                    VERSION: o
                }, l.UAParser = n, l && (l.jQuery || l.Zepto));
            void 0 !== y && (p = new n, y.ua = p.getResult(), y.ua.get = function () {
                return p.getUA()
            }, y.ua.set = function (e) {
                p.setUA(e);
                var t, s = p.getResult();
                for (t in s) y.ua[t] = s[t]
            })
        }("object" == typeof window ? window : this), function (e, t) {
            "function" == typeof define && define.amd ? define([], t) : "object" == typeof exports ? module.exports = t() : e.SuperGif = t()
        }(this, function () {
            function ne(e) {
                this.data = e, this.len = this.data.length, this.pos = 0, this.readByte = function () {
                    if (this.pos >= this.data.length) throw new Error("Attempted to read past end of stream.");
                    return e instanceof Uint8Array ? e[this.pos++] : 255 & e.charCodeAt(this.pos++)
                }, this.readBytes = function (e) {
                    for (var t = [], s = 0; s < e; s++) t.push(this.readByte());
                    return t
                }, this.read = function (e) {
                    for (var t = "", s = 0; s < e; s++) t += String.fromCharCode(this.readByte());
                    return t
                }, this.readUnsigned = function () {
                    var e = this.readBytes(2);
                    return (e[1] << 8) + e[0]
                }
            }

            function oe(o, a) {
                function r() {
                    for (var e, t = ""; e = o.readByte(), t += o.read(e), 0 !== e;);
                    return t
                }
                a = a || {};
                var i = function (e) {
                    for (var t = [], s = 0; s < e; s++) t.push(o.readBytes(3));
                    return t
                },
                    t = function (e) {
                        function t(e) {
                            var t;
                            o.readByte(), e.identifier = o.read(8), e.authCode = o.read(3), "NETSCAPE" === e.identifier ? (t = e, o.readByte(), t.unknown = o.readByte(), t.iterations = o.readUnsigned(), t.terminator = o.readByte(), a.app && a.app.NETSCAPE && a.app.NETSCAPE(t)) : ((t = e).appData = r(), a.app && a.app[t.identifier] && a.app[t.identifier](t))
                        }
                        var s, i;
                        switch (e.label = o.readByte(), e.label) {
                            case 249:
                                e.extType = "gce", n = e, o.readByte(), i = p(o.readByte()), n.reserved = i.splice(0, 3), n.disposalMethod = l(i.splice(0, 3)),
                                    n.userInput = i.shift(), n.transparencyGiven = i.shift(), n.delayTime = o.readUnsigned(), n.transparencyIndex = o.readByte(), n.terminator = o.readByte(), a.gce && a.gce(n);
                                break;
                            case 254:
                                e.extType = "com", (i = e).comment = r(), a.com && a.com(i);
                                break;
                            case 1:
                                e.extType = "pte";
                                var n = e;
                                o.readByte(), n.ptHeader = o.readBytes(12), n.ptData = r(), a.pte && a.pte(n);
                                break;
                            case 255:
                                e.extType = "app", t(e);
                                break;
                            default:
                                e.extType = "unknown", (s = e).data = r(), a.unknown && a.unknown(s)
                        }
                    },
                    s = function (e) {
                        function t(e, t) {
                            for (var s = new Array(e.length), i = e.length / t, n = [0, 4, 2, 1], o = [8, 8, 4, 2], a = 0, r = 0; r < 4; r++)
                                for (var c = n[r]; c < i; c += o[r]) {
                                    l = void 0;
                                    var p = c,
                                        l = a;
                                    l = e.slice(l * t, (l + 1) * t), s.splice.apply(s, [p * t, t].concat(l)), a++
                                }
                            return s
                        }
                        e.leftPos = o.readUnsigned(), e.topPos = o.readUnsigned(), e.width = o.readUnsigned(), e.height = o.readUnsigned();
                        var s = p(o.readByte()),
                            s = (e.lctFlag = s.shift(), e.interlaced = s.shift(), e.sorted = s.shift(), e.reserved = s.splice(0, 2), e.lctSize = l(s.splice(0, 3)), e.lctFlag && (e.lct = i(1 << e.lctSize + 1)), e.lzwMinCodeSize = o.readByte(), r());
                        e.pixels = d(
                            e.lzwMinCodeSize, s), e.interlaced && (e.pixels = t(e.pixels, e.width)), a.img && a.img(e)
                    },
                    n = function () {
                        var e = {};
                        switch (e.sentinel = o.readByte(), String.fromCharCode(e.sentinel)) {
                            case "!":
                                e.type = "ext", t(e);
                                break;
                            case ",":
                                e.type = "img", s(e);
                                break;
                            case ";":
                                e.type = "eof", a.eof && a.eof(e);
                                break;
                            default:
                                throw new Error("Unknown block: 0x" + e.sentinel.toString(16))
                        }
                        "eof" !== e.type && setTimeout(n, 0)
                    },
                    e = {};
                if (e.sig = o.read(3), e.ver = o.read(3), "GIF" !== e.sig) throw new Error("Not a GIF file.");
                e.width = o.readUnsigned(), e.height = o.readUnsigned();
                var c = p(o.readByte());
                e.gctFlag = c.shift(), e.colorRes = l(c.splice(0, 3)), e.sorted = c.shift(), e.gctSize = l(c.splice(0, 3)), e.bgColor = o.readByte(), e.pixelAspectRatio = o.readByte(), e.gctFlag && (e.gct = i(1 << e.gctSize + 1)), a.hdr && a.hdr(e), setTimeout(n, 0)
            }
            var l = function (e) {
                return e.reduce(function (e, t) {
                    return 2 * e + t
                }, 0)
            },
                p = function (e) {
                    for (var t = [], s = 7; 0 <= s; s--) t.push(!!(e & 1 << s));
                    return t
                },
                d = function (e, p) {
                    for (var t, s, i = 0, n = [], o = 1 << e, a = 1 + o, r = e + 1, c = []; ;)
                        if (s = t, (t = function (e) {
                            for (var t = 0, s = 0; s < e; s++) p.charCodeAt(i >> 3) & 1 << (7 & i) && (t |= 1 << s), i++;
                            return t
                        }(r)) !== o) {
                            if (t === a) break;
                            if (t < c.length) s !== o && c.push(c[s].concat(c[t][0]));
                            else {
                                if (t !== c.length) throw new Error("Invalid LZW code.");
                                c.push(c[s].concat(c[s][0]))
                            }
                            n.push.apply(n, c[t]), c.length === 1 << r && r < 12 && r++
                        } else {
                            l = void 0, c = [], r = e + 1;
                            for (var l = 0; l < o; l++) c[l] = [l];
                            c[o] = [], c[a] = null
                        } return n
                };
            return function (e) {
                var i, u, n, a = {
                    vp_l: 0,
                    vp_t: 0,
                    vp_w: null,
                    vp_h: null,
                    c_w: null,
                    c_h: null
                };
                for (i in e) a[i] = e[i];
                a.vp_w && a.vp_h && (a.is_vp = !0);

                function h() {
                    N = R, o = R = O = P = null
                }

                function g() {
                    try {
                        oe(u, te)
                    } catch (e) {
                        m("parse")
                    }
                }

                function v(e, t) {
                    l.width = e * d(), l.height = t * d(), $.style.minWidth = e * d() + "px", ee.width = e, ee.height = t, ee.style.width = e + "px", ee.style.height = t + "px", ee.getContext("2d").setTransform(1, 0, 0, 1, 0, 0)
                }

                function m(e) {
                    C = e, n = {
                        width: s.width,
                        height: s.height
                    }, c = [], M = []
                }

                function f() {
                    var e;
                    o && (c.push({
                        data: o.getImageData(0, 0, n.width, n.height),
                        delay: O
                    }), B.push({
                        x: 0,
                        y: 0
                    }), (e = new Image).addEventListener("load", function () {
                        M.push(e)
                    }, !1), e.src = o.canvas.toDataURL())
                }
                var _, y, T, S, t, b, w, E, A, C = null,
                    I = !1,
                    P = null,
                    O = null,
                    R = null,
                    L = null,
                    N = null,
                    o = null,
                    r = null,
                    k = !0,
                    D = !1,
                    c = [],
                    M = [],
                    B = [],
                    s = a.gif,
                    x = (s || ((_ = new Image).crossOrigin = "Anonymous", _.src = "", s = _), void 0 === a.auto_play && (a.auto_play = !s.getAttribute("rel:auto_play") || "1" == s.getAttribute("rel:auto_play")), a.hasOwnProperty("on_end") ? a.on_end : null),
                    F = a.hasOwnProperty("loop_delay") ? a.loop_delay : 0,
                    U = a.hasOwnProperty("loop_mode") ? a.loop_mode : "auto",
                    W = !a.hasOwnProperty("draw_while_loading") || a.draw_while_loading,
                    G = !!W && (!a.hasOwnProperty("show_progress_bar") || a.show_progress_bar),
                    V = a.hasOwnProperty("progressbar_height") ? a.progressbar_height : 25,
                    H = a.hasOwnProperty("progressbar_background_color") ? a.progressbar_background_color : "rgba(255,255,255,0.4)",
                    z = a.hasOwnProperty("progressbar_foreground_color") ? a.progressbar_foreground_color : "rgba(255,0,22,.8)",
                    j = function (e, t, s) {
                        var i, n, o;
                        s && G && (s = V, a.is_vp ? o = D ? (n = (a.vp_t + a.vp_h - s) / d(), s /= d(), i = a.vp_l / d() + e / t * (a.vp_w / d()), l.width / d()) : (n = a.vp_t + a.vp_h - s, i = a.vp_l + e / t * a.vp_w,
                            l.width) : (n = (l.height - s) / (D ? d() : 1), i = e / t * l.width / (D ? d() : 1), o = l.width / (D ? d() : 1), s /= D ? d() : 1), p.fillStyle = H, p.fillRect(i, n, o - i, s), p.fillStyle = z, p.fillRect(0, n, i, s))
                    },
                    Y = (t = -1, w = function () {
                        return (t + 1 + c.length) % c.length
                    }, y = !(E = function (e) {
                        t += e, X()
                    }), {
                        init: function () {
                            C || (a.c_w && a.c_h || p.scale(d(), d()), a.auto_play ? A() : (t = 0, X()))
                        },
                        step: A = function () {
                            y || setTimeout(S, 0)
                        },
                        play: function () {
                            k = !0, A()
                        },
                        pause: function () {
                            k = !1
                        },
                        getFrames: function () {
                            return M
                        },
                        playing: k,
                        move_relative: E,
                        current_frame: function () {
                            return t
                        },
                        length: function () {
                            return c.length
                        },
                        move_to: function (e) {
                            t = e, X()
                        }
                    });

                function X() {
                    var e;
                    (t = parseInt(t, 10)) > c.length - 1 && (t = 0), e = B[t = t < 0 ? 0 : t], ee.getContext("2d").putImageData(c[t].data, e.x, e.y), p.globalCompositeOperation = "copy", p.drawImage(ee, 0, 0)
                }

                function K(e) {
                    j(u.pos, u.data.length, e)
                }

                function q() { }

                function Z(t, s) {
                    return function (e) {
                        t(e), K(s)
                    }
                }

                function J() {
                    var e = s.parentNode,
                        t = (e || (e = document.createElement("div")).appendChild(s), document.createElement("div"));
                    l = document.createElement("canvas"),
                        p = l.getContext("2d"), $ = document.createElement("div"), ee = document.createElement("canvas"), t.width = l.width = s.width, t.height = l.height = s.height, $.style.minWidth = s.width + "px", t.className = "jsgif", $.className = "jsgif_toolbar", t.appendChild(l), t.appendChild($), e.insertBefore(t, s), e.removeChild(s), a.c_w && a.c_h && v(a.c_w, a.c_h), se = !0
                }

                function Q(e) {
                    return !I && (ie = e || !1, I = !0, c = [], M = [], h(), !(r = o = N = L = null))
                }
                var l, p, $, ee, te = {
                    hdr: Z(function (e) {
                        v((n = e).width, n.height)
                    }),
                    gce: Z(function (e) {
                        f(), h(), P = e.transparencyGiven ? e.transparencyIndex : null, O = e.delayTime, R = e.disposalMethod
                    }),
                    com: Z(q),
                    app: {
                        NETSCAPE: Z(q)
                    },
                    img: Z(function (e) {
                        o = o || ee.getContext("2d");
                        var t = c.length,
                            s = e.lctFlag ? e.lct : n.gct,
                            i = (0 < t && (3 === N ? null !== L ? o.putImageData(c[L].data, 0, 0) : o.clearRect(r.leftPos, r.topPos, r.width, r.height) : L = t - 1, 2 === N && o.clearRect(r.leftPos, r.topPos, r.width, r.height)), o.getImageData(e.leftPos, e.topPos, e.width, e.height));
                        e.pixels.forEach(function (e, t) {
                            e !== P && (i.data[4 * t + 0] = s[e][0], i.data[4 * t + 1] = s[e][1], i.data[4 * t + 2] = s[e][2],
                                i.data[4 * t + 3] = 255)
                        }), o.putImageData(i, e.leftPos, e.topPos), D || (p.scale(d(), d()), D = !0), W && (p.drawImage(ee, 0, 0), W = a.auto_play), r = e
                    }, !(b = 0)),
                    eof: function (e) {
                        f(), K(!1), a.c_w && a.c_h || (l.width = n.width * d(), l.height = n.height * d()), Y.init(), I = !1, ie && ie(s)
                    }
                },
                    d = function () {
                        var e = a.max_width && n && n.width > a.max_width ? a.max_width / n.width : 1;
                        return e
                    },
                    se = !(S = function () {
                        var e;
                        (y = k) && (E(1), e = 10 * c[t].delay || 100, 0 === w() ? (e += F, setTimeout(T, e)) : setTimeout(S, e))
                    }),
                    ie = !(T = function () {
                        null !== x && x(s), b++, !1 !== U || b < 0 ? S() : k = y = !1
                    });
                return {
                    play: Y.play,
                    pause: Y.pause,
                    getFrames: Y.getFrames,
                    move_relative: Y.move_relative,
                    move_to: Y.move_to,
                    get_playing: function () {
                        return k
                    },
                    get_canvas: function () {
                        return l
                    },
                    get_canvas_scale: function () {
                        return d()
                    },
                    get_loading: function () {
                        return I
                    },
                    get_auto_play: function () {
                        return a.auto_play
                    },
                    get_length: function () {
                        return Y.length()
                    },
                    get_current_frame: function () {
                        return Y.current_frame()
                    },
                    load_url: function (e, t) {
                        Q(t) && ((t = new XMLHttpRequest).open("GET", e, !0), "overrideMimeType" in t ? t.overrideMimeType(
                            "text/plain; charset=x-user-defined") : "responseType" in t ? t.responseType = "arraybuffer" : t.setRequestHeader("Accept-Charset", "x-user-defined"), t.onloadstart = function () {
                                se || J()
                            }, t.onload = function (e) {
                                200 != this.status && m("xhr - response"), "response" in this || (this.response = new VBArray(this.responseText).toArray().map(String.fromCharCode).join(""));
                                var t = this.response;
                                0 < t.toString().indexOf("ArrayBuffer") && (t = new Uint8Array(t)), u = new ne(t), setTimeout(g, 0)
                            }, t.onprogress = function (e) {
                                e.lengthComputable && j(e.loaded, e.total, !0)
                            }, t.onerror = function () {
                                m("xhr")
                            }, t.send())
                    },
                    load: function (e) {
                        this.load_url(s.getAttribute("rel:animated_src") || s.src, e)
                    },
                    load_raw: function (e, t) {
                        Q(t) && (se || J(), u = new ne(e), setTimeout(g, 0))
                    },
                    set_frame_offset: function (e, t) {
                        B[e] ? (void 0 !== t.x && (B[e].x = t.x), void 0 !== t.y && (B[e].y = t.y)) : B[e] = t
                    }
                }
            }
        }), function () {
            function i(e, t) {
                var s = this instanceof i ? this : n;
                return s.reset(t), "string" == typeof e && 0 < e.length && s.hash(e), s !== this ? s : void 0
            }
            var n;
            i.prototype.hash = function (e) {
                var t, s, i, n,
                    o = e.length;
                switch (this.len += o, s = this.k1, this.rem) {
                    case i = 0:
                        s ^= i < o ? 65535 & e.charCodeAt(i++) : 0;
                    case 1:
                        s ^= i < o ? (65535 & e.charCodeAt(i++)) << 8 : 0;
                    case 2:
                        s ^= i < o ? (65535 & e.charCodeAt(i++)) << 16 : 0;
                    case 3:
                        s = (s ^= i < o ? (255 & e.charCodeAt(i)) << 24 : 0) ^ (i < o ? (65280 & e.charCodeAt(i++)) >> 8 : 0)
                }
                if (this.rem = 3 & o + this.rem, 0 < (o -= this.rem)) {
                    for (t = this.h1; t = 4294967295 & 5 * (t = (t ^= s = 4294967295 & 13715 * (s = (s = 4294967295 & 11601 * s + 3432906752 * (65535 & s)) << 15 | s >>> 17) + 461832192 * (65535 & s)) << 13 | t >>> 19) + 3864292196, !(o <= i);) s = 65535 & e.charCodeAt(i++) ^ (65535 & e.charCodeAt(i++)) << 8 ^ (65535 & e.charCodeAt(i++)) << 16, s ^= (255 & (n = e.charCodeAt(i++))) << 24 ^ (65280 & n) >> 8;
                    switch (s = 0, this.rem) {
                        case 3:
                            s ^= (65535 & e.charCodeAt(i + 2)) << 16;
                        case 2:
                            s ^= (65535 & e.charCodeAt(i + 1)) << 8;
                        case 1:
                            s ^= 65535 & e.charCodeAt(i)
                    }
                    this.h1 = t
                }
                return this.k1 = s, this
            }, i.prototype.result = function () {
                var e = this.k1,
                    t = this.h1;
                return 0 < e && (t ^= 4294967295 & 13715 * (e = (e = 4294967295 & 11601 * e + 3432906752 * (65535 & e)) << 15 | e >>> 17) + 461832192 * (65535 & e)), t = 4294967295 & 51819 * (t = (t ^= this.len) ^ t >>> 16) + 2246770688 * (
                    65535 & t), t = 4294967295 & 44597 * (t ^= t >>> 13) + 3266445312 * (65535 & t), (t ^= t >>> 16) >>> 0
            }, i.prototype.reset = function (e) {
                return this.h1 = "number" == typeof e ? e : 0, this.rem = this.k1 = this.len = 0, this
            }, n = new i, this.MurmurHash3 = i
        }(), function (t, s, i) {
            if ("object" == typeof t) {
                if (void 0 === i && (i = new MurmurHash3, s = cleverapps.createSet(s)), Array.isArray(t)) {
                    i.hash("" + t.length);
                    for (var e = 0; e < t.length; e++) RecursiveHasher(t[e], s, i)
                } else Object.keys(t).sort().forEach(function (e) {
                    !s[e] && t[e] && (i.hash(e), RecursiveHasher(t[e], s, i))
                });
                return i.result()
            }
            "number" == typeof t ? i.hash("" + t) : i.hash(t)
        }),
        Version = {
            compare: function (e, t) {
                if (!e || !t) return !!e - !!t;
                for (var s = e.split("."), i = t.split("."), n = 0; n < Math.min(s.length, i.length); n++) {
                    var o = parseInt(s[n]),
                        a = parseInt(i[n]);
                    if (o !== a) return o - a
                }
                return s.length - i.length
            },
            isVersion: function (e) {
                if ("string" != typeof e) return !1;
                e = e.split(".");
                return 3 === e.length && e.every(function (e) {
                    return /^\d+$/.test(e)
                })
            },
            isMinorEquals: function (e, t) {
                return e.split(".").slice(0, 2).join(".") === t.split(".").slice(0, 2).join(".")
            },
            incPatch: function (e) {
                e = e.split(".");
                return e[2] = +e[2] + 1, e.join(".")
            },
            incMinor: function (e) {
                e = e.split(".");
                return e[1] = +e[1] + 1, e[2] = 0, e.join(".")
            },
            getMinor: function (e) {
                return +e.split(".")[1]
            },
            getPatch: function (e) {
                return +e.split(".")[2]
            }
        },
        BaseBooster = ("undefined" == typeof cc && (module.exports = Version), function (e) {
            cleverapps.EventEmitter.call(this), this.id = e;
            e = cleverapps.Boosters.CONFIG[e];
            this.price = e.price, this.force = e.force, this.available = e.available, this.icon = e.icon, this.limit = e.limit, this.executeEffect = e.executeEffect, this.disableForceOnInactive = e.disableForceOnInactive
        }),
        FieldBooster = (BaseBooster.prototype = Object.create(cleverapps.EventEmitter.prototype), (BaseBooster.prototype.constructor = BaseBooster).prototype.onGameStarted = function () { }, BaseBooster.prototype.isDisabled = function () {
            return !levels.user.checkAvailable(this.available)
        }, BaseBooster.prototype.getPrice = function () {
            if (this.price) return cleverapps.config.soft ? {
                soft: !0,
                amount: this.price.soft
            } : {
                amount: this.price.hard
            }
        }, BaseBooster.prototype.getAmount = function () {
            return cleverapps.boosters.getAmount(this.id)
        }, BaseBooster.prototype.setAmount = function (e) {
            return cleverapps.boosters.setAmount(this.id, e)
        }, BaseBooster.prototype.buy = function () {
            var e = cleverapps.EVENTS.SPENT.BOOSTER,
                t = this.getPrice(),
                e = t.soft ? cleverapps.user.spendSoft(e, t.amount) : cleverapps.user.spendHard(e, t.amount);
            return e && cleverapps.boosters.add(this.id, 1), e
        }, BaseBooster.prototype.use = function () {
            cleverapps.boosters.has(this.id) && (cleverapps.boosters.take(this.id), this.logUseEvents(), this.onUsed())
        }, BaseBooster.prototype.logUseEvents = function () {
            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HINT_USED, {
                value: this.getPrice().amount
            }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTERS_EXECUTE + "_" + this.id)
        }, BaseBooster.prototype.onUsed = function () {
            cleverapps.eventBus.trigger("taskEvent", DailyTasks.USE_BOOSTER)
        }, BaseBooster.prototype.execute = function () {
            this.use()
        }, BaseBooster.prototype.canExecute = function () {
            return cleverapps.boosters.has(this.id)
        }, BaseBooster.prototype.isAdsAvailable = function () {
            var e = this.getPrice().amount,
                e = cleverapps.config.soft ? cleverapps.user.canTakeSoft(e) : cleverapps.user.canTakeHard(e);
            return cleverapps.adsLimits.state(this.limit) === AdsLimits.STATE_READY && !e
        }, BaseBooster.prototype.isForceAvailable = function () {
            return this.isAvailable() && !cleverapps.forces.isShown(this.force.id)
        }, BaseBooster.prototype.isAvailable = function () {
            return !cleverapps.gameModes.noBoosters && levels.user.checkAvailable(this.available)
        }, BaseBooster.prototype.getState = function () {
            return this.canExecute() ? BaseBooster.AMOUNT_STATE : this.isAdsAvailable() ? BaseBooster.ADS_STATE : BaseBooster.PRICE_STATE
        }, BaseBooster.AMOUNT_STATE = 0, BaseBooster.ADS_STATE = 1, BaseBooster.PRICE_STATE = 2, function (e) {
            BaseBooster.call(this, e), this.hoverCell = void 0;
            e = cleverapps.Boosters.CONFIG[e];
            this.icon = e.icon, this.icon_moving = e.icon_moving, this.icon_active = e.icon_active, this.onExecuteListener = function (e) { },
                this.onHurtCellsListener = function (e) { }, this.onActivateListener = function () { }, this.onDeactivateListener = function () { }, this.onStopListener = function () { }, this.onGetView = function () { }
        }),
        CellBooster = (FieldBooster.prototype = Object.create(BaseBooster.prototype), (FieldBooster.prototype.constructor = FieldBooster).prototype.stop = function () {
            this.onStopListener()
        }, FieldBooster.prototype.deactivate = function () {
            this.onDeactivateListener(), this.onFieldTouchMoved(void 0)
        }, FieldBooster.prototype.execute = function (e) {
            var t;
            e = e && this.isAllowedTarget(e) ? e : void 0, this.onExecuteListener(e), e && (Game.currentGame && Game.currentGame.field.boosterAdvice && Game.currentGame.field.boosterAdvice.disable(), t = (e = this.listAffected(e)).cells, e = e.tiles, 0 < t.length && (this.hurtCells(t), this.hurtTiles(e), this.use(), Game.currentGame && Game.currentGame.onExecuteBooster()))
        }, FieldBooster.prototype.hurtCells = function (t) {
            t.forEach(function (e) {
                e.willBurn = !0, e.onBeforeHurtViaBooster(t)
            }), this.onHurtCellsListener(t), delete this.hoverCell
        },
            FieldBooster.prototype.hurtCell = function (e, t, s) {
                e.alive && e.hover(!1), e.hurt({
                    id: t,
                    groupSize: s,
                    boosterId: this.id
                })
            }, FieldBooster.prototype.hurtTiles = function (e) {
                e.forEach(function (e) {
                    e.hurtViaBooster(this.id)
                }.bind(this))
            }, FieldBooster.prototype.onFieldTouchStarted = function (e) {
                this.execute(e)
            }, FieldBooster.prototype.onFieldTouchMoved = function (e) {
                var t, s;
                this.hoverCell !== e && (t = [], s = [], this.hoverCell && (t = this.listAffected(this.hoverCell).cells, this.hoverCell = void 0), e && this.isAllowedTarget(e) && (this.hoverCell = e, s = this.listAffected(e).cells), cleverapps.substract(t, s, e = function (e) {
                    return e.x + "_" + e.y
                }).forEach(function (e) {
                    e.hover(!1)
                }), cleverapps.substract(s, t, e).forEach(function (e) {
                    e.hover(!0)
                }))
            }, FieldBooster.prototype.isAllowedTarget = function (e) {
                return e.hurtable
            }, FieldBooster.prototype.onFieldTouchEnded = function (e) {
                e && this.execute(e)
            }, FieldBooster.prototype.getViewClass = function () {
                return FieldBoosterView
            },
            function (e) {
                FieldBooster.call(this, e)
            }),
        LineBooster = (
            CellBooster.prototype = Object.create(FieldBooster.prototype), (CellBooster.prototype.constructor = CellBooster).prototype.listAffected = function (e) {
                this.targetCell = e;
                var t = [];
                return Game.currentGame.field.floor[e.y][e.x] && t.push(Game.currentGame.field.floor[e.y][e.x]), {
                    cells: [e],
                    tiles: t
                }
            }, CellBooster.prototype.getViewClass = function () {
                return CellBoosterView
            }, CellBooster.prototype.hurtCells = function (s) {
                FieldBooster.prototype.hurtCells.call(this, s), Game.counter.fieldCounter.setTimeout(function () {
                    s.forEach(function (e, t) {
                        this.hurtCell(e, t, s.length)
                    }.bind(this)), Game.currentGame && Game.currentGame.shakeField({
                        power: .5
                    })
                }.bind(this), CellBooster.HURT_DELAY)
            }, CellBooster.HURT_DELAY = 500, -1 !== ["runes", "adventure"].indexOf(cleverapps.config.name) && (CellBooster.HURT_DELAY = 1e3),
            function (e) {
                FieldBooster.call(this, e)
            }),
        ColorBooster = (LineBooster.prototype = Object.create(FieldBooster.prototype), (LineBooster.prototype.constructor = LineBooster).prototype.listAffected = function (e) {
            var t = [],
                s = [],
                i = 0,
                n = Field.SIZE,
                o = 1;
            LineBooster.DIRECTION === LineBooster.DIRECTIONS.DOWN_UP && (i = Field.SIZE - 1, o = n = -1);
            for (var a = i; a !== n; a += o) Game.currentGame.field.cells[a][e.x] && Game.currentGame.field.cells[a][e.x].hurtable && (t.push(Game.currentGame.field.cells[a][e.x]), Game.currentGame.field.floor[a][e.x] && s.push(Game.currentGame.field.floor[a][e.x]));
            return {
                cells: t,
                tiles: s
            }
        }, LineBooster.prototype.isAllowedTarget = function (e) {
            if (!e) return !1;
            var t = Game.currentGame.tutorial;
            return !(t && !t.finished && !t.existInControll(e.x, e.y))
        }, LineBooster.prototype.getViewClass = function () {
            return LineBoosterView
        }, LineBooster.prototype.hurtCells = function (i) {
            FieldBooster.prototype.hurtCells.call(this, i), i.forEach(function (e, t) {
                var s = LineBooster.HURT_DELAY + 100 * Math.abs(e.y - i[0].y);
                Game.counter.fieldCounter.setTimeout(function () {
                    this.hurtCell(e, 0, 1), Game.currentGame && t === i.length - 1 && Game.currentGame.shakeField()
                }.bind(this), s)
            }.bind(this))
        }, LineBooster.DIRECTIONS = {
            UP_DOWN: 0,
            DOWN_UP: 1
        }, LineBooster.DIRECTION = LineBooster.DIRECTIONS.UP_DOWN,
            "heroes" === cleverapps.config.name && (LineBooster.DIRECTION = LineBooster.DIRECTIONS.DOWN_UP), LineBooster.HURT_DELAY = 0, "heroes" === cleverapps.config.name && (LineBooster.HURT_DELAY = 400), "runes" === cleverapps.config.name && (LineBooster.HURT_DELAY = 600),
            function (e) {
                FieldBooster.call(this, e)
            }),
        Booster = (ColorBooster.prototype = Object.create(FieldBooster.prototype), (ColorBooster.prototype.constructor = ColorBooster).prototype.listAffected = function (e) {
            for (var t = [], s = [], i = (this.targetCell = e).getColor(), n = 0; n < Field.SIZE; n++)
                for (var o = 0; o < Field.SIZE; o++) Game.currentGame.field.cells[n][o] && Game.currentGame.field.cells[n][o].hurtable && (Game.currentGame.field.cells[n][o].getColor() !== i || void 0 === i && Game.currentGame.field.cells[n][o] !== e || (t.push(Game.currentGame.field.cells[n][o]), Game.currentGame.field.floor[n][o] && s.push(Game.currentGame.field.floor[n][o])));
            return {
                cells: t,
                tiles: s
            }
        }, ColorBooster.prototype.getViewClass = function () {
            return ColorBoosterView
        }, ColorBooster.prototype.hurtCells = function (s) {
            FieldBooster.prototype.hurtCells.call(this, s), Game.counter.fieldCounter.setTimeout(function () {
                var e = [];
                Array.prototype.push.apply(e, s), cleverapps.shuffle(e).forEach(function (e) {
                    e.animate(BaseCell.ANIMATION_MULTI_COLOR_SELECT)
                }), s.forEach(function (e, t) {
                    this.hurtCell(e, t, s.length)
                }.bind(this)), Game.currentGame && Game.currentGame.shakeField()
            }.bind(this), ColorBooster.HURT_DELAY)
        }, ColorBooster.HURT_DELAY = 900, "adventure" === cleverapps.config.name && (ColorBooster.HURT_DELAY = 1400), function (e) {
            BaseBooster.call(this, e), this.onForceListener = function () { }, this.onToggleArrowListener = function () { }, this.onToggleTintListener = function () { }, this.onExecuteListener = function () { }, this.onDisableListener = function () { }, this.onEnableListener = function () { }, this.alarm = new Alarm, this.alarm.onChangeListeners.tint = this.toggleTint.bind(this), this.alarm.onChangeListeners.arrow = this.toggleArrow.bind(this), cleverapps.eventBus.on("changeFocus", function () {
                this.alarm.isOn() && this.stopHint()
            }.bind(this))
        }),
        HintBooster = (
            Booster.prototype = Object.create(BaseBooster.prototype), (Booster.prototype.constructor = Booster).prototype.onGameStarted = function () {
                !this.disableForceOnInactive && this.isForceAvailable() && Game.currentGame.userStatus.on("inactive_long", this.showForce.bind(this))
            }, Booster.prototype.clear = function () {
                this.alarm.clear()
            }, Booster.prototype.onUserActive = function () {
                this.stopHint()
            }, Booster.prototype.clearAlarmTimeout = function () {
                this.alarmTimeout && (clearTimeout(this.alarmTimeout), this.alarmTimeout = void 0)
            }, Booster.prototype.startHint = function (e) {
                e && (this.manualAlarm = !0), this.alarm.start("hint", 1), this.clearAlarmTimeout()
            }, Booster.prototype.stopHint = function () {
                this.manualAlarm = !1, this.alarm.stop("hint"), this.clearAlarmTimeout()
            }, Booster.prototype.onUserInactive = function () {
                this.manualAlarm || cleverapps.meta.isFocused() || (this.startHint(), this.alarmTimeout = setTimeout(this.stopHint.bind(this), cleverapps.parseInterval(Booster.StopAlarmTimeout)))
            }, Booster.prototype.toggleTint = function () {
                this.onToggleTintListener(this.alarm.isOn())
            }, Booster.prototype.toggleArrow = function () {
                this.onToggleArrowListener(this.alarm.isOn())
            }, Booster.prototype.showForce = function () {
                return this.onForceListener()
            }, Booster.prototype.onPressed = function (e, t) {
                Game.currentGame.outcome === GameBase.OUTCOME_UNKNOWN && !Game.currentGame.counter.isActive() && (!Game.currentGame.open || Game.currentGame.open.isStable()) ? (t && (t = this.getAmount() + 1, this.setAmount(t)), this.canExecute() ? (this.execute(), e()) : this.isAdsAvailable() ? cleverapps.rewardedAdsManager.loadAndPlay({
                    type: RewardedAdsManager.REWARDED,
                    adLimit: this.limit,
                    callback: function () {
                        cleverapps.adsLimits.watch(this.limit), this.execute(), e()
                    }.bind(this),
                    onCancelCallback: function () {
                        e()
                    }
                }) : this.buy() ? (this.execute(), e()) : cleverapps.windows.isActive() ? cleverapps.meta.onceNoWindowsListener = e : e()) : e()
            }, Booster.prototype.execute = function (e) {
                this.onExecute(e), this.use(), this.onExecuteListener()
            }, Booster.StopAlarmTimeout = "5 seconds",
            function (e) {
                Booster.call(this, e)
            }),
        WildcardBooster = (HintBooster.prototype = Object.create(Booster.prototype), (HintBooster.prototype.constructor = HintBooster).prototype.onGameStarted = function () {
            var e = Game.currentGame;
            e.userStatus.on("inactive_long", this.onUserInactive.bind(this)), e.userStatus.on("active", this.onUserActive.bind(this)), this.isForceAvailable() && (e.on("WrongWord_Booster", this.showForce.bind(this)), e.on("forceHint", function () {
                this.showForce()
            }.bind(this)))
        }, HintBooster.prototype.findHint = function () {
            var e = Game.currentGame;
            return "klondike" === cleverapps.config.type ? e.selectHint() : ("stacks" === cleverapps.config.subtype ? e.keypad : e.board).selectHintPosition()
        }, HintBooster.prototype.addHint = function (e, t) {
            var s = Game.currentGame;
            if ("klondike" === cleverapps.config.type) return s.addHint(e), void s.counter.trigger();
            t = t || {};
            var i, n = .3;
            if (-1 === ["scramble"].indexOf(cleverapps.config.name)) return n = .7, s.board.addHint(e.row, e.column), void s.counter.setTimeout(function () { }, 1e3 * n);
            e.letter && (e.letter.setHint(!0, {
                hintAnimationDuration: t.hintAnimationDuration || n,
                startPos: t.startPos
            }), i = s.board.listWordIndexes(e.word)[e.index], s.counter.setTimeout(function () {
                s.board.addHint(i[0], i[1])
            }, 1e3 * n))
        }, HintBooster.prototype.onExecute = function () {
            var e = this.findHint();
            e ? (levels.gameHints && levels.gameHints.addHint(), this.addHint(e)) : this.trigger("noHintFound")
        }, HintBooster.prototype.isForceAvailable = function () {
            return Booster.prototype.isForceAvailable.call(this) && cleverapps.user.checkAvailable(HintBooster.FORCE_AVAILABLE)
        }, HintBooster.FORCE_AVAILABLE = {
            stacks: {
                level: .4
            }
        }, function (e) {
            Booster.call(this, e), this.onCardCreatedListener = function () { }, this.onShowTutorial = function () { }
        }),
        UndoBooster = (WildcardBooster.prototype = Object.create(Booster.prototype), (WildcardBooster.prototype.constructor = WildcardBooster).prototype.onGameStarted = function () {
            Game.currentGame.userStatus.on("inactive_very_short", this.hintAttempt.bind(this)), Game.currentGame.userStatus.on("active", this.onUserActive.bind(this))
        },
            WildcardBooster.prototype.onExecute = function () {
                var e = new Wildcard;
                this.onCardCreatedListener(e), Game.currentGame.shiftWildcard(e), Game.currentGame.log.push(MovesLog.MOVE_USE_BOOSTER, {
                    id: this.id
                }), this.wildcardTutorial || (e = cleverapps.Random.mathChoose(cleverapps.exclamation.getCongratulations()), cleverapps.exclamation.show(e))
            }, WildcardBooster.prototype.activateTutorial = function () {
                this.wildcardTutorial = !0, this.onShowTutorial()
            }, WildcardBooster.prototype.use = function () {
                this.wildcardTutorial || BaseBooster.prototype.use.call(this)
            }, WildcardBooster.prototype.onPressed = function (e, t) {
                Booster.prototype.onPressed.call(this, e, t && !this.wildcardTutorial), this.wildcardTutorial && Game.currentGame.cardsTutorial && (Game.currentGame.cardsTutorial.finishTutorialStep(), Game.currentGame.counter.trigger())
            }, WildcardBooster.prototype.hintAttempt = function () {
                var e, t;
                cleverapps.environment.isSceneWithPreview() || cleverapps.config.editorMode || (e = 0 === Game.currentGame.table.listMissed().length,
                    t = Game.currentGame.combo && 0 < Game.currentGame.combo.level, e && t && this.onUserInactive())
            }, WildcardBooster.prototype.makeUndo = function () {
                this.wildcardTutorial || cleverapps.user.earnHard(cleverapps.EVENTS.EARN.RETURN, this.price.hard), Game.currentGame.open.pop().trigger("makeUndo")
            },
            function (e) {
                Booster.call(this, e)
            }),
        TileShuffleBooster = (UndoBooster.prototype = Object.create(Booster.prototype), (UndoBooster.prototype.constructor = UndoBooster).prototype.onExecute = function () {
            Game.currentGame.log.executeUndo()
        }, UndoBooster.prototype.onUsed = function () { }, UndoBooster.prototype.onGameStarted = function () {
            Game.currentGame.log.on("change", this.updateState.bind(this))
        }, UndoBooster.prototype.updateState = function () {
            Game.currentGame.log.isEmpty() ? this.onDisableListener() : this.onEnableListener()
        }, function (e) {
            Booster.call(this, e)
        }),
        ShuffleBooster = (TileShuffleBooster.prototype = Object.create(Booster.prototype), (TileShuffleBooster.prototype.constructor = TileShuffleBooster).prototype.onGameStarted = function () {
            Game.currentGame.log.on("change", this.updateState.bind(this)), Game.currentGame.pagination.on("changePage", this.updateState.bind(this)), Game.currentGame.userStatus.on("inactive_very_short", function () {
                this.isForceAvailable() && this.showForce()
            }.bind(this))
        }, TileShuffleBooster.prototype.updateState = function () {
            Game.currentGame.table.cards.length <= 1 ? this.onDisableListener() : this.onEnableListener()
        }, TileShuffleBooster.prototype.onExecute = function () {
            Game.currentGame.table.shuffle()
        }, function (e) {
            Booster.call(this, e)
        }),
        VacuumBooster = (ShuffleBooster.prototype = Object.create(Booster.prototype), (ShuffleBooster.prototype.constructor = ShuffleBooster).prototype.onExecute = function () {
            Game.currentGame.keypad.shuffle()
        }, function (e) {
            Booster.call(this, e), this.onDisableListener()
        }),
        ReplaceAllBooster = (VacuumBooster.prototype = Object.create(Booster.prototype), (VacuumBooster.prototype.constructor = VacuumBooster).prototype.calcBlowTriads = function () {
            var e = Game.currentGame.table.cards.length;
            return .6 * e >= 3 * VacuumBooster.DEFAULT_BLOW_TRIADS ? VacuumBooster.DEFAULT_BLOW_TRIADS : .8 * e >= 3 * VacuumBooster.DEFAULT_BLOW_TRIADS ? VacuumBooster.DEFAULT_BLOW_TRIADS - 1 : VacuumBooster.DEFAULT_BLOW_TRIADS - 2
        }, VacuumBooster.prototype.onExecute = function () {
            Game.currentGame.table.blowCards(this.calcBlowTriads())
        }, VacuumBooster.prototype.onGameStarted = function () {
            Game.currentGame.log.on("change", this.updateState.bind(this)), Game.currentGame.table.on("blowCards", this.updateState.bind(this))
        }, VacuumBooster.prototype.updateState = function () {
            Game.currentGame.table.findCardsToBlow() ? this.onEnableListener() : this.onDisableListener()
        }, VacuumBooster.DEFAULT_BLOW_TRIADS = 3, function (e) {
            Booster.call(this, e), this.disableForceOnInactive = !0
        }),
        ClearPiecesBooster = (ReplaceAllBooster.prototype = Object.create(Booster.prototype), (ReplaceAllBooster.prototype.constructor = ReplaceAllBooster).prototype.onExecute = function () {
            var e = Game.currentGame,
                n = e.pieces;
            e.counter.setTimeout(function () { }, 500), e.applySelectionAlgorithm(!0, !0, !1,
                function (e) {
                    for (var t = e.items.map(function (e) {
                        return Forms.ALL_POSSIBLE_VARIANTS[e]
                    }), s = [n.calcPieceColor(), n.calcPieceColor(), n.calcPieceColor()], i = 0; i < n.forms.length; i++) n.clearHint(i), n.replacePiece(i, t[i], s[i])
                })
        }, function (e) {
            Booster.call(this, e)
        }),
        UndoPieceBooster = (ClearPiecesBooster.prototype = Object.create(Booster.prototype), (ClearPiecesBooster.prototype.constructor = ClearPiecesBooster).prototype.onExecute = function () {
            Game.currentGame.grid.runClearBang()
        }, function (e) {
            Booster.call(this, e)
        }),
        InstantTournament = (UndoPieceBooster.prototype = Object.create(Booster.prototype), (UndoPieceBooster.prototype.constructor = UndoPieceBooster).prototype.onExecute = function () {
            Game.currentGame.history.undo()
        }, UndoPieceBooster.prototype.onGameStarted = function () {
            Game.currentGame.history.onChangeListener = function (e) {
                e ? this.onEnableListener() : this.onDisableListener()
            }.bind(this)
        }, function () {
            this.id = void 0, this.score = 0, this.load(), cleverapps.platform.isConnected(Platform.PLATFORM) && this.updateId(),
                cleverapps.platform.on("changeStatus:" + Platform.PLATFORM, function (e) {
                    e === Platform.STATUS_CONNECTED && this.updateId()
                }.bind(this))
        }),
        BrushBooster = (InstantTournament.prototype.updateId = function () {
            cleverapps.platform.getCurrentTournamentId(function (e) {
                e !== this.id && (this.id = void 0)
            }.bind(this))
        }, InstantTournament.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.INSTANT_TOURNAMENT);
            e && (this.id = e.id, this.score = e.score, this.lastReport = e.lastReport)
        }, InstantTournament.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.INSTANT_TOURNAMENT, {
                id: this.id,
                score: this.score,
                lastReport: this.lastReport
            })
        }, InstantTournament.prototype.isInTournament = function () {
            return void 0 !== this.id
        }, InstantTournament.prototype.updateScore = cleverapps.accumulate(1e3, function () {
            var t, e, s = cleverapps.user.getFloatLevel();
            s < 5 || void 0 === cleverapps.timeStart || Date.now() - cleverapps.timeStart < 6e4 || this.lastReport + InstantTournament.REPORT_TIMEOUT > Date.now() || (
                e = s < 9 ? 50 : 10, (t = Math.round(100 * s)) < (Math.floor(this.score / e) + 1) * e || cleverapps.platform.getCurrentTournamentId(function (e) {
                    this.id === e && this.score === t || (console.log("Instant report score"), this.lastReport = Date.now(), cleverapps.platform.reportScore(t, function (e) {
                        console.log("Instant report score success", e), e && (this.id = e, this.score = t, this.save())
                    }.bind(this)))
                }.bind(this)))
        }), InstantTournament.REPORT_TIMEOUT = 6e4, "merge" === cleverapps.config.type && (InstantTournament.REPORT_TIMEOUT = cleverapps.parseInterval("2 days")), function (e) {
            Booster.call(this, e), this.init(), this.onAfterExecuted = function () { }
        }),
        DiscoverBooster = (BrushBooster.prototype = Object.create(Booster.prototype), (BrushBooster.prototype.ctor = BrushBooster).prototype.onGameStarted = function () {
            var e;
            this.isForceAvailable() && ((e = Game.currentGame).onMistakeBoosterListeners.brush = function () {
                this.isForceAvailable() && !this.used && (1 < e.inflamer.value || 0 < e.inflamer.stage) && this.showForce()
            }.bind(this))
        }, BrushBooster.prototype.canExecute = function () {
            return Booster.prototype.canExecute.call(this) && !this.used
        }, BrushBooster.prototype.onPressed = function (e, t) {
            this.used ? e() : Booster.prototype.onPressed.call(this, e, t)
        }, BrushBooster.prototype.execute = function () {
            this.executing || (this.executing = !0, Booster.prototype.execute.apply(this, arguments), this.executing = !1)
        }, BrushBooster.prototype.onExecute = function () {
            this.used = !0, Game.currentGame.showPaint(), this.onAfterExecuted()
        }, BrushBooster.prototype.init = function () {
            this.used = !1
        }, function (e) {
            Booster.call(this, e)
        }),
        BaseButtonBooster = (DiscoverBooster.prototype = Object.create(Booster.prototype), (DiscoverBooster.prototype.ctor = DiscoverBooster).prototype.onGameStarted = function () {
            var e = Game.currentGame;
            e.userStatus.on("inactive_short", this.onUserInactive.bind(this)), e.userStatus.on("active", this.onUserActive.bind(this)), this.isForceAvailable() && (e.onMistakeBoosterListeners.discover = this.showForce.bind(this))
        }, DiscoverBooster.prototype.onUserInactive = function () {
            this.isDisabled() || Booster.prototype.onUserInactive.apply(this, arguments)
        }, DiscoverBooster.prototype.onPressed = function (e, t) {
            0 === Game.currentGame.getAreasWithoutHint().length ? (cleverapps.notification.create("DiscoverBooster.hintsShown"), e()) : Booster.prototype.onPressed.call(this, e, t)
        }, DiscoverBooster.prototype.onUserActive = function () {
            this.manualAlarm || Booster.prototype.onUserActive.apply(this, arguments)
        }, DiscoverBooster.prototype.execute = function () {
            this.executing = !0, Booster.prototype.execute.apply(this, arguments), this.executing = !1
        }, DiscoverBooster.prototype.onExecute = function (e) {
            Game.currentGame.boosterDiscover(e)
        }, cleverapps.UI.Button.extend({
            ctor: function (e) {
                this.booster = e.booster, this.styles = e.styles, this.content = this.getContent(), this.onChangeAmount();
                e = {
                    onClicked: this.onPressed.bind(this),
                    content: this.content,
                    spine: e.spine
                };
                cleverapps.overrideStyles(e, this.getSize()), this._super(e), this.setCascadeOpacityEnabled(!0), this.setCascadeColorEnabled(!0), this.updateSize(), this.updatePosition(),
                    this.booster.on("changeAmount", this.createListener(this.onChangeAmount.bind(this)), this), cleverapps.adsLimits.on("update", this.onChangeAmount.bind(this), this), cleverapps.config.soft ? cleverapps.user.on("changeSoft", this.onChangeAmount.bind(this), this) : cleverapps.user.on("changeHard", this.onChangeAmount.bind(this), this), this.booster.onToggleArrowListener = this.createListener(this.toggleArrow.bind(this)), this.booster.onToggleTintListener = this.createListener(this.toggleTint.bind(this)), this.booster.onForceListener = this.createListener(this.showForce.bind(this)), this.booster.onExecuteListener = this.createListener(this.onExecute.bind(this)), this.booster.onEnableListener = this.createListener(this.enable.bind(this)), this.booster.onDisableListener = this.createListener(this.disable.bind(this)), cleverapps.aims.registerTarget("boosters" + this.booster.id, this, {
                        controls: this.getControlId(),
                        flyingUnderShadow: !0
                    })
            },
            onChangeAmount: function () {
                var t;
                this.free || (t = this.getCurrentText(), [this.amount, this.price,
                this.ads
                ].forEach(function (e) {
                    e.setVisible(e === t)
                }), this.setAmount(this.booster.getAmount()))
            },
            getCurrentText: function () {
                var e = this.booster.getState();
                return e === BaseBooster.AMOUNT_STATE ? this.amount : e === BaseBooster.PRICE_STATE ? this.price : e === BaseBooster.ADS_STATE ? this.ads : void 0
            },
            setAmount: function (e) {
                this.amount.setString("x" + e)
            },
            updatePosition: function () {
                this.styles.position && this.setPositionRound(this.styles.position.x[cleverapps.resolution.mode], this.styles.position.y[cleverapps.resolution.mode]), this.content.setPositionRound(this.width / 2, this.height / 2), this.layout.setPositionRound(this.styles.content.layout)
            },
            updateSize: function () {
                this.baseScale = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? this.styles.phone.scale : 1, this.setScale(this.baseScale);
                var e = this.getSize();
                this.resize(e.width, e.height)
            },
            getSize: function () {
                return {
                    width: this.styles.width,
                    height: this.styles.height
                }
            },
            toggleArrow: function (e) {
                e ? this.pointer = PointerView.create({
                    target: this
                }) : (PointerView.remove(
                    this.pointer), this.pointer = void 0), this.icon instanceof cleverapps.Spine && this.icon.setAnimation(0, e ? "animation" : "idle", !0)
            },
            toggleTint: function (e) {
                this.hintOn = e, this.runTintAnimation()
            },
            getForceActions: function () {
                return [function (e) {
                    this.switchToFreePrice(), setTimeout(e, 700)
                }.bind(this), function (e) {
                    cleverapps.meta.showControlsWhileFocused(this.getControlId(), !0), cleverapps.forces.create(this, this.booster.force), cleverapps.forces.onceForceClosed = e
                }.bind(this)]
            },
            getControlId: function () {
                return "hint_" + this.booster.id
            },
            showForce: function () {
                var e;
                return !!cleverapps.forces.isAvailable(this, this.booster.force) && (e = this.getForceActions(), this.baseZOrder = this.getLocalZOrder(), this.setLocalZOrder(0), cleverapps.meta.display({
                    focus: "ButtonBoosterForce",
                    control: [this.getControlId(), "opencards"],
                    actions: e
                }), !0)
            },
            runTintAnimation: function () {
                var e, t;
                !this.tintRunning && this.hintOn && (this.tintRunning = !0, e = cleverapps.styles.COLORS.WHITE,
                    t = cleverapps.styles.COLORS.HINT_ALARM_COLOR || cleverapps.styles.COLORS.PLAYER_ALARM_COLOR, this.background.runAction(new cc.Sequence(new cc.TintTo(.7, t.r, t.g, t.b), new cc.TintTo(.7, e.r, e.g, e.b), new cc.CallFunc(function () {
                        this.tintRunning = !1, this.runTintAnimation()
                    }.bind(this)))))
            },
            createIcon: function () {
                var e;
                return bundles.game.jsons.hint_icon_json ? ((e = new cleverapps.Spine(bundles.game.jsons.hint_icon_json)).setAnimation(0, "idle", !0), e) : new cc.Sprite(bundles.game.frames.hint_icon_png)
            },
            getLayoutOptions: function () {
                return {
                    direction: this.styles.content.direction,
                    margin: this.styles.content.margin
                }
            },
            getContent: function () {
                var e = new cc.Node,
                    t = (e.setAnchorPoint2(), this.getLayoutOptions()),
                    s = this.price = this.getPriceText(),
                    i = (s.setCascadeOpacityEnabled(!0), this.amount = cleverapps.UI.generateImageText("x" + this.booster.getAmount(), cleverapps.styles.FONTS.AMOUNT_BOOSTER)),
                    n = this.ads = new TextWithIcon("## x1", {
                        font: cleverapps.styles.FONTS.BUTTON_BOOSTER
                    }),
                    o = this.icon = this.createIcon(),
                    a = this.textNode = new cc.Node;
                return a.setAnchorPoint(.5, .5), a.setContentSize(s.getContentSize()), a.addChild(s), s.setPosition(a.width / 2, a.height / 2), a.addChild(i), i.setPosition(a.width / 2, a.height / 2), a.addChild(n), n.setPosition(a.width / 2, a.height / 2), this.layout = new cleverapps.Layout([o, a], t), e.addChild(this.layout), e
            },
            getPriceText: function () {
                var e = this.booster.getPrice(),
                    e = e.soft && "@@" + e.amount || "$$" + e.amount;
                return new TextWithIcon(e, {
                    font: cleverapps.styles.FONTS.BUTTON_BOOSTER
                })
            },
            createFreePrice: function () {
                var e = this.getFreeLayoutStyles(),
                    t = cleverapps.UI.generateTTFText("FREE", cleverapps.styles.FONTS.BUTTON_BOOSTER);
                return t.fitTo(e.textWidth), t.setPosition(this.textNode.width / 2, this.textNode.height / 2), this.textNode.addChild(t), t
            },
            switchToFreePrice: function () {
                var e = this.getCurrentText(),
                    t = this.free = this.createFreePrice();
                t.setOpacity(0), t.setVisible(!1), e.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide)), t.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.Show, new cc.FadeIn(
                    .3)))
            },
            getFreeLayoutStyles: function () {
                var e = this.styles.content.freeBlock;
                return {
                    textWidth: e.textWidth,
                    background: e.textBg
                }
            },
            switchToRegularPrice: function () {
                this.free.runAction(new cc.Sequence(new cc.DelayTime(.5), new cc.FadeOut(.3), new cc.RemoveSelf, new cc.CallFunc(function () {
                    delete this.free, this.getCurrentText().runAction(new cc.Sequence(new cc.Show, new cc.FadeIn(.3)))
                }.bind(this))))
            },
            onPressed: function () {
                var t = cleverapps.forces.isRunningForce(this.booster.force);
                t && (this.switchToRegularPrice(), this.baseZOrder && this.setLocalZOrder(this.baseZOrder), cleverapps.forces.closeRunningForce()), cleverapps.meta.display({
                    focus: "ExecuteButtonBooster",
                    action: function (e) {
                        this.booster.onPressed(e, t)
                    }.bind(this)
                })
            },
            onExecute: function () {
                this.icon instanceof cleverapps.Spine && "crocword" === cleverapps.config.name && this.icon.setAnimationAndIdleAfter("hint", "idle"), cleverapps.audio.playSound(this.booster.executeEffect)
            }
        })),
        BoosterAmountView = (cleverapps.styles.FONTS = cleverapps.overrideFonts(
            cleverapps.styles.FONTS, {
            BUTTON_BOOSTER: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            AMOUNT_BOOSTER: {
                size: 45,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.ButtonBooster = {
            width: 150,
            height: 130,
            zOrder: 0,
            position: {
                x: [{
                    align: "center",
                    dx: 0
                }, {
                    align: "right",
                    dx: -10
                }, {
                    align: "right",
                    dx: -10
                }],
                y: [{
                    align: "bottom",
                    dy: 200
                }, {
                    align: "bottom",
                    dy: 360
                }, {
                    align: "bottom",
                    dy: 360
                }]
            },
            phone: {
                scale: .8
            },
            content: {
                margin: 20,
                direction: cleverapps.UI.HORIZONTAL,
                layout: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                },
                freeBlock: {
                    textWidth: 120,
                    dx: 0
                }
            }
        }, cleverapps.Boosters = function (e) {
            this.boosterBeforeIds = cleverapps.Boosters.listBoostersBeforeIds(), this.boosterIds = cleverapps.Boosters.listBoostersIds(), this.boosters = {}, this.changed = {}, this.createBoosters(), e ? this.initialize() : this.load()
        }, cleverapps.Boosters.prototype.initialize = function () {
            this.data = {}, this.addInitAmount()
        },
            cleverapps.Boosters.prototype.createBoosters = function () {
                this.boosterIds.concat(this.boosterBeforeIds).forEach(function (e) {
                    var t = cleverapps.Boosters.CONFIG[e].model;
                    this.boosters[e] = new t(e)
                }, this)
            }, cleverapps.Boosters.prototype.addInitAmount = function () {
                var t = !1;
                this.listAll().forEach(function (e) {
                    void 0 === this.data[e.id] && (this.data[e.id] = cleverapps.Boosters.INIT_AMOUNT, t = !0)
                }, this), t && this.save()
            }, cleverapps.Boosters.prototype.load = function () {
                var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.BOOSTERS);
                this.data = e || {}
            }, cleverapps.Boosters.prototype.save = function (e) {
                cleverapps.Boosters.IsUnlimited() || (cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.BOOSTERS, this.data), !1 !== e && cleverapps.synchronizer.addUpdateTask("boosters"))
            }, cleverapps.Boosters.prototype.getAmount = function (e) {
                return this.data[e] || 0
            }, cleverapps.Boosters.prototype.has = function (e) {
                return 0 < this.getAmount(e)
            }, cleverapps.Boosters.prototype.take = function (e) {
                this.has(e) && this.setAmount(e, this.getAmount(e) - 1)
            },
            cleverapps.Boosters.prototype.add = function (e, t, s) {
                t = t || 1, this.setAmount(e, this.getAmount(e) + t, s)
            }, cleverapps.Boosters.prototype.setAmount = function (e, t, s) {
                this.getAmount(e) !== t && (this.data[e] = t, this.changed[e] = !0, this.save(), s || this.onChange())
            }, cleverapps.Boosters.prototype.onChange = function () {
                var e, t = this.changed;
                for (e in this.changed = {}, t) this.boosters[e].trigger("changeAmount")
            }, cleverapps.Boosters.prototype.getBoosterById = function (e) {
                return this.boosters[e]
            }, cleverapps.Boosters.prototype.listBoosters = function () {
                return this.boosterIds.map(function (e) {
                    return this.boosters[e]
                }, this)
            }, cleverapps.Boosters.prototype.listBoostersBefore = function () {
                return this.boosterBeforeIds.map(function (e) {
                    return this.boosters[e]
                }, this)
            }, cleverapps.Boosters.prototype.listAll = function () {
                return this.listBoostersBefore().concat(this.listBoosters())
            }, cleverapps.Boosters.listBoostersIds = function () {
                return "scramble" === cleverapps.config.name ? [cleverapps.Boosters.TYPE_HINT, cleverapps.Boosters.TYPE_SHUFFLE] : "match3" === cleverapps.config.type ? [cleverapps.Boosters.TYPE_CELL, cleverapps.Boosters.TYPE_LINE, cleverapps.Boosters.TYPE_COLOR] : "board" === cleverapps.config.type ? [cleverapps.Boosters.TYPE_HINT] : "solitaire" === cleverapps.config.type ? [cleverapps.Boosters.TYPE_WILDCARD, cleverapps.Boosters.TYPE_UNDO] : "differences" === cleverapps.config.name ? [cleverapps.Boosters.TYPE_BRUSH, cleverapps.Boosters.TYPE_DISCOVER] : "tile3" === cleverapps.config.type ? [cleverapps.Boosters.TYPE_TILE_SHUFFLE, cleverapps.Boosters.TYPE_UNDO, cleverapps.Boosters.TYPE_VACUUM] : "klondike" === cleverapps.config.type ? [cleverapps.Boosters.TYPE_UNDO, cleverapps.Boosters.TYPE_HINT] : "blocks" === cleverapps.config.type ? [cleverapps.Boosters.TYPE_REPLACE_ALL, cleverapps.Boosters.TYPE_CLEAR_PIECES, cleverapps.Boosters.TYPE_UNDO_PIECE] : []
            }, cleverapps.Boosters.listBoostersBeforeIds = function () {
                return "match3" === cleverapps.config.type ? [cleverapps.Boosters.TYPE_COMBO, cleverapps.Boosters.TYPE_MOVES, cleverapps.Boosters.TYPE_MULTICOLOR] : "solitaire" === cleverapps.config.type ? [cleverapps.Boosters.TYPE_MAGNET, cleverapps.Boosters.TYPE_DICE, cleverapps.Boosters.TYPE_JOKERS] : "stacks" === cleverapps.config.subtype ? [cleverapps.Boosters.TYPE_HIGHLIGHT, cleverapps.Boosters.TYPE_EYE, cleverapps.Boosters.TYPE_MAGNIFIER] : []
            }, cleverapps.Boosters.IsUnlimited = function () {
                return "klondike" === cleverapps.config.type
            }, cleverapps.Boosters.INIT_AMOUNT = 1, cleverapps.Boosters.TYPE_CELL = 0, cleverapps.Boosters.TYPE_LINE = 1, cleverapps.Boosters.TYPE_COLOR = 2, cleverapps.Boosters.TYPE_HINT = 3, cleverapps.Boosters.TYPE_WILDCARD = 4, cleverapps.Boosters.TYPE_SHUFFLE = 16, cleverapps.Boosters.TYPE_BRUSH = 8, cleverapps.Boosters.TYPE_DISCOVER = 9, cleverapps.Boosters.TYPE_COMBO = 5, cleverapps.Boosters.TYPE_MOVES = 6, cleverapps.Boosters.TYPE_MULTICOLOR = 7, cleverapps.Boosters.TYPE_MAGNET = 10, cleverapps.Boosters.TYPE_DICE = 11, cleverapps.Boosters.TYPE_JOKERS = 12, cleverapps.Boosters.TYPE_HIGHLIGHT = 13, cleverapps.Boosters.TYPE_EYE = 14, cleverapps.Boosters.TYPE_MAGNIFIER = 15,
            cleverapps.Boosters.TYPE_TILE_SHUFFLE = 17, cleverapps.Boosters.TYPE_UNDO = 18, cleverapps.Boosters.TYPE_RETURN = 19, cleverapps.Boosters.TYPE_VACUUM = 23, cleverapps.Boosters.TYPE_REPLACE_ALL = 20, cleverapps.Boosters.TYPE_CLEAR_PIECES = 21, cleverapps.Boosters.TYPE_UNDO_PIECE = 22, cleverapps.Boosters.CONFIG = {}, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_CELL] = {
                model: CellBooster,
                price: {
                    hard: 100
                },
                limit: AdsLimits.TYPES.BOOSTER_1,
                icon_moving: bundles.game.frames.cellbooster_moving_png,
                icon: bundles.game.frames.cellbooster_png,
                icon_active: bundles.game.frames.cellbooster_active_png,
                available: {
                    level: 1.6
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_LINE] = {
                model: LineBooster,
                price: {
                    hard: 150
                },
                limit: AdsLimits.TYPES.BOOSTER_2,
                icon_moving: bundles.game.frames.linebooster_moving_png,
                icon: bundles.game.frames.linebooster_png,
                icon_active: bundles.game.frames.linebooster_active_png,
                available: {
                    level: 2.53
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_COLOR] = {
                model: ColorBooster,
                price: {
                    hard: 200
                },
                limit: AdsLimits.TYPES.BOOSTER_3,
                icon_moving: bundles.game.frames.colorbooster_moving_png,
                icon: bundles.game.frames.colorbooster_png,
                icon_active: bundles.game.frames.colorbooster_active_png,
                available: {
                    level: 3.33
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_HINT] = {
                model: HintBooster,
                price: {
                    hard: "stacks" === cleverapps.config.subtype ? 150 : 50
                },
                force: Forces.FREE_HINT_FORCE,
                limit: AdsLimits.TYPES.BOOSTER_1,
                available: {
                    level: .07,
                    olympics: {
                        level: .25
                    }
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_WILDCARD] = {
                model: WildcardBooster,
                price: {
                    hard: 150
                },
                limit: AdsLimits.TYPES.BOOSTER_3,
                available: {
                    level: .65
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_SHUFFLE] = {
                model: ShuffleBooster,
                force: Forces.FREE_SHUFFLE_FORCE,
                price: {
                    hard: 100
                },
                limit: AdsLimits.TYPES.BOOSTER_2,
                available: {
                    level: .25,
                    projectName: ["scramble"]
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_BRUSH] = {
                model: BrushBooster,
                force: Forces.FREE_PAINT_FORCE,
                price: {
                    hard: 200
                },
                limit: AdsLimits.TYPES.BOOSTER_3,
                available: {
                    level: .8
                }
            },
            cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_DISCOVER] = {
                model: DiscoverBooster,
                force: Forces.FREE_HINT_FORCE,
                limit: AdsLimits.TYPES.BOOSTER_1,
                price: {
                    hard: 50
                },
                available: {
                    level: .8
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_TILE_SHUFFLE] = {
                model: TileShuffleBooster,
                force: Forces.FREE_SHUFFLE_FORCE,
                price: {
                    soft: 40
                },
                executeEffect: bundles.game.urls.shuffle_booster_effect,
                limit: AdsLimits.TYPES.BOOSTER_2,
                available: {
                    level: .91,
                    types: ["tile3"]
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_UNDO] = {
                model: UndoBooster,
                force: Forces.FREE_UNDO_FORCE,
                price: {
                    hard: 50,
                    soft: 100
                },
                disableForceOnInactive: !0,
                executeEffect: bundles.game.urls.undo_booster_effect,
                limit: AdsLimits.TYPES.BOOSTER_1,
                available: {
                    level: .4
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_VACUUM] = {
                model: VacuumBooster,
                force: Forces.FREE_VACUUM_FORCE,
                disableForceOnInactive: !0,
                price: {
                    soft: 395
                },
                executeEffect: bundles.game.urls.return_booster_effect,
                limit: AdsLimits.TYPES.BOOSTER_3,
                available: {
                    level: 1.6,
                    types: ["tile3"]
                }
            },
            cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_REPLACE_ALL] = {
                model: ReplaceAllBooster,
                force: Forces.FREE_REPLACE_ALL_FORCE,
                disableForceOnInactive: !0,
                price: {
                    soft: 100
                },
                limit: AdsLimits.TYPES.BOOSTER_2,
                available: {
                    level: .26,
                    types: ["blocks"]
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_CLEAR_PIECES] = {
                model: ClearPiecesBooster,
                force: Forces.FREE_NEXT_PIECES_FORCE,
                disableForceOnInactive: !0,
                price: {
                    soft: 300
                },
                limit: AdsLimits.TYPES.BOOSTER_2,
                available: {
                    level: .4,
                    types: ["blocks"]
                }
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_UNDO_PIECE] = {
                model: UndoPieceBooster,
                force: Forces.FREE_UNDO_PIECE,
                disableForceOnInactive: !0,
                price: {
                    soft: 50
                },
                limit: AdsLimits.TYPES.BOOSTER_1,
                available: {
                    level: .13,
                    types: ["blocks"]
                }
            }, "klondike" === cleverapps.config.type && (cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_UNDO].price = {
                hard: 0
            }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_HINT].price = {
                hard: 0
            }), cc.Node.extend({
                ctor: function (e) {
                    this._super(), this.setAnchorPoint(.5, .5),
                        this.setCascadeOpacityEnabled(!0);
                    var t = cleverapps.styles.BoosterAmountView;
                    this.bg = bundles.game.frames.booster_amount_bg_png ? new cc.Sprite(bundles.game.frames.booster_amount_bg_png) : new cc.Sprite, this.bg.setScale(t.background.scale), this.bg.setAnchorPoint2(), this.addChild(this.bg), this.amount = cleverapps.UI.generateImageText("", cleverapps.styles.FONTS.WHITE_TEXT), this.addChild(this.amount), this.booster = e, this.setAmount(e.getAmount())
                },
                setAmount: function (e) {
                    0 < e ? (this.visible = !0, this.bg.setVisible(!0), this.amount.setVisible(!0), this.amount.setString(e), this.amount.fitTo(this.bg.width * this.bg.scale * .85)) : (this.visible = !1, this.bg.setVisible(!1), this.amount.setVisible(!1)), this.setContentSize2(Math.max(this.bg.width * this.bg.scale, this.amount.width * this.amount.scale), Math.max(this.bg.height * this.bg.scale, this.amount.height * this.amount.scale)), this.amount.setPositionRound(this.width / 2, this.height / 2 + cleverapps.styles.BoosterAmountView.amount.offsetY), this.bg.setPositionRound(this.width / 2,
                        this.height / 2)
                }
            })),
        TournamentPlayerView = (cleverapps.styles.BoosterAmountView = {
            background: {
                scale: 1
            },
            amount: {
                offsetY: 0
            }
        }, cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.player = e, this.competition = t, this.game = Game.currentGame;
                t = cleverapps.styles.TournamentPlayerView, this.setContentSize2(t.width, t.height), this.setAnchorPoint2(), cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && this.setScale(.8), this.baseScale = this.getScale(), this.colorNode = new cc.Node, this.colorNode.setContentSize2(this.getContentSize()), this.colorNode.setAnchorPoint2(), this.colorNode.setCascadeColorEnabled(!0), this.colorNode.setPositionRound(this.width / 2, this.height / 2), this.addChild(this.colorNode), e = this.avatar = new cleverapps.UI.Avatar(e);
                e.setScale(t.avatar.scale), e.setCascadeColorEnabled(!1), this.colorNode.addChild(e), e.setLocalZOrder(-1), e.setPositionRound(t.avatar), this.createName(), this.addAmount(), this.processPlaceAnimation(), this.prevAmount = this.player.amount, this.setCascadeColorEnabled(!0),
                    this.addClickProcessing(), this.competition.onChangeResultsListeners["player_" + this.player.id] = this.createListener(this.onChangeResults.bind(this)), this.player.id === cleverapps.platform.getUserID() && (this.competition.onChangeResultsListeners.processPlaceAnimation = this.createListener(this.processPlaceAnimation.bind(this)))
            },
            createName: function () {
                var e = cleverapps.styles.TournamentPlayerView,
                    t = this.player.name,
                    s = (t || (cleverapps.throwAsync("No player name " + JSON.stringify(this.player)), t = "Player_" + this.player.id.substr(-3)), 0 < t.indexOf(" ") && (t = t.substring(0, t.indexOf(" "))), new cc.Sprite(bundles.tournament.frames.tournament_name_bg_png));
                this.colorNode.addChild(s), s.setPositionRound(e.name.bg), this.name = cleverapps.UI.generateOnlyText(t, cleverapps.styles.FONTS.TOURNAMENT_PLAYER_TEXT), this.name.fitTo(s.width - 2 * e.name.padding.x), s.addChild(this.name), this.name.setPositionRound(e.name)
            },
            addClickProcessing: function () {
                cleverapps.config.debugMode && cleverapps.UI.onClick(this, function () {
                    Game.currentGame && Game.currentGame.discoverDebug(this.player)
                }.bind(this))
            },
            addAmount: function () {
                var e = cleverapps.styles.TournamentPlayerView.amount,
                    t = new cc.Sprite(this.player.id === cleverapps.platform.getUserID() ? bundles.game.frames.tournament_mark_1_png : bundles.game.frames.tournament_mark_0_png),
                    s = (t.setPositionRound(t.width / 2, t.height / 2), this.score = new cc.Node),
                    t = (s.setAnchorPoint2(), s.setContentSize2(t.getContentSize()), s.addChild(t), s.setCascadeColorEnabled(!0), this.amountText = cleverapps.UI.generateImageText(this.player.amount + "", cleverapps.styles.FONTS.TOURNAMENT_PLAYER_TEXT));
                s.addChild(t), t.setPositionRound(e.text), this.colorNode.addChild(s), s.setPositionRound(e), s.setScale(e.scale || 1)
            },
            onChangeResults: function (e) {
                e === this.player.id && (e = cleverapps.styles.TournamentPlayerView.amount, this.score.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.4, 1.4).easing(cc.easeOut(3)), new cc.Sequence(new cc.RotateTo(.15, 15), new cc.RotateTo(.15, -15), new cc.RotateTo(.1, 0))), new cc.ScaleTo(
                    .15, e.scale || 1))), this.amountText.setString(this.player.amount + ""))
            },
            processPlaceAnimation: function () {
                var e, t;
                this.player.id === cleverapps.platform.getUserID() && (this.competition.calcPlace() < 3 || this.competition.getFinishedOpponents().length !== this.competition.results.length - 1 && (this.placeAnimationProcessing || (e = cleverapps.styles.COLORS.PLAYER_ALARM_COLOR, t = cleverapps.styles.COLORS.WHITE, this.placeAnimationProcessing = !0, this.colorNode.runAction(new cc.Sequence(new cc.TintTo(.5, e.r, e.g, e.b), new cc.TintTo(.5, t.r, t.g, t.b), new cc.CallFunc(function () {
                    this.placeAnimationProcessing = !1, this.processPlaceAnimation()
                }.bind(this)))), this.framePulsation || (this.framePulsation = new cc.Sprite(bundles.tournament.frames.avatar_frame_red_png), this.avatar.addChild(this.framePulsation), this.framePulsation.setPositionRound(this.avatar.width / 2, this.avatar.height / 2), this.framePulsation.setLocalZOrder(-1), this.framePulsation.setColor(cc.color.RED), this.framePulsation.setContentSize2(this.avatar.width,
                    this.avatar.height)), this.framePulsation.runAction(new cc.Sequence(new cc.ScaleTo(.5, 1.2), new cc.ScaleTo(.5, 1))))))
            },
            animateReorder: function (e) {
                var t;
                (cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? Math.abs(this.x - e.x) < 1 : Math.abs(this.y - e.y) < 1) && this.player.amount === this.prevAmount && !this.reorderAnimationRunning || (t = e.y > this.y || this.player.amount > this.prevAmount, this.prevAmount = this.player.amount, this.reorderAnimationRunning = !0, this.stopAllActions(), this.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.2, this.baseScale * (t ? 1.2 : .9)), new cc.MoveTo(.35, e).easing(cc.easeIn(1)), new cc.Sequence(new cc.CallFunc(function () {
                    this.rotation = 0
                }.bind(this)), new cc.DelayTime(.08), new cc.RotateBy(.108, e.y > this.y ? 20 : 0).easing(cc.easeInOut(.5)), new cc.RotateBy(.135, e.y > this.y ? -30 : 0), new cc.RotateBy(.027, e.y > this.y ? 10 : 0)), new cc.Sequence(new cc.DelayTime(.3), new cc.ScaleTo(.2, this.baseScale))), new cc.CallFunc(function () {
                    cleverapps.tooltipManager._hide(), this.reorderAnimationRunning = !1
                }.bind(this)))))
            },
            animateResult: function (e) {
                var t = cleverapps.styles.TournamentPlayerView;
                cleverapps.UI.animateDelta(e, {
                    parent: this,
                    font: cleverapps.styles.FONTS.TOURNAMENT_PLAYER_TEXT,
                    x: this.width / 2 + t.delta.x,
                    y: this.height / 2 + t.delta.y
                })
            }
        })),
        TournamentPlayersView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TOURNAMENT_PLAYER_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_BROWN
            }
        }), cleverapps.styles.TournamentPlayerView = {
            width: 130,
            height: 110,
            scale: [1, 1, 1],
            avatar: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 10
                },
                scale: .7
            },
            amount: {
                x: {
                    align: "right",
                    dx: 12
                },
                y: {
                    align: "bottom",
                    dy: 3
                },
                text: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    }
                }
            },
            name: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 3
                },
                padding: {
                    x: 17
                },
                bg: {
                    width: 100,
                    height: 40,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom"
                    }
                }
            },
            delta: {
                x: 55,
                y: 0
            }
        }, cc.Node.extend({
            ctor: function (t) {
                this._super(), this.competition = t, this.players = t.results, this.competition.calcPlace(), this.views = this.players.map(function (e) {
                    return new TournamentPlayerView(e, t)
                });
                var e = cleverapps.styles.TournamentPlayersView,
                    e = this.layout = new cleverapps.Layout(this.views, {
                        direction: cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? cleverapps.UI.HORIZONTAL : cleverapps.UI.VERTICAL,
                        reversed: cleverapps.resolution.mode !== cleverapps.WideMode.VERTICAL,
                        margin: e.margin,
                        padding: e.padding
                    });
                this.setContentSize2(e.getContentSize()), this.addChild(e), this.positions = {}, this.views.forEach(function (e, t) {
                    this.positions[t] = e.getPosition()
                }.bind(this)), this.createBg(), this.setAnchorPoint2(), this.updatePosition(), this.setLocalZOrder(1), t.onChangeResultsListeners.tournamentPlayers = cleverapps.whenGameActiveListener(this.createListener(cleverapps.timeredThrottle(10, this.onChangeResults.bind(this)))), this.onChangeResults(), Game.currentGame.on("stop", this.createListener(this.afterOnChangeOutcome.bind(this)), this), this.competition.onAnimateResults = this.createListener(this.animateResults.bind(this))
            },
            updateSize: function () {
                this.layout.setOptions({
                    direction: cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? cleverapps.UI.HORIZONTAL : cleverapps.UI.VERTICAL,
                    reversed: cleverapps.resolution.mode !== cleverapps.WideMode.VERTICAL
                }), this.layout.reshape(), this.setContentSize2(this.layout.getContentSize()), this.setContentSize2(this.layout.getContentSize()), this.bg.setContentSize2(this.getContentSize()), this.views.forEach(function (e, t) {
                    this.positions[t] = e.getPosition()
                }.bind(this))
            },
            updatePosition: function () {
                var e = cleverapps.styles.TournamentPlayersView.position;
                this.layout.setPositionRound(this.width / 2, this.height / 2), this.setPositionRound(this.width / 2, this.height / 2), this.setPositionRound(e), this.bg.setPositionRound(this.width / 2, this.height / 2)
            },
            afterOnChangeOutcome: function () {
                var e = cleverapps.UI.getSceneSize().width;
                this.runAction(new cc.MoveBy(1, -e / 2 * .025, 0).easing(cc.easeInOut(1.5)))
            },
            createBg: function () {
                var e = this.bg = new cc.Scale9Sprite(bundles.tournament.frames.tournament_bg_png);
                this.addChild(e), e.setLocalZOrder(-1),
                    e.setContentSize2(this.getContentSize())
            },
            onChangeResults: function () {
                this.competition.calcPlace(), this.views.sort(function (e, t) {
                    e = this.competition.results.indexOf(e.player), t = this.competition.results.indexOf(t.player) - e;
                    return cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && (t *= -1), t
                }.bind(this)), this.views.forEach(function (e, t) {
                    e.setLocalZOrder(t + 1), e.animateReorder(this.positions[t])
                }.bind(this))
            },
            animateResults: function (t) {
                this.views.forEach(function (e) {
                    e.player.player && e.animateResult(t)
                })
            },
            withinBoardView: function () {
                return cleverapps.isRumble()
            }
        })),
        ExpInfoWindow = (cleverapps.styles.TournamentPlayersView = {
            position: [{
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: -120
                }
            }, {
                x: {
                    align: "left",
                    dx: -20
                },
                y: {
                    align: "top",
                    dy: -165
                }
            }, {
                x: {
                    align: "left",
                    dx: -20
                },
                y: {
                    align: "top",
                    dy: -165
                }
            }],
            padding: {
                x: 15,
                y: 20
            },
            margin: 10
        }, Window.extend({
            onWindowLoaded: function () {
                var e = this.generateContent();
                this._super({
                    title: "ExpInfoWindow.Title",
                    name: "expinfowindow",
                    content: e
                }), Lottery.addText(this)
            },
            generateProductOption: function (e, t) {
                var s = cleverapps.styles.ExpInfoWindow,
                    i = Product.Create(e),
                    e = new cleverapps.UI.Button({
                        text: i.getCurrentPrice(),
                        onClicked: function () {
                            i.buy(function (e) {
                                e && this.close()
                            }.bind(this))
                        }.bind(this),
                        width: s.button.width,
                        height: s.button.height
                    }),
                    n = (Lottery.addIcon(e), new TextWithIcon(i.reward.exp + "%%", {
                        font: cleverapps.styles.FONTS.EXP_INFO_WINDOW_AMOUNT_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT,
                        icons: {
                            "%%": bundles.reward_icons.frames.reward_exp_png
                        }
                    })),
                    t = new cc.Sprite(t);
                return new cleverapps.Layout([t, n, e], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: s.button.itemsMargin
                })
            },
            generateContent: function () {
                var e = cleverapps.styles.ExpInfoWindow,
                    t = cleverapps.UI.generateOnlyText("ExpInfoWindow.Message", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT),
                    s = (t.setDimensions(e.text.width, 0), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), cleverapps.UI.generateOnlyText("ExpInfoWindow.BuyMessage", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT)),
                    i = (s.setDimensions(e.text.width, 0),
                        s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), new cleverapps.Layout([this.generateProductOption("buyExp10", bundles.exp_window.frames.small_exp_box), this.generateProductOption("buyExp150", bundles.exp_window.frames.exp_box)], {
                            direction: cleverapps.UI.HORIZONTAL,
                            margin: e.buttonsMargin,
                            align: cleverapps.UI.ALIGN_START
                        }));
                return new cleverapps.Layout([t, s, i], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin
                })
            },
            listBundles: function () {
                return ["exp_window"]
            }
        })),
        Chat = (cleverapps.styles.ExpInfoWindow = {
            margin: 30,
            buttonsMargin: 50,
            text: {
                width: 600
            },
            exp: {
                width: 400,
                height: 200
            },
            button: {
                itemsMargin: 3,
                width: 300,
                height: 100
            }
        }, function () {
            this.messages = [], cleverapps.EventEmitter.call(this), this.editingMode = !1, this.closing = !1, this.hasUnread = !1, this.wasUnreadMessages = !1, this.activeDialogueId = void 0, this.categoryTag = void 0, this.loadSave(), setInterval(this.reload.bind(this), cleverapps.parseInterval(Chat.RELOAD_INTERVAL))
        }),
        ChatMessage = (Chat.prototype = Object.create(cleverapps.EventEmitter.prototype), (
            Chat.prototype.constructor = Chat).IsAvailable = function () {
                if (cleverapps.config.wysiwygMode) return !1;
                if (cleverapps.chat.hasUnread) return !0;
                if (cleverapps.platform.oneOf(Mobage, SPMobage, GDCom, Huzcom, Pliega)) return !1;
                if (0 < cleverapps.paymentsHistory.classify()) return !0;
                var e = {};
                if ("merge" === cleverapps.config.type) {
                    var t = cleverapps.platform.oneOf(Instant) ? 6 : 9;
                    if (Game.currentGame && cleverapps.gameLevel.getLevel() < t) return !1
                } else e.level = 1;
                return e.registered = "3 days", levels.user.checkAvailable(e)
            }, Chat.prototype.loadSave = function () {
                var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.CHAT) || {};
                this.processed = e.processed || {}
            }, Chat.prototype.storeSave = function () {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.CHAT, {
                    processed: this.processed
                })
            }, Chat.prototype.load = function (t, s) {
                cleverapps.RestClient.get("/chat/messages/" + encodeURIComponent(cleverapps.platform.getUserID()), {}, function (e) {
                    this.processMessages(Array.isArray(e) ? e : []), MenuControlButton.updateAttention(), t && t()
                }.bind(this),
                    function (e) {
                        MenuControlButton.updateAttention(), s ? s(e) : this.printConnectionError(e)
                    }.bind(this))
            }, Chat.prototype.processMessages = function (e) {
                var e = e.map(ChatMessage.fromData),
                    i = (this.messages = [], this.hasUnread = !1, void 0),
                    n = void 0,
                    o = void 0,
                    e = (e.forEach(function (t) {
                        var s;
                        o && t.dialogueId !== o && this.messages.push(ChatMessage.createSeparator(o)), o = t.dialogueId;
                        try {
                            s = new Date(t.postDate).toLocaleDateString(cleverapps.settings.language || "en-US", {
                                year: "numeric",
                                month: "long",
                                day: "numeric"
                            })
                        } catch (e) {
                            s = new Date(t.postDate).toDateString()
                        }
                        s !== i && (i = s, this.messages.push(ChatMessage.createServiceMessage(s))), (1 === t.isResponse && 0 === t.readByUser || t.hasGift() && !t.isGiftTaken() && t.isApplicable()) && (this.hasUnread = !0, this.wasUnreadMessages = !0), t.hasGift() && this.processed[t.id] && (t.isGiftTaken() ? (delete this.processed[t.id], this.storeSave()) : cleverapps.RestClient.post("/chat/acceptGift", {
                            id: t.id
                        })), t.isTurningOnConsoleStream() ? (n = !0, this.messages.push(ChatMessage.createServiceMessage(
                            "ChatConsoleStreamSwitchOn", t.id))) : t.isTurningOffConsoleStream() ? (n = !1, this.messages.push(ChatMessage.createServiceMessage("ChatConsoleStreamSwitchOff", t.id))) : this.messages.push(t)
                    }.bind(this)), void 0 !== n && n ? cleverapps.consoleStream.enable(this.postMessage.bind(this, "Disable console stream", "stream_off", !0)) : void 0 === n || n || cleverapps.consoleStream.disable(), !1);
                0 === this.messages.length ? (this.messages.push(ChatMessage.createServiceMessage("ChatGreetingMessage")), e = !this.wasUnreadMessages) : this.getLastMessage() && -1 !== ["resolved", "no answer needed"].indexOf(this.getLastMessage().status) ? (this.messages.push(ChatMessage.createSeparator(o)), e = !this.wasUnreadMessages) : this.activeDialogueId = o, e && this.messages.push(ChatMessage.createCategoryButtons()), this.closing || (this.trigger("removeMessagesByType", ChatMessage.MESSAGE_TYPE.TEMPORARY), this.trigger("messagesUpdated"))
            }, Chat.prototype.postMessage = function (t, e, s) {
                var i, n = ChatMessage.createTemporaryMessage(t),
                    o = (this.messages.push(n),
                        s || this.trigger("messagesUpdated"), cleverapps.friends.getPlayer().name),
                    a = (o === Messages.get("Friends.You") && (o = Messages.get("LeadersWindow.player")), cleverapps.paymentsHistory.classify()),
                    r = (a <= cleverapps.PaymentsHistory.BRACKET_NONE && cleverapps.paymentsHistory.isPayer() && (a = cleverapps.PaymentsHistory.BRACKET_WEAK), cleverapps.user.getHumanReadableNumber());
                cleverapps.user.isPassedAll() && (i = Episode.LevelChooseAlgorithm({
                    start: 5,
                    seed: cleverapps.user.getPassAllProgress()
                }), r = cleverapps.humanReadableNumber(i.episodeNo, i.levelNo)), cleverapps.RestClient.post("/chat/message", {
                    message: t,
                    userid: cleverapps.platform.getUserID(),
                    isresponse: 0,
                    payerlevel: a,
                    name: o,
                    language: cleverapps.settings.language,
                    source: cleverapps.platform.source,
                    categoryTag: e || this.categoryTag,
                    level: r
                }, function () {
                    this.categoryTag = void 0, this.trigger("updatePlaceholder", void 0), this.load(function () {
                        this.trigger("removeMessagesByType", ChatMessage.MESSAGE_TYPE.CATEGORIES)
                    }.bind(this))
                }.bind(this), function () {
                    var e = this.messages.indexOf(n); - 1 !== e && this.messages.splice(e, 1), s || (this.trigger("removeMessagesByType", ChatMessage.MESSAGE_TYPE.TEMPORARY), this.trigger("returnMessageBack", t), this.printConnectionError())
                }.bind(this))
            }, Chat.prototype.selectCategory = function (e, t) {
                this.categoryTag === e ? (this.categoryTag = void 0, this.trigger("updatePlaceholder", "")) : (this.categoryTag = e, this.trigger("updatePlaceholder", t)), this.trigger("messagesUpdated")
            }, Chat.prototype.getLastMessage = function () {
                var e = cleverapps.chat.messages.filter(function (e) {
                    return e.dialogueId && e.status
                });
                return e[e.length - 1]
            }, Chat.prototype.markAsRead = function () {
                cleverapps.RestClient.post("/chat/markAsRead", {
                    userid: cleverapps.platform.getUserID()
                })
            }, Chat.prototype.acceptGift = function (t, e) {
                var s, i, n;
                this.processed[t.id] ? this.reload() : (s = !1, e && (t.progress ? (cleverapps.user.level = parseInt(t.progress.level), cleverapps.user.episode = parseInt(t.progress.episode), cleverapps.user.save(), cleverapps.hose && (cleverapps.hose.reset(),
                    cleverapps.hose.setCurrentEpisode(levels.user.episode))) : t.restoreProgressId ? cleverapps.synchronizer.getProgress(t.restoreProgressId) : t.presents ? (delete (e = cleverapps.clone(t.presents, s = !0)).expedition, cleverapps.chatPresents = {
                        reward: e,
                        callback: function () {
                            cleverapps.chat.processed[t.id] = !0, cleverapps.chat.storeSave(), cleverapps.RestClient.post("/chat/acceptGift", {
                                id: t.id
                            }, function () {
                                cleverapps.chat.reload()
                            })
                        }
                    }, this.closing = !0, (i = cleverapps.travelBook.getPageById(t.presents.expedition)) ? cleverapps.meta.display({
                        focus: "closeScene",
                        action: function (e) {
                            i.gotoExpedition(e)
                        }
                    }) : cleverapps.scenes.getRunningScene().closeAction()) : t.metha ? t.metha.simple ? (cleverapps.simple.current = t.metha.simple.current, cleverapps.simple.stars = 0, cleverapps.simple.save()) : t.metha.farm ? (Farm.Reset(), e = Farm.GetBuildingProgress(t.metha.farm.building, t.metha.farm.quest), cleverapps.farm.load(e), cleverapps.farm.save()) : t.metha.home && (cleverapps.home.load(Home.GetFurnitureProgress(t.metha.home.furniture, t.metha.home.stage)), cleverapps.home.save()) : t.harvested && (n = new Harvested(CustomSyncers.SLOT_MAIN), Object.keys(t.harvested).forEach(function (e) {
                        -1 !== cleverapps.unitsLibrary.listAvailableByType("fruit").indexOf(e) && (n.add(e, t.harvested[e]), cleverapps.user.incProgressCompare())
                    })), cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect)), s || (this.processed[t.id] = !0, this.storeSave(), cleverapps.RestClient.post("/chat/acceptGift", {
                        id: t.id
                    }, this.reload.bind(this))))
            }, Chat.prototype.printConnectionError = function () {
                this.messages.push(ChatMessage.createServiceMessage(Messages.get("RestartWindow.AnErrorOccured"), "error_" + Date.now())), this.trigger("messagesUpdated")
            }, Chat.prototype.reload = function () {
                !Chat.IsAvailable() && this.notFirstLoad || cleverapps.environment.hasScene([cleverapps.Environment.SCENE_MAIN, cleverapps.Environment.SCENE_CHAT]) && (this.load(), this.notFirstLoad = !0)
            }, Chat.prototype.giveRewards = function () {
                var e = "merge" === cleverapps.config.type && cleverapps.chatPresents.reward.unit;
                if (e) {
                    var t = e.amount - Game.currentGame.map.countEmptySlots();
                    if (0 < t) return delete cleverapps.chatPresents, void Game.currentGame.centerHint.createTextHint("Spawn.nospace", {
                        left: t
                    });
                    if (!this.canAcceptUnit(e)) return delete cleverapps.chatPresents, void Game.currentGame.centerHint.createTextHint("RestartWindow.OnError")
                }
                cleverapps.meta.display({
                    focus: "chatPresentsWindow",
                    action: function (e) {
                        new RewardWindow(cleverapps.chatPresents.reward), cleverapps.meta.onceNoWindowsListener = e, cleverapps.chatPresents.callback(), delete cleverapps.chatPresents
                    }
                })
            }, Chat.prototype.canAcceptUnit = function (e) {
                return cleverapps.unitsLibrary.isOpened(e) || Families[e.code].units[e.stage].climbable || ["clpet", "clpetrare", "clpetlegend", "xmproduct0", "xmproduct1", "xmproduct2", "drproduct0", "drproduct1", "drproduct2"].includes(Families[e.code].type) || ["landmark", "dragonpack", "underseapack", "sea2pack", "hlpack", "xmpack", "rpcampaign", "dr2campaign", "dr2dragonpack", "hlcampaign", "hlgnome", "hlcandle", "hlspider", "hlflittermouse"].includes(
                    e.code)
            }, Chat.RELOAD_INTERVAL = "1 minute", Chat.CATEGORIES = [{
                message: "ChatCategory.ProblemWithPayment",
                tag: "payment",
                placeholder: "ChatCategory.ProblemWithPaymentPlaceholder"
            }, {
                message: "ChatCategory.QuestionAboutTheRules",
                tag: "FAQ",
                placeholder: "ChatCategory.QuestionAboutTheRulesPlaceholder"
            }, {
                message: "ChatCategory.ReportABag",
                tag: "bug",
                placeholder: "ChatCategory.ReportABagPlaceholder"
            }, {
                message: "ChatCategory.AdsProblem",
                tag: "no ads",
                placeholder: "ChatCategory.AdsProblemPlaceholder"
            }, {
                message: "ChatCategory.Suggestions",
                tag: "suggestion",
                placeholder: "ChatCategory.SuggestionsPlaceholder"
            }, {
                message: "ChatCategory.OtherQuestions",
                tag: "other",
                placeholder: "ChatCategory.OtherQuestionsPlaceholder"
            }], function () { }),
        CategoriesView = (ChatMessage.fromData = function (e) {
            var t = new ChatMessage;
            return t.id = e.id, t.userId = e.userId, t.postDate = e.postDate, t.message = e.message, t.isResponse = e.isResponse, t.readByUser = e.readByUser, t.tag = e.tag, t.status = e.status, t.dialogueId = e.dialogueId, t.type = ChatMessage.MESSAGE_TYPE.CHAT,
                t
        }, ChatMessage.createServiceMessage = function (e, t) {
            var s = new ChatMessage;
            return s.id = t || "service_" + e, s.message = e, s.type = ChatMessage.MESSAGE_TYPE.SERVICE, s
        }, ChatMessage.createSeparator = function (e) {
            var t = new ChatMessage;
            return t.id = "separator_" + e, t.type = ChatMessage.MESSAGE_TYPE.SEPARATOR, t
        }, ChatMessage.createTemporaryMessage = function (e) {
            var t = new ChatMessage;
            return t.id = "tmp_" + e, t.message = e, t.type = ChatMessage.MESSAGE_TYPE.TEMPORARY, t.postDate = (new Date).toString(), t
        }, ChatMessage.createCategoryButtons = function () {
            var e = new ChatMessage;
            return e.id = "category_buttons", e.type = ChatMessage.MESSAGE_TYPE.CATEGORIES, e
        }, ChatMessage.prototype.hasGift = function () {
            return "gift" === this.tag || "takengift" === this.tag
        }, ChatMessage.prototype.isGiftTaken = function () {
            return "takengift" === this.tag
        }, ChatMessage.prototype.isTurningOnConsoleStream = function () {
            return "stream_on" === this.tag
        }, ChatMessage.prototype.isTurningOffConsoleStream = function () {
            return "stream_off" === this.tag
        },
            ChatMessage.prototype.isFromActiveOrUnreadDialogue = function () {
                if (cleverapps.chat.activeDialogueId === this.dialogueId) return !0;
                var e = (cleverapps.chat.getLastMessage() || {}).dialogueId;
                return cleverapps.chat.wasUnreadMessages && this.dialogueId === e
            }, ChatMessage.prototype.isApplicable = function () {
                if (this.parseGift(), this.metha)
                    if (this.metha.farm) {
                        var e = parseInt(this.metha.farm.building),
                            e = cleverapps.farm.buildings[e],
                            t = parseInt(this.metha.farm.quest);
                        if (!e || t >= e.quests.length) return !1
                    } else if (this.metha.simple) return parseInt(this.metha.simple.current) < cleverapps.simple.bgsAmount;
                return this.harvested ? 0 < Object.keys(this.harvested).filter(function (e) {
                    return -1 !== cleverapps.unitsLibrary.listAvailableByType("fruit").indexOf(e)
                }).length : !this.presents || !this.presents.expedition || (t = cleverapps.travelBook.getPageById(this.presents.expedition)) && t.isActive()
            }, ChatMessage.prototype.parseGift = function () {
                var e, i;
                this.parsed || (this.parsed = !0, (e = JSON.parse(this.message)).presents ? (i = this.presents = {},
                    e.expedition && (i.expedition = e.expedition), e.presents.forEach(function (e) {
                        var t, s;
                        "object" == typeof e && void 0 !== e.type && void 0 !== e.amount && ("coins" === (t = e.type) ? t = "soft" : "gold" === t ? t = "hard" : "lives2" === t && (t = "lives"), -1 === ["hard", "unlimitedLives", "stars", "exp", "lives", "soft", "wands", "worker", "unit", "growthFund"].indexOf(t) && 0 !== t.indexOf("booster") && 0 !== t.indexOf("hl") || (s = e.amount, 0 === t.indexOf("booster") ? (void 0 === i.boosters && (i.boosters = []), i.boosters[parseInt(t.replace("booster", ""))] = s) : "unlimitedLives" === t ? i.unlimitedLives = s + " hour" : "worker" === t ? i.worker = s + " hour" : -1 !== t.indexOf("hl") ? (i.herolevels || (i.herolevels = []), i.herolevels.push([t.replace("hl", ""), e.amount])) : "unit" === t ? i.unit = {
                            code: e.code,
                            stage: e.stage,
                            amount: s || 1
                        } : i[t] = s))
                    })) : e.progress ? this.progress = e.progress : e.restoreProgressId ? this.restoreProgressId = e.restoreProgressId : e.metha ? this.metha = e.metha : e.harvested && (this.harvested = e.harvested))
            }, ChatMessage.MESSAGE_TYPE = {
                CHAT: 0,
                SERVICE: 1,
                TEMPORARY: 2,
                SEPARATOR: 3,
                CATEGORIES: 4
            },
            cc.Node.extend({
                ctor: function (e) {
                    this._super(), this.chatMessage = e, this.setAnchorPoint2(0, .5), this.captionText = cleverapps.UI.generateOnlyText("ChatCategory.Select", cleverapps.styles.FONTS.STRICT_TEXT), this.captionText.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.addChild(this.captionText), this.updateSize()
                },
                updateSize: function () {
                    var e = cleverapps.styles.CategoriesView,
                        t = this.createCategoriesRows();
                    this.setContentSize2(cleverapps.UI.getSceneSize().width, this.captionText.height + t.length * (e.margin + e.button.height) + e.padding), this.categoriesLayout && this.categoriesLayout.removeFromParent(), this.categoriesLayout = new cleverapps.Layout(t, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.margin
                    }), this.categoriesLayout.setPositionRound(e.categories), this.addChild(this.categoriesLayout), this.captionText.setDimensions(cleverapps.UI.getSceneSize().width - e.padding, 0), this.captionText.setPositionRound(e.caption)
                },
                createCategoriesRows: function () {
                    function i(e) {
                        cleverapps.chat.selectCategory(e.tag,
                            Messages.get(e.placeholder))
                    }
                    for (var n = cleverapps.styles.CategoriesView, e = Chat.CATEGORIES.map(function (e) {
                        var t, s = new cleverapps.UI.Button({
                            text: e.message,
                            type: cleverapps.styles.UI.Button.Images.chat_categories,
                            onClicked: i.bind(this, e),
                            textVariant: "strict_black",
                            height: n.button.height
                        });
                        return s.setBright(e.tag !== cleverapps.chat.categoryTag), e.tag === cleverapps.chat.categoryTag && ((t = new cc.Sprite(bundles.chat.frames.active_category_close)).setPositionRound(n.closeButton), cleverapps.UI.applyHover(t), cleverapps.UI.onClick(t, i.bind(this, e)), s.addChild(t)), s
                    }), t = [], s = [], o = 0; o < e.length; o++) s.reduce(function (e, t) {
                        return e + t.width
                    }, 0) + e[o].width > .8 * cleverapps.UI.getSceneSize().width && (t.push(s), s = []), s.push(e[o]);
                    return t.push(s), t.map(function (e) {
                        return new cleverapps.Layout(e, {
                            direction: cleverapps.UI.HORIZONTAL,
                            margin: n.margin
                        })
                    })
                }
            })),
        ChatMessageView = (cleverapps.styles.CategoriesView = {
            padding: 50,
            margin: 14,
            caption: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: -20
                }
            },
            categories: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: -70
                }
            },
            button: {
                height: 80
            },
            closeButton: {
                x: {
                    align: "right",
                    dx: 6
                },
                y: {
                    align: "top",
                    dy: 6
                }
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.chatMessage = e, this.setAnchorPoint2(0, .5);
                var e = new Date(e.postDate).toLocaleTimeString(cleverapps.settings.language, {
                    hour12: !1,
                    hour: "2-digit",
                    minute: "2-digit"
                }),
                    e = this.messageTimeText = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.CHAT_MESSAGE_TIME_TEXT),
                    t = (e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_RIGHT), this.bg = cleverapps.UI.createScale9Sprite(this.chatMessage.isResponse ? bundles.chat.frames.dialog_box_white : bundles.chat.frames.dialog_box_green));
                this.addChild(t, -1), this.content = this.createContent(this.chatMessage), t.addChild(this.content), t.addChild(e), this.chatMessage.isResponse || (this.chatMessage.readByUser ? this.mark = new cc.Sprite(bundles.chat.frames.checkmark_read) : this.chatMessage.type === ChatMessage.MESSAGE_TYPE.TEMPORARY ? this.mark = new cc.Sprite(bundles.chat.frames.checkmark_tmp) : this.mark = new cc.Sprite(
                    bundles.chat.frames.checkmark_sent), t.addChild(this.mark)), this.updateSize()
            },
            createContent: function (e) {
                return e.hasGift() ? new GiftContentView(e) : (this.chatMessage.isFromActiveOrUnreadDialogue() ? (this.messageText = cleverapps.UI.generateOnlyText(e.message, cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT), this.bg.setColor(new cc.Color(255, 255, 255, 255)), this.bg.setOpacity(255)) : (this.messageText = cleverapps.UI.generateOnlyText(e.message, cleverapps.styles.FONTS.CHAT_DISABLED_MESSAGE_TEXT), this.bg.setColor(new cc.Color(200, 200, 200, 255)), this.bg.setOpacity(150)), this.messageText.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT), this.messageText)
            },
            updateContent: function (e) {
                this.content && this.content.removeFromParent(), this.content = this.createContent(e), this.bg.addChild(this.content), this.updateSize()
            },
            updateSize: function () {
                var e = cleverapps.styles.ChatMessageView,
                    t = .7 * cleverapps.UI.getSceneSize().width;
                t > e.maxWidth ? t = e.maxWidth : t < e.minWidth && (t = e.minWidth), this.messageText ? (this.messageText.setDimensions(
                    t, 0), this.setContentSize2(cleverapps.UI.getSceneSize().width, this.messageText.height + 2 * e.text.padding)) : this.setContentSize2(cleverapps.UI.getSceneSize().width, this.content.height + 2 * e.text.padding), this.bg.setContentSize(t + 2 * e.text.padding, this.height), this.chatMessage.isResponse ? (this.bg.setAnchorPoint2(0, .5), this.bg.setPosition("horizontal" !== cleverapps.config.orientation ? e.responseBg.verticalOffsetX : e.responseBg.offsetX, this.height / 2)) : this.bg.setPositionRound(e.questionBg), this.content.setPositionRound(this.bg.width / 2 + (this.chatMessage.isResponse ? e.text.responceOffsetX : 0), this.bg.height / 2 + e.text.offsetY), this.messageTimeText.setDimensions(e.time.width, e.time.height), this.messageTimeText.setPositionRound(this.chatMessage.isResponse ? e.time.response : e.time.question), this.mark && this.mark.setPositionRound(e.mark)
            }
        })),
        GiftContentView = (cleverapps.styles.ChatMessageView = {
            minWidth: 500,
            maxWidth: 900,
            text: {
                padding: 30,
                responceOffsetX: 5,
                offsetY: 2
            },
            time: {
                width: 200,
                height: 26,
                response: {
                    x: {
                        align: "right",
                        dx: -34
                    },
                    y: {
                        align: "bottom",
                        dy: 16
                    }
                },
                question: {
                    x: {
                        align: "right",
                        dx: -56
                    },
                    y: {
                        align: "bottom",
                        dy: 16
                    }
                }
            },
            mark: {
                x: {
                    align: "right",
                    dx: -22
                },
                y: {
                    align: "bottom",
                    dy: 18
                }
            },
            responseBg: {
                offsetX: 32,
                verticalOffsetX: 4
            },
            questionBg: {
                x: {
                    align: "right",
                    dx: -30
                },
                y: {
                    align: "center"
                }
            }
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CHAT_MESSAGE_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.BLACK,
                font: bundles.chat.urls.strict_font_ttf
            },
            CHAT_DISABLED_MESSAGE_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.COLOR_DARK_GRAY,
                font: bundles.chat.urls.strict_font_ttf
            },
            CHAT_MESSAGE_TIME_TEXT: {
                size: 26,
                color: new cc.Color(138, 138, 138, 255),
                font: bundles.chat.urls.strict_font_ttf
            }
        }), cleverapps.Layout.extend({
            ctor: function (e) {
                this.chatMessage = e;
                var t, s, i, n, p, o, e = cleverapps.styles.GiftContentView,
                    a = (this.chatMessage.parseGift(), Math.min(.6 * cleverapps.UI.getSceneSize().width, e.width)),
                    r = [],
                    c = cleverapps.UI.createScale9Sprite(bundles.chat.frames.gift_bg),
                    d = new cc.Sprite(bundles.chat.frames.checkmark_gift),
                    u = this.chatMessage.isGiftTaken() ? d.height : 0,
                    l = !1;
                this.chatMessage.presents && this.chatMessage.presents.expedition && (l = !(o = cleverapps.travelBook.getPageById(this.chatMessage.presents.expedition)) || !o.isActive()), this.chatMessage.progress || this.chatMessage.metha || this.chatMessage.restoreProgressId || l ? (this.chatMessage.metha ? this.chatMessage.metha.simple ? t = (o = parseInt(this.chatMessage.metha.simple.current)) < cleverapps.simple.bgsAmount ? cleverapps.UI.generateOnlyText("AdminSetMethaProgress.Text", cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT, {
                    bgIndex: o
                }) : cleverapps.UI.generateOnlyText("AdminSetMethaProgress.Text.Unavailable", cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT) : this.chatMessage.metha.farm ? (o = parseInt(this.chatMessage.metha.farm.building), s = cleverapps.farm.buildings[o], i = parseInt(this.chatMessage.metha.farm.quest), t = s && i < s.quests.length ? (o = Messages.get("building." + cleverapps.farm.buildings[o].name), n = Messages.get(0 < i ? "AdminSetFarmProgress.Text.Quest" : "AdminSetFarmProgress.Text", {
                    buildingName: o,
                    questName: Messages.get(s.quests[i].title)
                }), cleverapps.UI.generateOnlyText(n, cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)) : cleverapps.UI.generateOnlyText("AdminSetFarmProgress.Text.Unavailable", cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)) : this.chatMessage.metha.home && (o = parseInt(this.chatMessage.metha.home.furniture), s = cleverapps.home.furniture[o], i = parseInt(this.chatMessage.metha.home.stage), t = s && i < s.stages.length ? (o = Messages.get("building." + s.name), n = Messages.get(0 < i ? "AdminSetHomeProgress.Text.Stage" : "AdminSetHomeProgress.Text", {
                    furnitureName: o,
                    stageName: Messages.get(s.stages[i].title)
                }), cleverapps.UI.generateOnlyText(n, cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)) : cleverapps.UI.generateOnlyText("AdminSetHomeProgress.Text.Unavailable", cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)) : t = this.chatMessage.restoreProgressId ? cleverapps.UI.generateOnlyText("AdminRestoreProgress.Text", cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT, {
                    userId: this.chatMessage.restoreProgressId
                }) : l ? cleverapps.UI.generateOnlyText("ItemsFromCompletedExpedition", cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT) : (o = cleverapps.humanReadableNumber(parseInt(this.chatMessage.progress.episode), parseInt(this.chatMessage.progress.level)), cleverapps.UI.generateOnlyText("AdminSetProgress.Text", cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT, {
                    levelNo: o
                })), t.setDimensions(a, 0), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), c.setContentSize(a + e.bg.padding, Math.max(e.minHeight, t.height + e.bg.padding + u)), c.addChild(t), t.setPositionRound(c.width / 2, c.height / 2 + u / 2), r.push(c)) : (this.chatMessage.presents || this.chatMessage.harvested) && (s = this.chatMessage.presents && this.chatMessage.presents.herolevels && 0 < this.chatMessage.presents.herolevels.length, (t = cleverapps.UI.generateOnlyText(s ? "AdminGiftsHeroes" : "AdminGiftsText", cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)).setDimensions(a, 0), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), r.push(t), i = cleverapps.clone(this.chatMessage.presents, !0), delete (
                    i = this.chatMessage.harvested ? {
                        unit: Object.keys(this.chatMessage.harvested).map(function (e) {
                            return {
                                code: e,
                                amount: this.chatMessage.harvested[e],
                                stage: 4
                            }
                        }.bind(this))
                    } : i).expedition, n = new RewardsListComponent(i, {
                        columns: s ? 3 : 2,
                        font: cleverapps.styles.FONTS.CHAT_REWARD_COUNT_TEXT,
                        textDirection: cleverapps.UI.HORIZONTAL
                    }), l = Math.min(.9 * a / n.width, 1), n.setScale(l), c.setContentSize(a + e.bg.padding, Math.max(e.minHeight, n.height * l + u + e.bg.padding)), c.addChild(n), n.setPositionRound(c.width / 2, c.height / 2 + u / 2), r.push(c)), this.chatMessage.isGiftTaken() ? (d.setPositionRound(e.checkmark), c.addChild(d)) : this.chatMessage.isApplicable() && (void 0 === this.chatMessage.progress && void 0 === this.chatMessage.metha || (p = new cleverapps.UI.Button({
                        text: "No",
                        type: cleverapps.styles.UI.Button.Images.chat,
                        onClicked: function () {
                            cleverapps.chat.acceptGift(this.chatMessage, !1)
                        }.bind(this),
                        textVariant: "strict_black",
                        width: e.buttons.width,
                        height: e.buttons.height
                    })), o = new cleverapps.UI.Button({
                        text: void 0 !== this.chatMessage.progress ? "Yes" : "Accept",
                        type: cleverapps.styles.UI.Button.Images.chat,
                        onClicked: function () {
                            cleverapps.chat.acceptGift(this.chatMessage, !0)
                        }.bind(this),
                        textVariant: "strict_black",
                        width: e.buttons.width,
                        height: e.buttons.height
                    }), r.push(new cleverapps.Layout([p, o], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: e.margin
                    }))), this._super(r, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.margin,
                        padding: e.padding
                    })
            }
        })),
        MessageSeparatorView = (cleverapps.styles.GiftContentView = {
            width: 840,
            minHeight: 220,
            margin: 10,
            padding: {
                x: 10,
                y: 10
            },
            buttons: {
                width: 200,
                height: 60
            },
            checkmark: {
                x: {
                    align: "right",
                    dx: -6
                },
                y: {
                    align: "bottom",
                    dy: 10
                }
            },
            bg: {
                padding: 20
            }
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CHAT_REWARD_COUNT_TEXT: {
                size: 56,
                color: cleverapps.styles.COLORS.COLOR_BROWN,
                font: bundles.chat.urls.strict_font_ttf,
                name: "nostroke"
            }
        }), cc.Node.extend({
            ctor: function (e) {
                this._super(), this.chatMessage = e, this.setAnchorPoint2(0, .5), this.line = cleverapps.UI.createScale9Sprite(
                    bundles.chat.frames.dialogue_separator), this.addChild(this.line), this.updateSize()
            },
            updateSize: function () {
                var e = cleverapps.styles.MessageSeparatorView;
                this.setContentSize2(cleverapps.UI.getSceneSize().width, e.height), this.line.setContentSize(cleverapps.UI.getSceneSize().width - 2 * e.line.padding, e.line.height), this.line.setPositionRound(this.width / 2, this.height / 2)
            }
        })),
        MessageViewFactory = (cleverapps.styles.MessageSeparatorView = {
            height: 50,
            line: {
                height: 3,
                padding: 40
            }
        }, {}),
        ServiceMessageView = (MessageViewFactory.create = function (e) {
            switch (e.type) {
                case ChatMessage.MESSAGE_TYPE.SERVICE:
                    return new ServiceMessageView(e);
                case ChatMessage.MESSAGE_TYPE.SEPARATOR:
                    return new MessageSeparatorView(e);
                case ChatMessage.MESSAGE_TYPE.CATEGORIES:
                    return new CategoriesView(e);
                default:
                    return new ChatMessageView(e)
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.chatMessage = e, this.setAnchorPoint2(0, .5), this.messageText = cleverapps.UI.generateOnlyText(e.message, cleverapps.styles.FONTS.SERVICE_MESSAGE_TEXT),
                    this.messageText.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.addChild(this.messageText), this.updateSize()
            },
            updateSize: function () {
                this.messageText.setDimensions(cleverapps.UI.getSceneSize().width - cleverapps.styles.ServiceMessageView.padding, 0), this.setContentSize2(cleverapps.UI.getSceneSize().width, this.messageText.height + cleverapps.styles.ServiceMessageView.padding), this.messageText.setPositionRound(this.width / 2, this.height / 2)
            }
        })),
        ChatHeader = (cleverapps.styles.ServiceMessageView = {
            padding: 50
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            SERVICE_MESSAGE_TEXT: {
                size: 30,
                color: new cc.Color(83, 97, 106, 255),
                font: bundles.chat.urls.strict_font_ttf
            }
        }), cc.Scale9Sprite.extend({
            ctor: function (e) {
                this._super(bundles.chat.frames.panelup), this.setAnchorPoint2(0, 1);
                var t = cleverapps.styles.ChatHeader,
                    s = cleverapps.UI.generateOnlyText(Messages.get("ChatTitle"), cleverapps.styles.FONTS.CHAT_HEADER_TEXT),
                    i = (e.closing = !1, this.backButton = new cleverapps.UI.Button({
                        noBg: !0,
                        content: new cc.Sprite(
                            bundles.chat.frames.icon_back),
                        onClicked: function () {
                            e.closing = !0, setTimeout(function () {
                                cleverapps.scenes.getRunningScene().closeAction()
                            }, cc.sys.isMobile && e.editingMode ? 500 : 100)
                        },
                        width: t.back.width,
                        height: t.back.height
                    }));
                s.setPosition(0, t.text.offsetY), this.content = new cleverapps.Layout([i, s], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: t.back.margin
                }), this.addChild(this.content), this.updateSize()
            },
            updateSize: function () {
                var e = cleverapps.styles.ChatHeader;
                this.setContentSize2(cleverapps.UI.getSceneSize().width, e.height), this.setPosition(0, cleverapps.UI.getSceneSize().height), this.content.setPositionRound(this.width / 2 + e.content.offsetX, this.height / 2), cleverapps.UI.fitToBox(this.content, {
                    width: .8 * cleverapps.UI.getSceneSize().width,
                    height: e.height
                }), this.backButton.setScale(1 / this.content.scale)
            }
        })),
        ChatInput = (cleverapps.styles.ChatHeader = {
            height: 130,
            content: {
                offsetX: -50
            },
            text: {
                offsetY: -3
            },
            back: {
                width: 120,
                height: 120,
                margin: 25
            }
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CHAT_HEADER_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.BLACK
            }
        }), cc.Scale9Sprite.extend({
            ctor: function (e) {
                this._super(bundles.chat.frames.paneldown);
                var t = cleverapps.styles.ChatInput,
                    e = (this.chat = e, this.inputHeight = t.height, this.setAnchorPoint2(0, 0), this.sendButton = new cleverapps.UI.Button({
                        noBg: !0,
                        text: "``",
                        textOff: "~~",
                        icons: {
                            "``": bundles.chat.frames.panel_on,
                            "~~": bundles.chat.frames.panel_off
                        },
                        onClicked: this.send.bind(this),
                        width: t.sendButton.width,
                        height: this.inputHeight,
                        fitTo: !1
                    })),
                    e = (e.disable(), this.addChild(e), this.charsCountText = cleverapps.UI.generateOnlyText("0/500", cleverapps.styles.FONTS.CHAT_CHARS_COUNT_TEXT), this.charsCountText.setVisible(!1), this.charsCountText.setDimensions(t.charsCount.width, 0), this.charsCountText.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.addChild(this.charsCountText), this.textAreaBg = cleverapps.UI.createScale9Sprite(bundles.chat.frames.textbox)),
                    e = (this.addChild(e), this.text = new cc.EditBox(cc.size(e.width - t.textPadding.x,
                        e.height - t.textPadding.y)));
                e.setDelegate(this), e.stayOnTop(!0), e.setTouchEnabled(), e.setMaxLength(500), e.setFontColor(cleverapps.styles.FONTS.CHAT_INPUT_FIELD_TEXT.color), this.textAreaBg.addChild(this.text), this.updateSize(), this.chat.on("returnMessageBack", this.returnMessageBack.bind(this), this), this.chat.on("updatePlaceholder", this.updatePlaceholder.bind(this), this)
            },
            updateSize: function () {
                var e = cleverapps.styles.ChatInput;
                this.setContentSize2(cleverapps.UI.getSceneSize().width, this.inputHeight + e.padding), this.setPosition(0, 0), this.textAreaBg.setContentSize(this.width - e.textArea.rightMargin, this.inputHeight), this.textAreaBg.setPositionRound(e.textArea), this.sendButton.setContentSize(e.sendButton.width, this.inputHeight), this.sendButton.setPositionRound(e.sendButton), this.text.setContentSize(this.textAreaBg.width - e.textPadding.x, this.textAreaBg.height - e.textPadding.y), this.text.setPositionRound(this.textAreaBg.width / 2, this.textAreaBg.height / 2), this.charsCountText.setPositionRound(
                    e.charsCount)
            },
            send: function () {
                var e = this.getMessageText();
                0 < e.length && (this.text.setString(""), this.sendButton.disable(), this.charsCountText.setVisible(!1), this.chat.postMessage(e))
            },
            returnMessageBack: function (e) {
                this.text.setString(e), this.editBoxTextChanged(this.text, e)
            },
            updatePlaceholder: function (e) {
                this.placeholderText = e, 0 < this.getMessageText().length || !e || (this.text.setString(e), this.text.setFont("Rubik", cleverapps.styles.FONTS.CHAT_INPUT_FIELD_TEXT.size), this.text.setFontColor(cleverapps.styles.FONTS.CHAT_INPUT_FIELD_TEXT.placeholderColor), this.placeholderShown = !0)
            },
            editBoxTextChanged: function (e, t) {
                0 < this.getMessageText(t).length ? this.sendButton.enable() : this.sendButton.disable(), this.text.setFont("Rubik", cleverapps.styles.FONTS.CHAT_INPUT_FIELD_TEXT.size), this.text.setFontColor(cleverapps.styles.FONTS.CHAT_INPUT_FIELD_TEXT.color), 400 <= this.text.getString().length ? (this.charsCountText.setVisible(!0), this.charsCountText.setString(this.text.getString().length + "/500"),
                    this.charsCountText.setFont(450 <= this.text.getString().length ? cleverapps.styles.FONTS.CHAT_CHARS_COUNT_RED_TEXT : cleverapps.styles.FONTS.CHAT_CHARS_COUNT_TEXT)) : this.charsCountText.setVisible(!1)
            },
            editBoxReturn: function () {
                setTimeout(this.send.bind(this), 0)
            },
            getMessageText: function (e) {
                return this.placeholderShown ? "" : (e = e || this.text.getString()).trim().replace(/(?:\r\n|\r|\n)/g, "").replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g, "�")
            },
            editBoxEditingDidBegin: function () {
                this.chat.editingMode = !0, this.placeholderShown && (this.text.setString(""), this.placeholderShown = !1)
            },
            editBoxEditingDidEnd: function () {
                this.chat.editingMode = !1, this.placeholderText && this.updatePlaceholder(this.placeholderText)
            }
        })),
        ChatScene = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CHAT_INPUT_FIELD_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.BLACK,
                placeholderColor: cleverapps.styles.COLORS.COLOR_DARK_GRAY,
                font: bundles.chat.urls.strict_font_ttf
            },
            CHAT_CHARS_COUNT_TEXT: {
                size: 22,
                color: cleverapps.styles.COLORS.COLOR_VERY_DARK_GRAY,
                font: bundles.chat.urls.strict_font_ttf
            },
            CHAT_CHARS_COUNT_RED_TEXT: {
                size: 22,
                color: new cc.Color(243, 60, 60, 255),
                font: bundles.chat.urls.strict_font_ttf
            }
        }), cleverapps.styles.ChatInput = {
            height: 150,
            padding: 22,
            sendButton: {
                x: {
                    align: "right",
                    dx: -15
                },
                y: {
                    align: "center"
                },
                width: 150
            },
            charsCount: {
                x: {
                    align: "right",
                    dx: -40
                },
                y: {
                    align: "bottom",
                    dy: 10
                },
                width: 100
            },
            textArea: {
                rightMargin: 230,
                x: {
                    align: "left",
                    dx: 50
                },
                y: {
                    align: "center",
                    dy: -6
                }
            },
            textPadding: {
                x: 40,
                y: 12
            }
        }, cleverapps.FixedWidthScene.extend({
            ctor: function (e) {
                this._super(), this.chat = e
            },
            onSceneLoaded: function () {
                this._super(cleverapps.Environment.SCENE_CHAT);
                var e = new ChatHeader(this.chat),
                    e = (this.addChild(e), new ChatView(this.chat)),
                    e = (this.addChild(e), new ChatInput(this.chat));
                this.addChild(e), cleverapps.placements.run(Placements.INTERMEDIATE), this.chat.hasUnread && this.chat.markAsRead()
            },
            getBackgroundStyles: function () {
                return {
                    bundle: "chat",
                    patternId: "window_bg"
                }
            },
            listBundles: function () {
                var t = ["chat"];
                return "undefined" != typeof match3 && t.push("heroes_game"), "merge" === cleverapps.config.type && (t.push("episode_0"), t.push("game"), t.push("units_main"), t.push("landmarks"), cleverapps.chat.messages.forEach(function (e) {
                    e.hasGift() && (e = JSON.parse(e.message), (e = cleverapps.travelBook.getPageById(e.expedition)) && t.push(Map2d.getUnitsTexture(e.getCurrentLevel())))
                })), t
            }
        })),
        ChatView = cc.Node.extend({
            ctor: function (e) {
                this.chat = e, this.messageViews = {}, this._super(), this.setAnchorPoint2();
                e = this.container = new cc.Node;
                e.setAnchorPoint2(), this.scroll = new cleverapps.UI.ScrollView(e, {
                    childrenVisibility: cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK
                }), this.scroll.setAnchorPoint2(0, 0), this.scroll.setPositionRound(0, 0), this.addChild(this.scroll), this.updateSize(), this.chat.on("messagesUpdated", this.updateMessages.bind(this), this), this.chat.on("removeMessagesByType", this.removeMessagesByType.bind(this), this)
            },
            updateMessages: function () {
                this.chat.messages.forEach(function (e) {
                    var t;
                    this.messageViews[e.id] ? e.tag !== this.messageViews[e.id].chatMessage.tag ? this.messageViews[e.id].updateContent(e) : e.type === ChatMessage.MESSAGE_TYPE.CATEGORIES && this.messageViews[e.id].updateSize() : (t = MessageViewFactory.create(e), this.container.addChild(t), this.messageViews[e.id] = t)
                }.bind(this));
                var e = cleverapps.UI.arrangeWithMargins(this.container.getChildren(), {
                    margin: cleverapps.styles.ChatView.margin,
                    direction: cleverapps.UI.VERTICAL
                });
                e < this.scroll.height && (e = this.scroll.height), this.container.setContentSize2(cleverapps.UI.getSceneSize().width, e), this.scroll.updateInnerContent(), this.scroll.scrollToPercent(0)
            },
            removeMessagesByType: function (t) {
                Object.keys(this.messageViews).forEach(function (e) {
                    this.messageViews[e] && this.messageViews[e].chatMessage && this.messageViews[e].chatMessage.type === t && (this.messageViews[e].removeFromParent(), this.messageViews[e] = void 0)
                }.bind(this)), this.updateMessages()
            },
            updateSize: function () {
                var e = cleverapps.styles.ChatView,
                    t = cleverapps.styles.ChatInput.height,
                    t = cleverapps.UI.getSceneSize().height - cleverapps.styles.ChatHeader.height - t - e.extraHeight;
                this.scroll.setContentSize2(cleverapps.UI.getSceneSize().width, t), this.setContentSize2(this.scroll.getContentSize()), this.setPositionRound(e), this.chat.messages.forEach(function (e) {
                    this.messageViews[e.id] && this.messageViews[e.id].updateSize()
                }.bind(this)), this.updateMessages()
            }
        }),
        Aims = (cleverapps.styles.ChatView = {
            x: {
                align: "center"
            },
            y: {
                align: "top",
                dy: -128
            },
            margin: 4,
            scrollBarPosition: {
                x: 4,
                y: 14
            },
            extraHeight: 8
        }, function () {
            this.targets = {}, this.timeouts = {}
        }),
        Toolbar = (Aims.prototype.clear = function () {
            for (var e in this.targets) this.targets[e].forEach(this.clearHideTimeout.bind(this)), this.targets[e] = [];
            this.onceAllHiddenCallback = void 0
        }, Aims.prototype.registerTarget = function (e, n, t) {
            t = Object.assign({}, t), (e = cleverapps.toArray(e)) && e.length ? n ? n.aim ? cleverapps.throwAsync("target already registered as an aim") : (t.types = e,
                t.priority = t.priority || 0, n.aim = t, e.forEach(function (e) {
                    this.targets[e] || (this.targets[e] = []);
                    var t = this.targets[e];
                    t.push(n);
                    for (var s = t.length - 1; 0 < s && n.aim.priority < t[s - 1].aim.priority; --s) {
                        var i = t[s - 1];
                        t[s - 1] = t[s], t[s] = i
                    }
                }.bind(this)), n.addCleaner(this.removeTarget.bind(this, n))) : cleverapps.throwAsync("no target specified for aim") : cleverapps.throwAsync("no type specified for aim")
        }, Aims.prototype.removeTarget = function (s) {
            s.aim && (s.aim.types.forEach(function (e) {
                var t = this.targets[e].indexOf(s); - 1 !== t && this.targets[e].splice(t, 1)
            }.bind(this)), this.clearHideTimeout(s), s.aim = void 0)
        }, Aims.prototype.clearHideTimeout = function (e) {
            var t = this.timeouts[e.__instanceId];
            t && (cleverapps.timeouts.clearTimeout(t), delete this.timeouts[e.__instanceId])
        }, Aims.prototype.getTarget = function (e, t) {
            if (e instanceof cc.Node) return e;
            t = t || {}, e = cleverapps.toArray(e) || [], t.noDefault || e.push("default");
            for (var s = 0; s < e.length; ++s) {
                var i = e[s],
                    i = this.targets[i];
                if (i) {
                    i = this.chooseTarget(i);
                    if (i) return i
                }
            }
        },
            Aims.prototype.chooseTarget = function (e) {
                for (var t = e.length - 1; 0 <= t; --t) {
                    var s = e[t],
                        i = s.aim;
                    if (i && ((!i.filter || i.filter()) && (cleverapps.UI.isNodeOnScene(s, .3, .3) || i.treasureBag || i.toggle || i.controls || i.scrollsToTarget && i.scrollsToTarget()))) return s
                }
            }, Aims.prototype.showTarget = function (e) {
                var t;
                e && e.aim && (t = !0, e.aim.toggle ? e.aim.toggle(!(t = !1), !1) : e.aim.controls ? (t = !1, cleverapps.meta.showControlsTemporary(e.aim.controls)) : e.aim.treasureBag && (t = cleverapps.treasureBag.isVisible(), cleverapps.treasureBag.show()), this.timeouts[e.__instanceId] && (t = !1, this.clearHideTimeout(e)), t || (this.timeouts[e.__instanceId] = cleverapps.timeouts.setTimeout(this.hideTarget.bind(this, e), Aims.SHOW_DURATION)))
            }, Aims.prototype.hideTarget = function (e) {
                this.clearHideTimeout(e), this.onceAllHidden(), e.aim && (e.aim.toggle ? e.aim.toggle(!1, !1) : e.aim.controls ? cleverapps.meta.hideControlsTemporary(e.aim.controls) : e.aim.treasureBag && cleverapps.treasureBag.hide())
            }, Aims.prototype.hasShownTargets = function () {
                return !!Object.keys(
                    this.timeouts).length
            }, Aims.prototype.whenAllHidden = function (e) {
                this.onceAllHiddenCallback = e, this.onceAllHidden()
            }, Aims.prototype.onceAllHidden = function () {
                this.onceAllHiddenCallback && !this.hasShownTargets() && (cleverapps.timeouts.setTimeout(this.onceAllHiddenCallback, Aims.HIDE_ANIMATION_DURATION), this.onceAllHiddenCallback = void 0)
            }, Aims.SHOW_DURATION = 1600, Aims.HIDE_ANIMATION_DURATION = 200,
            function () {
                this.items = [], this.freezed = !1, this.enabled = !1, this.onUpdateItemsListener = function () { }, this.onAddItemListener = function () { }, this.onEnableListener = function () { }, this.onForceItem = function () { }, "merge" === cleverapps.config.type ? (this.addItem(new OrdersToolbarItem), this.addItem(new UnitsLibraryToolbarItem), this.addItem(new UnitShopToolbarItem), this.addItem(new TravelBookToolbarItem), this.addItem(new ClansToolbarItem), this.addItem(new CustomersToolbarItem)) : "battlefield" === cleverapps.config.type ? this.addItem(new ArmyLibraryToolbarItem) : ["merge", "match3", "differences", "solitaire", "board", "tile3"].includes(cleverapps.config.type) ? (this.addItem(new FriendRequestsToolbarItem), this.addItem(new PeriodicBonusToolbarItem), cleverapps.dailyTasks && this.addItem(new DailyTasksToolbarItem), this.addItem(new LeaderBoardToolbarItem), this.addItem(new RewardedVideoToolbarItem)) : ["blocks"].includes(cleverapps.config.type) && (this.addItem(new RewardedVideoToolbarItem), this.addItem(new LeaderBoardToolbarItem)), "undefined" != typeof BonusRoundToolbarItem && this.addItem(new BonusRoundToolbarItem)
            }),
        ToolbarItem = (Toolbar.prototype.getSceneItems = function () {
            return this.items.filter(function (e) {
                return e.isAvailableOnScene()
            })
        }, Toolbar.prototype.anyItemWithForce = function () {
            for (var e = 0; e < this.items.length; e++) {
                var t = this.items[e].getForce();
                if (t && this.items[e].isVisible() && !cleverapps.forces.isShown(t.id)) return this.items[e]
            }
        }, Toolbar.prototype.showAnyForce = function () {
            var t = this.anyItemWithForce();
            cleverapps.meta.display({
                focus: "toolbarItemForce",
                control: "toolbar",
                actions: [function (e) {
                    this.updateItems(),
                        cleverapps.timeouts.setTimeout(e, 500)
                }.bind(this), function (e) {
                    this.onForceItem(), t.showForce(), cleverapps.forces.onceForceClosed = e
                }.bind(this)]
            })
        }, Toolbar.prototype.addItem = function (e) {
            if (void 0 === this.getItem(e.type)) {
                this.items.push({});
                for (var t = this.items.length - 1; 0 < t && this.items[t - 1].type > e.type;) this.items[t] = this.items[t - 1], t--;
                this.items[t] = e, this.onAddItemListener(e, t)
            }
        }, Toolbar.prototype.hasVisibleItems = function () {
            return 0 < this.items.filter(function (e) {
                return e.isVisible()
            }).length
        }, Toolbar.prototype.resetByType = function (e) {
            e = this.getItem(e.type);
            e && (e.resetState(), this.updateItems())
        }, Toolbar.prototype.resetItemsState = function () {
            this.items.forEach(function (e) {
                e.resetState && e.resetState()
            })
        }, Toolbar.prototype.getItem = function (e) {
            for (var t = 0; t < this.items.length; ++t)
                if (this.items[t].type === e) return this.items[t]
        }, Toolbar.prototype.updateItems = function (e) {
            this.freezed || (this.onUpdateItemsListener(e), this._update())
        }, Toolbar.prototype.freezeUpdates = function () {
            this.freezed = !0
        },
            Toolbar.prototype.unfreezeUpdates = function () {
                this.freezed = !1, this.updateItems()
            }, Toolbar.prototype._update = function () {
                this.hasVisibleItems() ? this.enable() : this.disable()
            }, Toolbar.prototype.enable = function () {
                this.enabled || (this.enabled = !0, this.onEnableListener(this.enabled))
            }, Toolbar.prototype.disable = function () {
                this.enabled && (this.enabled = !1, this.onEnableListener(this.enabled))
            },
            function (e) {
                Object.assign(this, e), this.enabled = !1, this.marked = !1, this.onChangeStateListener = function () { }, this.showForce = function () { }, this.onFingerOnListener = function () { }, this.onFingerOffListener = function () { }
            }),
        PeriodicBonusToolbarItem = (ToolbarItem.prototype.getText = function () { }, ToolbarItem.prototype.setFinger = function (e, t) {
            this.finger !== (e = !!e) && ((this.finger = e) ? (clearTimeout(this.fingerTimeout), this.onFingerOnListener(), t && (this.fingerTimeout = setTimeout(function () {
                this.setFinger(!1)
            }.bind(this), t))) : this.onFingerOffListener())
        }, ToolbarItem.prototype.isVisible = function () {
            return this.enabled
        },
            ToolbarItem.prototype.onClick = function () {
                this.unmark()
            }, ToolbarItem.prototype.isAvailableOnScene = function () {
                return !0
            }, ToolbarItem.prototype.enable = function () {
                this.enabled || (this.enabled = !0, this.onChangeStateListener(), cleverapps.toolbar && cleverapps.toolbar.updateItems())
            }, ToolbarItem.prototype.disable = function () {
                this.enabled && (this.unmark(), this.enabled = !1, this.onChangeStateListener(), cleverapps.toolbar && cleverapps.toolbar.updateItems())
            }, ToolbarItem.prototype.mark = function () {
                this.marked || (this.marked = !0, this.onChangeStateListener())
            }, ToolbarItem.prototype.unmark = function () {
                this.marked && (this.marked = !1, this.onChangeStateListener())
            }, ToolbarItem.prototype.getForce = function () {
                return this.force
            }, ToolbarItem.prototype.getTargetTypes = function () {
                return this.targets
            }, ToolbarItem.FRIEND_REQUESTS = {
                type: 0,
                icon: bundles.toolbar.frames.toolbar_mail_icon_png
            }, ToolbarItem.BONUS_GAME = {
                type: 1,
                icon: bundles.toolbar.frames.toolbar_bonusround_icon_png,
                grayscaleDisabled: !0,
                force: Forces.BONUS_ROUND_FORCE
            },
            ToolbarItem.PERIODIC_BONUS = {
                type: 2,
                icon: bundles.toolbar.frames.toolbar_dailybonus_icon_png,
                grayscaleDisabled: !0,
                force: Forces.PERIODIC_BONUS_FORCE
            }, ToolbarItem.LEADER_BOARD = {
                type: 3,
                icon: bundles.toolbar.frames.toolbar_leader_board_icon_png
            }, ToolbarItem.DAILY_TASKS = {
                type: 4,
                icon: bundles.toolbar.frames.toolbar_daily_tasks_icon_png,
                force: Forces.DAILY_TASKS_FORCE
            }, ToolbarItem.REWARDED_VIDEO = {
                type: 5,
                icon: bundles.toolbar.frames.toolbar_rewarded_video_icon_png
            }, ToolbarItem.ORDERS = {
                type: 6,
                targets: "fruit",
                icon: bundles.toolbar.frames.toolbar_orders_icon_png
            }, ToolbarItem.UNITS_LIBRARY = {
                type: 7,
                targets: "unitsLibrary",
                icon: bundles.toolbar.frames.toolbar_units_library_icon_png
            }, ToolbarItem.UNIT_SHOP = {
                type: 8,
                icon: bundles.toolbar.frames.toolbar_unit_shop_icon_png,
                force: Forces.UNITS_SHOP_ICON
            }, ToolbarItem.TRAVEL_BOOK = {
                type: 9,
                icon: bundles.toolbar.frames.toolbar_travel_book_icon_png,
                force: Forces.TRAVEL_BOOK
            }, ToolbarItem.CLANS = {
                type: 10,
                icon: bundles.toolbar.frames.toolbar_clans_icon_png,
                force: Forces.CLANS_ICON
            }, ToolbarItem.ARMY_LIBRARY = {
                type: 11,
                targets: "armyLibrary",
                icon: bundles.toolbar.frames.toolbar_units_library_icon_png
            }, ToolbarItem.CUSTOMERS = {
                type: 12,
                icon: bundles.toolbar.frames.toolbar_customers_icon_png
            },
            function () {
                ToolbarItem.call(this, ToolbarItem.PERIODIC_BONUS), this.countdown = cleverapps.periodicBonus.countdown, cleverapps.periodicBonus.changeLockedListener = this.changeLocked.bind(this), this.changeLocked()
            }),
        FriendRequestsToolbarItem = (PeriodicBonusToolbarItem.prototype = Object.create(ToolbarItem.prototype), (PeriodicBonusToolbarItem.prototype.constructor = PeriodicBonusToolbarItem).prototype.isVisible = function () {
            return levels.user.checkAvailable(cleverapps.MiniGame.AVAILABLE)
        }, PeriodicBonusToolbarItem.prototype.unlock = function () {
            this.mark()
        }, PeriodicBonusToolbarItem.prototype.changeLocked = function () {
            cleverapps.periodicBonus.locked ? this.disable() : (this.enable(), this.mark())
        }, PeriodicBonusToolbarItem.prototype.onClick = function () {
            cleverapps.periodicBonus.locked ? cleverapps.notification.create(cleverapps.periodicBonus.closedText, {
                image: this.icon
            }) : (this.unmark(), cleverapps.meta.display({
                focus: "MiniGameWindowFromToolbar",
                action: function (e) {
                    cleverapps.periodicBonus.openWindow(e)
                }
            }))
        }, function () {
            ToolbarItem.call(this, ToolbarItem.FRIEND_REQUESTS), this.lastNotProceedId = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LAST_VIEWED_FRIEND_REQUEST, {
                raw: !0
            }), levels.friendRequests.onNewListener = function () {
                this.mark(), cleverapps.toolbar.updateItems()
            }.bind(this), levels.friendRequests.onChangeListener = function () {
                levels.friendRequests.existNotProcessed() || (this.unmark(), cleverapps.toolbar.updateItems(!0))
            }.bind(this), this.enable(), this.mark()
        }),
        LeaderBoardToolbarItem = (FriendRequestsToolbarItem.prototype = Object.create(ToolbarItem.prototype), (FriendRequestsToolbarItem.prototype.constructor = FriendRequestsToolbarItem).prototype.mark = function () {
            var e;
            0 === cleverapps.friends.listFriends().concat(
                cleverapps.invitalbleFriends.listFriends()).length || !1 !== (e = levels.friendRequests.lastNotProcessedId()) && e !== this.lastNotProceedId && ToolbarItem.prototype.mark.apply(this)
        }, FriendRequestsToolbarItem.prototype.isVisible = function () {
            return levels.friendRequests.existNotProcessed()
        }, FriendRequestsToolbarItem.prototype.onClick = function () {
            this.lastNotProceedId = levels.friendRequests.lastNotProcessedId(), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LAST_VIEWED_FRIEND_REQUEST, this.lastNotProceedId, {
                raw: !0
            }), this.unmark(), cleverapps.meta.display({
                focus: "FriendRequestsWindow",
                control: ["MenuBarGoldItem", "MenuBarLivesItem"],
                action: function (e) {
                    new FriendRequestsWindow, cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, function () {
            ToolbarItem.call(this, ToolbarItem.LEADER_BOARD), this.enable()
        }),
        DailyTasksToolbarItem = (LeaderBoardToolbarItem.prototype = Object.create(ToolbarItem.prototype), LeaderBoardToolbarItem.prototype.constructor = FriendRequestsToolbarItem,
            LeaderBoardToolbarItem.prototype.onClick = function () {
                cleverapps.social instanceof cleverapps.MobileVkSocial ? cleverapps.social.showLeaderBoardBox({
                    userResult: levels.user.getHumanReadableNumber()
                }, function () { }) : cleverapps.meta.display({
                    focus: "LeadersWindow",
                    action: function (e) {
                        new LeadersWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }, LeaderBoardToolbarItem.prototype.isVisible = function () {
                return !!cleverapps.rewardedAdsManager.isEnabled() && (!(cleverapps.flags.norest && !cleverapps.config.importMode) && (ToolbarItem.prototype.isVisible.call(this) && levels.user.checkAvailable(cleverapps.Availables.LEADER_BOARD)))
            },
            function () {
                ToolbarItem.call(this, ToolbarItem.DAILY_TASKS), this.countdown = new cleverapps.CountDown(cleverapps.dailyTasks.getTimeLeft(), {
                    permanent: !0
                }), this.enable(), cleverapps.dailyTasks.onChangeStateListener = this.onChangeState.bind(this), this.onChangeState()
            }),
        RewardedVideoToolbarItem = (DailyTasksToolbarItem.prototype = Object.create(ToolbarItem.prototype), (
            DailyTasksToolbarItem.prototype.constructor = DailyTasksToolbarItem).prototype.onChangeState = function () {
                0 < cleverapps.dailyTasks.getNotCollectedTasks().length ? this.mark() : this.unmark(), this.countdown.resetTimeLeft(cleverapps.dailyTasks.getTimeLeft()), this.countdown.nextSecond(Date.now()), this.onChangeStateListener()
            }, DailyTasksToolbarItem.prototype.isVisible = function () {
                return cleverapps.dailyTasks.isAvailable()
            }, DailyTasksToolbarItem.prototype.onClick = function () {
                cleverapps.meta.display({
                    focus: "DailyTasksWindow",
                    action: function (e) {
                        cleverapps.dailyTasks.update(), new DailyTasksWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }, function () {
                ToolbarItem.call(this, ToolbarItem.REWARDED_VIDEO), this.nextTime = 0, cleverapps.adsLimits.on("update", this.update.bind(this)), this.update()
            }),
        OrdersToolbarItem = (RewardedVideoToolbarItem.prototype = Object.create(ToolbarItem.prototype), (RewardedVideoToolbarItem.prototype.constructor = RewardedVideoToolbarItem).prototype.update = function () {
            this.isAvailable() ? this.enable() : this.disable();
            var e = cleverapps.adsLimits.getWatchCount(AdsLimits.TYPES.TOOLBAR);
            this.watchCount !== e && (this.watchCount = e, this.onChangeStateListener())
        }, RewardedVideoToolbarItem.prototype.getText = function () {
            var e = this.getReward();
            return e.hard ? "+" + e.hard + "$$" : "+" + e.soft + "@@"
        }, RewardedVideoToolbarItem.prototype.enable = function () {
            this.enabled || (ToolbarItem.prototype.enable.apply(this), this.mark())
        }, RewardedVideoToolbarItem.prototype.onClick = function () {
            this.disable(), cleverapps.rewardedAdsManager.loadAndPlay({
                type: RewardedAdsManager.REWARDED,
                adLimit: AdsLimits.TYPES.TOOLBAR,
                callback: this.reward.bind(this)
            })
        }, RewardedVideoToolbarItem.prototype.isAvailable = function () {
            return cleverapps.rewardedAdsManager.isEnabled() && cleverapps.adsLimits.state(AdsLimits.TYPES.TOOLBAR) === AdsLimits.STATE_READY && this.nextTime < Date.now()
        }, RewardedVideoToolbarItem.prototype.reward = function () {
            this.nextTime = Date.now() + cleverapps.parseInterval(RewardedVideoToolbarItem.TIMEOUT);
            var t = this.getReward();
            cleverapps.adsLimits.watch(AdsLimits.TYPES.TOOLBAR), cleverapps.meta.displayWhenFreeFocus({
                focus: "RewardedAdToolbarReward",
                action: function (e) {
                    new RewardWindow(t), cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, RewardedVideoToolbarItem.prototype.getReward = function () {
            var e = cleverapps.adsLimits.getWatchCount(AdsLimits.TYPES.TOOLBAR),
                e = e < 1 ? 10 : e < 2 ? 5 : 2,
                t = {};
            return t[cleverapps.config.soft ? "soft" : "hard"] = e, t
        }, RewardedVideoToolbarItem.TIMEOUT = "1 minute", function () {
            ToolbarItem.call(this, ToolbarItem.ORDERS), this.enable()
        }),
        UnitsLibraryToolbarItem = (OrdersToolbarItem.prototype = Object.create(ToolbarItem.prototype), (OrdersToolbarItem.prototype.constructor = OrdersToolbarItem).prototype.resetState = function () {
            Game.currentGame && (Game.currentGame.orders.findCanCook() || Game.currentGame.orders.findReady()) ? this.mark() : this.unmark()
        }, OrdersToolbarItem.prototype.isVisible = function () {
            return Game.currentGame && cleverapps.gameLevel && 2 <= cleverapps.gameLevel.getLevel() && -1 !== ["main"].indexOf(
                cleverapps.travelBook.getCurrentPage().id) && !cleverapps.config.editorMode
        }, OrdersToolbarItem.prototype.onClick = function () {
            cleverapps.meta.display({
                focus: "OrdersIconClicked",
                action: function (e) {
                    new OrdersWindow, cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, function () {
            ToolbarItem.call(this, ToolbarItem.UNITS_LIBRARY), this.enable()
        }),
        UnitShopToolbarItem = (UnitsLibraryToolbarItem.prototype = Object.create(ToolbarItem.prototype), (UnitsLibraryToolbarItem.prototype.constructor = UnitsLibraryToolbarItem).prototype.resetState = function () {
            cleverapps.unitsLibrary.hasAnyFresh(cleverapps.unitsLibrary.listTabCodes(cleverapps.travelBook.getCurrentPage().id)) ? this.mark() : this.unmark()
        }, UnitsLibraryToolbarItem.prototype.isVisible = function () {
            return !cleverapps.config.editorMode && Game.currentGame && (!Game.currentGame.isMainGame() || 3 <= cleverapps.gameLevel.getLevel())
        }, UnitsLibraryToolbarItem.prototype.onClick = function () {
            cleverapps.meta.display({
                control: ["MenuBarCoinsItem"],
                focus: "UnitsLibraryIconClicked",
                action: function (e) {
                    new UnitsLibraryWindow, cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, function () {
            ToolbarItem.call(this, ToolbarItem.UNIT_SHOP), this.enable()
        }),
        TravelBookToolbarItem = (UnitShopToolbarItem.prototype = Object.create(ToolbarItem.prototype), (UnitShopToolbarItem.prototype.constructor = UnitShopToolbarItem).prototype.resetState = function () {
            this.tabWithFree = void 0, cleverapps.unitsShop.getAvailableShops().forEach(function (e) {
                cleverapps.unitsShop.tabs[e.tab].getFreeProduct() && (this.tabWithFree = e.tab)
            }.bind(this)), void 0 !== this.tabWithFree ? this.mark() : this.unmark()
        }, UnitShopToolbarItem.prototype.isVisible = function () {
            return cleverapps.unitsShop && 0 < cleverapps.unitsShop.getAvailableShops().length
        }, UnitShopToolbarItem.prototype.onClick = function () {
            var s = cleverapps.unitsShop.getAvailableShops();
            cleverapps.meta.display({
                focus: "displayUnitsShop",
                control: ["MenuBarGoldItem", "MenuBarCoinsItem"],
                action: function (e) {
                    var t = void 0 !== this.tabWithFree ? this.tabWithFree : s[s.length - 1].tab;
                    new UnitsShopWindow({
                        tab: t
                    }), cleverapps.meta.onceNoWindowsListener = e
                }.bind(this)
            })
        }, UnitShopToolbarItem.prototype.getForce = function () {
            return 1 < cleverapps.unitsShop.getAvailableShops().length && Forces.UNITS_SHOP_ICON
        }, function () {
            ToolbarItem.call(this, ToolbarItem.TRAVEL_BOOK), this.enable()
        }),
        ToolbarView = (TravelBookToolbarItem.prototype = Object.create(ToolbarItem.prototype), (TravelBookToolbarItem.prototype.constructor = TravelBookToolbarItem).prototype.resetState = function () {
            cleverapps.travelBook.needsAttention() ? this.mark() : this.unmark(), cleverapps.travelBook.chooseForce()
        }, TravelBookToolbarItem.prototype.getForce = function () {
            return cleverapps.travelBook.chosenForForce && Forces.TRAVEL_BOOK
        }, TravelBookToolbarItem.prototype.isVisible = function () {
            return cleverapps.user.checkAvailable(TravelBook.AVAILABLE)
        }, TravelBookToolbarItem.prototype.onClick = function () {
            cleverapps.meta.display({
                focus: "TravelBook",
                actions: [function (e) {
                    new TravelBookWindow, cleverapps.meta.onceNoWindowsListener = e
                }, function (e) {
                    delete cleverapps.travelBook.chosenForForce, e()
                }]
            })
        }, cc.Node.extend({
            ctor: function () {
                this._super(), this.toolbar = cleverapps.toolbar, this.toolbar.resetItemsState(), this.toolbar.updateItems();
                var e = cleverapps.styles.ToolbarView;
                this.setAnchorPoint2(), this.setContentSize(0, e.bg.height), this.createBg(), this.itemsViews = [], this.toolbar.getSceneItems().forEach(function (e) {
                    e = new ToolbarItemView(e);
                    this.itemsViews.push(e), this.addChild(e)
                }.bind(this)), this.toolbar.onAddItemListener = this.createListener(this.addItem.bind(this)), this.toolbar.onUpdateItemsListener = this.createListener(this.updateItems.bind(this)), this.toolbar.onEnableListener = this.createListener(this.updateEnabled.bind(this)), this.toolbar.onForceItem = this.createListener(this.onForceItem.bind(this)), this.updateItems(!0), this.updateSize(), this.updatePosition(), this.toggle = this.createListener(function (e, t) {
                    (e || this.isShown()) && (this.stopAllActions(), e ? this.toolbar.enabled && this.show(t) : this.hide(t))
                }.bind(this))
            },
            updatePosition: function () {
                this.setPositionRound(cleverapps.styles.ToolbarView.position)
            },
            updateSize: function () {
                var e = cleverapps.resolution.mode === cleverapps.WideMode.HORIZONTAL ? 1.2 : 1;
                this.setScale(this.bg.width > cleverapps.UI.getSceneSize().width ? cleverapps.UI.getSceneSize().width / this.bg.width : e), this._updateBg()
            },
            createBg: function () {
                this.bg = new cc.Scale9Sprite(bundles.toolbar.frames.toolbar_bg_png);
                var e = cleverapps.styles.ToolbarView.bg.offsetY;
                this.addChild(this.bg), this.bg.height = this.height, this.bg.setPositionRound(this.width / 2, this.height / 2 + e)
            },
            onForceItem: function () {
                this.show(!0)
            },
            addItem: function (e, t) {
                e = new (e.getViewClass())(e);
                this.addChild(e), this.itemsViews.splice(t, 0, e), this.updateItems()
            },
            updateItems: function (i) {
                var n = cleverapps.styles.ToolbarView,
                    o = [],
                    a = [],
                    r = [],
                    c = 0,
                    t = (this.itemsViews.forEach(function (e) {
                        var t = e.visible,
                            s = (t && c++, e.model.isVisible());
                        s !== t && (a.push(e), s ? e.setVisible(!0) : i ? e.setVisible(!1) : (r.push(e), e.stopAllActions(), e.runAction(new cc.Sequence(
                            new cc.ScaleTo(.3, 0), new cc.CallFunc(function () {
                                e.setVisible(!1), e.setScale(1)
                            }))))), s && o.push(e)
                    }), (o.length - 1) * n.margin);
                o.forEach(function (e) {
                    e.baseScaleX = 1, t += e.width
                }), 0 < o.length && cleverapps.UI.arrangeWithMargins(o, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: n.margin,
                    y: this.height / 2 + n.items.dy,
                    iterator: function (e, t, s) {
                        t += n.margin + n.bg.padding, i ? (e.scale = 1, e.setPositionRound(t, s)) : (-1 !== a.indexOf(e) && (e.scale = 0, e.setPositionRound(t, s)), e.stopAllActions(), e.runAction(new cc.Spawn(new cc.ScaleTo(.6, 1).easing(cc.easeBackOut(.05)), new cc.MoveTo(.6, cc.p(t, s)))))
                    }
                }), t += 2 * n.margin + 2 * n.bg.padding, this.setContentSize(t, this.height), this.updateBg(c, o.length, i)
            },
            updateBg: function (e, t, s) {
                this.bg.stopAllActions(), s || e < t ? this._updateBg() : this.bg.runAction(new cc.Sequence(new cc.DelayTime(.6), new cc.CallFunc(this._updateBg.bind(this))))
            },
            _updateBg: function () {
                this.bg.setContentSize2(this.width, this.height + cleverapps.UI.getBgOffset()), this.bg.setPositionRound(this.width / 2,
                    this.height + cleverapps.styles.ToolbarView.bg.offsetY - this.bg.height / 2), this.decors && (this.decors.forEach(function (e) {
                        e.removeFromParent()
                    }), delete this.decors), this.decors = SceneDecors.add(this.bg, cleverapps.skins.getSlot("toolbarDecors"))
            },
            updateEnabled: function (e) {
                this.stopAllActions(), e && 0 === cleverapps.windows.list.length ? (this.hide(!0), this.show()) : this.hide()
            }
        })),
        ToolbarItemView = (cleverapps.styles.ToolbarView = {
            position: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: 0
                }
            },
            bg: {
                height: 205,
                padding: 0,
                offsetY: -90
            },
            hover: {
                margin: 6
            },
            items: {
                dy: -45
            },
            margin: 30
        }, cc.Node.extend({
            ctor: function (e) {
                var t = cleverapps.styles.ToolbarItemView,
                    s = (this._super(), this.model = e, this.icon = new cc.Sprite(e.icon)),
                    i = (s.setAnchorPoint2(), s.setPositionRound(t.icon), this.mark = new Attention),
                    t = (i.setScale(t.mark.baseScale || 1), i.setPositionRound(t.mark), i.pulse(), this.content = new cc.Node),
                    s = (t.setAnchorPoint2(), t.setContentSize2(s.getContentSize()), t.setPositionRound(t.width / 2, t.height / 2), t.addChild(s), t.addChild(i),
                        this.setContentSize2(t.getContentSize()), this.setAnchorPoint2(), this.addChild(t), cleverapps.UI.applyHover(this, {
                            onMouseOver: this.onMouseOver.bind(this)
                        }), cleverapps.UI.onClick(this, this.onClick.bind(this)), e.onFingerOnListener = this.createListener(this.turnOnFinger.bind(this)), e.onFingerOffListener = this.createListener(this.turnOffFinger.bind(this)), e.onChangeStateListener = this.createListener(this.onChangeState.bind(this)), e.showForce = this.createListener(this.showForce.bind(this)), this.turnOnFinger(), this.onChangeState(), e.getTargetTypes());
                s && cleverapps.aims.registerTarget(s, this.content, {
                    controls: "toolbar"
                })
            },
            onClick: function () {
                cleverapps.audio.playSound(bundles.main.urls.click_effect), cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), this.model.onClick()
            },
            turnOnFinger: function () {
                this.model.finger && (this.finger = FingerView.hintClick(this.content, {
                    delay: .8
                }))
            },
            turnOffFinger: function () {
                FingerView.remove(this.finger), this.finger = void 0
            },
            showForce: function () {
                cleverapps.forces.create(this, this.model.getForce())
            },
            updateTimer: function () {
                var e, t;
                this.timer && (this.timer.removeFromParent(), delete this.timer), this.model.countdown && this.model.countdown.getTimeLeft() && (e = cleverapps.styles.ToolbarItemView.timer, (t = this.timer = new cleverapps.CountDownView(this.model.countdown, {
                    font: cleverapps.styles.FONTS.TOOLBAR_ITEM_TIMER_TEXT,
                    background: {
                        frame: bundles.timer.frames.timer_bg_png,
                        width: e.bg.width,
                        height: e.bg.height
                    }
                })).setPosition(this.width / 2 + e.offsetX, this.height / 2 + e.offsetY), t.setScale(e.scale), this.content.addChild(t))
            },
            updateTextReward: function () {
                this.reward && (this.reward.removeFromParent(), delete this.reward);
                var e, t = this.model.getText();
                t && (e = cleverapps.styles.ToolbarItemView.reward, (t = this.reward = new TextWithIcon(t, {
                    font: cleverapps.styles.FONTS.TOOLBAR_ITEM_REWARD_TEXT
                })).setPositionRound(e), this.content.addChild(t))
            },
            grayscale: function () {
                this.icon.setColor(
                    this.model.enabled ? cleverapps.styles.COLORS.GRAY_SCALE_RESTORE_COLOR : cleverapps.styles.COLORS.GRAY_SCALE_COLOR)
            },
            onChangeState: function () {
                this.model.grayscaleDisabled && this.grayscale(), this.mark.setVisible(this.model.marked), this.model.marked && this.shake(), this.updateTimer(), this.updateTextReward()
            },
            shake: function () {
                this.shakeInProgress || (this.shakeInProgress = !0, this.content.runAction(new cc.Sequence(new cc.DelayTime(Math.floor(8 * Math.random()) + 8), new cc.Sequence(new cc.ScaleTo(.5, 1.2, .8), new cc.Spawn(new cc.ScaleTo(.2, 1, 1), new cc.MoveBy(.2, 0, 150)), new cc.MoveBy(.2, 0, -150), new cc.MoveBy(.1, 0, 30), new cc.MoveBy(.1, 0, -30), new cc.CallFunc(function () {
                    this.shakeInProgress = !1
                }.bind(this))))))
            },
            onMouseOver: function () {
                this.model.enabled && this.setScale(1.05 * this.baseScale || 1.05)
            }
        })),
        DialoguePersonTitleView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TOOLBAR_ITEM_TIMER_TEXT: {
                name: "default",
                size: 35
            },
            TOOLBAR_ITEM_REWARD_TEXT: {
                size: 26,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.ToolbarItemView = {
            timer: {
                offsetY: -10,
                offsetX: 0,
                scale: .6,
                bg: {
                    width: 200,
                    height: 50
                }
            },
            icon: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            mark: {
                x: {
                    align: "center",
                    dx: -30
                },
                y: {
                    align: "center",
                    dy: 30
                }
            },
            reward: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: 12
                }
            }
        }, cleverapps.FBLoginOrInvite = function () {
            var e, t, s, i;
            if (cleverapps.platform.isConnected(Platform.SOCIAL) && !cleverapps.flags.nologin && !cleverapps.flags.noinvites) return e = new cc.Node, e.setAnchorPoint2(), i = e.createListener(function () {
                e.removeFromParent(!0)
            }), i = new InviteButton({
                onSuccess: i
            }), i.setPositionRound(i.width / 2, i.height / 2), e.setContentSize2(i), e.addChild(i), t = cleverapps.styles.FBLoginOrInvite, t.images.avatars && ((s = new cleverapps.UI.Avatar({
                avatar: bundles.avatar.frames.default_avatar,
                frame: bundles.avatar.frames.avatar_frame2
            })).setScale(t.images.avatars.scale), s.setPositionRound(t.images.avatars.right.x, t.images.avatars.right.y), s.setRotation(
                t.images.avatars.right.rotation), i.addChild(s), (s = new cleverapps.UI.Avatar({
                    avatar: bundles.avatar.frames.default_avatar,
                    frame: bundles.avatar.frames.avatar_frame2
                })).setScale(t.images.avatars.scale), s.setPositionRound(t.images.avatars.left.x, t.images.avatars.left.y), s.setRotation(t.images.avatars.left.rotation), i.addChild(s)), i = cleverapps.UI.generateTTFText("FBLoginOrInvite.invite", cleverapps.styles.FONTS.FBLOGINORINVITE_TEXT), i.setPosition(e.width / 2 + t.text.offsetX, e.height + t.text.offsetY), i.fitTo(t.text.width), e.addChild(i), e.setVisible(!1), e.runAction(new cc.Sequence(new cc.ScaleTo(0, 0), new cc.Show, new cc.ScaleTo(.5, 1).easing(cc.easeBackOut()))), i.setOpacity(0), i.runAction(new cc.Sequence(new cc.DelayTime(.5), new cc.FadeIn(.5))), cleverapps.UI.wrap(e), e
        }, cleverapps.styles.FBLoginOrInvite = {
            images: {
                avatars: {
                    scale: .7,
                    left: {
                        x: {
                            align: "left",
                            dx: -90
                        },
                        y: {
                            align: "center"
                        },
                        rotation: -7
                    },
                    right: {
                        x: {
                            align: "left",
                            dx: -60
                        },
                        y: {
                            align: "center",
                            dy: 5
                        },
                        rotation: 13
                    }
                }
            },
            text: {
                offsetX: -40,
                offsetY: 26,
                width: 700
            }
        },
            cleverapps.Row = cc.Scale9Sprite.extend({
                ctor: function (e, t) {
                    this.options = t || {}, this.cup = e.cup, this.player = !!e.player, this.leader = !!e.leader, this.notInTop = e.notInTop, this.clickableArea = e.clickableArea, this.currentPlace = e.place, t = this.player ? this.options.row_you_png || bundles.table.frames.row_you_png : this.options.row_player_png || bundles.table.frames.row_player_png, this._super(t);
                    var s = cleverapps.styles.Row,
                        t = this.options.rowWidth,
                        i = this.options.rowHeight,
                        t = (this.setContentSize2(t || s.width, i || s.height), []),
                        i = (this.placeNode = this.createPlace(e.place), t.push(this.placeNode), e.emblem ? t.push(this.createEmblem(e.emblem)) : t.push(this.createAvatar(e.avatar)), t.length),
                        n = (!1 !== this.options.prizes && (this.prizeNode = this.createPrize(e.place), t.push(this.prizeNode)), t.push(this.createData(e)), this.options.buttonData && t.push(this.createButton(this.options.buttonData)), t.reduce(function (e, t) {
                            return e + t.width * t.scaleX + s.content.margin
                        }, 0)),
                        n = this.width - n - 2 * s.paddingX,
                        e = this.createName(e.text, e.id, n);
                    t.splice(i, 0, e), this.content = new cleverapps.Layout(t, {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: s.content.margin
                    }), this.addChild(this.content), this.content.setPositionRound(s.content)
                },
                createPlace: function (e) {
                    var t = cleverapps.styles.Row,
                        s = new cc.Node,
                        i = (s.setAnchorPoint2(), bundles.table.frames["badge_" + e]),
                        i = !1 !== this.options.badges && i ? new cc.Sprite(i) : this.createPlaceText(e);
                    return s.setContentSize2((!1 !== this.options.badges ? t.place.withBadge : t.place).width, t.content.height), s.addChild(i), i.setPositionRound(s.width / 2, s.height / 2), s
                },
                createPlaceText: function (e) {
                    var t = this.player ? cleverapps.styles.FONTS.ROW_PLAYER_TEXT : cleverapps.styles.FONTS.ROW_TEXT;
                    return this.notInTop && (e = "-"), cleverapps.UI.generateImageText(e, t)
                },
                createAvatar: function (e) {
                    var t = cleverapps.styles.Row,
                        e = new cleverapps.UI.Avatar(e);
                    return cleverapps.UI.fitToBox(e, {
                        height: t.content.height
                    }), e
                },
                createEmblem: function (e) {
                    var t = cleverapps.styles.Row,
                        e = new cc.Sprite(bundles.tablerow_icons.frames["emblem_" + e]);
                    return cleverapps.UI.fitToBox(e, {
                        height: t.emblem.height
                    }), e
                },
                createName: function (e, t, s) {
                    var i = cleverapps.styles.Row,
                        n = new cc.Node,
                        e = (n.setAnchorPoint2(), n.setContentSize2(s, i.content.height), e || ""),
                        t = (e || "string" != typeof t || (e = "Player_" + t.substr(-3)), e = cleverapps.UI.cutPlayerName(e, this.getMaxTextLength()), this.player ? cleverapps.styles.FONTS.ROW_PLAYER_TEXT : cleverapps.styles.FONTS.ROW_TEXT),
                        e = cleverapps.UI.generateOnlyText(e, t);
                    return e.fitTo(s, i.name.height), n.addChild(e), e.setPositionRound(i.name), n
                },
                createPrize: function (e) {
                    var t = cleverapps.styles.Row,
                        s = new cc.Node,
                        e = (s.setAnchorPoint2(), s.setContentSize2(t.prize.width, t.content.height), this.createPrizeIcon(e));
                    return e && (cleverapps.UI.fitToBox(e, {
                        height: t.content.height
                    }), s.addChild(e), e.setPositionRound(s.width / 2, s.height / 2), this.addPrizeBannerTooltip(s)), s
                },
                createPrizeIcon: function (e) {
                    if (e <= ("merge" === cleverapps.config.type ? 3 : 5)) return new cc.Sprite(bundles.table.frames["prize_" + e])
                },
                addPrizeBannerTooltip: function (e) {
                    var t = this.getPrizeTooltipText(),
                        s = cleverapps.styles.Row.tooltip,
                        s = (s = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? s.mobilePosition : s.position) || cleverapps.styles.UI.Tooltip.LOCATION.above;
                    cleverapps.tooltipManager.create(e, {
                        rewards: this.getRewards(),
                        text: t,
                        position: s,
                        clickableArea: this.clickableArea
                    })
                },
                getPrizeTooltipText: function () {
                    return Messages.get("PrizeTooltip")
                },
                getRewards: function () { },
                createData: function (e) {
                    var t = cleverapps.styles.Row,
                        s = this.player ? bundles.table.frames.amount_bg_you_png : bundles.table.frames.amount_bg_png,
                        i = this.createDataContent(e),
                        s = new cc.Scale9Sprite(s);
                    return s.setContentSize2(i.width + 2 * t.data.paddingX, t.data.bg.height), this.getTooltipText() && cleverapps.tooltipManager.create(s, {
                        text: this.getTooltipText(),
                        position: cleverapps.styles.UI.Tooltip.LOCATION.below,
                        clickableArea: this.clickableArea
                    }), s.addChild(i), i.setPositionRound(t.data.content), s.y = t.data.offsetY, this.updateAmount(e.amount, !0), s
                },
                createDataContent: function (e) {
                    var t,
                        s = cleverapps.styles.Row.data,
                        i = [],
                        e = e.dataIcon || this.options.dataIcon;
                    return e && (t = new cc.Sprite(e), s.icon.rotation && t.setRotation(s.icon.rotation), i.push(t)), this.dataTextWidth = (e ? s.text : s.text.withoutIcon).width, this.dataTextHeight = s.text.height, this.dataAmount = cleverapps.UI.generateImageText("222", cleverapps.styles.FONTS.ROW_DATA_TEXT), this.dataAmount.fitTo(this.dataTextWidth, this.dataTextHeight), i.push(this.dataAmount), new cleverapps.Layout(i, {
                        margin: s.margin,
                        direction: cleverapps.UI.HORIZONTAL
                    })
                },
                createButton: function (e) {
                    var t = cleverapps.styles.Row;
                    return new cleverapps.UI.Button({
                        type: t.button.type,
                        text: e.text,
                        width: t.button.width,
                        height: t.button.height,
                        disabled: e.disabled,
                        onClicked: e.action
                    })
                },
                updateParams: function (e) {
                    this.notInTop = e.notInTop
                },
                getTooltipText: function () {
                    return Messages.get("ResultTooltip")
                },
                updatePlace: function (e, t) {
                    this.currentPlace !== e && (this.currentPlace = e, this.refreshPlace(this.currentPlace, t), this.refreshPrize(this.currentPlace, t))
                },
                updateAmount: function (e, t) {
                    this.dataAmount && this.currentAmount !== e && (this.currentAmount = e, this.dataAmount.stopAllActions(), this.dataAmount.setString(this.currentAmount), this.dataAmount.fitTo(this.dataTextWidth, this.dataTextHeight), t || this.dataAmount.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.5), new cc.ScaleTo(.2, 1))))
                },
                refreshPrize: function (e) {
                    var t;
                    this.prizeNode && (t = this.prizeNode.getPosition(), this.prizeNode.removeFromParent(!0), this.prizeNode = this.createPrize(e), this.prizeNode.setPositionRound(t), this.content.addChild(this.prizeNode))
                },
                refreshPlace: function (e) {
                    var t = this.placeNode.getPosition();
                    this.placeNode.removeFromParent(!0), this.placeNode = this.createPlace(e), this.content.addChild(this.placeNode), this.placeNode.setPositionRound(t)
                },
                getMaxTextLength: function () {
                    return 12
                }
            }), cleverapps.overrideFonts(cleverapps.styles.FONTS, {
                ROW_DATA_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                ROW_PLAYER_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                },
                ROW_TEXT: {
                    size: 40,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                }
            }), cleverapps.styles.Row = {
                width: 700,
                height: 82,
                paddingX: 15,
                content: {
                    height: 62,
                    margin: 10,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    }
                },
                place: {
                    withBadge: {
                        width: 100
                    },
                    width: 50
                },
                avatar: {
                    scale: .6
                },
                emblem: {
                    height: 100
                },
                name: {
                    height: 50,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: -3
                    }
                },
                prize: {
                    width: 80
                },
                data: {
                    paddingX: 10,
                    offsetY: 0,
                    bg: {
                        height: 60
                    },
                    margin: 7,
                    content: {
                        x: {
                            align: "center"
                        },
                        y: {
                            align: "center",
                            dy: 2
                        }
                    },
                    icon: {
                        rotation: -10
                    },
                    text: {
                        withoutIcon: {
                            width: 100
                        },
                        width: 65,
                        height: 50
                    }
                },
                button: {
                    width: 196,
                    height: 75,
                    type: cleverapps.styles.UI.Button.Images.button_green
                },
                tooltip: {
                    position: void 0,
                    mobilePosition: void 0
                }
            }, cleverapps.LeadersRow = cleverapps.Row.extend({
                ctor: function (e) {
                    this._super(e, {
                        prizes: !1
                    })
                }
            }), cleverapps.styles.LeadersRow = {}, cleverapps.MissionRow = cleverapps.Row.extend({
                ctor: function (e, t) {
                    this.mission = t.mission, this._super(e, t)
                },
                getRewards: function () {
                    return this.mission.getPrizeByPlace(this.currentPlace - 1)
                }
            }), FeastMissionRow = cleverapps.MissionRow.extend({
                ctor: function (e, t) {
                    this.amountTooltip = t.amountTooltip, this.missionName = t.mission.name, this._super(e, t)
                },
                getPrizeTooltipText: function () {
                    var t, e = this.getRewardUnit(this.currentPlace - 1);
                    return e ? Array.isArray(e) ? (t = [], e.forEach(function (e) {
                        t.push(cleverapps.unitsLibrary.getUnitName(e))
                    }), t.join(", ")) : cleverapps.unitsLibrary.getUnitName(e) : this._super()
                },
                getTooltipText: function () {
                    return this.amountTooltip
                },
                getRewardUnit: function (e) {
                    var t = RewardsConfig[this.missionName];
                    if (t && t.places) {
                        t = t.places[e];
                        if (t && t.unit) return t.unit
                    }
                },
                getRewards: function () {
                    return {
                        units: this.getRewardUnit(this.currentPlace - 1)
                    }
                }
            }), cleverapps.styles.FeastMissionRow = {}, cleverapps.DailyCupRow = cleverapps.Row.extend({
                ctor: function (e) {
                    this._super(e, {
                        dataIcon: bundles.tablerow_icons.frames.dailycup
                    })
                },
                createPrizeIcon: function (e) {
                    return cleverapps.DailyCupRow.choosePrizeIcon(cleverapps.dailyCup, e)
                },
                getRewards: function () {
                    return cleverapps.dailyCup.listRewards()[this.currentPlace - 1]
                },
                getPrizeTooltipText: function () {
                    return this.currentPlace <= 3 ? "Cup" + this.currentPlace + "PlaceTooltip" : "CupRewardTooltip"
                }
            }), cleverapps.DailyCupRow.choosePrizeIcon = function (e, t) {
                if (e.listRewards()[t - 1]) return new cc.Sprite(bundles.table.frames["prize_" + t] || bundles.table.frames.prize_5)
            }, cleverapps.DailyCupLeadersRow = cleverapps.Row.extend({
                ctor: function (e) {
                    this._super(e, {
                        badges: !1,
                        prizes: !1
                    })
                },
                generateMedalAmount: function (e, t) {
                    var s = cleverapps.styles.DailyCupLeadersRow,
                        e = new cc.Sprite(bundles.table.frames["badge_" + e]),
                        t = (e.setScale(.7), cleverapps.UI.generateImageText(t, cleverapps.styles.FONTS.SMALL_WHITE_TEXT)),
                        i = (t.setAnchorPoint2(0, .5), t.fitTo(s.text.width), new cc.Node);
                    return i.setAnchorPoint2(), i.setContentSize2(s.text.width, t.height), i.addChild(t), t.setPositionRound(0, t.height / 2), new cleverapps.Layout([e, i], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: s.iconMargin
                    })
                },
                createDataContent: function (e) {
                    var t = cleverapps.styles.DailyCupLeadersRow,
                        s = [];
                    return s.push(this.generateMedalAmount(1, e.firstPlace)), s.push(this.generateMedalAmount(2, e.secondPlace)), s.push(this.generateMedalAmount(3, e.thirdPlace)), new cleverapps.Layout(s, {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: t.margin
                    })
                }
            }), cleverapps.styles.DailyCupLeadersRow = {
                text: {
                    width: 50
                },
                iconMargin: 2,
                margin: 4
            }, cleverapps.Table = function () {
                this.results = {}
            }, cleverapps.Table.prototype.reset = function () {
                this.results = {}
            }, cleverapps.Table.prototype.updateResults = function (e, t) {
                this.results[e] = [];
                for (var s = 0; s < t.length; s++) this.results[e].push(cleverapps.clone(t[s]))
            }, cleverapps.Table.prototype.resetResults = function (e) {
                this.results[e] = void 0
            }, cleverapps.Table.prototype.getResults = function (e) {
                return this.results[e]
            }, cleverapps.Table.prototype.createTableView = function (e) {
                var t = new cleverapps.TableView(e.data, this.results[e.id], e.rowConstructor, e.dataIcon, e);
                return this.updateResults(e.id, e.data), t
            }, cleverapps.TableView = cc.Node.extend({
                setupRowPosition: function (e, t, s) {
                    var i = function () {
                        e.view.currentPlace === e.data.place && e.data.place > this.amountRows ? (e.view.removeFromParent(), delete this.rows[e.data.id]) : this.scroll && this.setRowVisibility(e), s && s()
                    }.bind(this),
                        n = (t = this.amountRows - t, cc.p(this.innerPadding, this.innerPadding + (this.styles.margin + e.view.height) * t + e.view.height / 2));
                    e.view.setLocalZOrder(t), s && (this.isVisiblePosition(e.view.y, e.view.height) || this.isVisiblePosition(n.y, e.view.height)) ? e.view.runAction(new cc.Sequence(new cc.MoveTo(.2, n), new cc.CallFunc(i))) : (e.view.setPositionRound(n), i())
                },
                isVisiblePosition: function (e, t) {
                    return e -= this.scroll.innerContent.height / 2, -this.scroll.innerContent.y - this.scroll.height / 2 - t / 2 <= e && e <= -this.scroll.innerContent.y + this.scroll.height / 2 + t / 2
                },
                finishAnimation: function () {
                    this.inSwapAnimation--, 0 === this.inSwapAnimation && this.swapIfNeed()
                },
                startAnimation: function (e) {
                    this.inSwapAnimation += e = e || 1
                },
                swapPairIfNeed: function (e, t) {
                    var s, i = e.view.currentPlace,
                        n = t.view.currentPlace;
                    this.startAnimation(2), e.view.updatePlace(n), t.view.updatePlace(i), this.setupRowPosition(e, n, this.finishAnimation.bind(this)), this.setupRowPosition(t, i, this.finishAnimation.bind(this)), e.data.player ? s = (this.rows[t.id] ? t : e).view : t.data.player && (s = (this.rows[e.id] ? e : t).view), s && this.scroll.runAction(new cc.ScrollAction(s, {
                        duration: .2,
                        visibleBox: {
                            top: .8,
                            bottom: .8
                        }
                    }).easing(cc.easeInOut(1)))
                },
                findRowWithPlace: function (e) {
                    for (var t in this.rows)
                        if (this.rows[t].view.currentPlace === e) return this.rows[t];
                    return !1
                },
                swapIfNeed: function () {
                    if (0 === this.inSwapAnimation) {
                        var e, t, s, i = this.amountRows + 2;
                        for (t in this.rows) this.rows[t].view.currentPlace > this.rows[t].data.place && this.rows[t].data.place < i && (i = this.rows[t].data.place, e = this.rows[t]);
                        for (t in !e || (s = this.findRowWithPlace(e.view.currentPlace - 1)) && this.swapPairIfNeed(s, e), this.rows) this.rows[t].data.place <= i && this.rows[t].view.updateAmount(this.rows[t].data.amount)
                    }
                },
                setRowVisibility: function (e) {
                    e && e.view && e.view.setVisible(
                        this.isVisiblePosition(e.view.y, e.view.height))
                },
                setRowsVisibility: function () {
                    for (var e in this.rows) this.setRowVisibility(this.rows[e])
                },
                cloneResults: function (e) {
                    for (var t = [], s = 0; s < e.length; s++) t.push(cleverapps.clone(e[s]));
                    return t
                },
                updateResults: function (e) {
                    if (this.amountRows !== e.length) return !1;
                    var t, s, i = this.cloneResults(e),
                        n = this.amountRows + 1;
                    for (t in this.rows) this.rows[t].data.place = n;
                    for (t = 0; t < i.length; t++) this.rows[i[t].id] ? (this.rows[i[t].id].data = i[t], this.rows[i[t].id].view.updateParams(i[t])) : (this.dataIcon && (i[t].dataIcon = this.dataIcon), (s = cleverapps.clone(i[t])).place = n, this.rows[i[t].id] = {
                        view: new this.RowConstructor(s, this.rowOptions),
                        data: i[t]
                    }, this.rows[i[t].id].view.setAnchorPoint2(0, .5), this.node.addChild(this.rows[i[t].id].view), this.setupRowPosition(this.rows[i[t].id], s.place));
                    return this.swapIfNeed(), !0
                },
                findPlayerView: function () {
                    for (var e in this.rows)
                        if (this.rows[e].data.player) return this.rows[e].view
                },
                ctor: function (e, t, s, i, n) {
                    for (this.options = n || {},
                        this.rows = {}, this.amountRows = 0, this.inSwapAnimation = 0, this.startAnimation(), t && e.length !== t.length && (t = void 0), e = this.cloneResults(e), t = this.cloneResults(t = t || e), s = s || cleverapps.Row, this.RowConstructor = s, this.dataIcon = i, this.rowOptions = this.options.rowOptions, c = 0; c < t.length; c++) this.dataIcon && (t[c].dataIcon = this.dataIcon), (t[c].clickableArea = this).rows[t[c].id] = {
                            view: new this.RowConstructor(t[c], this.rowOptions),
                            data: t[c]
                        }, this.amountRows++;
                    var s = this.styles = cleverapps.styles.TableView,
                        o = (this.innerPadding = this.options.innerPadding || s.innerPadding, this._super(), this.setAnchorPoint2(), this.node = new cc.Node),
                        a = (o.setAnchorPoint2(), this.styles.width),
                        r = 0;
                    for (var c in this.rows) this.rows[c].view.setAnchorPoint2(0, .5), o.addChild(this.rows[c].view), a = this.rows[c].view.width, r = this.rows[c].view.height, this.setupRowPosition(this.rows[c], this.rows[c].data.place);
                    r = this.contentHeight = this.amountRows * r + (this.amountRows - 1) * s.margin + 2 * this.innerPadding, o.setContentSize2(a + 2 * this.innerPadding, r),
                        this.scroll = new cleverapps.UI.ScrollView(o, {
                            childrenVisibility: cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,
                            containerMovedListener: this.createListener(this.setRowsVisibility.bind(this))
                        }), this.scroll.setBarPadding(s.barPadding), this.scroll.setAnchorPoint2(0, 0), this.addChild(this.scroll), !1 !== n.bg && (this.bg = new cc.Scale9Sprite(bundles.table.frames.table_bg_png), this.addChild(this.bg), this.bg.setLocalZOrder(-1)), this.updateSize(), this.runAction(new cc.Sequence(new cc.DelayTime(.7), new cc.CallFunc(this.finishAnimation.bind(this)))), this.updateResults(e), this.setRowsVisibility()
                },
                updateSize: function () {
                    var e = this.styles = cleverapps.styles.TableView,
                        t = this.options.height || e.height,
                        s = 0,
                        t = ((t = Array.isArray(this.options.height) ? this.options.height[cleverapps.resolution.mode].height : t) || e.height) + 2 * this.innerPadding;
                    this.contentHeight <= t && (s = t - this.contentHeight), this.scroll.setContentSize2(this.node.width, 0 === s ? t : this.contentHeight + 1), void 0 !== this.options.scroll ? this.scroll.scrollTo(
                        this.options.scroll) : 0 === s && this.scroll.scrollTo(this.findPlayerView()), this.setContentSize2(this.scroll.width + 2 * e.padding, t + 2 * e.padding), this.scroll.setPosition(e.padding, e.padding + s), !1 !== this.options.bg && (this.bg.setContentSize2(this.getContentSize()), this.bg.setPositionRound(this.width / 2, this.height / 2))
                }
            }), cleverapps.styles.TableView = {
                width: 500,
                height: 732,
                margin: 4,
                padding: 6,
                innerPadding: 6,
                barPadding: {
                    cornerPadding: 20,
                    sidePadding: 5
                }
            }, cc.Scale9Sprite.extend({
                ctor: function () {
                    var e = cleverapps.styles.DialoguePersonTitleView,
                        e = (this._super(e.image, cleverapps.UI.getScale9Rect(e.image, cleverapps.UI.Scale9Rect.TwoPixelXY)), this.originalSize = this.getContentSize(), this.titleText = cleverapps.UI.generateOnlyText("", cleverapps.styles.FONTS.DIALOGUE_PERSON_TITLE_TEXT));
                    e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.addChild(e), this.setAnchorPoint2(), this.setCascadeOpacityEnabled(!0), this.setVisible(!1)
                },
                updateString: function (e) {
                    var t = cleverapps.styles.DialoguePersonTitleView.text,
                        s = this.titleText;
                    s.setString(e), s.setFontSize(cleverapps.styles.FONTS.DIALOGUE_PERSON_TITLE_TEXT.size), this.setContentSize2(Math.max(s.width + 2 * t.padding.x, this.originalSize.width), Math.max(s.height + 2 * t.padding.y, this.originalSize.height)), s.setPositionRound(this.width / 2, this.height / 2 + t.offset.y)
                },
                updatePersonPosition: function (e) {
                    var t = cleverapps.styles.DialoguePersonTitleView,
                        e = e.x,
                        s = t.offsetX;
                    (e = e - this.width * this.scale / 2 - s < 0 ? this.width * this.scale / 2 + s : e) + this.width * this.scale / 2 + s > this.parent.baseContentSize.width && (e = this.parent.baseContentSize.width - this.width * this.scale / 2 - s), this.setPositionRound(e, cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? t.mobileY : t.y)
                },
                updateSize: function () {
                    this.setScale(cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? .6 : 1)
                },
                updatePosition: function () {
                    var e;
                    this.personView && (e = this.parent.convertToNodeSpace(this.personView.parent.convertToWorldSpace(this.personView.getPosition())), this.personView && this.updatePersonPosition(e))
                },
                update: function (e, t, s) {
                    this.personView = t;
                    var i = this.parent.convertToNodeSpace(t.parent.convertToWorldSpace(t.basePosition));
                    this.visible ? this.orientation === t.getOrientation() && this.title === e || this.runAction(new cc.Sequence(new cc.FadeOut(.2), new cc.CallFunc(function () {
                        this.updateString(e), this.updateSize(), this.updatePersonPosition(i), s()
                    }.bind(this)), new cc.FadeIn(.2))) : (this.updateString(e), this.updateSize(), this.updatePersonPosition(i), this.setVisible(!0), s()), this.orientation = t.getOrientation(), this.title = e
                },
                hide: function () {
                    this.visible && this.runAction(new cc.Sequence(new cc.FadeOut(.2), new cc.CallFunc(function () {
                        this.setVisible(!1), delete this.personView
                    }.bind(this))))
                }
            })),
        DialogueView = (cleverapps.styles.DialoguePersonTitleView = {
            image: bundles.dialogues.frames.dialogue_name,
            offsetX: 0,
            y: {
                align: "top",
                anchor: "center",
                dy: 0
            },
            mobileY: {
                align: "top",
                anchor: "center",
                dy: 0
            },
            text: {
                padding: {
                    x: 5,
                    y: 0
                },
                offset: {
                    y: -3
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e, t) {
                this.options = t || {}, this.dialogue = e;
                t = cleverapps.styles.DialogueView;
                this._super({
                    name: "DialogueViewWindow",
                    closeButton: !1,
                    closeByBackButton: !1,
                    noBackground: !0,
                    styles: cleverapps.overrideStyles(t.Window, this.options.window, !0),
                    noScaleAdjustment: !0,
                    openSound: bundles.dialogues.urls.dialogue_effect
                }), this.generateContent(), this.updateSize(), this.updatePosition(), e.on("showUp", this.showUp.bind(this), this), e.on("close", this.close.bind(this), this), e.on("addPerson", this.addPerson.bind(this), this), e.on("hidePerson", this.hidePerson.bind(this), this), e.on("updateActive", this.updateActive.bind(this), this), e.on("updatePersonTitle", this.updatePersonTitle.bind(this), this), e.on("changeText", this.changeText.bind(this), this), e.on("finishTyping", this.byLetterAnimationFinish.bind(this), this)
            },
            onShow: function () {
                this.dialogue.isStarted() || this.dialogue.run()
            },
            updateSize: function () {
                this.adjustBaseWindow();
                var e = cleverapps.styles.DialogueView,
                    t = (this.contentWrap.setContentSize(cleverapps.UI.getSceneSize()),
                        cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? 0 : e.widthPadding);
                this.content.setContentSize2(this.contentWrap.width - 2 * t, e.size[cleverapps.resolution.mode].height + cleverapps.UI.getBgOffset()), this.content.baseContentSize = this.content.getContentSize(), [this.leftPersonView, this.rightPersonView].forEach(function (e) {
                    e && (e.stopAllActions(), e.setVisible(!0), this.updatePersonSize(e))
                }.bind(this)), cleverapps.UI.wrap(this.dialogueContent, {
                    keepPosition: !0
                })
            },
            updatePersonSize: function (e) {
                var t = cleverapps.styles.DialogueView,
                    s = 1,
                    t = s = cleverapps.resolution.mode !== cleverapps.WideMode.HORIZONTAL ? cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? t.persons.mobileScale : t.persons.squareScale : s;
                "left" !== e.getOrientation() && (t = -t), e.setScale(t, s)
            },
            updatePosition: function () {
                var e = cleverapps.styles.DialogueView,
                    t = e.position,
                    s = e.contentPosition,
                    t = (this.contentWrap.setPositionRound(t), this.dialogueContent.setPositionRound(s),
                        cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? 0 : e.widthPadding);
                this.content.stopAllActions(), this.content.setOpacity(255), this.content.setPositionRound(this.content.parent.convertToNodeSpace(cc.p(t, e.offsetY))), [this.leftPersonView, this.rightPersonView].forEach(function (e) {
                    e && this.updatePersonPosition(e)
                }.bind(this))
            },
            updatePersonPosition: function (e) {
                var t, s = cleverapps.styles.DialogueView,
                    i = s.persons.aboveContent ? this.content.y + this.content.height : 0,
                    n = (s.persons.aboveContent && (i += cleverapps.styles.WindowPersons.position.dy[e.role] || s.persons.dy), Math.abs(e.getScaleX()));
                [cleverapps.WideMode.SQUARE, cleverapps.WideMode.VERTICAL].includes(cleverapps.resolution.mode) && (i + (t = e.height / 2 - e.height / 2 * n) < this.content.y + this.content.height && (i += t), i += cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? s.persons.mobileOffsetY : s.persons.squareOffsetY), t = "left" === e.getOrientation() ? (t = e.calculateCoordinate(s.persons.left[cleverapps.resolution.mode].x, "x", this.contentWrap.width),
                    Math.min(t, this.contentWrap.width / 2 - s.persons.padding / 2 - e.width / 2 * n)) : (t = e.calculateCoordinate(s.persons.right[cleverapps.resolution.mode].x, "x", this.contentWrap.width), Math.max(t, this.contentWrap.width / 2 + s.persons.padding / 2 + e.width / 2 * n)), e.basePosition = {
                        x: t,
                        y: i
                    }, e.setPositionRound(t, i)
            },
            generateContent: function () {
                var e = this.content = cleverapps.UI.createScale9Sprite(bundles.dialogues.frames.bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY),
                    t = (e.setAnchorPoint2(0, 0), e.setCascadeOpacityEnabled(!0), this.dialogueContent = new cc.Node),
                    e = (t.avoidNode = "DialogueView", t.setVisible(!1), t.addChild(e), this.contentWrap = new cc.Node);
                e.setAnchorPoint(0, .5), e.addChild(t), cleverapps.UI.onClick(e, function () {
                    return this.dialogue.screenClicked(), !0
                }.bind(this), {
                    ignoreScale: !0
                }), e.setContentSize(cleverapps.UI.getSceneSize()), e.setLocalZOrder(1), this.addChild(e)
            },
            showUp: function (e, t) {
                var s = cleverapps.styles.DialogueView.showAnimation;
                if (e) return this.dialogueContent.setVisible(!0), void t();
                "fromBelow" === s ? this.showUpFromBelow(t) : this.showUpFromSides(t)
            },
            showUpFromSides: function (e) {
                var t = this.content.getContentSize();
                this.content.setContentSize(.6 * t.width, t.height), this.content.setOpacity(0), this.textBgArrow && this.textBgArrow.setVisible(!1), [this.leftPersonView, this.rightPersonView].forEach(function (e) {
                    var t, s, i;
                    e && (t = e.basePosition, s = "left" === e.getOrientation() ? cc.p(-e.width / 2, t.y) : cc.p(this.contentWrap.width + e.width / 2, t.y), i = e.isActive ? 0 : .25, e.setVisible(!1), e.setPosition(s), e.runAction(new cc.Sequence(new cc.DelayTime(i), new cc.Show, new cc.MoveTo(.25, t).easing(cc.easeBackOut()))))
                }.bind(this)), this.content.runAction(new cc.Sequence(new cc.DelayTime(.25), new cc.Spawn(new cc.FadeTo(.25, 255), new Scale9SpriteResizeTo(.25, t)))), this.dialogueContent.runAction(new cc.Sequence(new cc.DelayTime(.25), new cc.Show, new cc.DelayTime(.25), new cc.CallFunc(function () {
                    e(), this.textBgArrow && this.textBgArrow.setVisible(!0)
                }.bind(this))))
            },
            showUpFromBelow: function (e) {
                var s = cleverapps.styles.DialogueView,
                    t = this.content.getPosition(),
                    i = cc.p(t.x, -this.content.height);
                this.content.setPositionRound(i), this.content.runAction(new cc.Sequence(new cc.DelayTime(this.options.delay || 0), new cc.MoveTo(.2, t.x, t.y + s.showUp.offset), new cc.MoveTo(.1, t))), this.dialogueContent.runAction(new cc.Sequence(new cc.DelayTime(this.options.delay || 0), new cc.Show, new cc.DelayTime(.3), new cc.CallFunc(e))), [this.leftPersonView, this.rightPersonView].forEach(function (e) {
                    var t;
                    e && (t = e.basePosition, e.setVisible(!1), e.setPosition(t.x, i.y + this.content.height), e.runAction(new cc.Sequence(new cc.DelayTime(this.options.delay || 0), new cc.Show, new cc.MoveTo(.2, cc.p(t.x, t.y + s.showUp.offset)), new cc.MoveTo(.1, t.x, t.y))))
                }.bind(this))
            },
            addPerson: function (e, t) {
                var s, i = Person.ParseOptions(e).role;
                PersonsLibrary.getPerson(i) ? ((s = new Person(e)).setAnchorPoint2(.5, 0), s.setActive(e.active), this.dialogueContent.addChild(s), "left" === s.getOrientation() ? this.leftPersonView = s : this.rightPersonView = s,
                    this.updatePersonSize(s), this.updatePersonPosition(s), e = s.basePosition, t || ("left" === s.getOrientation() ? s.setPosition(cc.p(-s.width / 2, e.y)) : s.setPosition(cc.p(this.contentWrap.width + s.width / 2, e.y)), s.setVisible(!1), s.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.Show, new cc.MoveTo(.25, e).easing(cc.easeBackOut()))))) : cleverapps.throwAsync("Person is undefined - " + i)
            },
            updateActive: function (e) {
                e = "left" === e;
                this.leftPersonView && (this.leftPersonView.setActive(e), this.leftPersonView.setSpeaking(e)), this.rightPersonView && (this.rightPersonView.setActive(!e), this.rightPersonView.setSpeaking(!e))
            },
            updatePersonTitle: function (e) {
                var t = cleverapps.styles.DialogueView;
                if (this.personTitle || (this.personTitle = new DialoguePersonTitleView, this.content.addChild(this.personTitle, 1)), !e) return this.personTitle.hide(), void (this.textBgArrow && this.textBgArrow.setVisible(!1));
                var s = Messages.has("Dialogue.person." + e.role) && Messages.get("Dialogue.person." + e.role),
                    i = (s || (
                        cleverapps.config.debugMode && console.error("person has no name! Dialogue.person." + e.role + " is missing in localization"), s = Messages.get("Dialogue.person.noName")), "left" === e.orientation);
                this.personTitle.update(s, i ? this.leftPersonView : this.rightPersonView, function () {
                    var s = t.text.arrow;
                    s && (this.textBgArrow || (this.textBgArrow = new cc.Sprite(bundles.dialogues.frames.dialogue_arrow_png), this.content.addChild(this.textBgArrow)), this.textBgArrow.setVisible(!0), this.textBgArrow.setScaleX(i ? 1 : -1), this.textBgArrow.updatePosition = function () {
                        var e, t;
                        "relative" === s.offsetX ? this.leftPersonView && this.leftPersonView.isActive ? (e = this.content.convertToNodeSpace(this.leftPersonView.parent.convertToWorldSpace(this.leftPersonView.basePosition)).x, e += this.leftPersonView.getBoundingBox().width / 2, t = this.content.convertToNodeSpace(this.personTitle.parent.convertToWorldSpace(this.personTitle.getPosition())).x, t += this.personTitle.getBoundingBox().width / 2, this.textBgArrow.setPositionRound((t < e ? e : t) + this.textBgArrow.width / 2, s.y)) : this.rightPersonView && this.rightPersonView.isActive && (e = this.content.convertToNodeSpace(this.rightPersonView.parent.convertToWorldSpace(this.rightPersonView.basePosition)).x, e -= this.rightPersonView.getBoundingBox().width / 2, t = this.content.convertToNodeSpace(this.personTitle.parent.convertToWorldSpace(this.personTitle.getPosition())).x, t -= this.personTitle.getBoundingBox().width / 2, this.textBgArrow.setPositionRound((e < t ? e : t) - this.textBgArrow.width / 2, s.y)) : this.textBgArrow.setPositionRound(i ? s.offsetX : this.content.width - s.offsetX, s.y)
                    }.bind(this), this.textBgArrow.updatePosition())
                }.bind(this))
            },
            hidePerson: function (e) {
                var t, s, i;
                "right" !== e && this.leftPersonView && (t = this.leftPersonView.getPosition(), s = cc.p(-this.leftPersonView.width / 2, t.y), i = this.leftPersonView, delete this.leftPersonView), "right" === e && this.rightPersonView && (t = this.rightPersonView.getPosition(), s = cc.p(this.contentWrap.width + this.rightPersonView.width / 2, t.y), i = this.rightPersonView,
                    delete this.rightPersonView), i && i.runAction(new cc.Sequence(new cc.MoveTo(.25, s).easing(cc.easeIn(5)), new cc.RemoveSelf))
            },
            changeText: function (r, c) {
                var l = cleverapps.styles.DialogueView;
                this.text && this.text.removeFromParent(), this.text = cleverapps.UI.generateOnlyText(r, cleverapps.styles.FONTS.DIALOGUE_MESSAGE_TEXT || cleverapps.styles.FONTS.FORCE_MESSAGE_TEXT), this.text.initTextSize = this.text.getFontSize(), this.content.addChild(this.text, 1), this.text.updatePosition = function () {
                    var e = l.text,
                        t = e.padding,
                        s = l.text.alignment,
                        s = (cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && (t = e.verticalPadding, s = l.text.verticalAlignment), this.text.setHorizontalAlignment(s), this.content.width - t.fromWallX),
                        i = t.x,
                        n = (c && (s = this.content.width - t.x, i = t.fromWallX), this.content.height - t.y),
                        o = 1,
                        a = s - i,
                        t = n - t.y;
                    a > e.optimization.width && (a /= o = 1.5, t /= o), this.text.setFontSize(Math.round(this.text.initTextSize / o)), this.text.setDimensions(a, 0), this.text.fitTo(void 0, t), this.text.setScale(o), this.text.setAnchorPoint2(
                        .5, 1), this.text.setPositionRound((i + s) / 2, n), this.text._byLetterAnimationRunning && (this.text._byLetterAnimationDone(), this.text.setString(r))
                }.bind(this), this.text.updatePosition(), this.text.byLetterAnimation({
                    callback: this.dialogue.finishTyping.bind(this.dialogue)
                })
            },
            close: function (e) {
                this.byLetterAnimationFinish(), this.content.stopAllActions();
                var t = function () {
                    this.dialogue.trigger("beforeClose"), Window.prototype.close.apply(this, arguments), this.dialogue.finishClose()
                }.bind(this);
                e ? t() : "fromBelow" === cleverapps.styles.DialogueView.showAnimation ? this.closeToBelow(t) : this.closeToSides(t)
            },
            closeToSides: function (e) {
                this.text && this.text.removeFromParent(), this.textBgArrow && this.textBgArrow.setVisible(!1), [this.leftPersonView, this.rightPersonView].forEach(function (e) {
                    var t, s;
                    e && (t = e.getPosition(), t = "left" === e.getOrientation() ? cc.p(-e.width / 2, t.y) : cc.p(this.contentWrap.width + e.width / 2, t.y), s = e.isActive ? .25 : 0, e.runAction(new cc.Sequence(new cc.DelayTime(s), new cc.MoveTo(.25, t))))
                }.bind(this)),
                    this.content.runAction(new cc.Spawn(new cc.FadeTo(.5, 0), new Scale9SpriteResizeTo(.5, .6 * this.content.width, this.content.height))), this.dialogueContent.runAction(new cc.Sequence(new cc.DelayTime(.5), new cc.CallFunc(e)))
            },
            closeToBelow: function (e) {
                var t = cleverapps.styles.DialogueView,
                    s = cc.p(this.content.x, -this.content.height);
                this.content.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.MoveTo(.15, cc.p(this.content.x, this.content.y + t.showUp.offset)), new cc.MoveTo(.15, s), new cc.CallFunc(e), new cc.RemoveSelf)), [this.leftPersonView, this.rightPersonView].forEach(function (e) {
                    e && e.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.MoveTo(.15, cc.p(e.x, e.y + t.showUp.offset)), new cc.MoveTo(.15, e.x, s.y + this.content.height)))
                }.bind(this))
            },
            byLetterAnimationFinish: function (t) {
                this.text && (this.text.updatePosition(), this.text.byLetterAnimationFinish()), [this.leftPersonView, this.rightPersonView].forEach(function (e) {
                    e && e.setSpeaking(!1, t)
                })
            },
            listBundles: function (e) {
                return e.bundlesToLoad.slice()
            }
        })),
        MinimalDialogue = (cleverapps.styles.DialogueView = {
            position: {
                x: {
                    align: "left",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            contentPosition: {
                x: {
                    align: "left",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: 0
                }
            },
            size: [{
                height: 240
            }, {
                height: 280
            }, {
                height: 280
            }],
            widthPadding: 0,
            offsetY: 20,
            showAnimation: "fromSides",
            showUp: {
                offset: 75
            },
            text: {
                alignment: cc.TEXT_ALIGNMENT_LEFT,
                verticalAlignment: cc.TEXT_ALIGNMENT_CENTER,
                arrow: {
                    y: {
                        align: "top",
                        dy: 23
                    },
                    offsetX: "relative"
                },
                padding: {
                    fromWallX: 30,
                    x: 30,
                    y: 30
                },
                verticalPadding: {
                    fromWallX: 50,
                    x: 50,
                    y: 40
                },
                optimization: {
                    width: 1e3
                }
            },
            persons: {
                aboveContent: !0,
                dy: 0,
                mobileOffsetY: 0,
                squareOffsetY: 0,
                mobileScale: .8,
                squareScale: 1,
                left: [{
                    x: {
                        align: "left",
                        dx: 20
                    }
                }, {
                    x: {
                        align: "left",
                        dx: 75
                    }
                }, {
                    x: {
                        align: "left",
                        dx: 75
                    }
                }],
                right: [{
                    x: {
                        align: "right",
                        dx: -20
                    }
                }, {
                    x: {
                        align: "right",
                        dx: -75
                    }
                }, {
                    x: {
                        align: "right",
                        dx: -75
                    }
                }],
                padding: 100
            },
            Window: {
                windowShowUpAnimation: !1
            }
        }, cc.Node.extend({
            avoidNode: "MinimalDialogue",
            ctor: function (e) {
                this._super(), this.options = e || {},
                    this.targetRect = this.options.targetRect || this.options.rects && this.options.rects[0], this.setAnchorPoint2(), this.setLocalZOrder(20), this.options.text && (this.items = [this.options.text]), this.options.items && (this.items = this.options.items), e.control && cleverapps.meta.registerControl(e.control, this.createListener(function (e) {
                        e ? this.showUp() : this.hide(void 0, !0)
                    }))
            },
            display: function () {
                var e;
                this.createContent({
                    person: !0
                }), this.calculatePosition() || (e = this.calcMaxDimensions(), this.createContent({
                    person: !0,
                    maxDimensions: e
                }), this.calculatePosition() || (this.createContent({
                    person: !1,
                    maxDimensions: e
                }), this.calculatePosition() || this.logError())), this.debugInfo && this.debugInfo.show(), this.options.hidden || (MinimalDialogue.lastShown && MinimalDialogue.lastShown + 3e4 > Date.now() && (this.options.shortAnimations = !0), MinimalDialogue.lastShown = Date.now(), this.showUp())
            },
            updatePosition: function () {
                this.calculatePosition()
            },
            updateOrientation: function () {
                var e = cleverapps.scenes.getRunningScene(),
                    t = cleverapps.styles.MinimalDialogue;
                this.x > e.width / 2 + 3 ? (this.personNode && (this.textBgArrow.setPositionRound(t.text.arrow.right), this.textBgArrow.setScaleX(-1), this.personNode.setScaleX(-Math.abs(this.personNode.getScaleX())), this.personNode.setPositionRound({
                    align: "right"
                }, {
                    align: "center"
                })), this.bg.setAnchorPoint(1, .5), this.bg.setPositionRound({
                    align: "left"
                }, {
                    align: "center"
                })) : (this.personNode && (this.textBgArrow.setPositionRound(t.text.arrow.left), this.textBgArrow.setScaleX(1), this.personNode.setScaleX(Math.abs(this.personNode.getScaleX())), this.personNode.setPositionRound({
                    align: "left"
                }, {
                    align: "center"
                })), this.bg.setAnchorPoint(0, .5), this.bg.setPositionRound({
                    align: "right"
                }, {
                    align: "center"
                }))
            },
            logError: function () {
                var e = cc.view.getFrameSize(),
                    t = this.listRects(),
                    t = "Could not position minimal dialog. rects: " + JSON.stringify(t),
                    s = this.listDialogueRects(),
                    s = (t = t + " dialogRects: " + JSON.stringify(s), this.items.map(function (e, t) {
                        t = this.contentItems[t];
                        if ("string" == typeof e) return JSON.stringify({
                            text: e,
                            fontSize: t.getFontSize(),
                            font: t.font,
                            checkFont: document.fonts && document.fonts.check(t.font),
                            width: t.width,
                            height: t.height
                        });
                        t = {};
                        return e.debugInfo && (t = e.debugInfo), JSON.stringify(Object.assign(t, {
                            width: e.width,
                            height: e.height,
                            scale: e.scale
                        }))
                    }, this)),
                    s = (t = t + ", items: " + s.join(" + ") + ", frame size:" + e.width + " by " + e.height, cleverapps.scenes.getRunningScene());
                t = t + ", scene size:" + s.width + " by " + s.height + ", resolutionScale:" + resolutionScale + ", dpr:" + window.devicePixelRatio, 800 < s.width + s.height && cleverapps.throwAsync(t)
            },
            removeContent: function () {
                this.options.items && this.options.items.forEach(function (e) {
                    e.parent && (e.removeFromParent(!0), e.setPosition(0, 0))
                }), this.bg && (this.bg.removeAllChildren(), this.bg.removeFromParent(!0)), this.personNode && (this.personNode.removeFromParent(), this.personNode = void 0), delete this.personBackground, delete this.personAnimation
            },
            createContent: function (e) {
                this.removeContent();
                var t, s = cleverapps.styles.MinimalDialogue,
                    i = cc.size(0, 0),
                    n = (e.person && (t = this.personNode = this.createPerson(), n = s.person.margin, i = cc.size(t.width * t.scale + n, t.height * t.scale)), cleverapps.scenes.getRunningScene()),
                    n = cc.rectSubPadding(n.getGlobalBoundingBox(), cc.padding(s.padding)),
                    o = (n.width = Math.min(n.width, s.maxWidth), cc.rect(n.x, n.y, n.width - i.width, Math.min(n.height, s.text.maxHeight))),
                    n = (e.maxDimensions && (o.width = Math.min(n.width, e.maxDimensions.width), o.height = Math.min(n.height, e.maxDimensions.height)), cc.padding(cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? s.text.verticalPadding : s.text.padding)),
                    a = cc.rectSubPadding(o, n),
                    e = this.items.map(function (e) {
                        var t;
                        return "string" == typeof e ? (t = cleverapps.resolution.resizeFont(cleverapps.styles.FONTS.FORCE_MESSAGE_TEXT), (t = cleverapps.UI.generateOnlyText(e, t)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.width > a.width && t.setDimensions(a.width, 0), t) : (cleverapps.UI.fitToBox(e, {
                            width: a.width,
                            maxScale: e.scale
                        }), e)
                    }),
                    r = e.reduce(function (e, t) {
                        return e + t.height * t.scaleY
                    }, 0),
                    o = (
                        r > a.height && e.forEach(function (e) {
                            var t = e.height * a.height / r;
                            e.fitTo ? e.fitTo(a.width, t) : cleverapps.UI.fitToBox(e, {
                                width: a.width,
                                height: t
                            })
                        }), this.contentItems = e, "undefined" !== this.options.direction ? this.options.direction : cleverapps.UI.VERTICAL),
                    e = (this.content = new cleverapps.Layout(e, {
                        margin: s.margin,
                        direction: o
                    }), Math.max(this.content.height, s.text.minHeight)),
                    o = cc.rectAddPadding(cc.rect(0, 0, this.content.width, e), n);
                this.bg = cleverapps.UI.createScale9Sprite(bundles.dialogues_minimal.frames.bg_minimal_png, cleverapps.UI.Scale9Rect.TwoPixelXY), this.bg.setContentSize2(o), this.bg.addChild(this.content), s.text.arrow && t && (this.textBgArrow = new cc.Sprite(bundles.dialogues_minimal.frames.mini_arrow_bg_png), this.bg.addChild(this.textBgArrow)), this.content.setPositionRound(n.left + this.content.width / 2, n.bottom + e / 2), this.bg.setCascadeOpacityEnabledRecursively(!0), this.bg.setOpacity(0), this.content.setCascadeOpacityEnabledRecursively(!0), this.setContentSize2(i.width + o.width, Math.max(i.height, o.height)), this.addChild(this.bg), t && this.addChild(t), this.updateOrientation(), this.setVisible(!1)
            },
            createPerson: function () {
                var e = new cc.Node,
                    t = (e.setAnchorPoint2(), this.personBackground = new cleverapps.Spine(bundles.dialogues_minimal.jsons.bg_person)),
                    t = (e.setContentSize2(t.width, t.height), t.setPositionRound(e.width / 2, e.height / 2), e.addChild(t), "hero"),
                    s = (this.options.person && PersonsLibrary.getMinimalJson(this.options.person) && (t = cleverapps.skins.getSlot(this.options.person) || this.options.person), PersonsLibrary.getMinimalJson(t)),
                    s = (this.personAnimation = new cleverapps.Spine(s), this.personAnimation.setPositionRound(e.width / 2, e.height / 2), e.addChild(this.personAnimation), t + "_minimal"),
                    t = cleverapps.skins.getSlot(s);
                return t && this.personAnimation.setSkin(t), cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && e.setScale(.8), e
            },
            calculatePosition: function () {
                var e = cleverapps.UI.getSceneSize(),
                    t = cleverapps.styles.MinimalDialogue;
                if (this.options.forcePosition) this.options.forcePosition === Dialogue.POSITIONS.TOP ? this.setPositionRound(e.width / 2, e.height - this.height / 2 - t.positions.top.y) : this.options.forcePosition === Dialogue.POSITIONS.TOP_LOWER ? this.setPositionRound(e.width / 2, e.height - this.height / 2 - t.positions.topLower.y) : this.options.forcePosition === Dialogue.POSITIONS.BOTTOM ? this.setPositionRound(e.width / 2, this.height / 2 + t.positions.bottom.y) : this.options.forcePosition === Dialogue.POSITIONS.CENTER ? this.setPositionRound(e.width / 2, e.height / 2) : this.setPositionRound(this.options.forcePosition);
                else {
                    if (this.options.rects && this.options.rects.length) return this.calcDynamicPosition();
                    this.setPositionRound(e.width / 2, this.height / 2 + t.positions.bottom.y)
                }
                return !0
            },
            listRects: function () {
                var e = cleverapps.styles.MinimalDialogue,
                    t = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? e.rectsOffsetMobile : e.rectsOffset,
                    s = cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? e.targetOffsetMobile : e.targetOffset;
                return this.options.rects.map(function (e) {
                    return e === this.targetRect ? cc.rect(e.x - t, e.y - t, e.width + 2 * t, e.height + 2 * t) : cc.rect(e.x - s.left, e.y - s.down, e.width + s.left + s.right, e.height + s.down + s.up)
                })
            },
            listAllPositions: function (e) {
                for (var t = cleverapps.scenes.getRunningScene(), s = cc.rectSubPadding(t.getGlobalBoundingBox(), cc.padding(this.height / 2, this.width / 2)), i = [], n = 0; n < e.length; n++)
                    for (var o = e[n], a = this.calcPositionSlots(o), r = 0; r < a.length; r++) i.push(cc.nearestToRect(s, a[r]));
                return i
            },
            listDialogueRects: function (e) {
                e = e || {};
                var t = [this.bg.getGlobalBoundingBox()];
                return this.personNode && !e.withoutPerson && t.unshift(this.personNode.getGlobalBoundingBox()), t
            },
            calcIntersection: function (e, t) {
                var i, n = 0,
                    s = cleverapps.bannerAd.getGlobalBoundingBox();
                if (s && (t = [].concat(t).concat([s])), e.forEach(function (s) {
                    t.forEach(function (e) {
                        var e = cc.rectIntersection(s, e),
                            t = 2 < e.width && 2 < e.height ? e.width * e.height : 0;
                        n < t && (n = t, i = e)
                    }, this)
                }, this), 0 < n) return {
                    area: n,
                    rect: i
                }
            },
            calcMaxDimensions: function () {
                var e = this.listRects(),
                    n = this.listDialogueRects({
                        withoutPerson: !0
                    }).reduce(function (e, t) {
                        return cc.rectUnion(e, t)
                    }),
                    o = cc.size(),
                    a = cc.rectGetCenter(n);
                return e.forEach(function (e) {
                    var e = cc.rectIntersection(n, e),
                        t = cc.rectGetCenter(e),
                        s = e.y - n.y + e.height,
                        i = (t.y > a.y && (s = n.height - e.y - n.y), e.x - n.x + e.width);
                    t.x > a.x && (i = n.width - e.x - n.x), o.width = i > o.width ? i : o.width, o.height = s > o.height ? s : o.height
                }), o.width / n.width < o.height / n.height ? o.height = 0 : o.width = 0, cc.size(n.width - o.width, n.height - o.height)
            },
            pickVariant: function (e) {
                var t = cleverapps.scenes.getRunningScene(),
                    i = cc.p(t.width / 2, t.height / 2),
                    n = cc.rectGetCenter(this.targetRect),
                    t = e.filter(function (e) {
                        return e.intersection
                    }),
                    e = e.filter(function (e) {
                        return !e.intersection
                    });
                return 0 < e.length ? (e.sort(function (e, t) {
                    var s = cc.pDistance(e.position, n) - cc.pDistance(t.position, n);
                    return 30 < Math.abs(s) ? s : cc.pDistance(e.position, i) - cc.pDistance(t.position, i)
                }), e[0]) : (t.sort(function (e, t) {
                    return e.intersection.area - t.intersection.area
                }), t[0])
            },
            calcDynamicPosition: function () {
                var i = this.listRects(),
                    n = [],
                    e = (
                        this.listAllPositions(i).forEach(function (e) {
                            var t = this.getParent().convertToNodeSpace(e),
                                s = (this.setPositionRound(t), this.listDialogueRects());
                            n.push({
                                localPosition: t,
                                position: e,
                                dialogueRects: s,
                                intersection: this.calcIntersection(s, i)
                            })
                        }, this), this.pickVariant(n));
                return cleverapps.flags.debugMinimalDialogue && (this.debugInfo || (this.debugInfo = new MinimalDialogueDebug(this)), this.debugInfo.addVariants(n), this.debugInfo.setPickedVariant(e)), this.setPositionRound(e.localPosition), this.updateOrientation(), !e.intersection
            },
            calcPositionSlots: function (e) {
                var t = {
                    x: e.x - this.width / 2,
                    y: e.y + e.height / 2
                },
                    s = {
                        x: e.x + e.width + this.width / 2,
                        y: e.y + e.height / 2
                    };
                return [{
                    x: e.x + e.width / 2,
                    y: e.y + e.height + this.height / 2
                }, {
                    x: e.x + e.width / 2,
                    y: e.y - this.height / 2
                }, t, s]
            },
            showUp: function () {
                var s;
                this.shown || (this.shown = !0, this.stopAllActions(), this.bg.stopAllActions(), this.content.stopAllActions(), this.bg.setOpacity(0), this.bg.setVisible(!0), s = cleverapps.styles.MinimalDialogue, this.runAction(new cc.Sequence(new cc.DelayTime(
                    void 0 !== this.options.delay ? this.options.delay : .5), new cc.Show, new cc.CallFunc(function () {
                        var e, t = "minimal_showup";
                        this.options.shortAnimations ? (t = "minimal_short_showup", e = this.getPosition(), this.setPosition(e.x, e.y - s.moveY), this.runAction(new cc.MoveTo(.3, e).easing(cc.easeOut(2))), this.fadeInShowUp()) : this.bubbleShowUp(), this.personAnimation && (this.personAnimation.setVisible(!0), this.personAnimation.setAnimationAndIdleAfter(t, "talk_minimal"), this.personBackground.setVisible(!0), this.personBackground.setAnimationAndIdleAfter(t, "minimal_idle")), cleverapps.audio.playSound(bundles.dialogues.urls.dialogue_effect)
                    }.bind(this)))))
            },
            fadeInShowUp: function () {
                this.bg.runAction(new cc.FadeIn(.3))
            },
            fadeOutHide: function () {
                this.bg.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide))
            },
            bubbleShowUp: function () {
                this.bg.setScale(.46), this.bg.runAction(new cc.Sequence(new cc.DelayTime(.15), new cc.ScaleTo(.3, 1.16, 1.26).easing(cc.easeIn(1)), new cc.ScaleTo(.2, 1).easing(cc.easeOut(1)))),
                    this.bg.runAction(new cc.Sequence(new cc.DelayTime(.15), new cc.FadeIn(.17)))
            },
            bubbleHide: function () {
                this.bg.runAction(new cc.Sequence(new cc.DelayTime(.13), new cc.ScaleTo(.17, 1.16, 1.26).easing(cc.easeIn(1)), new cc.ScaleTo(.17, 0).easing(cc.easeOut(1)), new cc.Hide))
            },
            hide: function (e, t) {
                if (this.shown) {
                    if (this.stopAllActions(), this.bg.stopAllActions(), this.content.stopAllActions(), t) return this.bg.setOpacity(0), this.bg.setVisible(!1), this.personBackground && this.personBackground.setVisible(!1), this.personAnimation && this.personAnimation.setVisible(!1), this.shown = !1, void (e && e());
                    this.options.shortAnimations ? (this.runAction(new cc.MoveBy(.3, 0, -cleverapps.styles.MinimalDialogue.moveY).easing(cc.easeIn(2))), this.fadeOutHide(), this.personAnimation && (this.personAnimation.setAnimation(0, "minimal_short_hide", !1), this.personBackground.setAnimation(0, "minimal_short_hide", !1))) : (this.bubbleHide(), this.personAnimation && (this.personAnimation.setAnimation(0, "minimal_hide", !1),
                        this.personBackground.setAnimation(0, "minimal_hide", !1))), this.personAnimation && this.personAnimation.setCompleteListenerOnce(function () {
                            this.personAnimation.setVisible(!1), this.personBackground.setVisible(!1)
                        }.bind(this)), this.runAction(new cc.Sequence(new cc.DelayTime(.6), new cc.CallFunc(function () {
                            e && e()
                        }))), this.shown = !1
                } else e && e()
            },
            remove: function (e, t) {
                this.hide(function () {
                    this.removeFromParent(), e && e()
                }.bind(this), t)
            }
        })),
        ShopUserGoldView = (cleverapps.styles.MinimalDialogue = {
            rectsOffset: 10,
            rectsOffsetMobile: 5,
            targetOffset: {
                left: 30,
                right: 40,
                up: 30,
                down: 50
            },
            targetOffsetMobile: {
                left: 15,
                right: 20,
                up: 15,
                down: 25
            },
            maxWidth: 1e3,
            margin: 10,
            moveY: 20,
            padding: {
                x: 10,
                y: 10
            },
            person: {
                margin: 10
            },
            text: {
                maxHeight: 450,
                minHeight: 90,
                padding: {
                    top: 35,
                    bottom: 35,
                    left: 40,
                    right: 40
                },
                verticalPadding: {
                    top: 25,
                    bottom: 25,
                    left: 30,
                    right: 30
                }
            },
            positions: {
                topLower: {
                    y: 200
                },
                top: {
                    y: 100
                },
                bottom: {
                    y: 20
                }
            }
        }, cleverapps.config.debugMode && ((MinimalDialogueDebug = function (e) {
            e.addCleaner(this.hide.bind(this)), this.minimal = e,
                this.rects = e.listRects(), this.variants = [], this.pickedVariant = void 0
        }).prototype.addVariants = function (e) {
            this.variants = this.variants.concat(e)
        }, MinimalDialogueDebug.prototype.setPickedVariant = function (e) {
            this.pickedVariant = e
        }, MinimalDialogueDebug.prototype.show = function () {
            this.currentNodes = [], this.currentStep = this.variants.indexOf(this.pickedVariant), this.drawCurrentStep(), this.keyboardListener = cc.eventManager.addListener({
                event: cc.EventListener.KEYBOARD,
                onKeyPressed: function (e) {
                    e === cc.KEY.right && this.currentStep < this.variants.length - 1 && (this.currentStep++, this.drawCurrentStep()), e === cc.KEY.left && 0 < this.currentStep && (this.currentStep--, this.drawCurrentStep())
                }.bind(this)
            }, this.minimal)
        }, MinimalDialogueDebug.prototype.drawCurrentStep = function () {
            this.clearCurrentStep();
            var s = this.variants[this.currentStep];
            this.rects.forEach(function (e) {
                this.currentNodes.push(this.drawRect(e, new cc.Color(0, 0, 255, 255)))
            }, this), s.dialogueRects.forEach(function (e) {
                var t = s.intersection && s.intersection.rect ? new cc.Color(255, 0, 0, 255) : new cc.Color(0, 255, 0, 255);
                this.currentNodes.push(this.drawRect(e, t))
            }, this), s.intersection && s.intersection.rect && this.currentNodes.push(this.drawRect(s.intersection.rect, new cc.Color(255, 0, 0, 255), new cc.Color(255, 0, 0, 255)))
        }, MinimalDialogueDebug.prototype.clearCurrentStep = function () {
            this.currentNodes.forEach(function (e) {
                e.removeFromParent()
            }), this.currentNodes = []
        }, MinimalDialogueDebug.prototype.drawRect = function (e, t, s) {
            s = s || new cc.Color(0, 0, 0, 0);
            var i = new cc.DrawNode;
            return i.setAnchorPoint(0, 0), i.setContentSize2(e.width, e.height), i.setPositionRound(e.x, e.y), i.drawRect(cc.p(0, 0), cc.p(e.width, e.height), s, 3, t), i.setLocalZOrder(1e3), cleverapps.scenes.getRunningScene().addChild(i), i
        }, MinimalDialogueDebug.prototype.hide = function () {
            cc.eventManager.removeListener(this.keyboardListener), delete this.keyboardListener, this.clearCurrentStep()
        }), MinimalDialogue.extend({
            ctor: function () {
                this._super({
                    items: this.listItems()
                }),
                    cleverapps.scenes.getRunningScene().addChild(this), this.display(), this.setPositionRound(cleverapps.styles.ShopUserGoldView)
            },
            listItems: function () {
                var e = [this.createGoldBlock()],
                    t = ShopUserGoldView.ListBoosters();
                return 0 < t.length && e.push(this.createBoostersBlock(t)), e
            },
            createGoldBlock: function () {
                var e = cleverapps.UI.generateOnlyText("YouHaveAmount", cleverapps.styles.FONTS.SHOP_USER_GOLD_TEXT);
                if ("match3" !== cleverapps.config.type || !cleverapps.environment.isGameScene()) return e;
                var t = cleverapps.styles.ShopUserGoldView,
                    s = this.createItem(levels.user.gold, RewardTypes.hard.smallIcon, t.items.gold);
                return new cleverapps.Layout([e, s], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: t.textNode.goldItemsMargin
                })
            },
            createBoostersBlock: function (e) {
                var t = cleverapps.styles.ShopUserGoldView,
                    e = e.map(function (e) {
                        return this.createItem(e.getAmount(), RewardTypes.boosters.smallIcon[e.id], t.items.boosters)
                    }.bind(this));
                return new cleverapps.WrapGridLayout(e, {
                    direction: cleverapps.UI.HORIZONTAL,
                    columns: 3,
                    margin: t.textNode.boostersItemsMargin,
                    align: {
                        x: cleverapps.GridLayout.ALIGN_CENTER
                    }
                })
            },
            createItem: function (e, t, s) {
                var i = cleverapps.styles.ShopUserGoldView,
                    e = cleverapps.UI.generateImageText(cleverapps.formatAmount(e), cleverapps.styles.FONTS.SHOP_USER_GOLD_TEXT),
                    t = new cc.Sprite(t);
                return t.y += s.dy || 0, new cleverapps.Layout([e, t], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: i.items.margin
                })
            },
            getPreferredBundles: function () {
                return ["tile_shop", "prolongation_window"]
            }
        })),
        PersonsLibrary = (ShopUserGoldView.ListBoosters = function () {
            return -1 !== ["differences", "match3"].indexOf(cleverapps.config.type) ? cleverapps.boosters.listAll() : cleverapps.boosters.listBoostersBefore()
        }, ShopUserGoldView.IsAvailable = function () {
            return cleverapps.user.checkAvailable(cleverapps.config.features.includes("boosters_before") && WindowBoostersBefore.AVAILABLE, {
                ignoreProgress: !0
            }) && ShopUserGoldView.ListBoosters().length
        }, cleverapps.styles.ShopUserGoldView = {
            x: {
                align: "center"
            },
            y: {
                align: "bottom",
                dy: 20
            },
            textNode: {
                margin: 10,
                goldItemsMargin: 10,
                boostersItemsMargin: {
                    x: 15,
                    y: 15
                }
            },
            items: {
                margin: 5,
                gold: {
                    dy: 5
                },
                boosters: {
                    dy: 5
                }
            }
        }, {
            hasRole: function (t) {
                return 0 < Object.keys(cleverapps.config.persons).filter(function (e) {
                    return void 0 !== cleverapps.config.persons[e][t]
                }).length
            },
            getPerson: function (e) {
                return cleverapps.styles.PersonsLibrary[e]
            },
            getMinimalJson: function (e) {
                return bundles["person_minimal_" + e] && bundles["person_minimal_" + e].jsons[e + "_minimal_json"]
            },
            initialize: function () {
                var e, s = {};
                for (e in Object.keys(cleverapps.config.persons).forEach(function (t) {
                    Object.keys(cleverapps.config.persons[t]).forEach(function (e) {
                        s[e] = {}, s[e].name = cleverapps.config.persons[t][e], s[e].group = t
                    })
                }), s) cleverapps.styles.PersonsLibrary[e] || (cleverapps.styles.PersonsLibrary[e] = {}), cleverapps.styles.PersonsLibrary[e].name = s[e].name, cleverapps.styles.PersonsLibrary[e].bundle = "persons_" + s[e].group, void 0 === bundles["person_" + e] && console.log(e), cleverapps.styles.PersonsLibrary[e].json = bundles["person_" + e].jsons[e + "_json"],
                    bundles["person_" + e + "_minimal"] && (cleverapps.styles.PersonsLibrary[e].minimalJson = bundles["person_" + e + "_minimal"].jsons[e + "_minimal_json"]);
                var t, i = MethaHelper.listPersons();
                for (t in cleverapps.config.persons || (cleverapps.config.persons = {}), cleverapps.config.persons.meta || (cleverapps.config.persons.meta = {}), i) cleverapps.config.persons.meta[t] = t;
                Object.assign(cleverapps.styles.PersonsLibrary, i)
            }
        }),
        Person = (cleverapps.styles.PersonsLibrary = {}, cleverapps.Spine.extend({
            avoidNode: "Person",
            ctor: function (e) {
                if (e = Person.ParseOptions(e), this.role = e.role, this.person = PersonsLibrary.getPerson(this.role), !this.person) throw "Person is undefined - " + this.role;
                var t;
                this._super(this.person.json), this.setOrientation(e.orientation), !e.skin && this.hasSkin("regular") && (e.skin = "regular"), e.skin && this.hasSkin(e.skin) && this.setSkin(e.skin), this.emotion = e.emotion, this.setAnimation(0, this.emotion, !0), cleverapps.config.debugMode && cleverapps.flags.showPersonSilhouette && (t = "wooden" === cleverapps.config.ui ? 280 : 0,
                    cleverapps.bundleLoader.loadBundle("person_silhouette", {
                        onSuccess: function () {
                            var e = new cc.Sprite(bundles.person_silhouette.frames.silhouette);
                            e.setAnchorPoint2(.5, 0), e.setPositionRound(this.width / 2, t), this.addChild(e)
                        }.bind(this)
                    }))
            },
            setSpeaking: function (e, t) {
                this.hasAnimation("talk") && this.isSpeaking !== e && (this.isSpeaking = e, this.isSpeaking ? (this.setAnimation(0, "talk", !1), this.setCompleteListener(function () {
                    this.setAnimation(0, this.isSpeaking ? "talk" : this.emotion, !1)
                }.bind(this))) : t ? (this.setAnimation(0, this.emotion, !0), this.setCompleteListener()) : this.setCompleteListenerOnce(function () {
                    this.setAnimation(0, this.emotion, !0)
                }.bind(this)))
            },
            setActive: function (e) {
                this.isActive !== e && (this.isActive = e, this.setLocalZOrder(this.isActive ? -1 : -2))
            },
            getRole: function () {
                return this.role
            },
            getOrientation: function () {
                return this.orientation
            },
            setOrientation: function (e) {
                this.orientation = e, "right" === this.orientation ? this.setScaleX(-1) : this.setScaleX(1)
            }
        })),
        RewardGoldView = (Person.ParseOptions = function (e) {
            return (e = "string" == typeof e ? {
                role: e
            } : e).emotion = e.emotion || "idle", e.orientation = e.orientation || "left", e
        }, cleverapps.styles.Person = {
            width: 600,
            height: 800
        }, cc.Node.extend({
            ctor: function () {
                this._super(), this.setAnchorPoint2(), this.createBackground(), this.updateSize(), this.icon = this.createIcon(), this.text = this.createText(), Game.currentGame.on("rewardHard", this.createListener(this.runCollectAnimation.bind(this))), cleverapps.tooltipManager.create(this, {
                    text: "RewardGoldTooltip",
                    position: cleverapps.styles.UI.Tooltip.LOCATION.below
                }), cleverapps.aims.registerTarget("rewardHard", this, {
                    controls: "rewardElementGold",
                    toggle: this.createListener(function (e, t) {
                        this.aimVisible = e, this.toggle(this.controlsVisible, t)
                    }.bind(this)),
                    flyingUnderShadow: !0
                }), this.updatePosition()
            },
            toggle: function (e, t) {
                this.controlsVisible = e, (e = !this.aimVisible && cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? !1 : e) ? this.show && this.show(t) : this.hide && this.hide(t)
            },
            updateSize: function () {
                var e = cleverapps.styles.CloversView;
                this.setContentSize2(e), this.background.setContentSize2(e), this.toggle(this.controlsVisible, !0)
            },
            updatePosition: function () {
                var e = cleverapps.styles.RewardGoldView;
                this.setPositionRound(e), this.icon.setPositionRound(e.icon), this.background.setPositionRound(this.width / 2, this.height / 2), this.text.setPositionRound(e.text)
            },
            createBackground: function () {
                var e = this.background = cleverapps.UI.createScale9Sprite(bundles.reward_element.frames.reward_element_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY);
                return this.addChild(e), e
            },
            createIcon: function () {
                var e = new cleverapps.Spine(bundles.card.jsons.marks_json);
                return e.setAnimation(0, "coin_idle_counter", !0), this.addChild(e), e
            },
            createText: function () {
                var e = cleverapps.UI.generateImageText(Game.currentGame.rewards[GameBase.REWARD_HARD], cleverapps.styles.FONTS.HARD_REWARD_TEXT);
                return this.addChild(e), e
            },
            runCollectAnimation: function () {
                this.stopAllActions(), this.runAction(new cc.Sequence(new cc.PlaySound(bundles.reward_element.urls.reward_gold_effect),
                    new cc.ScaleTo(.15, 1.1), new cc.CallFunc(function () {
                        this.text.setString(Game.currentGame.rewards[GameBase.REWARD_HARD])
                    }.bind(this)), new cc.ScaleTo(.15, 1)))
            }
        })),
        CollectionContainerView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            HARD_REWARD_TEXT: {
                name: "default",
                size: 40
            }
        }), cleverapps.styles.RewardGoldView = {
            width: 150,
            height: 61,
            x: {
                align: "left",
                dx: 60
            },
            y: {
                align: "top",
                dy: -150
            },
            icon: {
                x: 20,
                y: 40
            },
            text: {
                x: {
                    align: "center",
                    dx: 20
                },
                y: {
                    align: "center",
                    dy: 2
                }
            }
        }, cc.Node.extend({
            ctor: function () {
                this._super(), this.updatePosition()
            },
            updatePosition: function () {
                var e = cleverapps.scenes.getRunningScene(),
                    t = [e.comboBarControl && e.comboBarControl.getGlobalBoundingBox(), e.rewardGoldControl && e.rewardGoldControl.getGlobalBoundingBox()].filter(Boolean),
                    t = 2 === t.length ? cc.rectUnion(t[0], t[1]) : t[0];
                this.setPositionRound(e.convertToNodeSpace(cc.p(0, t.y))), this.setContentSize(e.width, t.height)
            }
        })),
        BaseMiniGame = function () {
            cleverapps.EventEmitter.call(this), this.running = !0, this.paused = !1
        },
        MissionIcon = (
            BaseMiniGame.prototype = Object.create(cleverapps.EventEmitter.prototype), (BaseMiniGame.prototype.constructor = BaseMiniGame).prototype.pause = function () {
                this.paused = !0
            }, BaseMiniGame.prototype.resume = function () {
                this.paused = !1, this.trigger("resumed")
            }, BaseMiniGame.prototype.getName = function () {
                return ""
            }, BaseMiniGame.prototype.finish = function (e) {
                e = e || {}, this.running && (this.running = !1, this.trigger("finish", e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MINIGAME_FINISH + "_" + this.getName()), cleverapps.playSession.set(cleverapps.EVENTS.MINIGAME_FINISH + "_" + this.getName(), !0))
            },
            function (e) {
                var t = Missions[e.type].sideBarJson,
                    t = "function" == typeof t ? t(e) : t,
                    s = ["mission" + e.type];
                e.isPassMission() && s.push("battlePass"), e.isSlotMachineMission() && s.push("slotMachineTicket"), SideBarIcon.call(this, {
                    animation: t,
                    targets: s,
                    progressIconJson: Missions[e.type].sideBarProgressIconJson,
                    control: e.name + "MissionIcon",
                    lottery: e.type === Mission.TYPE_PERIODIC_SALE
                }), this.mission = e, this.resetState()
            }),
        MissionWindow = (
            MissionIcon.prototype = Object.create(SideBarIcon.prototype), (MissionIcon.prototype.constructor = MissionIcon).prototype.resetState = function () {
                this.available = MissionManager.hasProperParent(this.mission) && !cleverapps.config.editorMode && this.mission.isAvailable(), this.available && (this.setLocked(!1), this.setAttention(this.isAttentionRequired()), this.mission.isCompleted() ? (this.setLeftTime(0), this.setTitle("Finished")) : (this.setLeftTime(this.mission.getTimeLeft()), this.setTitle(void 0)))
            }, MissionIcon.prototype.getLockedTipData = function () {
                if (Missions[this.mission.type].available) return cleverapps.humanReadableNumber({
                    floatLevel: Missions[this.mission.type].available.level
                })
            }, MissionIcon.prototype.isAttentionRequired = function () {
                return this.mission.isMinigameMission() ? this.mission.canPlayMinigame() : this.mission.isPassMission() ? 0 < this.mission.logic.countAvailableRewards() : this.mission.isSlotMachineMission() ? 0 < this.mission.logic.getTickets() : !(
                    !this.mission.runningCompetition || !this.mission.runningCompetition.hasPlaceChanged()) || this.mission.type === Mission.TYPE_BONUS_WORLD
            }, MissionIcon.prototype.getForce = function () {
                return this.mission.iconForce
            }, MissionIcon.prototype.onPressed = function () {
                cleverapps.meta.display({
                    focus: this.mission.name + "MissionIconClicked",
                    action: function (e) {
                        var t, s;
                        this.mission.isRunning() ? (t = this.mission.getViewClass(), (s = (s = this.mission.getViewConstructor()) ? s(this.mission) : new t(this.mission)) instanceof cleverapps.FixedWidthScene ? cleverapps.scenes.replaceScene(s, e) : cleverapps.meta.onceNoWindowsListener = e) : this.mission.displayCompleted(e)
                    }.bind(this)
                })
            }, Window.extend({
                onWindowLoaded: function (e) {
                    var t = cleverapps.styles.MissionWindow;
                    this.mission = e, this.wasFinished = !this.mission.isRunning(), this.wasFinished && (this.prize = this.mission.getPrize()), this.content = this.createContent(), SceneDecors.add(this.content, cleverapps.skins.getSlot("missionWindowDecors")), this.mission.onChangeResults = this.createListener(
                        function () {
                            var e = this.mission.getResults();
                            this.tableView.updateResults(e), cleverapps.missionManager.table.updateResults(this.mission.type, e)
                        }.bind(this)), this._super({
                            title: {
                                text: "Missions." + e.getName() + ".Title",
                                font: cleverapps.skins.getSlot("missionWindowTitleFont")
                            },
                            name: " missionwindow",
                            content: this.content,
                            button: {
                                width: t.button.width,
                                height: t.button.height,
                                text: this.getButtonText(),
                                type: cleverapps.styles.UI.Button.Images.button_red,
                                onPressed: this.onButtonPressed.bind(this)
                            },
                            help: this.wasFinished ? void 0 : function () {
                                new GuideWindow(MissionRulesOptionsBuilder.build(e))
                            }
                        })
                },
                onButtonPressed: function () {
                    this.close(), this.wasFinished || cleverapps.meta.distract({
                        focus: "MissionPlayButtonPressed",
                        action: function (e) {
                            cleverapps.meta.wantsToPlay(e)
                        }
                    })
                },
                getButtonText: function () {
                    return this.wasFinished ? Messages.get(this.prize ? "ClaimPrize.Button.text" : "OK") : Messages.get("Play").toUpperCase()
                },
                createContent: function () {
                    var e = cleverapps.styles.MissionWindow;
                    this.tableView = this.createTable();
                    var t, s = [
                        this.createTextAndTimer()
                    ];
                    return "match3" === cleverapps.config.type && (t = this.createAnimationBlock(this.tableView.width), s.push(t)), s.push(this.tableView), new cleverapps.Layout(s, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.margin,
                        padding: e.padding
                    })
                },
                createTable: function () {
                    var e = cleverapps.styles.MissionWindow;
                    return cleverapps.missionManager.table.createTableView({
                        id: this.mission.type,
                        data: this.mission.getResults(),
                        dataIcon: MissionWindow.getTableRowIcon(this.mission.type),
                        height: ("match3" === cleverapps.config.type ? e.table.small : e.table).height,
                        rowConstructor: cleverapps.MissionRow,
                        rowOptions: {
                            mission: this.mission
                        }
                    })
                },
                createTextAndTimer: function () {
                    var e, t = [cleverapps.UI.generateOnlyText(this.mission.isRunning() ? "Missions.windowRunning" : "Missions.windowFinished", cleverapps.styles.FONTS.WINDOW_TEXT)];
                    return this.mission.isRunning() && (0 < (e = this.mission.getTimeLeft()) && (e = new cleverapps.CountDown(e, {
                        onFinish: function () {
                            this.onFinishedSound && "function" == typeof this.onFinishedSound && this.onFinishedSound(!0), this.close()
                        }.bind(this)
                    })), e = new cleverapps.CountDownView(e, {
                        font: cleverapps.styles.FONTS.MISSION_WINDOW_COUNTDOWN_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT
                    }), t.push(e)), new cleverapps.Layout(t, {
                        direction: cleverapps.UI.VERTICAL
                    })
                },
                createAnimationBlock: function (e) {
                    var t = cleverapps.styles.MissionWindow,
                        s = bundles[this.mission.getWindowBundleName()],
                        i = new cc.Scale9Sprite(bundles.table.frames.table_bg_png),
                        e = (i.setContentSize2(e, t.animation.height), "Missions.CommonText"),
                        n = ((n = this.wasFinished ? this.prize ? "Win" : "Lose" : n) && (e = "Missions." + this.mission.getName() + ".AnimationMainText" + n), ["Missions." + this.mission.getName() + ".AnimationMainTextInfo0", "Missions." + this.mission.getName() + ".AnimationMainTextInfo1", e].filter(Messages.has)),
                        e = (this.autoScrollText = new AutoScrollText(n, {
                            width: t.autoScrollText.width,
                            height: t.autoScrollText.height,
                            font: cleverapps.styles.FONTS.WHITE_TEXT
                        }), i.addChild(this.autoScrollText),
                            this.autoScrollText.setPositionRound(t.autoScrollText), new cc.Node),
                        n = (e.setContentSize2(t.animation.width, t.animation.height), e.setAnchorPoint(0, 0), new cleverapps.Spine(s.jsons.json));
                    return n.setAnimation(0, "finish", !0), n.setPositionRound(e.width / 2, e.height / 2), e.addChild(n), i.addChild(e), e.setPositionRound(t.animation), i
                },
                onFinishedSound: function (e) {
                    e && this.mission && !this.mission.finishTimeSoundPlayed && cleverapps.windows.currentWindow() === this && (this.mission.finishTimeSoundPlayed = !0, cleverapps.audio.playSound(bundles.main.urls.mission_finish_effect))
                },
                onShow: function () {
                    this._super(), this.onFinishedSound && "function" == typeof this.onFinishedSound && this.onFinishedSound(this.wasFinished), this.autoScrollText && (this.autoScrollText.setTextByIndex(0), this.autoScrollText.reinitTimer())
                },
                onClose: function () {
                    this.mission.runningCompetition && (this.mission.runningCompetition.updateShownPlace(), this.mission.updateMissionIcon())
                }
            })),
        ReplaceOldMissionWindow = (
            MissionWindow.prototype.listBundles = function (e) {
                var t = [],
                    e = e.getWindowBundleName();
                return e && t.push(e), t
            }, cleverapps.styles.MissionWindow = {
                margin: 20,
                button: {
                    width: 260,
                    height: 100
                },
                table: {
                    height: 725,
                    small: {
                        height: 450
                    }
                },
                animation: {
                    width: 250,
                    height: 247,
                    x: 0,
                    y: 0
                },
                autoScrollText: {
                    width: 400,
                    height: 150,
                    x: {
                        align: "right",
                        dx: -50
                    },
                    y: {
                        align: "center"
                    }
                }
            }, MissionWindow.getTableRowIcon = function (e) {
                var t = cleverapps.skins.getSlot("missionTableRowIcon", {
                    type: e
                });
                if (!t) switch (Mission.GetChildType(e)) {
                    case Mission.TYPE_LETTER:
                        return bundles.tablerow_icons.frames.letter_mission;
                    case Mission.TYPE_COMBO:
                        return bundles.tablerow_icons.frames.combo;
                    case Mission.TYPE_COLLECT_MARK:
                        return bundles.tablerow_icons.frames.collect_mark;
                    case Mission.TYPE_BURN_NEARBY:
                        return bundles.tablerow_icons.frames.burn_nearby;
                    case Mission.TYPE_EXPEDITION_FEAST:
                    case Mission.TYPE_LIVESFEAST:
                        return bundles.tablerow_icons.frames.feast_energy;
                    case Mission.TYPE_SOFTFEAST:
                        return bundles.tablerow_icons.frames.feast_coin;
                    case Mission.TYPE_KRAKENFEAST:
                        return bundles.tablerow_icons.frames.feast_tentacle
                }
                return t
            }, Window.extend({
                onWindowLoaded: function (e) {
                    this.missionData = Missions[e], this._super({
                        title: "ReplaceOldMissionWindow.title",
                        name: "ReplaceOldMissionWindow",
                        content: this.createContent(),
                        buttons: this.createButtons(),
                        closeButton: !1,
                        notCloseByTouchInShadow: !0
                    })
                },
                getPerson: function () {
                    return {
                        role: "king",
                        emotion: "happy"
                    }
                },
                createContent: function () {
                    var e = cleverapps.styles.ReplaceOldMissionWindow,
                        t = new cc.Sprite(bundles.replaceoldmissionwindow.urls.banner),
                        s = ["TravelBook.title." + this.missionData.id, "Missions." + this.missionData.name + ".Title"].find(function (e) {
                            return Messages.has(e)
                        }),
                        s = cleverapps.UI.generateOnlyText("ReplaceOldMissionWindow.text", cleverapps.styles.FONTS.REPLACE_OLD_MISSION_WINDOW_TEXT, {
                            name: Messages.get(s)
                        });
                    return s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.setDimensions(t.width, 0), new cleverapps.Layout([t, s], {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.margin
                    })
                },
                createButtons: function () {
                    var e = cleverapps.styles.ReplaceOldMissionWindow.button;
                    return [new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.button_green,
                        text: "ReplaceOldMissionWindow.restart",
                        onClicked: this.close.bind(this),
                        width: e.width,
                        height: e.height
                    })]
                },
                listBundles: function () {
                    return ["replaceoldmissionwindow"]
                }
            })),
        PeriodicSaleWindow = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            REPLACE_OLD_MISSION_WINDOW_TEXT: {
                name: "nostroke",
                size: 35,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            }
        }), cleverapps.styles.ReplaceOldMissionWindow = {
            margin: 20,
            button: {
                width: 300,
                height: 100
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.logic = e.logic, this._super({
                    name: "PeriodicSaleWindow",
                    noBackground: !0,
                    fireworks: !0,
                    content: this.createContent(),
                    openSound: bundles.periodic_sale.urls.bonussale_showup_effect
                }), this.setLocalZOrder(UpMenuContainer.ZORDER - 1), cleverapps.meta.hideAllControls(), cleverapps.meta.showControlsWhileFocused(["MenuBarGoldItem", "MenuBarCoinsItem", "MenuBarLivesItem"])
            },
            createContent: function () {
                var e = cleverapps.styles.PeriodicSaleWindow;
                return this.content = new cleverapps.Layout(this.createLots(), {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.lotsMargin.x[cleverapps.resolution.mode],
                    padding: e.lotsPadding
                }), this.createBg(), this.createCustomTitle(), this.content
            },
            updatePosition: function () {
                this._super(), this.animatedBg && this.animatedBg.setPositionRound(cleverapps.styles.PeriodicSaleWindow.bg.center)
            },
            createBg: function () {
                var e = cleverapps.styles.PeriodicSaleWindow.bg,
                    t = this.animatedBg = new cleverapps.Spine(bundles.periodic_sale.jsons.bonussale_bg);
                t.setAnimationAndIdleAfter("bg_open", "bg_idle"), t.setPositionRound(e.center), this.addChild(t), ["riddles"].includes(cleverapps.config.ui) && cleverapps.resolution.mode !== cleverapps.WideMode.VERTICAL && ((t = new cleverapps.Spine(bundles.periodic_sale.jsons.bonussale_bg)).setAnimation(0, "left", !0), t.setPositionRound(e.left), this.addChild(t), (t = new cleverapps.Spine(bundles.periodic_sale.jsons.bonussale_bg)).setAnimation(0,
                    "right", !0), t.setPositionRound(e.right), this.addChild(t))
            },
            createCustomTitle: function () {
                var e = cleverapps.styles.PeriodicSaleWindow.content.title,
                    t = new cc.Node,
                    s = (["wooden", "heroes"].includes(cleverapps.config.ui) && (t = cleverapps.UI.createScale9Sprite(bundles.periodic_sale.frames.shop_title, cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(e), cleverapps.UI.generateOnlyText("PeriodicSaleWindow.title", cleverapps.styles.FONTS.BONUSBG_TITLE));
                s.setPositionRound(e.text), s.fitTo(e.text.width, e.text.height), t.setPositionRound(e), t.addChild(s), this.content.addChild(t)
            },
            createLots: function () {
                return this.logic.getLots().map(function (e, t) {
                    e = new BonusSaleLot(e, this.logic);
                    return e.setLocalZOrder(-t), e
                }.bind(this))
            },
            onClose: function () {
                this.logic.isAllSold() && cleverapps.missionManager.remove(this.logic.mission)
            },
            listBundles: function () {
                return ["periodic_sale"]
            }
        })),
        BonusSaleLot = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            BONUSBG_TITLE: {
                size: 100,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE
            },
            PERIODIC_LOT_AMOUNT: {
                name: "default",
                size: 65,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            PERIODIC_LOT_WAS: {
                name: "nostroke",
                size: 35,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            VKDOG_DIALOGUE: {
                name: "nostroke",
                size: 29,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            BONUS_SALE_TIMER_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.styles.PeriodicSaleWindow = {
            lotsMargin: {
                x: [50, 100, 100]
            },
            lotsPadding: {
                top: 140,
                bottom: 0
            },
            content: {
                title: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "top",
                        dy: 70
                    },
                    text: {
                        x: {
                            align: "center",
                            dx: 0
                        },
                        y: {
                            align: "top",
                            dy: -16
                        },
                        width: 440
                    },
                    width: 900,
                    height: 157
                },
                timer: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "top",
                        dy: -122
                    }
                }
            },
            bg: {
                left: {
                    x: {
                        align: "left",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                },
                center: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                },
                right: {
                    x: {
                        align: "right",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                }
            }
        }, cc.Scale9Sprite.extend({
            ctor: function (e, t) {
                this._super(bundles.periodic_sale.frames.tile_bg, cleverapps.UI.getScale9Rect(bundles.periodic_sale.frames.tile_bg, cleverapps.UI.Scale9Rect.TwoPixelXY)), this.setContentSize2(cleverapps.styles.BonusSaleLot), this.lot = e, this.logic = t, this.product = Product.Create(this.lot.product), this.createHeader(), this.createIcon(), this.createButton(), this.clickHandler = cleverapps.UI.onClick(this, this.buyProduct.bind(this)), this.updateState()
            },
            createHeader: function () {
                var e, t = cleverapps.styles.BonusSaleLot.header,
                    s = cleverapps.UI.createScale9Sprite(bundles.periodic_sale.frames.reward_title, cleverapps.UI.Scale9Rect.TwoPixelXY),
                    i = (s.setContentSize2(t.reward.bg), "tropical" === cleverapps.config.ui ? (e = cleverapps.UI.createScale9Sprite(bundles.periodic_sale.frames.bonus_sale_header)).setContentSize(t.bonus) : (i = new cc.Sprite(bundles.periodic_sale.frames.bonus_sale_header), (n = new cc.Sprite(bundles.periodic_sale.frames.bonus_sale_header)).setScaleX(-1), e = new cleverapps.Layout([i, n], {
                        direction: cleverapps.UI.HORIZONTAL
                    })), e.setPositionRound(t.bonus), s.addChild(e, -1), "wooden" === cleverapps.config.ui && ((i = new cc.Sprite(bundles.periodic_sale.frames.bonus_tile_decor1)).setPositionRound(t.bonus.decor1), e.addChild(i, -1), (n = new cc.Sprite(bundles.periodic_sale.frames.bonus_tile_decor2)).setPositionRound(t.bonus.decor2), e.addChild(n, -1)), cleverapps.UI.generateOnlyText(Messages.get("BonusSalePlus"), cleverapps.styles.FONTS.BONUSSALE_PLUS)),
                    n = (i.fitTo(t.bonus.text.width), i.setPositionRound(t.bonus.text), e.addChild(i), new RewardsListComponent(this.lot.reward, {
                        columns: 2,
                        noPrefix: !0,
                        small: !0,
                        font: cleverapps.styles.FONTS.BONUSSALE_BONUS_REWARD,
                        textDirection: cleverapps.UI.HORIZONTAL,
                        margin: t.bonus.reward.margin,
                        textMargin: t.bonus.reward.textMargin
                    })),
                    i = (n.setPositionRound(t.bonus.reward), e.addChild(n), new RewardsListComponent(this.product.reward, {
                        columns: 1,
                        noPrefix: !0,
                        small: !0,
                        font: cleverapps.styles.FONTS.BONUSSALE_PRODUCT_REWARD,
                        textDirection: cleverapps.UI.HORIZONTAL
                    }));
                i.setPositionRound(t.reward), s.addChild(i), s.setPositionRound(t), this.addChild(s)
            },
            createIcon: function () {
                var e = cleverapps.styles.BonusSaleLot.icon,
                    t = new cc.Sprite(bundles.periodic_sale.frames[this.product.icon]),
                    s = new cleverapps.Spine(bundles.periodic_sale.jsons.shop_sparkles_large_json);
                s.setPosition(t.width / 2, t.height / 2), s.setAnimation(0, "animation", !0), t.addChild(s), ["wooden", "riddles", "tropical"].includes(cleverapps.config.ui) && ((s = new cc.Sprite(bundles.periodic_sale.frames.bonus_product_decor1)).setPositionRound(e.decor1), t.addChild(s, -1), (s = new cc.Sprite(bundles.periodic_sale.frames.bonus_product_decor2)).setPositionRound(e.decor2), t.addChild(s, -1)), e.light && ((s = new cc.Sprite(bundles.periodic_sale.frames.bonus_sale_light_bg)).setPositionRound(t.width / 2, t.height / 2), s.setScale(e.light.scale), t.addChild(s, -2)), t.setPositionRound(e), this.addChild(t)
            },
            createButton: function () {
                var e = cleverapps.styles.BonusSaleLot.button,
                    t = this.button = new cleverapps.UI.Button({
                        text: this.product.getCurrentPrice(),
                        onClicked: this.buyProduct.bind(this),
                        width: cleverapps.styles.BonusSaleLot.button.width,
                        height: cleverapps.styles.BonusSaleLot.button.height
                    }),
                    s = new cc.Sprite(bundles.periodic_sale.frames.sale_badge_png),
                    i = cleverapps.UI.generateOnlyText(this.lot.profit + "\nFREE", cleverapps.styles.FONTS.BONUSSALE_BADGE);
                i.fitTo(e.badge.text.width, e.badge.text.height), i.setPositionRound(e.badge.text), i.setRotation(e.badge.text.rotation), s.addChild(i), s.setPositionRound(e.badge), t.addChild(s), Lottery.addIcon(t), t.setPositionRound(e), this.addChild(t)
            },
            buyProduct: function () {
                this.logic.isSoldLot(this.lot.id) || this.product.buy(function (e) {
                    e && (this.updateState(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPENT.PERIODIC_LOT + this.lot.id))
                }.bind(this))
            },
            updateState: function () {
                this.logic.isSoldLot(this.lot.id) && (this.button.disable(), this.button.setString(Messages.get("SoldOut")), this.clickHandler && (this.clickHandler.remove(),
                    this.clickHandler = void 0), this.button.lotteryIcon && this.button.lotteryIcon.removeFromParent())
            }
        })),
        ChainSaleWindow = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            BONUSSALE_PLUS: {
                size: 42,
                color: cleverapps.styles.COLORS.YELLOW,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            BONUSSALE_REWARDS: {
                size: 30,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE
            },
            BONUSSALE_BADGE: {
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                size: 23
            },
            BONUSSALE_PRODUCT_REWARD: {
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.SHOP_STROKE,
                size: 60
            },
            BONUSSALE_BONUS_REWARD: {
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.SHOP_STROKE,
                size: 45
            }
        }), cleverapps.styles.BonusSaleLot = {
            width: 460,
            height: 800,
            header: {
                x: {
                    align: "center",
                    dx: -1
                },
                y: {
                    align: "top",
                    dy: -25
                },
                reward: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 10
                    },
                    bg: {
                        width: 496,
                        height: 120
                    }
                },
                bonus: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom",
                        dy: -187
                    },
                    reward: {
                        x: {
                            align: "center"
                        },
                        y: {
                            align: "center",
                            dy: -20
                        },
                        margin: {
                            y: 0
                        }
                    },
                    text: {
                        width: 300,
                        x: {
                            align: "center",
                            dx: 0
                        },
                        y: {
                            align: "center",
                            dy: 65
                        }
                    }
                }
            },
            icon: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 140
                },
                decor1: {
                    x: {
                        align: "center",
                        dx: -116
                    },
                    y: {
                        align: "bottom",
                        dy: 74
                    }
                },
                decor2: {
                    x: {
                        align: "center",
                        dx: 120
                    },
                    y: {
                        align: "bottom",
                        dy: 74
                    }
                }
            },
            button: {
                width: 300,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 22
                },
                badge: {
                    x: {
                        align: "right",
                        dx: 76
                    },
                    y: {
                        align: "center",
                        dy: 21
                    },
                    text: {
                        x: {
                            align: "center",
                            dx: 15
                        },
                        y: {
                            align: "center",
                            dy: 3
                        },
                        rotation: 32,
                        width: 90,
                        height: 68
                    }
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.logic = e.logic, this._super({
                    title: "ChainSaleWindow.title",
                    name: "ChainSaleWindow",
                    noBackground: !0,
                    content: this.createContent(),
                    openSound: bundles.chain_sale.urls.chain_sale_window_effect
                }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.CHAIN_SALE_OPEN),
                    e.onChangeResults = this.createListener(this.onChangeResults.bind(this))
            },
            createContent: function () {
                var e = cleverapps.styles.ChainSaleWindow,
                    t = this.createTiles(),
                    s = this.timer = this.createTimer(),
                    i = this.footnote = cleverapps.UI.generateTTFText("ChainSaleWindow.Footnote", cleverapps.styles.FONTS.CHAIN_SALE_FOOTNOTE_TEXT);
                return i.setDimensions(e.footnote.width, 0), i.fitTo(void 0, e.footnote.height), i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.content = new cleverapps.Layout([t, i, s], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: cleverapps.styles.ChainSaleWindow.margin
                }), this.createBg(), this.content
            },
            onChangeResults: function () {
                var e, t, s, i, n;
                this.logic.isAllSold() ? this.runAction(new cc.Sequence(new cc.DelayTime(1.5), new cc.CallFunc(function () {
                    this.close()
                }.bind(this)))) : (t = (e = this.logic.currentLots())[ChainSaleLogic.VISIBLE_LOTS - 1], s = this.tiles[0], this.tiles = this.tiles.slice(1), s.hideAnimation(1.1), i = this.getTileSlots(e.length), t && ((n = this.createTile(t)).setPosition(
                    i[ChainSaleLogic.VISIBLE_LOTS - 1]), this.tilesNode.addChild(n), this.tiles.push(n), n.appearAnimation(1.55)), this.tiles.forEach(function (e, t) {
                        var s;
                        e !== n && (s = i[t], e.runAction(new cc.Sequence(new cc.DelayTime(1.3), new cc.MoveTo(.3, s).easing(cc.easeBackIn()), new cc.CallFunc(function () {
                            0 === t && e.open()
                        }))))
                    }))
            },
            getTileSlots: function (e) {
                for (var t = [], s = cleverapps.styles.ChainSaleWindow.tile, i = s.width / 2 + (this.tilesNode.width - (s.width + s.margin) * e - s.margin) / 2, n = s.height / 2, o = 0; o < e; o++) t.push(cc.p(i, n)), i += s.width + s.margin;
                return t
            },
            createTiles: function () {
                for (var e = cleverapps.styles.ChainSaleWindow.tile, t = this.tilesNode = new cc.Node, s = (t.setAnchorPoint(.5, .5), t.setContentSize(3 * e.width + 2 * e.margin, e.height), this.tiles = [], this.logic.currentLots()), i = this.getTileSlots(s.length), n = 0; n < s.length; n++) {
                    var o = this.createTile(s[n]);
                    o.setPositionRound(i[n]), this.tiles.push(o), this.tilesNode.addChild(o)
                }
                return t
            },
            createTile: function (e) {
                return new ChainSaleLot(e, this.logic)
            },
            createTimer: function () {
                var e = cleverapps.styles.ChainSaleWindow.timer,
                    t = cleverapps.UI.generateTTFText("ChainSaleWindow.FinishTimerText", cleverapps.styles.FONTS.CHAIN_SALE_FOOTNOTE_TEXT),
                    s = (t.setVisible(!1), this.logic.mission.getTimeLeft()),
                    s = (0 < s && (s = new cleverapps.CountDown(s, {
                        onFinish: this.createListener(function () {
                            t.setVisible(!0), this.countdown.setVisible(!1)
                        }.bind(this))
                    })), this.countdown = new cleverapps.CountDownView(s, {
                        timerPosition: e.text,
                        font: cleverapps.styles.FONTS.CHAIN_SALE_TIMER_TEXT,
                        icon: bundles.big_timer.frames.big_timer_png,
                        background: {
                            frame: bundles.big_timer.frames.big_timer_bg_png,
                            width: e.width,
                            height: e.height
                        }
                    })),
                    i = new cc.Node;
                return i.setContentSize2(s.getContentSize()), i.setAnchorPoint2(), i.addChild(s), s.setPositionRound(i.width / 2, i.height / 2), i.addChild(t), t.setPositionRound(i.width / 2, i.height / 2), i.setPositionRound(e), i
            },
            createBg: function () {
                var e = cleverapps.styles.ChainSaleWindow.bg,
                    t = new cleverapps.Spine(bundles.chain_sale.jsons.chain_sale_bg_json);
                t.setAnimationAndIdleAfter("open", "idle"), t.setPositionRound(e), t.setLocalZOrder(-1), this.content.addChild(t)
            },
            onShow: function () {
                for (var e = this.tiles.length - 1; 0 <= e; e--) this.tiles[e].appearAnimation(.65 + .2 * e * .5);
                this.windowTitle.setVisible(!1), this.windowTitle.setScale(.2, 1), this.windowTitle.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.Show, new cc.ScaleTo(.6, 1, 1).easing(cc.easeElasticOut(.6)))), [this.timer, this.footnote].forEach(function (e) {
                    e.setOpacity(0), e.setVisible(!1), e.runAction(new cc.Sequence(new cc.DelayTime(.95), new cc.Show, new cc.FadeIn(.15)))
                }), this._super()
            },
            beforeCloseAnimation: function (e) {
                this.closeButton instanceof BandButton && this.closeButton.hide(), [this.timer, this.footnote, this.windowTitle].forEach(function (e) {
                    e.runAction(new cc.Sequence(new cc.FadeOut(.15)))
                });
                e = cleverapps.wait(this.tiles.length, e);
                for (var t = this.tiles.length - 1; 0 <= t; t--) this.tiles[t].runAction(new cc.Sequence(new cc.DelayTime(.075 * t * .5), new cc.Spawn(new cc.ScaleTo(.3, 0).easing(cc.easeBackIn()), new cc.Sequence(new cc.DelayTime(.2),
                    new cc.FadeTo(.1, .3))), new cc.CallFunc(e)))
            },
            listBundles: function () {
                return ["chain_sale"]
            }
        })),
        ChainSaleLot = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CHAIN_SALE_FOOTNOTE_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE
            },
            CHAIN_SALE_TIMER_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.styles.ChainSaleWindow = {
            margin: 20,
            timer: {
                text: {
                    x: {
                        align: "center",
                        dx: -3
                    },
                    y: {
                        align: "center",
                        dy: 2
                    }
                },
                width: 250,
                height: 67,
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "top",
                    dy: -122
                }
            },
            bg: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            tile: {
                width: 480,
                height: 700,
                margin: 10
            },
            tiles: {
                width: 1430,
                height: 700
            },
            footnote: {
                width: 1400,
                height: 60
            }
        }, cc.Scale9Sprite.extend({
            ctor: function (e, t) {
                this.stage = e;
                t = (this.logic = t).getProduct(e), t && (this.product = Product.Create(t)), this.logic.isOpened(this.stage) && this.open(!0),
                    t = this.product ? bundles.chain_sale.frames.paid_tile_bg : bundles.chain_sale.frames.free_tile_bg;
                this._super(t, cleverapps.UI.getScale9Rect(t, {
                    x: .5,
                    y: .3
                })), this.setContentSize2(cleverapps.styles.ChainSaleLot), this.setCascadeOpacityEnabledRecursively(!0), this.createReward(), this.createButton(), this.setVisible(!1), this.logic.isLast(e) || this.createArrow()
            },
            createArrow: function () {
                var e = this.arrow = new cc.Sprite(bundles.chain_sale.frames.arrow_png);
                e.setPositionRound(cleverapps.styles.ChainSaleLot.arrow), this.addChild(e)
            },
            open: function (e) {
                this.opened = !0, cleverapps.UI.onClick(this, this.buyProduct.bind(this)), e || ((e = new cleverapps.Spine(bundles.chain_sale.jsons.button_light_json)).setAnimation(0, "animation", !1), e.setPositionRound(cleverapps.styles.ChainSaleLot.button), e.setCompleteListenerRemove(), this.addChild(e, 1), this.lock.replaceParentSamePlace(this, {
                    keepScale: !0
                }), this.lock.setLocalZOrder(10), this.lock.setAnimation(0, "open", !1), this.lock.setCompleteListenerRemove(), this.runAction(
                    new cc.Sequence(new cc.DelayTime(.1), new cc.CallFunc(function () {
                        this.createButton()
                    }.bind(this)))))
            },
            createReward: function () {
                var e = cleverapps.styles.ChainSaleLot.reward,
                    t = this.rewardComponent = new RewardsListComponent(this.logic.getReward(this.stage), {
                        columns: 2,
                        font: cleverapps.styles.FONTS.CHAIN_SALE_REWARD,
                        textDirection: cleverapps.UI.VERTICAL,
                        margin: e.margin,
                        textMargin: -5,
                        icons: {
                            soft: bundles.chain_sale.frames.coins_png
                        }
                    });
                t.setPositionRound(e), t.setCascadeOpacityEnabledRecursively(!0), this.addChild(t)
            },
            createButton: function () {
                this.button && this.button.removeFromParent(!0);
                var e = cleverapps.styles.ChainSaleLot.button,
                    t = this.product ? this.product.getCurrentPrice() : "FREE",
                    t = new TextWithIcon(t, {
                        font: cleverapps.styles.FONTS.BUTTON_BOOSTER
                    }),
                    t = (this.opened || (s = this.lock = new cleverapps.Spine(bundles.chain_sale.jsons.lock_json)).setAnimation(0, "idle", !1), new cleverapps.Layout([t, s], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: e.margin
                    })),
                    s = this.button = new cleverapps.UI.Button({
                        content: t,
                        type: this.opened ? {
                            button_png: bundles.chain_sale.frames.yellow_button,
                            button_on_png: bundles.chain_sale.frames.yellow_button_on,
                            button_off_png: bundles.buttons.frames.button_disabled_png
                        } : void 0,
                        onClicked: this.buyProduct.bind(this),
                        width: e.width,
                        height: e.height
                    });
                s.setPositionRound(e), s.setCascadeOpacityEnabledRecursively(!0), this.addChild(s)
            },
            buyProduct: function () {
                var t;
                this.opened && !this.logic.isSold(this.stage) && (t = function () {
                    var t;
                    this.logic.lotBought(), this.isRunning() ? (this.rewardComponent.receiveRewards(), this.onBuyAnimation()) : (t = this.logic.getReward(this.stage), cleverapps.meta.display({
                        focus: "chainSaleRewardWindow",
                        action: function (e) {
                            new RewardWindow(t), cleverapps.meta.onceNoWindowsListener = e
                        }
                    }))
                }.bind(this), this.product ? this.product.buy(function (e) {
                    e && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPENT.CHAIN_LOT + this.stage), t())
                }.bind(this), {
                    noRewardWindow: !0
                }) : t())
            },
            hideAnimation: function (e) {
                this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.ScaleTo(.25, 1.3).easing(
                    cc.easeOut(2)), new cc.Spawn(new cc.ScaleTo(.25, .15).easing(cc.easeIn(2)), new cc.Sequence(new cc.DelayTime(.1), new cc.FadeTo(.2, .3), new cc.Hide))))
            },
            appearAnimation: function (e) {
                this.setScale(.4), this.setOpacity(.3), this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.Show, new cc.Spawn(new cc.ScaleTo(.4, 1).easing(cc.easeBackOut()), new cc.FadeIn(.15))))
            },
            onBuyAnimation: function () {
                this.rewardComponent.receiveRewardsAnimation();
                var e = new cleverapps.Spine(bundles.chain_sale.jsons.checkmark_json);
                e.setAnimation(0, "open", !1), e.setPositionRound(cleverapps.styles.ChainSaleLot.checkmark), this.addChild(e), cleverapps.audio.playSound(bundles.chain_sale.urls.chain_sale_open_effect), this.button.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.3).easing(cc.easeOut(2)), new cc.Spawn(new cc.ScaleTo(.2, .3).easing(cc.easeIn(2)), new cc.Sequence(new cc.DelayTime(.1), new cc.FadeTo(.1, .3), new cc.Hide))))
            }
        })),
        MissionRulesOptionsBuilder = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CHAIN_SALE_REWARD: {
                name: "nostroke",
                size: 45,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            }
        }), cleverapps.styles.ChainSaleLot = {
            width: 450,
            height: 700,
            reward: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 50
                },
                margin: {
                    x: 10,
                    y: -5
                }
            },
            button: {
                width: 250,
                height: 90,
                margin: 5,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 48
                }
            },
            checkmark: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 40
                }
            },
            arrow: {
                x: {
                    align: "right",
                    dx: 45
                },
                y: {
                    align: "center"
                }
            }
        }, {
            build: function (e) {
                return {
                    name: e.getName() + "GuideWindow",
                    stagesContent: function () {
                        var e = [1, 2, 3].map(function (e) {
                            return bundles[this.bundleName].jsons["rules_stages_" + e] || bundles[this.bundleName].jsons.rules_json
                        }, this);
                        return this.createSpineStages(e)
                    }
                }
            }
        }),
        MissionAnimationView = cc.Node.extend({
            ctor: function (e) {
                this._super(), this.usePool = !0;
                var t = this.clover = new cc.Sprite(this.getIcon(e));
                t.setScale(cleverapps.styles.MissionAnimationView.scale), this.addChild(t), this.setLocalZOrder(100), this.setCascadeOpacityEnabled(!0), this.initialize(e)
            },
            initialize: function (e) {
                this.getFieldAlgorithm()(this, e)
            },
            reuse: function (e) {
                this.stopListeners = !1, this.initialize(e)
            },
            remove: function () {
                this.usePool ? cc.pool.putInPool(this) : this.unuse()
            },
            unuse: function () {
                this.removeFromParent()
            }
        }),
        MissionAnimationCloverView = MissionAnimationView.extend({
            getIcon: function () {
                return bundles.tournament_icon.frames.fly_clover_png
            },
            getFieldAlgorithm: function () {
                return MissionAnimationView.SimpleFlyAlgorithm
            }
        }),
        MissionAnimationRoseView = MissionAnimationView.extend({
            getIcon: function (e) {
                return e.icon || cleverapps.skins.getSlot("missionMarkIcon", {
                    type: Mission.TYPE_COLLECT_MARK
                })
            },
            getFieldAlgorithm: function () {
                return MissionAnimationView.flyToAlgorithm
            },
            reuse: function (e) {
                this._super(e), this.clover.setSpriteFrame(this.getIcon(e))
            }
        }),
        MissionAnimationTulpanView = MissionAnimationView.extend({
            getIcon: function () {
                return cleverapps.skins.getSlot("missionIcon", {
                    type: Mission.TYPE_BURN_NEARBY
                })
            },
            getFieldAlgorithm: function () {
                return MissionAnimationView.flyToAlgorithm
            }
        }),
        CloversView = (MissionAnimationView.flyToAlgorithm = function (e, t) {
            var s = cleverapps.styles.MissionAnimationView,
                i = s.upY,
                n = t.beginPos,
                o = t.targetPos,
                a = (e.setPosition(n), n.y += i, e.setScale(t.beginScale), e.setOpacity(255), cc.p(o.x, o.y + s.flyTo.second.y)),
                a = [cc.p((n.x + a.x) / 2, (n.y + a.y) / 2 + s.flyTo.first.y), a, o],
                r = Math.abs(o.x - n.x),
                o = Math.abs(o.y - n.y) + s.flyTo.first.y + s.flyTo.second.y,
                n = Math.sqrt(r * r + o * o);
            n /= s.flySpeed, t.targetScale || (t.targetScale = t.beginScale), t.finalScale || (t.finalScale = t.targetScale), e.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.3, t.targetScale), new cc.MoveBy(.3, cc.p(0, i))), new cc.Spawn(new cc.ScaleTo(n, t.finalScale), new cc.BezierTo(n, a).easing(cc.easeIn(1))), new cc.CallFunc(function () {
                cleverapps.audio.playSound(bundles.game.urls.cell_collect_effect, {
                    throttle: 20
                }), e.remove(), t.callback && t.callback()
            })))
        }, MissionAnimationView.SimpleFlyAlgorithm = function (e, t) {
            var s = t.beginPos,
                i = (e.setPosition(s), e.setScale(0), e.setOpacity(255), cleverapps.styles.MissionAnimationView.bezierLength),
                n = Math.random() * i,
                o = (n < i / 2 && (n -= i), cc.p(s.x + n, s.y - 2 * i)),
                a = cc.p(o.x, o.y + i),
                s = [cc.p(s.x, s.y + i * (1.5 + .5 * Math.random())), a, o],
                i = .2;
            3 < i * t.amount && (i = 3 / t.amount), e.runAction(new cc.Sequence(new cc.DelayTime(t.id * i), new cc.CallFunc(function () {
                cleverapps.audio.playSound(bundles.game.urls.boom_effect, {
                    throttle: 20
                })
            }), new cc.Spawn(new cc.ScaleTo(.3, .8), new cc.BezierTo(2, s), new cc.RotateBy(2, n < 0 ? -360 : 360), new cc.Sequence(new cc.DelayTime(1.5), new cc.FadeOut(.5))), new cc.CallFunc(function () {
                e.remove()
            })))
        }, MissionAnimationCloverView.factory = function (e) {
            return cc.pool.hasObject(MissionAnimationCloverView) ? cc.pool.getFromPool(MissionAnimationCloverView, e) : new MissionAnimationCloverView(e)
        }, MissionAnimationRoseView.factory = function (e) {
            return cc.pool.hasObject(MissionAnimationRoseView) ? cc.pool.getFromPool(MissionAnimationRoseView, e) : new MissionAnimationRoseView(e)
        }, MissionAnimationTulpanView.factory = function (e) {
            return cc.pool.hasObject(MissionAnimationTulpanView) ? cc.pool.getFromPool(MissionAnimationTulpanView, e) : new MissionAnimationTulpanView(e)
        },
            MissionAnimationView.show = function (e, t, s) {
                s.amount || (s.amount = 1);
                for (var i = 0; i < s.amount; i++) switch (s.id = i, e) {
                    case Mission.TYPE_COMBO:
                        t.addChild(MissionAnimationCloverView.factory(s));
                        break;
                    case Mission.TYPE_COLLECT_MARK:
                        t.addChild(MissionAnimationRoseView.factory(s));
                        break;
                    case Mission.TYPE_BURN_NEARBY:
                        t.addChild(MissionAnimationTulpanView.factory(s))
                }
            }, cleverapps.styles.MissionAnimationView = {
                bezierLength: 250,
                flySpeed: 1500,
                upY: 100,
                flyTo: {
                    first: {
                        y: 300
                    },
                    second: {
                        y: 300
                    }
                },
                scale: 1
            }, cc.Node.extend({
                avoidView: "CloversView",
                ctor: function () {
                    this._super(), this.mission = Game.currentGame.secondaryMission, this.setLocalZOrder(10), this.withinInfoPanel = "match3" === cleverapps.config.type && "adventure" !== cleverapps.config.name, this.setAnchorPoint2(), this.createBackground(), this.updateSize(), this.icon = this.createIcon(), this.text = this.createText(), Game.currentGame.on("rewardClover", this.createListener(this.runCollectAnimation.bind(this))), Game.currentGame.on("showCloverView", this.createListener(
                        this.onShowUpAnimationStart.bind(this)), this), Game.currentGame.on("updateCloversTarget", this.createListener(function () {
                            this.text.setString(this.getTextString()), this.toggle(this.controlsVisible)
                        }.bind(this))), cleverapps.tooltipManager.create(this, {
                            text: "CloversTooltip",
                            position: "runes" === cleverapps.config.name ? cleverapps.styles.UI.Tooltip.LOCATION.above : cleverapps.styles.UI.Tooltip.LOCATION.below,
                            control: "cloversViewTooltip"
                        }), cleverapps.aims.registerTarget("mission_billet" + this.mission.type, this, {
                            toggle: this.createListener(function (e, t) {
                                this.aimVisible = e, this.toggle(cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? e : this.controlsVisible, t)
                            }.bind(this)),
                            flyingUnderShadow: !0
                        }), this.updatePosition()
                },
                onShowUpAnimationStart: function (e) {
                    e ? this.setVisible(!0) : (this.isStartAnimationInProgress = !0, "runes" === cleverapps.config.name && (this.baseScale = this.getScale(), this.setVisible(!0), this.setScale(0), e = cleverapps.once(function () {
                        this.isStartAnimationInProgress && this.runAction(
                            new cc.Sequence(new cc.DelayTime(.5), new cc.CallFunc(function () {
                                this.runAction(new cc.ScaleTo(.3, this.baseScale)), this.isStartAnimationInProgress = !1
                            }.bind(this))))
                    }.bind(this)), this.runAction(new cc.Sequence(new cc.DelayTime(2.5), new cc.CallFunc(e)))))
                },
                completeAnimationOnResize: function () {
                    this.isStartAnimationInProgress && (this.setScale(void 0 === this.baseScale ? 1 : this.baseScale), this.isStartAnimationInProgress = !1)
                },
                toggle: function (e, t) {
                    this.controlsVisible = e, (e = !this.aimVisible && ("tile3" === cleverapps.config.type && 0 === Game.currentGame.clovers || "match3" !== cleverapps.config.type && cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL) ? !1 : e) ? this.show && this.show(t) : this.hide && this.hide(t)
                },
                updateSize: function () {
                    var e = cleverapps.styles.CloversView;
                    this.setContentSize2(e), this.background.setContentSize2(e), this.toggle(this.controlsVisible, !0)
                },
                updatePosition: function () {
                    var e = cleverapps.styles.CloversView,
                        t = e.positions[cleverapps.resolution.mode];
                    this.setPositionRound(t),
                        this.icon.setPositionRound(e.icon), this.background.setPositionRound(this.width / 2, this.height / 2), this.text.setPositionRound(e.text)
                },
                createBackground: function () {
                    var e = this.background = cleverapps.UI.createScale9Sprite(bundles.reward_element.frames.reward_element_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY);
                    return this.addChild(e), e
                },
                createIcon: function () {
                    var e = cleverapps.styles.CloversView,
                        t = new cc.Sprite(this.mission.getIcon());
                    return this.addChild(t), cleverapps.UI.fitToBox(t, e.icon), t.baseScale = t.scale, t
                },
                createText: function () {
                    var e = cleverapps.styles.CloversView,
                        t = this.text = cleverapps.UI.generateImageText(this.getTextString(), cleverapps.styles.FONTS.CLOVERS_TEXT);
                    return this.addChild(t), t.setPositionRound(e.text), t
                },
                getTextString: function () {
                    var e = Game.currentGame.rewards[GameBase.REWARD_SECONDARY];
                    return ["differences"].includes(cleverapps.config.type) && 0 < Game.currentGame.clovers.length ? e + "/" + Game.currentGame.clovers.length : ["tile3"].includes(cleverapps.config.type) && 0 < Game.currentGame.clovers ? e + "/" + Game.currentGame.clovers : e
                },
                runCollectAnimation: function () {
                    this.stopAllActions(), this.mission.type !== Mission.TYPE_COMBO || "heroes" === cleverapps.config.name ? this.runAction(new cc.Sequence(new cc.PlaySound(bundles.game.urls.tournament_element_collected), new cc.ScaleTo(.15, 1.1), new cc.CallFunc(function () {
                        this.text.setString(this.getTextString())
                    }.bind(this)), new cc.ScaleTo(.15, 1))) : this.rotateAnimation()
                },
                rotateAnimation: function () {
                    this.text.setString(this.getTextString()), 0 === this.icon.getRotation() && (this.icon.setScale(this.icon.baseScale), this.icon.runAction(new cc.Sequence(new cc.Spawn(new cc.Sequence(new cc.ScaleTo(.2, 1.2 * this.icon.baseScale), new cc.ScaleTo(.2, this.icon.baseScale)), new cc.RotateBy(.4, 360)), new cc.CallFunc(function () {
                        this.icon.setRotation(0)
                    }, this)))), this.text.stopAllActions(), this.text.runAction(new cc.Sequence(new cc.PlaySound(bundles.main.urls.tournament_element_collected), new cc.ScaleTo(.2, 1.5), new cc.ScaleTo(.2, 1)))
                }
            })),
        MainScene = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CLOVERS_TEXT: {
                name: "default",
                size: 40
            }
        }), cleverapps.styles.CloversView = {
            width: 150,
            height: 61,
            positions: [{
                x: {
                    align: "left",
                    dx: 40
                },
                y: {
                    align: "top",
                    dy: -150
                }
            }, {
                x: {
                    align: "left",
                    dx: 236
                },
                y: {
                    align: "top",
                    dy: -150
                }
            }, {
                x: {
                    align: "left",
                    dx: 250
                },
                y: {
                    align: "top",
                    dy: -150
                }
            }],
            icon: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                },
                width: 100,
                height: 100
            },
            text: {
                x: {
                    align: "center",
                    dx: 20
                },
                y: {
                    align: "center"
                }
            }
        }, cleverapps.FixedWidthScene.extend({
            onSceneLoaded: function () {
                this._super(cleverapps.Environment.SCENE_MAIN), cleverapps.flyingAd && this.addChild(new FlyingAdView), cleverapps.environment.levelNo = levels.user.level, cleverapps.environment.episodeNo = levels.user.episode, cleverapps.placements.run(Placements.INTERMEDIATE)
            },
            _closeAction: function () {
                return cleverapps.administrator && AdministratorScene.IsAvailable() ? (cleverapps.flags.norest = !1, cleverapps.DataLoader.setAlerted(!1), cleverapps.DataLoader.setEnabled(!0), cleverapps.setRestDummies(!1), void AdministratorScene.open()) : cleverapps.config.wysiwygMode ? (cleverapps.config.editorMode = !1, void WysiwygScene.open(cleverapps.wysiwyg)) : void (cleverapps.platform.closeApplication && cleverapps.meta.display({
                    focus: "ConfirmExitWindow",
                    action: function (e) {
                        new ConfirmExitWindow({
                            action: cleverapps.platform.closeApplication.bind(cleverapps.platform)
                        }), cleverapps.meta.onceNoWindowsListener = e
                    }
                }))
            }
        })),
        MethaHelper = {
            start: function (e, t) {
                t.episode.isComingSoon() ? e() : !LevelStartWindow.isAvailable(t.episodeNo, t.levelNo) || cleverapps.config.features.includes("boosters_before") && !WindowBoostersBefore.isAvailable() ? t.play(e) : (cleverapps.meta.showControlsWhileFocused("MenuBarGoldItem"), t.building ? new BuildingStartWindow({
                    building: t.building,
                    level: t
                }) : new LevelStartWindow({
                    level: t
                }), cleverapps.meta.onceNoWindowsListener = e)
            },
            getCurrentLevel: function (e) {
                var t = void 0,
                    t = (cleverapps.meta.getType() === Metha.FARM ? (t = e.label, cleverapps.playButton.disableIncLevel(), (void 0 === t || t.episodeNo >= cleverapps.episodes.getAmountEpisodes()) && (
                        t = cleverapps.farm.chooseNextLevel(e)), e.label !== t && (e.label = t, cleverapps.farm.save()), cleverapps.playButton.enableIncLevel()) : t = cleverapps.isKnockoutGame() ? cleverapps.meta.getMainObject().knockoutGame.getNextLevel() : cleverapps.user.getCurrentLevel(), MethaHelper.getLevel(t.episodeNo, t.levelNo));
                return cleverapps.meta.getType() === Metha.FARM && (t.building = e), t
            },
            getLevel: function (e, t) {
                e = cleverapps.meta.getType() === Metha.HOSE ? new HoseEpisode(e) : new Episode(e, t);
                return e.getLevel(t)
            },
            prepare: function () {
                cleverapps.config.debugMode && cleverapps.meta.getType() === Metha.FARM && MethaHelper.validateDialogues(), cleverapps.meta.getType() === Metha.FARM && MethaHelper.validateQuestItems()
            },
            listPersons: function () {
                var e = {};
                if (cleverapps.meta.getType() === Metha.FARM)
                    for (var t = 0; t < 100; t++) {
                        var s = "person" + t;
                        if (!bundles[s]) break;
                        e[s] = {
                            name: s,
                            json: bundles[s].jsons[s],
                            offsetY: 0
                        }
                    }
                return e
            },
            validateQuestItems: function () {
                MethaHelper.readConfig().questItems.forEach(function (e, t) {
                    if (!bundles.farm_items.frames["item" + t]) throw "No questItem resource - " + e
                })
            },
            readConfig: function () {
                return cleverapps.meta.getType() === Metha.FARM ? cleverapps.farm.readConfig() : cleverapps.meta.getType() === Metha.HOMEFIX ? cleverapps.home.readConfig() : void 0
            },
            validateDialogues: function () {
                cleverapps.values(this.readConfig().dialogues).forEach(function (e) {
                    e.forEach(function (e) {
                        e = "string" === e.person && e.person.split("_")[0];
                        if (e && !PersonsLibrary.hasRole(e)) throw "No person: " + e
                    })
                })
            },
            allIsComplete: function (e) {
                cleverapps.meta.compound(e, [function (e) {
                    var t = MethaHelper.createDialogue("Final");
                    t.on("afterClose", e), new DialogueView(t)
                }, function (e) {
                    new AllDoneWindow, cleverapps.meta.onceNoWindowsListener = e
                }])
            },
            createDialogue: function (e) {
                var s, i, e = this.readConfig().dialogues[e];
                if (e) return s = [], i = [], e.forEach(function (e) {
                    var t = {
                        text: "" + e.text,
                        person: e.person
                    };
                    e.person2 && (t.person2 = e.person2), i.push(t), cleverapps.meta.getType() === Metha.FARM && (s.push(e.person.role), e.person2 && s.push(e.person2.role))
                }), new Dialogue(i, {
                    autoClose: !0,
                    showUp: !0,
                    bundles: s
                })
            }
        },
        PlayButtonView = cc.Node.extend({
            avoidNode: "PlayButtonView",
            ctor: function (e) {
                this._super(), this.options = e || {}, this.isSmall = this.options.isSmall, this.noLevelNumber = "knockout" === cleverapps.config.regime || cleverapps.meta.getType() === Metha.SHORTMETA || cleverapps.meta.getType() === Metha.HOSE && cleverapps.user.isPassedAll() || "blocks" === cleverapps.config.type, this.setAnchorPoint2(), this.setContentSize2(cleverapps.styles.PlayButtonView), this.updatePosition(), new HidingNode(this, cleverapps.UI.VERTICAL), cleverapps.meta.registerControl("play_button", this), cleverapps.playButton.on("update", this.update.bind(this), this), cleverapps.playButton.on("animatePassLevel", this.animatePassLevel.bind(this), this), this.update()
            },
            updatePosition: function () {
                this.setPositionRound(this.calcPosition())
            },
            update: function () {
                this.styling = this.getStyling(), this.createButton(), cleverapps.styles.PlayButtonView.button || (cleverapps.UI.applyHover(this), cleverapps.UI.onClick(this, function () {
                    cleverapps.playButton.onClick()
                }))
            },
            calcPosition: function () {
                var e = cleverapps.styles.PlayButtonView;
                return e = e.positions ? e.positions[cleverapps.resolution.mode] : e
            },
            animatePassLevel: function () {
                var e;
                this.button && this.button.stopAllActions(), this.show(!0), this.isSmall || this.noLevelNumber || (e = new cleverapps.Spine(bundles.main.jsons.play_button_transition_json), this.button.addChild(e), e.setPositionRound(this.button.width / 2, this.button.height / 2), e.runAction(new cc.Sequence(new cc.DelayTime(.6), new cc.CallFunc(function () {
                    e.setAnimation(0, "animation", !1), e.setCompleteListenerRemove()
                })))), this.button.runAction(new cc.Sequence(this.listAnimationActions()))
            },
            listAnimationActions: function () {
                if (this.noLevelNumber) return [new cc.DelayTime(1.1), new cc.CallFunc(this.updateTextAndButton.bind(this))];
                var e = this.scale;
                return [new cc.DelayTime(1.1), new cc.ScaleTo(.15, 1.3 * e), new cc.CallFunc(this.updateTextAndButton.bind(this)), new cc.PlaySound(bundles.main.urls.play_button_effect), new cc.ScaleTo(.2, e)]
            },
            updateTextAndButton: function () {
                this.styling = this.getStyling(), this.button.setString(this.getTextMsg()), this.button.setType(this.styling.type)
            },
            addFinger: function () {
                FingerView.hintClick(this, {
                    delay: 5
                })
            },
            createButton: function () {
                var e, t = cleverapps.styles.PlayButtonView;
                t.button && (this.button && this.button.removeFromParent(), e = this.button = new cleverapps.UI.Button({
                    width: t.width,
                    height: t.height,
                    text: this.getTextMsg(),
                    type: this.styling.type,
                    onClicked: function () {
                        cleverapps.playButton.onClick()
                    }
                }), this.addChild(e), e.setPositionRound(t.button))
            },
            getTextMsg: function () {
                if (!cleverapps.isLevels()) return Messages.getLocalized("Play");
                var e = cleverapps.playButton.getLevelNo(),
                    t = this.getDisplayedLevel(),
                    s = this.noLevelNumber ? "Play" : "PlayButton.text";
                return t.isHard() && !1 !== this.options.hard && (s = "message.hardLevel"), t.isTricky() && (s = "message.trickyLevel"), t.isBonus() && (s = "message.bonusLevel"), this.isSmall && (s = e), Messages.getLocalized(s, {
                    levelNo: e
                })
            },
            getDisplayedLevel: function () {
                return cleverapps.playButton.passedLevel && cleverapps.playButton.previousLevel ? cleverapps.playButton.previousLevel : cleverapps.playButton.currentLevel
            },
            getStyling: function () {
                var e = this.getDisplayedLevel(),
                    t = cleverapps.styles.PlayButtonView,
                    s = {
                        button_png: bundles.buttons_main.frames.play_button_png,
                        button_on_png: bundles.buttons_main.frames.play_button_on_png
                    };
                return t.button && t.button.SKIP_RESOLUTION && t.button.SKIP_RESOLUTION.padding && (s.SKIP_RESOLUTION = {
                    padding: t.button.SKIP_RESOLUTION.padding
                }), cleverapps.isLevels() && e.isHard() && !["wordsoup"].includes(cleverapps.config.name) && (s = Object.assign(s, {
                    button_png: bundles.buttons.frames.red_button,
                    button_on_png: bundles.buttons.frames.red_button_on
                })), cleverapps.isLevels() && e.isTricky() && !["wordsoup"].includes(cleverapps.config.name) && (s = Object.assign(s, {
                    button_png: bundles.buttons.frames.blue_button_png,
                    button_on_png: bundles.buttons.frames.blue_button_png
                })), {
                    type: s = cleverapps.isLevels() && e.isBonus() && !["wordsoup"].includes(cleverapps.config.name) ? Object.assign(s, {
                        button_png: bundles.buttons.frames.blue_button_png,
                        button_on_png: bundles.buttons.frames.blue_button_png
                    }) : s
                }
            }
        }),
        PlayButton = (cleverapps.styles.PlayButtonView = {
            width: 300,
            height: 100,
            x: {
                align: "center"
            },
            y: {
                align: "bottom",
                dy: 150
            },
            button: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            }
        }, function () {
            cleverapps.EventEmitter.call(this), cleverapps.isLevels() && cleverapps.user.on("incLevel", this.onIncLevel.bind(this)), cleverapps.episodes.onResetListener = this.update.bind(this), this.update()
        }),
        AllDoneWindow = (PlayButton.prototype = Object.create(cleverapps.EventEmitter.prototype), (PlayButton.prototype.constructor = PlayButton).prototype.onIncLevel = function () {
            this.incLevelDisabled || (this.passedLevel = !0, this.update())
        }, PlayButton.prototype.enableIncLevel = function () {
            delete this.incLevelDisabled
        }, PlayButton.prototype.disableIncLevel = function () {
            this.incLevelDisabled = !0
        }, PlayButton.prototype.getLevelNo = function () {
            var e = cleverapps.user.getVirtualDisplayLevel();
            return this.passedLevel && e--, e
        },
            PlayButton.prototype.update = function () {
                var e;
                PlayButton.IsAvailable() && cleverapps.isLevels() && (e = cleverapps.user.getCurrentLevel(), this.currentLevel && this.currentLevel.episodeNo === e.episodeNo && this.currentLevel.levelNo === e.levelNo || (this.currentLevel && (this.previousLevel = this.currentLevel), this.currentLevel = new Episode(e.episodeNo, e.levelNo).getLevel(), this.trigger("update")))
            }, PlayButton.prototype.onClick = function () {
                cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), cleverapps.meta.display({
                    focus: "PlayButton_scene",
                    action: function (e) {
                        cleverapps.meta.wantsToPlay(e)
                    }
                })
            }, PlayButton.prototype.animatePassLevel = function () {
                this.passedLevel = !1, this.trigger("animatePassLevel")
            }, PlayButton.IsAvailable = function () {
                return ![Metha.NONE].includes(cleverapps.meta.getType())
            }, Window.extend({
                onWindowLoaded: function () {
                    this._super({
                        title: "AllDoneWindow.title",
                        name: "alldonewindow",
                        content: this.getContent(),
                        button: {
                            width: cleverapps.styles.AllDoneWindow.button.width,
                            height: cleverapps.styles.AllDoneWindow.button.height,
                            text: "Play",
                            onPressed: function () {
                                this.close(), cleverapps.meta.distract({
                                    focus: "PlayButton",
                                    action: function (e) {
                                        cleverapps.meta.wantsToPlay(e)
                                    }
                                })
                            }.bind(this)
                        }
                    }), AllDoneWindow.showed = !0
                },
                getPerson: function () {
                    return {
                        role: "hero",
                        emotion: "happy"
                    }
                },
                getContent: function () {
                    return this.getText()
                },
                getText: function () {
                    var e = cleverapps.styles.AllDoneWindow,
                        t = cleverapps.UI.generateOnlyText("AllDoneWindow.text", cleverapps.styles.FONTS.WINDOW_TEXT);
                    return t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(e.text.width, 0), t.fitTo(void 0, e.text.height), t
                }
            })),
        WorldMap = (cleverapps.styles.AllDoneWindow = {
            text: {
                width: 550,
                height: 400
            },
            button: {
                width: 300,
                height: 100
            }
        }, MapScrollView.extend({
            ctor: function () {
                var e, t, s;
                this._super(), this.setContentSize2(cleverapps.UI.getBgSize()), this.setAnchorPoint2(), t = {
                    width: (e = cc.loader.getRes(bundles.world_map.jsons.mapData)).map.width * resolutionScale,
                    height: e.map.height * resolutionScale
                }, this.setContainerSize(t),
                    bundles.world_map.urls.map && ((s = new cc.Sprite(bundles.world_map.urls.map)).setScale(t.width / s.width), s.setPositionRound(this.innerWidth / 2, this.innerHeight / 2), this.container.addChild(s)), this.addBgs(e), this.buildingViews = {}, this.setZoom(cleverapps.styles.WorldMap.zoom.unfocused), this.animateNewTask = function () { }, this.updatePosition()
            },
            updateSize: function () {
                this.setContentSize2(cleverapps.UI.getBgSize()), this.setZoom(this.zoom), this.updateChildren()
            },
            updatePosition: function () {
                var e = cleverapps.scenes.getRunningScene();
                this.setPositionRound(e.convertToNodeSpace(cc.p(this.width * this.scale / 2, this.height * this.scale / 2)))
            },
            addBgs: function (e) {
                for (var t, s, i, n, o = 0; o <= 30; o++) cleverapps.meta.getType() === Metha.FARM ? t = bundles.metha_top_layer_0.jsons["map_json" + o] : cleverapps.meta.getType() === Metha.HOMEFIX && (t = bundles.world_map.jsons["map_json" + o] || bundles.world_map_nodither.jsons["map_json" + o]), t && ((s = new cleverapps.Spine(t, 1)).setAnimation(0, "animation", !0), e["map_json" + o] ? (i = e["map_json" + o], (
                    n = new cc.Node).setAnchorPoint2(), n.setContentSize2(i.width * resolutionScale, i.height * resolutionScale), s.setPosition(n.width / 2, n.height / 2), n.addChild(s), n.setPosition(this.innerWidth / 2 + i.x * resolutionScale, this.innerHeight / 2 + i.y * resolutionScale), this.container.addChild(n, i.zOrder)) : (s.setPosition(this.innerWidth / 2, this.innerHeight / 2), this.container.addChild(s)))
            },
            highlight: function (e) {
                e.addHighlight()
            },
            unhighlight: function (e) {
                e.removeHighlight()
            },
            onEnter: function () {
                this._super(), cleverapps.config.debugMode && cc.eventManager.addListener({
                    event: cc.EventListener.KEYBOARD,
                    onKeyPressed: function (e) {
                        if (e === cc.KEY.b && !this.bordered)
                            for (var t in this.bordered = !0, this.buildingViews) {
                                this.buildingViews[t].debugBorder();
                                var s = this.buildingViews[t].building.id,
                                    i = this.buildingViews[t].building.amountStages();
                                if (cleverapps.home)
                                    for (var n = 0; n < cleverapps.home.furniture.length; n++)
                                        if (cleverapps.home.furniture[n].id === this.buildingViews[t].building.id) {
                                            s = n;
                                            break
                                        } var o = cleverapps.UI.generateImageText(s,
                                            cleverapps.styles.FONTS.WINDOW_TEXT),
                                            i = cleverapps.UI.generateOnlyText("Stages: " + i, cleverapps.styles.FONTS.TEXT),
                                            o = new cleverapps.Layout([o, i], {
                                                direction: cleverapps.UI.VERTICAL,
                                                margin: 0
                                            });
                                this.buildingViews[t].addChild(o, 10), o.setPositionRound(this.buildingViews[t].width / 2, this.buildingViews[t].height / 2), o.replaceParentSamePlace(this.buildingViews[t].parent), this.buildingViews[t].idView = o
                            }
                    }.bind(this),
                    onKeyReleased: function (e) {
                        if (e === cc.KEY.b)
                            for (var t in this.bordered = !1, this.buildingViews) this.buildingViews[t].cleanupBorder(), this.buildingViews[t].idView.removeFromParent()
                    }.bind(this)
                }, this)
            },
            availableScrollPosition: function (e) {
                var t = this.getContainerSize(),
                    s = t.width - this.width,
                    t = t.height - this.height;
                return 0 < e.x ? e.x = 0 : e.x < -s && (e.x = -s), 0 < e.y ? e.y = 0 : e.y < -t && (e.y = -t), e
            },
            scrollTo: function (e, t, s) {
                var i, n, o;
                e && (t || cleverapps.meta.isFocused() || (console.log("Scroll:", e), cleverapps.meta.debugMessage("Trying to scroll without user focus!")), i = cleverapps.meta.focus,
                    o = this.buildingViews[e.name].getPosition(), o = {
                        x: this.width / 2 - o.x,
                        y: this.height / 2 - o.y
                    }, o = this.availableScrollPosition(o), t ? (this.setContainerPosition({
                        x: o.x,
                        y: o.y
                    }), s && s()) : ((t = this.getContainerPosition()).x -= o.x, t.y -= o.y, t = Math.sqrt(t.x * t.x + t.y * t.y) / 1300, t = Math.min(.7, Math.max(.3, t)), this.container.stopAllActions(), this.container.runAction(new cc.Spawn(new cc.MoveTo(t, o.x, o.y).easing(cc.easeInOut(2.5)), new cc.Repeat(new cc.Sequence(new cc.DelayTime(.025), new cc.CallFunc(this.updateChildren.bind(this))), Math.ceil(t / .025)))), n = new Error, this.runAction(new cc.Sequence(new cc.DelayTime(.45 * t || .5), new cc.CallFunc(function () {
                        cleverapps.meta.isFocused() && cleverapps.meta.focus === i || (console.log("Scroll:", e, i, cleverapps.meta.focus), cleverapps.throwAsync("Trying to scroll without user focus! Focus: " + cleverapps.meta.focus + " StartFocus: " + i, n)), s && s()
                    })))))
            },
            showBuildings: function (s) {
                var i = [];
                s.forEach(function (e, t) {
                    e.isComplete() && e.throwaway || i.push(t)
                }), i.sort(function (e, t) {
                    return s[t].y - s[e].y
                }), i.forEach(function (e) {
                    var e = s[e],
                        t = new BuildingView(e, this);
                    this.buildingViews[e.name] = t, this.container.addChild(t)
                }, this)
            },
            removeBuilding: function (e) {
                var t = this.buildingViews[e.name];
                t && (t.runAction(new cc.RemoveSelf), delete this.buildingViews[e.name])
            },
            removeTarget: function () {
                FingerView.remove(this.finger), this.finger = void 0
            },
            addTarget: function (e) {
                this.removeTarget(), this.finger = FingerView.hintClick(this.buildingViews[e.name])
            },
            findClickedBuilding: function (e) {
                var t, s;
                for (s in this.buildingViews) {
                    var i = this.buildingViews[s];
                    i.building.canTouch() && (!t || t.getLocalZOrder() <= i.getLocalZOrder()) && cc.rectContainsPoint(cc.rect(0, 0, i.width, i.height), i.convertTouchToNodeSpace(e)) && (t = i)
                }
                return t
            },
            onClick: function (e) {
                var t, e = this.findClickedBuilding(e);
                if (e && (cleverapps.debugMode && cleverapps.keyboardController.isPressed(cc.KEY.j))) return void (cleverapps.meta.getType() === Metha.FARM ? (Farm.Reset(), t = Farm.GetBuildingProgress(e.building.id, 0), cleverapps.farm.load(t),
                    cleverapps.farm.save(), cleverapps.refreshScene()) : cleverapps.meta.getType() === Metha.HOMEFIX && HomeTool.set(e.building.id, 0, !1, function () {
                        cleverapps.refreshScene()
                    }));
                e && e.building.onClick()
            }
        })),
        MissionGame = (cleverapps.styles.WorldMap = {
            persons: {},
            zoom: {
                base: 1,
                unfocused: .7,
                minScale: .5
            }
        }, function (e) {
            cleverapps.EventEmitter.call(this), this.running = !0, this.paused = !1, this.mission = e
        }),
        TellWindow = (MissionGame.prototype = Object.create(cleverapps.EventEmitter.prototype), (MissionGame.prototype.constructor = MissionGame).prototype.pause = function () {
            this.paused = !0
        }, MissionGame.prototype.resume = function () {
            this.paused = !1, this.trigger("resumed")
        }, MissionGame.prototype.getName = function () {
            return ""
        }, MissionGame.prototype.finish = function (e) {
            this.running && (0 < this.reward && this.mission.update(this.reward), this.running = !1, this.trigger("finish", e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MINIGAME_FINISH + "_" + this.getName()), cleverapps.playSession.set(cleverapps.EVENTS.MINIGAME_FINISH + "_" + this.getName(), !0))
        }, Window.extend({
            onWindowLoaded: function (e) {
                var t = this.createText(e.text);
                this._super({
                    content: t,
                    name: "tellwindow",
                    title: e.title,
                    fireworks: cleverapps.environment.isBonusWorldScene(),
                    button: {
                        text: e.buttonText || "OK",
                        onPressed: function () {
                            this.close(), e.onPressed && e.onPressed()
                        }.bind(this)
                    }
                })
            },
            getPerson: function () {
                return {
                    role: "hero",
                    emotion: "talk"
                }
            },
            createText: function (e) {
                var t = cleverapps.styles.TellWindow,
                    e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.WINDOW_TEXT);
                return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setDimensions(t.text.width, 0), e.fitTo(void 0, t.text.height), e
            }
        })),
        FriendRequestsWindow = (cleverapps.styles.TellWindow = {
            text: {
                width: 650,
                height: 400
            }
        }, Window.extend({
            onWindowLoaded: function () {
                var e = new cc.Node;
                e.setAnchorPoint2(), this.content = e, this.createViews(), this._super({
                    name: "friendrequestswindow",
                    content: e,
                    noBackground: !0,
                    loginOrInvite: !0
                })
            },
            createViews: function () {
                for (var e = cleverapps.styles.FriendRequestsWindow, t = (this.requestsViews = [], this.requestsIds = [], this.pendingViews = [], this.pendingIds = [], []), s = 0; s < levels.friendRequests.notProcessed.length; s++) {
                    var i = this.createRequestView(levels.friendRequests.notProcessed[s]);
                    i && t.push(i)
                }
                t.forEach(function (e) {
                    this.requestsViews.length < FriendRequestsWindow.MAX_SHOW_REQUESTS ? (this.content.addChild(e), this.requestsViews.push(e), this.requestsIds.push(e.model.getId())) : (this.content.addChild(e), e.setVisible(!1), this.pendingViews.push(e), this.pendingIds.push(e.model.getId()))
                }, this);
                var n = cleverapps.UI.arrangeWithMargins(this.requestsViews.slice().reverse(), {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin,
                    x: e.width / 2,
                    y: e.y
                });
                this.content.setContentSize2(e.width, n)
            },
            createRequestView: function (e) {
                var n = e.getId(),
                    t = e.getView();
                if (t) return new t(e, this, function () {
                    var e, t = this.getRequestIdViewOrder(n),
                        s = this.requestsViews[0].getPosition();
                    if (!1 !== t) {
                        for (var i = t - 1; 0 <= i; --i) this.requestsViews[i].isRunning() && this.requestsViews[i].runAction(new cc.MoveTo(this.getMoveTime(),
                            this.requestsViews[i + 1].getPosition()));
                        this.requestsIds.splice(t, 1), this.requestsViews.splice(t, 1)
                    }
                    0 === this.requestsViews.length && 0 === this.pendingViews.length ? this.close() : 0 < this.pendingViews.length && (t = this.pendingViews[0], e = this.pendingIds[0], this.pendingViews.splice(0, 1), this.pendingIds.splice(0, 1), this.requestsViews.splice(0, 0, t), this.requestsIds.splice(0, 0, e), t.setVisible(!0), t.setScale(0), t.setPosition(s), t.runAction(new cc.ScaleTo(this.getMoveTime(), 1)))
                }.bind(this))
            },
            getRequestIdViewOrder: function (e) {
                for (var t = 0; t < this.requestsIds.length; t++)
                    if (this.requestsIds[t] === e) return t;
                return !1
            },
            getMoveTime: function () {
                return .3
            },
            onClose: function () {
                cleverapps.toolbar.updateItems()
            }
        })),
        RewardWindow = (FriendRequestsWindow.MAX_SHOW_REQUESTS = 4, cleverapps.styles.FriendRequestsWindow = {
            width: 400,
            margin: 15,
            y: 0
        }, Window.extend({
            ctor: function (e, t) {
                this.options = t = t || {}, this.reward = new RewardsList(e, t), this.reward.receiveRewards(), cleverapps.DataLoader.processSaveQueue(), this._super()
            },
            onWindowLoaded: function () {
                this._super({
                    title: this.options.title || "RewardWindow.title",
                    name: this.options.name || "rewardwindow",
                    content: this.createContent(),
                    noBackground: !0,
                    tapToContinue: "Window.ClickToClaim",
                    shareId: this.options.shareId || this.reward.isBigReward() && "reward",
                    showSound: this.options.sound || bundles.main.urls.reward_window_effect
                }), this.adjustRewardList(), this.rewardsList.showUp()
            },
            adjustRewardList: function () {
                var e = this.rewardsList.width * this.rewardsList.scale;
                e > this.window.width && this.rewardsList.setScale(this.rewardsList.scale * this.window.width / e)
            },
            createContent: function () {
                var e, t = cleverapps.styles.RewardWindow;
                return this.options.text && ((e = this.rewardText = cleverapps.UI.generateTTFText(this.options.text, cleverapps.styles.FONTS.REWARDWINDOW_TITLE_TEXT)).setWrapWidth(t.textWidth), e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER)), this.rewardsList = this.createRewardsList(), new cleverapps.Layout([e, this.rewardsList].filter(Boolean), {
                    direction: cleverapps.UI.VERTICAL,
                    margin: t.margin
                })
            },
            onShow: function () {
                this._super(.3 * this.reward.listRewards().length)
            },
            getPerson: function () {
                return {
                    role: "hero",
                    emotion: "happy"
                }
            },
            createRewardsList: function () {
                var e = cleverapps.styles.RewardWindow.rewards;
                return new RewardsListComponent(this.reward, {
                    font: cleverapps.styles.FONTS.REWARDWINDOW_VALUE_TEXT,
                    iconWrap: e.iconWrap,
                    margin: e.margin,
                    textMargin: e.textMargin,
                    toMainWorld: this.options.toMainWorld,
                    shine: !0
                })
            },
            onClose: function () {
                this.reward && (this.reward.onAnimationFinished(), this.reward = void 0)
            },
            beforeCloseAnimation: function (e) {
                var t;
                this.reward ? (t = this.reward, this.reward = void 0, this.rewardsList.receiveRewardsAnimation({
                    callback: e
                }), t = t.underShadowRewardIndex(), this.runAction(new cc.Spawn(new cc.Sequence(new cc.DelayTime(.2 + .3 * t), new cc.CallFunc(function () {
                    this.persons && this.persons.hide(), this.rewardText && this.rewardText.runAction(new cc.FadeOut(.3)), this.windowTitle && this.windowTitle.hide(), this.styles.shadow && cleverapps.windows.onHideShadow()
                }.bind(this)),
                    new cc.DelayTime(.3), new cc.FadeOut(.3), new cc.CallFunc(this.hideSelf.bind(this)))))) : e()
            },
            onPressed: function () {
                this.close()
            },
            listBundles: function () {
                return this.reward.listBundles()
            },
            getPreferredBundles: function () {
                return "merge" === cleverapps.config.type ? ["game", "main"] : this._super()
            }
        })),
        UserStatus = (RewardWindow.createStarChestWindow = function (e) {
            return new RewardWindow(e, {
                title: "StarChestRewardWindow.title",
                name: "starchestrewardwindow"
            })
        }, RewardWindow.createPurchaseWindow = function (e) {
            return new RewardWindow(e, {
                title: "PurchaseRewardWindow.title",
                name: "purchaserewardwindow"
            })
        }, RewardWindow.createCupsWindow = function (e, t) {
            return new RewardWindow(e, {
                name: "cupsrewardwindow",
                title: "Cups." + t + ".title",
                text: "Cups." + t + ".reward"
            })
        }, RewardWindow.createDailyTaskWindow = function (e) {
            return new RewardWindow(e.getReward(), {
                title: "DailyTaskRewardWindow.title",
                name: "dailytaskrewardwindow",
                text: "DailyTaskRewardWindow.text"
            })
        }, RewardWindow.createMiniGameWindow = function (e) {
            return new RewardWindow(e, {
                title: "MiniGameRewardWindow.title",
                name: "minigamerewardwindow",
                text: "MiniGameRewardWindow.text"
            })
        }, RewardWindow.createMissionWindow = function (e, t, s) {
            return new RewardWindow(e, {
                shareId: (s = s || {}).shareId || t.rewardShareId,
                title: t.rewardTitle,
                text: t.rewardText,
                toMainWorld: t.mainWorldReward
            })
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            REWARDWINDOW_TITLE_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            REWARDWINDOW_VALUE_TEXT: {
                size: 56,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.styles.RewardWindow = {
            textWidth: 800,
            margin: 40,
            rewards: {
                iconWrap: {
                    height: 160
                },
                margin: {
                    x: 100,
                    y: 60
                },
                textMargin: 0
            }
        }, function () {
            cleverapps.EventEmitter.call(this), cleverapps.environment.isSceneWithPreview() || cleverapps.config.wysiwygMode ? this.timeouts = [] : this.timeouts = [
                new UserStatusTimeout(cleverapps.parseInterval("10 seconds"), function (e, t) {
                    this.trigger("inactive_very_short", t)
                }.bind(this)), new UserStatusTimeout(cleverapps.parseInterval("20 seconds"), function (e, t) {
                    this.trigger("inactive_short", t)
                }.bind(this)), new UserStatusTimeout(cleverapps.parseInterval("60 seconds"), function (e, t) {
                    this.trigger("inactive_long", t)
                }.bind(this))
            ]
        }),
        UserStatusTimeout = (UserStatus.prototype = Object.create(cleverapps.EventEmitter.prototype), (UserStatus.prototype.constructor = UserStatus).prototype.destructor = function () {
            this.timeouts.forEach(function (e) {
                e.destructor()
            }), this.timeouts = []
        }, UserStatus.prototype.reportUserAction = function () {
            this.trigger("active"), this.timeouts.forEach(function (e) {
                e.reset()
            })
        }, function (e, t) {
            this.time = e, this.callback = t, this.reset()
        }),
        Counter = (UserStatusTimeout.prototype.reset = function () {
            this.clear(), this.hintTimeout = cleverapps.timeouts.setTimeout(function () {
                this.callback(), this.reset()
            }.bind(this), this.time)
        },
            UserStatusTimeout.prototype.clear = function () {
                cleverapps.timeouts.clearTimeout(this.hintTimeout)
            }, UserStatusTimeout.prototype.destructor = function () {
                this.clear()
            },
            function () {
                this.value = 0, this.onceZero = void 0, this.afterRunStages = void 0, this.stages = [], this.off = !1, this.onStageActivatedListener = function () { }
            }),
        FakeGame = (Counter.prototype.registerStage = function (t, e) {
            for (var s = 0; s < this.stages.length; s++)
                if (this.stages[s].handler === e) return;
            cleverapps.config.debugMode && 0 < this.stages.filter(function (e) {
                return e.priority === t
            }).length && alert("Multiple stages with same priority: " + t), this.stages.push({
                priority: t,
                handler: e
            }), this.stages.sort(function (e, t) {
                return e.priority - t.priority
            })
        }, Counter.prototype.runStages = function () {
            if (0 === this.value && !this.off)
                for (var e = 0; e < this.stages.length; e++)
                    if (this.stages[e].handler(), this.isActive()) return void this.onStageActivatedListener()
        }, Counter.prototype.turnOff = function () {
            this.off = !0
        }, Counter.prototype.turnOn = function () {
            this.off = !1
        },
            Counter.prototype.isActive = function () {
                return 0 < this.value
            }, Counter.prototype.trigger = function (e) {
                this.off || (e ? cleverapps.timeouts.setTimeout(this.trigger.bind(this), e) : this.runStages())
            }, Counter.prototype.inc = function () {
                this.value++
            }, Counter.prototype.dec = function () {
                var e;
                this.value--, 0 !== this.value || this.off || (this.onceZero && (e = this.onceZero, this.onceZero = void 0, e()), 0 !== this.value || this.off || this.runStages(), this.afterRunStages && (this.afterRunStages(), this.afterRunStages = void 0))
            }, Counter.prototype.setTimeout = function (e, t) {
                return this.inc(), cleverapps.timeouts.setTimeout(function () {
                    this.off || (e(), this.dec())
                }.bind(this), t)
            }, Counter.prototype.clearStages = function () {
                this.stages = []
            }, cleverapps.GameSaver = {
                gamesData: [],
                getStoreSlot: function (e, t) {
                    if (e = e || 0, t = t || 0, -1 === ["match3", "board", "merge"].indexOf(cleverapps.config.type) || cleverapps.isRumble()) {
                        var s = cleverapps.loadedSnapshot && cleverapps.loadedSnapshot.games;
                        if (!s || s.episode !== e || s.level !== t) return
                    }
                    if ("merge" === cleverapps.config.type) {
                        var s = new Episode(e, t).getLevel(),
                            i = TravelBook.findPageById(s.expedition);
                        if (i && String(i.episode) === String(s.episodeNo) && String(i.level || 0) === String(s.levelNo)) return i.slot || CustomSyncers.SLOT_MAIN
                    }
                    return t + "x" + e
                },
                convertToStoreKey: function (e) {
                    return "merge" === cleverapps.config.type && (e = "0x" + (e || 0)), cleverapps.config.name + cleverapps.platform.getLocalStoragePreffix() + "_level_" + e
                },
                findSave: function (t) {
                    return this.gamesData.filter(function (e) {
                        return Object.keys(e)[0] === t
                    })[0]
                },
                load: function (e) {
                    var t = this.convertToStoreKey(e),
                        s = this.findSave(t);
                    return (s = s && JSON.parse(s[t])) || (s = cleverapps.DataLoader.load(t)) && this.saveInfo(e, s), s
                },
                loadProperty: function (e, t) {
                    e = cleverapps.GameSaver.load(e);
                    return e && e[t]
                },
                reset: function () {
                    cleverapps.GameSaver.gamesData = [], cleverapps.episodes.listAllLevels().forEach(function (e) {
                        e = cleverapps.GameSaver.getStoreSlot(e.episodeNo, e.levelNo);
                        cleverapps.GameSaver.removeSave(e, {}), cleverapps.GameSyncer.addUpdateTask(e)
                    })
                },
                saveInfo: function (e, t, s) {
                    var i = this.convertToStoreKey(e),
                        n = this.findSave(i);
                    if (n) this.gamesData[this.gamesData.indexOf(n)][i] = JSON.stringify(t);
                    else {
                        for (; this.gamesData.length >= cleverapps.DataLoader.FIFO_LIMIT;) this.gamesData.shift();
                        n = {};
                        n[i] = JSON.stringify(t), this.gamesData.push(n)
                    }
                    cleverapps.DataLoader.save(i, t, {
                        fifoKey: cleverapps.DataLoaderTypes.GAME_SAVE_FIFO
                    }), s || cleverapps.GameSyncer.addUpdateTask(e)
                },
                removeSave: function (e) {
                    var e = this.convertToStoreKey(e),
                        t = this.findSave(e);
                    t && this.gamesData.splice(this.gamesData.indexOf(t), 1), cleverapps.DataLoader.remove(e, cleverapps.DataLoaderTypes.GAME_SAVE_FIFO)
                }
            },
            function (e) {
                (Game.currentGame = this).counter = {
                    isActive: function () {
                        return !0
                    },
                    registerStage: function () { },
                    trigger: function () { },
                    fieldCounter: {
                        registerStage: function () { }
                    },
                    setTimeout: function () { }
                };
                var t = bundles[Episode.BundleId(e.episodeNo)],
                    s = t.episode.levels && t.episode.levels[e.levelNo] || {};
                this.levelContent = e, this.level = {
                    quick: !0,
                    content: e,
                    episodeNo: e.episodeNo,
                    expedition: s.expedition || "main",
                    getHumanReadableNumber: function () {
                        return cleverapps.humanReadableNumber(e.episodeNo, e.levelNo)
                    },
                    getLevelEnemies: function () {
                        var t = {};
                        return s.enemies && s.enemies.forEach(function (e) {
                            t[e] = Game.GOAL_ENEMY_TYPES[e]
                        }), t
                    },
                    episode: {
                        isBonusRound: function () {
                            return !1
                        },
                        isBonusWorldLevel: function () {
                            return !1
                        },
                        bundleId: function () {
                            return Episode.BundleId(e.episodeNo)
                        }
                    },
                    getTag: function () {
                        return s.tag
                    },
                    isHard: function () {
                        return this.getTag() === Level.TAGS.HARD
                    },
                    isTricky: function () {
                        return this.getTag() === Level.TAGS.TRICKY
                    },
                    getImageBundle: function () {
                        return s.bundleName
                    }
                }, -1 !== ["solitaire", "tile3"].indexOf(cleverapps.config.type) && (this.pagination = new cleverapps.Pagination(this.levelContent.screens.length), this.generator = new TileGenerator, this.table = {
                    cards: []
                }, this.updateClovers = function () { }), "match3" === cleverapps.config.type && (t = new Loader, this.field = new Field(t), this.loader = t, this.callsOnFieldReady = [], this.goals = new Goals(e), this.score = {
                    updatePoints: function () { }
                }, this.moves = this.levelContent.moves,
                    this.leftMoves = this.moves, this.beginMoves = this.moves, Match3.counter = this.counter), "merge" === cleverapps.config.type && Object.assign(this, {
                        level: Object.assign(this.level, {
                            families: Families.listExpeditionCodes(this.level.expedition),
                            mapSize: s.mapSize,
                            units: this.levelContent.units,
                            tiles: this.levelContent.tiles
                        }),
                        tutorial: {
                            isActive: function () { }
                        },
                        orders: {
                            updateOrder: function () { },
                            findCanCook: function () {
                                return !0
                            }
                        },
                        gameLevel: {
                            value: 0,
                            getLevel: function () {
                                return 1
                            },
                            nextLevelThreshold: function () {
                                return 1e3
                            }
                        },
                        harvested: {
                            canTakeList: function () { },
                            on: function () { }
                        },
                        workers: {
                            findAssigned: function () { },
                            countRegularFree: function () {
                                return 2
                            },
                            countRegularTotal: function () {
                                return 2
                            },
                            isBonusWorkerBuyed: function () {
                                return !1
                            },
                            removeInstant: function () { }
                        },
                        energyLottery: {
                            isAvailable: function () {
                                return !1
                            },
                            isReady: function () {
                                return !1
                            }
                        },
                        spawn: function () {
                            return []
                        },
                        storeSave: function () { },
                        seasonalOperator: {},
                        on: function () { },
                        isExpedition: function () { },
                        specialOfferPlanner: {
                            specialOffers: []
                        },
                        needToReplaceWithCoins: function () { },
                        customers: {
                            removeCustomer: function () { }
                        },
                        unitGreeter: {
                            addGreeter: function () { },
                            removeGreeter: function () { }
                        },
                        isMainGame: function () {
                            return !1
                        }
                    }), "board" === cleverapps.config.type && (this.board = new cleverapps.Board(this, [], []), this.board.addHint = function () { }, this.hintBooster = {
                        addHint: function () { }
                    }, this.keypad = new Keypad(this, {}), this.current = new cleverapps.Current(this, this.keypad), this.extra = new cleverapps.Extra(this.levelContent, [])), cleverapps.config.rpg && (this.enemies = Game.SelectEnemies(this.level)), "battlefield" === cleverapps.config.type && (this.battlefield = new Battlefield(this.level.content.army.size, this.level.content.army.formation))
            }),
        GameBase = (FakeGame.prototype.getMissionType = function () { }, FakeGame.prototype.stop = function () {
            this.stopped || (this.stopped = !0, "merge" === cleverapps.config.type && (this.map.stop(), InfoView.Clear()))
        }, FakeGame.prototype.on = function () { }, function (e, t) {
            cleverapps.EventEmitter.call(this), (Game.currentGame = this).levelContent = e.content, this.level = e, this.options = t || {},
                this.slot = cleverapps.GameSaver.getStoreSlot(this.level.episodeNo, this.level.levelNo), this.savedGame = this.loadSave(), this.score = new Score(this.savedGame.score), this.moves = this.savedGame.moves || 0, this.timer = new GameTimer(this), this.counter = new Counter, this.boostersBefore = this.options.boostersBefore || [], this.level.isRegular() && this.level.isNew() && (this.primaryMission = cleverapps.missionManager.findRunningMission([Mission.TYPE_TREASURE_SEARCH, Mission.TYPE_STICKERS_COLLECTION, Mission.TYPE_SLOT_MACHINE, Mission.TYPE_LEVELPASS])), this.level.isRegular() && this.level.isNew() && "merge" !== cleverapps.config.type && (this.secondaryMission = cleverapps.missionManager.findRunningMission([Mission.TYPE_COMBO, Mission.TYPE_COLLECT_MARK, Mission.TYPE_BURN_NEARBY, Mission.TYPE_LETTER])), this.userStatus = new UserStatus, this.rewards = {}, this.secondaryMission && (this.rewards[GameBase.REWARD_SECONDARY] = 0), this.primaryMission && (t = (e = this.primaryMission.getLevelReward())[0], this.level.isHard() && (t = e[1]), this.level.isTricky() && (t = e[2]), this.rewards[GameBase.REWARD_PRIMARY] = t), cleverapps.piggyBank && cleverapps.piggyBank.isActive() && !cleverapps.piggyBank.isFull() && (this.rewards[GameBase.REWARD_PIGGY_BANK] = cleverapps.piggyBank.getAddAmount()), this.level.isRegular() && this.level.isNew() && cleverapps.exp.isAvailable() && (this.rewards[GameBase.REWARD_EXP] = this.level.isHard() ? GameBase.HARD_LEVEL_EXP_PRIZE : GameBase.EXP_PRIZE), this.setBasicReward(), this.rewards[GameBase.REWARD_HARD] = 0, this.level.episode.isBonusRound() && (this.rewards[GameBase.REWARD_HARD] = cleverapps.BonusRoundChest.REWARD);
            e = Lantern.Get();
            e && e.isActive(this.level) && (this.rewards.lantern = e.savedStreak >= Lantern.getMaxStreak() ? 0 : 1, e.onStart()), this.savedGame.rewards && (this.rewards = cleverapps.override(this.rewards, this.savedGame.rewards)), this.levelWithTutorial() && "merge" !== cleverapps.config.type ? cleverapps.Random.seed(this.level.getHumanReadableNumber() - 1) : cleverapps.Random.randomSeed(), this.outcome = GameBase.OUTCOME_UNKNOWN,
                cleverapps.flyingAd && cleverapps.flyingAd.setGame(this), this.counter.turnOff(), "merge" !== cleverapps.config.type && this.counter.registerStage(-1, this.begin.bind(this)), void 0 !== Prolongation && (this.prolongation = new Prolongation)
        }),
        GameDataSaver = (GameBase.prototype = Object.create(cleverapps.EventEmitter.prototype), (GameBase.prototype.constructor = GameBase).prototype.levelWithTutorial = function () {
            if (cleverapps.config.editorMode) return !1;
            if ("blocks" === cleverapps.config.type) return BlocksTutorial.isAvailable() || this.savedGame.tutorial && void 0 !== this.savedGame.tutorial.step;
            if ("match3" !== cleverapps.config.type) return "tile3" === cleverapps.config.type || "solitaire" === cleverapps.config.type ? TilesTutorial.IsAvailable(this.level) : "board" === cleverapps.config.type ? 0 === levels.user.episode && 0 === levels.user.level && this.level.isCurrentLevel() && !cleverapps.isKnockoutGame() : "merge" === cleverapps.config.type || void 0;
            if (this.levelContent.tutorial) {
                if (this.level.episode.isBonusWorldLevel()) return !0;
                if (
                    cleverapps.user.isPassedAll() && this.level.isPassedLevel()) return !1;
                if (this.level.isCurrentLevel()) return !0
            }
            return !1
        }, GameBase.prototype.displayTutorial = function (e) {
            e()
        }, GameBase.prototype.hasBegan = function () {
            return !!["battlefield"].includes(cleverapps.config.type) || ("match3" === cleverapps.config.type ? this.beginMoves !== this.moves : !(!["tile3", "klondike", "solitaire"].includes(cleverapps.config.type) || !Boolean(this.move)) || (0 < this.moves || 0 < this.getPercentOfCompletion()))
        }, GameBase.prototype.begin = function (e) {
            this.began || !this.hasBegan() && !e || (this.began = !0, (this.level.isRegular() || this.level.episode.isBonusWorldLevel()) && levels.user.isUniqueStart(this.level.episodeNo, this.level.levelNo, this.level.content.version) && this._churnActivated())
        }, GameBase.prototype.setBasicReward = function () {
            this.basicReward = 0, [Metha.HOMEFIX, Metha.SIMPLE, Metha.SHORTMETA, Metha.HOSE, Metha.FARM].includes(cleverapps.meta.getType()) && "battlefield" !== cleverapps.config.type && (this.rewards[GameBase.REWARD_EXP] || (
                this.level.isCurrentLevel() || this.level.episode.isDailyCup() || this.level.episode.isDailyLevel() || this.level.episode.isAdsLevel() || this.level.episode.isBonusWorldLevel() || cleverapps.config.editorMode || cleverapps.config.wysiwygMode) && (this.basicReward = 10, this.level.isTricky() && (this.basicReward = 20), this.level.isHard() && (this.basicReward = 30)))
        }, GameBase.prototype.addBasicReward = function () {
            (cleverapps.config.soft ? GameBase.REWARD_SOFT : GameBase.REWARD_HARD) === GameBase.REWARD_HARD ? this.addHardReward(this.basicReward) : this.addSoftReward(this.basicReward)
        }, GameBase.prototype.showStartGameMessage = function (e) {
            this.level.isHard() ? cleverapps.gameMessage.showMessage("message.hardLevel", {
                callback: e
            }) : e()
        }, GameBase.prototype._churnActivated = function () {
            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.UNIQUE_START, {
                hash: this.level.hash
            })
        }, GameBase.prototype.setTimeout = function (e, t) {
            return setTimeout(function () {
                this.stopped || e()
            }.bind(this), t)
        }, GameBase.prototype.getInfo = function () {
            return {
                rewards: this.rewards
            }
        }, GameBase.prototype.getInitialInfo = function () {
            return {}
        }, GameBase.prototype.storeSave = function () {
            var e;
            void 0 !== this.slot && (e = this.getInfo(), console.log("storeSave"), console.log(e), cleverapps.GameSaver.saveInfo(this.slot, e))
        }, GameBase.prototype.eraseSave = function () {
            cleverapps.GameSaver.removeSave(this.slot)
        }, GameBase.prototype.loadSave = function () {
            if (void 0 !== this.slot) {
                var e = cleverapps.GameSaver.load(this.slot) || {};
                if (0 < Object.keys(e).length) return e
            }
            return this.getInitialInfo()
        }, GameBase.prototype.getDailyCupStars = function () {
            return 1
        }, GameBase.prototype.initPool = function () { }, GameBase.prototype.stop = function () {
            this.counter.turnOff(), this.timer.stop(), levels.FPS.stop(), runCleaners(this), this.userStatus.destructor(), cleverapps.menuBar.stopItems(), cleverapps.exclamation.remove(), this.stopped = !0, this.trigger("stop")
        }, GameBase.prototype.animateBeforeWin = function (e) {
            e()
        }, GameBase.prototype.needTapToSkip = function () { }, GameBase.prototype.needAnimateBonus = function () {
            return !1
        }, GameBase.prototype.animateBonus = function (e) {
            e()
        }, GameBase.prototype.leave = function (e) {
            if (this.outcome === GameBase.OUTCOME_UNKNOWN) {
                if (this.stillNoPenalty()) return e(), void this.giveUp();
                if (this.level.isBonus() && this.level.isNew()) return e(), void this.win();
                var t = !1;
                new ConfirmExitWindow({
                    action: function () {
                        t = !0
                    }
                }), cleverapps.meta.onceNoWindowsListener = function () {
                    e(), t && (cleverapps.highscore && Game.currentGame.isMemorableGame() ? this.win() : this.lose())
                }.bind(this)
            } else e()
        }, GameBase.prototype.setOutcome = function (e) {
            this.outcome === GameBase.OUTCOME_UNKNOWN && (this.outcome = e, cleverapps.user.incProgressCompare(e === GameBase.OUTCOME_VICTORY ? 30 : 1), cleverapps.config.debugMode && console.log("OUTCOME: " + e), this.trigger("outcome", e))
        }, GameBase.prototype.win = function () {
            this.setOutcome(GameBase.OUTCOME_VICTORY)
        }, GameBase.prototype.lose = function () {
            this.setOutcome(GameBase.OUTCOME_LOST)
        }, GameBase.prototype.giveUp = function () {
            this.setOutcome(GameBase.OUTCOME_GAVEUP)
        }, GameBase.prototype.playIntro = function (e,
            s) {
            var t = this.listIntroActions();
            s && (t = t.map(function (t) {
                return function (e) {
                    t(e, s)
                }
            })), this.introPlaying = !0, cleverapps.meta.compound(function () {
                this.introPlaying = !1, e(), this.counter.trigger()
            }.bind(this), t)
        }, GameBase.prototype.turnOffCounter = function (e) {
            cleverapps.config.editorMode || this.counter.turnOn(), this.counter.inc(), e()
        }, GameBase.prototype.turnOnCounter = function (e) {
            this.counter.dec(), this.userStatus.reportUserAction(), e()
        }, GameBase.prototype.listIntroActions = function () {
            return [this.turnOffCounter.bind(this), this.introZoom.bind(this), this.prepareBoosters.bind(this), this.showScreen.bind(this), this.updateRestoreProgress.bind(this), this.beforeGameStart.bind(this), this.showStartGameMessage.bind(this), this.turnOnCounter.bind(this), this.startTutorial.bind(this), this.showDailyLevelWindow.bind(this), this.executeBoostersBefore.bind(this), this.runFPS.bind(this)]
        }, GameBase.prototype.startTutorial = function (e) {
            this.levelWithTutorial() ? this.displayTutorial(e) : e()
        },
            GameBase.prototype.introZoom = function (e, t) {
                var s = cleverapps.scenes.getRunningScene(),
                    i = this.outcome === GameBase.OUTCOME_UNKNOWN,
                    n = i ? 1 : 1 / s.introScale;
                s.animateZoom ? (s.animateZoom(n, t ? 0 : .8, e), !t && i && cleverapps.audio.playSound(bundles.game.urls.openlevel_effect)) : e()
            }, GameBase.prototype.prepareBoosters = function (e) {
                for (var t in cleverapps.boosters.boosters) cleverapps.boosters.boosters[t].onGameStarted();
                e()
            }, GameBase.prototype.showScreen = function (e) {
                e()
            }, GameBase.prototype.updateRestoreProgress = function (e) {
                cleverapps.restoreProgress.update(), e()
            }, GameBase.prototype.beforeGameStart = function (e) {
                this.competition && this.competition.start(), e()
            }, GameBase.prototype.runFPS = function (e) {
                this.level.isRegular() && levels.FPS.run(this.level.episodeNo, this.level.levelNo), e()
            }, GameBase.prototype.showDailyLevelWindow = function (e) {
                !cleverapps.config.wysiwygMode && cleverapps.config.features.includes("dailylevel") && !DailyLevelWindow.shown && this.level.episode.isDailyLevel() && ["olympics", "crocword", "tripeaks",
                    "spades"
                ].includes(cleverapps.config.name) ? (DailyLevelWindow.shown = !0, new DailyLevelWindow, cleverapps.meta.onceNoWindowsListener = e) : e()
            }, GameBase.EXP_PRIZE = 1, GameBase.HARD_LEVEL_EXP_PRIZE = 3, GameBase.REWARD_PRIMARY = "background_clover", GameBase.REWARD_SECONDARY = "clover", GameBase.REWARD_PIGGY_BANK = "piggyBank", GameBase.REWARD_EXP = "exp", GameBase.REWARD_HARD = "hard", GameBase.REWARD_BOOSTERS = "boosters", GameBase.REWARD_SOFT = "soft", GameBase.OUTCOME_UNKNOWN = void 0, GameBase.OUTCOME_VICTORY = 1, GameBase.OUTCOME_LOST = 2, GameBase.OUTCOME_GAVEUP = 3, GameBase.prototype.stillNoPenalty = function () {
                return !cleverapps.isRumble() && (this.outcome === GameBase.OUTCOME_UNKNOWN && (!this.level.episode.isBonusRound() && (!!["board", "battlefield"].includes(cleverapps.config.type) || ("match3" === cleverapps.config.type && -1 === this.originalMoves || !this.hasBegan()))))
            }, GameBase.prototype.getMissionType = function () {
                if (this.secondaryMission) return this.secondaryMission.type
            }, GameBase.prototype.addClover = function (e, t, s) {
                this.getMissionType() === e && (this.rewards[GameBase.REWARD_SECONDARY] = (this.rewards[GameBase.REWARD_SECONDARY] || 0) + t, s || this.trigger("rewardClover"))
            }, GameBase.prototype.addHardReward = function (e, t) {
                this.rewards[GameBase.REWARD_HARD] = (this.rewards[GameBase.REWARD_HARD] || 0) + e, t || this.trigger("rewardHard", e)
            }, GameBase.prototype.addSoftReward = function (e, t) {
                this.rewards[GameBase.REWARD_SOFT] = (this.rewards[GameBase.REWARD_SOFT] || 0) + e, this.trigger("rewardSoft", e, t)
            }, GameBase.prototype.executeBoostersBefore = function (e, t) {
                t ? e() : cleverapps.meta.compound(e, this.boostersBefore.map(function (s) {
                    return function (e) {
                        s.execute();
                        var t = s.getExecuteDuration();
                        0 === t ? e() : Game.currentGame.counter.setTimeout(e, 1e3 * t)
                    }
                }))
            }, GameBase.prototype.getPercentOfCompletion = function () {
                return 0
            }, GameBase.LEVEL_WITH_COINS_AVAILABLE = {
                level: .93
            },
            function (e) {
                this.key = e
            }),
        GameSceneBase = (GameDataSaver.prototype.save = function (e) {
            var t = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.GAME_DATA) || {};
            t[this.key] = e,
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.GAME_DATA, t)
        }, GameDataSaver.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.GAME_DATA);
            return e && e[this.key]
        }, GameDataSaver.prototype.add = function (e) {
            var t = this.load() || {},
                t = Object.assign({}, t, e);
            this.save(t)
        }, GameDataSaver.prototype.clear = function () {
            this.save()
        }, GameDataSaver.prototype.loadAndClear = function () {
            var e = this.load();
            return e && this.clear(), e
        }, GameDataSaver.Reset = function () {
            cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.GAME_DATA)
        }, GameDataSaver.Create = function (e) {
            var t = Game.currentGame && Game.currentGame.slot || CustomSyncers.SLOT_MAIN;
            return new GameDataSaver(e + t)
        }, cleverapps.GameSyncer = {
            addUpdateTask: function (e) {
                "merge" !== cleverapps.config.type && (e = CustomSyncers.SLOT_MAIN), cleverapps.synchronizer.addUpdateTask("games" + e)
            },
            loadInfo: function (e) {
                void 0 === e ? (t = (s = cleverapps.user.getCurrentLevel()).episodeNo, s = s.levelNo, e = cleverapps.GameSaver.getStoreSlot(t, s)) : "merge" !== cleverapps.config.type || "1" !== e && "2" !== e || (t = e);
                var t, s, e = cleverapps.GameSaver.load(e);
                return (e = e && 0 < Object.keys(e).length ? Object.assign(e, {
                    episode: t || void 0,
                    level: s || void 0
                }) : e) || {}
            },
            saveInfo: function (e, t) {
                var s, i;
                void 0 !== t && (s = t.episode || 0, i = t.level || 0, delete t.episode, delete t.level, void 0 === e && (e = cleverapps.GameSaver.getStoreSlot(s, i)), cleverapps.GameSaver.saveInfo(e, t, !0))
            }
        }, CustomSyncers.extractors.games = function () {
            return cleverapps.GameSyncer.loadInfo(void 0)
        }, CustomSyncers.importerData.games = function (e) {
            cleverapps.GameSyncer.saveInfo(void 0, e)
        }, "merge" === cleverapps.config.type && CustomSyncers.registerBySlots("games", function (e) {
            return cleverapps.GameSyncer.loadInfo(e)
        }, function (e, t) {
            cleverapps.GameSyncer.saveInfo(e, t)
        }), cleverapps.FixedWidthScene.extend({
            ctor: function (e) {
                this.options = e || {}, this._super(e), this.styling = this.level ? GameSceneBase.ChooseStyling(this.level) : {}
            },
            onSceneLoaded: function (e) {
                cleverapps.environment.levelNo = this.level.levelNo,
                    cleverapps.environment.episodeNo = this.level.episodeNo, cleverapps.environment.setScene(e || cleverapps.Environment.SCENE_GAME);
                var t = this.level,
                    s = this.game = new Game(t, this.options.gameOptions),
                    t = (this._super(e || cleverapps.Environment.SCENE_GAME), levels.cookieJar && levels.cookieJar.shouldBeVisible() && levels.cookieJar.setVisible(), this.game.competition && cleverapps.isKnockoutGame() && (this.playersView = new KnockoutPlayersView(this.game.competition, cleverapps.meta.getRumble().getCurrentRound()), this.addChild(this.playersView)), s.combo && (e = new ComboBarView(s.combo), this.addChild(e), this.comboBarControl = new HidingNode(e, cleverapps.UI.HORIZONTAL), cleverapps.meta.registerControl("comboBar", e)), "match3" === cleverapps.config.type && (this.infoPanel = new InfoPanel, this.addChild(this.infoPanel), this.controlsPanel = new ControlsPanel, cleverapps.restoreProgress.isAvailable() && !cleverapps.config.rpg || this.addChild(this.controlsPanel)), s.on("outcome", this.createListener(this.onChangeOutcome.bind(this)), this),
                        this.boatswain = new Boatswain(t), cc.pool.drainAllPools(), this.game.initPool(), cleverapps.lives && cleverapps.lives.amount > cleverapps.lives.getMaxLives() && (this.game.moreThenMaxRegenLife = !0), "merge" !== cleverapps.config.type && this.takeLife(!0), this.customize(), this.game.levelWithCoins && (e = new RewardGoldView, this.addChild(e), this.rewardGoldControl = new HidingNode(e, cleverapps.UI.HORIZONTAL), cleverapps.meta.registerControl("rewardElementGold", e)), (this.comboBarControl || this.rewardGoldControl) && (this.collectionContainer = new CollectionContainerView, this.addChild(this.collectionContainer)), this.game.secondaryMission && ((t = new CloversView).withinInfoPanel ? (this.infoPanel.addChild(t), this.cloversControl = t) : (this.addChild(t), this.cloversControl = new HidingNode(t, cleverapps.UI.AUTO), cleverapps.meta.registerControl("rewardElementClover", t, "match3" !== cleverapps.config.type && cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? [cleverapps.Environment.SCENE_GAME] : void 0))), (this.level.isRegular() || this.level.episode.isBonusWorldLevel()) && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.LEVEL_START, {
                            hash: this.level.hash
                        }), this.game.tournament && (e = new TournamentPlayersView(this.game.competition), this.addChild(e), this.playersView = new HidingNode(e, cleverapps.resolution.mode === cleverapps.WideMode.HORIZONTAL ? cleverapps.UI.HORIZONTAL : cleverapps.UI.VERTICAL), cleverapps.meta.registerControl("tournamentPlayersView", e)), cleverapps.gameMessage.onShowMessage = this.createListener(this.onGameMessage.bind(this)), this.exclamationView = ExclamationViewBase.Create());
                this.addChild(t, 20), t.setPositionRound(cleverapps.styles.GameScene.exclamation), cleverapps.flyingAd && this.addChild(new FlyingAdView), s.on("stop", this.onStop.bind(this), this)
            },
            onGameMessage: function (e, t) {
                e = new GameMessageView(e, t);
                this.addChild(e)
            },
            onStop: function () { },
            calcHash: function () {
                return RecursiveHasher(this.level.content, ["episodeNo", "levelNo", "version", "hard", "paint", "extra", "gold", "bundles"])
            },
            introControls: function () {
                return "panel_info"
            },
            getBgIntroScale: function () {
                return cleverapps.styles.GameScene.startAnimation.scale
            },
            playIntro: function (e, t) {
                this.game.playIntro(e, t)
            },
            _closeAction: function () {
                !BackToAdminOrEditorAction.call(this) && this.game && cleverapps.meta.display({
                    focus: "GameSceneCloseAction",
                    action: function (e) {
                        this.game.leave(e)
                    }.bind(this)
                })
            },
            customize: function () { },
            takeLife: function (e) {
                cleverapps.unlimitedLives && !cleverapps.unlimitedLives.checkBuyed() && (this.level.episode.isDailyCup() && !cleverapps.dailyCup.withLives() || cleverapps.lives.take(e))
            },
            giveLife: function () {
                cleverapps.unlimitedLives && !cleverapps.unlimitedLives.checkBuyed() && (this.level.episode.isDailyCup() && !cleverapps.dailyCup.withLives() || (this.game.moreThenMaxRegenLife || cleverapps.lives.amount < cleverapps.lives.getMaxLives()) && cleverapps.lives.give())
            },
            onChangeOutcome: function () {
                cleverapps.audio.fadeOut(), this.level.isPassed = this.game.outcome === GameBase.OUTCOME_VICTORY, BeforeWinAction.call(this), this.wantPlayChangeOutcome = !0,
                    this.playChangeOutcome()
            },
            playChangeOutcome: function () {
                var i = this.game.outcome,
                    e = cleverapps.toArray(this.introControls());
                this.level.episode.isBonusRound() && i === GameBase.OUTCOME_LOST && e.push("MenuBarBonusRoundTimerItem"), i === GameBase.OUTCOME_VICTORY && "solitaire" === cleverapps.config.type && e.push("opencards");
                cleverapps.meta.display({
                    focus: "ChangeOutcome",
                    control: e,
                    filter: function () {
                        return this.wantPlayChangeOutcome
                    }.bind(this),
                    actions: [VictoryMessageAction, function (e) {
                        this.game.needTapToSkip() && this.createTapToSkip(e), this.game.animateBeforeWin(e)
                    }.bind(this), function (e) {
                        var t;
                        HideAnimations[t = this.game.outcome, GameBase.OUTCOME_LOST === t ? "Lose" : GameBase.OUTCOME_GAVEUP === t ? "GiveUp" : "Victory"].call(this, e)
                    }.bind(this), function (e) {
                        this.game.needAnimateBonus() ? (this.game.skipBonusAnimations || this.createBonusChest(), this.game.animateBonus(e)) : e()
                    }.bind(this), function (e) {
                        "solitaire" === cleverapps.config.type && (this.game.addBasicReward(), this.bonusChest && this.bonusChest.addGold()), e()
                    }.bind(this), function (e) {
                        this.tapToSkip && this.tapToSkip.hideAndRemove(), this.bonusChest ? this.bonusChest.animationLeave(e) : e()
                    }.bind(this), function (e) {
                        this.infoPanel && this.infoPanel.hide(), e()
                    }.bind(this), function (e) {
                        this.wantPlayChangeOutcome = !1, this.game.stop(), e()
                    }.bind(this), SaveFinalResultsAction.bind(this), this.game.introZoom.bind(this.game), function (e) {
                        this.level.isCurrentLevel() && (i === GameBase.OUTCOME_VICTORY && (cleverapps.eventBus.trigger("taskEvent", DailyTasks.PASS_LEVEL, {
                            level: this.level.getHumanReadableNumber()
                        }), this.level.isHard() && cleverapps.eventBus.trigger("taskEvent", DailyTasks.PASS_LEVEL_HARD)), cleverapps.isKnockoutGame() ? cleverapps.meta.getRumble().outcome === Rumble.OUTCOME_WIN && cleverapps.user.incLevel() : i === GameBase.OUTCOME_VICTORY && cleverapps.meta.getType() !== Metha.FARM && cleverapps.user.incLevel()), cleverapps.restoreProgress.update(), e()
                    }.bind(this), function (e) {
                        var t, s;
                        i !== GameBase.OUTCOME_VICTORY || cleverapps.user.isPassedAll() || (t = cleverapps.user.episode, (s = new Episode(t)).loadData(function () {
                            s.destructor()
                        })), e()
                    }, function (e) {
                        this.boatswain.prepareNext(), e()
                    }.bind(this), InterstitialAction.bind(this), ShowOutcomeWindow.bind(this), UpdateScoreAction.bind(this), TilesUnlockAction.bind(this), RateWindowAction.bind(this), NewLeagueWindowAction.bind(this), MinigameFinishAction.bind(this), PurgeOldGameAction.bind(this), BoatswainAction.bind(this)]
                })
            },
            getBackgroundStyles: function () {
                var e = cleverapps.skins.getSlot("gameSceneBg") || this.styling,
                    t = bundles[e.bundle].urls;
                return e.backgroundId = t[e.backgroundId] ? e.backgroundId : "background", e.animation = bundles[e.bundle].jsons.background_spine || e.animation, e
            },
            getAudioStyles: function () {
                return {
                    res: cleverapps.skins.getSlot("gameAudio") || this.styling.music,
                    fadeIn: cleverapps.styles.GameScene.sound.fadeIn,
                    delay: cleverapps.config.wysiwygMode ? 0 : cleverapps.styles.GameScene.sound.delay
                }
            },
            updateSize: function () {
                this._super(), this.exclamationView && this.exclamationView.setPositionRound(cleverapps.styles.GameScene.exclamation)
            },
            listBundles: function () {
                var e = this.level,
                    t = this.styling,
                    s = ["game"];
                return cleverapps.resolution.mode === cleverapps.WideMode.HORIZONTAL ? s.push("game_background_horizontal") : s.push("game_background_vertical"), t && s.push(t.bundle), e && (s.push(e.getImageBundle()), (t = e.getLevelCellSkins()) && cleverapps.values(t).forEach(function (e) {
                    var t;
                    bundles[e] && (t = e.substring(0, e.indexOf("_reskin")), t = s.indexOf(t), s.splice(t, 0 < t ? 1 : 0, e))
                }), cleverapps.config.rpg && s.push("enemies")), "stacks" === cleverapps.config.subtype && s.push("extra_" + cleverapps.settings.language), bundles["letters_" + cleverapps.settings.language] && s.push("letters_" + cleverapps.settings.language), s.filter(function (e) {
                    return e && bundles[e]
                })
            },
            animateZoom: function (e, t, s) {
                if (!t) return this.background && this.background.setScale(e * this.background.baseScale), void s();
                this.background && this.background.runAction(new cc.ScaleTo(t, e * this.background.baseScale)), this.runAction(new cc.Sequence(new cc.DelayTime(t), new cc.CallFunc(s)))
            },
            createBonusChest: function () {
                this.bonusChest = new ChestVictoryAnimation, this.bonusChest.setPositionRound(cleverapps.styles.ChestVictoryAnimation.chestPosition), this.addChild(this.bonusChest)
            },
            createTapToSkip: function (e) {
                var t = this.tapToSkip = new TapToContinue({
                    text: "TapToSkip"
                });
                t.setPositionRound(cleverapps.styles.TapToContinue), t.setLocalZOrder(30), t.setVisible(!1), t.show(), this.addChild(t), cleverapps.UI.onClick(t, function () { }, {
                    ignoreScale: !0,
                    onOuterTouch: cleverapps.once(function () {
                        this.game.skipBonusAnimations = !0, t.hideAndRemove(), this.tapToSkip = void 0, e()
                    }.bind(this))
                })
            }
        })),
        NoneMainGameScene = (GameSceneBase.ChooseStyling = function (e) {
            if (bundles[e.episode.bundleId()] && bundles[e.episode.bundleId()].urls.background) return {
                bundle: e.episode.bundleId()
            };
            if (cleverapps.environment.isEditorScene() && cleverapps.styles.GameScene.STYLING.editor) return cleverapps.styles.GameScene.STYLING.editor;
            var t = cleverapps.styles.GameScene.STYLING,
                s = t.regular[e.getHumanReadableNumber() % t.regular.length],
                t = (e.episode.isBonusRound() || e.isBonus() ? s = t.bonus : e.isHard() || cleverapps.isRumble() && cleverapps.meta.getRumble().getCurrentRound().isLast() ? s = t.hard : e.isTricky() && (s = t.tricky), (s = cleverapps.clone(s)).bundle);
            return cleverapps.resolution.mode !== cleverapps.WideMode.VERTICAL && (t = t.replace("_vertical", "_horizontal")), s.bundle = bundles[t] ? t : s.bundle.replace("_vertical", "_" + cleverapps.config.orientation), !e.episode.isBonusWorldLevel() || (t = cleverapps.missionManager.findRunningMission(Mission.TYPE_BONUS_WORLD)) && (s.bundle = t.bonusWorld.backgroundBundleId(), s.music = bundles[s.bundle].urls.game_music || bundles[s.bundle].urls.music, s.skin = void 0), s
        }, cleverapps.styles.GameScene = {
            exclamation: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            actor: void 0,
            startAnimation: {
                scale: 1.05
            },
            sound: {
                delay: 1
            },
            debugLevelNo: {
                x: {
                    align: "right",
                    dx: -100
                },
                y: {
                    align: "bottom",
                    dy: 100
                }
            }
        }, cleverapps.styles.GameScene.STYLING = {
            bonus: {
                backgroundId: "background_bonus",
                bundle: "game_background_vertical",
                music: bundles.game_music.urls.background_music_game
            },
            hard: {
                backgroundId: "background_hard",
                bundle: "game_background_vertical",
                music: bundles.game_music.urls.background_music_hard
            },
            regular: [{
                bundle: "game_background_vertical",
                music: bundles.game_music.urls.background_music_game
            }]
        }, -1 !== ["wordsoup", "olympics"].indexOf(cleverapps.config.name) && (cleverapps.styles.GameScene.STYLING.bonus.patternId = "background_bonus"), -1 !== ["wordsoup", "olympics", "differences"].indexOf(cleverapps.config.name) && (cleverapps.styles.GameScene.STYLING.hard.patternId = "background_hard", cleverapps.styles.GameScene.STYLING.regular[0].patternId = "background"), function () {
            bundles.editor && bundles.editor.urls.background && (cleverapps.styles.GameScene.STYLING.editor = {
                bundle: "editor"
            });
            for (var e = cleverapps.styles.GameScene.STYLING.regular[0], t = 2; ; t++) {
                if (bundles.game_background_vertical) {
                    if (!bundles.game_background_vertical.urls["background_" + t]) break
                } else if (!bundles.game_background_horizontal.urls["background_" + t]) break;
                cleverapps.styles.GameScene.STYLING.regular.push({
                    backgroundId: "background_" + t,
                    bundle: e.bundle,
                    music: e.music,
                    patternId: e.patternId
                })
            }
        }(), GameSceneBase.extend({
            ctor: function (e) {
                (e = e || {}).level || (e.level = new Episode(0).getLevel(0)), this._super(e)
            },
            onSceneLoaded: function () {
                this._super(cleverapps.Environment.SCENE_MAIN)
            },
            _closeAction: function () {
                MainScene.prototype._closeAction.call(this)
            }
        })),
        GameMessage = function () {
            this.onShowMessage = function () { }
        },
        GameMessageView = (GameMessage.prototype.showMessage = function (e, t) {
            var s;
            (t = t || {}).delay = t.delay || 1.2, t.skin = this.getSkin(), cleverapps.timeouts.setTimeout(function () {
                this.onShowMessage(e, t)
            }.bind(this), 200), t.callback && (s = t.callbackDelay || t.delay, cleverapps.timeouts.setTimeout(t.callback, 700 + 1e3 * s + 500))
        }, GameMessage.prototype.getSkin = function () {
            return cleverapps.isRumble() && cleverapps.meta.getRumble().getCurrentRound().isLast() || Game.currentGame.level.isHard() ? "hard" : Game.currentGame.level.isTricky() ? "tricky" : Game.currentGame.level.episode.isBonusRound() ? "bonus_round" : void 0
        }, cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.options = t = t || {}, this.styles = cleverapps.styles.GameMessageView;
                var t = cleverapps.scenes.getRunningScene(),
                    s = this.createBackground(),
                    e = (s.setVisible(!1), this.addChild(s), this.updateSize(), this.createText(e));
                e.fitTo(.9 * t.width), s.addChild(e), this.setLocalZOrder(11), this.updatePosition(), this.show()
            },
            updatePosition: function () {
                var e = cleverapps.scenes.getRunningScene();
                this.background.setPositionRound(e.width / 2, this.background.y), this.direction = this.options.direction || GameMessageView.DIRECTION_TOP_DOWN, this.start = cc.p(e.width / 2, e.height + this.background.height / 2), this.target = cc.p(e.width / 2, e.height / 2), this.finish = cc.p(e.width / 2, -this.background.height / 2), this.direction === GameMessageView.DIRECTION_TOP_TOP && (this.finish = start), this.pattern && this.createPatternLayer(this.pattern, this.background)
            },
            updateSize: function () {
                var e = cleverapps.UI.getSceneSize();
                this.background.setContentSize2(1.2 * e.width, this.background.height)
            },
            show: function () {
                this.background.setPositionRound(this.start), this.background.setVisible(!0), cleverapps.audio.playSound(bundles.gamemessage.urls.game_message_effect), this.background.runAction(new cc.Sequence(new cc.MoveTo(.3, this.target).easing(cc.easeBackOut(1.4)), new cc.CallFunc(function () {
                    "hard" === this.options.skin && cleverapps.audio.playSound(bundles.gamemessage.urls.game_message_hard_effect)
                }.bind(this)), new cc.DelayTime(this.options.delay), new cc.CallFunc(function () {
                    this.background.runAction(new cc.MoveTo(.3, this.finish).easing(cc.easeBackIn(1.4)))
                }.bind(this)), new cc.DelayTime(.3), new cc.CallFunc(function () {
                    this.removeFromParent()
                }.bind(this))))
            },
            createText: function (e) {
                e = Messages.has(e) ? Messages.get(e) : e;
                var t = cleverapps.styles.FONTS.GAME_MESSAGE_TEXT,
                    s = cleverapps.UI.generateTTFText(e.toUpperCase(), t);
                return s.updatePosition = function () {
                    s.setPositionRound(this.styles.text)
                }.bind(this), s.updatePosition(), s.setLocalZOrder(1), s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s
            },
            createBackground: function () {
                var e = bundles.gamemessage.frames.gamemessage_bg_png,
                    e = this.background = new cc.Scale9Sprite(e),
                    t = (e.setLocalZOrder(-1), this.pattern = bundles.gamemessage.frames.gamemessage_pattern_png);
                return t && this.createPatternLayer(t, e), e
            },
            createPatternLayer: function (e, t) {
                this.patternLayout && (this.patternLayout.removeFromParent(), delete this.patternLayout);
                for (var s = new cc.Sprite(e).width, i = Math.ceil(cleverapps.UI.getSceneSize().width / s) + 1, n = [], o = 0; o <= i; o++) {
                    var a = new cc.Sprite(e);
                    n.push(a)
                }
                s = this.patternLayout = new cleverapps.Layout(n, {
                    direction: cleverapps.UI.HORIZONTAL
                });
                s.setLocalZOrder(0), s.setPositionRound(cleverapps.scenes.getRunningScene().width / 2, t.height / 2), t.addChild(s)
            }
        })),
        GameTimer = (GameMessageView.DIRECTION_TOP_DOWN = 0, GameMessageView.DIRECTION_TOP_TOP = 1, cleverapps.styles.GameMessageView = {
            text: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            }
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            GAME_MESSAGE_TEXT: {
                size: 86,
                color: cleverapps.styles.COLORS.WHITE
            }
        }), function (e) {
            cleverapps.EventEmitter.call(this), this.start = e.savedGame.timeStart || Date.now(), this.seconds = e.savedGame.seconds || 0, this.interval = setInterval(function () {
                e.outcome === GameBase.OUTCOME_UNKNOWN && e.began && (this.seconds++, this.trigger("onSecond"))
            }.bind(this), 1e3)
        }),
        UpdateScoreAction = (GameTimer.prototype = Object.create(cleverapps.EventEmitter.prototype), (GameTimer.prototype.constructor = GameTimer).prototype.getStartTime = function () {
            return this.start
        }, GameTimer.prototype.getTime = function () {
            return Date.now() - this.start
        }, GameTimer.prototype.getInGameTime = function () {
            return this.seconds
        }, GameTimer.prototype.stop = function () {
            clearInterval(this.interval)
        }, function (e) {
            cleverapps.instantTournament.updateScore(), e()
        }),
        InterstitialAction = function (e) {
            cleverapps.rewardedAdsManager.showInterstitial(e)
        },
        VictoryMessageAction = function (e) {
            if (Game.currentGame.outcome === GameBase.OUTCOME_VICTORY && "blocks" !== cleverapps.config.type) {
                if (cleverapps.audio.playSound(bundles.main.urls.congratulate_sfx), ["heroes", "runes",
                    "adventure"
                ].includes(cleverapps.config.name)) return cleverapps.exclamation.show("message.YouWin", Exclamation.Types.Congrats), void Game.currentGame.counter.setTimeout(e, 1200);
                Game.currentGame.counter.inc(), cleverapps.gameMessage.showMessage("GameMessage.Victory", {
                    json: bundles.gamemessage.jsons.game_message_victory_json,
                    direction: GameMessageView.DIRECTION_TOP_DOWN,
                    rays: !0,
                    callbackDelay: .7,
                    callback: function () {
                        Game.currentGame.counter.dec(), e()
                    }
                })
            } else e()
        },
        HideAnimations = {
            Victory: function (e) {
                e()
            },
            Lose: function (e) {
                HideAnimations.Victory.call(this, e)
            },
            GiveUp: function (e) {
                HideAnimations.Lose.call(this, e)
            }
        },
        BeforeWinAction = function () {
            cleverapps.placements.run(Placements.AFTER_GAME_FINISH);
            var e = this.game.outcome;
            this.giveLife(), this.controlsPanel && this.controlsPanel.hide(), this.level.isRegular() && cleverapps.isKnockoutGame() && cleverapps.meta.getRumble().moveNextRound(e), "solitaire" !== cleverapps.config.type && this.game.addBasicReward(), this.level.isRegular() && cleverapps.meta.getMainObject().gamePlayed(e, this.game), "KeypadControl" === cleverapps.meta.focus && this.game.keypad.reset(), e === GameBase.OUTCOME_GAVEUP ? BeforeWinGaveUpAction.call(this) : e === GameBase.OUTCOME_VICTORY ? BeforeWinVictoryAction.call(this) : e === GameBase.OUTCOME_LOST && BeforeWinLoseAction.call(this)
        },
        BeforeWinVictoryAction = function () {
            this.game.timer && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.LEVEL_PASSED_TIME, {
                hash: this.level.hash,
                passedTime: this.game.timer.getTime()
            });
            var e = Lantern.Get(),
                t = (e && e.isActive(this.level) && e.onWin(), (this.level.isRegular() || this.level.episode.isBonusWorldLevel()) && (void 0 !== this.game.leftMoves && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.LEVEL_LEFT_MOVES, {
                    hash: this.level.hash,
                    leftMoves: this.game.leftMoves
                }), e = !0, (e = "board" === cleverapps.config.type && this.game.timer ? this.game.timer.getTime() <= cleverapps.parseInterval("5 minutes") : e) && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.LEVEL_FINISH, {
                    hash: this.level.hash
                }), (this.level.isNew() || this.level.episode.isBonusWorldLevel()) && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.UNIQUE_FINISH, {
                    hash: this.level.hash
                })), this.level.isCurrentLevel());
            this.boatswain.level = this.level = Object.assign(cleverapps.clone(this.level), {
                isCurrentLevel: function () {
                    return t
                }
            }), this.level.episode.isDailyLevel() && cleverapps.dailyLevel.onWin(this.level), this.level.episode.isBonusWorldLevel() && cleverapps.missionManager.dispatchEvent(Mission.TYPE_BONUS_WORLD, {
                level: this.level
            }), cleverapps.missionManager.refreshTeaser(), "board" === cleverapps.config.type && BeforeWinVictoryWordAction.call(this), this.game.eraseSave()
        },
        BeforeWinVictoryWordAction = function () {
            var e;
            levels.gameHints.reset(), this.level.isCurrentLevel() && this.game.tournament && (e = this.game.competition.calcPlace() + 1, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TOURNAMENT_LEVEL_PLACE + "_" + e)), this.game.updateRewards(), this.game.competition && this.game.rewards[GameBase.REWARD_PRIMARY] && this.game.competition.onAnimateResults(
                this.game.rewards[GameBase.REWARD_PRIMARY])
        },
        BeforeWinLoseAction = function () {
            var e = Lantern.Get();
            e && e.isActive(this.level) && e.onLose(), this.takeLife(), this.game.eraseSave()
        },
        BeforeWinGaveUpAction = function () {
            var e = Lantern.Get();
            e && e.isActive(this.level) && e.restoreSavedStreak()
        },
        MinigameFinishAction = function (e) {
            var t = this.game.primaryMission;
            t && t.isMinigameReadyToFinish() ? (new t.nudgeWindow(t), cleverapps.meta.onceNoWindowsListener = e) : e()
        },
        BackToAdminOrEditorAction = function () {
            var e = cleverapps.getRequestParameters(location.hash);
            return "editor" === e.mode ? (cleverapps.setUrlHash({
                playLevel: void 0
            }), this.level.edit(), !0) : "admin" === e.mode && (cleverapps.setUrlHash({
                playLevel: void 0
            }), AdministratorScene.open(), !0)
        },
        PurgeOldGameAction = function (e) {
            this.game && !this.game.stopped && cleverapps.throwAsync("purgeOldGame active game"), Game.currentGame = void 0, this.game = void 0, e()
        },
        SaveFinalResultsAction = function (e) {
            var t;
            this.game.outcome === GameBase.OUTCOME_VICTORY && this.level.episode.isDailyCup() && (
                cleverapps.dailyCup.addAmount(this.game.getDailyCupStars()), cleverapps.dailyCup.reload(!0), cleverapps.playSession.set(cleverapps.EVENTS.CUP_PLAYERS + cleverapps.dailyCup.type, !0), cleverapps.eventBus.trigger("taskEvent", DailyTasks.PASS_DAILY_CUP_LEVEL)), this.game.outcome === GameBase.OUTCOME_VICTORY && "match3" === cleverapps.config.type && (cleverapps.user.isPassedAll() || (t = this.level.getHumanReadableNumber(), cleverapps.social.sendActivity(cleverapps.Social.ACTIVITY.LVL_PASSED, {
                    userName: cleverapps.friends.getPlayer().name,
                    score: this.game.score.getPoints(),
                    levelNo: t
                })), this.level.isRegular() && this.level.isNew() && cleverapps.exp.isAvailable() && !this.game.rewards[GameBase.REWARD_EXP] && (this.game.rewards[GameBase.REWARD_EXP] = this.level.isHard() ? GameBase.HARD_LEVEL_EXP_PRIZE : GameBase.EXP_PRIZE), (this.level.episode.isRegular() && this.level.isNew() || this.level.episode.isDailyCup()) && (this.game.rewards.stars = this.game.score.stars), this.level.isRegular() && cleverapps.eventLogger.logEvent(
                    cleverapps.EVENTS.STATS.LEVEL_STARS, {
                    hash: this.level.hash,
                    stars: this.game.score.stars
                })), this.game.rewards[GameBase.REWARD_BOOSTERS] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTER_CELL_RECEIVED), e()
        },
        TilesUnlockAction = function (e) {
            var t;
            "tile3" === cleverapps.config.type && this.game.outcome === GameBase.OUTCOME_VICTORY && TilesUnlockWindow.areUnlockedTilesAvailable() ? (t = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.UNLOCKED_TILES_STAGES) || 0, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.UNLOCKED_TILES_STAGES, t + 1), new TilesUnlockWindow, cleverapps.meta.onceNoWindowsListener = e) : e()
        },
        ShowOutcomeWindow = function (e) {
            var t = this.game.outcome;
            t === GameBase.OUTCOME_GAVEUP ? e() : (this.level.episode.isBonusRound() ? ShowBonusRoundWindow : t === GameBase.OUTCOME_LOST && "battlefield" !== cleverapps.config.type ? ShowLoseWindow : ShowVictoryWindow).call(this, e)
        },
        ShowVictoryWindow = function (e) {
            new VictoryWindow(this.game, this.boatswain), cleverapps.meta.onceNoWindowsListener = e
        },
        ShowBonusRoundWindow = function (e) {
            new BonusRoundWindow(this.game), cleverapps.meta.onceNoWindowsListener = e
        },
        ShowLoseWindow = function (e) {
            cleverapps.meta.compound(e, [function (e) {
                cleverapps.isRumble() && "differences" !== cleverapps.config.name ? (new BeforeLoseWindow(this.game), cleverapps.meta.onceNoWindowsListener = e) : e()
            }.bind(this), function (e) {
                new LoseWindow(this.game, this.boatswain), cleverapps.meta.onceNoWindowsListener = e
            }.bind(this)])
        },
        DailyTask = function () {
            cleverapps.EventEmitter.call(this), this.type = void 0, this.goal = void 0, this.progress = 0, this.collected = !1, this.difficulty = void 0, this.data = void 0
        },
        DailyTasks = (DailyTask.prototype = Object.create(cleverapps.EventEmitter.prototype), (DailyTask.prototype.constructor = DailyTask).prototype.isSwappable = function () {
            return -1 !== [DailyTasks.WATCH_ADS].indexOf(this.type)
        }, DailyTask.CreateCompleteAll = function () {
            var e = new DailyTask;
            return e.type = DailyTasks.COMPLETE_ALL, e.goal = 5, e.icon = "daily_task_icon_complete_all_png", e.data = {}, e
        }, DailyTask.Create = function (t) {
            var s = new DailyTask;
            return s.type = t.type, s.goal = t.goal, s.difficulty = t.difficulty, s.data = {}, Object.keys(t).forEach(function (e) {
                -1 === ["type", "goal", "difficulty"].indexOf(e) && (s.data[e] = t[e])
            }), s
        }, DailyTask.prototype.load = function (e, t) {
            this.type = e.type, this.goal = e.goal, this.progress = e.progress, this.lastProgress = e.lastProgress, this.collected = e.collected, this.data = e.data || {}, this.data.color && -1 === DailyTasks.CELL_COLORS.indexOf(this.data.color) && (this.data.color = cleverapps.Random.choose(DailyTasks.CELL_COLORS)), this.data.cardValue && -1 === DailyTasks.CARD_VALUES.indexOf(this.data.cardValue) && (this.data.cardValue = cleverapps.Random.choose(DailyTasks.CARD_VALUES)), this.difficulty = this.guessDifficulty(t)
        }, DailyTask.prototype.guessDifficulty = function (e) {
            return e <= 1 ? DailyTask.EASY : 2 <= e && e <= 3 ? DailyTask.MEDIUM : DailyTask.HARD
        }, DailyTask.prototype.getSaveInfo = function () {
            return {
                type: this.type,
                goal: this.goal,
                progress: this.progress,
                lastProgress: this.lastProgress,
                collected: this.collected,
                data: this.data
            }
        },
            DailyTask.prototype.addProgress = function (e, t) {
                if (t = "object" == typeof e ? e : t, 0 < (e = "number" != typeof e ? 1 : e)) return this.setProgress(this.progress + e, t)
            }, DailyTask.prototype.isApplicable = function (e) {
                switch (this.type) {
                    case DailyTasks.COLLECT_COLOR_CELLS:
                        return this.data.color === e.color;
                    case DailyTasks.GUESS_WORDS_WITH_LETTER:
                        return this.data.letter === e.letter;
                    case DailyTasks.COLLECT_CARDS_BY_VALUE:
                        return this.data.cardValue === e.cardValue;
                    case DailyTasks.COLLECT_CARDS_BY_SUIT:
                        return this.data.cardSuit === e.cardSuit;
                    case DailyTasks.COLLECT_HERO_CELLS:
                        return this.data.color === e.color;
                    case DailyTasks.MERGE:
                        return this.data.mergeAmount <= e.mergeAmount
                }
                return !0
            }, DailyTask.prototype.notifyProgress = function () {
                var e;
                this.progress !== this.lastProgress && (void 0 === this.lastProgress && (this.lastProgress = 0), e = this.getTitle(), cleverapps.notification.create(e.text, {
                    toReplace: e.replace,
                    image: bundles.notification.frames.icon,
                    progress: {
                        amount: this.lastProgress,
                        newAmount: this.progress,
                        total: this.goal
                    }
                }),
                    this.lastProgress = this.progress)
            }, DailyTask.prototype.setProgress = function (e, t) {
                this.isApplicable(t) && !this.isFinished() && (e = (e = "number" != typeof e ? 1 : e) > this.goal ? this.goal : e) !== this.progress && (this.progress = e, this.trigger("update"), this.save(), this.isFinished() && cleverapps.dailyTasks.taskWasFinished(this), this.type !== DailyTasks.COMPLETE_ALL && setTimeout(this.notifyProgress.bind(this), 0))
            }, DailyTask.prototype.isFinished = function () {
                return this.progress >= this.goal
            }, DailyTask.prototype.collect = function () {
                this.isFinished() && !this.collected && (this.collected = !0, this.save(), this.trigger("update"), cleverapps.dailyTasks.onChangeStateListener())
            }, DailyTask.prototype.givePrize = function () {
                this.isFinished() && !this.collected && (cleverapps.dailyTasks.collect(this), RewardWindow.createDailyTaskWindow(this))
            }, DailyTask.prototype.save = function () {
                cleverapps.dailyTasks.save()
            }, DailyTask.prototype.getTitle = function () {
                var e, t = {};
                return DailyTasks.COLLECT_COLOR_CELLS === this.type && (t.color = Messages.get(
                    "ColorCell." + this.data.color + ".Title")), DailyTasks.GUESS_WORDS_WITH_LETTER === this.type && this.data.letter && (t.letter = this.data.letter.toUpperCase()), DailyTasks.COLLECT_HERO_CELLS === this.type && (t.heroes = Messages.get("DailyTask.24." + this.data.color)), DailyTasks.COLLECT_CARDS_BY_VALUE === this.type && (e = parseInt(this.data.cardValue) || this.data.cardValue, t.cards = "number" == typeof e ? e : Messages.get("DailyTask.25." + e)), DailyTasks.COLLECT_CARDS_BY_SUIT === this.type && (t.cards = Messages.get("DailyTask.26." + this.data.cardSuit)), DailyTasks.MERGE === this.type && (t.amount = this.data.mergeAmount), -1 !== [DailyTasks.SPEND_HARD, DailyTasks.SPEND_SOFT].indexOf(this.type) && (t.amount = this.goal), {
                    text: "DailyTask." + this.type + ".Title",
                    replace: t
                }
            }, DailyTask.prototype.getIcon = function () {
                if (DailyTasks.GUESS_WORDS_WITH_LETTER === this.type) return e = CharView.Create(this.data.letter, {
                    bgImage: bundles.dailytasks.frames.letter_bg_png
                }), "scramble" === cleverapps.config.name && e.setScale(.8), e;
                var e = DailyTasks.CONFIG[this.type].icon;
                return "object" == typeof e && (e = e[this.data.color || this.data.cardValue || this.data.cardSuit]), new cc.Sprite(bundles.dailytasks.frames[e])
            }, DailyTask.prototype.getReward = function () {
                return this.data.customReward || (e = this.type === DailyTasks.COMPLETE_ALL ? RewardsConfig.DailyTask.completeAll : RewardsConfig.DailyTask[["easy", "medium", "hard"][this.difficulty]], e = cleverapps.Random.choose(e), -1 !== ["board", "match3"].indexOf(cleverapps.config.type) ? cleverapps.user.prepareRewardByRich(e) : e);
                var e
            }, DailyTask.EASY = 0, DailyTask.MEDIUM = 1, DailyTask.HARD = 2,
            function () {
                this.onChangeStateListener = function () { }, this.onTaskSwappedOut = function () { }, this.tasks = [], this.whenStart = -1, this.isAvailable() ? this.load() : this.save(), cleverapps.whenAllInitialized(this.update.bind(this)), cleverapps.user.on("incLevel", this.update.bind(this)), cleverapps.eventBus.on("gameEvent", this.onGameEvent.bind(this)), cleverapps.eventBus.on("taskEvent", this.onTaskEvent.bind(this))
            }),
        DailyTasksWindow = (DailyTasks.prototype.getInfo = function () {
            return {
                whenStart: this.whenStart,
                tasks: this.tasks.map(function (e) {
                    return e.getSaveInfo()
                })
            }
        }, DailyTasks.prototype.load = function (e) {
            if (!this.isAvailable()) return this.tasks = [], void (this.whenStart = -1);
            e = e || cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.DAILY_TASKS) || {};
            this.tasks = [], this.whenStart = void 0 !== e.whenStart ? e.whenStart : -1, this.whenStart > this.getStartTime() && (this.whenStart = this.getStartTime());
            e.tasks && 6 === e.tasks.length && e.tasks.every(function (e) {
                return DailyTasks.CONFIG[e.type]
            }) ? this.tasks = e.tasks.map(function (e, t) {
                var s = new DailyTask;
                return s.load(e, t), s
            }) : this.whenStart = -1
        }, DailyTasks.prototype.save = function (e) {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.DAILY_TASKS, this.getInfo()), !1 !== e && cleverapps.synchronizer.addUpdateTask("dailytasks")
        }, DailyTasks.prototype.collect = function (e) {
            e.collected || (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_TASK_REWARD + (e.difficulty || 3)), cleverapps.playSession.inc(cleverapps.EVENTS.SESSION_DAILY_TASK_REWARD),
                e.collect(), cleverapps.social.sendActivity(cleverapps.Social.ACTIVITY.DAILY_TASK, {
                    userName: cleverapps.friends.getPlayer().name
                }))
        }, DailyTasks.prototype.collectLastTask = function () {
            var e = cleverapps.dailyTasks.getCompleteAllTask();
            e.progress !== e.goal || e.collected || 1 !== cleverapps.dailyTasks.getNotCollectedTasks().length || e.givePrize()
        }, DailyTasks.prototype.pick5Pack = function () {
            var e = cleverapps.Random.chooseAmount(this.listTaskByDifficulty(DailyTask.EASY).slice(), 2),
                t = cleverapps.Random.chooseAmount(this.listTaskByDifficulty(DailyTask.MEDIUM).slice(), 2),
                s = cleverapps.Random.chooseAmount(this.listTaskByDifficulty(DailyTask.HARD).slice(), 1),
                e = e.concat(t).concat(s);
            return e.push(DailyTask.CreateCompleteAll()), e.map(function (e) {
                return new DailyTask.Create(e)
            })
        }, cleverapps.config.debugMode && (DailyTasks.GuessName = function (t) {
            return Object.keys(DailyTasks).find(function (e) {
                return DailyTasks[e] === t
            })
        }), DailyTasks.prototype.listTaskByDifficulty = function (e) {
            return this._generatedTasks || (
                this._generatedTasks = this.generateAllTasks()), this._generatedTasks[e]
        }, DailyTasks.prototype.generateAllTasks = function () {
            var s = [DailyTasks.COMPLETE_ALL],
                i = [
                    [],
                    [],
                    []
                ];
            return Object.keys(DailyTasks.CONFIG).forEach(function (e) {
                var t = +e;
                if (-1 !== s.indexOf(t)) return !1;
                e = DailyTasks.CONFIG[t].generate();
                void 0 !== e && (e = !Array.isArray(e) ? [e] : e).forEach(function (e) {
                    e.type = t, i[e.difficulty].push(e)
                })
            }), i
        }, DailyTasks.prototype.getStartTime = function () {
            var e = new Date,
                t = 1e3 * e.getTimezoneOffset() * 60;
            return e.getTime() - (e.getTime() - t) % DailyTasks.INTERVAL
        }, DailyTasks.prototype.startNewTasks = function () {
            this.tasks = this.pick5Pack(), this.whenStart = this.getStartTime(), this.save(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_TASKS_START)
        }, DailyTasks.prototype.getNotCollectedTasks = function () {
            return this.tasks.filter(function (e) {
                return e.isFinished() && !e.collected
            })
        }, DailyTasks.prototype.isAllTasksFinished = function () {
            return 0 === cleverapps.dailyTasks.getActiveTasks().length
        },
            DailyTasks.prototype.getActiveTasks = function () {
                return this.tasks.filter(function (e) {
                    return !e.isFinished()
                })
            }, DailyTasks.prototype.getFinishedTasks = function () {
                return this.tasks.filter(function (e) {
                    return e.isFinished()
                })
            }, DailyTasks.prototype.swapOutTask = function (e, t) {
                var s, i = this.tasks.indexOf(e);
                t || (e = this.listTaskByDifficulty(e.difficulty), s = this.tasks.map(function (e) {
                    return e.type
                }), e = e.filter(function (e) {
                    return -1 === s.indexOf(e.type)
                }), t = cleverapps.Random.choose(e)), this.tasks[i] = new DailyTask.Create(t), this.onTaskSwappedOut(i), this.save()
            }, DailyTasks.prototype.addProgress = function (t, s, i) {
                var e = this.getActiveTasks().filter(function (e) {
                    return e.type === t
                });
                0 !== e.length && (e = t === DailyTasks.SPEND_HARD ? [e[0]] : e).forEach(function (e) {
                    e.addProgress(s, i)
                })
            }, DailyTasks.prototype.getTimeLeft = function () {
                var e = DailyTasks.INTERVAL;
                return Math.max(0, this.whenStart + e - Date.now())
            }, DailyTasks.prototype.isAvailable = function (e) {
                return levels.user.checkAvailable(cleverapps.Availables.DAILY_TASKS, e)
            },
            DailyTasks.prototype.update = function () {
                clearTimeout(this.finishTimeout), this.isAvailable() && (0 === this.getTimeLeft() && (this._generatedTasks = void 0, this.startNewTasks()), this.finishTimeout = new cleverapps.LongTimeout(this.update.bind(this), this.getTimeLeft()), this.onChangeStateListener())
            }, DailyTasks.prototype.getTasks = function () {
                return this.tasks
            }, DailyTasks.prototype.processDiscoverWord = function (e) {
                cleverapps.unique(e.split("")).forEach(function (e) {
                    cleverapps.dailyTasks.addProgress(DailyTasks.GUESS_WORDS_WITH_LETTER, 1, {
                        letter: e
                    })
                }), 7 <= e.length && cleverapps.dailyTasks.addProgress(DailyTasks.GUESS_LONG_WORDS, 1)
            }, DailyTasks.prototype.processOpenCard = function (e) {
                "solitaire" === cleverapps.config.type && (this.addProgress(DailyTasks.COLLECT_CARDS_BY_VALUE, 1, {
                    cardValue: e.getRank()
                }), this.addProgress(DailyTasks.COLLECT_CARDS_BY_SUIT, 1, {
                    cardSuit: e.getSuit()
                }))
            }, DailyTasks.prototype.getCompleteAllTask = function () {
                return this.getTasks().filter(function (e) {
                    return e.type === DailyTasks.COMPLETE_ALL
                })[0]
            },
            DailyTasks.prototype.taskWasFinished = function (e) {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_TASK_FINISH_AMOUNT + this.getFinishedTasks().length), e.type !== DailyTasks.COMPLETE_ALL && this.addProgress(DailyTasks.COMPLETE_ALL), this.preparePush(), this.onChangeStateListener()
            }, DailyTasks.prototype.preparePush = function () {
                var e;
                this.getFinishedTasks().length < 2 || (0 < this.getActiveTasks().length && this.getTimeLeft() > DailyTasks.PUSH_UNTIL_RESET_TIME && (e = this.getTimeLeft() - DailyTasks.PUSH_UNTIL_RESET_TIME), cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.DAILY_TASKS_UNCOMPLETED, e))
            }, DailyTasks.prototype.onTaskEvent = function (e, t, s) {
                s = "object" == typeof t ? t : s, cleverapps.dailyTasks.addProgress(e, t = "number" != typeof t ? 1 : t, s)
            }, DailyTasks.prototype.onGameEvent = function (e, s) {
                if ("merge" === cleverapps.config.type) switch (e) {
                    case Merge.MINE:
                        var t = s.affected.getData();
                        t.source && t.mineable && cleverapps.dailyTasks.addProgress(DailyTasks.DESTROY_ENT);
                        break;
                    case Merge.COMPLETE_MINING:
                        s.task.energy && cleverapps.dailyTasks.addProgress(DailyTasks.USE_WORKER);
                        break;
                    case Merge.BUILD:
                        cleverapps.dailyTasks.addProgress(DailyTasks.USE_WORKER), cleverapps.dailyTasks.addProgress(DailyTasks.BUILD);
                        break;
                    case Merge.MERGE:
                        cleverapps.dailyTasks.addProgress(DailyTasks.MERGE, 1, {
                            mergeAmount: s.affected.length
                        }), s.affected.some(function (e) {
                            return "crystal" === e.code && e.isLast()
                        }) && cleverapps.dailyTasks.addProgress(DailyTasks.USE_RAINBOW);
                        break;
                    case Merge.HARVEST:
                        "fruit" === s.affected.getType() && cleverapps.dailyTasks.addProgress(DailyTasks.HARVEST_FRUITS);
                        break;
                    case Merge.PRIZE_HARVESTED:
                        !0 === s.affected.getData().chest && cleverapps.dailyTasks.addProgress(DailyTasks.OPEN_CHEST);
                        break;
                    case Merge.SPAWN:
                        function i(e, t) {
                            if (Array.isArray(s.affected)) {
                                t = s.affected.filter(t);
                                if (0 < t.length) return e.stage > t[0].stage
                            }
                        }
                        "fruit" === s.unit.getType() && s.unit.stage < 4 ? s.affected && (Array.isArray(s.affected) || -1 === ["chest", "fruit", "source"].indexOf(s.affected.getType())) || cleverapps.dailyTasks.addProgress(
                            DailyTasks.GROW_PLANT) : "source" === s.unit.getType() ? i(s.unit, function (e) {
                                return "source" === e.getType()
                            }) && cleverapps.dailyTasks.addProgress(DailyTasks.CREATE_SOURCE) : "wands" === s.unit.code && i(s.unit, function (e) {
                                return "wands" === e.code
                            }) && cleverapps.dailyTasks.addProgress(DailyTasks.MERGE_SOLDIERS);
                        break;
                    case Merge.OPENFOG:
                        cleverapps.dailyTasks.addProgress(DailyTasks.OPEN_FOG)
                }
            }, DailyTasks.INTERVAL = cleverapps.parseInterval(cleverapps.config.debugMode ? "10 minutes" : "1 day"), DailyTasks.PUSH_UNTIL_RESET_TIME = cleverapps.parseInterval("5 hours"), DailyTasks.PASS_LEVEL = 4, DailyTasks.WATCH_ADS = 7, DailyTasks.USE_MULTI_COLOR_CELL = 8, DailyTasks.USE_BOOSTER = 9, DailyTasks.COLLECT_COLOR_CELLS = 10, DailyTasks.SPEND_HARD = 13, DailyTasks.GUESS_WORDS_WITH_LETTER = 16, DailyTasks.COLLECT_HERO_CELLS = 24, DailyTasks.COLLECT_CARDS_BY_VALUE = 25, DailyTasks.COLLECT_CARDS_BY_SUIT = 26, DailyTasks.DESTROY_ENT = 28, DailyTasks.MAKE_ORDER = 29, DailyTasks.USE_RAINBOW = 30, DailyTasks.MERGE_SOLDIERS = 31, DailyTasks.HARVEST_FRUITS = 32,
            DailyTasks.USE_WORKER = 33, DailyTasks.OPEN_CHEST = 34, DailyTasks.COLLECT_PIXEL = 35, DailyTasks.MERGE = 36, DailyTasks.BUY_UNITS_SHOP_ITEMS = 37, DailyTasks.PLAY_MINESWEEPER = 38, DailyTasks.SPEND_SOFT = 39, DailyTasks.CREATE_SOURCE = 40, DailyTasks.COMPLETE_ALL = 41, DailyTasks.BUILD = 43, DailyTasks.GROW_PLANT = 44, DailyTasks.PASS_DAILY_CUP_LEVEL = 45, DailyTasks.PASS_LEVEL_HARD = 46, DailyTasks.GUESS_LONG_WORDS = 47, DailyTasks.GET_FULL_COMBO = 48, DailyTasks.USE_BOOSTER_BEFORE = 49, DailyTasks.PASS_KNOCKOUT = 50, DailyTasks.PLAY_MINI_GAME = 51, DailyTasks.ENERGY_LOTTERY = 52, DailyTasks.OPEN_FOG = 53, DailyTasks.FINISH_QUEST = 54, DailyTasks.USE_UP_INSTANT_WORKER = 55, DailyTasks.LEVEL_UP = 56, DailyTasks.FINISH_EXPEDITION = 57, DailyTasks.OPEN_STAR_CHEST = 58, DailyTasks.UPGRADE_HERO = 59, DailyTasks.CELL_COLORS = ["a", "b", "d"], DailyTasks.CARD_VALUES = ["j", "q", "k", "a"], DailyTasks.CONFIG = {}, DailyTasks.CONFIG[DailyTasks.WATCH_ADS] = {
                generate: function () {
                    if (cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED) && !cleverapps.paymentsHistory.isVIP()) return {
                        goal: cleverapps.Random.random(10, 15),
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_watch_ads_png"
            }, DailyTasks.CONFIG[DailyTasks.SPEND_SOFT] = {
                generate: function () {
                    if (cleverapps.config.soft) return {
                        goal: 35,
                        customReward: {
                            soft: 40
                        },
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_spend_coins_png"
            }, DailyTasks.CONFIG[DailyTasks.SPEND_HARD] = {
                generate: function () {
                    if (!1 !== cleverapps.config.soft) return {
                        customReward: {
                            hard: 18
                        },
                        goal: 15,
                        difficulty: DailyTask.EASY
                    };
                    var e = 50 * Math.floor(cleverapps.Random.random(500, 750) / 50);
                    return [{
                        goal: 200,
                        customReward: {
                            hard: 150
                        },
                        difficulty: DailyTask.EASY
                    }, {
                        goal: e,
                        customReward: {
                            hard: 50 * Math.floor(.75 * e / 50)
                        },
                        difficulty: DailyTask.HARD
                    }]
                },
                icon: "daily_task_icon_spend_gold_png"
            }, DailyTasks.CONFIG[DailyTasks.PASS_LEVEL] = {
                generate: function () {
                    if ("merge" !== cleverapps.config.type) return {
                        goal: cleverapps.Random.random(12, 15),
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_pass_level_png"
            }, DailyTasks.CONFIG[DailyTasks.PASS_LEVEL_HARD] = {
                generate: function () {
                    if (
                        "merge" !== cleverapps.config.type && !cleverapps.isKnockoutGame()) return {
                            goal: cleverapps.Random.random(3, 4),
                            difficulty: DailyTask.MEDIUM
                        }
                },
                icon: "daily_task_icon_hard_level_png"
            }, DailyTasks.CONFIG[DailyTasks.GUESS_WORDS_WITH_LETTER] = {
                generate: function () {
                    var e, t;
                    if ("board" === cleverapps.config.type && -1 === ["ko"].indexOf(cleverapps.settings.language)) return e = ["e", "o", "a"], t = ["p", "c", "t"], cleverapps.settings.language === cc.sys.LANGUAGE_RUSSIAN ? (e = ["е", "о", "а"], t = ["п", "с", "т"]) : cleverapps.settings.language === cc.sys.LANGUAGE_JAPANESE && (e = ["あ", "か", "ち"], t = ["は", "ラ", "わ"]), [{
                        letter: cleverapps.Random.choose(e),
                        goal: 5 * Math.floor(cleverapps.Random.random(50, 75) / 5),
                        difficulty: DailyTask.MEDIUM
                    }, {
                        letter: cleverapps.Random.choose(t),
                        goal: 5 * Math.floor(cleverapps.Random.random(125, 150) / 5),
                        difficulty: DailyTask.HARD
                    }]
                }
            }, DailyTasks.CONFIG[DailyTasks.COLLECT_CARDS_BY_VALUE] = {
                generate: function () {
                    if ("solitaire" === cleverapps.config.type) return {
                        goal: 5 * Math.floor(cleverapps.Random.random(25, 50) / 5),
                        difficulty: DailyTask.HARD,
                        cardValue: cleverapps.Random.choose(DailyTasks.CARD_VALUES)
                    }
                },
                icon: {
                    j: "daily_task_icon_cards_by_value_j_png",
                    q: "daily_task_icon_cards_by_value_q_png",
                    k: "daily_task_icon_cards_by_value_k_png",
                    a: "daily_task_icon_cards_by_value_a_png"
                }
            }, DailyTasks.CONFIG[DailyTasks.COLLECT_CARDS_BY_SUIT] = {
                generate: function () {
                    if ("solitaire" === cleverapps.config.type) return {
                        goal: 5 * Math.floor(cleverapps.Random.random(50, 75) / 5),
                        difficulty: DailyTask.MEDIUM,
                        cardSuit: cleverapps.Random.choose(Card.SUITS)
                    }
                },
                icon: {
                    c: "daily_task_icon_cards_by_suit_c_png",
                    d: "daily_task_icon_cards_by_suit_d_png",
                    h: "daily_task_icon_cards_by_suit_h_png",
                    s: "daily_task_icon_cards_by_suit_s_png"
                }
            }, DailyTasks.CONFIG[DailyTasks.GET_FULL_COMBO] = {
                generate: function () {
                    if ("solitaire" === cleverapps.config.type) return {
                        goal: 30,
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_full_combo_png"
            }, DailyTasks.CONFIG[DailyTasks.USE_MULTI_COLOR_CELL] = {
                generate: function () {
                    if ("match3" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(25, 30),
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_multi_color_cell_png"
            }, DailyTasks.CONFIG[DailyTasks.USE_BOOSTER] = {
                generate: function () {
                    if (0 !== cleverapps.boosters.listBoosters().length) return {
                        goal: cleverapps.Random.random(3, 5),
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_use_booster_png"
            }, DailyTasks.CONFIG[DailyTasks.USE_BOOSTER_BEFORE] = {
                generate: function () {
                    if (0 !== cleverapps.boosters.listBoostersBefore().length) return {
                        goal: cleverapps.Random.random(3, 5),
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_booster_before_png"
            }, DailyTasks.CONFIG[DailyTasks.COLLECT_COLOR_CELLS] = {
                generate: function () {
                    var t;
                    if ("match3" === cleverapps.config.type) return t = cleverapps.Random.choose(DailyTasks.CELL_COLORS), [{
                        goal: 100 * Math.floor(cleverapps.Random.random(500, 1e3) / 100),
                        difficulty: DailyTask.MEDIUM,
                        color: t
                    }, {
                        goal: 100 * Math.floor(cleverapps.Random.random(2500, 3e3) / 100),
                        difficulty: DailyTask.HARD,
                        color: cleverapps.Random.choose(DailyTasks.CELL_COLORS.filter(function (e) {
                            return e !== t
                        }))
                    }]
                },
                icon: {
                    a: "daily_task_icon_color_cells_a_png",
                    b: "daily_task_icon_color_cells_b_png",
                    d: "daily_task_icon_color_cells_d_png"
                }
            }, DailyTasks.CONFIG[DailyTasks.COLLECT_HERO_CELLS] = {
                generate: function () {
                    if ("match3" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(25, 30),
                        difficulty: DailyTask.HARD,
                        color: cleverapps.Random.choose(DailyTasks.CELL_COLORS)
                    }
                },
                icon: {
                    a: "daily_task_icon_hero_cells_a_png",
                    b: "daily_task_icon_hero_cells_b_png",
                    d: "daily_task_icon_hero_cells_d_png"
                }
            }, DailyTasks.CONFIG[DailyTasks.DESTROY_ENT] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(3, 4),
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_destroy_ent_png"
            }, DailyTasks.CONFIG[DailyTasks.MAKE_ORDER] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: 3,
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_make_order_png"
            }, DailyTasks.CONFIG[DailyTasks.USE_RAINBOW] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(1, 2),
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_use_rainbow_png"
            }, DailyTasks.CONFIG[DailyTasks.MERGE_SOLDIERS] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(10, 15),
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_merge_soldiers_png"
            }, DailyTasks.CONFIG[DailyTasks.HARVEST_FRUITS] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(30, 40),
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_harvest_fruit_png"
            }, DailyTasks.CONFIG[DailyTasks.USE_WORKER] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(25, 50),
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_use_worker_png"
            }, DailyTasks.CONFIG[DailyTasks.OPEN_CHEST] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(20, 30),
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_open_chest_png"
            },
            DailyTasks.CONFIG[DailyTasks.COLLECT_PIXEL] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(40, 55),
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_collect_pixel_png"
            }, DailyTasks.CONFIG[DailyTasks.MERGE] = {
                generate: function () {
                    var e, t;
                    if ("merge" === cleverapps.config.type) return e = cleverapps.Random.choose([9, 17]), t = cleverapps.Random.random(5, 10), {
                        mergeAmount: e,
                        goal: t = 17 === e ? cleverapps.Random.random(3, 4) : t,
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_merge_png"
            }, DailyTasks.CONFIG[DailyTasks.BUY_UNITS_SHOP_ITEMS] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(1, 2),
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_units_shop_png"
            }, DailyTasks.CONFIG[DailyTasks.PLAY_MINESWEEPER] = {
                generate: function () {
                    if ("mergecraft" === cleverapps.config.name) return {
                        goal: cleverapps.Random.random(2, 3),
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_minesweeper_png"
            }, DailyTasks.CONFIG[DailyTasks.CREATE_SOURCE] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(10, 15),
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_create_source_png"
            }, DailyTasks.CONFIG[DailyTasks.ENERGY_LOTTERY] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type && cleverapps.user.level <= 8 && Game.currentGame && Game.currentGame.energyLottery && Game.currentGame.energyLottery.isAvailable()) return {
                        goal: 1,
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_energy_lottery_png"
            }, DailyTasks.CONFIG[DailyTasks.OPEN_FOG] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type && cleverapps.user.level <= 8) return {
                        goal: 1,
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_open_fog_png"
            }, DailyTasks.CONFIG[DailyTasks.FINISH_QUEST] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type && cleverapps.user.level <= 8) return {
                        goal: cleverapps.Random.random(3, 5),
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_finish_quest_png"
            }, DailyTasks.CONFIG[DailyTasks.USE_UP_INSTANT_WORKER] = {
                generate: function () {
                    if (
                        "merge" === cleverapps.config.type && cleverapps.user.level <= 8) return {
                            goal: 1,
                            difficulty: DailyTask.HARD
                        }
                },
                icon: "daily_task_icon_instant_worker_png"
            }, DailyTasks.CONFIG[DailyTasks.BUILD] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(50, 65),
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_build_png"
            }, DailyTasks.CONFIG[DailyTasks.GROW_PLANT] = {
                generate: function () {
                    if ("merge" === cleverapps.config.type) return {
                        goal: cleverapps.Random.random(85, 100),
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_grow_plant_png"
            }, DailyTasks.CONFIG[DailyTasks.PASS_DAILY_CUP_LEVEL] = {
                generate: function () {
                    if (cleverapps.dailyCup.isAvailable()) return {
                        goal: cleverapps.Random.random(2, 3),
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_daily_cup_png"
            }, DailyTasks.CONFIG[DailyTasks.GUESS_LONG_WORDS] = {
                generate: function () {
                    if ("board" === cleverapps.config.type) return {
                        goal: 20,
                        difficulty: DailyTask.HARD
                    }
                },
                icon: "daily_task_icon_long_words_png"
            },
            DailyTasks.CONFIG[DailyTasks.PASS_KNOCKOUT] = {
                generate: function () {
                    if (cleverapps.isKnockoutGame()) return {
                        goal: 1,
                        difficulty: DailyTask.MEDIUM
                    }
                },
                icon: "daily_task_icon_knockout_png"
            }, DailyTasks.CONFIG[DailyTasks.PLAY_MINI_GAME] = {
                generate: function () {
                    if (void 0 !== bundles.dailytasks.frames.daily_task_icon_mini_game_png) return {
                        goal: 1,
                        difficulty: DailyTask.EASY
                    }
                },
                icon: "daily_task_icon_mini_game_png"
            }, DailyTasks.CONFIG[DailyTasks.COMPLETE_ALL] = {
                icon: "daily_task_icon_complete_all_png"
            }, Window.extend({
                onWindowLoaded: function () {
                    this.showMenubar(), this.createContent(), this._super({
                        name: "dailytaskswindow",
                        title: cleverapps.dailyTasks.isAllTasksFinished() ? "DailyTasksWindow.finished.title" : "DailyTasksWindow.title",
                        content: this.content,
                        foreground: bundles.windows.frames.window_foreground_png,
                        noPadding: !0
                    }), this.tabs.activateTab("tasks"), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_TASKS_OPEN_WINDOW), cleverapps.playSession.set(cleverapps.EVENTS.SESSION_DAILY_TASK_OPEN_WINDOW, !0)
                },
                getPerson: function () {
                    return "merge" === cleverapps.config.type && (cleverapps.unitsLibrary.getActiveHero() || "dwarf")
                },
                showMenubar: function () {
                    var t;
                    "merge" === cleverapps.config.type && (t = [], cleverapps.dailyTasks.tasks.forEach(function (e) {
                        new RewardsList(e.getReward()).rewards.forEach(function (e) {
                            e.listControls().forEach(function (e) {
                                -1 === t.indexOf(e) && t.push(e)
                            })
                        })
                    }), cleverapps.meta.showControlsWhileFocused(t))
                },
                onClose: function () {
                    var e = cleverapps.dailyTasks.getCompleteAllTask();
                    e && e.isFinished() && !e.collected && e.givePrize()
                },
                createTabs: function () {
                    var e = function (e) {
                        e = new e(this);
                        return this.content.addChild(e), e.setPositionRound(e.width / 2, e.height / 2), e
                    }.bind(this);
                    this.dailyTasksTab = e(DailyTasksTab), this.tabsInfo = {
                        tasks: {
                            content: this.dailyTasksTab,
                            icon: bundles.tabs.frames.dailytasks_icon
                        }
                    }, DailyTasksWindow.HasAchievements() && (this.tabsInfo.achievements = {
                        content: e(AchievementsTab),
                        icon: bundles.tabs.frames.achievements_icon
                    })
                },
                createContent: function () {
                    var e = cleverapps.styles.DailyTasksWindow,
                        t = this.content = new cc.Node,
                        s = (t.setAnchorPoint2(), this.createTabs(), t.setContentSize2(this.dailyTasksTab.getContentSize()), this.tabs = new Tabs(this.tabsInfo, e.tabs));
                    t.addChild(s), s.setPositionRound(e.tabs), s.setVisible(1 < Object.keys(this.tabsInfo).length)
                },
                showHint: function (e) {
                    this.minimal && (this.stopAction(this.minimalAction), this.minimal.remove()), this.minimal = new MinimalDialogue({
                        delay: 0,
                        text: e,
                        rects: this.getMinimalDialogueRects()
                    }), this.addChild(this.minimal), this.minimal.display(), this.minimalAction = this.runAction(new cc.Sequence(new cc.DelayTime(2), new cc.CallFunc(function () {
                        this.minimal.remove(), delete this.minimal
                    }.bind(this))))
                },
                listBundles: function () {
                    return ["dailytasks"]
                }
            })),
        DailyTasksTab = (DailyTasksWindow.HasAchievements = function () {
            return cleverapps.achievements && cleverapps.config.debugMode
        }, cleverapps.styles.DailyTasksWindow = {
            tabs: {
                height: 130,
                direction: cleverapps.UI.VERTICAL,
                x: {
                    align: "left",
                    dx: -115
                },
                y: {
                    align: "top",
                    dy: -85
                }
            }
        }, cleverapps.Layout.extend({
            ctor: function (e) {
                var t = [],
                    s = cleverapps.styles.DailyTasksTab,
                    i = "tropical" === cleverapps.config.ui && "merge" === cleverapps.config.type,
                    e = new DailyTaskTimer(e.close.bind(e), i);
                i || t.push(cleverapps.UI.wrapWithPadding(e, s.timer.padding)), t.push(new DailyTasksCompleteAllView(i && e)), t.push(this.createScroll()), cleverapps.dailyTasks.onTaskSwappedOut = this.createListener(this.animateSwapOut.bind(this)), this._super(t, {
                    direction: cleverapps.UI.VERTICAL,
                    margin: s.margin,
                    padding: s.padding
                })
            },
            createScroll: function () {
                var e, t = cleverapps.styles.DailyTasksTab,
                    s = this.createTasks(),
                    i = this.scroll = new cleverapps.UI.ScrollView(s);
                return i.setContentSize2(s.width + 2 * t.scroll.paddingX, t.scroll.height), i.setBarPadding(t.scrollBarPadding), bundles.dailytasks.frames.foreground_png && (s = cleverapps.UI.createScale9Sprite(bundles.dailytasks.frames.foreground_png), e = "merge" === cleverapps.config.type, s.setContentSize2((e ? t.foreground.wide : t.foreground).width, t.foreground.height), i.addChild(s), s.setPositionRound(t.foreground)), i
            },
            createTasks: function () {
                var t = this.taskViews = [],
                    e = (cleverapps.dailyTasks.getTasks().filter(function (e) {
                        return e.type !== DailyTasks.COMPLETE_ALL
                    }).forEach(function (e) {
                        e = new DailyTaskView(e);
                        t.push(e)
                    }, this), cleverapps.styles.DailyTasksTab.tasks),
                    e = new cleverapps.Layout(t, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.margin,
                        padding: e.padding
                    });
                return e.visibilityCheckList = t, e
            },
            onSelectTab: function () {
                cleverapps.dailyTasks.collectLastTask(), this.wasAnimated || (this.wasAnimated = !0, this.scroll.scrollTo(cleverapps.UI.ScrollView.SCROLLS.LOWER_RIGHT), this.runAction(new cc.Sequence(new cc.DelayTime(.55), new cc.CallFunc(function () {
                    for (var e = 0, t = 0; t < this.taskViews.length; t++) {
                        var s = this.taskViews[t].task;
                        if (s.isFinished() && !s.collected) {
                            e = t;
                            break
                        }
                    }
                    0 === e ? this.scroll.scrollTo(cleverapps.UI.ScrollView.SCROLLS.UPPER_LEFT, 1, {
                        easing: cc.easeBackInOut()
                    }) : e === this.taskViews.length - 1 ? this.scroll.scrollTo(cleverapps.UI.ScrollView.SCROLLS.LOWER_RIGHT, 1, {
                        easing: cc.easeBackInOut()
                    }) : this.scroll.runAction(new cc.ScrollAction(
                        this.taskViews[e], {
                        duration: 1,
                        visibleBox: {
                            top: .6,
                            bottom: .6
                        }
                    }).easing(cc.easeBackInOut()))
                }.bind(this)))))
            },
            animateSwapOut: function (e) {
                var t = this.taskViews[e],
                    s = t.getPosition(),
                    i = new DailyTaskView(cleverapps.dailyTasks.tasks[e]);
                t.parent.addChild(i), i.setPosition(s.x, s.y + .8 * i.height), i.setOpacity(0), i.setScale(1.02), i.runAction(new cc.Sequence(new cc.DelayTime(.4), new cc.Spawn(new cc.MoveTo(.4, s), new cc.FadeIn(.4), new cc.Sequence(new cc.DelayTime(.3), new cc.ScaleTo(.2, 1))))), t.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.035), new cc.DelayTime(.05), new cc.Spawn(new cc.FadeOut(.5), new cc.ScaleTo(.5, .85), new cc.MoveBy(.5, 0, -200)), new cc.RemoveSelf)), this.taskViews.splice(e, 1, i)
            }
        })),
        DailyTaskTimer = (cleverapps.styles.DailyTasksTab = {
            margin: 0,
            padding: {
                x: 20,
                top: 140,
                bottom: 50
            },
            scroll: {
                paddingX: 20,
                height: 590
            },
            scrollBarPadding: {
                sidePadding: 8
            },
            timer: {
                padding: {
                    x: 0,
                    y: 0
                }
            },
            foreground: {
                width: 698,
                wide: {
                    width: 698
                },
                height: 594,
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            tasks: {
                margin: 15,
                padding: {
                    x: 0,
                    y: 20
                }
            }
        }, cleverapps.Layout.extend({
            ctor: function (e, t) {
                var s = cleverapps.styles.DailyTaskTimer,
                    t = cleverapps.UI.generateOnlyText("DailyTasksWindow.TimeToRefresh", t ? cleverapps.styles.FONTS.DAILY_TASK_CTA : cleverapps.styles.FONTS.WINDOW_TEXT),
                    e = (t.fitTo(s.text.width), new Timer(cleverapps.dailyTasks.getTimeLeft(), e));
                this._super([t, e], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: s.margin,
                    padding: s.padding
                }), this.setCascadeOpacityEnabled(!0), e.setCascadeOpacityEnabled(!0), e.y += s.offsetY
            }
        })),
        DailyTaskView = (cleverapps.styles.DailyTaskTimer = {
            margin: 20,
            offsetY: 0,
            text: {
                width: 450
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.isWide = "merge" === cleverapps.config.type, this.task = e, this.setAnchorPoint2();
                var e = cleverapps.styles.DailyTaskView,
                    t = (this.icon = this.createIcon(), this.title = this.createTitle(), this.rewards = this.createRewards(), new cleverapps.Layout([this.title, this.rewards], {
                        direction: cleverapps.UI.VERTICAL,
                        align: cleverapps.UI.ALIGN_START
                    })),
                    s = new cc.Node,
                    t = (s.setAnchorPoint2(),
                        s.setContentSize((this.isWide ? e.titleAndRewards.wide : e.titleAndRewards).width, e.titleAndRewards.height), s.addChild(t), t.setPositionRound(e.titleAndRewards), this.createProgressBlock()),
                    s = [this.icon, s, t];
                this.content = new cleverapps.Layout(s, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin,
                    padding: e.padding
                }), this.addChild(this.content), this.background = this.createBackground(), this.setContentSize2(this.background.getContentSize()), this.background.setPositionRound(this.width / 2, this.height / 2), this.content.setPositionRound(this.width / 2, this.height / 2), this.createSwapButton(), this.setCascadeOpacityEnabledRecursively(!0), this.onUpdate(), this.task.on("update", this.onUpdate.bind(this), this)
            },
            createProgressBlock: function () {
                var e = cleverapps.styles.DailyTaskView,
                    t = new cc.Node;
                return t.setAnchorPoint2(), t.setContentSize2(e.progressBlock), this.progressBar = this.createProgressBar(), this.progressBar.setAnchorPoint2(), t.addChild(this.progressBar), this.progressBar.setPositionRound(t.width / 2, t.height / 2),
                    this.check = new cc.Sprite(bundles.dailytasks.frames.daily_task_mark_png), t.addChild(this.check), this.check.setPositionRound(t.width / 2, t.height / 2), this.rewardButton = new cleverapps.UI.Button({
                        width: e.button.width,
                        height: e.button.height,
                        type: cleverapps.styles.UI.Button.Images.small_button_green,
                        text: "DailyTaskView.Get",
                        onClicked: this.onRewardButtonClick.bind(this)
                    }), this.rewardButton.setCascadeOpacityEnabled(!0), this.rewardButton.setLocalZOrder(1), t.addChild(this.rewardButton), this.rewardButton.setPositionRound(t.width / 2, t.height / 2), t
            },
            createBackground: function () {
                var e = cleverapps.UI.createScale9Sprite(bundles.dailytasks.frames.daily_task_bg_png);
                return e.setContentSize2(this.content.getContentSize()), this.addChild(e, -1), e
            },
            onRewardButtonClick: function () {
                this.task.isFinished() && !this.task.collected && ("merge" === cleverapps.config.type ? (this.rewardsList.receiveRewards(), this.rewardsList.receiveRewardsAnimation({
                    noFadeOut: !0,
                    callback: cleverapps.dailyTasks.collectLastTask
                }),
                    cleverapps.dailyTasks.collect(this.task)) : this.task.givePrize())
            },
            createProgressBar: function () {
                var e = cleverapps.styles.DailyTaskView,
                    t = new ScaledProgressBar({
                        progress: bundles.progress_bar.frames.bar_dailytask,
                        background: bundles.progress_bar.frames.bg_dailytask,
                        progressFrames: e.progressBar.progressFrames,
                        barText: {
                            text: this.task.progress + "/" + this.task.goal,
                            font: cleverapps.styles.FONTS.DAILY_TASK_PROGRESS_FONT,
                            dy: e.progressBar.text.dy
                        }
                    });
                return t.setAnchorPoint2(0, 0), t.setLength(e.progressBar.width), t.setPercentage(0), t
            },
            createRewards: function () {
                var e = this.task.getReward(),
                    t = cleverapps.styles.DailyTaskView,
                    s = cleverapps.UI.generateOnlyText("RewardsListComponent.rewardTitle", cleverapps.styles.FONTS.DAILY_TASK_REWARD_FONT || cleverapps.styles.FONTS.WINDOW_SMALL_TEXT),
                    e = this.rewardsList = new RewardsListComponent(e, {
                        font: cleverapps.styles.FONTS.DAILY_TASK_REWARD_FONT || cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,
                        margin: t.reward.margin,
                        noPrefix: !0,
                        textDirection: cleverapps.UI.HORIZONTAL,
                        textMargin: t.reward.textMargin,
                        small: !0,
                        noShowControls: !0
                    }),
                    s = new cleverapps.Layout([s, e], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: t.reward.margin.x
                    });
                return cleverapps.UI.fitToBox(s, {
                    width: (this.isWide ? t.titleAndRewards.wide : t.titleAndRewards).width,
                    height: t.titleAndRewards.height
                }), s
            },
            createTitle: function () {
                var e = cleverapps.styles.DailyTaskView,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2((this.isWide ? e.title.wide : e.title).width, e.title.height), t.setCascadeOpacityEnabled(!0), this.task.getTitle()),
                    s = cleverapps.UI.generateOnlyText(s.text, cleverapps.styles.FONTS.DAILY_TASK_FONT || cleverapps.styles.FONTS.WINDOW_SMALL_TEXT, s.replace);
                return s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT), s.setDimensions((this.isWide ? e.title.wide : e.title).textWidth, 0), s.fitTo(void 0, t.height), s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT), t.addChild(s), s.setPositionRound(s.width / 2, t.height / 2), t
            },
            createIcon: function () {
                var e = cleverapps.styles.DailyTaskView.icon,
                    t = new cc.Node,
                    s = (
                        t.setAnchorPoint2(), this.task.getIcon()),
                    i = cleverapps.UI.createScale9Sprite(bundles.dailytasks.frames.daily_task_icon_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY);
                return e.bg && i.setContentSize2((this.isWide ? e.bg.wide : e.bg).width, e.bg.height), t.addChild(i), t.setContentSize2(i.getContentSize()), i.setPositionRound(t.width / 2, t.height / 2), bundles.dailytasks.frames.daily_task_icon_frame_png && ((i = this.iconFrame = new cc.Scale9Sprite(bundles.dailytasks.frames.daily_task_icon_frame_png)).setPositionRound(t.width / 2, t.height / 2), t.addChild(i), i.setContentSize2(e.frame)), s.setPositionRound(t.width / 2, t.height / 2), t.addChild(s), t.setCascadeOpacityEnabled(!0), t
            },
            updateProgress: function () {
                this.progressBar.setPercentage(this.task.progress / this.task.goal * 100), this.progressBar.updateBarText(this.task.progress + "/" + this.task.goal)
            },
            onUpdate: function () {
                this.rewardButton.setVisible(!this.task.collected && !this.task.expired && this.task.isFinished());
                var e = cleverapps.styles.DailyTaskView;
                this.iconFrame && (
                    this.iconFrame.setSpriteFrame(new cc.Sprite(this.task.isFinished() ? bundles.dailytasks.frames.daily_task_icon_frame_completed_png : bundles.dailytasks.frames.daily_task_icon_frame_png).getSpriteFrame()), this.iconFrame.setContentSize2(e.icon.frame)), this.check && (this.check.visible = this.task.isFinished() && this.task.collected), this.updateProgress(), this.task.isFinished() && (this.progressBar.setVisible(!1), this.swapBtn && (this.swapBtn.removeFromParent(), delete this.swapBtn), this.task.collected && (bundles.dailytasks.frames.daily_task_bg_completed_png && this.background.setSpriteFrame(new cc.Sprite(bundles.dailytasks.frames.daily_task_bg_completed_png).getSpriteFrame()), [this.icon, this.background, this.title, this.rewards].forEach(function (e) {
                        e.setOpacity(140)
                    })))
            },
            createSwapButton: function () {
                var e;
                this.task.isSwappable() && !this.task.isFinished() && (e = cleverapps.styles.DailyTaskView, this.swapBtn = new DailytaskSwapButton(this.task, this.isWide), this.content.addChild(this.swapBtn),
                    this.isWide ? this.swapBtn.setPositionRound(e.swapButton.wide) : this.swapBtn.setPositionRound(e.swapButton))
            }
        })),
        DailytaskSwapButton = (cleverapps.styles.DailyTaskView = {
            margin: 10,
            padding: {
                left: 10,
                right: 40,
                y: 10
            },
            titleAndRewards: {
                width: 394,
                height: 138,
                x: {
                    align: "left"
                },
                y: {
                    align: "center"
                },
                wide: {
                    width: 606
                }
            },
            content: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            reward: {
                margin: {
                    x: 10
                },
                textMargin: 0
            },
            progressBlock: {
                width: 230,
                height: 35
            },
            icon: {
                x: {
                    align: "left",
                    dx: 25
                },
                y: {
                    align: "center",
                    dy: 0
                },
                frame: {
                    width: 142,
                    height: 142
                }
            },
            title: {
                width: 300,
                textWidth: 300,
                wide: {
                    width: 606,
                    textWidth: 540
                },
                height: 80
            },
            button: {
                width: 168,
                height: 80
            },
            swapButton: {
                wide: {
                    x: {
                        align: "right",
                        dx: -275
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                },
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "top",
                    dy: 0
                }
            },
            progressBar: {
                width: 230,
                text: {
                    dy: 0
                }
            }
        }, cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.setAnchorPoint2(), this.setContentSize2(cleverapps.styles.DailytaskSwapButton), this.task = e, this.isWide = t, this.createButton(), this.createTooltip(), cleverapps.UI.applyHover(this, {
                    onMouseOver: this.onMouseOver.bind(this),
                    onMouseOut: this.onMouseOut.bind(this)
                })
            },
            createTooltip: function () {
                var e = cleverapps.styles.DailytaskSwapButton.tooltip,
                    t = this.tooltip = new cc.Scale9Sprite(bundles.tooltip.frames.tooltip_bg_png),
                    s = (t.setContentSize2(e), this.isWide ? t.setPositionRound(this.width / 2, -t.height / 2) : t.setPositionRound(this.width - t.width / 2, -t.height / 2), this.addChild(t), cleverapps.UI.generateOnlyText("DailyTasksWindow.swapTooltip", cleverapps.styles.FONTS.TOOLTIP_TEXT));
                s.fitTo(t.width - e.padding), t.addChild(s), s.setPositionRound(t.width / 2, t.height / 2), t.setVisible(!1)
            },
            createButton: function () {
                this.isWide ? this.button = new cleverapps.UI.Button({
                    width: cleverapps.styles.DailytaskSwapButton.width,
                    height: cleverapps.styles.DailytaskSwapButton.height,
                    content: new cc.Sprite(bundles.dailytasks.frames.swap_task_icon),
                    type: cleverapps.styles.UI.Button.Images.small_button_blue,
                    onClicked: this.onClicked.bind(this)
                }) : (this.button = new cc.Sprite(bundles.dailytasks.frames.swap_task_icon),
                    cleverapps.UI.onClick(this.button, this.onClicked.bind(this)), cleverapps.UI.applyHover(this.button), this.button.applyInteractiveScale()), this.addChild(this.button), this.button.setPositionRound(this.width / 2, this.height / 2)
            },
            onClicked: function () {
                cleverapps.dailyTasks.swapOutTask(this.task), this.tooltip.removeFromParent(), delete this.tooltip, this.button.removeFromParent(), delete this.button
            },
            onMouseOver: function () {
                this.tooltip && this.tooltip.setVisible(!0)
            },
            onMouseOut: function () {
                this.tooltip && this.tooltip.setVisible(!1)
            }
        })),
        DailyTasksCompleteAllView = (cleverapps.styles.DailytaskSwapButton = {
            width: 70,
            height: 60,
            tooltip: {
                width: 300,
                height: 60,
                padding: 50
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.timer = e, this.setAnchorPoint2(), this.task = cleverapps.dailyTasks.getCompleteAllTask();
                e = cleverapps.UI.createScale9Sprite(bundles.dailytasks.frames.complete_all_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY);
                this.addChild(e), this.content = this.createContent(), this.addChild(this.content),
                    e.setContentSize2(this.content.getContentSize()), this.setContentSize2(e.getContentSize()), e.setPositionRound(this.width / 2, this.height / 2), this.content.setPositionRound(this.width / 2, this.height / 2), this.setLocalZOrder(1), this.onUpdate(), this.task.on("update", this.onUpdate.bind(this), this)
            },
            createContent: function () {
                var e = cleverapps.styles.DailyTasksCompleteAllView,
                    t = this.createTextLayout(),
                    s = this.task.getIcon();
                return new cleverapps.Layout([s, t], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin,
                    padding: e.padding,
                    align: e.align
                })
            },
            createTextLayout: function () {
                var e = cleverapps.styles.DailyTasksCompleteAllView,
                    t = [],
                    s = this.createText();
                return t.push(s), this.timer && t.push(this.timer), this.prize = new PrizeBarComponent({
                    currentValue: this.task.progress,
                    goalValue: this.task.goal,
                    collected: this.task.collected,
                    reward: "merge" !== cleverapps.config.type && this.task.getReward(),
                    width: e.textLayout.width,
                    onCollect: this.task.givePrize.bind(this.task)
                }), t.push(this.prize), new cleverapps.Layout(t, {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.textLayout.margin,
                    padding: e.textLayout.padding
                })
            },
            createText: function () {
                var e = cleverapps.styles.DailyTasksCompleteAllView,
                    t = cleverapps.UI.generateOnlyText("DailyTasksWindow.CTA", cleverapps.styles.FONTS.DAILY_TASK_CTA || cleverapps.styles.FONTS.WINDOW_TEXT);
                return t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(e.textLayout.width, 0), t.fitTo(void 0, e.textLayout.height), t
            },
            onUpdate: function () {
                this.prize.updateProgress(this.task.progress, this.task.goal), this.task.collected && this.prize.setCollected()
            }
        })),
        PassLevelsConfig = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            DAILY_TASKS_BAR: {
                name: "default",
                size: 35
            }
        }), cleverapps.styles.DailyTasksCompleteAllView = {
            margin: 30,
            padding: {
                left: 75,
                right: 110,
                top: 15,
                bottom: 30
            },
            align: cleverapps.UI.ALIGN_CENTER,
            textLayout: {
                width: "merge" === cleverapps.config.type ? 700 : 400,
                height: 90,
                margin: 40,
                padding: {
                    bottom: 30
                }
            },
            prize: {
                x: {
                    align: "right",
                    dx: -100
                },
                y: {
                    align: "bottom",
                    dy: -24
                }
            },
            mark: {
                x: {
                    align: "right",
                    dx: 75
                },
                y: {
                    align: "center"
                }
            }
        }, {}),
        PassMissionLogic = function (e, t) {
            this.mission = e, this.onShowWindowListeners = {}, this.onUpdateListeners = {}, this.onLevelChangedListeners = {}, this.onProgressChangedListeners = {};
            var s = this.mission.view.LEVELS,
                i = Mission.GetParentType(e.type),
                n = (PassLevelsConfig[i] && (s = PassLevelsConfig[i]), 0);
            this.levels = s.map(function (e, t) {
                n += e.task.goal;
                t = Object.assign({
                    level: t
                }, e);
                return t.task.goalTotal = n, t
            }), this.load(this.mission.details), this.checkComplete() && this.mission.complete(), this.shownAvailableRewards = 0, Game.currentGame && Game.currentGame.bpPointsPlanner && (Game.currentGame.bpPointsPlanner.removeWrongPoints(!0), t && Game.currentGame.bpPointsPlanner.start()), Mission.GetChildType(e.type) === Mission.TYPE_EXPEDITION_PASS && cleverapps.eventBus.on("gameEvent", this.onGameEvent.bind(this), this), this.mission.onChangeResults = this.runListeners.bind(this, this.onUpdateListeners), this.onAnimateAmountChange = function () { }, this.onNextAmountStep = function () { }, this.onAnimateProgressChange = function () { }, this.onNextProgressStep = function () { }, this.onShowFinger = function () { }
        },
        PassRewardIcon = (PassMissionLogic.prototype.runListeners = function (e) {
            for (var t in e) {
                t = e[t];
                t && t()
            }
        }, PassMissionLogic.prototype.showProgress = function () {
            var e;
            this.isAllProgressShown() ? this.onShowFinger() : (e = this.shownProgress.level >= this.progress.level ? {
                level: this.progress.level,
                progress: this.progress.progress
            } : {
                level: this.shownProgress.level,
                progress: this.levels[this.shownProgress.level].task.goal
            }, this.onAnimateAmountChange(this.shownProgress, e, this.levels[this.shownProgress.level].task.goal), this.onAnimateProgressChange(e, function () {
                if (this.shownProgress.level >= this.progress.level) return this.shownProgress = e, this.saveProgress(), void this.showProgress();
                e = {
                    level: this.shownProgress.level + 1,
                    progress: 0
                }, this.onNextAmountStep(e), this.onNextProgressStep(this.shownProgress.level, function () {
                    this.shownProgress = e, this.saveProgress(), this.runListeners(this.onLevelChangedListeners), this.showProgress()
                }.bind(this))
            }.bind(
                this)))
        }, PassMissionLogic.prototype.checkComplete = function () {
            return this.isAllTasksCompleted() && this.hasPremium() && 0 === this.countAvailableRewards()
        }, PassMissionLogic.prototype.saveProgress = function () {
            this.mission.details = this.getInfo(), this.mission.update(0, this.getInfo())
        }, PassMissionLogic.prototype.load = function (e) {
            function t(e) {
                return e.reduce(function (e, t) {
                    return e | 1 << t
                }, 0)
            }
            this.premium = e.premium || e.boughtPremium || void 0, this.rewards = e.rewards || 0, this.premiumRewards = e.premiumRewards || 0, this.progress = e.progress || 0, Array.isArray(e.levelsToReward) && (this.rewards = t(e.levelsToReward)), Array.isArray(e.levelsToPremReward) && (this.premiumRewards = t(e.levelsToPremReward)), e.currentTask && (i = Math.min(e.currentTask.level || 0, this.levels.length - 1), s = e.currentTask.progress || 0, this.progress = this.levels[i].task.goalTotal - this.levels[i].task.goal + s), this.shownProgress = e.shownProgress || this.progress, this.progress = this._extract(this.progress), this.shownProgress = this._extract(this.shownProgress);
            var s,
                i = (1 << this.progress.level) - 1;
            this.rewards &= i, this.premiumRewards &= i
        }, PassMissionLogic.prototype.getInfo = function () {
            return {
                premium: this.premium,
                rewards: this.rewards,
                premiumRewards: this.premiumRewards,
                progress: this._compact(this.progress),
                shownProgress: this._compact(this.shownProgress)
            }
        }, PassMissionLogic.prototype.completeCurrentTask = function () {
            this.progress.level < this.levels.length && this.addProgress(this.levels[this.progress.level].task.goal - this.progress.progress)
        }, PassMissionLogic.prototype.takeLevelReward = function (e, t) {
            if (this.hasReward(e, t)) {
                var s = t ? this.levels[e].premiumReward : this.levels[e].reward;
                if (s.unit && "merge" === cleverapps.config.type && !cleverapps.travelBook.isExpedition()) {
                    var i = cleverapps.toArray(s.unit).reduce(function (e, t) {
                        return e + t.amount
                    }, 0) - Game.currentGame.map.countEmptySlots();
                    if (0 < i) return void Game.currentGame.centerHint.createTextHint("Spawn.nospace", {
                        left: i
                    })
                }
                return t ? this.premiumRewards ^= 1 << e : this.rewards ^= 1 << e, this.saveProgress(), this._logEventByType((
                    t ? cleverapps.EVENTS.PASS_RECEIVED_PREMIUM : cleverapps.EVENTS.PASS_RECEIVED) + "_" + e), this.checkComplete() && this.mission.complete(), s
            }
        }, PassMissionLogic.prototype.receiveReward = function () {
            if (this.mission.manualFinish)
                for (var e = 0; e < this.levels.length; ++e) {
                    var t = this.takeLevelReward(e, !1);
                    if (t) return t;
                    if (this.hasPremium() && (t = this.takeLevelReward(e, !0))) return t
                }
        }, PassMissionLogic.prototype.hasReward = function (e, t) {
            return (t ? this.premiumRewards : this.rewards) & 1 << e
        }, PassMissionLogic.prototype.setPremium = function () {
            this.premium = 1, this.runListeners(this.onUpdateListeners), this.saveProgress()
        }, PassMissionLogic.prototype.isCompletedTaskShown = function () {
            return this.progress.level === this.shownProgress.level
        }, PassMissionLogic.prototype.isAllTasksCompleted = function () {
            return this.progress.level >= this.levels.length
        }, PassMissionLogic.prototype.isAllProgressShown = function () {
            return this.progress.level === this.shownProgress.level && this.progress.progress === this.shownProgress.progress
        },
            PassMissionLogic.prototype.countAvailableRewards = function () {
                var e = Number(this._getAvailableRewardsSet()).toString(2).match(/1/g);
                return e && e.length || 0
            }, PassMissionLogic.prototype.addProgress = function (e) {
                if (e) {
                    for (var t = this._extract(this._compact(this.progress) + e), s = this.progress.level; s < t.level; s++) {
                        this.rewards |= 1 << s, this.premiumRewards |= 1 << s, this._logEventByType(cleverapps.EVENTS.PASS_FINISH_TASK + "_" + s);
                        var i, n, o = this.mission.getTimeLeft();
                        o <= cleverapps.parseInterval("3 days") && (this.isAllTasksCompleted() || ((n = new Date).setHours(21, 0, 0), 0 < (n = n - Date.now()) && n < o - cleverapps.parseInterval("10 minutes") && (i = n)), cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.PASS_UNCOMPLETED, i))
                    }
                    this.progress = t, this.saveProgress(), this.runListeners(this.onProgressChangedListeners)
                }
            }, PassMissionLogic.prototype.hasPremium = function () {
                return this.premium
            }, PassMissionLogic.prototype.canBuyPremium = function () {
                return !this.hasPremium() && (this.mission.isRunning() || 0 !== this.progress.level)
            },
            PassMissionLogic.prototype.canRemoveSilently = function () {
                return !1
            }, PassMissionLogic.prototype.canRemove = function () {
                return 0 === this.countAvailableRewards()
            }, PassMissionLogic.prototype.hasLastChance = function () {
                return !this.isAllTasksCompleted()
            }, PassMissionLogic.prototype.processEvent = function (e) {
                this.addProgress(e.amount), e.sourceUnit ? e.sourceUnit.onClaimPoints({
                    amount: e.amount,
                    callback: function () {
                        Game.currentGame.bpPointsPlanner && Game.currentGame.bpPointsPlanner.spawnOfferUnit(), this.displayWindow()
                    }.bind(this)
                }) : this.displayWindow(1e3)
            }, PassMissionLogic.prototype.handleShowWindow = function () {
                this.shownAvailableRewards = this._getAvailableRewardsSet(), this.runListeners(this.onShowWindowListeners)
            }, PassMissionLogic.prototype.stop = function () {
                "merge" === cleverapps.config.type && Game.currentGame && (Game.currentGame.map.listAvailableUnits().forEach(function (e) {
                    e.points && e.setPoints(0);
                    var t = e.findComponent(UnitsShopComponent),
                        t = (t && (t.checkPrizes(), t.checkCrystals()), e.findComponent(SpecialOffer));
                    t && t.type === SpecialOffer.TYPE_PASS_POINTS && e.remove()
                }), Game.currentGame && Game.currentGame.bpPointsPlanner && Game.currentGame.bpPointsPlanner.removeWrongPoints()), runCleaners(this)
            }, PassMissionLogic.prototype.beforeRemove = function () {
                "merge" === cleverapps.config.type && cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition() && Game.currentGame.specialOfferPlanner.planNext({
                    type: this.hasPremium() ? SpecialOffer.TYPE_PASS_FINISH_PREMIUM : SpecialOffer.TYPE_PASS_FINISH,
                    delay: 200,
                    target: this.levels[this.levels.length - 1].premiumReward.unit
                })
            }, PassMissionLogic.prototype.onGameEvent = function (e, t) {
                if (cleverapps.travelBook.isExpedition() && MissionManager.hasProperParent(this.mission) && this.mission.isRunning() && !this.isAllTasksCompleted()) {
                    var s;
                    switch (e) {
                        case Merge.SPAWN:
                            s = !Array.isArray(t.affected) && t.unit;
                            break;
                        case Merge.BUILD:
                            s = t.affected
                    }
                    s && s.getData().bpPoints && s.setPoints(s.getData().bpPoints)
                }
            }, PassMissionLogic.BuildableUnitPoints = function (e) {
                var t = [0, 0, 5, 10, 20, 60, 300, 600, 2e3,
                    2500, 3e3, 4e3
                ];
                return t[Math.min(e.stage, t.length - 1)]
            }, PassMissionLogic.prototype.needDisplayWindow = function () {
                var e = this._getAvailableRewardsSet();
                return e ^= e & this.shownAvailableRewards
            }, PassMissionLogic.prototype.displayWindow = function (t) {
                this.needDisplayWindow() && (t = t || 0, cleverapps.meta.display({
                    focus: "PassWindow",
                    actions: [function (e) {
                        cleverapps.meta.showControlsWhileFocused(this.mission.name + "MissionIcon"), setTimeout(e, t)
                    }.bind(this), function (e) {
                        cleverapps.meta.hideControlsWhileFocused(this.mission.name + "MissionIcon"), new this.mission.view(this.mission), cleverapps.meta.onceNoWindowsListener = e
                    }.bind(this)]
                }))
            }, PassMissionLogic.prototype._compact = function (e) {
                for (var t = 0, s = 0; s < e.level; s++) t += this.levels[s].task.goal;
                return t + e.progress
            }, PassMissionLogic.prototype._extract = function (e) {
                for (var t = 0, s = 0; s < this.levels.length; s++) {
                    if (e < t + this.levels[s].task.goal) return {
                        level: s,
                        progress: e - t
                    };
                    t += this.levels[s].task.goal
                }
                return {
                    level: this.levels.length,
                    progress: 0
                }
            },
            PassMissionLogic.prototype._getAvailableRewardsSet = function () {
                return this.hasPremium() ? this.rewards << this.levels.length | this.premiumRewards : this.rewards
            }, PassMissionLogic.prototype._logEventByType = function (e, t) {
                switch (Mission.GetChildType(this.mission.type)) {
                    case Mission.TYPE_SALEPASS:
                        e = "purchase_" + e;
                        break;
                    case Mission.TYPE_EXPEDITION_PASS:
                        e = cleverapps.travelBook.getCurrentPage().id + "_" + e
                }
                cleverapps.eventLogger.logEvent(e, t)
            }, PassMissionLogic.GetPrice = function (t) {
                return [Mission.TYPE_RAPUNZEL_EXPEDITION, Mission.TYPE_RAPUNZEL2_EXPEDITION, Mission.TYPE_EASTER_EXPEDITION, Mission.TYPE_CHINA_EXPEDITION].some(function (e) {
                    return t.type === Mission.CompoundType(Mission.TYPE_EXPEDITION_PASS, e)
                }) ? 499 : Mission.TYPE_EXPEDITION_PASS === Mission.GetChildType(t.type) ? 1e3 : 750
            }, PassMissionLogic.classifyAmount = function (e) {
                return 300 < e ? 3 : 80 < e ? 2 : 1
            }, cc.Node.extend({
                ctor: function (e) {
                    switch (this._super(), this.options = e = e || {}, this.setAnchorPoint2(), void 0 === e.prefix && (e.prefix = "x"), e.type) {
                        case "hard":
                        case "rubies":
                            this.initWithSprite(bundles.reward_icons.frames.reward_gold_png, e.prefix + e.value);
                            break;
                        case "exp":
                            this.initWithSprite(bundles.reward_icons.frames.reward_exp_png, e.prefix + e.value);
                            break;
                        case "coins":
                            this.initWithSprite(bundles.reward_icons.frames.reward_coin_png, e.prefix + e.value);
                            break;
                        case "lives":
                        case "energy":
                            this.initWithSprite(bundles.reward_icons.frames.reward_energy_png, e.prefix + e.value);
                            break;
                        case "unlimitedLives":
                            this.initWithSprite(bundles.reward_icons.frames.life_unlim, Product.FormatTimePeriod(e.value).title);
                            break;
                        case "boosters":
                            var t = Object.keys(e.value)[0];
                            this.initWithSprite(RewardTypes.boosters.icon[t], e.prefix + e.value[t]);
                            break;
                        case "wands":
                            this.initWithSprite(bundles.reward_icons.frames.reward_wand_png, e.prefix + e.value);
                            break;
                        case "worker":
                            e.value = Product.FormatTimePeriod(e.value), this.initWithSprite(bundles.reward_icons.frames.reward_worker_png, e.value.title, {
                                amount: e.value.amount
                            });
                            break;
                        case "unit":
                            this.initWithUnit(e.value, e.prefix),
                                this.rewardName = cleverapps.unitsLibrary.getUnitName(e.value, !0) + " x" + e.value.amount
                    }
                },
                initWithSprite: function (e, t, s) {
                    this.initWithNode(new cc.Sprite(e), t, s)
                },
                initWithUnit: function (e, t) {
                    var s = UnitView.getUnitImage(e, {
                        preferStatic: !0
                    });
                    s && (s.clearTrack && s.clearTrack(0), s.setAnchorPoint2(), this.initWithNode(s, t + e.amount))
                },
                initWithNode: function (e, t, s) {
                    var i = this.options,
                        n = cleverapps.styles.PassRewardIcon,
                        e = (this.setContentSize2(n.icon), this.icon = e, cleverapps.UI.fitToBox(e, {
                            width: n.icon.width,
                            height: n.icon.height,
                            maxScale: (i.premium ? n.icon.prem : n.icon.free).scale
                        }), e.setPositionRound(n.icon), this.addChild(e), i.font || cleverapps.styles.FONTS.PASS_REWARD_TEXT);
                    cleverapps.UI.ImageFont.IsApplicable(e, t) ? this.text = cleverapps.UI.generateImageText(t, e, s) : this.text = cleverapps.UI.generateOnlyText(t, e, s), this.text.setPositionRound(n.text), this.text.setLocalZOrder(1), this.addChild(this.text)
                },
                setDiscolor: function (e) {
                    e ? (this.icon.setOpacity(120), this.icon.setColor(new cc.Color(0, 150, 255, 255)),
                        this.text.setOpacity(120), this.text.setScale(.8)) : (this.icon.setOpacity(255), this.icon.setColor(new cc.Color(255, 255, 255, 255)), this.text.setScale(1), this.text.setOpacity(255))
                },
                setAttention: function (e) {
                    var t = cleverapps.styles.PassRewardIcon.attention;
                    this.attention && (this.attention.removeFromParent(), delete this.attention), e && ((e = this.attention = new cc.Sprite(e)).setPositionRound(t), this.addChild(e))
                },
                setShining: function (e) {
                    var t = cleverapps.styles.PassRewardIcon.shining;
                    this.shining && (this.shining.removeFromParent(), delete this.shining), e && ((e = this.shining = new cleverapps.Spine(bundles.reward_icons_pass.jsons.prize_shining_json, t.scale)).setAnimation(0, t.animation, !0), e.setPositionRound(t), e.setLocalZOrder(-1), this.addChild(e))
                },
                setFlying: function (e, t) {
                    var s = cleverapps.styles.PassRewardIcon.flying;
                    this.flyingAction && (this.stopAction(this.flyingAction), delete this.flyingAction), e && (this.flyingAction = this.runAction(new cc.Sequence(new cc.DelayTime(1.5 * Math.random()), new cc.CallFunc(
                        function () {
                            this.flyingAction = this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.CallFunc(function () {
                                this.icon.runAction(new cc.Sequence(new cc.MoveBy(3, 0, s.offsetY), new cc.CallFunc(function () {
                                    Math.random() < .7 / t.countAvailableRewards() && this.icon.runAction(new cc.Sequence(new cc.RotateBy(.25, 10), new cc.RotateBy(.25, -10), new cc.RotateBy(.25, 10), new cc.RotateBy(.25, -10)))
                                }, this), new cc.MoveBy(1.5, 0, -s.offsetY)))
                            }, this), new cc.DelayTime(4.5))))
                        }, this))))
                },
                setClaimable: function (e, t, s) {
                    this.setClaimButton(e, t, s), e && !t && cleverapps.UI.onClick(this, this.claimReward.bind(this, s))
                },
                setClaimButton: function (e, t, s) {
                    this.claimButton && (this.claimButton.removeFromParent(), this.claimButton = void 0), e && (e = cleverapps.styles.PassRewardIcon.claimButton, (s = this.claimButton = new cleverapps.UI.Button({
                        type: cleverapps.styles.UI.Button.Images.small_button_green,
                        width: e.width,
                        height: e.height,
                        text: "Claim",
                        onClicked: this.claimReward.bind(this, s)
                    })).setAnchorPoint2(), s.setPositionRound(e), this.addChild(s),
                        t && s.disable())
                },
                updateState: function (e, t) {
                    var s;
                    switch (this.options.level < t && (s = e.hasReward(this.options.level, this.options.premium) ? this.options.premium && !e.hasPremium() ? "premium_required" : "fresh" : "gained"), cc.eventManager.removeListeners(this), this.setDiscolor(!1), this.setAttention(), this.setShining(!1), this.setFlying(!1), this.setClaimable(!1), s) {
                        case "premium_required":
                            this.setClaimable(!0, !1, e);
                            break;
                        case "fresh":
                            this.setShining(!0), this.setFlying(!0, e), this.setClaimable(!0, !1, e);
                            break;
                        case "gained":
                            this.setAttention(bundles.reward_icons_pass.frames.prize_checkmark_png);
                            break;
                        default:
                            this.setDiscolor(!0), cleverapps.tooltipManager.create(this, {
                                text: "PassWindow.moreItemsToolTip." + e.mission.collectItemName,
                                position: cleverapps.styles.UI.Tooltip.LOCATION.above
                            })
                    }
                },
                openAnimation: function () {
                    this.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.2), new cc.ScaleTo(.2, 1))), this.claimButton && (this.claimButton.setVisible(!1), this.claimButton.runAction(new cc.Sequence(new cc.DelayTime(.4), new cc.Show)))
                },
                claimReward: function (e) {
                    var t;
                    e.shownProgress.level < this.options.level || (!this.options.premium || e.hasPremium() ? (t = e.takeLevelReward(this.options.level, this.options.premium)) && (e.checkComplete() && cleverapps.windows.currentWindow().close(), new RewardWindow(t, {
                        toMainWorld: e.mission.mainWorldReward
                    })) : new PassBuyTicketWindow(e))
                },
                getPreferredBundles: function () {
                    return "merge" === cleverapps.config.type ? ["units"] : this._super()
                }
            })),
        PassProgress = (PassRewardIcon.createIconsFromRewardsList = function (e, t, s) {
            var i, n = [];
            for (i in e) {
                var o = e[i];
                if ("unit" === i)
                    for (var o = cleverapps.toArray(o), a = 0; a < o.length; ++a) {
                        var r = new PassRewardIcon({
                            type: i,
                            value: o[a],
                            level: t,
                            premium: s
                        });
                        n.push(r)
                    } else n.push(new PassRewardIcon({
                        type: i,
                        value: o,
                        level: t,
                        premium: s
                    }))
            }
            return n
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PASS_REWARD_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.PassRewardIcon = {
            icon: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                },
                width: 180,
                height: 180,
                free: {
                    scale: 1.1
                },
                prem: {
                    scale: 1.2
                }
            },
            text: {
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -2
                }
            },
            attention: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -60
                }
            },
            shining: {
                x: {
                    align: "center",
                    dx: -8
                },
                y: {
                    align: "center",
                    dy: 0
                },
                animation: "idle",
                scale: 1.2
            },
            flying: {
                offsetY: 8
            },
            claimButton: {
                width: 170,
                height: 60,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: -75
                }
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.passLogic = e.passLogic;
                var t = cleverapps.styles.PassProgress,
                    e = (this.setContentSize2(e.width - 2 * t.paddingX, t.height), this.createTasks()),
                    s = (e.setPositionRound(t.tasks), this.progressBar = new ScaledProgressBar({
                        progress: bundles.progress_bar.frames.bar_passprogress,
                        background: bundles.progress_bar.frames.bg_passprogress
                    })),
                    s = (s.setLength(e.content.width - t.tasks.width / 2 - t.progressBar.offsetWidth), s.setAnchorPoint2(0, .5), s.setPositionRound(t.progressBar), s.setLocalZOrder(-1), s.setPercentage(this.calcProgressPercentage(this.passLogic.shownProgress)), e.content.addChild(s),
                        cleverapps.config.debugMode && cleverapps.UI.onClick(s, function () {
                            this.passLogic.completeCurrentTask(), this.passLogic.showProgress()
                        }.bind(this)), this.addLines(), this.progressScroll = new cleverapps.UI.ScrollView(e, {
                            childrenVisibility: cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,
                            direction: cleverapps.UI.ScrollView.DIR_HORIZONTAL,
                            scrollBarEnabled: !1,
                            outOfBoundaryScale: .05
                        }));
                s.setContentSize2(this.width + t.scroll.offsetWidth, this.height + t.scroll.offsetHeight), s.scrollTo(cleverapps.UI.ScrollView.SCROLLS.LOWER_RIGHT), s.setPositionRound(t.scroll), this.addChild(s), this.passLogic.onAnimateProgressChange = this.createListener(this.animateProgressChange.bind(this)), this.passLogic.onNextProgressStep = this.createListener(this.animateProgressStep.bind(this)), this.passLogic.onShowFinger = this.createListener(this.showFinger.bind(this)), this.passLogic.onShowWindowListeners.passProgress = this.createListener(this.onShow.bind(this))
            },
            createTasks: function () {
                var i = cleverapps.styles.PassProgress.tasks,
                    n = this.passLogic.levels,
                    e = this.container = new cc.Node,
                    o = (e.setAnchorPoint2(), e.setContentSize2(i.width * n.length + i.contentOffset, i.height), this.rewardIcons = []),
                    t = (n.forEach(function (e, t) {
                        var s = PassRewardIcon.createIconsFromRewardsList(e.reward, e.level, !1),
                            s = (this.addIcons(s, i.width * (.5 + t), i.reward.y).setLocalZOrder(n.length - t), o.push.apply(o, s), PassRewardIcon.createIconsFromRewardsList(e.premiumReward, e.level, !0));
                        this.addIcons(s, i.width * (.5 + t), i.premiumReward.y).setLocalZOrder(n.length - t), o.push.apply(o, s)
                    }.bind(this)), this.updateIcons(), this.createTaskPoints(), this.createTasksBgs(), cleverapps.UI.wrapWithPadding(e, {
                        left: i.contentOffset
                    }));
                return t.content = e, t
            },
            createTaskPoints: function () {
                this.taskPoints = this.passLogic.levels.map(function (e, t) {
                    e = this.createTaskPoint(e, t);
                    return this.container.addChild(e), e
                }, this)
            },
            createTaskPoint: function (e, t) {
                return this.passLogic.shownProgress.level > e.level ? this.createCompletedTaskPoint(e, t) : this.createUncompletedTaskPoint(e, t)
            },
            createCompletedTaskPoint: function (e, t) {
                var s = cleverapps.styles.PassProgress.tasks,
                    i = this.passLogic.mission.type === Mission.TYPE_SALEPASS,
                    n = i && bundles.passprogress.frames.sale_task_point_completed || bundles.passprogress.frames.task_point_completed,
                    n = new cc.Sprite(n);
                return n.setPositionRound(s.width * (.5 + t), s.taskPoint.y), s.completedLevelIcon ? ((i = new cc.Sprite(i ? bundles.passprogress.frames.progress_coin : bundles.passprogress.frames.progress_star)).setScale(s.completedLevelIcon.scale), n.addChild(i), i.setPositionRound(n.width / 2, n.height / 2)) : (s = cleverapps.UI.generateImageText(t + 1, cleverapps.styles.FONTS.PASS_PROGRESS_POINT_COMPLETED), n.addChild(s), s.setPositionRound(n.width / 2, n.height / 2)), n
            },
            createUncompletedTaskPoint: function (e, t) {
                var s = cleverapps.styles.PassProgress.tasks,
                    i = new cc.Sprite(bundles.passprogress.frames.task_point),
                    s = (i.setPositionRound(s.width * (.5 + t), s.taskPoint.y), cleverapps.UI.generateImageText(t + 1, cleverapps.styles.FONTS.PASS_PROGRESS_POINT));
                return i.addChild(s),
                    s.setPositionRound(i.width / 2, i.height / 2), i
            },
            createTasksBgs: function () {
                var i = cleverapps.styles.PassProgress,
                    s = function (e, t) {
                        var s = cleverapps.UI.createScale9Sprite(bundles.passprogress.frames[e ? "prize_bg_orange1" : "prize_bg_blue1"]);
                        s.setContentSize2(i.tasks.bgs), s.setPositionRound(i.tasks.width * (.5 + t), (e ? i.line.first : i.line.second).y), this.container.addChild(s, -1)
                    }.bind(this);
                this.passLogic.levels.forEach(function (e, t) {
                    t % 2 == 0 && !bundles.passprogress.frames.prize_bg_single || (s(!0, t), s(!1, t))
                }, this)
            },
            addIcons: function (e, t, s) {
                e = new cleverapps.Layout(e, {
                    direction: cleverapps.UI.VERTICAL,
                    reversed: !0
                });
                return e.setAnchorPoint2(), e.setPositionRound(t, s), this.container.addChild(e), e
            },
            addLines: function () {
                var s = cleverapps.styles.PassProgress.line,
                    e = function (e, t) {
                        e = cleverapps.UI.createScale9Sprite(e, s.scale9 || void 0);
                        e.setPositionRound(t), e.setContentSize2(this.width, s.height), this.addChild(e, -2)
                    }.bind(this);
                bundles.passprogress.frames.prize_bg_single ? e(bundles.passprogress.frames.prize_bg_single,
                    s.single) : (e(bundles.passprogress.frames.prize_bg_orange2, s.first), e(bundles.passprogress.frames.prize_bg_blue2, s.second))
            },
            calcProgressPercentage: function (e) {
                var t = this.passLogic.levels.length;
                if (e.level >= t) return 100;
                if (0 === e.level && 0 === e.progress) return 0;
                var s = .5 / t,
                    i = e.progress / this.passLogic.levels[e.level].task.goal;
                return 0 === e.level ? s * i * 100 : 100 * (s + (1 - s) / (t - 1) * (e.level - 1 + i))
            },
            scrollToLevel: function (e, t, s) {
                this.taskPoints[t] && this.progressScroll.scrollTo(this.taskPoints[t].getPosition(), e, s)
            },
            animateProgressChange: function (e, t) {
                this.scrollToLevel(.8, e.level);
                e = this.calcProgressPercentage(e);
                this.progressBar.runAction(new ScaledProgressBarProgressTo(.8, e).easing(cc.easeCubicActionOut())), this.runAction(new cc.Sequence(new cc.DelayTime(.6), new cc.CallFunc(t)))
            },
            animateProgressStep: function (t, e) {
                var s = this.taskPoints[t],
                    i = this.createCompletedTaskPoint(this.passLogic.levels[t], t);
                this.container.addChild(i), i.setPositionRound(s.getPosition()), this.taskPoints[t] = i, s.removeFromParent(),
                    i.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.15), new cc.ScaleTo(.15, 1))), i.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.15), new cc.PlaySound(bundles.passprogress.urls.task_done_sfx), new cc.CallFunc(function () {
                        this.rewardIcons.filter(function (e) {
                            return e.options.level === t
                        }).forEach(function (e) {
                            e.updateState(this.passLogic, t + 1), e.openAnimation()
                        }.bind(this)), this.passLogic.levels[t].energy && Game.currentGame.addReward("energy", this.passLogic.levels[t].energy, i)
                    }.bind(this)), new cc.ScaleTo(.15, 1), new cc.CallFunc(e)))
            },
            updateIcons: function () {
                this.rewardIcons.forEach(function (e) {
                    e.updateState(this.passLogic, this.passLogic.shownProgress.level)
                }.bind(this))
            },
            showFinger: function () {
                var e, t = this.getFirstShownReward();
                t && (e = this.rewardIcons.filter(function (e) {
                    return e.options.level === t.level && e.options.premium === t.premium
                })[0], this.finger = FingerView.hintClick(e, {
                    delay: .8,
                    loopFilter: function () {
                        return cc.rectContainsRect(this.progressScroll.getGlobalBoundingBox(), e.icon.getGlobalBoundingBox())
                    }.bind(this)
                }))
            },
            hideFinger: function () {
                FingerView.remove(this.finger), this.finger = void 0
            },
            onShow: function () {
                var e, t = this.passLogic.shownProgress.level;
                !this.passLogic.isAllProgressShown() || void 0 !== (e = this.getFirstShownReward()) && (t = e.level), this.hideFinger(), this.updateIcons(), this.runAction(new cc.Sequence(new cc.DelayTime(.4), new cc.CallFunc(function () {
                    this.scrollToLevel(.8, t, {
                        easing: cc.easeBackInOut(),
                        callback: function () {
                            this.passLogic.showProgress()
                        }.bind(this)
                    })
                }.bind(this))))
            },
            getFirstShownReward: function () {
                for (var e = 0, t = this.passLogic.shownProgress.level; e < t; ++e) {
                    if (this.passLogic.hasPremium() && this.passLogic.hasReward(e, !0)) return {
                        level: e,
                        premium: !0
                    };
                    if (this.passLogic.hasReward(e)) return {
                        level: e,
                        premium: !1
                    }
                }
            }
        })),
        PassHeader = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PASS_PROGRESS_POINT: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE
            },
            PASS_PROGRESS_POINT_COMPLETED: {
                name: "nostroke",
                size: 40,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            }
        }), cleverapps.styles.PassProgress = {
            paddingX: 148,
            height: 700,
            scroll: {
                x: {
                    align: "center",
                    dx: -1
                },
                y: {
                    align: "center",
                    dy: 0
                },
                offsetHeight: 100,
                offsetWidth: 0
            },
            progressBar: {
                offsetWidth: 5,
                x: {
                    align: "left",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 1
                }
            },
            line: {
                first: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 159
                    }
                },
                second: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: -151
                    }
                },
                height: 311
            },
            tasks: {
                width: 220,
                height: 500,
                contentOffset: 30,
                taskPoint: {
                    y: {
                        align: "center"
                    }
                },
                premiumReward: {
                    y: {
                        align: "center",
                        dy: 208
                    }
                },
                reward: {
                    y: {
                        align: "center",
                        dy: -120
                    }
                },
                bgs: {
                    width: 220,
                    height: 311
                }
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.options = e, this.mission = e.passLogic.mission;
                var t, s = cleverapps.styles.PassHeader,
                    i = (this.setAnchorPoint2(), this.setContentSize2(e.width - 2 * s.paddingX, s.height), e.bg_json ? ((t = new cleverapps.Spine(e.bg_json)).setAnimation(0, "animation", !0), this.addChild(t), t.setPositionRound(this.width / 2, this.height / 2), (i = cleverapps.offerManager.findOffer({
                        mission: this.mission.type
                    })) && this.createPack(i), (i = new cleverapps.Spine(e.decor_json)).setAnimation(0,
                        "animation", !0), this.addChild(i), i.setPositionRound(s.decor)) : e.json ? ((i = new cleverapps.Spine(e.json)).setAnimation(0, "animation", !0), i.setPositionRound(this.width / 2, this.height / 2), this.addChild(i)) : bundles.passheader.frames.details_background && ((t = cleverapps.UI.createScale9Sprite(bundles.passheader.frames.details_background, cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(this.width, this.height), t.setPositionRound(this.width / 2, this.height / 2), this.addChild(t)), this.mission.isCompleted() ? ((i = cleverapps.UI.generateOnlyText("PassWindow.finished", cleverapps.styles.FONTS.PASS_TITLE_TEXT)).setPositionRound(s.timer), this.addChild(i)) : ((t = this.createTimer()).setPositionRound(s.timer), this.addChild(t)), this.amonut = new PassProgressAmount(e));
                i.setPositionRound(s.amount), this.addChild(i)
            },
            createPack: function (e) {
                var t = cleverapps.styles.PassHeader,
                    s = this.mission.type === Mission.TYPE_SALEPASS ? t.salepass : void 0,
                    i = new cleverapps.Spine(this.options.pack_json),
                    n = (i.setAnimation(0, "animation", !0),
                        this.addChild(i), i.setPositionRound(t.pack), new cc.Sprite(bundles.passheader.frames.badge_png)),
                    s = (i.addChild(n), n.setPositionRound(s && s.pack.badge || t.pack.badge), new TextWithIcon(e.getPriceText())),
                    s = (n.addChild(s), s.fitTo(t.pack.badge.text.width), s.setRotation(t.pack.badge.text.rotation), s.setPositionRound(t.pack.badge.text), function () {
                        new MissionOfferWindow(e), this.options.close()
                    }.bind(this));
                cleverapps.UI.onClick(i, s), cleverapps.UI.onClick(n, s), cleverapps.UI.applyHover(i)
            },
            createTimer: function () {
                var e = cleverapps.styles.PassHeader.timer,
                    t = [],
                    s = (e.tooltip || ((s = cleverapps.UI.generateOnlyText("PassWindow.timer", cleverapps.styles.FONTS.PASS_TITLE_TEXT)).setDimensions(e.title.width, 0), s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.fitTo(void 0, e.title.height), t.push(s)), new cc.Scale9Sprite(bundles.passheader.frames.timer_substrate)),
                    i = (s.setContentSize2(e), e.tooltip && cleverapps.tooltipManager.create(s, {
                        text: "PassWindow.timer",
                        position: cleverapps.styles.UI.Tooltip.LOCATION.below
                    }),
                        this.mission.getTimeLeft()),
                    i = (0 < i && (i = new cleverapps.CountDown(i)), new cleverapps.CountDownView(i, {
                        font: cleverapps.styles.FONTS.PASS_TIMER_TEXT,
                        background_content: s,
                        icon: bundles.passheader.frames.timer_icon
                    }));
                return i.fitTo(e.countdown.width, 0), t.push(i), new cleverapps.Layout(t, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin
                })
            }
        })),
        ExpeditionPassHeader = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PASS_TITLE_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            PASS_TIMER_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.WHITE
            }
        }), cleverapps.styles.PassHeader = {
            paddingX: 50,
            height: 200,
            timer: {
                tooltip: !0,
                width: 250,
                height: 66,
                margin: 20,
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 22
                },
                countdown: {
                    width: 180
                },
                title: {
                    width: 450,
                    height: 60
                }
            },
            decor: {
                x: {
                    align: "center",
                    dx: -650
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            pack: {
                x: {
                    align: "right",
                    dx: -30
                },
                y: {
                    align: "center",
                    dy: 0
                },
                badge: {
                    x: {
                        align: "right",
                        dx: 141
                    },
                    y: {
                        align: "center",
                        dy: 11
                    },
                    text: {
                        x: {
                            align: "center",
                            dx: 40
                        },
                        y: {
                            align: "center",
                            dy: 7
                        },
                        rotation: -17,
                        width: 130
                    }
                }
            },
            salepass: {
                pack: {
                    badge: {
                        x: {
                            align: "right",
                            dx: 181
                        },
                        y: {
                            align: "center",
                            dy: -8
                        }
                    }
                }
            },
            amount: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: -90
                }
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this.passLogic = e.passLogic;
                var t = cleverapps.styles.ExpeditionPassHeader,
                    s = (this._super(), this.setAnchorPoint2(), this.setContentSize2(e.width, t.height), new cleverapps.Spine(bundles["expeditionpass_" + cleverapps.skins.getSlot("skinName")].jsons.top_bg)),
                    s = (s.setAnimation(0, "animation", !0), s.setPositionRound(e.width / 2, this.height / 2), this.addChild(s), cleverapps.UI.generateOnlyText("ExpeditionPassWindow.header", cleverapps.styles.FONTS.EXPEDITIONS_PASS_TITLE_TEXT)),
                    s = (s.setDimensions(t.titleWidth, 0), s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.setPositionRound(t.title), this.addChild(s), this.amount = new PassProgressAmount(e));
                s.setPositionRound(t.amount), this.addChild(s)
            }
        })),
        PassProgressAmount = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            EXPEDITIONS_PASS_TITLE_TEXT: {
                size: 35,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.styles.ExpeditionPassHeader = {
            x: {
                align: "center"
            },
            y: {
                align: "top",
                dy: -20
            },
            height: 222,
            titleWidth: 900,
            title: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 10
                }
            },
            amount: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -85
                }
            }
        }, cleverapps.Layout.extend({
            ctor: function (e) {
                this.passLogic = e.passLogic;
                var t, s, i, n, e = cleverapps.styles.PassProgressAmount;
                this.passLogic.isAllTasksCompleted() && this.passLogic.isAllProgressShown() ? t = cleverapps.UI.generateOnlyText("PassWindow.completed", cleverapps.styles.FONTS.PASS_PROGRESS_TEXT) : (t = cleverapps.UI.generateOnlyText("PassWindow.progress", cleverapps.styles.FONTS.PASS_PROGRESS_TEXT), s = new cc.Sprite(bundles.passprogress.frames[this.passLogic.mission.type === Mission.TYPE_SALEPASS ? "progress_coin" : "progress_star"]), n = this.passLogic.shownProgress, i = this.passLogic.levels[n.level].task.goal, n = this.amount = cleverapps.UI.generateImageText(n.progress + " / " + i,
                    cleverapps.styles.FONTS.PASS_PROGRESS_IMAGE_TEXT), this.baseAmountScale = n.scale, n.setAnchorPoint2(0, .5)), this._super([t, s, n].filter(Boolean), {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: e.margin
                    }), this.passLogic.onAnimateAmountChange = this.createListener(this.animateChange.bind(this)), this.passLogic.onNextAmountStep = this.createListener(this.animateStep.bind(this))
            },
            animateChange: function (e, t, s) {
                this.amount.runAction(new ImageFontCountTo(.8, t.progress, s))
            },
            animateStep: function (e) {
                var t, s, i = this.passLogic.levels;
                e.level < i.length ? (t = 0, s = i[e.level].task.goal) : t = s = i[i.length - 1].task.goal, this.amount.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1.2 * this.baseAmountScale), new cc.ScaleTo(.2, this.baseAmountScale), new ImageFontCountTo(0, t, s)))
            }
        })),
        PassTickets = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PASS_PROGRESS_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            PASS_PROGRESS_IMAGE_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.styles.PassProgressAmount = {
            margin: 10
        }, cc.Node.extend({
            ctor: function (e) {
                this.options = e;
                var t = cleverapps.styles.PassTickets,
                    s = (this._super(), this.setAnchorPoint2(), bundles.passtickets.frames.tickets_layout_background && ((s = cleverapps.UI.createScale9Sprite(bundles.passtickets.frames.tickets_layout_background, cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(cleverapps.styles.PassTicket.width, s.height), s.setPositionRound(s.width / 2, s.height / 2), this.setContentSize2(s.width, s.height), this.addChild(s)), new PassTicket(e));
                s.setPositionRound(t.free), this.addChild(s), this.addPremiumTicket(), e.passLogic.onShowWindowListeners.passTickets = this.createListener(this.addPremiumTicket.bind(this))
            },
            addPremiumTicket: function () {
                this.premium && this.premium.removeFromParent(), this.premium = new PassTicket(
                    Object.assign({}, this.options, {
                        premium: !0
                    })), this.premium.setPositionRound(cleverapps.styles.PassTickets.premium), this.addChild(this.premium)
            }
        })),
        PassTicket = (cleverapps.styles.PassTickets = {
            free: {
                x: {
                    align: "center",
                    dx: -20
                },
                y: {
                    align: "center",
                    dy: -170
                }
            },
            premium: {
                x: {
                    align: "center",
                    dx: -20
                },
                y: {
                    align: "center",
                    dy: 145
                }
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this.premium = e.premium, this.passLogic = e.passLogic, this.closeWindowCallback = e.close, this._super();
                var t, e = cleverapps.styles.PassTicket,
                    s = (this.setContentSize2(e.width, e.height), this.setAnchorPoint2(), bundles.passtickets.frames.ticket_background && ((s = cleverapps.UI.createScale9Sprite(bundles.passtickets.frames.ticket_background, cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(e.width, e.height), s.setPositionRound(e.width / 2, e.height / 2), this.addChild(s)), bundles.passtickets.frames.order_rings && e.rings.forEach(function (e) {
                        var t = new cc.Sprite(bundles.passtickets.frames.order_rings);
                        t.setPositionRound(e), this.addChild(t)
                    }, this),
                        this.premium && e.premium.text || e.text),
                    i = cleverapps.UI.generateOnlyText(this.premium ? "PassWindow.ticket.hint" : "PassWindow.ticket.freeHint", this.premium ? cleverapps.styles.FONTS.PASS_TICKET_TEXT : cleverapps.styles.FONTS.PASS_TICKET_SMALL_TEXT),
                    s = (i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), i.fitTo(s.width, s.height), new cc.Node),
                    n = (s.setAnchorPoint2(), s.setContentSize2(this.premium && e.premium.icon || e.icon), this.passLogic.mission.type === Mission.TYPE_SALEPASS ? "purchase_ticket_json" : "ticket_json"),
                    n = new cleverapps.Spine(bundles.passtickets.jsons[n]),
                    n = (n.setAnimation(0, this.premium ? "animation" : "animation2", !0), n.setPositionRound(s.width / 2, s.height / 2), s.addChild(n), this.premium && !this.passLogic.hasPremium() ? (t = this.createTicketButton(), cleverapps.UI.onClick(s, function () {
                        this.passLogic.canBuyPremium() && new PassBuyTicketWindow(this.passLogic)
                    }.bind(this))) : (o = new cc.Sprite(bundles.passtickets.frames.attention_png), e.checkmark && (o.setPositionRound(e.checkmark), s.addChild(o))), [i, s, t, o]),
                    o = (
                        "tropical" === cleverapps.config.ui && (n = [i, t, s]), new cleverapps.Layout(n, {
                            margin: e.margin,
                            direction: cleverapps.UI.VERTICAL
                        }));
                o.setPositionRound(e.icon), this.addChild(o)
            },
            createTicketButton: function () {
                var e = cleverapps.styles.PassTicket.button;
                return this.passLogic.hasPremium() ? new cc.Sprite(bundles.passtickets.frames.attention_png) : new UseGoldButton({
                    type: cleverapps.styles.UI.Button.Images.small_button_green,
                    price: PassMissionLogic.GetPrice(this.passLogic.mission),
                    onClicked: this.buyTicket.bind(this),
                    eventName: cleverapps.EVENTS.SPENT.BATTLE_PASS,
                    disabled: !this.passLogic.canBuyPremium(),
                    width: e.width,
                    height: e.height
                })
            },
            buyTicket: function () {
                this.passLogic.setPremium(), this.closeWindowCallback(), new this.passLogic.mission.view(this.passLogic.mission), new RewardWindow({
                    battlePass: {
                        missionType: this.passLogic.mission.type
                    }
                })
            }
        })),
        PassWindowContent = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PASS_TICKET_TEXT: {
                size: 35,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            PASS_TICKET_SMALL_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            }
        }), cleverapps.styles.PassTicket = {
            width: 300,
            height: 624,
            margin: -50,
            text: {
                width: 210,
                height: 90
            },
            icon: {
                width: 160,
                height: 240,
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            premium: {
                icon: {
                    width: 160,
                    height: 220
                }
            },
            button: {
                width: 170,
                height: 60,
                scale: 1.2
            }
        }, cc.Node.extend({
            ctor: function (i) {
                this._super(), this.setAnchorPoint2(), this.setContentSize2(i.width, i.styles.height), i.components.forEach(function (e) {
                    var t = i.styles[e.name],
                        s = Object.assign(e.params || {}, {
                            passLogic: i.passLogic,
                            width: i.width,
                            styles: t
                        });
                    e.class.IsActive && !e.class.IsActive(s) || ((e = new e.class(s)).setPositionRound(t), this.addChild(e, t.zOrder))
                }.bind(this));
                cleverapps.meta.showControlsWhileFocused(["MenuBarGoldItem", "MenuBarLivesItem"])
            }
        })),
        BuildPassWindow = Window.extend({
            onWindowLoaded: function (e) {
                this.mission = e;
                var t = [{
                    name: "header",
                    class: PassHeader,
                    params: {
                        bg_json: bundles.pass.jsons.bg_json,
                        pack_json: bundles.pass.jsons.pack_json,
                        decor_json: bundles.pass.jsons.decor_json,
                        close: this.close.bind(this),
                        passLogic: e.logic
                    }
                }, {
                    name: "progress",
                    class: PassProgress
                }, {
                    name: "tickets",
                    class: PassTickets,
                    params: {
                        close: this.close.bind(this)
                    }
                }];
                this._super({
                    name: "BuildPassWindow",
                    title: "BuildPassWindow.title",
                    content: new PassWindowContent({
                        components: t,
                        width: cleverapps.styles.BuildPassWindow.width,
                        styles: cleverapps.styles.BuildPassWindow,
                        passLogic: e.logic
                    }),
                    help: function () {
                        new GuideWindow(e.rulesOptions)
                    },
                    foreground: bundles.passforeground.frames.window_foreground_png,
                    contentPadding: cleverapps.styles.BuildPassWindow.contentPadding,
                    closeButton: !0,
                    noPadding: !0,
                    styles: cleverapps.styles.BuildPassWindow.window
                })
            },
            onShow: function () {
                this._super(), this.mission.logic.handleShowWindow()
            },
            listBundles: function () {
                return ["pass"]
            },
            getPreferredBundles: function () {
                return ["pass", "units"]
            }
        }),
        LevelPassWindow = (BuildPassWindow.LEVELS = [{
            energy: 0,
            task: {
                goal: 30
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "treasure",
                    stage: 0,
                    amount: 1
                }
            }
        }, {
            energy: 5,
            task: {
                goal: 75
            },
            reward: {
                unit: {
                    code: "herochest",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "worker",
                    stage: 3,
                    amount: 1
                }
            }
        }, {
            energy: 5,
            task: {
                goal: 150
            },
            reward: {
                unit: {
                    code: "seasonchest",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "sacks",
                    stage: 0,
                    amount: 2
                }
            }
        }, {
            energy: 5,
            task: {
                goal: 350
            },
            reward: {
                unit: {
                    code: "sacks",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "treasure",
                    stage: 2,
                    amount: 1
                }
            }
        }, {
            energy: 10,
            task: {
                goal: 700
            },
            reward: {
                unit: {
                    code: "crystal",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "worker",
                    stage: 2,
                    amount: 2
                }
            }
        }, {
            energy: 10,
            task: {
                goal: 1500
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 2,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "worker",
                    stage: 3,
                    amount: 1
                }
            }
        }, {
            energy: 10,
            task: {
                goal: 3e3
            },
            reward: {
                unit: {
                    code: "sacks",
                    stage: 1,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "sacks",
                    stage: 1,
                    amount: 2
                }
            }
        }, {
            energy: 15,
            task: {
                goal: 5e3
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 3,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "crystal",
                    stage: 3,
                    amount: 1
                }
            }
        }, {
            energy: 15,
            task: {
                goal: 8e3
            },
            reward: {
                unit: {
                    code: "treasure",
                    stage: 1,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "sacks",
                    stage: 2,
                    amount: 1
                }
            }
        }, {
            energy: 15,
            task: {
                goal: 12e3
            },
            reward: {
                unit: {
                    code: "magicplant",
                    stage: 4,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "coinstree",
                    stage: 1,
                    amount: 1
                }
            }
        }], cleverapps.styles.BuildPassWindow = {
            width: 1816,
            height: 935,
            paddingX: 50,
            window: {
                Foreground: {
                    padding: {
                        top: 300
                    }
                }
            },
            contentPadding: {
                right: 80
            },
            progress: {
                x: {
                    align: "right",
                    dx: -26
                },
                y: {
                    align: "center",
                    dy: -122
                }
            },
            header: {
                x: {
                    align: "center",
                    dx: -2
                },
                y: {
                    align: "top",
                    dy: -30
                }
            },
            tickets: {
                x: {
                    align: "left",
                    dx: 24
                },
                y: {
                    align: "center",
                    dy: -118
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.mission = e, this._super({
                    name: "LevelPassWindow",
                    title: "LevelPassWindow.title",
                    content: this.createContent(),
                    closeButton: !0,
                    styles: cleverapps.styles.LevelPassWindow.window,
                    foreground: bundles.passforeground.frames.window_foreground_png,
                    help: function () {
                        new GuideWindow(e.rulesOptions)
                    }
                })
            },
            onShow: function () {
                this._super(), this.mission.logic.handleShowWindow()
            },
            createContent: function () {
                var e = cleverapps.styles.LevelPassWindow,
                    t = this.calcContentWidth();
                return new PassWindowContent({
                    components: [{
                        name: "progress",
                        class: PassProgress
                    }, {
                        name: "header",
                        class: PassHeader
                    }, {
                        name: "tickets",
                        class: PassTickets,
                        params: {
                            close: this.close.bind(this)
                        }
                    }],
                    width: t,
                    styles: e,
                    passLogic: this.mission.logic
                })
            },
            calcContentWidth: function () {
                var e = cleverapps.styles.LevelPassWindow,
                    t = cleverapps.UI.getSceneSize().width - 2 * e.paddingX;
                return t = (t = t < e.minWidth ? e.minWidth : t) > e.maxWidth ? e.maxWidth : t
            },
            listBundles: function () {
                return ["pass"]
            },
            getPreferredBundles: function () {
                return ["pass"]
            }
        })),
        SalePassWindow = (LevelPassWindow.LEVELS = [{
            level: 0,
            task: {
                goal: 3
            },
            reward: {
                unlimitedLives: "30 minutes"
            },
            premiumReward: {
                unlimitedLives: "12 hours"
            }
        }, {
            level: 1,
            task: {
                goal: 5
            },
            reward: {
                boosters: {
                    5: 1
                }
            },
            premiumReward: {
                boosters: {
                    5: 3
                }
            }
        }, {
            level: 2,
            task: {
                goal: 8
            },
            reward: {
                unlimitedLives: "1 hour"
            },
            premiumReward: {
                boosters: {
                    0: 3
                }
            }
        }, {
            level: 3,
            task: {
                goal: 12
            },
            reward: {
                boosters: {
                    6: 1
                }
            },
            premiumReward: {
                unlimitedLives: "12 hours"
            }
        }, {
            level: 4,
            task: {
                goal: 15
            },
            reward: {
                unlimitedLives: "2 hours"
            },
            premiumReward: {
                boosters: {
                    1: 3
                }
            }
        }, {
            level: 5,
            task: {
                goal: 20
            },
            reward: {
                exp: 20
            },
            premiumReward: {
                hard: 300
            }
        }, {
            level: 6,
            task: {
                goal: 25
            },
            reward: {
                boosters: {
                    7: 1
                }
            },
            premiumReward: {
                boosters: {
                    2: 3
                }
            }
        }, {
            level: 7,
            task: {
                goal: 30
            },
            reward: {
                boosters: {
                    6: 2
                }
            },
            premiumReward: {
                unlimitedLives: "12 hours"
            }
        }, {
            level: 8,
            task: {
                goal: 40
            },
            reward: {
                unlimitedLives: "2 hours"
            },
            premiumReward: {
                boosters: {
                    0: 5
                }
            }
        }, {
            level: 9,
            task: {
                goal: 50
            },
            reward: {
                boosters: {
                    2: 1
                }
            },
            premiumReward: {
                hard: 500
            }
        }], cleverapps.styles.LevelPassWindow = {
            minWidth: 900,
            maxWidth: 1800,
            height: 900,
            paddingX: 50,
            window: {
                padding: {
                    left: 0,
                    right: 0,
                    top: 160,
                    bottom: 50
                }
            },
            progress: {
                x: {
                    align: "right",
                    dx: -25
                },
                y: {
                    align: "top",
                    dy: -210
                }
            },
            header: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: -10
                }
            },
            tickets: {
                x: {
                    align: "left",
                    dx: 10
                },
                y: {
                    align: "top",
                    dy: -243
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.mission = e;
                var t = [{
                    name: "header",
                    class: PassHeader,
                    params: {
                        bg_json: bundles.salepass.jsons.bg_json,
                        pack_json: bundles.salepass.jsons.pack_json,
                        decor_json: bundles.salepass.jsons.decor_json,
                        json: bundles.salepass.jsons.head_json,
                        close: this.close.bind(this),
                        passLogic: e.logic
                    }
                }, {
                    name: "progress",
                    class: PassProgress
                }, {
                    name: "tickets",
                    class: PassTickets,
                    params: {
                        close: this.close.bind(this)
                    }
                }];
                this._super({
                    name: "SalePassWindow",
                    title: "SalePassWindow.title",
                    content: new PassWindowContent({
                        components: t,
                        width: cleverapps.styles.SalePassWindow.width,
                        styles: cleverapps.styles.SalePassWindow,
                        passLogic: e.logic
                    }),
                    help: function () {
                        new GuideWindow(e.rulesOptions)
                    },
                    foreground: bundles.passforeground.frames.window_foreground_png,
                    contentPadding: cleverapps.styles.SalePassWindow.contentPadding,
                    closeButton: !0,
                    noPadding: !0,
                    styles: cleverapps.styles.SalePassWindow.window
                })
            },
            onShow: function () {
                this._super(), this.mission.logic.handleShowWindow()
            },
            listBundles: function () {
                return ["salepass"]
            },
            getPreferredBundles: function () {
                return ["salepass"]
            }
        })),
        ExpeditionPassWindow = (SalePassWindow.LEVELS = [{
            energy: 0,
            task: {
                goal: 30
            },
            reward: {
                unit: {
                    code: "crystal",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "crystal",
                    stage: 0,
                    amount: 3
                }
            }
        }, {
            energy: 5,
            task: {
                goal: 150
            },
            reward: {
                unit: {
                    code: "treasure",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "treasure",
                    stage: 1,
                    amount: 2
                }
            }
        }, {
            energy: 5,
            task: {
                goal: 275
            },
            reward: {
                unit: {
                    code: "coins",
                    stage: 4,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "coins",
                    stage: 5,
                    amount: 1
                }
            }
        }, {
            energy: 5,
            task: {
                goal: 325
            },
            reward: {
                unit: {
                    code: "treasure",
                    stage: 1,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "worker",
                    stage: 4,
                    amount: 2
                }
            }
        }, {
            energy: 10,
            task: {
                goal: 355
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 3,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "treasure",
                    stage: 2,
                    amount: 2
                }
            }
        }, {
            energy: 10,
            task: {
                goal: 400
            },
            reward: {
                unit: {
                    code: "treasure",
                    stage: 2,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "crystal",
                    stage: 3,
                    amount: 2
                }
            }
        }, {
            energy: 10,
            task: {
                goal: 475
            },
            reward: {
                unit: {
                    code: "sacks",
                    stage: 2,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "treasure",
                    stage: 2,
                    amount: 3
                }
            }
        }, {
            energy: 15,
            task: {
                goal: 525
            },
            reward: {
                unit: {
                    code: "coins",
                    stage: 3,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "rubies",
                    stage: 4,
                    amount: 1
                }
            }
        }, {
            energy: 15,
            task: {
                goal: 600
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 3,
                    amount: 2
                }
            },
            premiumReward: {
                unit: {
                    code: "worker",
                    stage: 4,
                    amount: 2
                }
            }
        }, {
            energy: 15,
            task: {
                goal: 750
            },
            reward: {
                unit: {
                    code: "magicplant",
                    stage: 5,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "energytree",
                    stage: 1,
                    amount: 1
                }
            }
        }], cleverapps.styles.SalePassWindow = {
            width: 1816,
            height: 935,
            paddingX: 50,
            window: {
                Foreground: {
                    padding: {
                        top: 300
                    }
                }
            },
            contentPadding: {
                right: 100
            },
            progress: {
                x: {
                    align: "right",
                    dx: -26
                },
                y: {
                    align: "center",
                    dy: -122
                }
            },
            header: {
                x: {
                    align: "center",
                    dx: -2
                },
                y: {
                    align: "top",
                    dy: -30
                }
            },
            tickets: {
                x: {
                    align: "left",
                    dx: 24
                },
                y: {
                    align: "center",
                    dy: -118
                }
            }
        }, Window.extend({
            ctor: function (e) {
                this.mission = e, this._super.apply(this, arguments)
            },
            onWindowLoaded: function (e) {
                var t = {
                    name: "ExpeditionPassWindow",
                    title: "ExpeditionPassWindow.title",
                    content: new PassWindowContent({
                        components: [{
                            name: "progress",
                            class: PassProgress
                        }, {
                            name: "tickets",
                            class: PassTickets,
                            params: {
                                close: this.close.bind(this)
                            }
                        }, {
                            name: "header",
                            class: ExpeditionPassHeader
                        }],
                        width: cleverapps.styles.ExpeditionPassWindow.width,
                        styles: cleverapps.styles.ExpeditionPassWindow,
                        passLogic: e.logic
                    }),
                    foreground: bundles.passforeground.frames.window_foreground_png,
                    closeButton: !0,
                    noPadding: !0
                },
                    s = Mission.ParseCompoundType(e.type).parentType; - 1 === [Mission.TYPE_RAPUNZEL_EXPEDITION, Mission.TYPE_RAPUNZEL2_EXPEDITION, Mission.TYPE_EASTER_EXPEDITION, Mission.TYPE_CHINA_EXPEDITION].indexOf(s) && (t.help = function () {
                        new GuideWindow(e.rulesOptions)
                    }), this._super(t)
            },
            getPerson: function () {
                if (Mission.ParseCompoundType(this.mission.type).parentType === Mission.TYPE_UNDERSEA2_EXPEDITION) return "capitannemo"
            },
            onShow: function () {
                this._super(), this.mission.logic.handleShowWindow()
            },
            onClose: function () {
                cleverapps.meta.hideControlsWhileFocused(["MenuBarGoldItem", "MenuBarLivesItem"])
            },
            listBundles: function () {
                return ["expeditionpass_" + cleverapps.skins.getSlot("skinName")]
            },
            getPreferredBundles: function () {
                return ["expeditionpass_" + cleverapps.skins.getSlot("skinName")]
            }
        })),
        PassLastChanceWindow = (ExpeditionPassWindow.LEVELS = [{
            task: {
                goal: 100
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "worker",
                    stage: 1,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 175
            },
            reward: {
                unit: {
                    code: "sacks",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "sacks",
                    stage: 1,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 300
            },
            reward: {
                unit: {
                    code: "wands",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "wands",
                    stage: 2,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 750
            },
            reward: {
                unit: {
                    code: "coins",
                    stage: 2,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "rubies",
                    stage: 2,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 1500
            },
            reward: {
                unit: {
                    code: "crystal",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "crystal",
                    stage: 1,
                    amount: 2
                }
            }
        }, {
            task: {
                goal: 3500
            },
            reward: {
                unit: {
                    code: "treasure",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "treasure",
                    stage: 2,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 4500
            },
            reward: {
                unit: {
                    code: "sacks",
                    stage: 1,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "sacks",
                    stage: 2,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 5200
            },
            reward: {
                unit: {
                    code: "herochest",
                    stage: 0,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "herochest",
                    stage: 1,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 6e3
            },
            reward: {
                unit: {
                    code: "coins",
                    stage: 3,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "rubies",
                    stage: 3,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 8e3
            },
            reward: {
                unit: {
                    code: "herochest",
                    stage: 1,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "herochest",
                    stage: 2,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 1e4
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 3,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "worker",
                    stage: 4,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 12e3
            },
            reward: {
                unit: {
                    code: "magicplant",
                    stage: 3,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "magicplant",
                    stage: 5,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "sacks",
                    stage: 2,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "sacks",
                    stage: 2,
                    amount: 3
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 3,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "worker",
                    stage: 4,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "herochest",
                    stage: 1,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "herochest",
                    stage: 2,
                    amount: 2
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "wands",
                    stage: 1,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "wands",
                    stage: 2,
                    amount: 3
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "coins",
                    stage: 3,
                    amount: 2
                }
            },
            premiumReward: {
                unit: {
                    code: "rubies",
                    stage: 3,
                    amount: 2
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "treasure",
                    stage: 1,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "treasure",
                    stage: 2,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "crystal",
                    stage: 2,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "crystal",
                    stage: 3,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "sacks",
                    stage: 2,
                    amount: 2
                }
            },
            premiumReward: {
                unit: {
                    code: "sacks",
                    stage: 2,
                    amount: 3
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "coins",
                    stage: 4,
                    amount: 3
                }
            },
            premiumReward: {
                unit: {
                    code: "rubies",
                    stage: 4,
                    amount: 3
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "herochest",
                    stage: 1,
                    amount: 2
                }
            },
            premiumReward: {
                unit: {
                    code: "herochest",
                    stage: 2,
                    amount: 2
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "worker",
                    stage: 4,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "magicplant",
                    stage: 6,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "magicplant",
                    stage: 4,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "coinstree",
                    stage: 3,
                    amount: 1
                }
            }
        }, {
            task: {
                goal: 15e3
            },
            reward: {
                unit: {
                    code: "magicplant",
                    stage: 5,
                    amount: 1
                }
            },
            premiumReward: {
                unit: {
                    code: "energytree",
                    stage: 3,
                    amount: 1
                }
            }
        }], cleverapps.styles.ExpeditionPassWindow = {
            width: 1770,
            height: 901,
            progress: {
                x: {
                    align: "right",
                    dx: -27
                },
                y: {
                    align: "bottom",
                    dy: -7
                }
            },
            header: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: -4
                }
            },
            tickets: {
                x: {
                    align: "left",
                    dx: 24
                },
                y: {
                    align: "center",
                    dy: -106
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.mission = e, this.price = this.calcPrice(), this._super({
                    name: "battlepasslastchancewindow",
                    title: "PassLastChanceWindow.title",
                    content: this.createContent(),
                    buttons: this.createButtons(),
                    notCloseByTouchInShadow: !0,
                    closeButtonDelay: !0
                }), this.addOfferBadge()
            },
            createContent: function () {
                var e = cleverapps.styles.PassLastChanceWindow,
                    t = cleverapps.UI.generateOnlyText("PassLastChanceWindow.upperText", cleverapps.styles.FONTS.DARK_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT),
                    s = (t.setAnchorPoint2(), t.setDimensions(e.texts.width, 0), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.createRewards()),
                    i = (s.setLocalZOrder(1), cleverapps.UI.generateOnlyText("PassLastChanceWindow.lowerText", cleverapps.styles.FONTS.DARK_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT));
                return i.setAnchorPoint2(), i.setDimensions(e.texts.width, 0), i.setHorizontalAlignment(
                    cc.TEXT_ALIGNMENT_CENTER), new cleverapps.Layout([t, s, i], {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.margin
                    })
            },
            createRewards: function () {
                var e = cleverapps.styles.PassLastChanceWindow.rewards,
                    t = this.mission.logic.levels[this.mission.logic.shownProgress.level],
                    s = PassRewardIcon.createIconsFromRewardsList(t.reward, t.level, !1).map(function (e) {
                        return this.createReward(e, !1)
                    }, this);
                return this.mission.logic.hasPremium() && s.push.apply(s, PassRewardIcon.createIconsFromRewardsList(t.premiumReward, t.level, !0).map(function (e) {
                    return this.createReward(e, !0)
                }, this)), new cleverapps.Layout(s, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin
                })
            },
            addOfferBadge: function () {
                var e = cleverapps.styles.PassLastChanceWindow,
                    t = new TileBadge({
                        text: Messages.get("PassLastChanceWindow.badgeText").replace(/ /g, "\n"),
                        rotation: e.offerBadge.rotation
                    });
                t.setPositionRound(this.mission.details && this.mission.details.premium ? e.premiumOfferBadge : e.offerBadge), this.window.addChild(t)
            },
            createButtons: function () {
                var e = cleverapps.styles.PassLastChanceWindow.buttons;
                return [new UseGoldButton({
                    type: cleverapps.styles.UI.Button.Images.button_blue,
                    price: this.price,
                    onClicked: this.buyReward.bind(this),
                    eventName: cleverapps.EVENTS.SPENT.LAST_CHANCE,
                    width: e.width,
                    height: e.height
                })]
            },
            createReward: function (e, t) {
                var s = cleverapps.styles.PassLastChanceWindow.rewards,
                    i = cleverapps.UI.createScale9Sprite(bundles.passlastchance_window.frames.icon_background, cleverapps.UI.Scale9Rect.TwoPixelXY);
                return i.setAnchorPoint2(), i.setContentSize2(s.background), e.setScale(1.3), e.setAnchorPoint2(), e.setPositionRound(s.icon), i.addChild(e), t && ((e = new cc.Sprite(bundles.passlastchance_window.frames.icon_ribbon)).setPositionRound(s.ribbon), i.addChild(e), (t = cleverapps.UI.generateOnlyText("PassRewardIcon.ribbonText", cleverapps.styles.FONTS.BP_LAST_CHANCE_RIBBON)).setPositionRound(s.text), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(s.text.width, 0), t.fitTo(void 0, s.text.height), t.setRotation(s.text.rotation),
                    e.addChild(t), (e = new cleverapps.Spine(this.mission.type === Mission.TYPE_SALEPASS ? bundles.passlastchance_window.jsons.purchase_ticket_json : bundles.passlastchance_window.jsons.ticket_json)).setAnimation(0, "animation", !0), e.setAnchorPoint2(), e.setScale(s.ticket.scale), e.setPositionRound(s.ticket), i.addChild(e)), i
            },
            calcPrice: function () {
                return 100
            },
            buyReward: function () {
                this.mission.logic.completeCurrentTask(), this.close(), new this.mission.view(this.mission)
            },
            listBundles: function () {
                return ["passlastchance_window"]
            },
            getPreferredBundles: function () {
                return ["passlastchance_window"]
            }
        })),
        PassBuyTicketWindow = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            BP_LAST_CHANCE_RIBBON: {
                size: 45,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.styles.PassLastChanceWindow = {
            margin: 40,
            texts: {
                width: 800
            },
            buttons: {
                width: 300,
                height: 110
            },
            offerBadge: {
                x: {
                    align: "right",
                    dx: -190
                },
                y: {
                    align: "center",
                    dy: 220
                },
                rotation: 15
            },
            premiumOfferBadge: {
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 220
                },
                rotation: 15
            },
            rewards: {
                margin: 30,
                background: {
                    width: 416,
                    height: 416
                },
                icon: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 10
                    }
                },
                ribbon: {
                    x: {
                        align: "left",
                        dx: 1
                    },
                    y: {
                        align: "top",
                        dy: 4
                    }
                },
                text: {
                    x: {
                        align: "center",
                        dx: -26
                    },
                    y: {
                        align: "center",
                        dy: 36
                    },
                    width: 120,
                    height: 74,
                    rotation: -45
                },
                ticket: {
                    x: {
                        align: "right",
                        dx: 109
                    },
                    y: {
                        align: "bottom",
                        dy: -100
                    },
                    scale: 1.3
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.passLogic = e, this._super({
                    name: "PassBuyTicketWindow",
                    title: "PassBuyTicketWindow.title",
                    content: this.createContent(),
                    closeButton: !0,
                    contentPadding: cleverapps.styles.PassBuyTicketWindow.contentPadding
                }), this.createBadge()
            },
            createContent: function () {
                var e = cleverapps.styles.PassBuyTicketWindow,
                    t = this.createTicket(),
                    s = Messages.get("PassBuyTicketWindow.lowerText"),
                    s = cleverapps.splitHalfByWord(s).join("\n"),
                    s = cleverapps.UI.generateOnlyText(s, cleverapps.styles.FONTS.GOLDEN_TICKET_TEXT),
                    i = (s.fitTo(e.texts.width),
                        s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.createRewards()),
                    n = this.createButtons();
                return new cleverapps.Layout([t, i, s, n], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin,
                    padding: e.padding
                })
            },
            createTicket: function () {
                var e = cleverapps.styles.PassBuyTicketWindow.ticket,
                    t = this.passLogic.mission.type === Mission.TYPE_SALEPASS ? "purchase_ticket_json" : "ticket_json",
                    t = new cleverapps.Spine(bundles.passbuyticket_window.jsons[t], 1.3),
                    s = (t.setPositionRound({
                        align: "center"
                    }, {
                        align: "center"
                    }), t.setAnimation(0, "animation", !0), new cc.Node);
                return s.setAnchorPoint2(), s.setContentSize2(e), s.addChild(t), s
            },
            createRewards: function () {
                var s = cleverapps.styles.PassBuyTicketWindow.rewards,
                    e = this.passLogic.levels.map(function () {
                        var e = new cc.Scale9Sprite(bundles.passbuyticket_window.frames.icon_background);
                        return e.setContentSize2(s.background), e
                    }),
                    i = new cleverapps.GridLayout(e, {
                        columns: 12 <= e.length ? Math.ceil(e.length / 3) : 5,
                        margin: s.margin,
                        padding: s.padding
                    });
                return e.forEach(function (e, t) {
                    t = PassRewardIcon.createIconsFromRewardsList(this.passLogic.levels[t].premiumReward, this.passLogic.levels[t].level, !0)[0];
                    t.setPositionRound(e.x + s.icon.dx, e.y + s.icon.dy), cleverapps.UI.fitToBox(t, s.icon), i.addChild(t), t.rewardName && cleverapps.tooltipManager.create(t, {
                        text: t.rewardName,
                        position: cleverapps.styles.UI.Tooltip.LOCATION.below
                    })
                }, this), bundles.passbuyticket_window.frames.rewards_background_special && ((e = cleverapps.UI.createScale9Sprite(bundles.passbuyticket_window.frames.rewards_background_special, cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(i.width, i.height), e.setPositionRound(i.width / 2, i.height / 2), i.addChild(e, -1)), i
            },
            createButtons: function () {
                var e = cleverapps.styles.PassBuyTicketWindow.buttons;
                return new UseGoldButton({
                    type: cleverapps.styles.UI.Button.Images.button_green,
                    price: PassMissionLogic.GetPrice(this.passLogic.mission),
                    onClicked: this.buyTicket.bind(this),
                    eventName: cleverapps.EVENTS.SPENT.BATTLE_PASS,
                    width: e.width,
                    height: e.height
                })
            },
            createBadge: function () {
                var e = cleverapps.styles.PassBuyTicketWindow,
                    t = new TileBadge({
                        type: "value",
                        value: "200%",
                        rotation: e.badge.rotation
                    });
                this.window.addChild(t, 2), t.setPositionRound(e.badge)
            },
            buyTicket: function () {
                this.passLogic.setPremium(), this.close(), new RewardWindow({
                    battlePass: {
                        missionType: this.passLogic.mission.type
                    }
                })
            },
            listBundles: function () {
                return ["passbuyticket_window"]
            },
            getPreferredBundles: function () {
                return ["passbuyticket_window"]
            }
        })),
        CupTableView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            GOLDEN_TICKET_TEXT: {
                size: 40,
                color: new cc.Color(121, 75, 57, 255)
            }
        }), cleverapps.styles.PassBuyTicketWindow = {
            margin: 40,
            padding: {
                x: 10,
                top: -20
            },
            texts: {
                width: 800
            },
            buttons: {
                width: 300,
                height: 110
            },
            ticket: {
                width: 180,
                height: 200,
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            badge: {
                rotation: -15,
                x: {
                    align: "left",
                    dx: -60
                },
                y: {
                    align: "top",
                    dy: 50
                }
            },
            rewards: {
                width: 1e3,
                margin: {
                    x: 10,
                    y: 10
                },
                padding: {
                    x: 25,
                    top: 20,
                    bottom: 30
                },
                background: {
                    width: 120,
                    height: 120
                },
                icon: {
                    width: 100,
                    height: 100,
                    maxScale: 1,
                    dx: 0,
                    dy: 0
                }
            },
            contentPadding: {
                left: 50,
                right: 50
            }
        }, cc.Node.extend({
            ctor: function (e, t, s) {
                s = s || {}, this._super(), this.cup = e, this.tableConstructor = t, this.table = this.tableConstructor(), this.scaleDuration = s.scaleDuration, this.scaleEasing = s.scaleEasing, this.updateSize(), this.setAnchorPoint2(), this.updatePosition(), this.addChild(this.table), this.cupStart = this.cup.start, this.updateState(), this.cup.onChangedTable = this.createListener(this.updateState.bind(this))
            },
            updateSize: function () {
                this.setContentSize2(this.table.getContentSize())
            },
            updatePosition: function () {
                this.table.setPositionRound(this.width / 2, this.height / 2)
            },
            updateState: function () {
                if (!this.animationRunning) {
                    var e;
                    if (this.cup.start === this.cupStart) return e = this.cup.listParticipants(), this.table.updateResults(e) ? void cleverapps.cupsTopTable.updateResults(this.cup.type, e) : (this.cupStart = void 0, void this.updateState());
                    this.animationRunning = !0, this.hideTable(function () {
                        cleverapps.cupsTopTable.updateResults(this.cup.type, this.cup.listParticipants()), this.cupStart = this.cup.start,
                            this.recreateTable(), this.showTable(function () {
                                this.animationRunning = !1
                            }.bind(this))
                    }.bind(this))
                }
            },
            recreateTable: function () {
                var e = this.table.getPosition();
                this.table.removeFromParent(), this.table = this.tableConstructor(), this.table.setPositionRound(e), this.addChild(this.table)
            },
            showTable: function (e) {
                this.table.setScale(0), this.table.runAction(new cc.Sequence(new cc.ScaleTo(this.scaleDuration || .5, 1).easing(this.scaleEasing || cc.easeBackOut()), new cc.CallFunc(e)))
            },
            hideTable: function (e) {
                this.table.runAction(new cc.Sequence(new cc.ScaleTo(this.scaleDuration || .5, 0).easing(this.scaleEasing || cc.easeBackIn()), new cc.CallFunc(e)))
            }
        })),
        DailyCupScene = cleverapps.FixedWidthScene.extend({
            onSceneLoaded: function () {
                this._super(cleverapps.Environment.SCENE_DAILY_CUP), cleverapps.environment.episodeNo = Episode.Types.DAILYCUP;
                var e = new DailyCupView(cleverapps.dailyCup);
                this.addChild(e), cleverapps.playSession.set(cleverapps.EVENTS.CUP_DAU + cleverapps.dailyCup.type, !0), cleverapps.placements.run(
                    Placements.INTERMEDIATE)
            },
            getBackgroundStyles: function () {
                return {
                    bundle: "daily_cup",
                    patternId: bundles.daily_cup.urls.daily_cup_pattern && "daily_cup_pattern",
                    backgroundId: "daily_cup_bg"
                }
            },
            playIntro: function (e) {
                cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.CUP_RULES + cleverapps.dailyCup.type) ? e() : (new GuideWindow({
                    name: "DailyCupRulesWindow"
                }), cleverapps.meta.onceNoWindowsListener = function () {
                    cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.CUP_RULES + cleverapps.dailyCup.type, !0), e()
                })
            },
            listBundles: function () {
                return ["daily_cup"]
            }
        }),
        DailyCupView = cc.Node.extend({
            ctor: function () {
                this._super();
                var e = cleverapps.styles.DailyCupView,
                    t = this.createTitle(),
                    s = this.createTimerBlock(),
                    i = this.createTable(),
                    t = new cleverapps.Layout([t, s, i], {
                        margin: e.topLayout.margin,
                        direction: cleverapps.UI.VERTICAL
                    }),
                    s = this.createHelpButton(),
                    i = this.createLeadersButton(),
                    n = this.playButton = this.createPlayButton(),
                    s = this.buttonsLayout = new cleverapps.Layout([s, n, i], {
                        margin: e.buttonsLayout.margin,
                        direction: cleverapps.UI.HORIZONTAL
                    }),
                    n = new cleverapps.Layout([t, s], {
                        margin: e.margin,
                        direction: cleverapps.UI.VERTICAL
                    }),
                    i = (this.setAnchorPoint2(), this.setContentSize2(n.width, n.height), n.setPositionRound(this.width / 2, this.height / 2), this.addChild(n), this.noConnectionInfo = this.createNoConnectionInfo());
                i.setPositionRound(n.width / 2, n.height / 2), n.addChild(i, 1), this.updateState(), cleverapps.dailyCup.reload(), cleverapps.dailyCup.onChangedView = this.createListener(this.updateState.bind(this)), this.updateSize(), this.updatePosition(), new HidingNode(this.buttonsLayout, cleverapps.UI.VERTICAL), cleverapps.meta.registerControl("dailyCupButtons", this.buttonsLayout)
            },
            updatePosition: function () {
                var e = cleverapps.styles.DailyCupView;
                this.setPositionRound(e.position)
            },
            updateSize: function () {
                var e = cleverapps.styles.DailyCupView,
                    t = cleverapps.scenes.getRunningScene(),
                    t = t && t.width || cleverapps.UI.getSceneSize().width;
                this.setScale(t < e.baseWidth ? t / e.baseWidth : 1)
            },
            updateState: function () {
                this.animationRunning || (
                    cleverapps.dailyCup.isRunning() ? (this.finishedText.setVisible(!1), this.timer.setVisible(!0), this.timer.countDown.resetTimeLeft(cleverapps.dailyCup.getTimeLeft()), this.playButton.setString("Play"), this.playButton.enable()) : (this.finishedText.setVisible(!0), this.timer.setVisible(!1), cleverapps.dailyCup.getReward() ? (this.playButton.setString("Claim"), this.playButton.enable()) : cleverapps.dailyCup.isActive() && cleverapps.dailyCup.isFinished() ? (this.playButton.setString("Next"), this.playButton.enable()) : (this.playButton.setString("Play"), this.playButton.disable())), cleverapps.dailyCup.hasConnection() ? this.noConnectionInfo.setVisible(!1) : (this.noConnectionInfo.setVisible(!0), this.playButton.disable()))
            },
            createTitle: function () {
                var e = cleverapps.styles.DailyCupView.title,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2(e), new cc.Scale9Sprite(bundles.daily_cup.frames.daily_cup_title_bg_png)),
                    s = (s.setContentSize2(e), t.addChild(s), s.setPositionRound(e.bg), cleverapps.UI.generateOnlyText(
                        "Cups.daily.title", cleverapps.styles.FONTS.DAILY_CUP_TITLE_TEXT));
                return s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), s.fitTo(e.text.width), t.addChild(s), s.setPositionRound(e.text), t
            },
            createTimerBlock: function () {
                var e = cleverapps.styles.DailyCupView,
                    t = new cc.Node;
                return t.setAnchorPoint2(), t.setContentSize2(e.timerBlock), this.timer = this.createTimer(), t.addChild(this.timer), this.timer.setPositionRound(t.width / 2, t.height / 2), this.finishedText = this.createFinishedText(), t.addChild(this.finishedText), this.finishedText.setPositionRound(t.width / 2, t.height / 2), t
            },
            createTimer: function () {
                var e = cleverapps.styles.DailyCupView,
                    t = cleverapps.dailyCup.getTimeLeft(),
                    s = new cc.Scale9Sprite(bundles.timer.frames.timer_bg_png);
                return s.setContentSize2(e.timer.bg), new cleverapps.CountDownView(new cleverapps.CountDown(t), {
                    font: cleverapps.styles.FONTS.DAILY_CUP_TIMER_TEXT,
                    background_content: s
                })
            },
            createFinishedText: function () {
                var e = cleverapps.styles.DailyCupView,
                    t = new cc.Scale9Sprite(bundles.timer.frames.timer_bg_png),
                    s = (t.setContentSize2(e.finishedText), cleverapps.UI.generateOnlyText("Cups.daily.finished", cleverapps.styles.FONTS.WHITE_TEXT));
                return t.addChild(s), s.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), s.fitTo(t.width - 2 * e.finishedText.padding.x, t.height - 2 * e.finishedText.padding.y), s.setPositionRound(t.width / 2, t.height / 2), t
            },
            createTable: function () {
                return new CupTableView(cleverapps.dailyCup, function () {
                    return cleverapps.cupsTopTable.createTableView({
                        id: cleverapps.dailyCup.type,
                        data: cleverapps.dailyCup.listParticipants(),
                        rowConstructor: cleverapps.DailyCupRow,
                        height: cleverapps.styles.DailyCupView.height
                    })
                })
            },
            createHelpButton: function () {
                return new cleverapps.UI.HelpButton(function () {
                    cleverapps.meta.display({
                        focus: "DailyCupRulesWindow",
                        action: function (e) {
                            new GuideWindow({
                                name: "DailyCupRulesWindow",
                                title: "DailyCupRulesWindow.title"
                            }), cleverapps.meta.onceNoWindowsListener = e
                        }
                    })
                })
            },
            createPlayButton: function () {
                var e = cleverapps.styles.DailyCupView;
                return new cleverapps.UI.Button({
                    text: "Play",
                    width: e.playButton.width,
                    height: e.playButton.height,
                    onClicked: function () {
                        this.animationRunning || cleverapps.meta.display({
                            focus: "PlayDailyCup",
                            actions: [function (e) {
                                this.animationRunning = !0, cleverapps.dailyCup.isRunning() ? cleverapps.dailyCup.wantsToPlay(e) : cleverapps.dailyCup.getReward() ? cleverapps.dailyCup.receiveReward(e) : (cleverapps.dailyCup.isActive() && cleverapps.dailyCup.isFinished() && cleverapps.dailyCup.next(), e())
                            }.bind(this), function (e) {
                                e(), this.animationRunning = !1, this.updateState()
                            }.bind(this)]
                        })
                    }.bind(this)
                })
            },
            createLeadersButton: function () {
                var e = cleverapps.styles.DailyCupView,
                    t = new cc.Sprite(bundles.daily_cup.frames.daily_cup_leaders_icon_png);
                return cleverapps.UI.fitToBox(t, e.leadersButton), t.baseScale = t.scale, cleverapps.UI.applyHover(t), cleverapps.UI.onClick(t, function () {
                    cleverapps.meta.display({
                        focus: "DailyCupLeadersWindow",
                        action: function (e) {
                            new DailyCupLeadersWindow, cleverapps.meta.onceNoWindowsListener = e
                        }
                    })
                }), t
            },
            createNoConnectionInfo: function () {
                var e = cleverapps.styles.DailyCupView.noConnectionInfo,
                    t = new cc.Scale9Sprite(bundles.timer.frames.timer_bg_png),
                    e = (t.setContentSize2(e.bg), cleverapps.UI.generateOnlyText("InternetConnectionError", cleverapps.styles.FONTS.WHITE_TEXT));
                return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setPositionRound(t.width / 2, t.height / 2), e.setDimensions(t.width, 0), e.fitTo(void 0, t.height), t.addChild(e), t
            }
        }),
        DailyCupLeadersWindow = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            DAILY_CUP_TIMER_TEXT: {
                name: "default",
                color: cleverapps.styles.COLORS.WHITE,
                size: 40,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            DAILY_CUP_TITLE_TEXT: {
                name: "default",
                color: cleverapps.styles.COLORS.WHITE,
                size: 60,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.DailyCupView = {
            height: 640,
            margin: 40,
            baseWidth: 800,
            position: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -30
                }
            },
            topLayout: {
                margin: 20
            },
            title: {
                width: 500,
                height: 150,
                bg: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: -30
                    }
                },
                text: {
                    width: 250,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: -10
                    }
                }
            },
            table: {
                height: 650,
                paddingX: 20
            },
            timerBlock: {
                width: 300,
                height: 100
            },
            timer: {
                bg: {
                    width: 270,
                    height: 55
                }
            },
            finishedText: {
                width: 400,
                height: 80,
                padding: {
                    x: 10,
                    y: 5
                }
            },
            buttonsLayout: {
                margin: 20
            },
            playButton: {
                width: 300,
                height: 125
            },
            leadersButton: {
                width: 100,
                height: 100
            },
            noConnectionInfo: {
                bg: {
                    width: 480,
                    height: 120
                }
            }
        }, Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.DailyCupLeadersWindow,
                    e = (this.content = new cc.Node, this.content.setAnchorPoint2(), this.content.setContentSize(e.width, e.height), this._super({
                        title: "DailyCupLeadersWindow.Title",
                        name: "dailycupleaderswindow",
                        content: this.content
                    }), cleverapps.cupsLeadersTable.getResults("cache"));
                e ? this.leadersOnLoad(e[0]) : (this.loading = new LeadersLoading, this.loading.setPosition(this.content.width / 2, this.content.height / 2), this.content.addChild(this.loading), cleverapps.RestClient.get(
                    "/dailycup/leaders/" + encodeURIComponent(cleverapps.platform.getUserID()), {}, this.createListener(this.leadersOnLoad.bind(this)),
                    function () {
                        cleverapps.notification.create("LeadersLoadFailed")
                    }))
            },
            leadersOnLoad: function (e) {
                this.loading && (this.loading.remove(), cleverapps.cupsLeadersTable.updateResults("cache", [e]));
                for (var t = e.leaders, s = !1, i = 0; i < t.length; i++)
                    if (t[i].id === cleverapps.platform.getUserID()) {
                        t[i].player = s = !0;
                        break
                    } s || (e = {
                        id: cleverapps.platform.getUserID(),
                        firstPlace: e.playerResult.firstPlace,
                        secondPlace: e.playerResult.secondPlace,
                        thirdPlace: e.playerResult.thirdPlace,
                        player: !0,
                        avatar: cleverapps.friends.getPlayer().avatar,
                        text: cleverapps.friends.getPlayer().name,
                        notInTop: !0
                    }, t.push(e)), t.forEach(function (e, t) {
                        e.place = t + 1
                    });
                e = this.table = cleverapps.cupsLeadersTable.createTableView({
                    id: "dailyCupLeadersWindow",
                    data: t,
                    rowConstructor: cleverapps.DailyCupLeadersRow
                });
                e.setPositionRound(this.content.width / 2, this.content.height / 2), this.content.addChild(e)
            }
        })),
        CupsConfig = (
            cleverapps.styles.DailyCupLeadersWindow = {
                width: 650,
                height: 750
            }, "undefined" == typeof cc && ((cleverapps = require("../utils")).Environment = {}, cleverapps.Availables = {
                CLANS: {}
            }, RewardsConfig = {}, Forces = {}), {}),
        Cup = (CupsConfig.TYPE_DAILY = "daily", CupsConfig.TYPE_WEEKLY = "weekly", CupsConfig.TYPE_CLAN = "clan", CupsConfig.TYPE_CLAN_INNER = "claninner", CupsConfig.TYPES = {}, CupsConfig.TYPES[CupsConfig.TYPE_DAILY] = {
            available: {
                level: 10,
                registered: "7 days",
                projectName: ["riddles", "heroes", "adventure", "runes", "wordsoup", "crocword", "magicwords", "olympics", "scramble", "tripeaks", "spades"]
            },
            scenes: [cleverapps.Environment.SCENE_MAIN, cleverapps.Environment.SCENE_DAILY_CUP],
            rewards: RewardsConfig.DailyCup,
            force: Forces.DAILY_CUP,
            duration: cleverapps.parseInterval("1 hour"),
            cooldown: 0,
            topLimit: 25,
            statsLimit: 25
        }, -1 !== ["wordsoup", "scramble", "magicwords", "crocword"].indexOf(cleverapps.config.name) && (CupsConfig.TYPES[CupsConfig.TYPE_DAILY].duration = cleverapps.parseInterval("3 hours")), cleverapps.config.debugMode && (
            CupsConfig.TYPES[CupsConfig.TYPE_DAILY].duration = cleverapps.parseInterval("3 minutes")), CupsConfig.TYPES[CupsConfig.TYPE_WEEKLY] = {
                available: {
                    level: 0,
                    projectName: ["olympics"]
                },
                scenes: [cleverapps.Environment.SCENE_LOADER, cleverapps.Environment.SCENE_MAIN],
                rewards: RewardsConfig.WeeklyCup,
                duration: cleverapps.parseInterval("1 week"),
                cooldown: 0,
                restartAfter: cleverapps.parseInterval("1 minute"),
                topLimit: 25
            }, cleverapps.config.debugMode && (CupsConfig.TYPES[CupsConfig.TYPE_WEEKLY].duration = cleverapps.parseInterval("3 minutes")), CupsConfig.TYPES[CupsConfig.TYPE_CLAN] = {
                available: Object.assign({}, cleverapps.Availables.CLANS, {
                    projectName: [],
                    disabled: !0
                }),
                scenes: [cleverapps.Environment.SCENE_MAIN],
                rewards: RewardsConfig.ClanCup,
                origin: new Date("2022-10-06T00:00:00+00:00").getTime(),
                duration: cleverapps.parseInterval("4 days"),
                cooldown: cleverapps.parseInterval("10 days"),
                restartAfter: cleverapps.parseInterval("1 day"),
                participateAsClan: !0,
                topLimit: 50
            }, cleverapps.config.debugMode && (
                CupsConfig.TYPES[CupsConfig.TYPE_CLAN].duration = cleverapps.parseInterval("4 minutes"), CupsConfig.TYPES[CupsConfig.TYPE_CLAN].cooldown = cleverapps.parseInterval("1 minute"), CupsConfig.TYPES[CupsConfig.TYPE_CLAN].restartAfter = cleverapps.parseInterval("30 seconds")), CupsConfig.TYPES[CupsConfig.TYPE_CLAN_INNER] = Object.assign({}, CupsConfig.TYPES[CupsConfig.TYPE_CLAN], {
                    master: CupsConfig.TYPE_CLAN,
                    rewards: [],
                    participateAsClan: !1,
                    topLimit: 50
                }), CupsConfig.IsEnabled = function (e) {
                    e = CupsConfig.TYPES[e];
                    return e && e.available && e.available.projectName && -1 !== e.available.projectName.indexOf(cleverapps.config.name)
                }, "undefined" == typeof cc && (module.exports = CupsConfig), function (e, t) {
                    this.type = e, this.config = CupsConfig.TYPES[this.type], this.innerCup = t, CupsConfig.IsEnabled(this.type) && (this.onChangedView = function () { }, this.onChangedTable = function () { }, this.onChangedIcon = function () { }, this.load(), this.reload(!0), setInterval(this.reload.bind(this), Cup.RELOAD_INTERVAL))
                }),
        Subscription = (
            Cup.prototype.runOnChangeListeners = function () {
                this.onChangedIcon(), this.onChangedView(), this.onChangedTable()
            }, Cup.prototype.load = function () {
                var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.CUP + this.type),
                    e = (this.participantId = (e = e || {}).participantId, this.start = e.start || 0, this.end = e.end || 0, this.stars = e.stars || 0, this.delta = e.delta || 0, this.state = void 0 === e.state ? Cup.STATE_PENDING : e.state, this.participants = [], clearTimeout(this.timeout), this.getTimeLeft());
                e && (this.timeout = new cleverapps.LongTimeout(this.reload.bind(this), e))
            }, Cup.prototype.save = function () {
                var e = {
                    participantId: this.participantId,
                    start: this.start,
                    end: this.end,
                    stars: this.stars,
                    delta: this.delta,
                    state: this.state
                };
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.CUP + this.type, e)
            }, Cup.prototype.next = function () {
                this.state = Cup.STATE_PENDING, this.save(), this.runOnChangeListeners(), this.reload(), this.innerCup && this.innerCup.next()
            }, Cup.prototype.updateCup = function (e) {
                if (!e || !e.start) return this.state = Cup.STATE_PENDING, void this.save();
                this.start !== e.start && (this.start = e.start || 0, this.delta = 0, this.state = Cup.STATE_RUNNING, this.wantsToShow = !0, cleverapps.cupsTopTable.resetResults(this.type), cleverapps.cupsLeadersTable.resetResults("cache")), this.participantId = e.participantId, this.end = Date.now() + e.time || 0, this.stars = e.stars + this.delta || 0, this.participants = e.participants || [], clearTimeout(this.timeout);
                e = this.getTimeLeft();
                e ? (this.state = Cup.STATE_RUNNING, this.timeout = new cleverapps.LongTimeout(this.reload.bind(this), e)) : this.state === Cup.STATE_RUNNING && (this.state = Cup.STATE_FINISHED, this.getReward() || (this.state = Cup.STATE_RECEIVED, this.wantsToShow = !1), cleverapps.cupsLeadersTable.resetResults("cache")), this.save()
            }, Cup.prototype.isAvailable = function (e) {
                return CupsConfig.IsEnabled(this.type) && cleverapps.user.checkAvailable(this.config.available, e)
            }, Cup.prototype.isActive = function () {
                return this.state !== Cup.STATE_PENDING
            }, Cup.prototype.isRunning = function () {
                return this.state === Cup.STATE_RUNNING && this.getTimeLeft()
            }, Cup.prototype.isFinished = function () {
                return this.state !== Cup.STATE_RUNNING
            }, Cup.prototype.hasConnection = function () {
                return !this.noConnection
            }, Cup.prototype.getTimeLeft = function () {
                return Math.max(0, this.end - Date.now())
            }, Cup.prototype.reload = function (e) {
                var t, s, i;
                !this.reloading && this.isAvailable() && (e || cleverapps.environment.hasScene(this.config.scenes)) && (this.state === Cup.STATE_RECEIVED && this.end + this.config.restartAfter < Date.now() ? this.next() : (t = this.delta, this.delta = 0, this.save(), e = function () {
                    this.reloading = !1, this.noConnection = !0, this.delta += t, this.save(), this.runOnChangeListeners()
                }.bind(this), s = function (e) {
                    this.reloading = !1, this.noConnection = !1, this.updateCup(e), this.runOnChangeListeners()
                }.bind(this), this.reloading = !0, i = {
                    type: this.type,
                    userId: cleverapps.platform.getUserID(),
                    delta: t
                }, this.state !== Cup.STATE_PENDING && (i.start = this.start), cleverapps.RestClient.post("/dailycup/sync/", i, s, e)))
            }, Cup.prototype.addAmount = function (e) {
                this.isRunning() && e && (this.stars += e, this.delta += e, this.save(), this.runOnChangeListeners())
            }, Cup.prototype.listParticipants = function () {
                for (var e, t = this.participants.slice(), s = 0; s < t.length; ++s) t[s].id === this.participantId && (e = t[s]);
                var i = cleverapps.friends.getPlayer();
                return this.type === CupsConfig.TYPE_CLAN && (i = cleverapps.userClan), e || (e = {
                    id: i.id,
                    avatar: i.avatar || i.emblem,
                    name: i.name
                }, t.push(e)), e.amount = this.stars, e.player = !0, t.sort(function (e, t) {
                    return t.amount - e.amount
                }), t.forEach(function (e, t) {
                    e.cup = this, e.place = t + 1, e.text = e.name, this.config.participateAsClan && (e.emblem = e.avatar)
                }.bind(this)), t
            }, Cup.prototype.calcPlace = function () {
                if (this.stars) {
                    for (var e = 0; e < this.participants.length; e++) {
                        var t = this.participants[e];
                        if (t.id === this.participantId) return e;
                        if (t.amount < this.stars) return e
                    }
                    return this.participants.length
                }
            }, Cup.prototype.listRewards = function () {
                return this.config.rewards
            }, Cup.prototype.getReward = function () {
                if (this.state === Cup.STATE_FINISHED) return this.listRewards()[this.calcPlace()]
            }, Cup.prototype.receiveReward = function (e) {
                var t = this.getReward(),
                    s = this.calcPlace();
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.CUP_REWARD + this.type + "_" + this.start + "_" + (s + 1)), RewardWindow.createCupsWindow(t, this.type), cleverapps.meta.onceNoWindowsListener = e, this.state = Cup.STATE_RECEIVED, this.save(), this.runOnChangeListeners()
            }, Cup.prototype.withLives = function () {
                return cleverapps.lives && "board" !== cleverapps.config.type
            }, Cup.prototype.wantsToPlay = function (e) {
                if (this.withLives() && cleverapps.lives.isEmpty()) return new LivesShopWindow, void (cleverapps.meta.onceNoWindowsListener = e);
                var t = Episode.LevelChooseAlgorithm({
                    start: 5,
                    seed: 1e3 * (this.start || 0) + (this.stars || 0)
                }),
                    t = new Episode(t.episodeNo, t.levelNo, {
                        type: Episode.Types.DAILYCUP
                    });
                MethaHelper.start(e, t.getLevel())
            }, Cup.prototype.getForce = function () {
                return this.config.force
            }, Cup.prototype.needsAttention = function () {
                var e = this.calcPlace();
                return this.getReward() || void 0 !== e && e !== this.lastShownPlace
            },
            Cup.prototype.afterWindowShown = function () {
                this.wantsToShow = !1, this.lastShownPlace = cleverapps.clanCup.calcPlace()
            }, Cup.STATE_RUNNING = 0, Cup.STATE_FINISHED = 1, Cup.STATE_RECEIVED = 2, Cup.STATE_PENDING = 3, Cup.RELOAD_INTERVAL = cleverapps.parseInterval("30 seconds"),
            function () {
                cleverapps.EventEmitter.call(this), this.active = !1, this.rewardTime = 0, this.tokens = {}, this.updateInfo(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SUBSCRIPTION) || {}, !1), this.reload(), cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, this.reload.bind(this))
            }),
        SubscriptionWindow = (Subscription.prototype = Object.create(cleverapps.EventEmitter.prototype), (Subscription.prototype.constructor = Subscription).calcSource = function () {
            var e = cleverapps.platform.source;
            return e = "mobile_ok" === e ? "web_ok" : e
        }, Subscription.prototype.getInfo = function (e) {
            var t = {
                active: this.active,
                rewardTime: this.rewardTime,
                tokens: this.tokens
            },
                e = (e && cleverapps.platform.oneOf(Apple) && delete t.tokens, {});
            return e[Subscription.calcSource()] = t, e
        },
            Subscription.prototype.updateInfo = function (e, t) {
                var s = Subscription.calcSource();
                (e = e && e[s]) && (this.active = Boolean(e.id) || e.active, this.rewardTime = e.rewardTime || e.lastRewardTime || 0, this.tokens = cleverapps.override({}, e.tokens || {}, this.tokens), this.save(t))
            }, Subscription.prototype.save = function (e) {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SUBSCRIPTION, this.getInfo()), e || cleverapps.synchronizer.addUpdateTask("subscription")
            }, Subscription.prototype.getLeftTime = function () {
                if (this.isActive()) return Math.max(this.rewardTime + cleverapps.parseInterval(Subscription.REWARD_INTERVAL) - Date.now(), 0)
            }, Subscription.prototype.scheduleReload = function () {
                clearTimeout(this.reloadTimeout), this.reloadTimeout = new cleverapps.LongTimeout(this.reload.bind(this), cleverapps.parseInterval(Subscription.RELOAD_INTERVAL))
            }, Subscription.prototype.reload = function () {
                this.scheduleReload(), cleverapps.platform.oneOf(CleverApps) && !cleverapps.config.debugMode && this.active && (this.active = !1, this.save(), this.trigger(
                    "update")), !Subscription.IsAvailable() || cleverapps.isLocalhost() || cleverapps.platform.oneOf(CleverApps) || cleverapps.payments.getSubscriptionStatus({
                        tokens: this.tokens
                    }, function (e) {
                        var t = this.isActive();
                        this.active = e && e.active, this.save(), this.trigger("update"), t && !this.isActive() && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SUBSCRIPTION_CANCELLED)
                    }.bind(this))
            }, Subscription.prototype.buy = function (e, t) {
                var s = function (e) {
                    e && (cleverapps.platform.oneOf(IOS, MacOS, AndroidPlatform) && Subscription.BUY_RELOADS.forEach(function (e) {
                        new cleverapps.LongTimeout(this.reload.bind(this), cleverapps.parseInterval(e))
                    }, this), this.scheduleReload(), this.active = !0, this.rewardTime = 0, this.save(), this.trigger("update"), this.receiveReward(), t())
                }.bind(this);
                cleverapps.platform.oneOf(CleverApps) ? s(cleverapps.config.debugMode) : e.buy(s)
            }, Subscription.prototype.addPurchaseTokens = function (e, t) {
                Array.isArray(e) || (e = [e]);
                var o = !1;
                e.forEach(function (e) {
                    var t = e.name,
                        s = e.purchaseToken,
                        i = e.productId,
                        e = e.packageName,
                        n = this.tokens[t] || {};
                    t && s && i && e && (n.purchaseToken !== s || n.productId !== i || n.packageName !== e) && (this.tokens[t] = {
                        productId: i,
                        packageName: e,
                        purchaseToken: s
                    }, o = !0)
                }.bind(this)), o && (t && !this.isActive() && (this.lastReloadTime = 0, this.reload()), this.save())
            }, Subscription.prototype.isRewardReady = function () {
                return 0 === this.getLeftTime()
            }, Subscription.prototype.needsAttention = function () {
                return this.isRewardReady()
            }, Subscription.CalcReward = function () {
                var e = "instant" === Subscription.calcSource() && RewardsConfig.SubscriptionInstant,
                    e = cleverapps.clone(e || RewardsConfig.Subscription, !0);
                return cleverapps.user.setRandomBoostersReward(e)
            }, Subscription.prototype.receiveReward = function () {
                if (this.isRewardReady()) {
                    var e = Subscription.CalcReward();
                    if (e.unit) {
                        var t = -Game.currentGame.map.countEmptySlots();
                        if (cleverapps.toArray(e.unit).forEach(function (e) {
                            t += e.amount
                        }), 0 < t) return void Game.currentGame.centerHint.createTextHint("Spawn.nospace", {
                            left: t
                        })
                    }
                    new RewardWindow(e, {
                        title: "SubscriptionRewardWindow.title",
                        name: "subscriptionrewardwindow",
                        text: "MiniGameRewardWindow.text",
                        toMainWorld: cleverapps.travelBook.isExpedition()
                    }), this.rewardTime = Date.now(), this.save(), this.trigger("update"), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SUBSCRIPTION_REWARD)
                }
            }, cleverapps.config.debugMode && (Subscription.prototype.reset = function () {
                this.active = !1, this.rewardTime = 0, this.tokens = {}, this.save()
            }), Subscription.prototype.isActive = function () {
                return this.active
            }, Subscription.prototype.needDisplayWindow = function () {
                return Subscription.IsAvailable() && !this.isActive()
            }, Subscription.IsAvailable = function () {
                return !!Subscription.IsModelAvailable() && (!(!cleverapps.subscription || !cleverapps.subscription.isActive()) || !(cleverapps.platform.oneOf(AndroidPlatform) && cleverapps.payments instanceof YooKassaPayments) && (!(cleverapps.payments instanceof InstantPayments && !cleverapps.payments.isSubscriptionsAvailable()) && (cleverapps.payments.isAvailable() && cleverapps.user.checkAvailable(Subscription.AVAILABLE))))
            },
            Subscription.IsModelAvailable = function () {
                var e = [];
                switch (cleverapps.platform.source) {
                    case "web_ok":
                    case "mobile_ok":
                        e = Subscription.MODEL_AVAILABLE_OK;
                        break;
                    case "facebook":
                        e = Subscription.MODEL_AVAILABLE_FACEBOOK;
                        break;
                    case "android":
                        e = Subscription.MODEL_AVAILABLE_ANDROID;
                        break;
                    case "ios":
                    case "macos":
                        e = Subscription.MODEL_AVAILABLE_IOS;
                        break;
                    case "instant":
                        e = cleverapps.config.debugMode ? Subscription.MODEL_AVAILABLE_INSTANT : [];
                        break;
                    case "cleverapps":
                        e = cleverapps.config.debugMode ? Subscription.MODEL_AVAILABLE_XSOLLA : []
                }
                return -1 !== (e = cleverapps.config.debugMode && (cleverapps.platform instanceof OKPlatform || cleverapps.platform instanceof MobileOK || TestSocial.isAppropriate()) ? Subscription.MODEL_AVAILABLE_OK.concat(Subscription.MODEL_AVAILABLE_FACEBOOK) : e).indexOf(cleverapps.config.name)
            }, Subscription.MODEL_AVAILABLE_OK = ["mergecraft", "wondermerge", "fairy", "heroes", "riddles", "wordsoup", "crocword", "tripeaks", "runes", "olympics", "scramble", "differences", "magicwords"], Subscription.MODEL_AVAILABLE_FACEBOOK = [
                "mergecraft", "wondermerge", "fairy", "heroes", "riddles", "wordsoup", "crocword", "tripeaks", "scramble", "magicwords", "runes", "differences"
            ], Subscription.MODEL_AVAILABLE_ANDROID = ["mergecraft", "wondermerge", "fairy", "heroes", "riddles", "wordsoup", "crocword", "tripeaks", "olympics", "scramble", "differences"], Subscription.MODEL_AVAILABLE_IOS = ["mergecraft", "crocword", "wordsoup", "tripeaks"], Subscription.MODEL_AVAILABLE_INSTANT = ["mergecraft", "wondermerge", "fairy", "tripeaks"], Subscription.MODEL_AVAILABLE_XSOLLA = ["mergecraft", "wondermerge", "fairy", "heroes", "riddles", "wordsoup", "crocword", "tripeaks", "runes", "olympics", "scramble", "differences", "magicwords"], Subscription.AVAILABLE = {
                level: 6
            }, "merge" === cleverapps.config.type && (Subscription.AVAILABLE = {
                level: 7.5
            }), Subscription.REWARD_INTERVAL = "24 hours", Subscription.RELOAD_INTERVAL = "30 minutes", Subscription.BUY_RELOADS = ["1 minute", "3 minutes", "5 minutes", "10 minutes"], cleverapps.config.debugMode && (Subscription.REWARD_INTERVAL = "20 minutes",
                Subscription.RELOAD_INTERVAL = "1 minute", Subscription.BUY_RELOADS = ["5 seconds", "10 seconds", "15 seconds", "20 seconds", "30 seconds", "40 seconds"]), Window.extend({
                    onWindowLoaded: function () {
                        this.weekProduct = Product.Create("subsWeek"), this.monthProduct = Product.Create("subsMonth"), cleverapps.platform.oneOf(Microsoft) && cleverapps.config.debugMode && (this.weekProduct = Product.Create("subsWeekTest"), this.monthProduct = Product.Create("subsMonthTest")), this._super({
                            name: "SubscriptionWindow",
                            content: this.createContent(),
                            noBackground: !0,
                            title: "SubscriptionWindow.Title",
                            notCloseByTouchInShadow: !0,
                            closeButtonDelay: !0
                        }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SUBSCRIPTION_WINDOW_OPEN), Lottery.addText(this)
                    },
                    getPerson: function () {
                        return "merge" !== cleverapps.config.type && {
                            role: "hero",
                            emotion: "happy"
                        }
                    },
                    buySubscription: function (e) {
                        cleverapps.subscription.buy(e, this.createListener(function () {
                            this.close()
                        }.bind(this)))
                    },
                    createContent: function () {
                        var e = cleverapps.styles.SubscriptionWindow,
                            t = this.prizesView = this.createRewardsList(),
                            s = [],
                            t = (s.unshift(this.createFooter()), s.unshift(new SubscriptionButtons({
                                monthProduct: this.monthProduct,
                                weekProduct: this.weekProduct,
                                buySubscription: this.buySubscription.bind(this)
                            })), s.unshift(new SubscriptionInfo), s.unshift(t), cleverapps.UI.generateOnlyText("SubscriptionRewardsList.subtitle", cleverapps.styles.FONTS.SUBSCRIPTION_PRIZE_SUBTITLE));
                        return t.fitTo(e.subtitle.width, e.subtitle.height), s.unshift(t), new cleverapps.Layout(s, {
                            direction: cleverapps.UI.VERTICAL,
                            margin: e.margin,
                            padding: e.padding
                        })
                    },
                    createFooter: function () {
                        var e, t = new Terms,
                            s = cleverapps.styles.SubscriptionWindow;
                        return t.width > .9 * s.width && t.setScale(.9 * s.width / t.width), !cleverapps.subscription.isActive() && cleverapps.platform.oneOf(IOS, MacOS) && (e = new Restore(this)).setScale(t.getScale()), new cleverapps.Layout([t, e], {
                            direction: cleverapps.UI.VERTICAL
                        })
                    },
                    onShow: function () {
                        this._super(), this.prizesView.showUp && this.prizesView.showUp()
                    },
                    createRewardsList: function () {
                        var e = cleverapps.overrideStyles(cleverapps.styles.RewardWindow.rewards, cleverapps.styles.SubscriptionWindow.rewards, !0);
                        return new RewardsListComponent(Subscription.CalcReward(), {
                            font: cleverapps.styles.FONTS.REWARDWINDOW_VALUE_TEXT,
                            iconWrap: e.iconWrap,
                            margin: e.margin,
                            textMargin: e.textMargin
                        })
                    },
                    getPreferredBundles: function () {
                        return ["game"]
                    }
                })),
        SubscriptionButtons = (cleverapps.overrideStyles(cleverapps.styles.DECORATORS, {
            SUBSCRIPTION_WINDOW_GOLD_OFFER_STROKE: {
                color: new cc.Color(46, 83, 26, 255),
                size: 2
            }
        }), cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            SUBSCRIPTION_PRIZE_SUBTITLE: {
                size: 48,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.SubscriptionWindow = {
            width: 600,
            margin: 15,
            padding: {
                top: 20
            },
            rewards: {
                margin: {
                    y: 20
                },
                textMargin: -10
            },
            subtitle: {
                width: 600,
                height: 70
            }
        }, cleverapps.GridLayout.extend({
            ctor: function (e) {
                var t = cleverapps.styles.SubscriptionButtons,
                    s = cleverapps.platform.oneOf(IOS),
                    i = s ? Messages.get(
                        "SubscriptionWindow.iosMonthButton", {
                        price: Product.ReplaceIconCodes(e.monthProduct.getCurrentPrice())
                    }) : e.monthProduct.getCurrentPrice(),
                    i = this.createBuyButton(e.monthProduct, e.buySubscription, cleverapps.styles.UI.Button.Images.button_blue, i),
                    n = (Lottery.addIcon(i), Messages.get(s ? "SubscriptionWindow.iosWeekButton" : "SubscriptionWindow.Free", {
                        price: Product.ReplaceIconCodes(e.weekProduct.getCurrentPrice())
                    })),
                    n = this.createBuyButton(e.weekProduct, e.buySubscription, cleverapps.styles.UI.Button.Images.button_green, n),
                    o = Messages.get(0 === e.weekProduct.trial.indexOf("3 day") ? "SubscriptionWindow.ThreeDaysAdditional" : "SubscriptionWindow.OneDayAdditional", {
                        newline: "\n"
                    }),
                    s = (s && (o = Messages.get("SubscriptionWindow.iOSThreeDaysAdditional", {
                        price: Product.ReplaceIconCodes(e.weekProduct.getCurrentPrice())
                    })), (o = cleverapps.UI.generateOnlyText(o, cleverapps.styles.FONTS.SUBSCRIPTION_BUTTON_TITLE)).setDimensions(t.buttonWidth, 0), o.fitTo(void 0, t.titleHeight), o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),
                        "SubscriptionWindow.MonthlyAdditional");
                (s = cleverapps.UI.generateOnlyText("SubscriptionWindow.MonthlyAdditional", cleverapps.styles.FONTS.SUBSCRIPTION_BUTTON_TITLE)).setDimensions(t.buttonWidth, 0), s.fitTo(void 0, t.titleHeight), s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this._super([o, s, n, i], {
                    columns: 2,
                    align: {
                        y: cleverapps.UI.ALIGN_START
                    },
                    margin: t.margin
                })
            },
            createBuyButton: function (e, t, s, i) {
                var n = cleverapps.styles.SubscriptionButtons;
                return new cleverapps.UI.Button({
                    text: i || e.getCurrentPrice(),
                    type: s,
                    width: n.buttonWidth,
                    height: n.buttonHeight,
                    onClicked: function () {
                        t(e)
                    }
                })
            }
        })),
        SubscriptionInfo = (cleverapps.styles.SubscriptionButtons = {
            contentObjectsMargin: 7,
            buttonWidth: 270,
            buttonHeight: 100,
            titleHeight: 70,
            margin: {
                x: 40,
                y: 7
            }
        }, cleverapps.Layout.extend({
            ctor: function () {
                var e, t = cleverapps.styles.SubscriptionInfo,
                    s = cleverapps.UI.generateOnlyText("SubscriptionWindow.MainText", cleverapps.styles.FONTS.SUBSCRIPTION_MAIN_TEXT);
                s.setDimensions(cleverapps.styles.SubscriptionWindow.width, 0),
                    s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), cleverapps.clans && Clans.IsAvailable() && (e = new cc.Sprite(bundles.reward_icons.frames.clan_gift_png), e = new TextWithIcon("** ClanGift.Text", {
                        font: cleverapps.styles.FONTS.SUBSCRIPTION_MAIN_TEXT,
                        icons: {
                            "**": e
                        },
                        iconMaxHeight: 2
                    })), this._super([s, e].filter(Boolean), {
                        direction: cleverapps.UI.VERTICAL,
                        margin: t.margin,
                        padding: t.padding
                    })
            }
        })),
        ExpeditionMissionLogic = (cleverapps.styles.SubscriptionInfo = {
            margin: 15,
            padding: {
                x: 0,
                y: 10
            }
        }, function (e, t) {
            this.mission = e, this.expedition = Missions[e.type].id, this.episode = Missions[e.type].episode, this.level = Missions[e.type].level, this.slot = Missions[e.type].slot, t && (this.clearSavedGames(), this.clearUnitsLibrary(), cleverapps.travelBook.onNewExpeditionMission(e.type), cleverapps.offerManager.clearForceByMission(e.type), Landmarks.clearForce(this.expedition), cleverapps.user.registered > ExpeditionMissionLogic.EXPEDITIONS_LOG_SINCE && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.EXPEDITIONS.PLAY + this.expedition))
        }),
        FeastExpeditionLogic = (ExpeditionMissionLogic.prototype.stop = function (e) {
            e || cleverapps.travelBookHint.checkMission(this.mission)
        }, ExpeditionMissionLogic.prototype.clearSavedGames = function () {
            cleverapps.GameSaver.saveInfo(this.slot, {})
        }, ExpeditionMissionLogic.prototype.clearUnitsLibrary = function () {
            var t = {},
                e = (cleverapps.travelBook.listAvailablePages().forEach(function (e) {
                    e.id !== this.expedition && e.isRunning() && (e = new Episode(e.episode, e.level).getLevel(), Object.assign(t, e.families))
                }.bind(this)), new Episode(this.episode, this.level).getLevel()),
                e = Object.keys(e.families).filter(function (e) {
                    return !t[e]
                });
            cleverapps.unitsLibrary.resetFamilies(e)
        }, ExpeditionMissionLogic.prototype.resetPush = function () {
            this.mission.getTimeLeft() >= ExpeditionMissionLogic.ATTENTION_TIMEOUT && cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.EXPEDITION, ExpeditionMissionLogic.ATTENTION_TIMEOUT)
        }, ExpeditionMissionLogic.prototype.sendPeriodicPush = function () {
            var e = cleverapps.DataLoader.load(
                cleverapps.DataLoaderTypes.EXPEDITION_PUSH_PLANNING_TIME) || 0;
            Date.now() > e + ExpeditionMissionLogic.PERIODIC_PUSH_TIMEOUT && this.mission.getTimeLeft() >= ExpeditionMissionLogic.PERIODIC_PUSH_TIMEOUT && (cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.EXPEDITION_PERIODIC, ExpeditionMissionLogic.PERIODIC_PUSH_TIMEOUT), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.EXPEDITION_PUSH_PLANNING_TIME, Date.now()))
        }, ExpeditionMissionLogic.prototype.getPrize = function () {
            var e, t, s = Fogs.LoadOpened(this.expedition);
            for (t in ExpeditionMissionLogic.REWARDS) s[t] && (e = ExpeditionMissionLogic.REWARDS[t]);
            return e
        }, ExpeditionMissionLogic.prototype.blowUp = function (e) {
            var t = function (e) {
                var t = [];
                this.mission.getChildMissions().forEach(function (e) {
                    t.push(e.displayCompleted.bind(e))
                }), cleverapps.meta.compound(e, t)
            }.bind(this);
            cleverapps.meta.compound(e, [function (e) {
                function t() {
                    !i.typing && i.stage >= i.data.length - 1 && i.close()
                }
                var s = [{
                    text: Messages.get("ExpeditionFinishWindow.text"),
                    person: {
                        role: "king",
                        emotion: "happy"
                    }
                }],
                    i = new Dialogue(s, {
                        showUp: !0
                    });
                i.on("buttonClicked", t), i.on("screenClicked", t), i.on("afterClose", e), new DialogueView(i)
            }, function (e) {
                Game.currentGame.collectAndRemoveAllUnits(e)
            }, t, function (e) {
                cleverapps.travelBook.isExpedition() ? cleverapps.travelBook.gotoMainScene(e) : e()
            }])
        }, ExpeditionMissionLogic.prototype.canRemoveSilently = function () {
            return Date.now() - this.mission.finishTime() > ExpeditionMissionLogic.AUTO_REMOVE_TIMEOUT
        }, ExpeditionMissionLogic.prototype.beforeRemove = function () {
            cleverapps.eventBus.trigger("taskEvent", DailyTasks.FINISH_EXPEDITION)
        }, ExpeditionMissionLogic.prototype.canShowCompleted = function () {
            return cleverapps.environment.hasEpisode(this.episode)
        }, ExpeditionMissionLogic.EXPEDITIONS_LOG_SINCE = new Date("2022-10-27").getTime(), ExpeditionMissionLogic.ATTENTION_TIMEOUT = cleverapps.parseInterval("2 days"), ExpeditionMissionLogic.PERIODIC_PUSH_TIMEOUT = cleverapps.parseInterval("3 days"), ExpeditionMissionLogic.AUTO_REMOVE_TIMEOUT = cleverapps.parseInterval(
            "14 days"), cleverapps.config.debugMode && (ExpeditionMissionLogic.ATTENTION_TIMEOUT = cleverapps.parseInterval("10 minutes")), ExpeditionMissionLogic.REWARDS = {
                fog1: {
                    soft: 10
                },
                fog6: {
                    soft: 10,
                    lives: 10
                },
                fog16: {
                    soft: 20,
                    lives: 20
                },
                fog26: {
                    soft: 30,
                    lives: 30
                },
                fog36: {
                    soft: 50,
                    lives: 50
                }
            }, function (e) {
                (this.mission = e).isRunning() && cleverapps.eventBus.on("gameEvent", this.onGameEvent.bind(this), this)
            }),
        GrowthFund = (FeastExpeditionLogic.prototype.stop = function () {
            runCleaners(this)
        }, FeastExpeditionLogic.prototype.onGameEvent = function (e, t) {
            if (MissionManager.hasProperParent(this.mission)) {
                var s, i, n, o, a = 0;
                if (Mission.GetChildType(this.mission.type) === Mission.TYPE_SNAIL_FEAST) e === Merge.SPAWN && -1 !== ["drsnail", "seasnail"].indexOf(t.unit.code) && (a = this.getSnailPoints(t.unit.stage), i = t.affected && Unit.IsApplicable({
                    type: "snailhouse"
                }, t.affected) ? t.affected : t.unit);
                else {
                    switch (e) {
                        case Merge.RUDOLF_COMPLETED:
                            a = t.points, i = t.unit;
                            break;
                        case Merge.COMPLETE_MINING:
                            i = t.unit, s = t.task.time;
                            break;
                        case Merge.BUILD:
                            i = t.affected,
                                s = t.time;
                            break;
                        case Merge.SPAWN:
                            Array.isArray(t.affected) && t.unit.isBuilt() && (i = t.unit, n = void 0 !== t.unit.getData().createPrize ? 500 : 0, 6 <= (o = t.unit.stage - 1) ? a = cleverapps.Random.random(10, 13) : 5 == o ? a = cleverapps.Random.random(8, 11) : 4 == o ? a = cleverapps.Random.random(6, 9) : 3 == o ? a = cleverapps.Random.random(4, 7) : 2 == o ? a = cleverapps.Random.random(2, 5) : 1 == o ? a = cleverapps.Random.random(1, 3) : 0 == o && (a = 1))
                    }
                    s && (a = s >= cleverapps.parseInterval("60 minutes") ? 3 : s >= cleverapps.parseInterval("10 minutes") ? 2 : 1)
                }
                0 < a && i && this.collectFromUnit(a, i, n)
            }
        }, FeastExpeditionLogic.prototype.getSnailPoints = function (e) {
            return this.snailPoints || (this.snailPoints = {}), this.snailPoints[e] || (0 === e ? t = 0 : 1 === e ? t = 1 : 2 === e ? t = 3 : 2.5 < (t = Math.round(2.5 * this.getSnailPoints(e - 1))) % 5 ? t = t - t % 5 + 5 : t -= t % 5, this.snailPoints[e] = t);
            var t
        }, FeastExpeditionLogic.prototype.collectFromUnit = function (e, t, s) {
            Game.currentGame.addReward("mission", {
                missionType: this.mission.type,
                amount: e
            }, t, {
                delay: s || 0
            })
        }, FeastExpeditionLogic.prototype.beforeRemove = function () {
            var e;
            Mission.GetChildType(this.mission.type) !== Mission.TYPE_SNAIL_FEAST || cleverapps.gameModes.multipleHeroes || ((e = {})[Mission.TYPE_DRAGONIA2_EXPEDITION] = "drsnail", e[Mission.TYPE_DRAGONIA3_EXPEDITION] = "drsnail", e[Mission.TYPE_UNDERSEA2_EXPEDITION] = "seasnail", Game.currentGame.replaceUnit({
                code: e[Mission.GetParentType(this.mission.type)]
            }, function (e) {
                var t = {},
                    t = (t[Mission.TYPE_DRAGONIA2_EXPEDITION] = "drresource", t[Mission.TYPE_DRAGONIA3_EXPEDITION] = "drresource", t[Mission.TYPE_UNDERSEA2_EXPEDITION] = "searesource", cleverapps.unitsLibrary.listAvailableByType(t[Mission.GetParentType(this.mission.type)])),
                    t = cleverapps.Random.choose(t);
                return {
                    code: t,
                    stage: Math.min(3, e.stage, Families[t].units.length - 1)
                }
            }.bind(this)))
        }, function () {
            cleverapps.EventEmitter.call(this), this.received = -1, this.levels = [], this.load(), this.createLevels(), cleverapps.user.on("incLevel", this.onUserIncLvl.bind(this)), cleverapps.exp.on("changeExp", this.onUserChangeExp.bind(this)), this.isBought() && cleverapps.playSession.set(
                cleverapps.EVENTS.FUND_DAU, !0)
        }),
        Products = (GrowthFund.prototype = Object.create(cleverapps.EventEmitter.prototype), (GrowthFund.prototype.constructor = GrowthFund).prototype.isBought = function () {
            return -1 < this.received
        }, GrowthFund.prototype.onUserChangeExp = function () {
            var e;
            cleverapps.flags.videoAdsMainMonetization || (e = this.isActive(), this.wantsAttention = this.wantsAttention || e && !this.wasActive, this.wasActive = e)
        }, GrowthFund.prototype.onUserIncLvl = function () {
            cleverapps.gameLevel && cleverapps.gameLevel.withOwnLevel || (this.calcLevelsState(), !cleverapps.flags.videoAdsMainMonetization && this.isActive() && this.findByLevelNo(cleverapps.user.getVirtualLevel() - 1) && (this.wantsAttention = !0))
        }, GrowthFund.prototype.afterBuy = function (e) {
            this.buyTime = Date.now(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FUND_BUY), this.received = 0, this.save(), e || this.onBought()
        }, GrowthFund.prototype.onBought = function () {
            this.trigger("updateState")
        }, GrowthFund.prototype.createLevels = function () {
            for (
                var e = GrowthFund.LEVELS.start; e <= GrowthFund.LEVELS.finish; e += GrowthFund.LEVELS.step) this.levels.push({
                    levelNo: e,
                    reward: GrowthFund.LEVELS.rewards[e] || GrowthFund.LEVELS.rewards.default
                });
            this.calcLevelsState()
        }, GrowthFund.prototype.calcLevelsState = function () {
            this.levels.forEach(function (e) {
                e.levelNo > cleverapps.user.getVirtualLevel() - 1 ? e.state = GrowthFund.STATE.INSUFFICIENT : e.levelNo <= this.received ? e.state = GrowthFund.STATE.RECEIVED : 0 < this.received ? e.levelNo === this.received + GrowthFund.LEVELS.step ? e.state = GrowthFund.STATE.READY : e.state = GrowthFund.STATE.WAITING : e.levelNo === GrowthFund.LEVELS.start ? e.state = GrowthFund.STATE.READY : e.state = GrowthFund.STATE.WAITING
            }, this)
        }, GrowthFund.prototype.takeReward = function (e) {
            (!this.buyTime || Date.now() - this.buyTime > cleverapps.parseInterval("10 minutes")) && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FUND_GOLD, {
                amount: this.findByLevelNo(e).reward
            }), this.received = e, this.calcLevelsState(), this.trigger("updateState"), this.save()
        },
            GrowthFund.prototype.findByLevelNo = function (e) {
                for (var t in this.levels)
                    if (this.levels[t].levelNo === e) return this.levels[t]
            }, GrowthFund.prototype.findFirst = function (e) {
                for (var t in this.levels)
                    if (this.levels[t].state === e) return this.levels[t]
            }, GrowthFund.prototype.isRewardReady = function () {
                return this.findFirst(GrowthFund.STATE.READY)
            }, GrowthFund.prototype.save = function (e) {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.GROWTHFUND, this.getInfo()), e || cleverapps.synchronizer.addUpdateTask("growthfund")
            }, GrowthFund.prototype.getInfo = function () {
                return this.received
            }, GrowthFund.prototype.load = function () {
                var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.GROWTHFUND);
                this.setInfo(void 0 === e ? -1 : e)
            }, GrowthFund.prototype.setInfo = function (e) {
                "object" == typeof (this.received = e) && (this.received = -1, !e.bought && void 0 === e.lastReceived || (this.received = e.lastReceived || 0)), this.wasActive = this.isActive()
            }, GrowthFund.prototype.updateInfo = function (e) {
                this.setInfo(e), this.save(!0),
                    this.calcLevelsState()
            }, GrowthFund.prototype.isActive = function () {
                return cleverapps.user.getFloatLevel() >= GrowthFund.LEVELS.available || this.isBought()
            }, GrowthFund.prototype.getTotalWaitingRewards = function () {
                var t = 0;
                return this.levels.forEach(function (e) {
                    -1 !== [GrowthFund.STATE.READY, GrowthFund.STATE.WAITING].indexOf(e.state) && (t += e.reward)
                }), t
            }, GrowthFund.prototype.needsAttention = function () {
                return this.isBought() && this.isRewardReady() || this.wantsAttention
            }, GrowthFund.GetRestoreReward = function () {
                if (cleverapps.growthFund && !cleverapps.growthFund.isBought()) return {
                    growthFund: !0
                }
            }, GrowthFund.STATE = {
                INSUFFICIENT: 0,
                WAITING: 1,
                READY: 2,
                RECEIVED: 3
            }, GrowthFund.LEVELS = {
                available: 6.1,
                start: 1,
                finish: 49,
                step: 1,
                rewards: {
                    default: 450,
                    1: 550
                }
            }, "undefined" == typeof cc && (cleverapps = require("../../utils"), "undefined" != typeof window && window.CRMClientApp && (cleverapps.config.source = void 0), bundles = {
                reward_icons: {
                    frames: {}
                }
            }, RewardsConfig = {
                Packs: []
            }), {}),
        PaymentsManager = (Products.DEPRECATED = {}, Products.ACTIVE = {},
            Products.MBGA_COIN_PRODUCTS = {}, Products.initialize = function () {
                Object.assign(Products.DEPRECATED, {
                    pack500: {
                        projects: ["mergecraft", "wondermerge"],
                        price: 5.99,
                        image: !1
                    },
                    pack2100: {
                        projects: ["mergecraft", "wondermerge"],
                        price: 25.99,
                        image: !1
                    },
                    pack14000: {
                        projects: ["mergecraft", "wondermerge"],
                        price: 129.99,
                        image: !1
                    },
                    pack3800: {
                        projects: ["mergecraft", "wondermerge"],
                        price: 25.99,
                        image: !1
                    },
                    pack25000: {
                        projects: ["mergecraft", "wondermerge"],
                        price: 129.99,
                        image: !1
                    },
                    addMoves: {
                        projects: ["heroes", "riddles", "spades", "tripeaks"],
                        title: "Shop.AddMoves.Title",
                        description: "Shop.AddMoves.Description",
                        boughtMessage: "Shop.AddMoves.BoughtMessage",
                        price: .99,
                        restoreReward: {
                            hard: 200
                        }
                    },
                    addMoves1: {
                        projects: ["adventure", "heroes", "riddles", "runes", "spades", "tripeaks"],
                        title: "Shop.AddMoves1.Title",
                        description: "Shop.AddMoves1.Description",
                        boughtMessage: "Shop.AddMoves.BoughtMessage",
                        price: .99,
                        moves: 5,
                        bonus: 1,
                        restoreReward: {
                            hard: 200
                        }
                    },
                    addMoves2: {
                        projects: ["adventure", "heroes", "riddles", "runes", "spades", "tripeaks"],
                        title: "Shop.AddMoves2.Title",
                        description: "Shop.AddMoves2.Description",
                        boughtMessage: "Shop.AddMoves.BoughtMessage",
                        price: 1.99,
                        moves: 10,
                        bonus: 1,
                        restoreReward: {
                            hard: 400
                        }
                    },
                    addMoves3: {
                        projects: ["adventure", "heroes", "riddles", "runes", "spades", "tripeaks"],
                        title: "Shop.AddMoves3.Title",
                        description: "Shop.AddMoves3.Description",
                        boughtMessage: "Shop.AddMoves.BoughtMessage",
                        price: 2.99,
                        moves: 15,
                        bonus: 1,
                        restoreReward: {
                            hard: 600
                        }
                    },
                    addMoves5: {
                        projects: ["adventure", "heroes", "riddles", "runes", "spades", "tripeaks"],
                        title: "Shop.AddMoves5.Title",
                        description: "Shop.AddMoves5.Description",
                        boughtMessage: "Shop.AddMoves.BoughtMessage",
                        price: 4.99,
                        moves: 15,
                        bonus: 2,
                        restoreReward: {
                            hard: 1e3
                        }
                    }
                }), "tripeaks" === cleverapps.config.name && cleverapps.override(Products.DEPRECATED, {
                    addMoves: {
                        id: {
                            yandex: "addMoves"
                        },
                        image: "/res/fbproducts/addmoves0.png"
                    },
                    addMoves1: {
                        price: 1.49
                    }
                }), -1 !== ["riddles", "tripeaks", "heroes", "adventure", "runes"].indexOf(cleverapps.config.name) && cleverapps.override(Products.DEPRECATED, {
                    addMoves1: {
                        id: {
                            yandex: "addMoves1"
                        },
                        image: "/res/fbproducts/addmoves.png"
                    },
                    addMoves2: {
                        id: {
                            yandex: "addMoves2"
                        },
                        image: "/res/fbproducts/addmoves.png"
                    },
                    addMoves3: {
                        id: {
                            yandex: "addMoves3"
                        },
                        image: "/res/fbproducts/addmoves.png"
                    },
                    addMoves5: {
                        id: {
                            yandex: "addMoves5"
                        },
                        image: "/res/fbproducts/addmoves.png"
                    }
                }), "match3" === cleverapps.config.type && Object.assign(Products.ACTIVE, {
                    buyExp10: {
                        title: "Shop.BuyExp10.Title",
                        description: "Shop.BuyExp10.Description",
                        boughtMessage: "Shop.BuyExp10.BoughtMessage",
                        price: 9.99,
                        reward: {
                            exp: 10
                        }
                    },
                    buyExp150: {
                        title: "Shop.BuyExp150.Title",
                        description: "Shop.BuyExp150.Description",
                        boughtMessage: "Shop.BuyExp150.BoughtMessage",
                        price: 99.99,
                        reward: {
                            exp: 150
                        }
                    }
                }), ["merge", "tile3", "none", "blocks"].includes(cleverapps.config.type) || Object.assign(Products.ACTIVE, {
                    piggybank500: {
                        title: "Shop.PiggyBank1.Title",
                        description: "Shop.PiggyBank1.Description",
                        price: 2.99,
                        restoreLogic: PiggyBank,
                        reward: {
                            hard: 500
                        }
                    },
                    piggybank1800: {
                        title: "Shop.PiggyBank2.Title",
                        description: "Shop.PiggyBank2.Description",
                        price: 9.99,
                        restoreLogic: PiggyBank,
                        reward: {
                            hard: 1800
                        }
                    },
                    piggybank6000: {
                        title: "Shop.PiggyBank3.Title",
                        description: "Shop.PiggyBank3.Description",
                        price: 29.99,
                        restoreLogic: PiggyBank,
                        reward: {
                            hard: 6e3
                        }
                    },
                    piggybank25000: {
                        title: "Shop.PiggyBank4.Title",
                        description: "Shop.PiggyBank4.Description",
                        price: 99.99,
                        restoreLogic: PiggyBank,
                        reward: {
                            hard: 25e3
                        }
                    }
                }), ["merge", "tile3"].includes(cleverapps.config.type) && Object.assign(Products.MBGA_COIN_PRODUCTS, {
                    coins350: {
                        id: {},
                        title: "Shop.Coins350.Title",
                        description: "Shop.Coins350.Description",
                        price: 1.99,
                        reward: {
                            soft: 350
                        },
                        icon: "shop_coins_very_small_png",
                        image: "/res/fbproducts/soft_currency_very_small_200.png?v=2",
                        boughtMessage: "Product.SoftCurrencyBought"
                    },
                    coins1100: {
                        id: {},
                        title: "Shop.Coins1100.Title",
                        description: "Shop.Coins1100.Description",
                        price: 3.99,
                        reward: {
                            soft: 1100
                        },
                        icon: "shop_coins_small_png",
                        image: "/res/fbproducts/soft_currency_small_200.png?v=2",
                        boughtMessage: "Product.SoftCurrencyBought"
                    },
                    coins3000: {
                        id: {},
                        title: "Shop.Coins3000.Title",
                        description: "Shop.Coins3000.Description",
                        price: 7.99,
                        reward: {
                            soft: 3e3
                        },
                        icon: "shop_coins_medium_png",
                        image: "/res/fbproducts/soft_currency_medium_200.png?v=2",
                        boughtMessage: "Product.SoftCurrencyBought"
                    },
                    coins7000: {
                        id: {},
                        title: "Shop.Coins7000.Title",
                        description: "Shop.Coins7000.Description",
                        price: 17.99,
                        reward: {
                            soft: 7e3
                        },
                        icon: "shop_coins_large_png",
                        image: "/res/fbproducts/soft_currency_large_200.png?v=2",
                        boughtMessage: "Product.SoftCurrencyBought"
                    }
                }), "merge" === cleverapps.config.type && Object.assign(Products.ACTIVE, {
                    expeditionPack: {
                        title: "Shop.expeditionPack.title",
                        description: "Shop.expeditionPack.description",
                        boughtMessage: "Shop.expeditionPack.boughtMessage",
                        price: 9.99,
                        restoreLogic: Offer,
                        restoreReward: {
                            hard: 1200
                        }
                    },
                    growthFund: {
                        title: "Shop.growthFund.title",
                        description: "Shop.growthFund.description",
                        boughtMessage: "Shop.growthFund.boughtMessage",
                        value: "800%",
                        icon: "growth_fund_icon",
                        mainSceneOnly: !0,
                        price: 24.99,
                        clanGift: !0,
                        restoreLogic: GrowthFund,
                        restoreReward: {
                            hard: 2800
                        },
                        TileModelClass: GrowthFundTileModel,
                        ViewClassName: GrowthFundTile
                    }
                }), cleverapps.config.lives && !["tile3", "none"].includes(cleverapps.config.type) && Object.assign(Products.ACTIVE, {
                    unlimitedLives: {
                        title: "UnlimitedLives.Title",
                        description: "UnlimitedLives.Description",
                        boughtMessage: "UnlimitedLivesBought",
                        image: "/res/fbproducts/unlimitedlives.png",
                        price: 2.99,
                        reward: {
                            unlimitedLives: "3 days"
                        },
                        icon: "unlimitedLives_png",
                        animation: "animation",
                        ViewClassName: LivesProductTile,
                        TileModelClass: BuyLivesTileModel
                    }
                }), ["none"].includes(cleverapps.config.type) || Object.assign(Products.ACTIVE, {
                    gold500: {
                        title: "Shop.Gold500.Title",
                        description: "Shop.Gold500.Description",
                        price: 2.99,
                        reward: {
                            hard: 500
                        },
                        rewardsIcon: "shop_gold_png",
                        icon: "shop_gold_very_small_png"
                    },
                    gold1800: {
                        title: "Shop.Gold1800.Title",
                        description: "Shop.Gold1800.Description",
                        price: 9.99,
                        oldPrice: 1.99,
                        label: 1800,
                        reward: {
                            hard: 1800
                        },
                        rewardsIcon: "shop_gold_png",
                        icon: "shop_gold_small_png"
                    },
                    gold3800: {
                        title: "Shop.Gold3800.Title",
                        description: "Shop.Gold3800.Description",
                        price: 19.99,
                        reward: {
                            hard: 3800
                        },
                        rewardsIcon: "shop_gold_png",
                        icon: "shop_gold_medium_png"
                    },
                    gold6000: {
                        title: "Shop.Gold6000.Title",
                        description: "Shop.Gold6000.Description",
                        price: 29.99,
                        clanGift: !0,
                        oldPrice: 5.99,
                        label: 6e3,
                        reward: {
                            hard: 6e3
                        },
                        rewardsIcon: "shop_gold_png",
                        icon: "shop_gold_large_png"
                    },
                    gold25000: {
                        title: "Shop.Gold25000.Title",
                        description: "Shop.Gold25000.Description",
                        price: 99.99,
                        clanGift: !0,
                        reward: {
                            hard: 25e3
                        },
                        rewardsIcon: "shop_gold_png",
                        icon: "shop_gold_huge_png"
                    },
                    starterPack0: {
                        title: "StarterPack0.Title",
                        description: "StarterPack0.Description",
                        boughtMessage: "StarterPack.Bought",
                        boughtMessageParams: {
                            title: "StarterPack0.Title"
                        },
                        restoreLogic: PackManager,
                        reward: RewardsConfig.Packs[0],
                        stage: 0,
                        mainSceneOnly: !0,
                        price: .99,
                        available: {
                            level: 2.65
                        }
                    },
                    starterPack: {
                        title: "StarterPack1.Title",
                        description: "StarterPack1.Description",
                        boughtMessage: "StarterPack.Bought",
                        boughtMessageParams: {
                            title: "StarterPack1.Title"
                        },
                        restoreLogic: PackManager,
                        reward: RewardsConfig.Packs[1],
                        stage: 1,
                        mainSceneOnly: !0,
                        price: 4.99,
                        available: {
                            level: 4.65
                        }
                    },
                    starterPack2: {
                        title: "StarterPack2.Title",
                        description: "StarterPack2.Description",
                        boughtMessage: "StarterPack.Bought",
                        boughtMessageParams: {
                            title: "StarterPack2.Title"
                        },
                        restoreLogic: PackManager,
                        reward: RewardsConfig.Packs[2],
                        stage: 2,
                        mainSceneOnly: !0,
                        price: 29.99,
                        available: {
                            level: 6.65
                        }
                    }
                }), ["none"].includes(cleverapps.config.type) || Object.assign(Products.ACTIVE, {
                    subsWeek: {
                        title: "Shop.SubsWeek.Title",
                        description: "Shop.SubsWeek.Description",
                        boughtMessage: "Shop.SubsWeek.BoughtMessage",
                        icon: "prem_tile_icon",
                        price: 9.99,
                        clanGift: !0,
                        trial: "1 day",
                        period: "2 weeks",
                        type: "subscription",
                        projects: ["riddles", "heroes", "wordsoup", "crocword", "olympics", "tripeaks", "scramble", "magicwords", "mergecraft", "wondermerge", "fairy", "runes", "differences"]
                    },
                    subsMonth: {
                        title: "Shop.SubsMonth.Title",
                        description: "Shop.SubsMonth.Description",
                        boughtMessage: "Shop.SubsMonth.BoughtMessage",
                        icon: "prem_tile_icon",
                        price: 14.99,
                        clanGift: !0,
                        period: "1 month",
                        type: "subscription",
                        projects: ["riddles", "heroes", "wordsoup", "crocword", "olympics", "tripeaks", "scramble", "magicwords", "mergecraft", "wondermerge", "fairy", "runes", "differences"],
                        TileModelClass: SubscriptionTileModel,
                        ViewClassName: SubscriptionTile
                    },
                    subsWeekTest: {
                        title: "Shop.SubsWeek.Title",
                        description: "Shop.SubsWeek.Description",
                        boughtMessage: "Shop.SubsWeek.BoughtMessage",
                        icon: "prem_tile_icon",
                        price: .05,
                        trial: "1 day",
                        period: "2 weeks",
                        type: "subscription",
                        projects: ["riddles", "heroes", "wordsoup", "crocword", "fairy"],
                        image: "/res/fbproducts/subsweek.png"
                    },
                    subsMonthTest: {
                        title: "Shop.SubsMonth.Title",
                        description: "Shop.SubsMonth.Description",
                        boughtMessage: "Shop.SubsMonth.BoughtMessage",
                        icon: "prem_tile_icon",
                        price: .1,
                        period: "1 month",
                        type: "subscription",
                        projects: ["riddles", "heroes", "wordsoup", "crocword", "fairy"],
                        image: "/res/fbproducts/subsmonth.png"
                    }
                }), -1 !== ["mergecraft", "wondermerge", "riddles", "tripeaks", "heroes", "scramble", "wordsoup", "crocword", "olympics", "magicwords", "adventure",
                    "runes", "differences"
                ].indexOf(cleverapps.config.name) && (cleverapps.override(Products.ACTIVE.gold500, {
                    id: {
                        facebook: "500gold.html",
                        android: "500gold",
                        amazon: "500gold",
                        ios: "500gold",
                        instant: "500gold",
                        yandex: "500gold"
                    },
                    image: "/res/fbproducts/gold2_200.png?v=3"
                }), cleverapps.override(Products.ACTIVE.gold1800, {
                    id: {
                        facebook: "1800gold.html",
                        android: "1800gold",
                        amazon: "1800gold",
                        ios: "1800gold",
                        instant: "1800gold"
                    },
                    image: "/res/fbproducts/gold3_200.png?v=2"
                }), cleverapps.override(Products.ACTIVE.gold3800, {
                    id: {
                        facebook: "3800gold.html",
                        android: "3800gold",
                        amazon: "3800gold",
                        ios: "3800gold",
                        instant: "3800gold"
                    },
                    image: "/res/fbproducts/heap_gold.png?v=4"
                }), cleverapps.override(Products.ACTIVE.gold6000, {
                    id: {
                        facebook: "6000gold.html",
                        android: "6000gold",
                        amazon: "6000gold",
                        ios: "6000gold",
                        instant: "6000gold"
                    },
                    image: "/res/fbproducts/gold4_200.png?v=1"
                }), cleverapps.override(Products.ACTIVE.gold25000, {
                    id: {
                        facebook: "25000gold.html",
                        android: "25000gold",
                        amazon: "25000gold",
                        ios: "25000gold",
                        instant: "25000gold"
                    },
                    image: "/res/fbproducts/gold5_200.png?v=1"
                }), cleverapps.override(Products.ACTIVE, {
                    starterPack0: {
                        id: {
                            yandex: "StarterPack0"
                        },
                        image: "/res/fbproducts/starter_pack0.png?v=1"
                    },
                    starterPack: {
                        id: {
                            yandex: "starterPack"
                        },
                        image: "/res/fbproducts/starter_pack.png?v=1"
                    },
                    starterPack2: {
                        id: {
                            yandex: "starterPack2"
                        },
                        image: "/res/fbproducts/starter_pack2.png?v=1"
                    }
                }), "merge" === cleverapps.config.type && (cleverapps.override(Products.ACTIVE.expeditionPack, {
                    image: "/res/fbproducts/expedition_pack.png"
                }), cleverapps.override(Products.ACTIVE.growthFund, {
                    image: "/res/fbproducts/growth_fund.png"
                })), ["merge", "tile3"].includes(cleverapps.config.type) || cleverapps.override(Products.ACTIVE, {
                    piggybank500: {
                        image: "/res/fbproducts/piggy_bank.png?v=1"
                    },
                    piggybank1800: {
                        image: "/res/fbproducts/piggy_bank.png?v=1"
                    },
                    piggybank6000: {
                        image: "/res/fbproducts/piggy_bank.png?v=1"
                    },
                    piggybank25000: {
                        image: "/res/fbproducts/piggy_bank.png?v=1"
                    }
                }), Products.ACTIVE.unlimitedLives && cleverapps.override(Products.ACTIVE.unlimitedLives, {
                    id: {
                        yandex: "unlimitedLives"
                    }
                }), cleverapps.override(Products.ACTIVE, {
                    subsWeek: {
                        image: "/res/fbproducts/premium.png"
                    },
                    subsMonth: {
                        image: "/res/fbproducts/premium.png"
                    },
                    subsWeekTest: {
                        image: "/res/fbproducts/premium.png"
                    },
                    subsMonthTest: {
                        image: "/res/fbproducts/premium.png"
                    }
                })), -1 !== ["riddles", "heroes", "runes", "adventure", "scramble", "tripeaks"].indexOf(cleverapps.config.name) && Object.assign(Products.ACTIVE, {
                    sweetPack: {
                        title: "TileShop.sweetPack.Title",
                        description: "TileShop.sweetPack.Description",
                        image: "/res/fbproducts/sweet_pack_200.png",
                        boughtMessage: "Shop.sweetPack.boughtMessage",
                        price: 5.99,
                        reward: {
                            hard: 500,
                            boosters: {
                                0: 1,
                                1: 1
                            }
                        },
                        icon: "pack500_png",
                        ViewClassName: PackProductTile
                    },
                    jamPack: {
                        title: "TileShop.jamPack.Title",
                        description: "TileShop.jamPack.Description",
                        image: "/res/fbproducts/jam_pack_200.png",
                        boughtMessage: "Shop.jamPack.boughtMessage",
                        price: 12.99,
                        reward: {
                            hard: 1800,
                            boosters: {
                                0: 1,
                                1: 1,
                                2: 1
                            }
                        },
                        icon: "pack1800_png",
                        ViewClassName: PackProductTile
                    },
                    tastyPack: {
                        title: "TileShop.tastyPack.Title",
                        description: "TileShop.tastyPack.Description",
                        image: "/res/fbproducts/tasty_pack_200.png?v=1",
                        boughtMessage: "Shop.tastyPack.boughtMessage",
                        price: 25.99,
                        reward: {
                            hard: 3800,
                            boosters: {
                                0: 3,
                                1: 3,
                                2: 3
                            }
                        },
                        icon: "pack3800_png",
                        ViewClassName: PackProductTile
                    },
                    honeyPack: {
                        title: "TileShop.honeyPack.Title",
                        description: "TileShop.honeyPack.Description",
                        image: "/res/fbproducts/honey_pack_200.png?v=1",
                        boughtMessage: "Shop.honeyPack.boughtMessage",
                        price: 39.99,
                        reward: {
                            hard: 6e3,
                            boosters: {
                                0: 5,
                                1: 5,
                                2: 5
                            }
                        },
                        icon: "pack6000_png",
                        ViewClassName: PackProductTile
                    },
                    epicPack: {
                        title: "TileShop.epicPack.Title",
                        description: "TileShop.epicPack.Description",
                        image: "/res/fbproducts/epic_pack_200.png?v=1",
                        boughtMessage: "Shop.epicPack.boughtMessage",
                        price: 129.99,
                        reward: {
                            hard: 25e3,
                            boosters: {
                                0: 20,
                                1: 20,
                                2: 20
                            }
                        },
                        icon: "pack25000_png",
                        ViewClassName: PackProductTile
                    }
                }), "zenmatch" === cleverapps.config.name && Object.assign(Products.ACTIVE, {
                    kit3: {
                        title: "Kit3.Title",
                        description: "Kit3.Description",
                        boughtMessage: "Kit3.Bought",
                        restoreReward: RewardsConfig.kit3,
                        image: "/res/fbproducts/kit.png",
                        price: 2.99
                    },
                    kit10: {
                        title: "Kit10.Title",
                        description: "Kit10.Description",
                        boughtMessage: "Kit10.Bought",
                        restoreReward: RewardsConfig.kit10,
                        image: "/res/fbproducts/kit.png",
                        price: 9.99
                    },
                    kit50: {
                        title: "Kit50.Title",
                        description: "Kit50.Description",
                        boughtMessage: "Kit50.Bought",
                        image: "/res/fbproducts/kit.png",
                        price: 49.99
                    }
                }), ["merge", "tile3", "blocks"].includes(cleverapps.config.type) && (Products.ACTIVE.gold500.reward = {
                    hard: 200
                }, Products.ACTIVE.gold1800.reward = {
                    hard: 900
                }, Products.ACTIVE.gold3800.reward = {
                    hard: 2100
                }, Products.ACTIVE.gold6000.reward = {
                    hard: 3500
                }, Products.ACTIVE.gold25000.reward = {
                    hard: 14e3
                }), "merge" === cleverapps.config.type && (Products.ACTIVE.starterPack0.available = {
                    level: 6.2
                }, Products.ACTIVE.starterPack.available = {
                    level: 8.2
                }, Products.ACTIVE.starterPack2.available = {
                    level: 10.2
                }), "solitaire" === cleverapps.config.type && "spades" !== cleverapps.config.name && (Products.ACTIVE.sweetPack.reward.boosters = {
                    10: 2,
                    11: 2,
                    12: 2
                }, Products.ACTIVE.jamPack.reward.boosters = {
                    10: 3,
                    11: 3,
                    12: 3
                }, Products.ACTIVE.tastyPack.reward.boosters = {
                    10: 5,
                    11: 5,
                    12: 5
                }, Products.ACTIVE.honeyPack.reward.boosters = {
                    10: 7,
                    11: 7,
                    12: 7
                }, Products.ACTIVE.epicPack.reward.boosters = {
                    10: 30,
                    11: 30,
                    12: 30
                }), "match3" === cleverapps.config.type && (Products.ACTIVE.sweetPack.reward.boosters = {
                    5: 1,
                    6: 1,
                    7: 1
                }, Products.ACTIVE.jamPack.reward.boosters = {
                    5: 2,
                    6: 2,
                    7: 2
                }, Products.ACTIVE.tastyPack.reward.boosters = {
                    0: 3,
                    1: 3,
                    5: 3,
                    6: 3,
                    7: 3
                }, Products.ACTIVE.honeyPack.reward.boosters = {
                    0: 5,
                    1: 5,
                    5: 5,
                    6: 5,
                    7: 5
                }, Products.ACTIVE.epicPack.reward.boosters = {
                    0: 18,
                    1: 18,
                    5: 18,
                    6: 18,
                    7: 18
                }), -1 !== ["android", "ios", "macos"].indexOf(cleverapps.config.source) && (Products.ACTIVE.subsWeek.price = 4.99, Products.ACTIVE.subsWeek.trial = "3 days", Products.ACTIVE.subsWeek.period = "1 week", Products.ACTIVE.subsWeek.title = "Shop.SubsWeek.ThreeDays.Title", Products.ACTIVE.subsWeek.description = "Shop.SubsWeek.ThreeDays.Description"), "scramble" === cleverapps.config.name && (Products.ACTIVE.sweetPack.reward.boosters = {
                    13: 2,
                    14: 2,
                    15: 2
                }, Products.ACTIVE.jamPack.reward.boosters = {
                    13: 3,
                    14: 3,
                    15: 3
                }, Products.ACTIVE.tastyPack.reward.boosters = {
                    13: 5,
                    14: 5,
                    15: 5
                }, Products.ACTIVE.honeyPack.reward.boosters = {
                    13: 7,
                    14: 7,
                    15: 7
                }, Products.ACTIVE.epicPack.reward.boosters = {
                    13: 30,
                    14: 30,
                    15: 30
                }), "mergecraft" === cleverapps.config.name && Object.assign(Products.DEPRECATED, {
                    gold1: {
                        title: "Shop.Gold1.Title",
                        description: "Shop.Gold1.Description",
                        price: .99,
                        reward: {
                            hard: 65
                        },
                        icon: "shop_gold_tiny_png",
                        id: {
                            android: "1gold",
                            amazon: "1gold",
                            ios: "1gold",
                            instant: "1gold"
                        },
                        image: "/res/fbproducts/gold1_200.png?v=3"
                    },
                    gold5: {
                        title: "Shop.Gold5.Title",
                        description: "Shop.Gold5.Description",
                        price: 4.99,
                        reward: {
                            hard: 455
                        },
                        icon: "shop_gold_very_small_png",
                        id: {
                            android: "5gold",
                            amazon: "5gold",
                            ios: "5gold",
                            instant: "5gold"
                        },
                        image: "/res/fbproducts/gold2_200.png?v=3"
                    },
                    gold10: {
                        title: "Shop.Gold10.Title",
                        description: "Shop.Gold10.Description",
                        price: 9.99,
                        reward: {
                            hard: 1e3
                        },
                        icon: "shop_gold_small_png",
                        id: {
                            android: "10gold",
                            amazon: "10gold",
                            ios: "10gold",
                            instant: "10gold"
                        },
                        image: "/res/fbproducts/gold3_200.png?v=2"
                    },
                    gold20: {
                        title: "Shop.Gold20.Title",
                        description: "Shop.Gold20.Description",
                        price: 19.99,
                        reward: {
                            hard: 2220
                        },
                        icon: "shop_gold_medium_png",
                        id: {
                            android: "20gold",
                            amazon: "20gold",
                            ios: "20gold",
                            instant: "20gold"
                        },
                        image: "/res/fbproducts/heap_gold.png?v=4"
                    },
                    gold50: {
                        title: "Shop.Gold50.Title",
                        description: "Shop.Gold50.Description",
                        price: 49.99,
                        reward: {
                            hard: 7145
                        },
                        icon: "shop_gold_large_png",
                        id: {
                            android: "50gold",
                            amazon: "50gold",
                            ios: "50gold",
                            instant: "50gold"
                        },
                        image: "/res/fbproducts/gold4_200.png?v=1"
                    },
                    gold100: {
                        title: "Shop.Gold100.Title",
                        description: "Shop.Gold100.Description",
                        price: 99.99,
                        reward: {
                            hard: 14285
                        },
                        icon: "shop_gold_huge_png",
                        id: {
                            android: "100gold",
                            amazon: "100gold",
                            ios: "100gold",
                            instant: "100gold"
                        },
                        image: "/res/fbproducts/gold5_200.png?v=1"
                    }
                }), Object.keys(Products.DEPRECATED).forEach(function (e) {
                    var t = Products.DEPRECATED[e];
                    t.projects && -1 === t.projects.indexOf(cleverapps.config.name) && delete Products.DEPRECATED[e]
                }), Object.keys(Products.ACTIVE).forEach(function (e) {
                    var t = Products.ACTIVE[e];
                    (-1 !== ["klondike"].indexOf(cleverapps.config.name) || t.projects && -1 === t.projects.indexOf(cleverapps.config.name)) && delete Products.ACTIVE[e]
                });
                var t = {
                    buyExp10: 1,
                    buyExp150: 2,
                    addMoves1: 8,
                    addMoves2: 9,
                    addMoves3: 10,
                    addMoves5: 11,
                    piggybank500: 12,
                    piggybank1800: 13,
                    piggybank6000: 14,
                    piggybank25000: 15,
                    addMoves: 20,
                    gold500: 21,
                    gold1800: 22,
                    gold3800: 39,
                    gold6000: 23,
                    gold25000: 24,
                    starterPack0: 25,
                    starterPack: 26,
                    starterPack2: 27,
                    subsWeek: 31,
                    subsMonth: 32,
                    subsWeekTest: 33,
                    subsMonthTest: 34,
                    sweetPack: 35,
                    jamPack: 36,
                    tastyPack: 40,
                    honeyPack: 37,
                    epicPack: 38,
                    unlimitedLives: 64,
                    growthFund: 73,
                    expeditionPack: 74,
                    coins350: 75,
                    coins1100: 76,
                    coins3000: 77,
                    coins7000: 78
                },
                    e = (Object.keys(Products.ACTIVE).concat(Object.keys(Products.MBGA_COIN_PRODUCTS), Object.keys(Products.DEPRECATED)).forEach(function (i) {
                        var n = Products.MBGA_COIN_PRODUCTS[i] || Products.ACTIVE[i] || Products.DEPRECATED[i],
                            e = (-1 !== ["macos", "ios"].indexOf(cleverapps.config.source) && 100 <= n.price && (n.price = 99.99), n.key = i, n.id = n.id || {}, ["android", "amazon", "ios", "instant", "yandex", "samsung", "rustore"]);
                        "subscription" === n.type && e.push("ok"), e.forEach(function (e) {
                            var t = i.toLowerCase();
                            void 0 === n.id[e] && (n.id[e] = t)
                        }), void 0 === n.id.facebook && (n.id.facebook = i.toLowerCase() + ".html"), void 0 === n.id.wortal && (n.id.wortal = "jp.rgames.testcrocword.purchase." + i.toLowerCase()), t[i] && (n.id.mymailru = t[i], n.id.mbga = t[i]), void 0 === n.image && (n.image = "/res/fbproducts/" + i.toLowerCase() + ".png"), ["android", "amazon", "ios"].forEach(function (e) {
                            var t = cleverapps.config[e] && cleverapps.config[e].iap || {},
                                s = t.items || {},
                                t = t.prefix || ("android" === e ? "" : "com.cleverapps." + cleverapps.config.name + ".");
                            n.id[e] = s[i] || t + n.id[e]
                        })
                    }), cleverapps.clone(Products.DEPRECATED, !0));
                Object.assign(e, cleverapps.clone(Products.ACTIVE, !0)), cleverapps.platform && cleverapps.platform.oneOf(Mobage, SPMobage) && Object.assign(e, cleverapps.clone(Products.MBGA_COIN_PRODUCTS)), cleverapps.config.products = e
            }, "undefined" == typeof cc && (Products.initialize(), module.exports = Products),
            function () {
                this.consumed = [], this.load(),
                    this.restoreThrottled = cleverapps.timeredThrottle(1e4, this.restore.bind(this)), this.tryLoadProductsThrottled = cleverapps.timeredThrottle(1e4, this.tryLoadProducts.bind(this)), cc.eventManager.addCustomListener(cc.game.EVENT_SHOW, this.tryLoadProductsThrottled.bind(this)), cleverapps.timeouts.setInterval(this.tryLoadProductsThrottled.bind(this), cleverapps.parseInterval("2 minutes")), cleverapps.timeouts.setInterval(this.restoreThrottled.bind(this), cleverapps.parseInterval(cleverapps.config.debugMode ? "1 minute" : "5 minutes")), cleverapps.platform.on("changeStatus:" + Platform.PAYMENTS, function (e) {
                        this.updateFlags(), e === Platform.STATUS_CONNECTED ? this.tryLoadProducts() : cleverapps.payments.productsLoaded = !1
                    }.bind(this))
            }),
        RestoreProgress = (PaymentsManager.prototype.createPayments = function () {
            var e = cleverapps.payments && cleverapps.payments.constructor,
                t = this.getPluginClass();
            return e === t || (this.stopLoadProductsPlayer(), this.stopRestorePlayer(), this.stopPurchasePlayer(), delete this.restorePurchase,
                cleverapps.payments && cleverapps.payments.clear(), cleverapps.payments = new t, PaymentOverlay.initialize()), cleverapps.payments
        }, PaymentsManager.prototype.getPluginClass = function () {
            var e;
            return NoPayments.isAppropriate() ? e = NoPayments : YooKassaPayments.isAppropriate() ? e = YooKassaPayments : WebViewPayments.isAppropriate() ? e = WebViewPayments : RuStorePayments.isAppropriate() ? e = RuStorePayments : XsollaPayments.isAppropriate() ? e = XsollaPayments : TestPayments.isAppropriate() ? e = TestPayments : InstantPayments.isAppropriate() ? e = InstantPayments : SPMobagePayments.isAppropriate() ? e = SPMobagePayments : OKPayments.isAppropriate() ? e = OKPayments : MobileMyMailRuPayments.isAppropriate() ? e = MobileMyMailRuPayments : SamsungPayments.isAppropriate() ? e = SamsungPayments : MyMailRuPayments.isAppropriate() ? e = MyMailRuPayments : MobileVkPayments.isAppropriate() ? e = MobileVkPayments : VKPayments.isAppropriate() ? e = VKPayments : MobagePayments.isAppropriate() ? e = MobagePayments : FotoStranaPayments.isAppropriate() ? e = FotoStranaPayments : DraugiemPayments.isAppropriate() ? e = DraugiemPayments : YandexPayments.isAppropriate() ? e = YandexPayments : MicrosoftPayments.isAppropriate() ? e = MicrosoftPayments : PlingaPayments.isAppropriate() ? e = PlingaPayments : KongregatePayments.isAppropriate() ? e = KongregatePayments : WortalPayments.isAppropriate() ? e = WortalPayments : FacebookPayments.isAppropriate() ? e = FacebookPayments : MygamesPayments.isAppropriate() ? e = MygamesPayments : WechatPayments.isAppropriate() && (e = WechatPayments), e
        }, PaymentsManager.prototype.updateFlags = function () {
            cleverapps.whenAllInitialized(function () {
                cleverapps.flags.update()
            })
        }, PaymentsManager.prototype.onUpdateCountry = function () {
            this.isPurchaseRunning() || cleverapps.platform.updatePlugin(Platform.PAYMENTS)
        }, PaymentsManager.prototype.stopRestorePlayer = function () {
            this.restorePlayer && (this.restorePlayer.stop(), delete this.restorePlayer)
        }, PaymentsManager.prototype.restore = function () {
            var n;
            cleverapps.payments.isAvailable() && cleverapps.payments.isRestoreAvailable() && !this.isPurchaseRunning() && !this.isRestoreRunning() && (this.restorePlayer = new ActionPlayer({
                actionTimeout: cleverapps.parseInterval("1 minute"),
                actions: [function (s, i) {
                    cleverapps.payments.restore(function (e, t) {
                        e === cleverapps.CODE_SUCCEED ? (t.restore = !0, n = t, s()) : i()
                    })
                }, function (t, s) {
                    if (this.isConsumed(n.paymentId)) return this.consume(n), void s();
                    cleverapps.payments.validate(n, function (e) {
                        e === cleverapps.CODE_SUCCEED ? t() : (this.consume(n), s())
                    }.bind(this))
                }.bind(this), function (e) {
                    this.restorePurchase = n, console.log("payments restore", n), e()
                }.bind(this), function (e) {
                    cleverapps.meta.isFocused() || this.showRestore(), e()
                }.bind(this)]
            })).play()
        }, PaymentsManager.prototype.showRestore = function () {
            var e = this.restorePurchase,
                t = e && e.productId && Product.Create(e.productId);
            !(t && e && cleverapps.environment.isMainScene()) || cleverapps.travelBook.isExpedition() && t.mainSceneOnly || (this.logPurchase(t, e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PRODUCT.RESTORE, {
                value: t.price
            }), this.consume(e),
                t.onBuyed({
                    restore: !0
                }), delete this.restorePurchase, this.restoreThrottled())
        }, PaymentsManager.prototype.load = function () {
            var e = cleverapps.platform.dataLoader.load(SimpleDataLoader.TYPES.PAYMENTS);
            e && (this.consumed = (e.consumed || []).slice())
        }, PaymentsManager.prototype.save = function () {
            cleverapps.platform.dataLoader.save(SimpleDataLoader.TYPES.PAYMENTS, {
                consumed: this.consumed.slice(-Payments.CONSUMED_STORAGE_LIMIT)
            })
        }, PaymentsManager.prototype.setConsumed = function (e) {
            e && !this.consumed.includes(e) && (this.consumed.push(e), this.save())
        }, PaymentsManager.prototype.isConsumed = function (e) {
            return e && this.consumed.includes(e)
        }, PaymentsManager.prototype.consume = function (e) {
            this.setConsumed(e.paymentId), cleverapps.payments.consume(e)
        }, PaymentsManager.prototype.purchase = function (n, s, e) {
            var t, o;
            if (s = cleverapps.once(s), this.isPurchaseRunning()) return cleverapps.notification.create("Product.PurchaseProcessing"), void s(!1, Product.PURCHASE_PROCESSING);
            if (!cleverapps.payments.isAvailable()) return cleverapps.notification.create("Product.PurchaseCancelled"), void s(!1, cleverapps.CODE_FAILED);
            var a = this.purchasePlayer = new ActionPlayer([function (e, t) {
                cleverapps.payments.setPurchaseState(PaymentsManager.STATE_SOCIAL), cleverapps.payments.freeFromLoginToPay() ? e() : cleverapps.social.checkConnection(e, t.bind(this, "ProductLoginNeeded"))
            }.bind(this), function (e, t) {
                (cleverapps.synchronizer._syncIn.needShowReloadWindow() ? t : e)()
            }, function (e, t) {
                cleverapps.payments.setPurchaseState(PaymentsManager.STATE_EMAIL);
                var s = cleverapps.info.getValue("email");
                !cleverapps.payments.requiresEmailToPay() || cleverapps.validateEmail(s) ? e() : new EmailWindow(e, t.bind(this, "ProductEmailNeeded"))
            }.bind(this), function (e) {
                cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PRODUCT.OPEN), t = new PaymentOverlay, cleverapps.scenes.getRunningScene().addChild(t), e()
            }, function (s, i) {
                console.log("PaymentsManager purchase start", n.loadedId, n.key), cleverapps.payments.setPurchaseState(PaymentsManager.STATE_PURCHASE),
                    n.openTime = Date.now(), cleverapps.payments.purchase(n, cleverapps.once(function (e, t) {
                        if (console.log("PaymentsManager purchase result", n.loadedId, n.key, e), console.log("PaymentsManager purchase purchaseInfo", JSON.stringify(t, cleverapps.cutStringsReplacer)), (e = cleverapps.config.debugMode && cleverapps.Tool.restoreCheck ? Product.RESTORE_CHECK : e) !== cleverapps.CODE_SUCCEED || a.isRunning())
                            if (e === cleverapps.CODE_SUCCEED) {
                                if (o = t || n, this.isConsumed(o.paymentId)) return this.consume(o), void i();
                                s()
                            } else i(e);
                        else cleverapps.timeouts.setTimeout(function () {
                            this.restoreThrottled()
                        }.bind(this), 15e3)
                    }.bind(this)))
            }.bind(this), function (t, s) {
                cleverapps.payments.setPurchaseState(PaymentsManager.STATE_VALIDATE), console.log("PaymentsManager validate start", n.loadedId, n.key), cleverapps.payments.validate(o, function (e) {
                    if (console.log("PaymentsManager validate result", n.loadedId, n.key, e), e !== cleverapps.CODE_SUCCEED) return this.consume(o), void s(e);
                    t()
                }.bind(this))
            }.bind(this)]);
            a.onComplete(function () {
                console.log(
                    "PaymentsManager purchase complete", n.loadedId, n.key), t && t.removeFromParent(), cleverapps.payments.setPurchaseState(void 0)
            }), a.onSuccess(function () {
                console.log("PaymentsManager purchase success", n.loadedId, n.key), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PRODUCT.SUCCESS), this.logPurchase(n, o), n.onBuyed(e), this.consume(o), s(!0, n)
            }.bind(this)), a.onFailure(function (e) {
                var t;
                console.log("PaymentsManager purchase failure", n.loadedId, n.key), e = e || cleverapps.CODE_FAILED, [Product.PENDING_PURCHASE, Product.TIMEOUT_CANCEL, Product.RESTORE_CHECK].includes(e) ? console.log(e + " - " + n.itemId) : (t = Messages.has(e) ? e : "Product.PurchaseCancelled", cleverapps.notification.create(t)), s(!1, e)
            }), a.play()
        }, PaymentsManager.prototype.isPurchaseRunning = function () {
            return this.purchasePlayer && this.purchasePlayer.isRunning()
        }, PaymentsManager.prototype.isRestoreRunning = function () {
            return this.restorePlayer && this.restorePlayer.isRunning()
        }, PaymentsManager.prototype.stopPurchasePlayer = function () {
            this.purchasePlayer && (this.purchasePlayer.stop(), delete this.purchasePlayer)
        }, PaymentsManager.prototype.logPurchase = function (e, t) {
            var s, i, n, o = {
                itemId: e.itemId,
                price: e.price,
                textPrice: e.getCurrentPrice(),
                paymentId: t && t.paymentId || ""
            };
            e.loadedPriceAmount && e.loadedCurrencyCode && (o.textPrice = e.loadedPriceAmount + " " + e.loadedCurrencyCode), o.price = Math.round(o.price * cleverapps.User.calcPriceCoef() * 100) / 100, "subscription" !== e.type ? (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.PAYMENTS, o), cleverapps.payments.oneOf(YooKassaPayments) && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.YOOKASSA.PAID_COUNT), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.YOOKASSA.PAID_AMOUNT, {
                value: o.price
            })), cleverapps.abTest.allLogEvent(cleverapps.EVENTS.STATS.PAYMENTS, {
                value: o.price
            }), cleverapps.travelBook.isExpedition() && (cleverapps.user.registered > ExpeditionMissionLogic.EXPEDITIONS_LOG_SINCE && cleverapps.eventLogger.logEvent(
                cleverapps.EVENTS.EXPEDITIONS.SPEND + cleverapps.travelBook.getCurrentPage().id, {
                value: 100 * o.price
            }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.EXPEDITIONS.TOTAL + cleverapps.travelBook.getCurrentPage().id, {
                value: o.price
            })), !(Game.currentGame && Game.currentGame.level.episode.isBonusWorldLevel() || cleverapps.environment.isBonusWorldScene()) || (s = cleverapps.missionManager.findByType(Mission.TYPE_BONUS_WORLD)) && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BONUS_WORLD_PAYMENTS + s.bonusWorld.type, {
                value: o.price
            }), cleverapps.paymentsHistory.addPayment(e), s = t.transactionId || t.paymentId, i = t.loadedPriceAmount, n = t.loadedCurrencyCode, t.state = t.restore ? 4 : 2, n && i || (i = o.price, n = "USD"), cleverapps.adjust && cleverapps.adjust.logPurchase(s, i, n), cleverapps.adOcean && cleverapps.adOcean.logEvent(AdOcean.EVENT_ACTIVE_PAY, {
                price: i
            }), cleverapps.thinkingData && cleverapps.thinkingData.logPurchase(e, t), cleverapps.gravityEngine && cleverapps.gravityEngine.logPurchase(e, t),
                cleverapps.firebase && !cleverapps.config.debugMode && cleverapps.firebase.logEvent("purchase", {
                    currency: n,
                    value: i,
                    transaction_id: s
                }), cleverapps.googleAnalytics && cleverapps.googleAnalytics.logEvent("purchase", {
                    currency: n,
                    value: i,
                    transaction_id: s,
                    items: [{
                        item_id: e.itemId,
                        item_name: e.title
                    }]
                }), cleverapps.platform.oneOf(AndroidPlatform) && cleverapps.platform.callNative("FacebookPlugin.logPurchase", {
                    price: i,
                    currency: n
                }), cleverapps.platform.oneOf(Yandex, WortalPlatform, Instant, Samsung, AndroidBase, Apple, Samsung) && !cleverapps.payments.oneOf(RestPayments, YooKassaPayments) && cleverapps.RestClient.post("/payments/add/" + cleverapps.platform.source + "/" + encodeURIComponent(cleverapps.platform.getUserID()), Object.assign(o, {
                    purchase: t
                }))) : cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SUBSCRIPTION_BOUGHT, o)
        }, PaymentsManager.prototype.stopLoadProductsPlayer = function () {
            this.loadProductsPlayer && (this.loadProductsPlayer.stop(), delete this.loadProductsPlayer)
        }, PaymentsManager.prototype.tryLoadProducts = function () {
            cleverapps.platform.isConnected(Platform.PAYMENTS) && (this.loadProductsPlayer && this.loadProductsPlayer.isRunning() || (this.loadProductsPlayer = new ActionPlayer({
                actionTimeout: cleverapps.parseInterval("15 seconds"),
                actions: [function (t) {
                    cleverapps.payments.productsLoaded ? t() : cleverapps.payments.loadProducts(function (e) {
                        e === cleverapps.CODE_SUCCEED && (cleverapps.payments.productsLoaded = !0, this.updateFlags(), this.restore(), t())
                    }.bind(this))
                }.bind(this), function (t) {
                    cleverapps.payments.subscriptionsLoaded ? t() : cleverapps.payments.loadSubscriptions(function (e) {
                        e === cleverapps.CODE_SUCCEED && (cleverapps.payments.subscriptionsLoaded = !0, t())
                    })
                }, function (t) {
                    cleverapps.payments.subscriptionsTokensLoaded ? t() : cleverapps.payments.loadSubscriptionsTokens(function (e) {
                        e === cleverapps.CODE_SUCCEED && (cleverapps.payments.subscriptionsTokensLoaded = !0, t())
                    })
                }]
            }), this.loadProductsPlayer.play()))
        }, PaymentsManager.STATE_SOCIAL = 1, PaymentsManager.STATE_EMAIL = 2, PaymentsManager.STATE_PURCHASE = 3,
            PaymentsManager.STATE_VALIDATE = 4,
            function () {
                this.onShow = function () { }, this.onHide = function () { }, this.visible = !1, this.opened = !1, this.update()
            }),
        RestoreProgressButton = (RestoreProgress.prototype.isAvailable = function () {
            return !(cleverapps.config.adminMode || cleverapps.config.editorMode || cleverapps.config.wysiwygMode) && (!(!cleverapps.platform.isConnected(Platform.SOCIAL) || cleverapps.flags.nologin || cleverapps.social.isLoggedIn()) && ((!cleverapps.config.importMode || !cleverapps.flags.isLoggedIn) && ("merge" === cleverapps.config.type ? cleverapps.user.level < 2 : cleverapps.user.getFloatLevel() < .5)))
        }, RestoreProgress.prototype.isVisible = function () {
            return !!(cleverapps.environment.isMainScene() || cleverapps.environment.isGameScene() || cleverapps.environment.isComicsScene())
        }, RestoreProgress.prototype.isOpened = function () {
            return this.opened
        }, RestoreProgress.prototype.update = function () {
            var e = this.isAvailable() && this.isVisible() && !this.isOpened();
            e !== this.visible && ((this.visible = e) ? this.onShow() : this.onHide())
        },
            RestoreProgress.prototype.restore = function () {
                var e;
                cleverapps.windows.currentWindow() instanceof FbConnectWindow || (e = [function (e) {
                    this.opened = !0, this.update(), new FbConnectWindow({
                        restoreProgress: !0,
                        onClose: e
                    })
                }.bind(this), function (e) {
                    this.opened = !1, this.update(), e()
                }.bind(this)], cleverapps.meta.isFocused() ? cleverapps.meta.distract({
                    focus: "RestoreProgress",
                    restore: !0,
                    keepControls: !0,
                    actions: e
                }) : cleverapps.meta.display({
                    focus: "RestoreProgress",
                    actions: e
                }))
            }, cleverapps.UI.Button.extend({
                alwaysOn: !0,
                ctor: function () {
                    var e = cleverapps.styles.RestoreProgressButton,
                        t = e.size ? e.size[cleverapps.resolution.mode] : e,
                        s = (this.contentFont = cleverapps.styles.FONTS.BUTTON_TEXT, this.content = cleverapps.UI.generateOnlyText("RestoreProgress", this.contentFont));
                    s.setDimensions(t.width, 0), s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.fitTo(void 0, t.height), this._super({
                        width: t.width,
                        height: t.height,
                        content: s,
                        type: cleverapps.styles.UI.Button.Images.button_blue,
                        onClicked: function () {
                            cleverapps.restoreProgress.restore()
                        }
                    }), this.content.setPositionRound(e.content), this.setCascadeOpacityEnabledRecursively(!0), this.setOpacity(0), this.setVisible(!1), this.setLocalZOrder(BaseWindow.WINDOWS_ZORDER + 2), cleverapps.restoreProgress.onShow = this.createListener(this.onShow.bind(this)), cleverapps.restoreProgress.onHide = this.createListener(this.onHide.bind(this)), cleverapps.restoreProgress.visible && this.runAction(new cc.CallFunc(this.onShow.bind(this))), this.updateSize()
                },
                updateSize: function () {
                    var e, t;
                    cleverapps.styles.RestoreProgressButton.size && (t = (e = cleverapps.styles.RestoreProgressButton).size[cleverapps.resolution.mode], this.resize(t.width, t.height), this.content.setFontSize(this.contentFont.size), this.content.setDimensions(t.width, 0), this.content.fitTo(void 0, t.height), this.content.setPositionRound(e.content))
                },
                updateDynamicPosition: function (e) {
                    var t = cleverapps.styles.RestoreProgressButton,
                        s = cleverapps.scenes.getRunningScene().getAvoidNodes(["HidingNode", "DialogueView",
                            "FieldView", "MenuBarItemView", "MinimalDialogue", "PaginationView", "Panel", "Person", "PlayButtonView", "BoardView", "KeypadView", "CurrentView", "BandButton"
                        ]).filter(function (e) {
                            return !1 !== e.isShown
                        }),
                        t = (cleverapps.gameModes.showAvoidRects && cleverapps.scenes.getRunningScene().drawRects(s.map(function (e) {
                            var t = e.getBoundingBoxToWorld();
                            return t.name = e.avoidNode, t
                        })), cleverapps.UI.findPosition(this, t.position, s));
                    cc.pointEqualToPoint(this.getPosition(), t, .5) || (cleverapps.restoreProgress.visible && !e ? (this.stopAllActions(), this.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.MoveTo(0, t.x, t.y), new cc.FadeIn(.3)))) : this.setPosition(t.x, t.y))
                },
                onShow: function () {
                    this.stopAllActions(), this.runAction(new cc.Sequence(new cc.Show, new cc.FadeIn(.3)))
                },
                onHide: function () {
                    this.stopAllActions(), this.runAction(new cc.Sequence(new cc.DelayTime(.1), new cc.FadeOut(.3), new cc.Hide))
                }
            })),
        GrowthFundWindow = (cleverapps.styles.RestoreProgressButton = {
            width: 300,
            height: 110,
            position: [{
                x: {
                    align: "left",
                    dx: 20
                },
                y: {
                    align: "bottom",
                    dy: 20
                }
            }, {
                x: {
                    align: "right",
                    dx: -20
                },
                y: {
                    align: "bottom",
                    dy: 20
                }
            }, {
                x: {
                    align: "right",
                    dx: -20
                },
                y: {
                    align: "top",
                    dy: -110
                }
            }],
            content: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                }
            }
        }, Window.extend({
            onWindowLoaded: function () {
                this.product = Product.Create("growthFund"), this._super({
                    name: "GrowthFundWindow",
                    title: "GrowthFundWindow.title",
                    content: this.createContent(),
                    styles: cleverapps.styles.GrowthFundWindow.window,
                    foreground: bundles.windows.frames.window_foreground_png
                }), cleverapps.meta.showControlsWhileFocused("MenuBarGoldItem"), cleverapps.growthFund.on("updateState", this.updateState.bind(this), this), cleverapps.growthFund.wantsAttention = !1, Lottery.addText(this)
            },
            getPerson: function () {
                return PersonsLibrary.hasRole("seller") && "seller"
            },
            onShow: function () {
                this._super(), cleverapps.growthFund.isBought() && this.removeBuyButton()
            },
            createContent: function () {
                var e = cleverapps.styles.GrowthFundWindow;
                return new cleverapps.Layout([this.createTop(), this.createTiles()], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin,
                    padding: e.padding
                })
            },
            createTop: function () {
                var e = cleverapps.styles.GrowthFundWindow.top,
                    t = this.top = cleverapps.UI.createScale9Sprite(bundles.growth_fund.frames.top_bg, cleverapps.UI.Scale9Rect.TwoPixelXY),
                    s = (t.setContentSize2(e), t.setLocalZOrder(1), new cleverapps.Spine(bundles.growth_fund.jsons.main_win_safe)),
                    s = (s.setAnimationAndIdleAfter("open", "idle"), t.addChild(s), s.setPositionRound(e.icon), cleverapps.UI.generateOnlyText("GrowthFundWindow.cta1", cleverapps.styles.FONTS.GROWTH_FUND_CTA1)),
                    i = cleverapps.UI.generateOnlyText("GrowthFundWindow.cta2", cleverapps.styles.FONTS.GROWTH_FUND_CTA2),
                    s = (i.fitTo(e.text.width), new cleverapps.Layout([s, i], {
                        align: e.align,
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.text.margin
                    }));
                return t.addChild(s), s.setPositionRound(e.text), this.createBuyButton(), t
            },
            createBuyButton: function () {
                var e;
                cleverapps.growthFund.isBought() ? this.removeBuyButton() : (e = cleverapps.styles.GrowthFundWindow.top.button, this.buyButton = new cleverapps.UI.Button({
                    width: e.width,
                    height: e.height,
                    type: ["tropical", "riddles"].includes(cleverapps.config.ui) ? cleverapps.styles.UI.Button.Images.button_blue : cleverapps.styles.UI.Button.Images.button_purple,
                    text: this.product.getCurrentPrice(),
                    onClicked: this.onBuy.bind(this)
                }), Lottery.addIcon(this.buyButton), this.top.addChild(this.buyButton), this.buyButton.setPositionRound(e))
            },
            removeBuyButton: function () {
                this.buyButton && (this.buyButton.removeFromParent(), delete this.buyButton), this.mark || (this.mark = new cc.Sprite(bundles.growth_fund.frames.bought_checkmark || bundles.growth_fund.frames.checkmark), this.top.addChild(this.mark), this.mark.setPositionRound(cleverapps.styles.GrowthFundWindow.top.mark))
            },
            onBuy: function () {
                this.product.buy(function (e) {
                    e && (this.removeBuyButton(), cleverapps.growthFund.afterBuy())
                }.bind(this))
            },
            createTiles: function () {
                var e, t = cleverapps.styles.GrowthFundWindow.scroll,
                    s = (this.levelTiles = cleverapps.growthFund.levels.map(function (e) {
                        return new GrowthFundLevelView(e)
                    }, this), new cleverapps.Layout(
                        this.levelTiles, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: t.margin
                    })),
                    s = this.scroll = new cleverapps.UI.ScrollView(s, {
                        direction: cleverapps.UI.ScrollView.DIR_VERTICAL
                    });
                return s.setContentSize2(t), this.animateScrollToRelevant(), t.top && ((e = cleverapps.UI.createScale9Sprite(bundles.growth_fund.frames.scroll_top)).setContentSize2(t.top), s.addChild(e), e.setPositionRound(t.top)), s
            },
            animateScrollToRelevant: function () {
                for (var e = this.levelTiles.length - 1; 0 <= e && this.levelTiles[e].state === GrowthFund.STATE.INSUFFICIENT; e--);
                var t = Math.min(2, Math.max(.5, 2 * e / this.levelTiles.length));
                this.scroll.scrollTo(this.levelTiles[e]), this.scroll.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.CallFunc(function () {
                    var e = cleverapps.growthFund.findFirst(GrowthFund.STATE.READY) || cleverapps.growthFund.findFirst(GrowthFund.STATE.INSUFFICIENT);
                    e && (e = cleverapps.growthFund.levels.indexOf(e), this.scroll.scrollTo(this.levelTiles[e], t, {
                        easing: cc.easeInOut(2)
                    }))
                }.bind(this))))
            },
            updateState: function () {
                this.levelTiles.forEach(function (e) {
                    e.updateState()
                })
            },
            listBundles: function () {
                return ["growth_fund"]
            }
        })),
        GrowthFundBuyWindow = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            GROWTH_FUND_CTA1: {
                size: 52,
                color: cleverapps.styles.COLORS.WHITE
            },
            GROWTH_FUND_CTA2: {
                size: 35,
                color: cleverapps.styles.COLORS.WHITE
            }
        }), cleverapps.styles.GrowthFundWindow = {
            margin: 10,
            window: {
                padding: {
                    left: 45,
                    right: 45,
                    top: 90,
                    bottom: 30
                }
            },
            top: {
                width: 980,
                height: 250,
                align: cleverapps.UI.ALIGN_START,
                text: {
                    width: 590,
                    margin: -15,
                    x: {
                        align: "left",
                        dx: 290
                    },
                    y: {
                        align: "top",
                        dy: -5
                    }
                },
                icon: {
                    x: {
                        align: "left",
                        dx: 15
                    },
                    y: {
                        align: "center",
                        dy: -30
                    }
                },
                button: {
                    width: 230,
                    height: 90,
                    x: {
                        align: "right",
                        dx: -80
                    },
                    y: {
                        align: "bottom",
                        dy: 25
                    }
                },
                mark: {
                    x: {
                        align: "right",
                        dx: -150
                    },
                    y: {
                        align: "bottom",
                        dy: 45
                    }
                }
            },
            scroll: {
                margin: 5,
                width: 990,
                height: 710,
                top: {
                    width: 1078,
                    height: 45,
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "top",
                        dy: 25
                    }
                }
            }
        }, Window.extend({
            onWindowLoaded: function () {
                this.product = Product.Create("growthFund"), this._super({
                    name: "GrowthFundBuyWindow",
                    title: "GrowthFundBuyWindow.title",
                    content: this.createContent()
                }), this.createBadge(), Lottery.addText(this)
            },
            getPerson: function () {
                return PersonsLibrary.hasRole("seller") && "seller"
            },
            createContent: function () {
                var e = cleverapps.styles.GrowthFundBuyWindow,
                    t = this.createBuyButton(),
                    s = this.creteTextNode(),
                    i = new cleverapps.Spine(bundles.growth_fund.jsons.buy_fund_safe);
                return i.setAnimationAndIdleAfter("open", "idle"), new cleverapps.Layout([i, s, t], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin
                })
            },
            creteTextNode: function () {
                function e(e, t) {
                    var e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.WINDOW_TEXT),
                        t = cleverapps.UI.generateImageText(cleverapps.formatAmount(t), cleverapps.styles.FONTS.GROWTH_FUND_RECEIVE_AMOUNT),
                        s = new cc.Sprite(bundles.growth_fund.frames.rubies),
                        t = new cleverapps.Layout([t, s], {
                            direction: cleverapps.UI.HORIZONTAL,
                            margin: i.iconMargin
                        });
                    return new cleverapps.Layout([e, t], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: i.margin
                    })
                }
                var i = cleverapps.styles.GrowthFundBuyWindow.text,
                    t = e("GrowthFundBuyWindow.text1",
                        cleverapps.growthFund.getTotalWaitingRewards()),
                    s = e("GrowthFundBuyWindow.text2", GrowthFund.LEVELS.rewards.default);
                return new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: i.lineMargin
                })
            },
            createBuyButton: function () {
                var e = new cleverapps.UI.Button({
                    text: this.product.getCurrentPrice(),
                    onClicked: function () {
                        this.product.buy(function (e) {
                            e && (cleverapps.growthFund.afterBuy(), this.close())
                        }.bind(this))
                    }.bind(this),
                    width: cleverapps.styles.GrowthFundBuyWindow.button.width,
                    height: cleverapps.styles.GrowthFundBuyWindow.button.height
                });
                return Lottery.addIcon(e), e
            },
            createBadge: function () {
                var e = cleverapps.styles.GrowthFundBuyWindow.badge,
                    t = new TileBadge({
                        type: "value",
                        value: "800%"
                    });
                t.setPositionRound(e), this.window.addChild(t)
            },
            listBundles: function () {
                return ["growth_fund"]
            }
        })),
        GrowthFundLevelView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            GROWTH_FUND_RECEIVE_AMOUNT: {
                name: "nostroke",
                size: 53,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            }
        }),
            cleverapps.styles.GrowthFundBuyWindow = {
                margin: 20,
                text: {
                    margin: 20,
                    iconMargin: 5,
                    lineMargin: 0
                },
                badge: {
                    x: {
                        align: "right",
                        dx: 40
                    },
                    y: {
                        align: "bottom",
                        dy: -40
                    }
                },
                button: {
                    width: 240,
                    height: 95
                }
            }, cc.Node.extend({
                ctor: function (e) {
                    this._super(), this.data = e, this.state = e.state, this.setAnchorPoint2(), this.setContentSize2(cleverapps.styles.GrowthFundLevelView), this.createContent()
                },
                createContent: function () {
                    var e, t = cleverapps.styles.GrowthFundLevelView,
                        s = cleverapps.growthFund.findFirst(GrowthFund.STATE.INSUFFICIENT),
                        s = (this.reached = !s || this.data.levelNo < s.levelNo, this.bg = cleverapps.UI.createScale9Sprite(bundles.growth_fund.frames.lvl_bg, cleverapps.UI.Scale9Rect.TwoPixelXY));
                    s.setContentSize2(this.getContentSize()), this.addChild(s), s.setPositionRound(this.width / 2, this.height / 2), bundles.growth_fund.frames.lvl_icon_bg && ((e = cleverapps.UI.createScale9Sprite(bundles.growth_fund.frames.lvl_icon_bg, cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(t.iconBg), e.setPositionRound(t.iconBg), s.addChild(e),
                        s.setCascadeOpacityEnabled(!0), s.setCascadeColorEnabled(!0)), this.createReward(), this.createTitle(), this.createIcon(), this.setState(), this.reached || this.paintInsufficient()
                },
                createReward: function () {
                    var e = cleverapps.styles.GrowthFundLevelView.rewards,
                        t = cleverapps.UI.generateOnlyText("RewardsListComponent.rewardTitle", this.reached ? cleverapps.styles.FONTS.GROWTH_FUND_LEVEL_REWARD_REACHED : cleverapps.styles.FONTS.GROWTH_FUND_LEVEL_REWARD),
                        s = this.rewardsList = new RewardsListComponent({
                            hard: this.data.reward
                        }, {
                            font: this.reached ? cleverapps.styles.FONTS.GROWTH_FUND_LEVEL_VALUE_REACHED : cleverapps.styles.FONTS.GROWTH_FUND_LEVEL_VALUE,
                            margin: e.margin,
                            noPrefix: !0,
                            textDirection: cleverapps.UI.HORIZONTAL,
                            textMargin: e.textMargin,
                            icons: {
                                hard: bundles.growth_fund.frames.rubies
                            },
                            small: !0
                        }),
                        t = new cleverapps.Layout([t, s], {
                            direction: cleverapps.UI.HORIZONTAL,
                            margin: e.margin.x
                        });
                    this.addChild(t), t.setPositionRound(e)
                },
                createTitle: function () {
                    var e = cleverapps.styles.GrowthFundLevelView.title,
                        t = "GrowthFundWindow.reach",
                        s = cleverapps.styles.FONTS.GROWTH_FUND_LEVEL_TITLE,
                        t = (this.reached && (t = "GrowthFundWindow.reached", s = cleverapps.styles.FONTS.GROWTH_FUND_LEVEL_TITLE_REACHED), this.title = cleverapps.UI.generateOnlyText(t, s, {
                            level: this.data.levelNo + 1
                        }));
                    t.fitTo(e.maxWidth), this.addChild(t), t.setPositionRound(e)
                },
                createIcon: function () {
                    var e = cleverapps.styles.GrowthFundLevelView.icon,
                        t = new cc.Sprite(bundles.growth_fund.frames.rubies_heap);
                    this.addChild(t), t.setPositionRound(e), this.icon = t
                },
                setState: function () {
                    var e;
                    switch (cleverapps.tooltipManager.remove(this), cc.eventManager.removeListeners(this), this.data.state) {
                        case GrowthFund.STATE.INSUFFICIENT:
                            e = Messages.get("GrowthFundWindow.insufficient"), this.createMark();
                            break;
                        case GrowthFund.STATE.WAITING:
                            e = Messages.get("GrowthFundWindow.getPrevious", {
                                level: cleverapps.growthFund.findFirst(GrowthFund.STATE.READY).levelNo + 1
                            }), this.createButton();
                            break;
                        case GrowthFund.STATE.READY:
                            this.createButton();
                            break;
                        case GrowthFund.STATE.RECEIVED:
                            this.createMark()
                    }
                    e && cleverapps.tooltipManager.create(this.button || this.mark, {
                        text: e,
                        position: cleverapps.styles.UI.Tooltip.LOCATION.above
                    })
                },
                createButton: function () {
                    var e = cleverapps.styles.GrowthFundLevelView.button;
                    this.button = new cleverapps.UI.Button({
                        width: e.width,
                        height: e.height,
                        text: "Claim",
                        onClicked: this.onClick.bind(this)
                    }), this.addChild(this.button), this.button.setPositionRound(e)
                },
                onClick: function () {
                    cleverapps.growthFund.isBought() ? this.data.state === GrowthFund.STATE.READY && (Game.currentGame ? (this.rewardsList.receiveRewards(), this.rewardsList.receiveRewardsAnimation({
                        noFadeOut: !0
                    })) : cleverapps.user.earnHard(cleverapps.EVENTS.EARN.GROWTH_FUND, this.data.reward), cleverapps.growthFund.takeReward(this.data.levelNo)) : new GrowthFundBuyWindow
                },
                createMark: function () {
                    var e = bundles.growth_fund.frames[this.data.state === GrowthFund.STATE.RECEIVED ? "checkmark" : "lock"],
                        e = this.mark = new cc.Sprite(e);
                    this.addChild(e), e.setPositionRound(cleverapps.styles.GrowthFundLevelView.mark)
                },
                updateState: function () {
                    this.state === this.data.state && this.state !== GrowthFund.STATE.WAITING || (this.state = this.data.state, this.removeAllChildren(!0), this.createContent())
                },
                paintInsufficient: function () {
                    function e(e) {
                        e.setColor(new cc.Color(180, 180, 180, 255)), e.setOpacity(140)
                    }
                    for (var t in e(this.bg), e(this.icon), this.rewardsList.targets) e(this.rewardsList.targets[t].icon)
                }
            })),
        ReturnBonus = (cleverapps.styles.GrowthFundLevelView = {
            width: 960,
            height: 150,
            title: {
                maxWidth: 490,
                x: {
                    align: "left",
                    dx: 175
                },
                y: {
                    align: "center",
                    dy: 25
                }
            },
            icon: {
                width: 130,
                height: 130,
                x: {
                    align: "left",
                    dx: 25
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            rewards: {
                margin: {
                    x: 10
                },
                textMargin: 0,
                x: {
                    align: "left",
                    dx: 175
                },
                y: {
                    align: "center",
                    dy: -25
                }
            },
            mark: {
                x: {
                    align: "right",
                    dx: -134
                },
                y: {
                    align: "center"
                }
            },
            button: {
                width: 200,
                height: 80,
                x: {
                    align: "right",
                    dx: -68
                },
                y: {
                    align: "center"
                }
            }
        }, function () {
            cleverapps.social.hasPromoGift(function (e) {
                this.hasReward = e
            }.bind(this))
        }),
        ComicsPlayer = (ReturnBonus.prototype.shouldReward = function () {
            return this.hasReward
        },
            ReturnBonus.prototype.giveReward = function () {
                cleverapps.meta.display({
                    focus: "ReturnBonusRewardWindow",
                    action: function (e) {
                        cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RETURNBONUS_REWARD), this.hasReward = !1, cleverapps.social.usePromoGift(), new RewardWindow(ReturnBonus.REWARD, {
                            title: "ReturnBonusRewardWindow.title"
                        }), cleverapps.meta.onceNoWindowsListener = e
                    }.bind(this)
                })
            }, ReturnBonus.REWARD = {
                hard: 150
            }, "merge" === cleverapps.config.type ? ReturnBonus.REWARD = {
                energy: 100,
                hard: 5,
                soft: 100,
                worker: "6 hour"
            } : "match3" === cleverapps.config.type ? ReturnBonus.REWARD = {
                unlimitedLives: "6 hours",
                hard: 100,
                boosters: {
                    5: 1,
                    6: 1
                }
            } : "wordsoup" === cleverapps.config.name && (ReturnBonus.REWARD = {
                homeStar: 10,
                hard: 150
            }),
            function (e, t) {
                this.stages = e, this.animation = t, this.stage = -1
            }),
        ComicsScene = (ComicsPlayer.prototype.onChangeStage = function () {
            (void 0 === this.dialogueStages || this.dialogueStages < 1) && (this.next(), this.dialogueStages = this.comics.dialogueStages || 1), this.dialogueStages--
        }, ComicsPlayer.prototype.next = function () {
            this.stage++, this.stage >= this.stages.length || (this.comics = this.stages[this.stage], this.runAnimation())
        }, ComicsPlayer.prototype.completeShowAnimation = function () {
            this.inAnimation && this.comics.idleAnimation && (this.animation.setCompleteListener(), this.inAnimation = !1, this.animation.setAnimation(0, this.comics.idleAnimation, !0))
        }, ComicsPlayer.prototype.runAnimation = function () {
            this.comics.showAnimation ? (this.inAnimation = !0, this.animation.setAnimation(0, this.comics.showAnimation, !1), this.animation.setCompleteListener(this.animation.createListener(this.completeShowAnimation.bind(this)))) : (this.inAnimation = !1, this.animation.setAnimation(0, this.comics.idleAnimation, !0))
        }, cleverapps.FixedWidthScene.extend({
            ctor: function (e, t) {
                this.data = e, this.callback = t, this._super()
            },
            onSceneLoaded: function () {
                this._super(cleverapps.Environment.SCENE_COMICS);
                var e = this.data,
                    t = this.callback,
                    s = (this.createBg(), this.dialogue = new Dialogue(e.dialogue, {
                        autoClose: !0,
                        autoScroll: 3
                    })),
                    e = new ComicsPlayer(e.stages,
                        this.createAnimation(e));
                s.on("afterClose", t), s.on("changedStage", e.onChangeStage.bind(e)), this.runAction(new cc.Sequence(new cc.DelayTime(0), new cc.CallFunc(function () {
                    new DialogueView(s, {
                        window: {
                            shadow: !1
                        }
                    })
                })))
            },
            updateSize: function () {
                this._super(), this.bg && (this.bg.baseScale = Math.max(this.width / this.bg.width, this.height / this.bg.height), this.bg.setScale(this.bg.baseScale)), this.animationNode && this.animationNode.setScale(1)
            },
            updatePosition: function () {
                this._super(), this.bg && this.bg.setPositionRound(this.width / 2, this.height / 2), this.animationNode && this.animationNode.setPositionRound(this.width / 2, this.height / 2)
            },
            createAnimation: function (e) {
                var t = this.animationNode = new cc.Node,
                    e = (t.setAnchorPoint2(), t.setContentSize(this.getContentSize()), t.setPositionRound(this.width / 2, this.height / 2), this.addChild(t), this.animation = new cleverapps.Spine(e.json));
                return t.addChild(e), e.setPositionRound(t.width / 2, t.height / 2), e
            },
            createBg: function () {
                var e;
                bundles.comicses.urls.bg && (e = this.bg = new cc.Sprite(
                    bundles.comicses.urls.bg), this.addChild(e), e.setPositionRound(this.width / 2, this.height / 2), this.bg.baseScale = Math.max(this.width / e.width, this.height / e.height), e.setScale(this.bg.baseScale), e.setLocalZOrder(-10))
            },
            listBundles: function () {
                var e = ["dialogues"];
                return e = this.data.bundles ? e.concat(this.data.bundles) : e
            }
        })),
        KeyboardController = (ComicsScene.showComics = function (e, t) {
            cleverapps.scenes.replaceScene(new ComicsScene(t, e), function () {
                cleverapps.meta.setEventNodes([cleverapps.scenes.getRunningScene()])
            })
        }, function () {
            this.bindings = {}, this.keyPressed = {}, cc.eventManager.addListener(cc.EventListener.create({
                event: cc.EventListener.KEYBOARD,
                onKeyPressed: this.onKeyPressedHandler.bind(this),
                onKeyReleased: this.onKeyReleasedHandler.bind(this)
            }), 2)
        }),
        LivesFeast = (KeyboardController.prototype.RETURN_THROTTLE = 250, KeyboardController.prototype.THROTTLE_KEYS = cleverapps.createSet([cc.KEY.escape, cc.KEY.back]), KeyboardController.prototype.KEYS = cleverapps.createSet([cc.KEY.ctrl, cc.KEY.shift]),
            cleverapps.config.debugMode && (KeyboardController.prototype.KEYS = cleverapps.createSet([cc.KEY.ctrl, cc.KEY.alt, cc.KEY.shift, cc.KEY.s, cc.KEY.d, cc.KEY.r, cc.KEY.j, cc.KEY.a, cc.KEY.Delete, cc.KEY.c, cc.KEY.h, cc.KEY.w, cc.KEY.m, cc.KEY.f, cc.KEY.q, cc.KEY.v, cc.KEY.y, cc.KEY.space, cc.KEY.l, cc.KEY.b, cc.KEY.x])), KeyboardController.prototype.bindKeys = function (e, t, s) {
                return this.bindings[e] = {
                    combo: t,
                    callback: s
                }, e
            }, KeyboardController.prototype.unbindKeys = function (e) {
                delete this.bindings[e]
            }, KeyboardController.prototype.isPressed = function (e) {
                return this.keyPressed[e]
            }, KeyboardController.prototype.onKeyPressedHandler = function (t) {
                if (!this.keyPressed[t]) {
                    this.KEYS[t] && (this.keyPressed[t] = !0);
                    for (var e = cleverapps.values(this.bindings).sort(function (e, t) {
                        return t.combo.length - e.combo.length
                    }), s = 0; s < e.length; s++)
                        if (e[s].combo.every(function (e) {
                            if (this.KEYS[e]) {
                                if (!this.keyPressed[e]) return !1
                            } else if (e !== t) return !1;
                            return !0
                        }, this)) {
                            e[s].callback();
                            break
                        }
                }
            },
            KeyboardController.prototype.onKeyReleasedHandler = function (e) {
                this.KEYS[e] && (this.keyPressed[e] = !1), this.THROTTLE_KEYS[e] && this.returnAction()
            }, KeyboardController.prototype.returnAction = cleverapps.throttle(KeyboardController.prototype.RETURN_THROTTLE, function () {
                var e = cleverapps.windows.list[cleverapps.windows.list.length - 1];
                cleverapps.sceneDebugger && cleverapps.sceneDebugger.selectedNode ? "undefined" != typeof EditorMap2dDecoratorView && cleverapps.sceneDebugger.selectedNode instanceof EditorMap2dDecoratorView ? cleverapps.sceneDebugger.selectedNode.unselect() : (cleverapps.sceneDebugger.selectedNode.cleanupBorder(), cleverapps.sceneDebugger.selectedNode = void 0) : e && e.closeByBackButton ? e.closeByBackButton() : !cleverapps.toolModel || cleverapps.scenes.getRunningScene() instanceof AdministratorScene ? !(e = cleverapps.scenes.getRunningScene()) || e instanceof LoaderScene || e.closeAction() : cleverapps.toolModel.isOpened() ? cleverapps.toolModel.hide() : cleverapps.toolModel.show()
            }),
            function (e, t) {
                this.mission = e,
                    t && Game.currentGame.pixelsPlanner.restart()
            }),
        SoftFeast = function (e, t) {
            this.mission = e, t && Game.currentGame.pixelsPlanner.restart()
        },
        KrakenFeast = function (e, t) {
            this.mission = e, t && Game.currentGame.monstersPlanner.spawnToAllSlots(!0)
        },
        ChestTime = (KrakenFeast.prototype.stop = function () {
            Game.currentGame && MissionManager.hasProperParent(this.mission) && (Game.currentGame.monstersPlanner.stop(), Game.currentGame.quests.applyDynamicFilter())
        }, function (e) {
            this.mission = e
        }),
        Caravan = (ChestTime.prototype.onAdded = function () {
            this.forEachChest(function (e) {
                e.onUpdateState()
            })
        }, ChestTime.prototype.canRemoveSilently = function () {
            return !0
        }, ChestTime.prototype.stop = function () {
            this.forEachChest(function (e) {
                Chest.AlwaysWithEnergy(e.unit) || e.onUpdateState()
            })
        }, ChestTime.prototype.forEachChest = function (t) {
            Game.currentGame && Game.currentGame.map.listAvailableUnits().forEach(function (e) {
                e = e.findComponent(Chest);
                e && t(e)
            })
        }, function (e, t) {
            this.mission = e, t && (!(e = Game.currentGame.shipsPlanner.spawnUnit()) || (
                t = Game.currentGame.unitStories.findStory(Unit.GetKey(e))) && (this.unitStory = {
                    story: t,
                    unit: e
                }))
        }),
        PeriodicPackLogic = (Caravan.prototype.buyProduct = function (e) {
            e.onBuyed()
        }, Caravan.prototype.beforeRemove = function () {
            Game.currentGame && Game.currentGame.shipsPlanner.removeUnit()
        }, Caravan.PRODUCTS = ["caravan0", "caravan1", "caravan2"], function (e, t) {
            this.mission = e, t && cleverapps.forces.clearForce(Forces.PERIODIC_PACK.id)
        }),
        PeriodicSaleLogic = (PeriodicPackLogic.prototype.offerBought = function () {
            cleverapps.missionManager.remove(this.mission)
        }, function (e, t) {
            this.mission = e, t && cleverapps.forces.clearForce(Forces.PERIODIC_SALE.id)
        }),
        ChainSaleLogic = (PeriodicSaleLogic.prototype.getLots = function () {
            var e = RewardsConfig.PeriodicBonusSale,
                t = this.mission.details.payer;
            return void 0 === t && ((t = cleverapps.paymentsHistory.classify()) === cleverapps.PaymentsHistory.BRACKET_UNDECIDED && (t = cleverapps.PaymentsHistory.BRACKET_NONE), t = Math.min(t, e.length - 2), this.mission.update(0, {
                payer: t
            })), e.slice(t, t + 2)
        },
            PeriodicSaleLogic.prototype.isSoldLot = function (e) {
                return this.mission.result & 1 << e
            }, PeriodicSaleLogic.prototype.countSoldLots = function () {
                return this.getLots().filter(function (e) {
                    return this.isSoldLot(e.id)
                }.bind(this)).length
            }, PeriodicSaleLogic.prototype.isAllSold = function () {
                return this.getLots().length === this.countSoldLots()
            }, PeriodicSaleLogic.prototype.lotBought = function (e) {
                e = (this.mission.result ^ 1 << e) - this.mission.result;
                this.mission.update(e)
            }, PeriodicSaleLogic.prototype.isAvailable = function () {
                return !cleverapps.flags.videoAdsMainMonetization
            }, PeriodicSaleLogic.FindProductLot = function (t) {
                var s = cleverapps.missionManager.findByType(Mission.TYPE_PERIODIC_SALE);
                if (s && s.isAvailable() && s.isRunning()) {
                    var e = s.logic.getLots();
                    if (!e.some(function (e) {
                        return e.reward.energy
                    }) || cleverapps.travelBook.getCurrentPage().withEnergy()) return e.find(function (e) {
                        return e.product === t && !s.logic.isSoldLot(e.id)
                    })
                }
            }, PeriodicSaleLogic.NeedTileDecor = function (e) {
                return void 0 !== PeriodicSaleLogic.FindProductLot(e.product.key)
            }, PeriodicSaleLogic.addProductBonus = function (e) {
                var t = PeriodicSaleLogic.FindProductLot(e.key);
                if (t) return cleverapps.missionManager.findByType(Mission.TYPE_PERIODIC_SALE).logic.lotBought(t.id), Product.AddUpRewards(e.reward, cleverapps.clone(t.reward))
            }, PeriodicSaleLogic.TileDecorGenerator = function (e) {
                var e = PeriodicSaleLogic.FindProductLot(e.key),
                    t = cleverapps.styles.Decorators.shop_bonusSale_decor.content;
                return new RewardsListComponent(e.reward, {
                    columns: 2,
                    noPrefix: !0,
                    small: !0,
                    font: cleverapps.styles.FONTS.BONUSSALE_REWARDS,
                    textDirection: cleverapps.UI.HORIZONTAL,
                    margin: t.margin,
                    textMargin: t.textMargin,
                    iconWrap: t.iconWrap
                })
            },
            function (e, t) {
                this.mission = e, this.packs = RewardsConfig.ChainSale, t && cleverapps.forces.clearForce(Forces.CHAIN_SALE.id), this.checkIfComplete()
            }),
        CaravanTileView = (ChainSaleLogic.prototype.lotBought = function () {
            this.mission.increaseResult(1), this.checkIfComplete()
        },
            ChainSaleLogic.prototype.checkIfComplete = function () {
                this.isAllSold() && this.mission.complete()
            }, ChainSaleLogic.prototype.getStage = function () {
                return this.mission.result
            }, ChainSaleLogic.prototype.canRemoveSilently = function () {
                return !0
            }, ChainSaleLogic.prototype.skipNext = function () {
                return this.mission.iconForce && !cleverapps.forces.isShown(this.mission.iconForce.id)
            }, ChainSaleLogic.prototype.currentLots = function () {
                for (var e = this.getStage(), t = [], s = e; s < e + ChainSaleLogic.VISIBLE_LOTS; s++) this.packs[s] && t.push(s);
                return t
            }, ChainSaleLogic.prototype.isLast = function (e) {
                return e === this.packs.length - 1
            }, ChainSaleLogic.prototype.isOpened = function (e) {
                return e <= this.getStage()
            }, ChainSaleLogic.prototype.isSold = function (e) {
                return e < this.getStage()
            }, ChainSaleLogic.prototype.getReward = function (e) {
                return this.packs[e].reward
            }, ChainSaleLogic.prototype.getProduct = function (e) {
                return this.packs[e].product
            }, ChainSaleLogic.prototype.isAvailable = function () {
                return !cleverapps.flags.videoAdsMainMonetization
            },
            ChainSaleLogic.prototype.isAllSold = function () {
                return 0 === this.currentLots().length
            }, ChainSaleLogic.VISIBLE_LOTS = 3, cc.Scale9Sprite.extend({
                ctor: function (e, t, s) {
                    this.product = e, this.callback = s, this.cupData = t, this.units = Prizes.Generate([this.cupData], {
                        listOnly: !0
                    }), this._super(bundles.caravan.frames.tile_bg_png, cleverapps.UI.getScale9Rect(bundles.caravan.frames.tile_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY));
                    s = cleverapps.styles.CaravanTileView, this.setContentSize(s), this.title = this.createTitle(), this.title.setLocalZOrder(1), this.addChild(this.title), this.title.setPositionRound(s.title), this.grid = this.createGrid(), this.grid.setOpacity(0), this.grid.setVisible(!1), this.addChild(this.grid), this.grid.setPositionRound(s.grid), this.unitsGrid = this.createUnitsGrid(), this.unitsGrid.setOpacity(0), this.unitsGrid.setVisible(!1), this.addChild(this.unitsGrid), this.unitsGrid.setPositionRound(s.grid), this.amount = this.createAmount(), this.amount.setOpacity(0), this.amount.setVisible(!1), this.addChild(
                        this.amount), this.amount.setPositionRound(s.amount), this.person = new cc.Sprite(this.product.person), this.addChild(this.person), this.person.setPositionRound(s.person), this.rewardsBlock = this.createRewardsBlock(), this.addChild(this.rewardsBlock), this.rewardsBlock.setPositionRound(s.rewardsBlock), this.helpButton = new cleverapps.UI.HelpButton(this.onHelpButtonClicked.bind(this)), this.addChild(this.helpButton), this.helpButton.setPositionRound(s.helpButton), e.value && (this.badge = new TileBadge({
                            type: "value",
                            value: e.value
                        }), this.badge.setScale(s.badge.scale), this.addChild(this.badge), this.badge.setPositionRound(s.badge)), t = new UseGoldButton({
                            price: this.product.price,
                            eventName: cleverapps.EVENTS.SPENT.CARAVAN + this.product.order,
                            width: s.button.width,
                            height: s.button.height,
                            filter: this.canBeBought.bind(this),
                            onClicked: this.callback.bind(this)
                        });
                    this.addChild(t), t.setPositionRound(s.button), this.onHelpButtonClicked(!0)
                },
                canBeBought: function () {
                    var e = cleverapps.toArray(
                        this.product.reward.unit || this.product.reward.units || []).reduce(function (e, t) {
                            return e + (void 0 === t.amount ? 1 : t.amount)
                        }, 0) - Game.currentGame.map.countEmptySlots();
                    return !(0 < e) || (Game.currentGame.centerHint.createTextHint("Spawn.nospace", {
                        left: e
                    }), !1)
                },
                onHelpButtonClicked: function (t) {
                    this.isHelpShown = !this.isHelpShown;

                    function e(e) {
                        if (e.stopAllActions(), t) return e.setVisible(!0), void e.setOpacity(255);
                        e.runAction(new cc.Sequence(new cc.Show, new cc.FadeIn(.3)))
                    }

                    function s(e) {
                        if (e.stopAllActions(), t) return e.setOpacity(0), void e.setVisible(!1);
                        e.runAction(new cc.Sequence(new cc.FadeOut(.3), new cc.Hide))
                    }
                    var i = cleverapps.styles.CaravanTileView,
                        i = (this.helpButton.setType(this.isHelpShown ? {
                            button_png: bundles.caravan.frames.return_button_png,
                            button_on_png: bundles.caravan.frames.return_button_on_png
                        } : {
                            button_png: bundles.buttons.frames.help_button_png,
                            button_on_png: bundles.buttons.frames.help_button_on_png
                        }), this.title.calculatePositionRound(this.isHelpShown ? i.title.help : i.title));
                    this.title.stopAllActions(), t ? this.title.setPositionRound(i) : this.title.runAction(new cc.MoveTo(.3, i));
                    this.isHelpShown ? ([this.grid, this.unitsGrid, this.amount].forEach(e), [this.rewardsBlock, this.person].forEach(s), this.badge && this.badge.performRecursive(s)) : ([this.rewardsBlock, this.person].forEach(e), [this.grid, this.unitsGrid, this.amount].forEach(s), this.badge && this.badge.performRecursive(e))
                },
                createGrid: function () {
                    var t = cleverapps.styles.CaravanTileView.grid,
                        e = (this.slots = this.units.map(function () {
                            var e = new cc.Scale9Sprite(bundles.caravan.frames.inner_bg_png);
                            return e.setContentSize(t.unit.bg), e
                        }), new cleverapps.GridLayout(this.slots, {
                            columns: 3,
                            margin: t.margin
                        }));
                    return e.setCascadeOpacityEnabledRecursively(!0), e
                },
                createUnitsGrid: function () {
                    var s = cleverapps.styles.CaravanTileView.grid,
                        i = new cc.Node;
                    return i.setAnchorPoint2(), i.setContentSize2(this.grid.getContentSize()), i.setCascadeOpacityEnabledRecursively(!0), this.units.forEach(function (e, t) {
                        e = UnitView.getUnitImage({
                            code: e.code,
                            stage: e.stage
                        }, {
                            preferStatic: !0,
                            alignAnchorX: !0
                        }), cleverapps.UI.fitToBox(e, {
                            width: s.unit.width,
                            height: s.unit.height,
                            maxScale: 1.5
                        }), i.addChild(e), t = this.slots[t].getPosition(), e.setPositionRound(t.x, t.y), e = cleverapps.UI.generateOnlyText(Math.round(100 / 12) + "%", cleverapps.styles.FONTS.CARAVAN_PROBABILITY);
                        e.setLocalZOrder(1), i.addChild(e), e.setPositionRound(t.x + s.probability.x, t.y + s.probability.y)
                    }, this), i
                },
                createTitle: function () {
                    var e = cleverapps.styles.CaravanTileView,
                        t = new cc.Scale9Sprite(bundles.caravan.frames.title_bg_png),
                        s = (t.setContentSize(e.title.bg), cleverapps.UI.generateOnlyText(this.product.title, cleverapps.styles.FONTS.WHITE_TEXT));
                    return s.fitTo(e.title.text.width), t.addChild(s), s.setPositionRound(e.title.text), t
                },
                createAmount: function () {
                    var e = cleverapps.UI.generateOnlyText("Caravan.ItemsAmount", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT, {
                        amount: this.cupData.amount
                    });
                    return e.setCascadeOpacityEnabledRecursively(!0), e
                },
                createRewardsBlock: function () {
                    var e = cleverapps.styles.CaravanTileView.rewardsBlock,
                        t = e.withBg ? new cc.Scale9Sprite(bundles.caravan.frames.inner_bg_png) : new cc.Node,
                        s = (t.setContentSize2(e.bg), new cc.Sprite(this.product.icon)),
                        s = (t.addChild(s), s.setPositionRound(e.icon), new cc.Sprite(bundles.caravan.frames.plus_png)),
                        s = (t.addChild(s), s.setPositionRound(e.plus), cleverapps.clone(this.product.reward)),
                        s = (delete s.unit, new RewardsListComponent(s, {
                            columns: 1,
                            small: !0,
                            textDirection: cleverapps.UI.HORIZONTAL,
                            font: cleverapps.styles.FONTS.CARAVAN_REWARDS_BLOCK_TEXT,
                            margin: {
                                x: e.margin,
                                y: e.margin
                            },
                            iconWrap: e.iconWrap,
                            textWrap: e.textWrap
                        }));
                    return t.addChild(s), s.setPositionRound(e.rewards), t.setCascadeOpacityEnabledRecursively(!0), t
                }
            })),
        CaravanMissionWindow = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CARAVAN_PROBABILITY: {
                size: 28,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            CARAVAN_REWARDS_BLOCK_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR
            }
        }), cleverapps.styles.CaravanTileView = {
            width: 540,
            height: 940,
            amount: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 130
                }
            },
            title: {
                x: {
                    align: "center",
                    dx: 7
                },
                y: {
                    align: "center",
                    dy: -25
                },
                help: {
                    x: {
                        align: "center",
                        dx: 7
                    },
                    y: {
                        align: "center",
                        dy: -245
                    }
                },
                bg: {
                    width: 560,
                    height: 126
                },
                text: {
                    width: 400,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 8
                    }
                }
            },
            button: {
                width: 300,
                height: 86,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 30
                }
            },
            grid: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: -55
                },
                margin: {
                    x: 10,
                    y: 6
                },
                probability: {
                    x: 44,
                    y: -50
                },
                unit: {
                    width: 135,
                    height: 135,
                    bg: {
                        width: 145,
                        height: 145
                    }
                }
            },
            rewardsBlock: {
                withBg: !0,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 130
                },
                margin: 0,
                bg: {
                    width: 447,
                    height: 260
                },
                icon: {
                    x: {
                        align: "center",
                        dx: -110
                    },
                    y: {
                        align: "center"
                    }
                },
                plus: {
                    x: {
                        align: "center",
                        dx: 15
                    },
                    y: {
                        align: "center"
                    }
                },
                rewards: {
                    x: {
                        align: "right",
                        dx: -10
                    },
                    y: {
                        align: "center"
                    }
                },
                iconWrap: {
                    width: 45,
                    height: 65
                },
                textWrap: {
                    width: 90,
                    height: 65
                }
            },
            helpButton: {
                x: {
                    align: "left",
                    dx: -10
                },
                y: {
                    align: "top",
                    dy: 10
                }
            },
            badge: {
                x: {
                    align: "right",
                    dx: 13
                },
                y: {
                    align: "top",
                    dy: 30
                },
                scale: .7
            },
            person: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 475
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.mission = e, this._super({
                    name: "CaravanMissionWindow",
                    content: this.createContent(),
                    noBackground: !0,
                    title: "CaravanMissionWindow.Title",
                    notCloseByTouchInShadow: !0,
                    closeButtonDelay: !0
                }), cleverapps.meta.showControlsWhileFocused("MenuBarGoldItem")
            },
            getPerson: function () {
                return {
                    left: "mergecraft" === cleverapps.config.name ? "seller" : "camel",
                    right: "camel"
                }
            },
            createContent: function () {
                var e = cleverapps.styles.CaravanMissionWindow,
                    t = Caravan.PRODUCTS.map(function (e, t) {
                        var e = Product.Create(e),
                            s = Families.caravanbox.units[t].cup,
                            s = new CaravanTileView(e, s, this.buyProduct.bind(this, e));
                        return s.setLocalZOrder(-t), s
                    }, this);
                return t.forEach(function (e, t) {
                    e.runAction(new cc.Sequence(new cc.DelayTime(.7 + .3 * t), new cc.CallFunc(function () {
                        e.onHelpButtonClicked()
                    })))
                }), new cleverapps.Layout(t, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin
                })
            },
            buyProduct: function (e) {
                this.mission.logic.buyProduct(e), this.close()
            },
            listBundles: function () {
                return ["caravan"]
            }
        })),
        LanternMissionLogic = (cleverapps.styles.CaravanMissionWindow = {
            margin: 20
        }, function (e) {
            this.mission = e, this.lantern = new Lantern(e)
        }),
        ManualStarters = {
            ChildStarter: function (e) {
                return function () {
                    return cleverapps.missionManager.findByType(e)
                }
            },
            ExpeditionFeastStarter: function (e) {
                var t = Game.currentGame;
                if (cleverapps.travelBook.isExpedition() && t && t.fogs.isOpened("fog6")) {
                    var s, i, t = cleverapps.missionManager.findLocalExpedition();
                    if (t && t.type === Missions[e].parentType) return i = s = cleverapps.parseInterval(Missions[e].duration), e = cleverapps.missionManager.getLastRemoved(e), t.getTimeLeft() >= s && e + i < Date.now()
                }
                return !1
            },
            SnailFeastStarter: function (e, t) {
                var s = cleverapps.missionManager.findLocalExpedition(),
                    i = cleverapps.missionManager.getLastRemoved(e);
                if (!s) return !1;
                if (s.type !== Missions[e].parentType || !MissionTree.targets[e] || !MissionTree.targets[e].length) return !1;
                if (i < s.started && (i = 0), t && t.fromMissionTree) return !i;
                if (!i) return !1;
                t = cleverapps.parseInterval(Missions[e].duration), e = t;
                return cleverapps.config.debugMode && (e = cleverapps.parseInterval("3 minutes")), s.getTimeLeft() >= t && i + e < Date.now()
            },
            MissionTreeStarter: function (e, t) {
                return t && t.fromMissionTree
            }
        },
        Missions = ("undefined" == typeof cc && (cleverapps = require("../utils"), Mission = require("./mission").Mission), Mission.TYPE_COMBO = 0, Mission.TYPE_COLLECT_MARK = 1, Mission.TYPE_BURN_NEARBY = 2, Mission.TYPE_LETTER = 3, Mission.TYPE_TREASURE_SEARCH = 7, Mission.TYPE_LANTERN = 9, Mission.TYPE_LEVELPASS = 15, Mission.TYPE_BUILDPASS = 15, Mission.TYPE_STICKERS_COLLECTION = 18, Mission.TYPE_BONUS_WORLD = 19, Mission.TYPE_LIVESFEAST = 20, Mission.TYPE_SLOT_MACHINE = 21, Mission.TYPE_SOFTFEAST = 22, Mission.TYPE_BOOSTTIME = 23, Mission.TYPE_CHESTTIME = 24, Mission.TYPE_SALEPASS = 25, Mission.TYPE_KRAKENFEAST = 26, Mission.TYPE_SLOT2_PASS = 28, Mission.TYPE_SLOT1_FEAST = 30, Mission.TYPE_DRAGONIA_EXPEDITION = "32v1", Mission.TYPE_SLOT2_FEAST = 33, Mission.TYPE_SLOT1_PASS = 34, Mission.TYPE_UNDERSEA_EXPEDITION = "40v1",
            Mission.TYPE_CARAVAN = 42, Mission.TYPE_EXPEDITION_PASS = 44, Mission.TYPE_EXPEDITION_FEAST = 45, Mission.TYPE_UNDERSEA2_EXPEDITION = "46v1", Mission.TYPE_SNAIL_FEAST = 47, Mission.TYPE_RAPUNZEL_EXPEDITION = 48, Mission.TYPE_DRAGONIA2_EXPEDITION = 49, Mission.TYPE_HALLOWEEN_EXPEDITION = 50, Mission.TYPE_RAPUNZEL2_EXPEDITION = 52, Mission.TYPE_PERIODIC_PACK = 53, Mission.TYPE_PERIODIC_SALE = 54, Mission.TYPE_EASTER_EXPEDITION = 55, Mission.TYPE_ADVENTURE_EXPEDITION = 58, Mission.TYPE_DRAGONIA3_EXPEDITION = 59, Mission.TYPE_HALLOWEEN_2023_EXPEDITION = 60, Mission.TYPE_RAPUNZEL3_EXPEDITION = 62, Mission.TYPE_XMAS_EXPEDITION = "61v1", Mission.TYPE_CHINA_EXPEDITION = 63, Mission.TYPE_CHAIN_SALE = 64, Mission.OLD_VERSIONS = {}, Object.keys(Mission).forEach(function (e) {
                if (0 === e.indexOf("TYPE_")) {
                    var t = Mission[e];
                    if (String(t).match(/^(\d+)v(\d+)$/))
                        for (var s = Mission.ParseTypeVersion(t) - 1; 0 <= s; --s) Mission.OLD_VERSIONS[Mission.VersionType(t, s)] = t
                }
            }), Mission.OBSOLETE_TYPES = [4, 5, 6, 8, 11, 12, 13, 14, 16, 17, 27, 29, 35, 36, 37, 38, 39, 41, 43, 51, 56,
                Mission.TYPE_EASTER_EXPEDITION, Mission.TYPE_HALLOWEEN_EXPEDITION, Mission.TYPE_PERIODIC_SALE
            ], {}),
        CurrentEpisodeLabel = (Missions.SEMAPHORE_ALWAYS = 0, Missions.SEMAPHORE_PRIMARY = 1, Missions.SEMAPHORE_SECONDARY = 2, Missions.SEMAPHORE_CUSTOM_LANTERN = 4, Missions.SEMAPHORE_CUSTOM_SALE = 16, Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT1 = 32, Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2 = 64, Missions.SEMAPHORE_PERIODIC_SALE = 128, Missions.SEMAPHORE_COOLDOWNS = {}, Missions.SEMAPHORE_COOLDOWNS[Missions.SEMAPHORE_PRIMARY] = "1 hour", Missions.SEMAPHORE_COOLDOWNS[Missions.SEMAPHORE_SECONDARY] = "2 day", Missions.SEMAPHORE_COOLDOWNS[Missions.SEMAPHORE_CUSTOM_LANTERN] = "5 day", Missions.SEMAPHORE_COOLDOWNS[Missions.SEMAPHORE_CUSTOM_SALE] = "7 day", Missions.SEMAPHORE_COOLDOWNS[Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT1] = "0", Missions.SEMAPHORE_COOLDOWNS[Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2] = "0", Missions.SEMAPHORE_COOLDOWNS[Missions.SEMAPHORE_PERIODIC_SALE] = "0", Missions.initialize = function () {
            var e = {
                available: {
                    level: 3.45
                },
                view: MissionWindow,
                duration: "1 day",
                semaphore: Missions.SEMAPHORE_SECONDARY,
                startWindow: MissionRulesOptionsBuilder,
                prize: RewardsConfig.Tournament.places,
                teaser: !0
            },
                t = (Missions[Mission.TYPE_COMBO] = Object.assign({}, e, {
                    available: {
                        level: 4.93
                    },
                    name: "MagicTournament",
                    collectIcon: bundles.tournament_icon.frames.clover_png,
                    competition: {
                        step: [1, 4],
                        amount: [20, 30]
                    },
                    bundle: "magic_tournament",
                    sideBarJson: bundles.sidebar.jsons.tournament_magic_icon_json,
                    finishWindow: MissionWindow
                }), Missions[Mission.TYPE_COLLECT_MARK] = Object.assign({}, e, {
                    available: {
                        level: 3.6
                    },
                    name: "RoseTournament",
                    collectIcon: bundles.tournament_icon.frames.rose_png,
                    competition: {
                        step: [10, 40],
                        amount: [20, 30]
                    },
                    bundle: "rose_tournament",
                    sideBarJson: bundles.sidebar.jsons.tournament_rose_icon_json,
                    finishWindow: MissionWindow
                }), Missions[Mission.TYPE_BURN_NEARBY] = Object.assign({}, e, {
                    available: {
                        level: 4.4
                    },
                    name: "TulpanTournament",
                    collectIcon: bundles.tournament_icon.frames.tulpan_png,
                    competition: {
                        step: [3, 10],
                        amount: [20, 30]
                    },
                    bundle: "tulpan_tournament",
                    sideBarJson: bundles.sidebar.jsons.tournament_tulpan_icon_json,
                    finishWindow: MissionWindow
                }), Missions[Mission.TYPE_LETTER] = Object.assign({}, e, {
                    name: "LetterTournament",
                    collectIcon: bundles.tournament_icon.frames.mission_letter_png,
                    competition: {
                        step: [2, 6],
                        amount: [20, 30]
                    },
                    sideBarJson: bundles.sidebar.jsons.mission_letter_icon_json,
                    finishWindow: MissionWindow,
                    bundle: "letter_tournament",
                    STAR_TYPES_AMOUNT: 2
                }), cleverapps.config.features || []);
            t.includes("treasure_search") && (Missions[Mission.TYPE_TREASURE_SEARCH] = Object.assign({}, e, {
                available: {
                    level: 4.93
                },
                name: "TreasureSearch",
                view: TreasureSearchWindow,
                minigame: {
                    price: 1
                },
                prize: RewardsConfig.TreasureSearch,
                startWindow: TreasureSearchWindow,
                nudgeWindow: TreasureSearchWindow,
                duration: "3 days",
                semaphore: Missions.SEMAPHORE_PRIMARY,
                bundle: "treasuresearch",
                sideBarJson: bundles.sidebar.jsons.treasure_search_icon_json,
                logic: TreasureSearchMissionLogic
            })), t.includes("stickers_collection") && (
                Missions[Mission.TYPE_STICKERS_COLLECTION] = Object.assign({}, e, {
                    available: {
                        level: 4.93
                    },
                    name: "StickersCollection",
                    view: StickersCollectionWindow,
                    minigame: {
                        price: 1
                    },
                    prize: RewardsConfig.StickersCollection,
                    startWindow: StickersCollectionWindow,
                    nudgeWindow: StickersCollectionWindow,
                    duration: "3 days",
                    semaphore: Missions.SEMAPHORE_PRIMARY,
                    bundle: "stickers_collection",
                    sideBarJson: bundles.sidebar.jsons.stickers_collection_icon_json,
                    logic: StickersCollectionLogic,
                    startCurrency: 0,
                    tournament: !0
                })), "undefined" != typeof LanternWindow && (Missions[Mission.TYPE_LANTERN] = Object.assign({}, e, {
                    available: {
                        level: 8.26
                    },
                    name: "Lantern",
                    view: LanternWindow,
                    duration: "2 day",
                    semaphore: Missions.SEMAPHORE_CUSTOM_LANTERN,
                    startWindow: LanternWindow,
                    sideBarJson: bundles.sidebar.jsons.lantern_icon_json,
                    iconForce: Forces.LANTERN,
                    logic: LanternMissionLogic,
                    prize: void 0
                })), t.includes("bonus_world") && (Missions[Mission.TYPE_BONUS_WORLD] = Object.assign({}, e, {
                    name: "BonusWorld",
                    startWindow: BonusWorldWindow,
                    view: BonusWorldScene,
                    semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT1,
                    available: {
                        level: 3.85
                    },
                    logic: BonusWorldMissionLogic,
                    sideBarJson: BonusWorldConfig.xmas.sideBarJson,
                    feature: "bonusworld",
                    oncePerEvent: !cleverapps.config.debugMode,
                    iconForce: Forces.BONUS_WORLD
                })), Missions[Mission.TYPE_PERIODIC_SALE] = {
                    available: {
                        level: 5
                    },
                    name: "PeriodicSale",
                    feature: "periodic_sale",
                    semaphore: Missions.SEMAPHORE_PERIODIC_SALE,
                    oncePerEvent: !0,
                    logic: PeriodicSaleLogic,
                    bundle: "periodic_sale",
                    sideBarJson: bundles.sidebar.jsons.periodic_sale_json,
                    view: PeriodicSaleWindow,
                    iconForce: Forces.PERIODIC_SALE
                }, Missions[Mission.TYPE_CHAIN_SALE] = {
                    available: {
                        level: 5
                    },
                    name: "ChainSale",
                    feature: "chain_sale",
                    semaphore: Missions.SEMAPHORE_PERIODIC_SALE,
                    oncePerEvent: !0,
                    logic: ChainSaleLogic,
                    bundle: "chain_sale",
                    sideBarJson: bundles.sidebar.jsons.chain_sale_json,
                    view: ChainSaleWindow,
                    iconForce: Forces.CHAIN_SALE
                }, "merge" === cleverapps.config.type && (Missions[Mission.TYPE_LIVESFEAST] = Object.assign({}, e, {
                    available: {
                        level: 5
                    },
                    name: "LivesFeast",
                    duration: "3 day",
                    semaphore: Missions.SEMAPHORE_PRIMARY,
                    competition: {
                        step: [3, 3, 3, 5, 5, 5, 10, 10, 15, 20, 25],
                        forceCoef: .45,
                        amount: [20, 30],
                        noPlayerEpisodeCoef: !0,
                        botAheadPlayerCoef: .5,
                        botAheadPlayerBigDifferenceCoef: .2,
                        bigDistanceLength: 100
                    },
                    logic: LivesFeast,
                    prize: RewardsConfig.LivesFeast.places,
                    bundle: "lives_feast",
                    collectIcon: bundles.reward_icons.frames.reward_energy_png,
                    sideBarJson: bundles.sidebar.jsons.lives_feast_icon_json,
                    view: LivesFeastMissionWindow,
                    startWindow: LivesFeastMissionWindow,
                    finishWindow: LivesFeastMissionWindow
                }), Missions[Mission.TYPE_BUILDPASS] = Object.assign({}, e, {
                    name: "BuildPass",
                    view: BuildPassWindow,
                    semaphore: Missions.SEMAPHORE_PRIMARY,
                    startWindow: BuildPassWindow,
                    finishWindow: BuildPassWindow,
                    rulesOptions: PassRulesOptions,
                    logic: PassMissionLogic,
                    sideBarJson: bundles.sidebar.jsons.buildpass_icon_json,
                    lastChanceView: PassLastChanceWindow,
                    collectItemName: "star",
                    duration: "3 days",
                    cooldown: "28 days",
                    available: {
                        level: 5
                    }
                }), Missions[Mission.TYPE_SALEPASS] = Object.assign({}, e, {
                    name: "SalePass",
                    view: SalePassWindow,
                    semaphore: Missions.SEMAPHORE_PRIMARY,
                    startWindow: SalePassWindow,
                    finishWindow: SalePassWindow,
                    rulesOptions: SalePassRulesOptions,
                    logic: PassMissionLogic,
                    sideBarJson: bundles.sidebar.jsons.salepass_icon_json,
                    lastChanceView: PassLastChanceWindow,
                    collectItemName: "crystal",
                    duration: "3 days",
                    cooldown: "28 days",
                    tutorial: MergeTutorials.salepass,
                    available: {
                        level: 5
                    }
                }), Missions[Mission.TYPE_CHESTTIME] = Object.assign({}, e, {
                    available: {
                        level: 9.5
                    },
                    logic: ChestTime,
                    name: "ChestTime",
                    duration: "1 day",
                    semaphore: Missions.SEMAPHORE_SECONDARY,
                    bundle: "chesttime",
                    sideBarJson: bundles.sidebar.jsons.chesttime_icon_json,
                    view: ChestTimeMissionWindow,
                    startWindow: ChestTimeMissionWindow,
                    finishWindow: ChestTimeMissionWindow
                }), Missions[Mission.TYPE_SOFTFEAST] = Object.assign({}, e, {
                    available: {
                        level: 5
                    },
                    name: "SoftFeast",
                    duration: "3 day",
                    semaphore: Missions.SEMAPHORE_PRIMARY,
                    competition: {
                        step: [5, 50],
                        forceCoef: .1,
                        amount: [20, 30],
                        noPlayerEpisodeCoef: !0,
                        botAheadPlayerCoef: .5,
                        botAheadPlayerBigDifferenceCoef: .2,
                        bigDistanceLength: 500
                    },
                    logic: SoftFeast,
                    prize: RewardsConfig.SoftFeast.places,
                    bundle: "lives_feast",
                    collectIcon: bundles.reward_icons.frames.reward_coin_png,
                    sideBarJson: bundles.sidebar.jsons.soft_feast_icon_json,
                    view: SoftFeastMissionWindow,
                    startWindow: SoftFeastMissionWindow,
                    finishWindow: SoftFeastMissionWindow
                }), Missions[Mission.TYPE_KRAKENFEAST] = Object.assign({}, e, {
                    available: {
                        level: 5
                    },
                    name: "KrakenFeast",
                    duration: "3 day",
                    semaphore: Missions.SEMAPHORE_PRIMARY,
                    competition: {
                        step: [5, 5, 5, 5, 5, 10, 10, 10, 10, 15, 15, 20, 20, 25, 30],
                        forceCoef: .2,
                        amount: [20, 30],
                        noPlayerEpisodeCoef: !0,
                        botAheadPlayerCoef: .5,
                        botAheadPlayerBigDifferenceCoef: .2,
                        bigDistanceLength: 90
                    },
                    logic: KrakenFeast,
                    prize: RewardsConfig.KrakenFeast.places,
                    bundle: "lives_feast",
                    collectIcon: bundles.reward_icons.frames.tentacle_png,
                    sideBarJson: bundles.sidebar.jsons.kraken_feast_icon_json,
                    view: KrakenFeastMissionWindow,
                    startWindow: KrakenFeastMissionWindow,
                    finishWindow: KrakenFeastMissionWindow
                }), Missions[Mission.TYPE_BOOSTTIME] = Object.assign({}, e, {
                    available: {
                        level: 9.5
                    },
                    name: "BoostTime",
                    duration: "1 day",
                    semaphore: Missions.SEMAPHORE_SECONDARY,
                    bundle: "boosttime",
                    sideBarJson: bundles.sidebar.jsons.boosttime_icon_json,
                    view: BoostTimeMissionWindow,
                    startWindow: BoostTimeMissionWindow,
                    finishWindow: BoostTimeMissionWindow
                }), Missions[Mission.TYPE_CARAVAN] = Object.assign({}, e, {
                    available: {
                        level: 8
                    },
                    logic: Caravan,
                    name: "Caravan",
                    ship: "caravanship",
                    duration: "3 day",
                    semaphore: Missions.SEMAPHORE_SECONDARY,
                    bundle: "unitssale",
                    startWindow: CaravanMissionWindow,
                    view: CaravanMissionWindow,
                    finishWindow: CaravanMissionWindow,
                    sideBarJson: bundles.sidebar.jsons.caravan_icon_json
                }), Missions[Mission.TYPE_EXPEDITION_PASS] = {
                    name: "ExpeditionPass",
                    view: ExpeditionPassWindow,
                    startWindow: ExpeditionPassWindow,
                    finishWindow: ExpeditionPassWindow,
                    rulesOptions: ExpeditionPassRulesOptions,
                    sideBarJson: bundles.sidebar.jsons.expedition_buildpass_icon_json,
                    logic: PassMissionLogic,
                    sideBarSlotName: "expeditionBuildPassSideBarIcon",
                    lastChanceView: PassLastChanceWindow,
                    collectItemName: "star",
                    manualStart: ManualStarters.MissionTreeStarter,
                    manualFinish: !0,
                    mainWorldReward: !0
                }, Missions[Mission.TYPE_EXPEDITION_FEAST] = {
                    name: "ExpeditionFeast",
                    view: ExpeditionFeastWindow,
                    startWindow: ExpeditionFeastWindow,
                    finishWindow: ExpeditionFeastWindow,
                    manualStart: ManualStarters.ExpeditionFeastStarter,
                    logic: FeastExpeditionLogic,
                    duration: "1 hour",
                    bundle: "lives_feast",
                    prize: RewardsConfig.ExpeditionFeast.places,
                    mainWorldReward: !0,
                    sideBarJson: bundles.sidebar.jsons.expedition_feast_icon_json,
                    collectIcon: bundles.reward_icons.frames.expedition_feast_icon,
                    sideBarSlotName: "expeditionFeastSideBarIcon",
                    competition: {
                        step: [2, 2, 2, 3, 3, 3, 5, 5, 5, 10, 10, 12, 12, 15],
                        forceCoef: 2,
                        amount: [20, 30],
                        noPlayerEpisodeCoef: !0,
                        botAheadPlayerCoef: .5,
                        offlineCoef: .8,
                        botAheadPlayerBigDifferenceCoef: .3,
                        bigDistanceLength: 50
                    }
                }, Missions[Mission.TYPE_SNAIL_FEAST] = {
                    name: "SnailFeast",
                    view: SnailFeastWindow,
                    startWindow: SnailFeastWindow,
                    finishWindow: SnailFeastWindow,
                    manualStart: ManualStarters.SnailFeastStarter,
                    logic: FeastExpeditionLogic,
                    duration: "6 hour",
                    bundle: "snail_feast",
                    prize: RewardsConfig.SnailFeast.places,
                    mainWorldReward: !0,
                    sideBarJson: bundles.sidebar.jsons.snail_feast_icon_json,
                    collectIcon: bundles.reward_icons.frames.snail_feast_icon,
                    sideBarSlotName: "expeditionFeastSideBarIcon",
                    competition: {
                        step: [3, 3, 3, 3, 10, 10, 10, 65, 65],
                        forceCoef: .45,
                        amount: 5,
                        noPlayerEpisodeCoef: !0,
                        botAheadPlayerCoef: .3,
                        offlineCoef: .8,
                        botAheadPlayerBigDifferenceCoef: .1,
                        bigDistanceLength: 50
                    }
                }, Missions[Mission.TYPE_PERIODIC_PACK] = {
                    available: {
                        level: 5
                    },
                    name: "PeriodicPack",
                    feature: "periodic_pack",
                    semaphore: Missions.SEMAPHORE_PERIODIC_SALE,
                    oncePerEvent: !0,
                    sideBarJson: !1,
                    logic: PeriodicPackLogic
                }, TravelBook.INIT_EXPEDITIONS()), "undefined" != typeof SlotMachineScene && (Missions[Mission.TYPE_SLOT_MACHINE] = Object.assign({}, e, {
                    name: "SlotMachine",
                    startWindow: void 0,
                    view: SlotMachineScene,
                    semaphore: Missions.SEMAPHORE_PRIMARY,
                    available: {
                        level: 3.85
                    },
                    logic: SlotMachineMissionLogic,
                    sideBarJson: bundles.sidebar.jsons.slot_machine_json,
                    duration: "3 days",
                    iconForce: Forces.SLOT_MACHINE_ICON
                })), "match3" === cleverapps.config.type && (Missions[Mission.TYPE_LEVELPASS] = Object.assign({}, e, {
                    priority: 4,
                    name: "LevelPass",
                    view: LevelPassWindow,
                    semaphore: Missions.SEMAPHORE_PRIMARY,
                    iconForce: Forces.LEVELPASS,
                    startWindow: LevelPassWindow,
                    finishWindow: LevelPassWindow,
                    rulesOptions: {
                        name: "PassRulesWindow"
                    },
                    logic: PassMissionLogic,
                    sideBarJson: bundles.sidebar.jsons.levelpass_icon_json,
                    sideBarProgressIconJson: bundles.sidebar.jsons.levelpass_star_json,
                    lastChanceView: PassLastChanceWindow,
                    collectItemName: "star",
                    duration: "7 days",
                    available: {
                        level: 14
                    }
                }), Missions[Mission.TYPE_BONUS_WORLD] && (Missions[Mission.TYPE_BONUS_WORLD].available = {
                    level: 4.13
                })), "hustlemerge" === cleverapps.config.name && StopHustlemergeMissions(), Missions.afterInitialize()
        }, Missions.checkIllegal = function (e) {
            return void 0 === e || e.includes && e.includes("undefined")
        }, Missions.afterInitialize = function () {
            Object.keys(Missions).forEach(function (s) {
                s = cleverapps.castType(s);
                var e = Missions[s];
                e.type = s, (e.childMissions || []).forEach(function (e) {
                    var t = Mission.CompoundType(e, s);
                    Missions[t] = Object.assign({}, Missions[e], {
                        type: t,
                        parentType: s,
                        implementations: void 0
                    }), Missions[e].implementations || (Missions[e].implementations = []), Missions[e].implementations.push(t)
                })
            }), [Mission.TYPE_RAPUNZEL_EXPEDITION, Mission.TYPE_RAPUNZEL2_EXPEDITION, Mission.TYPE_EASTER_EXPEDITION, Mission.TYPE_CHINA_EXPEDITION].forEach(function (e) {
                Missions[e] && (e = Mission.CompoundType(Mission.TYPE_EXPEDITION_PASS, e), Missions[e] = Object.assign(Missions[e], {
                    manualStart: void 0,
                    semaphore: Missions.SEMAPHORE_ALWAYS,
                    available: {
                        fogId: "fog1"
                    }
                }))
            }), Object.keys(Missions).forEach(function (e, t) {
                Missions.checkIllegal(e) && cleverapps.throwAsync("Undefined mission type " + e + " ind: " + t)
            }), Object.keys(PassLevelsConfig).forEach(function (e, t) {
                Missions.checkIllegal(e) && cleverapps.throwAsync("Undefined pass config type " + e + " ind: " + t)
            })
        }, "undefined" == typeof cc && (module.exports = {
            Missions: Missions,
            Mission: Mission
        }), cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.episode = e, this.createContent(), this.setAnchorPoint2(), this.setPositionRound({
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    }
                }), this.setLocalZOrder(1)
            },
            createContent: function () {
                this.bg = this.createBg();
                var e = this.label = new cc.Node;
                e.setAnchorPoint2(), e.setContentSize2(this.bg.getContentSize()), e.addChild(this.bg), e.setPositionRound(cleverapps.styles.CurrentEpisodeLabel.label.alignment), this.addLabelText(), this.setContentSize2(e.getContentSize()), this.addChild(this.label)
            },
            createBg: function () {
                var e, t, s = cleverapps.styles.CurrentEpisodeLabel.background;
                return s.json ? ((e = new cc.Node).setAnchorPoint2(), e.setContentSize2(s), (t = this.bgAnimation = new cleverapps.Spine(s.json)).setAnimation(0, "idle", !1), t.setPosition(e.width / 2, e.height / 2), e.addChild(t)) : (e = cleverapps.UI.createScale9Sprite(s.image, cleverapps.UI.Scale9Rect.TwoPixelXY), s.width && e.setContentSize2(s)), e.setPosition(e.width / 2, e.height / 2), e
            },
            addLabelText: function () {
                var e = cleverapps.styles.CurrentEpisodeLabel.label.islandText,
                    t = this.labelText = cleverapps.UI.generateTTFText("StartEpisodeWindow.Title" + this.episode.episodeNo, e.font);
                t.fitTo(this.bg.width + e.padding), t.setPositionRound(e.alignment), this.label.addChild(t)
            },
            addLevelsLabel: function () {
                var e, t, s = cleverapps.styles.CurrentEpisodeLabel.label.levelsText;
                s && (t = this.episode.levels.filter(function (e) {
                    return e.type === Episode.LEVEL_TYPE_PASSED
                }).length, e = this.episode.levels.length, (t = cleverapps.UI.generateTTFText(t + "/" + e, s.font)).setPositionRound(s.alignment), this.label.addChild(t))
            }
        })),
        MiniGameWindow = (cleverapps.MiniGame = function (e) {
            cleverapps.config.debugMode && (cleverapps.MiniGame.TIMEOUT = "2 minutes"), cleverapps.DailyChest.call(this, {
                isNewUser: e,
                serverTaskName: "bonuses",
                interval: cleverapps.parseInterval(cleverapps.MiniGame.TIMEOUT)
            }), this.closedText = "MiniGame.ClosedText"
        }, cleverapps.MiniGame.prototype = Object.create(cleverapps.DailyChest.prototype),
            cleverapps.MiniGame.prototype.constructor = cleverapps.MiniGame, cleverapps.MiniGame.prototype.initializeForNewUser = function () {
                this.locked = !1, this.setWhenUnlock(Date.now())
            }, cleverapps.MiniGame.TIMEOUT = "1 day", cleverapps.MiniGame.prototype.resetUnlockCountdown = function () {
                cleverapps.DailyChest.prototype.resetUnlockCountdown.call(this), cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.MINI_GAME, this.when - Date.now())
            }, cleverapps.MiniGame.prototype.refreshItems = function () { }, cleverapps.MiniGame.prototype.isAvailable = function () {
                return !!levels.user.checkAvailable(cleverapps.MiniGame.AVAILABLE) && !this.locked
            }, cleverapps.MiniGame.prototype.getReward = function () {
                var e = cleverapps.Random.choose(RewardsConfig.MiniGame);
                return levels.user.isBeginner() && RewardsConfig.MiniGameBeginner && (e = cleverapps.Random.choose(RewardsConfig.MiniGameBeginner)), (e = levels.user.isNovice() && RewardsConfig.MiniGameNovice ? cleverapps.Random.choose(RewardsConfig.MiniGameNovice) : e).betGold && delete e.betGold,
                    e = cleverapps.user.prepareRewardByRich(e)
            }, cleverapps.MiniGame.prototype.openWindow = function (e) {
                var t;
                cleverapps.periodicBonus.locked ? (cleverapps.notification.create(cleverapps.periodicBonus.closedText), e && e()) : (t = cleverapps.clone(cleverapps.periodicBonus.getReward(), !0), new MiniGameWindow(t), cleverapps.eventBus.trigger("taskEvent", DailyTasks.PLAY_MINI_GAME), e && (cleverapps.meta.onceNoWindowsListener = e))
            }, cleverapps.MiniGame.AVAILABLE = {
                level: 2.13,
                registered: "1 hour",
                epicart: {
                    disabled: !0
                }
            }, Window.extend({
                onWindowLoaded: function (e) {
                    this.reward = e;
                    var e = cleverapps.styles.MiniGameWindow,
                        t = (this.text = cleverapps.UI.generateOnlyText("MiniGameWindow.Text", cleverapps.styles.FONTS.WINDOW_TEXT), this.text.fitTo(e.text.width), this.createBoxesNode()),
                        t = new cleverapps.Layout([t, this.text], {
                            margin: e.margin,
                            direction: cleverapps.UI.VERTICAL,
                            padding: e.padding
                        });
                    this._super({
                        title: "MiniGameWindow.Title",
                        name: "minigamewindow",
                        content: t,
                        closeButton: !1
                    })
                },
                createBoxesNode: function () {
                    var e = cleverapps.styles.MiniGameWindow,
                        s = new cc.Node;
                    return s.setAnchorPoint2(), this.boxes = [], e.boxes.forEach(function (e, t) {
                        t = this.createBox(t);
                        this.boxes.push(t), s.addChild(t), t.setPositionRound(e)
                    }, this), cleverapps.UI.wrap(s), s
                },
                createBox: function (e) {
                    var t = cleverapps.styles.MiniGameWindow,
                        s = new cc.Node,
                        i = (s.setAnchorPoint2(), s.setContentSize2(t.box), new cleverapps.Spine(bundles.minigame.jsons.minigame_json));
                    return s.addChild(i), i.setSkin(["green", "blue", "pink"][e]), i.setAnimation(0, "animation", !0), i.setPositionRound(t.box.animation), cleverapps.UI.applyHover(s), cleverapps.UI.onClick(s, this.onPressed.bind(this)), s
                },
                onShow: function () {
                    this._super(), this.showUpAnimation()
                },
                onHide: function () {
                    this._super(), this.boxes && this.boxes.forEach(function (e) {
                        e.stopAllActions()
                    }), this.text && this.text.stopAllActions()
                },
                showUpAnimation: function () {
                    var e = this.boxes,
                        s = e.map(function (e) {
                            return e.getPosition()
                        }),
                        i = [
                            [2, 0, 1],
                            [0, 2, 1],
                            [1, 0, 2]
                        ];
                    this.text.setOpacity(0), e.forEach(function (e, t) {
                        e.runAction(
                            new cc.Sequence(new cc.DelayTime(.5), new cc.MoveTo(.3, s[i[0][t]]), new cc.DelayTime(.1), new cc.CallFunc(function () {
                                0 === t && cleverapps.audio.playSound(bundles.main.urls.daily_game_mix_effect)
                            }), new cc.MoveTo(.3, s[i[1][t]]), new cc.DelayTime(.1), new cc.CallFunc(function () {
                                0 === t && cleverapps.audio.playSound(bundles.main.urls.daily_game_mix_effect)
                            }), new cc.MoveTo(.3, s[i[2][t]]), new cc.DelayTime(.1), new cc.CallFunc(function () {
                                0 === t && cleverapps.audio.playSound(bundles.main.urls.daily_game_mix_effect)
                            }), new cc.MoveTo(.3, s[t]), new cc.DelayTime(.3), new cc.CallFunc(function () {
                                0 === t && this.text.runAction(new cc.FadeIn(.5))
                            }.bind(this))))
                    }, this)
                },
                onPressed: function () {
                    cleverapps.periodicBonus.locked || (cleverapps.periodicBonus.open(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_BONUS), RewardWindow.createMiniGameWindow(this.reward), this.close())
                }
            })),
        TooltipManager = (cleverapps.styles.MiniGameWindow = {
            margin: 30,
            padding: {
                top: 30,
                bottom: 30
            },
            text: {
                width: 500
            },
            box: {
                width: 150,
                height: 150,
                animation: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    }
                }
            },
            boxes: [{
                x: -180,
                y: -50
            }, {
                x: 0,
                y: 50
            }, {
                x: 180,
                y: -50
            }]
        }, cleverapps.UI.Tooltip = cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.options = t, this.target = e, this.duration = t.duration || 4;
                var s, i, e = cleverapps.styles.UI.Tooltip,
                    n = t.size || e.SIZE.medium;
                t.rewards ? this.setContentSize2(n.width + e.rewards.extraWidth, n.height + e.rewards.extraHeight) : this.setContentSize2(n), this.setAnchorPoint2(), t.zOrder && this.setLocalZOrder(t.zOrder), this.bg = new cc.Scale9Sprite(bundles.tooltip.frames.tooltip_bg_png), this.addChild(this.bg), this.bg.setContentSize2(this.getContentSize()), void 0 === t.arrow && (t.arrow = t.position === e.LOCATION.below ? e.ARROW.top : e.ARROW.bottom), this.drawArrow(t.arrow), t.content ? (this.content = t.content, this.bg.addChild(this.content), (n = Math.min(this.width / (this.content.width * this.content.scaleX + e.content.padding), this.height / (this.content.height * this.content.scaleY + e.content.padding))) < 1 && this.content.setScale(this.content.scaleX * n, this.content.scaleY * n),
                    this.content.setPositionRound(this.width / 2, this.height / 2 + e.content.offset.y)) : ((n = this.text = cleverapps.UI.generateOnlyText(t.text, cleverapps.styles.FONTS.TOOLTIP_TEXT)).fitTo(this.width - e.content.padding), s = n, t.rewards && (i = new RewardsListComponent(t.rewards, {
                        columns: 5,
                        font: cleverapps.styles.FONTS.TOOLTIP_FONT,
                        noPrefix: !0,
                        iconWrap: e.rewards.iconWrap,
                        noShowControls: !0
                    }), cleverapps.UI.fitToBox(i, {
                        width: this.width - e.content.padding
                    }), s = new cleverapps.Layout([n, i], {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.rewards.margin
                    })), s.setPositionRound(this.width / 2, this.height / 2 + e.content.offset.y), this.bg.addChild(s)), t.control ? cleverapps.meta.registerControl(t.control, this.createListener(function (e) {
                        e ? this.show() : this.hide()
                    }.bind(this))) : this.show(), this.updatePosition()
            },
            hide: function () {
                this.stopAllActions();
                var e = .2 * this.scale;
                this.runAction(new cc.Sequence(new cc.ScaleTo(e, 0), new cc.CallFunc(function () {
                    this.content && this.content.removeFromParent()
                }.bind(this)), new cc.RemoveSelf))
            },
            updatePosition: function () {
                var e = cleverapps.scenes.getRunningScene(),
                    t = this.options.rewards ? this.options.position.rewards : this.options.position,
                    t = this.calculatePositionRound(t.x, t.y, {
                        box: this.target.getGlobalBoundingBox()
                    });
                this.setPositionRound(e.convertToNodeSpace(t)), this.bg.setPositionRound(this.width / 2, this.height / 2), this.x - this.width / 2 < 0 && (this.bg.x += this.width / 2 - this.x + cleverapps.styles.UI.Tooltip.bgPadding), this.x + this.width / 2 > cleverapps.scenes.getRunningScene().width && (this.bg.x -= this.width / 2 - cleverapps.scenes.getRunningScene().width + this.x + cleverapps.styles.UI.Tooltip.bgPadding)
            },
            show: function () {
                this.stopAllActions(), this.setVisible(!1), this.runAction(new cc.Sequence(new cc.ScaleTo(0, .2), new cc.Show, new cc.ScaleTo(.1, 1))), this.runAction(new cc.Sequence(new cc.DelayTime(this.duration), new cc.CallFunc(function () {
                    this.hide()
                }.bind(this))))
            },
            drawArrow: function (e) {
                var t = e === cleverapps.styles.UI.Tooltip.ARROW.bottom ? new cc.Scale9Sprite(bundles.tooltip.frames.tooltip_shadow_arrow_png) : new cc.Scale9Sprite(bundles.tooltip.frames.tooltip_arrow_png);
                this.addChild(t), t.setRotation(e.rotation), t.setPositionRound(e)
            }
        }), cleverapps.styles.UI.Tooltip = {
            content: {
                padding: 40,
                offset: {
                    y: -4
                }
            },
            bgPadding: 10,
            rewards: {
                extraWidth: 0,
                extraHeight: 110,
                margin: 10,
                iconWrap: {
                    width: 60,
                    height: 60
                }
            },
            SIZE: {
                short: {
                    width: 360,
                    height: 100
                },
                medium: {
                    width: 480,
                    height: 100
                },
                long: {
                    width: 600,
                    height: 100
                }
            },
            LOCATION: {
                above: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "top",
                        dy: 100
                    },
                    rewards: {
                        x: {
                            align: "center",
                            dx: 0
                        },
                        y: {
                            align: "top",
                            dy: 220
                        }
                    }
                },
                below: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -112
                    },
                    rewards: {
                        x: {
                            align: "center",
                            dx: 0
                        },
                        y: {
                            align: "bottom",
                            dy: -222
                        }
                    }
                }
            },
            ARROW: {
                top: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "top",
                        dy: 18
                    },
                    rotation: 180
                },
                bottom: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -16
                    },
                    rotation: 0
                },
                left: {
                    x: {
                        align: "left",
                        dx: -22
                    },
                    y: {
                        align: "center",
                        dy: 0
                    },
                    rotation: 90
                },
                right: {
                    x: {
                        align: "right",
                        dx: 22
                    },
                    y: {
                        align: "center",
                        dy: 0
                    },
                    rotation: -90
                }
            }
        }, function () {
            this.active = void 0, cc.eventManager.addListener(cc.EventListener.create({
                event: cc.EventListener.TOUCH_ONE_BY_ONE,
                onTouchBegan: function () {
                    this.onClick()
                }.bind(this)
            }), -1), "mouse" in cc.sys.capabilities && cc.eventManager.addListener(cc.EventListener.create({
                event: cc.EventListener.MOUSE,
                onMouseScroll: function () {
                    this.onClick()
                }.bind(this)
            }), -1)
        }),
        Exclamation = (TooltipManager.prototype.create = function (t, s) {
            t.tooltipHandler && this.remove(t), t.baseScaleX = t.scaleX, t.baseScaleY = t.scaleY, t.tooltipHandler = cleverapps.UI.onClick(t, function (e) {
                cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), s.clickableArea ? (e = s.clickableArea.convertTouchToNodeSpace(e), cc.rectContainsPoint(cc.rect(0, 0, s.clickableArea.width, s.clickableArea.height), e) && cleverapps.tooltipManager.onClick(t, s)) : cleverapps.tooltipManager.onClick(t, s)
            })
        }, TooltipManager.prototype.remove = function (e) {
            e.tooltipHandler && (e.tooltipHandler.remove(), e.tooltipHandler = void 0)
        }, TooltipManager.prototype.onClick = cleverapps.accumulate(0, function (e, t) {
            var s;
            (e || this.active) && (t = t || {},
                s = this.active && this.active.target, s = e && s !== e, this._hide(), (s || t.forceShow) && this._show(e, t))
        }), TooltipManager.prototype._show = function (e, t) {
            var s = new cleverapps.UI.Tooltip(e, t);
            cleverapps.scenes.getRunningScene().movingNode.addChild(s), addCleaner(s, function () {
                this.active === s && delete this.active
            }.bind(this)), this.active = s
        }, TooltipManager.prototype._hide = function () {
            this.active && this.active.hide()
        }, function () {
            cleverapps.EventEmitter.call(this)
        }),
        ExclamationViewBase = (Exclamation.prototype = Object.create(cleverapps.EventEmitter.prototype), (Exclamation.prototype.constructor = Exclamation).prototype.show = function (e, t) {
            this.trigger("show", e, t || Exclamation.Types.Normal)
        }, Exclamation.prototype.remove = function () {
            this.trigger("hide")
        }, Exclamation.prototype.getCongratulations = function () {
            return -1 !== ["heroes", "runes"].indexOf(cleverapps.config.name) ? ["wow", "super", "yay", "yeah", "ohyeah", "oh"] : Messages.get("congratulations")
        }, Exclamation.Types = {
            Normal: 100,
            Warning: 101,
            Congrats: 102
        }, cc.Node.extend({
            ctor: function () {
                this._super();
                var e = this.getStyles();
                this.setAnchorPoint2(), this.setContentSize2(e), e.scale && this.setScale(e.scale[cleverapps.resolution.mode]), cleverapps.exclamation.on("show", cleverapps.throttle(1e3, this.showMessage.bind(this)), this), cleverapps.exclamation.on("hide", this.hideMessage.bind(this), this)
            },
            showMessage: function (e, t) {
                var s = "message.Shuffle" === e ? bundles.exclamations.urls.shuffle_effect : bundles.exclamations.urls.keep_going_effect,
                    i = "keep_going_letsgo",
                    n = cleverapps.styles.FONTS.MESSAGE_TEXT_NORMAL;
                switch (t) {
                    case Exclamation.Types.Warning:
                        i = "5_moves_left", s = bundles.exclamations.urls.five_moves_effect, n = cleverapps.styles.FONTS.MESSAGE_TEXT_WARNING;
                        break;
                    case Exclamation.Types.Congrats:
                        i = "you_win", s = bundles.main.urls.beat_friend_effect, n = cleverapps.styles.FONTS.MESSAGE_TEXT_CONGRATS
                }
                this.runActions(e, n, s, i)
            },
            hideMessage: function () {
                this.setVisible(!1)
            },
            runActions: function (e, t, s, i) {
                this.createAnimation(i), this.createMsg(e, t), this.playSound(s)
            },
            playSound: function (e) {
                var t;
                e && (t = this.getStyles().sound ? this.getStyles().sound.delay : 0, this.runAction(new cc.Sequence(new cc.DelayTime(t), new cc.CallFunc(function () {
                    cleverapps.audio.playSound(e)
                }))))
            },
            createMsg: function (e, t) {
                e = this.createText(e, t);
                e.opacity = 0, e.runAction(new cc.Sequence(new cc.DelayTime(.2), new cc.FadeIn(.2), new cc.Spawn(new cc.MoveBy(.1, 0, -2), new cc.ScaleTo(.1, 1, .9)), new cc.ScaleTo(.25, 1, 1), new cc.DelayTime(.3), new cc.FadeOut(.2), new cc.RemoveSelf))
            },
            createText: function (e, t) {
                var s = cleverapps.UI.LabelTTF.GetLocalizedText(e),
                    e = cleverapps.UI.generateTTFText(e, t);
                return -1 !== s.indexOf(" ") ? e.setDimensions(this.width, 0) : e.fitTo(this.width), e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setPositionRound(this.width / 2, this.height / 2), this.addChild(e), e
            },
            createAnimation: function (e) {
                this.animation || (this.animation = new cleverapps.Spine(bundles.exclamations.jsons.exclamations_json), this.animation.setPositionRound(this.width / 2, this.height / 2), this.addChild(this.animation)),
                    this.animation.setAnimation(0, e, !1)
            },
            getStyles: function () {
                return cleverapps.styles.Exclamations.base
            }
        })),
        ExclamationViewHeroes = (ExclamationViewBase.Create = function () {
            return new (-1 !== ["heroes", "runes"].indexOf(cleverapps.config.name) ? ExclamationViewHeroes : -1 !== ["board", "solitaire", "differences"].indexOf(cleverapps.config.type) ? ExclamationViewWords : -1 !== ["adventure"].indexOf(cleverapps.config.name) ? ExclamationViewActor : ExclamationViewBase)
        }, ExclamationViewBase.extend({
            getStyles: function () {
                return cleverapps.styles.Exclamations.heroes
            },
            showMessage: function (e, t) {
                var s = this.getStyles(),
                    i = "message.YouWin" === e ? bundles.main.urls.sound_win_effect : bundles.exclamations.urls.keep_going_effect,
                    n = cleverapps.styles.FONTS.CONGRATS_MESSAGE_FONT,
                    o = s[e],
                    o = (o ? n.color = o.color : t === Exclamation.Types.Warning ? n.color = s.warning.color : n.color = s.default.color, "lets_go"); - 1 !== cleverapps.exclamation.getCongratulations().indexOf(e) ? (i = bundles.game.urls[e + "_effect"], e = "message." + (o = e)) : "message.KeepGoing" === e ? i = bundles.exclamations.urls.go_on_effect : "message.Shuffle" === e && (o = "shuffle", i = bundles.exclamations.urls.shuffle_effect), this.runActions(e, n, i, o)
            },
            createMsg: function (e, t) {
                e = this.createText(e, t);
                e.setRotation(10);
                e.setScale(.1), e.setVisible(!1), e.runAction(new cc.Sequence(new cc.DelayTime(.2), new cc.Show, new cc.ScaleTo(.3, 1).easing(cc.easeInOut(3)), new cc.DelayTime(.55), new cc.ScaleTo(.3, .1), new cc.RemoveSelf))
            }
        })),
        ExclamationViewWords = ExclamationViewBase.extend({
            getStyles: function () {
                return cleverapps.styles.Exclamations.base
            },
            showMessage: function (e) {
                this.runActions(e, void 0, void 0, "animation")
            },
            createMsg: function (e) {
                e = Messages.getLocalized(e);
                var e = this.splitTextToLines(e).map(this.createLine.bind(this)),
                    e = new cleverapps.Layout(e, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.length && e[0].height / 10 || 0
                    }),
                    t = (e.setCascadeOpacityEnabled(!0), e.setOpacity(0), e.setScale(0), e.setPositionRound(this.width / 2, this.height / 2), this.addChild(e), 1),
                    s = cleverapps.scenes.getRunningScene();
                e.width > s.width && (t = s.width / (1.2 * e.width)), this.setVisible(!0), this.stopAllActions(), this.runAction(new cc.Sequence(new cc.DelayTime(1.4), new cc.Hide)), e.runAction(new cc.Spawn(new cc.FadeIn(.25), new cc.Sequence(new cc.ScaleTo(.2, 1.4 * t, 1.4 * t), new cc.ScaleTo(.2, .8 * t, .8 * t), new cc.ScaleTo(1, t, t)), new cc.Sequence(new cc.DelayTime(1.2), new cc.FadeOut(.2), new cc.RemoveSelf)))
            },
            createLine: function (e) {
                for (var t = new cc.Node, s = (t.setAnchorPoint(.5, .5), 0), i = 0, n = this.splitLineToBlocks(e), o = 0; o < n.length; o++) {
                    var a = cleverapps.UI.generateOnlyText(n[o], cleverapps.styles.FONTS.CONGRATE_TEXT),
                        r = (t.addChild(a), Math.abs(o - n.length / 2)),
                        c = 1 - .2 / n.length * r,
                        r = .2 + .6 / n.length * r,
                        l = " " !== n[o] ? a.width : cleverapps.styles.Exclamations.spaceWidth;
                    a.setPosition(s + l * c / 2, a.height / 2), s += l * c, i = Math.max(i, a.height), a.setScale(0), a.runAction(new cc.Sequence(new cc.ScaleTo(r, 1.36), new cc.ScaleTo(.13, c)))
                }
                return t.setContentSize(s, i), t.setCascadeOpacityEnabled(!0), t
            },
            splitTextToLines: function (e) {
                if (!e) return [];
                var t = e.indexOf(" ");
                if (e.length <= 16 || -1 === t) return [e];
                var s = e.substr(0, 16).lastIndexOf(" ");
                return [e.substr(0, s = -1 === s ? t : s)].concat(e.substr(s + 1).trim())
            },
            splitLineToBlocks: function (e) {
                e = e.split("");
                if (e.length <= 6) return e;
                var t = e.slice(3, e.length - 3).join("");
                return t.startsWith(" ") ? t = [" ", t] : t.endsWith(" ") && (t = [t, " "]), e.slice(0, 3).concat(t).concat(e.slice(e.length - 3, e.length))
            }
        }),
        ExclamationViewActor = ExclamationViewWords.extend({
            getStyles: function () {
                return cleverapps.styles.Exclamations.actor
            },
            showMessage: function (e) {
                var t, s = bundles.exclamations.urls.exclamation_alert_effect; - 1 !== cleverapps.exclamation.getCongratulations().indexOf(e) ? (s = (t = cleverapps.Random.mathChoose(this.getStyles().actorActions)).sound, cleverapps.scenes.getRunningScene().actor.animate(t.animation, {
                    noSFX: !0
                })) : "message.YouWin" === e ? s = bundles.exclamations.urls.exclamation_win_effect : "message.Shuffle" === e && (s = bundles.exclamations.urls.shuffle_effect), this.runActions(e,
                    void 0, s, "animation")
            }
        }),
        SceneDecors = (cleverapps.overrideColors(cleverapps.styles.COLORS, {
            CONGRATS_RED: new cc.Color(255, 35, 60, 255),
            CONGRATS_LIGHT_GREEN: new cc.Color(182, 248, 68, 255),
            CONGRATS_BLUE: new cc.Color(0, 177, 249, 255),
            CONGRATS_ORANGE: new cc.Color(233, 117, 38, 255),
            CONGRATS_PURPLE: new cc.Color(194, 11, 227, 255),
            CONGRATS_GREEN: new cc.Color(0, 209, 121, 255),
            CONGRATS_DARK_RED: new cc.Color(241, 15, 51, 255)
        }), cleverapps.styles.Exclamations = {
            base: {
                width: 650,
                height: 200
            },
            spaceWidth: 40
        }, cleverapps.styles.Exclamations.heroes = cleverapps.overrideStyles(cleverapps.styles.Exclamations.base, {
            width: 760,
            scale: [.8, 1, 1],
            sound: {
                delay: .6
            },
            default: {
                color: cleverapps.styles.COLORS.CONGRATS_BLUE
            },
            warning: {
                color: cleverapps.styles.COLORS.CONGRATS_DARK_RED
            },
            yeah: {
                color: cleverapps.styles.COLORS.CONGRATS_RED
            },
            super: {
                color: cleverapps.styles.COLORS.CONGRATS_LIGHT_GREEN
            },
            yay: {
                color: cleverapps.styles.COLORS.CONGRATS_BLUE
            },
            lets_go: {
                color: cleverapps.styles.COLORS.CONGRATS_ORANGE
            },
            ohyeah: {
                color: cleverapps.styles.COLORS.CONGRATS_PURPLE
            },
            oh: {
                color: cleverapps.styles.COLORS.CONGRATS_GREEN
            },
            wow: {
                color: cleverapps.styles.COLORS.CONGRATS_DARK_RED
            }
        }, !0), cleverapps.styles.Exclamations.actor = cleverapps.overrideStyles(cleverapps.styles.Exclamations.base, {
            actorActions: [{
                animation: Actor.ANIMATIONS.ATTACK1,
                sound: bundles.game.urls.sc_welldone
            }, {
                animation: Actor.ANIMATIONS.ATTACK2,
                sound: bundles.game.urls.sc_welldone2
            }, {
                animation: Actor.ANIMATIONS.ATTACK3,
                sound: bundles.game.urls.sc_welldone3
            }]
        }, !0), {
            add: function (e, t) {
                if ((t = cleverapps.toArray(t)) && t.length) return this.createDecors(e, t)
            },
            createDecors: function (s, e) {
                return e.map(function (e) {
                    var t;
                    return e.json ? (t = new cleverapps.Spine(e.json)).setAnimation(0, e.animation, !0) : t = new cc.Sprite(e.image), s.addChild(t, e.zOrder || 0), e.scale && (e.scale.x ? t.setScale(e.scale.x, e.scale.y) : t.setScale(e.scale)), t.setPositionRound(e), t
                })
            }
        }),
        NoConnectionWindow = (cleverapps.styles.SceneDecors = {}, cleverapps.SkinManager = function () {
            this.active = [],
                this.defaultSlots = cleverapps.SkinManager.SKINS.default.slots, this.prepareBundlesSkins()
        }, cleverapps.SkinManager.prototype.prepareBundlesSkins = function () {
            for (var e in this.overrides = {}, bundles) {
                e = bundles[e];
                this.prepareOverriddenUrls(e.frames), this.prepareOverriddenUrls(e.jsons), this.prepareOverriddenUrls(e.urls)
            }
        }, cleverapps.SkinManager.prototype.prepareOverriddenUrls = function (e) {
            for (var t in e) {
                var s = (i = t.split("$"))[1],
                    i = i[0];
                s && (this.overrides[s] || (this.overrides[s] = {}), this.overrides[s][e[i]] = e[t])
            }
        }, cleverapps.SkinManager.prototype.getLink = function (e) {
            if (!this.active.length) return e;
            for (var t = 0; t < this.active.length; t++) {
                var s = this.active[t].slots,
                    s = s && s.skinName && s.skinName(),
                    s = s && this.overrides[s] && this.overrides[s][e];
                if (s) return s
            }
            return e
        }, cleverapps.SkinManager.prototype.getSlot = function (e, t) {
            for (var s = 0; s < this.active.length; s++)
                if (this.active[s] && this.active[s].slots[e]) {
                    var i = this.active[s].slots[e](t);
                    if (void 0 !== i) return i
                }
            return this.defaultSlots[e] && this.defaultSlots[e](t)
        }, cleverapps.SkinManager.prototype.update = function () {
            var e;
            if (this.active = [], "merge" === cleverapps.config.type) return (e = cleverapps.travelBook.getCurrentExpedition()) && cleverapps.SkinManager.SKINS[e.id + "_expedition"] && this.active.push(cleverapps.SkinManager.SKINS[e.id + "_expedition"]), cleverapps.eventManager && cleverapps.eventManager.isActive("xmas_skin") && this.active.push(cleverapps.SkinManager.SKINS.xmas), cleverapps.eventManager && cleverapps.eventManager.isActive("dragonia") && this.active.push(cleverapps.SkinManager.SKINS.dragonia), cleverapps.eventManager && cleverapps.eventManager.isActive("dragonia2") && this.active.push(cleverapps.SkinManager.SKINS.dragonia2), cleverapps.eventManager && cleverapps.eventManager.isActive("undersea") && this.active.push(cleverapps.SkinManager.SKINS.undersea), void (cleverapps.eventManager && cleverapps.eventManager.isActive("undersea2") && this.active.push(cleverapps.SkinManager.SKINS.undersea2));
            cleverapps.eventManager && cleverapps.eventManager.listCurrentFeatures().forEach(function (e) {
                cleverapps.SkinManager.SKINS[e] && this.active.push(cleverapps.SkinManager.SKINS[e])
            }, this)
        }, cleverapps.SkinManager.prototype.getBundles = function () {
            var t = [];
            return this.active.forEach(function (e) {
                e && e.bundle && t.push(e.bundle)
            }), 0 < t.length ? t : void 0
        }, cleverapps.SkinManager.SKINS = {
            default: {
                localization: {},
                slots: {
                    windowDecors: function (e) {
                        return e.decors
                    },
                    windowBg: function (e) {
                        return e.image
                    },
                    spine: function (e) {
                        return e.json
                    },
                    menuBarItem: function () { },
                    sceneControlButton: function () { },
                    gameAudio: function () { },
                    missionIcon: function (e) {
                        return Missions[e.type].collectIcon
                    },
                    missionWindowHero: function () {
                        return cleverapps.styles.MissionWindow.heroTitleAnimation
                    },
                    tulpanScale: function () {
                        return cleverapps.styles.TulpanCellView.scale
                    },
                    removeMissions: function () { },
                    toolbarDecors: function () {
                        return []
                    },
                    localization: function (e) {
                        return cleverapps.SkinManager.SKINS.default.localization[e]
                    },
                    windowTitle: function (e) {
                        return e.image
                    },
                    missionMarkIcon: function (e) {
                        return Missions[e.type].collectIcon
                    },
                    missionWindowTitleFont: function () {
                        return cleverapps.styles.FONTS.WINDOW_TITLE_TEXT
                    },
                    cardMarkSpine: function (e) {
                        return e.json
                    },
                    water: function () {
                        var e = Game.currentGame && Game.currentGame.map && Game.currentGame.map.tilesTexture;
                        return bundles[e] && bundles[e].frames.water
                    },
                    unitIcon: function (e) {
                        return bundles.unit_icons.frames["small_icon_castle_" + e]
                    },
                    fog: function () {
                        return {}
                    },
                    outOfBoundaryScale: function () {
                        return .2
                    }
                }
            }
        }, cleverapps.SkinManager.SKINS.xmas = {
            bundle: "xmas",
            localization: {},
            slots: {
                localization: function () { },
                windowDecors: function (e) {
                    var t = cleverapps.clone(e.decors || {}, !0);
                    return t.xmas_window_top = !0, t.xmas_window_title_right = !0, t.xmas_window_title_left = !0, t.xmas_window_right_top = !0, t.xmas_window_right_bottom = !0, t.xmas_window_left_bottom = !0, t.xmas_window_left_top = !0, t.xmas_window_alternative_title_right = !0, t.xmas_window_alternative_title_left = !0, "tropical" === cleverapps.config.ui && (t.decor_title_right = !1,
                        t.decor_title_left = !1, t.window_liana_top_left = !1, t.window_liana_top_right = !1, t.window_liana_left = !1, t.window_liana_right = !1, t.window_liana_bottom_left = !1, t.window_liana_bottom_right = !1), "wooden" === cleverapps.config.ui && "undefined" != typeof OrdersWindow && e.window instanceof OrdersWindow && (t.xmas_window_right_top = !1, t.xmas_window_right_bottom = !1, t.xmas_window_left_bottom = !1, t.xmas_window_left_top = !1), "mergecraft" === cleverapps.config.name && (void 0 !== BuildPassWindow && e.window instanceof BuildPassWindow || void 0 !== SalePassWindow && e.window instanceof SalePassWindow) && (t.xmas_window_right_top = !1, t.xmas_window_left_top = !1, t.xmas_window_right_top_bgonly = !0, t.xmas_window_left_top_bgonly = !0), "riddles" === cleverapps.config.ui && "undefined" != typeof UnitsLibraryWindow && e.window instanceof UnitsLibraryWindow && (t.xmas_window_left_bottom = !1), t
                },
                menuBarItem: function () {
                    return cleverapps.styles.SceneDecors.xmas_menubar
                },
                menuBarLevelItem: function () {
                    return cleverapps.styles.SceneDecors.xmas_menubar_level
                },
                sidebarBg: function () {
                    return bundles.sidebar.frames.xmas_sidebar_bg
                },
                sidebarIcon: function () {
                    return cleverapps.styles.SceneDecors.xmas_sidebar
                },
                toolbarDecors: function () {
                    return cleverapps.styles.SceneDecors.xmas_toolbar
                },
                sceneControlButton: function () {
                    return cleverapps.styles.SceneDecors.xmas_control_buttons
                },
                spine: function (e) {
                    var t = {};
                    return -1 !== ["heroes", "riddles"].indexOf(cleverapps.config.name) && (t[bundles.heroes.jsons.A_hero_spine_json] = bundles.xmas.jsons.A_hero_spine_json, t[bundles.heroes.jsons.B_hero_spine_json] = bundles.xmas.jsons.B_hero_spine_json, t[bundles.heroes.jsons.C_hero_spine_json] = bundles.xmas.jsons.C_hero_spine_json, t[bundles.heroes.jsons.D_hero_spine_json] = bundles.xmas.jsons.D_hero_spine_json, t[bundles.heroes.jsons.E_hero_spine_json] = bundles.xmas.jsons.E_hero_spine_json, t[bundles.heroes.jsons.W_hero_spine_json] = bundles.xmas.jsons.W_hero_spine_json), t[e.json] || e.json
                }
            }
        }, Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.NoConnectionWindow;
                this._super({
                    title: "NoConnectionWindow.title",
                    name: "noconnectionwindow",
                    content: this.getContent(),
                    button: {
                        width: e.button.width,
                        height: e.button.height,
                        text: "OK",
                        onPressed: function () {
                            this.close()
                        }.bind(this)
                    }
                })
            },
            getContent: function () {
                var e = cleverapps.styles.NoConnectionWindow,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2(e.animation), new cleverapps.Spine(bundles.noconnection_window.jsons.no_connection_json)),
                    s = (t.addChild(s), s.setPositionRound(t.width / 2, t.height / 2), s.setAnimation(0, "animation", !0), cleverapps.UI.generateTTFText("RestartWindow.AnErrorOccured", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT));
                return s.setDimensions(e.text.width, 0), s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin
                })
            },
            listBundles: function () {
                return ["noconnection_window"]
            }
        })),
        Rocket = (cleverapps.styles.NoConnectionWindow = {
            width: 500,
            height: 800,
            margin: 30,
            animation: {
                width: 400,
                height: 400
            },
            text: {
                width: 480
            },
            button: {
                width: 200,
                height: 100
            }
        },
            cleverapps.UI.ZoomHandler = function (e, t) {
                t = t || {}, this.target = e, this.minZoom = t.minZoom || .8, this.maxZoom = t.maxZoom || 2, new PointerHandler(this.target, {
                    onMouseZoom: function (e) {
                        var t = 1;
                        this.target.zoom <= .3 ? t = .3 : this.target.zoom <= .5 && (t = .5), this.target.stopScrollAction(), this.setZoom(this.target.zoom + e * t)
                    }.bind(this),
                    onPinchZoom: cc.sys.capabilities.touches && function (e) {
                        this.target.stopScrollAction(), this.setZoom(this.target.zoom + e)
                    }.bind(this)
                })
            }, cleverapps.UI.ZoomHandler.prototype.normalizeZoom = function (e) {
                return e = Math.round(100 * e) / 100, Math.min(Math.max(e, this.minZoom), this.maxZoom)
            }, cleverapps.UI.ZoomHandler.prototype.setZoom = function (e, t) {
                this.target.zoom = t ? e : this.normalizeZoom(e), this.target.centerNode.setScale(this.target.zoom), this.target.updateVisibility(), this.target.calcBorders(), this.target.scrollHandler.afterContainerScale(), this.target.onUpdateZoomListener()
            }, cleverapps.UI.ZoomHandler.ZOOM_DIRECTION_IN = 0, cleverapps.UI.ZoomHandler.ZOOM_DIRECTION_OUT = 1,
            cc.ZoomAction = cc.ActionInterval.extend({
                ctor: function (e, t) {
                    cc.ActionInterval.prototype.ctor.call(this), this._params = t, cc.ActionInterval.prototype.initWithDuration.call(this, e)
                },
                startWithTarget: function (e) {
                    cc.ZoomAction._UID++, this._UID = cc.ZoomAction._UID, cc.ActionInterval.prototype.startWithTarget.call(this, e);
                    e = this.getZoomHandler();
                    this._startZoom = e.target.zoom, this._targetZoom = this._params.zoom, this._params.zoomKoef && (this._targetZoom = e.normalizeZoom(this._startZoom * this._params.zoomKoef)), this._params.maxZoom && this._targetZoom > this._params.maxZoom && (this._targetZoom = this._params.maxZoom), this._params.direction === cleverapps.UI.ZoomHandler.ZOOM_DIRECTION_IN && this._targetZoom < this._startZoom && (this._targetZoom = this._startZoom), this._params.direction === cleverapps.UI.ZoomHandler.ZOOM_DIRECTION_OUT && this._targetZoom > this._startZoom && (this._targetZoom = this._startZoom), this._params.zoomFocus && (this._zoomFocusStartPosition = this.target.getContainerPosition(),
                        this._zoomFocusTargetPosition = this.target.targetToPoint(this._params.zoomFocus, this._params.zoomFocusPadding))
                },
                clone: function () {
                    return new cc.ZoomAction(this._duration, this._params)
                },
                getZoomHandler: function () {
                    return this.target.zoomHandler
                },
                stop: function () {
                    this.getZoomHandler()._zoomRunning = !1, this.target.onUpdateZoomListener()
                },
                update: function (e) {
                    cc.ZoomAction._UID === this._UID && (e = this._computeEaseTime(e), this._zoomFocusTargetPosition && this.target.scrollToPoint(this.target.normalizePoint(cc.pAdd(this._zoomFocusStartPosition, cc.pMult(cc.pSub(this._zoomFocusTargetPosition, this._zoomFocusStartPosition), e)))), this.getZoomHandler().setZoom(this._startZoom + (this._targetZoom - this._startZoom) * e, !0), this.getZoomHandler()._zoomRunning = !0)
                }
            }), cc.ZoomAction._UID = 0, cc.Node.extend({
                ctor: function (e, t, s) {
                    this._super(), this.startCell = e, this.targetCell = t, this.addChild(s.rocket), this.setVisible(!1);
                    var t = 0,
                        i = (s.startDX && (t += s.startDX), cleverapps.styles.Rocket.startDX && (
                            t += cleverapps.styles.Rocket.startDX), 0);
                    s.startDY && (i += s.startDY), cleverapps.styles.Rocket.startDY && (i += cleverapps.styles.Rocket.startDY), this.setPositionRound(BaseCellView.alignInTheGrid(e.x, e.y)), this.setPosition(this.getPosition().x + t, this.getPosition().y + i), this.aim(s)
                },
                aim: function (e) {
                    this.targetPos = BaseCellView.alignInTheGrid(this.targetCell.x, this.targetCell.y), this.prevPos = this.getPosition(), this.scheduleUpdate(), this.animateFly(e)
                },
                animateFly: function (e) {
                    var t, s = cleverapps.styles.Rocket,
                        i = this.getPosition(),
                        n = BaseCellView.alignInTheGrid(this.targetCell.x, this.targetCell.y),
                        i = cc.p(i.x, Math.max(i.y, n.y) + s.flyUp),
                        s = cc.p(n.x, i.y),
                        o = this.targetCell.y - this.startCell.y;
                    this.targetCell.y > this.startCell.y && Math.abs(this.targetCell.x - this.startCell.x) <= 1 ? (t = Math.abs(o) * cleverapps.styles.BaseCellView.CELL_SIZE_PX, this.startCell.x < Field.SIZE / 2 ? s.x += t : s.x -= t) : this.startCell.x === this.targetCell.x && this.startCell.y > this.targetCell.y && (t = Math.abs(o) * cleverapps.styles.BaseCellView.CELL_SIZE_PX, i.y -= t / 2, this.startCell.x < Field.SIZE / 2 ? i.x += t / 2 : i.x -= t / 2, s = cc.p(i.x, n.y + cleverapps.styles.BaseCellView.CELL_SIZE_PX)), this.runAction(new cc.Sequence(new cc.DelayTime(e.delay), new cc.CallFunc(function () {
                        this.setVisible(!0), e.onLaunch()
                    }.bind(this)), new cc.BezierTo(e.duration, [i, s, n]).easing(cc.easeIn(1)), new cc.CallFunc(function () {
                        this.unscheduleUpdate(), e.onArrive(function () {
                            this.runAction(new cc.RemoveSelf)
                        }.bind(this))
                    }.bind(this))))
                },
                update: function (e) {
                    this._super(e), this.setRotation(180 * Math.atan2(this.x - this.prevPos.x, this.y - this.prevPos.y) / Math.PI), this.prevPos = this.getPosition()
                }
            })),
        UseGoldButton = (cleverapps.styles.Rocket = {
            flyUp: 150
        }, cleverapps.UI.Button.extend({
            ctor: function (e) {
                var t;
                this.price = e.price, this.source = e.source, this.onFilterHandler = e.filter || function () {
                    return !0
                }, this.onClickHandler = function () {
                    e.onClicked()
                }, this.eventName = e.eventName, this.confirmWindowOptions = e.confirmWindowOptions, this.price && e.canCoins && ((t = cleverapps.missionManager.findByType(
                    Mission.TYPE_BOOSTTIME)) && MissionManager.hasProperParent(t) && (this.useCoins = !0, this.price *= UseGoldButton.RUBY_COINS_RATE)), this._super({
                        width: e.width,
                        height: e.height,
                        text: this.getText(e.speedUp),
                        onClicked: this.onClick.bind(this),
                        type: e.type,
                        disabled: e.disabled
                    }), this.adviceTarget = e.adviceTarget
            },
            getText: function (e) {
                if (!this.price) return "UseGoldButton.free";
                var t = this.useCoins ? "@@" + this.price : "$$" + this.price;
                return e && (t += ">>"), t
            },
            takeCurrency: function () {
                var e = this.source || this;
                return this.useCoins ? cleverapps.user.spendSoft(this.eventName, this.price, {
                    source: e
                }) : cleverapps.user.spendHard(this.eventName, this.price)
            },
            onClick: function () {
                this.confirmWindowOptions ? this.showConfirmWindow() : this.onFilterHandler() && this.takeCurrency() && this.onClickHandler()
            },
            showConfirmWindow: function () {
                var t = function () {
                    new ConfirmSpeedUpWindow({
                        price: this.confirmWindowOptions.price,
                        timeLeft: this.confirmWindowOptions.timeLeft,
                        totalDuration: this.confirmWindowOptions.totalDuration,
                        eventName: this.eventName,
                        callback: this.onClickHandler
                    })
                }.bind(this);
                cleverapps.meta.isFocused() ? t() : cleverapps.meta.display({
                    focus: "ConfirmSpeedUpWindow",
                    action: function (e) {
                        t(), cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            }
        })),
        AdBubble = (UseGoldButton.RUBY_COINS_RATE = 5, function (e) {
            cleverapps.EventEmitter.call(this), this.onSuccess = e.onSuccess, this.canClick = e.canClick, this.limit = e.limit, this.skin = e.skin, cleverapps.adsLimits.on("update", this.onAdsUpdate.bind(this), this), this.onAdsUpdate()
        }),
        AdBubbleView = (AdBubble.prototype = Object.create(cleverapps.EventEmitter.prototype), (AdBubble.prototype.constructor = AdBubble).prototype.onClick = function () {
            this.watchAd()
        }, AdBubble.prototype.watchAd = function () {
            !this._isActive || this.canClick && !this.canClick() || cleverapps.rewardedAdsManager.loadAndPlay({
                type: RewardedAdsManager.REWARDED,
                adLimit: this.limit,
                callback: function () {
                    cleverapps.adsLimits.watch(this.limit), this.trigger("pop"), this.onSuccess()
                }.bind(this)
            })
        }, AdBubble.prototype.setActive = function (e) {
            this._isActive !== e && (
                this._isActive = e, this.trigger("update", this._isActive))
        }, AdBubble.prototype.isActive = function () {
            return this._isActive
        }, AdBubble.prototype.onAdsUpdate = function () {
            this.setActive(this.isAdAvailable()), this.trigger("adsUpdate")
        }, AdBubble.prototype.isAdAvailable = function () {
            return cleverapps.adsLimits.state(this.limit) === AdsLimits.STATE_READY
        }, AdBubble.prototype.getSkin = function () {
            return this.skin || "regular"
        }, AdBubble.prototype.onExit = function () {
            runCleaners(this), this.purge()
        }, cleverapps.Spine.extend({
            ctor: function (e) {
                this.adBubble = e, this._super(bundles.ads_bubble.jsons.ads_bubble_json);
                e = cleverapps.styles.AdBubbleView;
                this.setContentSize2(e), this.spine.setPositionRound(this.width / 2, this.height / 2), this.setSkin(this.adBubble.getSkin()), cleverapps.UI.onClick(this, this.adBubble.onClick.bind(this.adBubble)), cleverapps.UI.applyHover(this), this.adBubble.on("update", this.createListener(this.updateVisibility.bind(this)), this), this.adBubble.on("pop", this.createListener(this.pop.bind(this)), this),
                    this.updateVisibility(this.adBubble.isActive())
            },
            updateVisibility: function (e) {
                e ? this.show() : this.hide()
            },
            hide: function () {
                this.setVisible(!1)
            },
            show: function () {
                this.setCompleteListener(), this.setAnimationAndIdleAfter("showup", "idle")
            },
            pop: function () {
                this.setAnimation(0, "hide", !1), this.setCompleteListenerOnce(function () {
                    this.setVisible(!1)
                }.bind(this))
            },
            onExit: function () {
                this.adBubble.onExit()
            }
        })),
        RewardTypes = (cleverapps.styles.AdBubbleView = {
            width: 150,
            height: 150
        }, {}),
        Timer = (RewardTypes.hard = RewardTypes.rubies = {
            icon: bundles.reward_icons.frames.reward_gold_png,
            smallIcon: bundles.reward_icons.frames.gold_small_png,
            controls: "MenuBarGoldItem",
            flyingAnimation: Reward.JUMP_COLLECT_ANIMATION,
            handler: function (e, t) {
                return cleverapps.isNumber(e) || (cleverapps.throwAsync("RewardTypes.hard - " + e), e = 0), cleverapps.user.earnHard(t.event, e, !0),
                    function () {
                        cleverapps.user.onChangeGold()
                    }
            }
        }, RewardTypes.soft = {
            icon: bundles.reward_icons.frames.reward_coin_png,
            smallIcon: bundles.reward_icons.frames.coin_small_png,
            controls: "MenuBarCoinsItem",
            bundle: "episode_0",
            flyingAnimation: Reward.JUMP_COLLECT_ANIMATION,
            handler: function (e) {
                return cleverapps.isNumber(e) || (cleverapps.throwAsync("RewardTypes.soft - " + e), e = 0), cleverapps.user.setSoft(cleverapps.user.soft + e, !0),
                    function () {
                        cleverapps.user.trigger("changeSoft")
                    }
            }
        }, RewardTypes.exp = {
            icon: bundles.reward_icons.frames.reward_exp_png,
            smallIcon: bundles.reward_icons.frames.reward_exp_small_png,
            controls: "MenuBarGameLevelItem",
            flyingAnimation: "merge" === cleverapps.config.type && Reward.JUMP_COLLECT_ANIMATION,
            handler: function (e) {
                var t = cleverapps.exp.isAvailable();
                return cleverapps.isNumber(e) || (cleverapps.throwAsync("RewardTypes.exp - " + e), e = 0), t && cleverapps.exp.setExp(cleverapps.exp.getExp() + e, !0),
                    function () {
                        t && cleverapps.exp.onChange()
                    }
            }
        }, RewardTypes.boosters = {
            icon: {},
            smallIcon: {},
            handler: function (e) {
                var t = 0 < e.amount;
                return t && cleverapps.boosters.add(e.id, e.amount, !0),
                    function () {
                        t && cleverapps.boosters.onChange()
                    }
            }
        },
            RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_CELL] = bundles.reward_icons.frames.cellbooster, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_LINE] = bundles.reward_icons.frames.linebooster, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_COLOR] = bundles.reward_icons.frames.colorbooster, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_HINT] = bundles.reward_icons.frames.hint_icon_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_WILDCARD] = bundles.reward_icons.frames.joker_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_BRUSH] = bundles.reward_icons.frames.pot, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_DISCOVER] = bundles.reward_icons.frames.hat, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_COMBO] = bundles.reward_icons.frames.heroes_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_MOVES] = bundles.reward_icons.frames.moves_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_MULTICOLOR] = bundles.reward_icons.frames.multicolor_png,
            RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_MAGNET] = bundles.reward_icons.frames.magnet_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_DICE] = bundles.reward_icons.frames.dice_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_JOKERS] = bundles.reward_icons.frames.joker_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_HIGHLIGHT] = bundles.reward_icons.frames.highlight, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_EYE] = bundles.reward_icons.frames.eye, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_MAGNIFIER] = bundles.reward_icons.frames.hint, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_UNDO] = bundles.reward_icons.frames.booster_undo_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_TILE_SHUFFLE] = bundles.reward_icons.frames.booster_tile_shuffle_png, RewardTypes.boosters.icon[cleverapps.Boosters.TYPE_VACUUM] = bundles.reward_icons.frames.booster_vacuum_png,
            RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_CELL] = bundles.reward_icons.frames.cellbooster_small, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_LINE] = bundles.reward_icons.frames.linebooster_small, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_COLOR] = bundles.reward_icons.frames.colorbooster_small, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_HINT] = bundles.reward_icons.frames.hint_icon_png, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_WILDCARD] = bundles.reward_icons.frames.joker_small_png, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_BRUSH] = bundles.reward_icons.frames.pot_small, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_DISCOVER] = bundles.reward_icons.frames.hat_small, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_COMBO] = bundles.reward_icons.frames.heroes_small_png, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_MOVES] = bundles.reward_icons.frames.moves_small_png,
            RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_MULTICOLOR] = bundles.reward_icons.frames.multicolor_small_png, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_MAGNET] = bundles.reward_icons.frames.magnet_small_png, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_DICE] = bundles.reward_icons.frames.dice_small_png, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_JOKERS] = bundles.reward_icons.frames.joker_small_png, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_HIGHLIGHT] = bundles.reward_icons.frames.highlight_small, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_EYE] = bundles.reward_icons.frames.eye_small, RewardTypes.boosters.smallIcon[cleverapps.Boosters.TYPE_MAGNIFIER] = bundles.reward_icons.frames.hint_small, RewardTypes.keys = {
                handler: function () {
                    return function () { }
                }
            }, RewardTypes.unlimitedLives = {
                icon: bundles.reward_icons.frames.life_unlim,
                smallIcon: bundles.reward_icons.frames.life_unlim_small,
                controls: "MenuBarLivesItem",
                handler: function (e) {
                    return cleverapps.unlimitedLives.buy(e.time),
                        function () {
                            cleverapps.lives.onBuyUnlimitedLivesListener()
                        }
                }
            }, RewardTypes.stars = {
                icon: bundles.reward_icons.frames.stars_png,
                smallIcon: bundles.reward_icons.frames.stars_small_png,
                handler: function (e) {
                    return cleverapps.starChest.addStars(e, !0),
                        function () {
                            cleverapps.sideBar.resetByClassName(StarChestIcon), cleverapps.starChest.onChangeStars()
                        }
                }
            }, RewardTypes.simpleStar = {
                icon: bundles.reward_icons.frames.simple_star_png,
                handler: function (e) {
                    return cleverapps.simple.earnStars(e, !0),
                        function () {
                            cleverapps.simple.pendingsStars += e, cleverapps.simple.updateProgress()
                        }
                }
            }, RewardTypes.homeStar = {
                handler: function (e) {
                    return cleverapps.home.earnStars(e, !0),
                        function () {
                            cleverapps.home.onChangeStars()
                        }
                }
            }, RewardTypes.lives = RewardTypes.energy = {
                icon: bundles.reward_icons.frames.reward_energy_png || bundles.reward_icons.frames.life_png,
                smallIcon: bundles.reward_icons.frames.energy_small_png || bundles.reward_icons.frames.life_small_png,
                controls: "MenuBarLivesItem",
                flyingAnimation: Reward.JUMP_COLLECT_ANIMATION,
                handler: function (e, t) {
                    return cleverapps.lives.give(e, t.event, !0),
                        function () {
                            cleverapps.lives.processRegenerateState(!0), cleverapps.lives.runListeners()
                        }
                }
            }, RewardTypes.wands = {
                icon: bundles.reward_icons.frames.reward_wand_png,
                smallIcon: bundles.reward_icons.frames.reward_wand_small_png,
                controls: "MenuBarWandsItem",
                bundle: "episode_0",
                flyingAnimation: Reward.JUMP_COLLECT_ANIMATION,
                handler: function (e) {
                    return Game.currentGame.wands += e, Game.currentGame.storeSave(),
                        function () {
                            Game.currentGame.fogs.onChangeWandsAmount(), Game.currentGame.onChangeWandsListener()
                        }
                }
            }, RewardTypes.worker = {
                icon: bundles.reward_icons.frames.reward_worker_png,
                smallIcon: bundles.reward_icons.frames.worker_small_png,
                controls: "MenuBarWorkersItem",
                handler: function (e) {
                    return e.subscription ? Game.currentGame.workers.addSubscriptionWorker(!0) : Game.currentGame.workers.addBonusWorkerPeriod(e.time, !0),
                        function () {
                            Game.currentGame.workers.onChangeTotalAmount(e.amount)
                        }
                }
            },
            RewardTypes.herolevels = {
                bundle: "heroes_game",
                handler: function (e) {
                    return match3.heroes.setLevel(e.color, Math.max(0, Math.min(Heroes.HEROES_MAX_LEVEL, e.level)), !0),
                        function () {
                            match3.heroes.onHeroChangeLevel(e.color)
                        }
                }
            }, RewardTypes.growthFund = {
                icon: bundles.reward_icons.frames.growth_fund_png,
                flyingAnimation: Reward.NO_ANIMATION,
                handler: function () {
                    var e = cleverapps.growthFund && !cleverapps.growthFund.isBought();
                    return e && cleverapps.growthFund.afterBuy(!0),
                        function () {
                            e && cleverapps.growthFund.onBought()
                        }
                }
            }, RewardTypes.units = {
                handler: function (e) {
                    if ("landmark" === Families[e.code].type) return cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LANDMARKS.OPEN + e.stage), cleverapps.unitsLibrary.openUnit(e),
                        function () { };
                    for (var s = Game.currentGame.map.getScreenCenterCell(), t = [], i = e.amount || 1; 0 < i; --i) t.push({
                        code: e.code,
                        stage: e.stage,
                        pointsValue: e.pointsValue
                    });
                    if (this.options.toMainWorld) return (new Pocket).addUnits(t),
                        function () {
                            cleverapps.toolbar.resetByType(ToolbarItem.TRAVEL_BOOK)
                        };
                    var n = [];
                    return t.forEach(function (e) {
                        var t = Game.currentGame.map.findEmptySlot(s.x, s.y, e);
                        t ? ((e = new Unit(e)).setPosition(t.x, t.y), Game.currentGame.map.add(Map2d.LAYER_UNITS, t.x, t.y, e), n.push(e)) : Game.currentGame.pocket.addUnits(e)
                    }), this.spawnedUnits || (this.spawnedUnits = []), n.length && (this.spawnedUnits = this.spawnedUnits.concat(n), Game.currentGame.storeSave()),
                        function () { }
                }
            }, RewardTypes.randomBoosters = {
                icon: bundles.reward_icons.frames.boosters_common_small_png,
                smallIcon: bundles.reward_icons.frames.boosters_common_small_png,
                handler: function () {
                    return function () { }
                }
            }, RewardTypes.moves = {
                icon: bundles.reward_icons.frames.moves_png,
                smallIcon: bundles.reward_icons.frames.moves_small_png,
                handler: function () {
                    return function () { }
                }
            }, RewardTypes.cards = {
                icon: bundles.reward_icons.frames.cards,
                flyingAnimation: Reward.SPAWN_CARDS_ANIMATION,
                handler: function (e) {
                    this.spawnedCards || (this.spawnedCards = []);
                    for (var t = 0; t < e; ++t) {
                        var s = TileFactory.Create({}, {
                            noMarks: !0
                        });
                        this.spawnedCards.push(s)
                    }
                    return function () { }
                }
            },
            RewardTypes.battlePass = {
                bundle: "passbuyticket_window",
                handler: function () {
                    return function () { }
                }
            }, RewardTypes.mission = {
                icon: {},
                smallIcon: {},
                flyingAnimation: "merge" === cleverapps.config.type && Reward.JUMP_COLLECT_ANIMATION,
                handler: function (e) {
                    var t = cleverapps.missionManager.findByType(e.missionType);
                    return (t = t && !t.isRunning() ? void 0 : t) && (t.isPassMission() || t.isTreasureSearchMission() ? cleverapps.missionManager.dispatchEvent(t, e) : t.isSlotMachineMission() ? t.logic.slotMachine.setTickets(t.logic.slotMachine.tickets + e.amount, !0) : t.update(e.amount, void 0, !0)), cleverapps.once(function () {
                        t && (t.onUpdateMission(e.amount), t.isSlotMachineMission() && t.logic.slotMachine.trigger("updateTickets"))
                    })
                }
            }, RewardTypes.kraken = {
                icon: bundles.reward_icons.frames.tentacle_png,
                flyingAnimation: Reward.NO_ANIMATION,
                handler: function () {
                    return Game.currentGame.monstersPlanner.spawnToAllSlots(),
                        function () { }
                }
            }, RewardTypes.pawsPoints = {
                icon: bundles.reward_icons.frames.paw_png,
                flyingAnimation: Reward.JUMP_COLLECT_ANIMATION,
                handler: function (e) {
                    return function () {
                        Game.currentGame.pawBox && Game.currentGame.pawBox.addPoints(e)
                    }
                }
            }, RewardTypes.mission.icon[Mission.TYPE_SOFTFEAST] = bundles.reward_icons.frames.reward_coin_png, RewardTypes.mission.icon[Mission.TYPE_TREASURE_SEARCH] = bundles.reward_icons.frames.reward_shovel_png, RewardTypes.slotMachineTicket = {
                icon: bundles.reward_icons.frames.slot_machine_ticket,
                handler: function (e) {
                    var t = cleverapps.missionManager.findByType(Mission.TYPE_SLOT_MACHINE);
                    return RewardTypes.mission.handler({
                        missionType: t && t.type,
                        amount: e
                    })
                }
            }, RewardTypes.piggyBank = {
                bundle: "piggy_bank_reward",
                handler: function (e) {
                    return cleverapps.piggyBank.isActive() && cleverapps.piggyBank.add(e),
                        function () { }
                }
            }, RewardTypes.clover = {
                handler: function (e) {
                    var t = Game.currentGame && Game.currentGame.secondaryMission;
                    return RewardTypes.mission.handler({
                        missionType: t && t.type,
                        amount: e
                    })
                }
            }, RewardTypes.background_clover = {
                handler: function (e) {
                    var t = Game.currentGame && Game.currentGame.primaryMission;
                    return RewardTypes.mission.handler({
                        missionType: t && t.type,
                        amount: e
                    })
                }
            }, RewardTypes.lantern = {
                handler: function () {
                    return function () { }
                }
            }, RewardTypes.cup = {
                icon: {},
                smallIcon: {},
                flyingAnimation: Reward.JUMP_COLLECT_ANIMATION,
                handler: function (e) {
                    var t;
                    switch (e.type) {
                        case CupsConfig.TYPE_DAILY:
                            t = cleverapps.dailyCup;
                            break;
                        case CupsConfig.TYPE_WEEKLY:
                            t = cleverapps.weeklyCup;
                            break;
                        case CupsConfig.TYPE_CLAN:
                            t = cleverapps.clanCup
                    }
                    return t && (t.addAmount(e.amount), t.innerCup && t.innerCup.addAmount(e.amount)),
                        function () { }
                }
            }, RewardTypes.troopCards = {}, RewardTypes.troop = {
                handler: function (e) {
                    cleverapps.formation.receiveNewSquad(e)
                }
            }, RewardTypes.cup.icon[CupsConfig.TYPE_CLAN] = bundles.reward_icons.frames.cup_png, RewardTypes.cup.smallIcon[CupsConfig.TYPE_CLAN] = bundles.reward_icons.frames.cup_small_png, cleverapps.Layout.extend({
                ctor: function (e, t, s) {
                    var i = cleverapps.styles.Timer,
                        s = (s = s || {}).width || i.width,
                        n = i.height,
                        o = new cc.Scale9Sprite(bundles.big_timer.frames.big_timer_bg_png),
                        n = (o.setContentSize2(s, n),
                            new cc.Sprite(bundles.big_timer.frames.big_timer_png)),
                        e = (n.setLocalZOrder(1), e <= 0 ? e : new cleverapps.CountDown(e, {
                            onFinish: t
                        })),
                        t = new cleverapps.CountDownView(e, {
                            font: cleverapps.styles.FONTS.TIMER_TEXT
                        });
                    o.addChild(t), t.setPositionRound(i.timer), t.fitTo(s - 2 * i.padding.x), this._super([n, o], {
                        margin: i.margin,
                        direction: cleverapps.UI.HORIZONTAL
                    })
                }
            })),
        TravelBook = (cleverapps.styles.Timer = {
            width: 300,
            height: 60,
            margin: -40,
            timer: {
                x: {
                    align: "center",
                    dx: 16
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            padding: {
                x: 36
            },
            icon: {
                x: {
                    align: "left",
                    dx: -25
                },
                y: {
                    align: "center",
                    dy: 3
                }
            }
        }, function () {
            this.pages = [new ExpeditionPage(TravelBook.PAGES[0])], this.currentPage = this.pages[0], (cleverapps.config.lives || cleverapps.config.energy) && CustomSyncers.SLOTS.forEach(function (e) {
                cleverapps.livesBySlots[e].onFullListener = this.onLivesFull.bind(this, e)
            }, this)
        }),
        TravelBookWindow = (TravelBook.prototype.init = function () {
            var e = TravelBook.PAGES.slice(1).filter(function (e) {
                return cleverapps.user.checkAvailable(e.available, {
                    ignoreProgress: !0
                }) && (
                        !e.missionType || cleverapps.missionManager.canCreateType(e.missionType))
            }).map(function (e) {
                return new ExpeditionPage(e)
            }),
                t = this.pages.find(function (e) {
                    return e.isMain()
                });
            this.pages = [t].concat(e), this.updatePages(), this.currentPage = t
        }, TravelBook.prototype.listDisplayedPages = function () {
            this.pages.forEach(function (e) {
                e.updateState()
            });
            var e = this.pages.filter(function (e) {
                return e.isActive()
            });
            return e = e.length < TravelBook.DISPLAYED_PAGES ? e.concat(this.listUpcoming().slice(0, TravelBook.DISPLAYED_PAGES - e.length)) : e
        }, TravelBook.prototype.onLivesFull = function (t) {
            this.pages.filter(function (e) {
                return e.slot === t
            }).forEach(function (e) {
                e.planEvent(ExpeditionPage.EVENT_ENERGY, Date.now()), e.setAttentionEvent(ExpeditionPage.EVENT_ENERGY)
            })
        }, TravelBook.prototype.gotoMainScene = function (e) {
            cleverapps.config.demoMode ? cleverapps.unitsDemoMode.gotoUnitsDemoScene(e) : this.pages.find(function (e) {
                return e.isMain()
            }).gotoExpedition(e)
        }, TravelBook.prototype.getPageById = function (t) {
            return this.pages.find(function (
                e) {
                return e.id === t
            })
        }, TravelBook.prototype.setCurrentPage = function (e) {
            this.currentPage = e
        }, TravelBook.prototype.getCurrentPage = function () {
            return this.currentPage
        }, TravelBook.prototype.listAvailablePages = function () {
            return this.pages
        }, TravelBook.prototype.getCurrentExpedition = function () {
            return this.currentPage.isMain() ? void 0 : this.currentPage
        }, TravelBook.prototype.isExpedition = function () {
            return !this.currentPage.isMain()
        }, TravelBook.prototype.updatePages = function () {
            this.pages.forEach(function (e) {
                e.updateState()
            })
        }, TravelBook.prototype.onUpdateExpedition = function () {
            this.updateBuilt(), this.currentPage.setNew(!1)
        }, TravelBook.prototype.onNewExpeditionMission = function (t) {
            var e = this.pages.find(function (e) {
                return e.missionType === t
            });
            this.startNewExpedition(e)
        }, TravelBook.prototype.startNewExpedition = function (t) {
            this.pages.filter(function (e) {
                return e.slot === t.slot
            }).forEach(function (e) {
                e.resetEvents()
            }), t.setNew(!0), t.setAttentionEvent(ExpeditionPage.EVENT_START), cleverapps.forces.clearForce(
                Forces.TRAVEL_BOOK.id)
        }, TravelBook.prototype.updateBuilt = function () {
            var e = Game.currentGame.workers.findLeastBusy(Buildable);
            e ? (e = Date.now() + e.getTimeLeft(), this.currentPage.planEvent(ExpeditionPage.EVENT_BUILT, e), this.currentPage.setAttentionEvent(ExpeditionPage.EVENT_BUILT)) : this.currentPage.planEvent(ExpeditionPage.EVENT_BUILT, 0)
        }, TravelBook.prototype.listUpcoming = function () {
            var t = this.pages.filter(function (e) {
                return e.isActive()
            }).map(function (e) {
                return e.slot
            }),
                e = this.pages.find(function (e) {
                    return e.isUpcoming() && !t.includes(e.slot) && e.isPermanent()
                }),
                s = this.pages.find(function (e) {
                    return e.isUpcoming() && !t.includes(e.slot) && e.isSeasonal()
                });
            return [e, this.pages.find(function (e) {
                return e.isUpcoming() && !t.includes(e.slot) && !e.isSeasonal() && !e.isPermanent()
            }), s].filter(Boolean)
        }, TravelBook.prototype.findExpeditionByMission = function (t) {
            return this.pages.find(function (e) {
                return t && e.missionType === t.type
            })
        }, TravelBook.prototype.needsAttention = function () {
            return this.pages.some(function (e) {
                return e.attention
            })
        }, TravelBook.prototype.isChosenForForce = function (e) {
            return this.chosenForForce === e
        }, TravelBook.prototype.chooseForce = function () {
            cleverapps.forces.isShown(Forces.TRAVEL_BOOK.id) || (this.chosenForForce = this.pages.filter(function (e) {
                return e.isActive() && e.isNew && (void 0 === e.missionType || cleverapps.missionManager.findRunningMission(e.missionType))
            }).sort(function (e, t) {
                return t.getStartTime() - e.getStartTime()
            })[0])
        }, TravelBook.DISPLAYED_PAGES = 4, TravelBook.AVAILABLE = {
            level: 6
        }, "undefined" == typeof cc && (TravelBook = function () { }, Mission = (Missions = require("../missions/missions")).Mission, Missions = Missions.Missions, cleverapps = require("../utils"), CustomSyncers = {}), TravelBook.PAGES = [{
            id: "main",
            prefix: "main",
            slot: CustomSyncers.SLOT_MAIN,
            episode: "0"
        }, {
            id: "collections",
            prefix: "cl",
            name: "CollectionsExpedition",
            episode: "collections",
            slot: CustomSyncers.EXPEDITION_SLOT3,
            permanent: !0,
            gameLevel: !0,
            available: {
                level: 8.1,
                projectName: ["mergecraft", "fairy"]
            }
        }, {
            id: "dragonia",
            prefix: "dr",
            missionType: Mission.TYPE_DRAGONIA_EXPEDITION,
            name: "DragoniaExpedition",
            episode: "dragonia",
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            duration: "20 days",
            oneShot: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS, Mission.TYPE_EXPEDITION_FEAST]
        }, {
            id: "rapunzel",
            prefix: "rp",
            missionType: Mission.TYPE_RAPUNZEL_EXPEDITION,
            name: "RapunzelExpedition",
            episode: "rapunzel",
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            duration: "6 days",
            energy: !0,
            oneShot: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS]
        }, {
            id: "undersea",
            prefix: "sea",
            missionType: Mission.TYPE_UNDERSEA_EXPEDITION,
            name: "UnderseaExpedition",
            episode: "undersea",
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            duration: "20 days",
            oneShot: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS, Mission.TYPE_EXPEDITION_FEAST]
        }, {
            id: "dragonia2",
            prefix: "dr2",
            missionType: Mission.TYPE_DRAGONIA2_EXPEDITION,
            name: "Dragonia2Expedition",
            episode: "dragonia",
            level: 1,
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            available: {
                level: 7
            },
            duration: "20 days",
            energy: !0,
            oneShot: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS, Mission.TYPE_SNAIL_FEAST]
        }, {
            id: "rapunzel2",
            prefix: "rp2",
            missionType: Mission.TYPE_RAPUNZEL2_EXPEDITION,
            name: "Rapunzel2Expedition",
            episode: "rapunzel",
            level: 1,
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            duration: "8 days",
            energy: !0,
            oneShot: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS]
        }, {
            id: "undersea2",
            prefix: "sea2",
            missionType: Mission.TYPE_UNDERSEA2_EXPEDITION,
            name: "Undersea2Expedition",
            episode: "undersea",
            level: 1,
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            duration: "20 days",
            oneShot: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS, Mission.TYPE_SNAIL_FEAST]
        }, {
            id: "xmas",
            prefix: "xm",
            missionType: Mission.TYPE_XMAS_EXPEDITION,
            name: "XmasExpedition",
            episode: "xmas",
            slot: CustomSyncers.EXPEDITION_SLOT1,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT1,
            available: {
                level: 7,
                projectName: ["mergecraft", "wondermerge", "fairy"]
            },
            feature: "xmas_expedition",
            childMissions: [Mission.TYPE_EXPEDITION_PASS, Mission.TYPE_EXPEDITION_FEAST]
        }, {
            id: "halloween",
            prefix: "hl",
            missionType: Mission.TYPE_HALLOWEEN_2023_EXPEDITION,
            name: "HalloweenExpedition",
            episode: "halloween",
            slot: CustomSyncers.EXPEDITION_SLOT1,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT1,
            feature: "halloween",
            childMissions: [Mission.TYPE_EXPEDITION_PASS, Mission.TYPE_EXPEDITION_FEAST]
        }, {
            id: "easter",
            prefix: "es",
            missionType: Mission.TYPE_EASTER_EXPEDITION,
            name: "EasterExpedition",
            episode: "easter",
            slot: CustomSyncers.EXPEDITION_SLOT1,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT1,
            feature: "easter_expedition",
            available: {
                level: 6,
                projectName: ["mergecraft", "wondermerge", "fairy"]
            },
            energy: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS]
        }, {
            id: "dragonia3",
            prefix: "dr3",
            missionType: Mission.TYPE_DRAGONIA3_EXPEDITION,
            name: "Dragonia3Expedition",
            episode: "dragonia",
            level: 2,
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            available: {
                level: 7,
                projectName: ["mergecraft", "wondermerge"]
            },
            duration: "20 days",
            energy: !0,
            oneShot: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS, Mission.TYPE_SNAIL_FEAST]
        }, {
            id: "rapunzel3",
            prefix: "rp3",
            missionType: Mission.TYPE_RAPUNZEL3_EXPEDITION,
            name: "Rapunzel3Expedition",
            episode: "rapunzel",
            level: 2,
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            duration: "8 days",
            energy: !0,
            oneShot: !0,
            available: {
                debugMode: !0,
                level: 7,
                projectName: ["mergecraft"]
            },
            childMissions: [Mission.TYPE_EXPEDITION_PASS]
        }, {
            id: "china",
            prefix: "ch",
            missionType: Mission.TYPE_CHINA_EXPEDITION,
            name: "ChinaExpedition",
            episode: "china",
            level: 0,
            slot: CustomSyncers.EXPEDITION_SLOT1,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT1,
            feature: "china_expedition",
            available: {
                level: 6,
                projectName: ["mergecraft", "wondermerge", "fairy"]
            },
            energy: !0,
            childMissions: [Mission.TYPE_EXPEDITION_PASS]
        }, {
            id: "adventure",
            prefix: "av",
            missionType: Mission.TYPE_ADVENTURE_EXPEDITION,
            name: "AdventureExpedition",
            episode: "adventure",
            slot: CustomSyncers.EXPEDITION_SLOT2,
            semaphore: Missions.SEMAPHORE_CUSTOM_EXPEDITION_SLOT2,
            available: {
                level: 7,
                projectName: ["mergecraft"],
                debugMode: !0
            },
            duration: "20 days",
            oneShot: !0
        }], TravelBook.findPageById = function (e) {
            for (var t = 0; t < TravelBook.PAGES.length; ++t) {
                var s = TravelBook.PAGES[t];
                if (s.id === e) return s
            }
        }, TravelBook.LIST_IN_ORDER_EXPEDITIONS = function () {
            return TravelBook.PAGES.filter(function (e) {
                return "main" !== e.id
            }).map(function (e) {
                return e.missionType
            })
        }, TravelBook.INIT_EXPEDITIONS = function () {
            var t = Object.assign({}, {
                level: 0,
                duration: "1 day",
                logic: ExpeditionMissionLogic,
                rewardShareId: "bonus_world",
                sideBarJson: !1,
                rewardTitle: "ExpeditionRewardWindow.title",
                rewardText: "ExpeditionRewardWindow.description"
            });
            TravelBook.PAGES.filter(function (e) {
                return void 0 !== e.missionType
            }).forEach(function (e) {
                e.available = e.available || cleverapps.Availables.EXPEDITIONS, Missions[e.missionType] = Object.assign({}, t, e)
            })
        }, "undefined" == typeof cc && (module.exports = TravelBook), Window.extend({
            onWindowLoaded: function (e) {
                this._super({
                    title: "TravelBookWindow.Title",
                    name: "travelbookwindow",
                    content: this.getContent(),
                    styles: cleverapps.styles.TravelBookWindow.window
                }), e && e.targetPage && this.showHint(e.targetPage)
            },
            getContent: function () {
                var e = cleverapps.styles.TravelBookWindow.content,
                    t = this.pageViews = cleverapps.travelBook.listDisplayedPages().map(function (e) {
                        return new ExpeditionPageView(e)
                    }, this),
                    t = new cleverapps.Layout(t, {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: e.margin,
                        padding: e.padding
                    }),
                    s = new cc.Node;
                return s.setAnchorPoint2(), s.setContentSize2(Math.max(e.width, t.width), t.height), s.addChild(t), t.setPositionRound(e), s
            },
            showHint: function (t) {
                var e, s = this.pageViews.find(function (e) {
                    return e.page.id === t && e.page.isActive()
                });
                s ? s.showHint() : this.runAction(new cc.Sequence(new cc.DelayTime(.25), new cc.CallFunc(
                    function () {
                        e = this.dialogue = new MinimalDialogue({
                            person: "king",
                            delay: 0,
                            text: "MissionUnavailable",
                            rects: this.getMinimalDialogueRects()
                        }), this.addChild(e), e.display()
                    }.bind(this)), new cc.DelayTime(3), new cc.CallFunc(function () {
                        e.remove()
                    })))
            },
            listBundles: function () {
                return ["travel_book"]
            }
        })),
        ExpeditionPage = (cleverapps.styles.TravelBookWindow = {
            window: {
                padding: {
                    left: 24,
                    right: 27,
                    top: 30,
                    bottom: 30
                }
            },
            content: {
                x: {
                    align: "left"
                },
                y: {
                    align: "center"
                },
                width: 1300,
                margin: 20,
                padding: {
                    x: 60,
                    y: 50
                }
            }
        }, function (e) {
            this.id = e.id, this.prefix = e.prefix, this.missionType = e.missionType, this.slot = e.slot || CustomSyncers.SLOT_MAIN, this.episode = e.episode, this.level = e.level || 0, this.energy = e.energy, this.gameLevel = e.gameLevel, this.permanent = e.permanent, this.available = e.available, this.disableNew = e.disableNew, this.attentionEvent = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.TRAVEL_BOOK_ATTENTION + this.id) || !1
        }),
        ExpeditionPageView = (ExpeditionPage.TYPE_SKIP = 0, ExpeditionPage.TYPE_ACTIVE = 1, ExpeditionPage.TYPE_UPCOMING = 2,
            ExpeditionPage.prototype.isMain = function () {
                return "main" === this.id
            }, ExpeditionPage.prototype.getStartTime = function () {
                var e = cleverapps.missionManager.findByType(this.missionType);
                return e && e.isRunning() && e.started || 0
            }, ExpeditionPage.prototype.getTimeLeft = function () {
                var e = cleverapps.missionManager.findByType(this.missionType);
                return e && e.isRunning() && e.getTimeLeft() || 0
            }, ExpeditionPage.prototype.updateState = function () {
                var e = this.state;
                this.state = this.calcState(), this.isPermanent() && this.isActive() && e !== this.state && ((e = cleverapps.GameSaver.load(this.slot)) && 0 !== Object.keys(e).length || cleverapps.travelBook.startNewExpedition(this)), this.title = "TravelBook.title." + this.id, this.isUpcoming() && (this.title = "TravelBook.soon"), this.forceText = "TravelBookForce." + this.id, this.events = this.listEvents(), this.events[0] ? (this.message = "function" == typeof this.events[0].message ? this.events[0].message(this) : this.events[0].message, (e = cleverapps.DataLoader.load(
                    cleverapps.DataLoaderTypes.TRAVEL_BOOK_EVENTS + this.id) || {})[this.events[0].type] = void 0, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.TRAVEL_BOOK_EVENTS + this.id, e)) : this.message = void 0, this.isCompleted() && this.setAttentionEvent(ExpeditionPage.EVENT_FINISH), this.attention = !this.isCurrent() && this.events.find(function (e) {
                        return e.type === this.attentionEvent
                    }, this)
            }, ExpeditionPage.prototype.resetEvents = function () {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.TRAVEL_BOOK_EVENTS + this.id, {})
            }, ExpeditionPage.prototype.setNew = function (e) {
                this.isNew = e
            }, ExpeditionPage.prototype.setAttentionEvent = function (e) {
                this.attentionEvent !== e && (this.attentionEvent = e, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.TRAVEL_BOOK_ATTENTION + this.id, e))
            }, ExpeditionPage.prototype.planEvent = function (e, t) {
                var s = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.TRAVEL_BOOK_EVENTS + this.id) || {};
                s[e] = {
                    time: t
                }, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.TRAVEL_BOOK_EVENTS + this.id, s)
            },
            ExpeditionPage.prototype.listEvents = function () {
                if ("merge" !== cleverapps.config.type) return [];
                if (!this.isActive()) return [];
                var t = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.TRAVEL_BOOK_EVENTS + this.id) || {};
                return ExpeditionPage.EVENTS.filter(function (e) {
                    return e.filter ? e.filter(this) : t[e.type] && t[e.type].time && t[e.type].time < Date.now()
                }, this)
            }, ExpeditionPage.prototype.isPassed = function () {
                return cleverapps.missionManager.isMissionPassed(this.missionType)
            }, ExpeditionPage.prototype.calcState = function () {
                if (this.isMain()) return ExpeditionPage.TYPE_ACTIVE;
                if (this.isPermanent()) return cleverapps.user.checkAvailable(this.available) ? ExpeditionPage.TYPE_ACTIVE : ExpeditionPage.TYPE_UPCOMING;
                var e = Missions[this.missionType];
                if (!e) return ExpeditionPage.TYPE_SKIP;
                if (cleverapps.missionManager.findByType(this.missionType)) return ExpeditionPage.TYPE_ACTIVE;
                if (this.isPassed()) return ExpeditionPage.TYPE_SKIP;
                if (e.feature) {
                    var t = cleverapps.missionManager.isAvailableByType(this.missionType, {
                        skipFeatures: !0
                    }),
                        s = cleverapps.eventManager.getNextFeatureEvent(e.feature);
                    if (!t || !s || s.getTimeBeforeStart() > cleverapps.parseInterval("3 days")) return ExpeditionPage.TYPE_SKIP
                }
                return e.disableNew ? ExpeditionPage.TYPE_SKIP : ExpeditionPage.TYPE_UPCOMING
            }, ExpeditionPage.prototype.gotoExpedition = function (e) {
                var t, s;
                cleverapps.travelBook.setCurrentPage(this), this.setAttentionEvent(!1), this.isMain() ? (s = cleverapps.meta.getMainScene(), cleverapps.scenes.replaceScene(new s, e)) : (t = cleverapps.missionManager.findByType(this.missionType), s = new GameScene({
                    level: this.getCurrentLevel()
                }), cleverapps.scenes.replaceScene(s, function () {
                    t && t.isCompleted() ? t.displayCompleted(e) : e()
                }))
            }, ExpeditionPage.prototype.isActive = function () {
                return this.state === ExpeditionPage.TYPE_ACTIVE
            }, ExpeditionPage.prototype.isUpcoming = function () {
                return this.state === ExpeditionPage.TYPE_UPCOMING
            }, ExpeditionPage.prototype.isSeasonal = function () {
                return Missions[this.missionType] && Missions[this.missionType].feature
            },
            ExpeditionPage.prototype.isPermanent = function () {
                return Boolean(this.permanent)
            }, ExpeditionPage.prototype.isCompleted = function () {
                var e = cleverapps.missionManager.findByType(this.missionType);
                return e && e.isCompleted()
            }, ExpeditionPage.prototype.isCurrent = function () {
                return cleverapps.travelBook.getCurrentPage() === this
            }, ExpeditionPage.prototype.withEnergy = function () {
                return this.isMain() || this.energy
            }, ExpeditionPage.prototype.withWands = function () {
                return this.isMain() || !["rapunzel", "rapunzel2", "easter", "china"].includes(this.id)
            }, ExpeditionPage.prototype.withWorkers = function () {
                return this.isMain() || !["rapunzel", "rapunzel2", "easter", "collections", "china"].includes(this.id)
            }, ExpeditionPage.prototype.getCurrentLevel = function () {
                return new Episode(this.episode, this.level).getLevel()
            }, ExpeditionPage.prototype.getButtonMsg = function () {
                return this.isUpcoming() ? this.isPermanent() && 0 < this.levelsUntil() ? Messages.get("UnlockOnLevel", {
                    level: Math.floor(this.available.level + 1)
                }) : "Soon" : "Go"
            },
            ExpeditionPage.prototype.getTooltipMsg = function () {
                return this.isPermanent() && 0 < this.levelsUntil() ? Messages.get("UnlockOnLevel", {
                    level: Math.floor(this.available.level + 1)
                }) : Messages.get("TravelBook.soonTooltip")
            }, ExpeditionPage.prototype.levelsUntil = function () {
                return Math.floor(this.available.level) - Math.floor(cleverapps.user.getFloatLevel())
            }, ExpeditionPage.prototype.isRunning = function () {
                return !!this.isMain() || (this.isPermanent() ? cleverapps.user.checkAvailable(this.available) : Boolean(cleverapps.missionManager.findRunningMission(this.missionType)))
            }, ExpeditionPage.EVENT_START = "start", ExpeditionPage.EVENT_FINISH = "finish", ExpeditionPage.EVENT_ENERGY = "energy", ExpeditionPage.EVENT_KEYS = "keys", ExpeditionPage.EVENT_BUILT = "built", ExpeditionPage.EVENTS = [{
                type: ExpeditionPage.EVENT_START,
                message: {
                    text: "TravelBook.message.welcome"
                },
                filter: function (e) {
                    return e.isNew
                }
            }, {
                type: ExpeditionPage.EVENT_FINISH,
                message: function () {
                    return {
                        text: "TravelBook.message.finished",
                        icon: bundles.travel_book.frames.icon_finish
                    }
                },
                filter: function (e) {
                    return e.isCompleted()
                }
            }, {
                type: ExpeditionPage.EVENT_BUILT,
                message: function () {
                    return {
                        text: "TravelBook.message.built",
                        icon: bundles.travel_book.frames.icon_built
                    }
                }
            }, {
                type: ExpeditionPage.EVENT_KEYS,
                message: function (e) {
                    return {
                        icon: bundles.travel_book.frames["icon_key_" + e.id],
                        text: "TravelBook.message.keys." + e.id
                    }
                }
            }, {
                type: ExpeditionPage.EVENT_ENERGY,
                message: function (e) {
                    return {
                        icon: bundles.travel_book.frames["icon_energy_" + e.id],
                        text: "TravelBook.message.energy"
                    }
                },
                filter: function (e) {
                    return e.withEnergy() && cleverapps.livesBySlots[e.slot].isFull()
                }
            }], cc.Scale9Sprite.extend({
                ctor: function (e) {
                    this.page = e;
                    e = cleverapps.styles.ExpeditionPageView;
                    this._super(bundles.travel_book.frames.bg_png), this.setContentSize2(e), this.createImage(), this.createTitle(), this.page.isCurrent() ? this.createCurrentText() : this.createButton(), this.page.isActive() && !this.page.isMain() && this.page.getTimeLeft() && this.createTimer(),
                        this.page.message && this.createMessage(), this.page.isActive() && !this.page.isCurrent() && cleverapps.UI.onClick(this, this.gotoExpedition.bind(this), {
                            ignoreScale: !0
                        })
                },
                createImage: function () {
                    var e = cleverapps.styles.ExpeditionPageView,
                        t = new cc.Sprite(bundles.travel_book.frames[this.page.id + "_png"]);
                    this.addChild(t), t.setPositionRound(e.image), this.page.isUpcoming() && t.setColor(new cc.Color(130, 130, 130, 255))
                },
                createTitle: function () {
                    var e = cleverapps.styles.ExpeditionPageView,
                        t = (bundles.travel_book.frames.title_bg_png && ((t = new cc.Scale9Sprite(bundles.travel_book.frames.title_bg_png)).setContentSize2(e.title.bg), this.addChild(t), t.setPositionRound(e.title.bg)), cleverapps.UI.generateOnlyText(this.page.title, cleverapps.styles.FONTS.TRAVEL_BOOK_TITLE_TEXT));
                    t.fitTo(e.title.width), this.addChild(t), t.setPositionRound(e.title)
                },
                createCurrentText: function () {
                    var e = cleverapps.styles.ExpeditionPageView,
                        t = cleverapps.UI.generateOnlyText("TravelBook.current", cleverapps.styles.FONTS.TRAVEL_BOOK_BOTTOM_TEXT),
                        s = (t.fitTo(e.current.text.width), new cc.Sprite(bundles.travel_book.frames.mark_png)),
                        t = new cleverapps.Layout([t, s], {
                            margin: e.current.margin,
                            direction: cleverapps.UI.HORIZONTAL
                        });
                    this.addChild(t), t.setPositionRound(e.current)
                },
                createTimer: function () {
                    var e = cleverapps.styles.ExpeditionPageView,
                        t = this.page.getTimeLeft(),
                        t = new Timer(t, function () { }, {
                            width: e.timer.width
                        });
                    this.addChild(t), t.setPositionRound(e.timer)
                },
                createButton: function () {
                    var e = cleverapps.styles.ExpeditionPageView,
                        t = this.button = new cleverapps.UI.Button({
                            text: this.page.getButtonMsg(),
                            onClicked: this.gotoExpedition.bind(this),
                            width: e.button.width,
                            height: e.button.height,
                            mark: this.page.attention
                        });
                    this.addChild(t), t.setPositionRound(e.button), this.page.isUpcoming() && (t.disable(), cleverapps.tooltipManager.create(t, {
                        text: this.page.getTooltipMsg(),
                        position: cleverapps.styles.UI.Tooltip.LOCATION.above
                    })), cleverapps.travelBook.isChosenForForce(this.page) && this.showHint()
                },
                showHint: function () {
                    FingerView.hintClick(this.button)
                },
                createMessage: function () {
                    var e, t = cleverapps.styles.ExpeditionPageView,
                        s = bundles.travel_book.frames.key_text_bg_png,
                        s = (!this.page.message.icon && bundles.travel_book.frames.key_text_bg_no_icon_png && (s = bundles.travel_book.frames.key_text_bg_no_icon_png), new cc.Scale9Sprite(s)),
                        i = (s.setContentSize2((this.page.message.icon ? t.message : t.message.noIcon).width, t.message.height), cleverapps.UI.generateOnlyText(this.page.message.text, cleverapps.styles.FONTS.TRAVEL_BOOK_MESSAGE_TEXT));
                    s.addChild(i), i.setPositionRound((this.page.message.icon ? t.message.text : t.message.text.noIcon).x, t.message.text.y), i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), i.setDimensions(t.message.text.width, 0), i.fitTo(void 0, t.message.text.height), this.page.message.icon && (i = new cc.Sprite(bundles.travel_book.frames.key_icon_bg_png), e = new cc.Sprite(this.page.message.icon), cleverapps.UI.fitToBox(e, t.message.icon), i.addChild(e), e.setPositionRound(t.message.icon), s.addChild(i), i.setPositionRound(t.message.iconBg)),
                        this.addChild(s), s.setPositionRound((this.page.message.icon ? t.message : t.message.noIcon).x, t.message.y)
                },
                gotoExpedition: function () {
                    cleverapps.meta.distract({
                        focus: "TravelBook.gotoExpedition",
                        action: function (e) {
                            this.page.gotoExpedition(e)
                        }.bind(this)
                    })
                }
            })),
        TravelBookHint = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            TRAVEL_BOOK_BOTTOM_TEXT: {
                name: "default",
                size: 35,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            TRAVEL_BOOK_TITLE_TEXT: {
                name: "default",
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            TRAVEL_BOOK_MESSAGE_TEXT: {
                name: "default",
                size: 30,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            }
        }), cleverapps.styles.ExpeditionPageView = {
            width: 380,
            height: 630,
            message: {
                noIcon: {
                    x: {
                        align: "center"
                    },
                    width: 300
                },
                x: {
                    align: "center",
                    dx: 28
                },
                y: {
                    align: "top",
                    dy: -100
                },
                text: {
                    width: 210,
                    height: 75,
                    noIcon: {
                        x: {
                            align: "center"
                        }
                    },
                    x: {
                        align: "center",
                        dx: 10
                    },
                    y: {
                        align: "center",
                        dy: 2
                    }
                },
                width: 270,
                height: 86,
                icon: {
                    width: 80,
                    height: 80,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    }
                },
                iconBg: {
                    x: {
                        align: "left",
                        dx: -50
                    },
                    y: {
                        align: "center"
                    }
                }
            },
            image: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 20
                }
            },
            title: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: -45,
                    anchor: "center"
                },
                width: 340
            },
            current: {
                margin: 10,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 35
                },
                text: {
                    width: 250
                }
            },
            timer: {
                margin: 10,
                width: 200,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 140
                }
            },
            button: {
                width: 300,
                height: 90,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 23
                }
            }
        }, function () {
            this.nextTime = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.TRAVEL_BOOK_HINT_TIME) || 0, this.onShowHint = function () { }, this.onHideHint = function () { }
        }),
        TravelBookHintView = (TravelBookHint.prototype.canShow = function () {
            return !cleverapps.meta.isFocused() && cleverapps.environment.isMainScene() && !cleverapps.travelBook.isExpedition() && Game.currentGame && !Game.currentGame.stopped && Game.currentGame.showUpFinished
        }, TravelBookHint.prototype.check = function () {
            var e;
            Date.now() < this.nextTime || !this.canShow() || this.running || (e = cleverapps.travelBook.pages.map(function (e) {
                return e.missionType && cleverapps.missionManager.findByType(e.missionType)
            }).filter(function (e) {
                return e
            }).sort(function (e, t) {
                return e.getTimeLeft() - t.getTimeLeft()
            })[0]) && this.checkMission(e)
        }, TravelBookHint.prototype.checkMission = function (e) {
            var t, s, i = cleverapps.travelBook.findExpeditionByMission(e);
            i && this.canShow() && (s = Math.ceil(e.getTimeLeft() / cleverapps.parseInterval("1 day")), e.isCompleted() ? (t = Messages.get("ExpeditionProgressHint.completed", {
                name: i.title
            }), i.isUpcoming() && cleverapps.throwAsync("completed mission with upcoming page " + (e && e.type) + " " + i.id + " " + i.missionType)) : e.isRunning() && s <= 3 && (t = Messages.get("ExpeditionProgressHint.remaining", {
                name: i.title,
                remaining: s
            })), t && (this.hideHint(), this.running = !0, this.onShowHint(t),
                Game.currentGame.counter.setTimeout(this.hideHint.bind(this), TravelBookHint.DURATION), this.setNextTime(Date.now() + TravelBookHint.TIMEOUT)))
        }, TravelBookHint.prototype.hideHint = function () {
            this.onHideHint(), this.running = !1
        }, TravelBookHint.prototype.setNextTime = function (e) {
            this.nextTime = e, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.TRAVEL_BOOK_HINT_TIME, e)
        }, TravelBookHint.DURATION = 4e3, TravelBookHint.TIMEOUT = cleverapps.parseInterval("1 day"), cc.Node.extend({
            ctor: function () {
                this._super(), cleverapps.travelBookHint.onShowHint = this.createListener(this.showHint.bind(this)), cleverapps.travelBookHint.onHideHint = this.createListener(this.hideHint.bind(this))
            },
            showHint: function (e) {
                var t = cleverapps.scenes.getRunningScene().downToolBarControl.getBoundingBox();
                this.dialogue = new MinimalDialogue({
                    text: e,
                    rects: [t],
                    person: "king"
                }), this.addChild(this.dialogue), this.dialogue.display(), cleverapps.toolbar.getItem(ToolbarItem.TRAVEL_BOOK.type).setFinger(!0, cleverapps.parseInterval("4 seconds"))
            },
            hideHint: function () {
                this.dialogue && this.dialogue.remove()
            }
        })),
        PaginationView = (cleverapps.Pagination = function (e, t) {
            cleverapps.EventEmitter.call(this), this.page = t || 0, this.total = e
        }, cleverapps.Pagination.prototype = Object.create(cleverapps.EventEmitter.prototype), cleverapps.Pagination.prototype.constructor = cleverapps.Pagination, cleverapps.Pagination.prototype.isLast = function () {
            return this.page === this.total - 1
        }, cleverapps.Pagination.prototype.getCurrent = function () {
            return this.page
        }, cleverapps.Pagination.prototype.getTotal = function () {
            return this.total
        }, cleverapps.Pagination.prototype.nextPage = function () {
            this.isLast() ? this.trigger("lastPage") : this.setPage(this.page + 1)
        }, cleverapps.Pagination.prototype.setPage = function (e) {
            this.page = e, this.trigger("changePage", this.page)
        }, cleverapps.Pagination.prototype.addPage = function () {
            this.total++, this.trigger("addPage")
        }, cleverapps.Pagination.prototype.removePage = function (e) {
            this.total <= 1 || (this.page > e && this.page--, this.page === e && (0 === this.page ? (this.setPage(
                1), this.page = 0) : this.setPage(this.page - 1)), this.total--, this.trigger("removePage", e))
        }, cleverapps.Spine.extend({
            avoidNode: "PaginationView",
            ctor: function (e) {
                this.pagination = e, this._super(bundles.pagination.jsons[this.getJsonName()]), this.setAnimation(0, this.getIdleAnimationName()), this.pagination.on("changePage", this.createListener(this.changePage.bind(this))), this.updateRelativePosition()
            },
            changePage: function () {
                this.setAnimationAndIdleAfter("open_" + this.pagination.page, this.getIdleAnimationName())
            },
            getJsonName: function () {
                return "pagination_" + this.pagination.total + "_json"
            },
            getIdleAnimationName: function () {
                return "idle_" + this.pagination.page
            },
            updateRelativePosition: function () {
                var s = cleverapps.styles.PaginationView,
                    e = cleverapps.scenes.getRunningScene(),
                    i = this.calculatePositionRound(s.x, s.y, {
                        box: e.getGlobalBoundingBox()
                    });
                [e.upMenuContainer && e.upMenuContainer.menuBar, e.comboBarControl].filter(Boolean).forEach(function (e) {
                    var e = cc.rectAddPadding(e.getGlobalBoundingBox(), cc.padding(s.padding)),
                        t = cc.rect(i.x - this.width / 2, i.y - this.height / 2, this.width, this.height);
                    cc.rectIntersectsRect(e, t) && (i.y = e.y - t.height / 2)
                }.bind(this)), this.setPositionRound(e.convertToNodeSpace(i))
            }
        })),
        Score = (cleverapps.styles.PaginationView = {
            x: {
                align: "center",
                dx: 0
            },
            y: {
                align: "top",
                dy: -30
            },
            padding: 25
        }, function (e) {
            cleverapps.EventEmitter.call(this), this.points = e || 0
        }),
        WebWorker = (Score.prototype = Object.create(cleverapps.EventEmitter.prototype), (Score.prototype.constructor = Score).prototype.getPoints = function () {
            return this.points
        }, Score.prototype.setPoints = function (e, t) {
            this.points = e = e < 0 ? 0 : e, this.trigger("onChange", this.points, t)
        }, Score.prototype.hide = function () {
            this.trigger("onHide")
        }, Score.prototype.show = function () {
            this.trigger("onShow")
        }, Score.prototype.addPoints = function (e, t) {
            this.setPoints(this.points + e, t)
        }, {
            IsAvailable: function () {
                return -1 !== ["blocks"].indexOf(cleverapps.config.type)
            },
            Build: function () {
                var e;
                return (e = cleverapps.isLocalhost() ? new Worker("cleverapps/levels/game/blocks/worker/blocksworker.js") : (e = document.getElementById("web-worker-task").innerHTML, new Worker(window.URL.createObjectURL(new Blob([e], {
                    type: "text/javascript"
                }))))).postMessage(Forms.ALL_POSSIBLE_VARIANTS), e
            }
        }),
        TilesUnlockWindow = Window.extend({
            onWindowLoaded: function () {
                this.tilesCreated = !1;
                var e = this.createContent();
                this._super({
                    content: e,
                    name: "tilesunlockwindow",
                    noBackground: !0,
                    tapToContinue: "Window.ClickToClose"
                })
            },
            onShow: function () {
                this._super(2.5)
            },
            createContent: function () {
                var e = cleverapps.styles.TilesUnlockWindow,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize(e.width, e.height), cleverapps.UI.generateOnlyText("TilesUnlockWindow.text", cleverapps.styles.FONTS.TILES_UNLOCK_WINDOW_TEXT)),
                    s = (s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.setDimensions(e.text.width, 0), s.fitTo(void 0, e.text.height), t.addChild(s), s.setPositionRound(e.text), this.animation = new cleverapps.Spine(bundles.tiles_unlock_window.jsons.tiles_unlock_json));
                return s.setAnimationAndIdleAfter("open", "idle"), cleverapps.audio.playSound(
                    bundles.game.urls.tiles_unlock_effect), s.setPositionRound(e.animation), t.addChild(s), (this.tiles = this.createTiles()).forEach(function (e) {
                        t.addChild(e)
                    }), t
            },
            createTiles: function () {
                var e = Game.currentGame.generator.getAvailableSkins().new.map(function (e) {
                    e = CardView.createCardView(new Card({
                        value: e
                    }));
                    return e.onTouchHandler.remove(), e.onTouchHandler = void 0, e.hide = void 0, e
                }),
                    s = !0,
                    i = cleverapps.wait(2, function () {
                        this.tilesCreated = !0
                    }.bind(this));
                return e.forEach(function (e) {
                    var t = [];
                    t.push(e.unlockSpawnAnimate(s, i)), t.push(new cc.CallFunc(i)), t.push(e.unlockIdleAnimate(s)), e.runAction(new cc.Sequence(t)), s = !1
                }), e
            },
            beforeCloseAnimation: function (t) {
                t = cleverapps.wait(2, t);
                var s = !0;
                this.animation.setAnimation(0, "close", !1), this.animation.setCompleteListenerRemove(), this.tiles.forEach(function (e) {
                    e.stopAllActions(), e.unlockEndAnimate(t, s), s = !1
                })
            },
            close: function () {
                this.tilesCreated && this._super()
            },
            listBundles: function () {
                return ["tiles_unlock_window"]
            }
        }),
        BaseBoosterBefore = (
            TilesUnlockWindow.getUnlockedTiles = function () {
                var e = Game.currentGame.generator.getAvailableSkins().new;
                if (e.length) return e
            }, TilesUnlockWindow.areUnlockedTilesAvailable = function () {
                return 0 === cleverapps.user.level && 0 < cleverapps.user.episode && TilesUnlockWindow.getUnlockedTiles()
            }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
                TILES_UNLOCK_WINDOW_TEXT: {
                    size: 60,
                    color: new cc.Color(255, 255, 83, 255),
                    stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                    shadow: {
                        color: cleverapps.styles.COLORS.COLOR_BROWN,
                        direction: cc.size(0, -5)
                    }
                }
            }), cleverapps.styles.TilesUnlockWindow = {
                width: 650,
                height: 900,
                animation: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: 0
                    }
                },
                tiles: {
                    offset: 125,
                    scale: 1.7
                },
                text: {
                    width: 800,
                    height: 600,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "top"
                    }
                }
            },
            function (e) {
                BaseBooster.call(this, e), this.spentEvent = cleverapps.EVENTS.SPENT.BOOSTER_BEFORE
            }),
        ComboBooster = (BaseBoosterBefore.prototype = Object.create(BaseBooster.prototype), (BaseBoosterBefore.prototype.constructor = BaseBoosterBefore).prototype.onUsed = function () {
            cleverapps.eventBus.trigger("taskEvent", DailyTasks.USE_BOOSTER_BEFORE)
        }, BaseBoosterBefore.prototype.onGiveUp = function () {
            cleverapps.lives && !this.getLanternBonus() && cleverapps.boosters.add(this.id, 1)
        }, BaseBoosterBefore.prototype.getLanternBonus = function () {
            return Lantern.GetBoosterBonus(Game.currentGame.level, this)
        }, BaseBoosterBefore.prototype.logUseEvents = cleverapps.extendFunc(BaseBoosterBefore.prototype.logUseEvents, function () {
            this.getLanternBonus() || this._super()
        }), BaseBoosterBefore.prototype.execute = cleverapps.extendFunc(BaseBoosterBefore.prototype.execute, function () {
            this.getLanternBonus() && this.setAmount(this.getAmount() + 1), this._super()
        }), BaseBoosterBefore.prototype.getExecuteDuration = function () {
            return "scramble" === cleverapps.config.name ? 0 : .3
        }, BaseBoosterBefore.prototype.isUpcoming = function () {
            for (var e = cleverapps.boosters.listBoostersBefore(), t = 0; t < e.length; t++)
                if (!e[t].isAvailable()) return e[t] === this;
            return !1
        }, function () {
            BaseBoosterBefore.call(this,
                cleverapps.Boosters.TYPE_COMBO)
        }),
        DiceBooster = (ComboBooster.prototype = Object.create(BaseBoosterBefore.prototype), (ComboBooster.prototype.constructor = ComboBooster).prototype.execute = function () {
            BaseBoosterBefore.prototype.execute.call(this);
            var e = ComboBooster.COMBOS_AMOUNT,
                t = ComboBooster.COMBOS_TIMEOUTS.slice(0, e),
                t = Game.currentGame.field.addRandomCombo(e, {
                    boosterBefore: !0,
                    timeouts: t
                });
            t < e && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTER_COMBO_NO_PLACE, {
                value: e - t
            }), t <= e - ComboBooster.COMBOS_AMOUNT && this.onGiveUp()
        }, ComboBooster.COMBOS_AMOUNT = 5, ComboBooster.COMBOS_TIMEOUTS = [0, 120, 250, 360, 500, 620, 750, 860, 1e3, 1100], function () {
            BaseBoosterBefore.call(this, cleverapps.Boosters.TYPE_DICE)
        }),
        EyeBooster = (DiceBooster.prototype = Object.create(BaseBoosterBefore.prototype), (DiceBooster.prototype.constructor = DiceBooster).prototype.execute = function () {
            BaseBoosterBefore.prototype.execute.call(this), Game.currentGame.dice.roll(), Game.currentGame.dice.reward(), this.number = Game.currentGame.dice.number
        }, DiceBooster.prototype.getExecuteDuration = function () {
            return 2.6 + .2 * (this.number || 6)
        }, function () {
            BaseBoosterBefore.call(this, cleverapps.Boosters.TYPE_EYE)
        }),
        HighlightBooster = (EyeBooster.prototype = Object.create(BaseBoosterBefore.prototype), (EyeBooster.prototype.constructor = EyeBooster).prototype.execute = function () {
            BaseBoosterBefore.prototype.execute.call(this), this.trigger("giveBonus")
        }, EyeBooster.prototype.getExecuteDuration = function () {
            return 5
        }, function () {
            BaseBoosterBefore.call(this, cleverapps.Boosters.TYPE_HIGHLIGHT)
        }),
        MagnetBooster = (HighlightBooster.prototype = Object.create(BaseBoosterBefore.prototype), (HighlightBooster.prototype.constructor = HighlightBooster).prototype.execute = function () {
            BaseBoosterBefore.prototype.execute.call(this), Game.currentGame.currentHighlighter.enable()
        }, function () {
            BaseBoosterBefore.call(this, cleverapps.Boosters.TYPE_MAGNET)
        }),
        MagnifierBooster = (MagnetBooster.prototype = Object.create(BaseBoosterBefore.prototype), (MagnetBooster.prototype.constructor = MagnetBooster).prototype.execute = function () {
            BaseBoosterBefore.prototype.execute.call(this);
            var e, t, s = cleverapps.Random.shuffle(Game.currentGame.table.cardsThatCanBeReplacedWithBoosters());
            0 !== s.length ? (e = (0 < (e = s.filter(function (e) {
                return e.isOpen()
            })).length ? e : s)[0], s = Object.assign(e.toJSON(), {
                marks: ["magnet"]
            }), (s = TileFactory.Create(s)).setOwner(e.owner), Game.currentGame.table.replaceCard(e, s), Game.currentGame.table.trigger("replaceCardWithAnother", e, s), e.isOpen() && s.flip(), (t = s.marks[0]).hide(), Game.currentGame.table.trigger("demonstrateBoosterBefore", s, function () {
                t.show(!0)
            })) : this.onGiveUp()
        }, MagnetBooster.prototype.getExecuteDuration = function () {
            return 2.2
        }, function () {
            BaseBoosterBefore.call(this, cleverapps.Boosters.TYPE_MAGNIFIER)
        }),
        MovesBooster = (MagnifierBooster.prototype = Object.create(BaseBoosterBefore.prototype), (MagnifierBooster.prototype.constructor = MagnifierBooster).prototype.execute = function () {
            BaseBoosterBefore.prototype.execute.call(this), Game.currentGame.keypad.addMagnifiers(
                MagnifierBooster.AMOUNT), Game.currentGame.keypad.magnifiersShowUp()
        }, MagnifierBooster.AMOUNT = 5, function () {
            BaseBoosterBefore.call(this, cleverapps.Boosters.TYPE_MOVES)
        }),
        MultiColorBooster = (MovesBooster.prototype = Object.create(BaseBoosterBefore.prototype), (MovesBooster.prototype.constructor = MovesBooster).prototype.execute = function () {
            var e;
            this.isLevelWithUnlimitedLives() || (BaseBoosterBefore.prototype.execute.call(this), e = MovesBooster.MOVES_AMOUNT, Game.currentGame.setMoves(Game.currentGame.moves + e, {
                animate: !0,
                boosterBefore: !0
            }), Game.currentGame.beginMoves += e)
        }, MovesBooster.prototype.isLevelWithUnlimitedLives = function () {
            return -1 === Game.currentGame.moves
        }, MovesBooster.MOVES_AMOUNT = 5, function () {
            BaseBoosterBefore.call(this, cleverapps.Boosters.TYPE_MULTICOLOR)
        }),
        TwoJokersBooster = (MultiColorBooster.prototype = Object.create(BaseBoosterBefore.prototype), (MultiColorBooster.prototype.constructor = MultiColorBooster).prototype.execute = function () {
            BaseBoosterBefore.prototype.execute.call(this);
            var e = Game.currentGame.field.addRandomMulticolor(1, {
                boosterBefore: !0
            });
            e < 1 && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTER_MULTICOLOR_NO_PLACE, {
                value: 1 - e
            }), this.onGiveUp())
        }, function () {
            BaseBoosterBefore.call(this, cleverapps.Boosters.TYPE_JOKERS)
        }),
        WindowBoosterBefore = (TwoJokersBooster.prototype = Object.create(BaseBoosterBefore.prototype), (TwoJokersBooster.prototype.constructor = TwoJokersBooster).prototype.execute = function () {
            BaseBoosterBefore.prototype.execute.call(this);

            function e(e, t) {
                var s;
                e && ((s = TileFactory.Create({
                    feature: "wild",
                    x: e.x,
                    y: e.y,
                    rotation: e.getRotation()
                })).setOwner(e.owner), Game.currentGame.table.insertBeforeCard(e, s), Game.currentGame.table.trigger("insertCard", s, t ? -2 * cleverapps.styles.CardView.width : 2 * cleverapps.styles.CardView.width))
            }
            var t = Game.currentGame.table.cardsWithPossibilityOfPlacingUnderThem();
            e(t.filter(function (e) {
                return e.x < 0
            }).pop(), !0), e(t.filter(function (e) {
                return 0 <= e.x
            }).pop(), !1)
        }, TwoJokersBooster.prototype.getExecuteDuration = function () {
            return 1.6
        }, function (e, t) {
            cleverapps.EventEmitter.call(this), this.booster = e, this.level = t, this.selected = !1, this.changeAmountListener = this.booster.on("changeAmount", this.onChangeAmount.bind(this)), this.onChangeAmount()
        }),
        WindowBoostersBefore = (WindowBoosterBefore.prototype = Object.create(cleverapps.EventEmitter.prototype), (WindowBoosterBefore.prototype.constructor = WindowBoosterBefore).prototype.onChangeAmount = function () {
            this.isDisabled() ? delete this.bonus : this.bonus = Lantern.GetBoosterBonus(this.level, this.booster), this.trigger("changeAmount")
        }, WindowBoosterBefore.prototype.getIcon = function () {
            return this.isDisabled() ? bundles.boosters_before.frames.booster_before_lock_png : this.booster.icon
        }, WindowBoosterBefore.prototype.getLevelAvailable = function () {
            return cleverapps.humanReadableNumber({
                floatLevel: this.booster.available.level
            })
        }, WindowBoosterBefore.prototype.getAmount = function () {
            return this.booster.getAmount()
        }, WindowBoosterBefore.prototype.getForce = function () {
            return this.booster.force
        },
            WindowBoosterBefore.prototype.getPrice = function () {
                return this.booster.getPrice().amount
            }, WindowBoosterBefore.prototype.setSelected = function (e) {
                this.selected !== e && (this.selected = e, this.trigger("update"))
            }, WindowBoosterBefore.prototype.onClick = function () {
                cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), !this.isLantern() && this.isActive() && (this.isAd() ? cleverapps.rewardedAdsManager.loadAndPlay({
                    type: RewardedAdsManager.REWARDED,
                    adLimit: this.booster.limit,
                    callback: function () {
                        cleverapps.adsLimits.watch(this.booster.limit), cleverapps.boosters.add(this.booster.id, 1), this.setSelected(!0)
                    }.bind(this)
                }) : this.isSelected() ? this.setSelected(!1) : (this.booster.canExecute() || this.booster.buy()) && this.setSelected(!0))
            }, WindowBoosterBefore.prototype.isSelected = function () {
                return this.selected
            }, WindowBoosterBefore.prototype.isActive = function () {
                return this.booster.isAvailable()
            }, WindowBoosterBefore.prototype.isDisabled = function () {
                return !this.booster.isAvailable() || this.booster.isUpcoming()
            }, WindowBoosterBefore.prototype.isUpcoming = function () {
                return this.booster.isUpcoming()
            }, WindowBoosterBefore.prototype.isAd = function () {
                return this.booster.isAdsAvailable() && this.getAmount() <= 0
            }, WindowBoosterBefore.prototype.isLantern = function () {
                return Lantern.GetBoosterBonus(this.level, this.booster) && !this.booster.isForceAvailable()
            }, WindowBoosterBefore.prototype.showTutorialStep = function (e) {
                this.booster.isForceAvailable() && this.isActive() ? (cleverapps.boosters.has(this.booster.id) || cleverapps.boosters.add(this.booster.id, 1), this.trigger("showForce", e)) : e()
            }, WindowBoosterBefore.prototype.onExit = function () {
                this.changeAmountListener && (this.changeAmountListener.clear(), delete this.changeAmountListener)
            },
            function (t) {
                this.level = t, this.list = cleverapps.boosters.listBoostersBefore().map(function (e) {
                    return new WindowBoosterBefore(e, t)
                })
            }),
        BoosterBeforeAmountView = (WindowBoostersBefore.prototype.listActivatedBoosters = function () {
            return this.list.filter(function (e) {
                return e.isSelected() || e.isLantern()
            }).map(function (e) {
                return e.booster
            })
        }, WindowBoostersBefore.prototype.showTutorialSteps = function () {
            var e = this.list.map(function (t) {
                return function (e) {
                    t.showTutorialStep(e)
                }
            });
            new ActionPlayer(e).play()
        }, WindowBoostersBefore.isAvailable = function (e) {
            return cleverapps.user.checkAvailable(WindowBoostersBefore.AVAILABLE, e) && 0 < cleverapps.boosters.listBoostersBefore().length
        }, WindowBoostersBefore.AVAILABLE = {
            level: .83
        }, "match3" === cleverapps.config.type && (WindowBoostersBefore.AVAILABLE = {
            level: 1.46
        }), cc.Node.extend({
            ctor: function (e) {
                this._super(), this.setAnchorPoint(.5, .5), this.setCascadeOpacityEnabled(!0), this.booster = e, this.bg = new cc.Sprite(bundles.boosters_before.frames.booster_before_purple_button_png), this.addChild(this.bg), this.booster.isDisabled() && this.booster.getAmount() > cleverapps.Boosters.INIT_AMOUNT && cleverapps.UI.convertToGrayScale(this.bg), this.amount = cleverapps.UI.generateImageText("", cleverapps.styles.FONTS.BOOSTER_BEFORE_AMOUNT_TEXT),
                    this.addChild(this.amount), this.icon = new cc.Sprite(bundles.boosters_before.frames.booster_before_check_icon_png), this.addChild(this.icon), this.update()
            },
            showActivated: function () {
                this.amount.visible = !1, this.icon.visible = !0, this.bg.setSpriteFrame(bundles.boosters_before.frames.booster_before_green_button_png), this.visible = !0
            },
            showAmount: function () {
                var e = cleverapps.styles.BoosterBeforeAmountView;
                this.amount.visible = !0, this.icon.visible = !1, this.bg.setSpriteFrame(bundles.boosters_before.frames.booster_before_purple_button_png), this.visible = !0, this.amount.setString(this.booster.getAmount()), this.amount.fitTo(e.amount.width)
            },
            update: function () {
                this.booster.isSelected() ? this.showActivated() : 0 < this.booster.getAmount() ? this.showAmount() : this.visible = !1;
                var e = cleverapps.styles.BoosterBeforeAmountView;
                this.setContentSize2(Math.max(this.bg.width * this.bg.scale, this.amount.width * this.amount.scale), Math.max(this.bg.height * this.bg.scale, this.amount.height * this.amount.scale)),
                    this.amount.setPositionRound(e.amount), this.bg.setPositionRound(this.width / 2, this.height / 2), this.icon.setPositionRound(e.icon)
            }
        })),
        BoosterBeforeBonusView = (cleverapps.styles.BoosterBeforeAmountView = {
            amount: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 4
                },
                width: 55
            },
            icon: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            }
        }, cc.Sprite.extend({
            ctor: function () {
                this._super(bundles.boosters_before.frames.booster_before_green_button_png), this.icon = new cc.Sprite(bundles.boosters_before.frames.booster_before_lantern_icon_png), this.icon.setPositionRound(this.width / 2, this.height / 2), this.addChild(this.icon)
            },
            lanternAnimation: function () {
                this.scale = 0, this.runAction(new cc.Sequence(new cc.DelayTime(1.1), new cc.ScaleTo(.2, 1, 1)))
            }
        })),
        BoosterBeforeView = cc.Scale9Sprite.extend({
            ctor: function (e, t) {
                this._super(bundles.boosters_before.frames.booster_before_bg_png), this.windowBooster = e, this.level = t;
                e = cleverapps.styles.BoosterBeforeView;
                this.setContentSize2(e), this.createIcon(), this.windowBooster.isUpcoming() && this.createUpcomingText(), this.windowBooster.isLantern() && ((t = new BoosterBeforeBonusView).setPositionRound(e.bonus), this.addChild(t), t.lanternAnimation()), this.windowBooster.isDisabled() || this.windowBooster.isLantern() || (this.amount = new BoosterBeforeAmountView(this.windowBooster), this.amount.setPositionRound(e.amount), this.addChild(this.amount), this.createPrice()), this.windowBooster.on("update", this.createListener(this.update.bind(this)), this), this.windowBooster.on("showForce", this.createListener(this.showForce.bind(this)), this), this.windowBooster.on("changeAmount", this.createListener(this.update.bind(this)), this), cleverapps.adsLimits.on("update", this.createListener(this.update.bind(this)), this), cleverapps.config.soft ? cleverapps.user.on("changeSoft", this.update.bind(this), this) : cleverapps.user.on("changeHard", this.update.bind(this), this), this.windowBooster.isDisabled() || this.windowBooster.isLantern() || (cleverapps.UI.applyHover(this), cleverapps.UI.onClick(this, this.onClick.bind(this))), this.update()
            },
            showUp: function (e) {
                this.setVisible(!1), this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.CallFunc(function () {
                    cleverapps.audio.playSound(bundles.boosters_before.urls.appear_sfx, {
                        throttle: 0
                    }), this.setScale(.5), this.setVisible(!0)
                }.bind(this)), new cc.ScaleTo(.4, 1, 1).easing(cc.easeBackOut(2))))
            },
            createPrice: function () {
                var e = cleverapps.styles.BoosterBeforeView.price,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2(e.content.width, e.content.height), this.price = new TextWithIcon("$$" + this.windowBooster.getPrice(), {
                        font: cleverapps.styles.FONTS.WHITE_TEXT
                    })),
                    i = this.ads = new TextWithIcon("## x1", {
                        font: cleverapps.styles.FONTS.WHITE_TEXT
                    }),
                    s = (t.addChild(s), s.setPosition(t.width / 2, t.height / 2), t.addChild(i), i.setPosition(t.width / 2, t.height / 2), this.priceButton = new cleverapps.UI.Button({
                        content: t,
                        width: e.width,
                        height: e.height,
                        type: cleverapps.styles.UI.Button.Images.small_button_green,
                        keepRadius: !0,
                        onClicked: this.onClick.bind(this)
                    }));
                this.addChild(s), s.setPositionRound(e)
            },
            createUpcomingText: function () {
                var e = cleverapps.styles.BoosterBeforeView,
                    t = bundles.boosters_before.frames.booster_before_level_bg,
                    t = (this.textAvailableBg = cleverapps.UI.createScale9Sprite(t, e.textAvailable.bg.rect), this.addChild(this.textAvailableBg), this.textAvailableBg.setContentSize2(e.textAvailable.bg), this.textAvailableBg.setPositionRound(e.textAvailable.bg), cleverapps.UI.generateOnlyText(Messages.get("UnlockOnLevel", {
                        level: this.windowBooster.getLevelAvailable()
                    }), cleverapps.styles.FONTS.BOOSTERS_BEFORE_UNLOCK || cleverapps.styles.FONTS.WINDOW_SMALL_TEXT));
                this.addChild(t, 1), t.setPositionRound(e.textAvailable), t.fitTo(e.textAvailable.width)
            },
            createIcon: function () {
                var e = cleverapps.styles.BoosterBeforeView,
                    e = (e.icon[this.windowBooster.id] || e.icon).dy;
                this.icon = new cc.Sprite(this.windowBooster.getIcon()), this.windowBooster.isUpcoming() ? this.icon.setOpacity(150) : this.icon.setOpacity(255), this.icon.setPositionRound(this.width / 2, this.height / 2 + e), this.addChild(this.icon)
            },
            onClick: function () {
                this.windowBooster.onClick(), this.icon.stopAllActions(), this.icon.setScale(.95), this.icon.runAction(new cc.ScaleTo(.15, 1).easing(cc.easeBackInOut()));
                var e = this.windowBooster.isSelected() ? bundles.main.urls.booster_before_cancel_effect : bundles.main.urls.booster_before_selection_effect;
                cleverapps.audio.playSound(e)
            },
            updateBackground: function () {
                var e = bundles.boosters_before.frames.booster_before_bg_png;
                this.windowBooster.isDisabled() ? e = bundles.boosters_before.frames.booster_before_bg_off_png : (this.windowBooster.isSelected() || this.windowBooster.isLantern()) && (e = bundles.boosters_before.frames.booster_before_bg_on_png), this.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(e))
            },
            updateIcon: function () {
                this.icon.setSpriteFrame(this.windowBooster.getIcon()), this.windowBooster.isUpcoming() ? this.icon.setOpacity(150) : this.icon.setOpacity(255)
            },
            update: function () {
                this.updateBackground(), this.amount && this.amount.update(), this.priceButton && (this.priceButton.setVisible(this.windowBooster.isActive() && this.windowBooster.getAmount() <= 0), this.price.setVisible(!this.windowBooster.isAd()), this.ads.setVisible(this.windowBooster.isAd())), this.windowBooster.isSelected() && Messages.has("BoosterBeforeUse_" + this.windowBooster.booster.id) && cleverapps.notification.create("BoosterBeforeUse_" + this.windowBooster.booster.id, {
                    image: this.windowBooster.booster.icon
                })
            },
            showForce: function (e) {
                var t = this.windowBooster.getForce();
                cleverapps.forces.isAvailable(this, t) ? (cleverapps.forces.create(this, t), cleverapps.forces.onceForceClosed = e, this.update()) : e()
            },
            onExit: function () {
                this.windowBooster.onExit()
            }
        }),
        BoostersBeforeComponent = (cleverapps.styles.BoosterBeforeView = {
            width: 186,
            height: 186,
            bonus: {
                x: {
                    align: "right",
                    dx: 18
                },
                y: {
                    align: "bottom",
                    dy: -18
                }
            },
            amount: {
                x: {
                    align: "right",
                    dx: 18
                },
                y: {
                    align: "bottom",
                    dy: -18
                }
            },
            price: {
                width: 160,
                height: 80,
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -40
                },
                content: {
                    width: 115,
                    height: 50
                }
            },
            textAvailable: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 8
                },
                width: 170,
                bg: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: -5
                    },
                    width: 190,
                    height: 55
                }
            },
            icon: {
                dy: 0
            }
        }, function (t) {
            var e, s = cleverapps.styles.BoostersBeforeComponent,
                i = cleverapps.UI.generateOnlyText("BoostersBeforeComponent.Title", cleverapps.styles.FONTS.WINDOW_BIG_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT),
                n = t.list.map(function (e) {
                    return new BoosterBeforeView(e, t.level)
                }),
                o = new cleverapps.Layout(n, {
                    padding: s.padding,
                    margin: s.margin,
                    direction: cleverapps.UI.HORIZONTAL
                }),
                n = (n.forEach(function (e, t) {
                    e.showUp(.2 + .2 * t)
                }), new cleverapps.Layout([i, o], {
                    margin: s.contentMargin,
                    direction: cleverapps.UI.VERTICAL
                })),
                i = t.list.some(function (e) {
                    return e.isLantern()
                }),
                o = Lantern.Get();
            return i && o && (e = new LanternView(o, n), n.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.CallFunc(function () {
                e.show()
            }), new cc.DelayTime(.2), new cc.CallFunc(function () {
                e.replaceParentSamePlace(cleverapps.windows.currentWindow()), e.setLocalZOrder(20)
            }), new cc.DelayTime(.6), new cc.CallFunc(function () {
                e.hide()
            })))), n
        }),
        BoostersBeforeHelper = (
            cleverapps.styles.BoostersBeforeComponent = {
                padding: {
                    bottom: 20
                },
                contentMargin: 50,
                margin: 25
            }, {
                animateAppear: function (e, t, s) {
                    var i, n;
                    s = cleverapps.once(s || function () { }), e && e.parent && t.target && t.target.parent ? (i = t.target, n = cleverapps.scenes.getRunningScene(), e.setPosition(e.getParent().convertToNodeSpace(i.getParent().convertToWorldSpace(i.getPosition()))), e.replaceParentSamePlace(n), e.setLocalZOrder(10), e.setScale(2), e.runAction(new cc.Sequence(new cc.ScaleTo(.5, t.scale).easing(cc.easeBackOut()), new cc.CallFunc(function () {
                        cleverapps.audio.playSound(bundles.main.urls.collect_coins_effect), !1 !== t.remove && e.parent && e.removeFromParent(!0)
                    }))), e.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.CallFunc(s))), BoostersBeforeHelper.animateStars(e)) : s()
                },
                animateStars: function (e) {
                    var t = new cleverapps.Spine(bundles.game.jsons.boosters_before_json);
                    t.setAnimation(0, "animation", !1), t.setPositionRound(e.x, e.y), e.parent.addChild(t), t.setLocalZOrder(e.getLocalZOrder() - 1), t.setTimeScale(1.3),
                        t.runAction(new cc.Sequence(new cc.DelayTime(1.3), new cc.RemoveSelf))
                }
            }),
        EyeBoosterView = cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.booster = e, this.boardView = t, this.board = this.boardView.board, this.setAnchorPoint2(), this.soundNode = new cc.Node, this.addChild(this.soundNode), this.booster.on("giveBonus", this.giveBonus.bind(this), this), cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL && (EyeBoosterView.ANIMATION_TIME_SCALE = .6, EyeBoosterView.SINGLE_PASS_TIME = 2.25)
            },
            giveBonus: function () {
                this.boardView.toggleElements(!1);
                var e = cleverapps.scenes.getRunningScene(),
                    t = new cleverapps.Spine(bundles.game.jsons.eye_booster_json);
                e.addChild(t), t.setLocalZOrder(110), t.setPositionRound(e.width / 2, e.height / 2), t.setAnimation(0, "show", !1), t.setCompleteListener(function () {
                    t.setAnimation(0, "activate", !1), t.setCompleteListenerRemove(), t.setTimeScale(EyeBoosterView.ANIMATION_TIME_SCALE);
                    var n = [];
                    this.boardView.placeholders.forEach(function (e, i) {
                        e.forEach(function (e, t) {
                            var s;
                            this.board.foundWordsSet[this.board.words[i]] || (s = this.boardView.createLetter(this.board.words[i][t].toUpperCase()), this.boardView.grid.addChild(s), s.updatePosition = function () {
                                s.setPositionRound(this.boardView.placeholders[i][t].x, this.boardView.placeholders[i][t].y + cleverapps.styles.BoardView.Letter.paddingBottom)
                            }.bind(this), s.updatePosition(), n.push(s))
                        }.bind(this))
                    }.bind(this)), n.sort(function (e, t) {
                        return e.x - t.x
                    }), this.soundNode.runAction(new cc.RepeatForever(new cc.Sequence(new cc.PlaySound(bundles.game.urls.eye_booster_effect), new cc.DelayTime(2.4)))), this.runPass(n, 0)
                }.bind(this)), cleverapps.audio.playSound(bundles.game.urls.eye_booster_start_effect)
            },
            runPass: function (e, i) {
                var t, n, o, a, r, c, l;
                i !== EyeBoosterView.PASSES_COUNT ? (t = cleverapps.styles.EyeBoosterView, n = t.MIN_OPACITY_OFFSET, o = t.MAX_OPACITY_OFFSET, a = e[0].x - n, r = e[e.length - 1].x + n, c = r - a, l = cleverapps.wait(e.length, this.runPass.bind(this, e, i + 1)), e.forEach(function (e) {
                    var t = i % 2 == 0 ? e.x : r - e.x,
                        s = (t - n - a) / c * EyeBoosterView.SINGLE_PASS_TIME,
                        t = (t - o - a) / c * EyeBoosterView.SINGLE_PASS_TIME - s;
                    e.setOpacity(0), e.runAction(new cc.Sequence(new cc.DelayTime(s), new cc.FadeIn(t), new cc.FadeOut(t), new cc.CallFunc(l)))
                })) : this.onAllPassesFinished(e)
            },
            onAllPassesFinished: function (e) {
                this.soundNode.stopAllActions(), e.forEach(function (e) {
                    e.removeFromParent()
                }), this.boardView.toggleElements(!0), this.boardView.showUpLettersAnimation(), this.boardView.showUpCoinsAnimation(), this.boardView.showUpStarsAnimation()
            }
        }),
        levels = (EyeBoosterView.ANIMATION_TIME_SCALE = .8, EyeBoosterView.SINGLE_PASS_TIME = 1.8, EyeBoosterView.PASSES_COUNT = 2, cleverapps.styles.EyeBoosterView = {
            MIN_OPACITY_OFFSET: 300,
            MAX_OPACITY_OFFSET: 100
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_COMBO] = {
            model: ComboBooster,
            price: {
                hard: 50
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.heroes_png,
            force: Forces.FIRST_BOOSTERS_BEFORE,
            available: {
                level: 1.73
            }
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_MOVES] = {
            model: MovesBooster,
            price: {
                hard: 100
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.moves_png,
            force: Forces.SECOND_BOOSTERS_BEFORE,
            available: {
                level: 2.4
            }
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_MULTICOLOR] = {
            model: MultiColorBooster,
            price: {
                hard: 150
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.multicolor_png,
            force: Forces.THIRD_BOOSTERS_BEFORE,
            available: {
                level: 2.93
            }
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_MAGNET] = {
            model: MagnetBooster,
            price: {
                hard: 50
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.magnet_png,
            force: Forces.FIRST_BOOSTERS_BEFORE,
            available: {
                level: 1.85
            }
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_DICE] = {
            model: DiceBooster,
            price: {
                hard: 100
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.dice_png,
            force: Forces.SECOND_BOOSTERS_BEFORE,
            available: {
                level: 2.4
            }
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_JOKERS] = {
            model: TwoJokersBooster,
            price: {
                hard: 150
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.joker_png,
            force: Forces.THIRD_BOOSTERS_BEFORE,
            available: {
                level: 2.93
            }
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_HIGHLIGHT] = {
            model: HighlightBooster,
            price: {
                hard: 50
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.highlight,
            force: Forces.FIRST_BOOSTERS_BEFORE,
            available: {
                level: 1.33
            }
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_EYE] = {
            model: EyeBooster,
            price: {
                hard: 100
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.eye,
            force: Forces.SECOND_BOOSTERS_BEFORE,
            available: {
                level: 2.4
            }
        }, cleverapps.Boosters.CONFIG[cleverapps.Boosters.TYPE_MAGNIFIER] = {
            model: MagnifierBooster,
            price: {
                hard: 150
            },
            limit: AdsLimits.TYPES.BOOSTERS_BEFORE,
            icon: bundles.reward_icons.frames.hint,
            force: Forces.THIRD_BOOSTERS_BEFORE,
            available: {
                level: 2.93
            }
        }, cleverapps.ServerFlags = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SERVER_FLAGS);
            this.flags = e || []
        },
            cleverapps.ServerFlags.prototype.reset = function () {
                this.flags = [], this.save()
            }, cleverapps.ServerFlags.prototype.hasFlag = function (e) {
                return 0 <= this.flags.indexOf(e)
            }, cleverapps.ServerFlags.prototype.setFlag = function (e) {
                this.hasFlag(e) || (this.flags.push(e), this.save())
            }, cleverapps.ServerFlags.prototype.clearFlag = function (e) {
                e = this.flags.indexOf(e); - 1 !== e && (this.flags.splice(e, 1), this.save())
            }, cleverapps.ServerFlags.prototype.getInfo = function () {
                return this.flags
            }, cleverapps.ServerFlags.prototype.updateInfo = function (e, t) {
                this.flags = e, this.save(t)
            }, cleverapps.ServerFlags.prototype.save = function (e) {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SERVER_FLAGS, this.flags), e || cleverapps.synchronizer.addUpdateTask("serverflags")
            }, cleverapps.ServerFlags.PAGE_LIKED = 2, cleverapps.ServerFlags.EXPEDITION_COMPENSATION = 5, {}),
        VersionChecker = (levels.User = function (e) {
            this.onLevelStatusChanged = function () { }, cleverapps.User.call(this, e), cleverapps.platform.on("userIdChanged", this.onUserIdChanged.bind(this))
        }, levels.User.prototype = Object.create(cleverapps.User.prototype), levels.User.prototype.constructor = levels.User, levels.User.prototype.getProgress = function () {
            return cleverapps.humanReadableNumber(this.episode, this.level) - 1
        }, levels.User.prototype.getVirtualProgress = function () {
            return cleverapps.humanReadableNumber(this.episode, this.level) + this.progress - 1
        }, levels.User.prototype.loadData = function (e) {
            cleverapps.User.prototype.loadData.call(this, e), this.episode = e.episode, this.level = e.level, this.league = this.calcLeague(), this.progress = e.progress || 0, e.uniqueStartEvent && (this.uniqueStartEvent = e.uniqueStartEvent), this.calcRating()
        }, levels.User.prototype.calcRating = function () {
            var e = this.calcLeague();
            this.league !== e && (this.league = e, this.isLeagueChanged = !0, this.onLeagueChangeListener()), this.save()
        }, levels.User.prototype.isUniqueStart = function (e, t, s) {
            e = e + "_" + t + "_" + s;
            return this.uniqueStartEvent !== e && (this.uniqueStartEvent = e, this.save(!1), !0)
        }, levels.User.prototype.getPassAllProgress = function () {
            return this.progress
        }, levels.User.prototype.isCurrentLevel = function (e, t) {
            if (cleverapps.meta.getType() !== Metha.HOSE) return !0;
            var s = this.getCurrentLevel();
            return s.levelNo === e && s.episodeNo === t
        }, levels.User.prototype.isPassedLevel = function (e, t) {
            return this.episode > t || this.episode === t && this.level > e
        }, levels.User.prototype.getHumanReadableNumber = function () {
            return cleverapps.humanReadableNumber(this.episode, this.level)
        }, levels.User.prototype.checkAvailable = function (e, t) {
            t = t || [];
            var s = cleverapps.config.name;
            if ((e = e || {})[s]) return this.checkAvailable(e[s], t);
            if (cleverapps.config.subtype && e[cleverapps.config.subtype]) return this.checkAvailable(e[cleverapps.config.subtype], t);
            var i = cleverapps.platform.source;
            return e[i] ? this.checkAvailable(e[i], t) : !(!cleverapps.config.debugMode && e.registeredDate && this.registered < new Date(e.registeredDate).getTime()) && (!(!cleverapps.config.debugMode && e.registered && this.registered + cleverapps.parseInterval(e.registered) > Date.now()) && (!e.disabled && (!(
                e.debugMode && !cleverapps.config.debugMode) && (e.level = e.level || 0, e.episode = e.episode || 0, (!e.projectName || (e.projectName = cleverapps.toArray(e.projectName), -1 !== e.projectName.indexOf(s))) && ((!e.types || -1 !== e.types.indexOf(cleverapps.config.type)) && ((!e.meta || -1 !== e.meta.indexOf(cleverapps.meta.getType())) && ((!e.source || (Array.isArray(e.source) || (e.source = [e.source]), -1 !== e.source.indexOf(i))) && ((!e.language || cleverapps.settings.language === e.language) && ((!e.payments || !cleverapps.flags.videoAdsMainMonetization) && (!(e.fogId && !Game.currentGame.fogs.isOpened(e.fogId)) && (!(e.paymentsCountry && cleverapps.paymentsCountry && PaymentsCountry.isApplicable() && cleverapps.paymentsCountry.getCode() !== e.paymentsCountry) && (!!t.ignoreProgress || (void 0 !== e.gameLevel ? cleverapps.gameLevel.level >= e.gameLevel : this.getFloatLevel() + .001 >= e.level)))))))))))))
        }, levels.User.prototype.getFloatLevel = function (e, t) {
            return void 0 === e && (e = this.episode), void 0 === t && (t = this.level), "merge" === cleverapps.config.type ? t + Math.min(1,
                cleverapps.expBySlots[CustomSyncers.SLOT_MAIN].getExp() / cleverapps.gameLevel.nextLevelThreshold(!0)) : "knockout" === cleverapps.config.regime ? 6 * (e + t / Episode.LEVELS_PER_EPISODE) : 2 * (e + t / Episode.LEVELS_PER_EPISODE)
        }, levels.User.prototype.parseFloatLevel = function (e) {
            for (var t = {
                episodeNo: 0,
                levelNo: 0
            }, s = 0, i = 0; ; ++s) {
                if ("merge" !== cleverapps.config.type && s >= Episode.LEVELS_PER_EPISODE && (s = 0, i += 1), this.getFloatLevel(i, s) > e) return t;
                t.episodeNo = i, t.levelNo = s
            }
        }, levels.User.prototype.sendLevelPassedEvents = function () {
            var e = [1, 3, 5],
                s = this.getDaysSinceRegistration(),
                i = this.getHumanReadableNumber();
            [50, 100, 200].forEach(function (t) {
                t + 1 === i && e.forEach(function (e) {
                    s < e && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.LEVEL_PASS_EVENT + "_" + t + "_" + e)
                }, this)
            }, this)
        }, levels.User.prototype.isPassedAll = function () {
            return cleverapps.isLevels() && this.episode >= cleverapps.episodes.getAmountEpisodes()
        }, levels.User.prototype.incLevel = function () {
            if (this.isPassedAll()) return this.progress++,
                "board" === cleverapps.config.type && (e = this.getCurrentLevel(), cleverapps.GameSaver.removeSave(cleverapps.GameSaver.getStoreSlot(e.episodeNo, e.levelNo))), this.trigger("incLevel"), this.calcRating(), void this.save();
            var e = this.level,
                t = this.episode;
            this.level++, this.level === Episode.LEVELS_PER_EPISODE && (this.level = 0, this.incEpisode()), this.trigger("incLevel"), this.calcRating(), this.save(), this.sendLevelPassedEvents(), this.onLevelStatusChanged(t, e), this.onLevelStatusChanged(this.episode, this.level), 1 === this.getHumanReadableNumber() && 0 === this.getDaysSinceRegistration() && this.reportRetention()
        }, levels.User.prototype.incEpisode = function () {
            this.episode++, this.calcRating(), this.save(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GENERAL.LEVEL_UP, {
                level: this.episode
            }), cleverapps.EVENTS.TARGET_FOR_BUYING["BASE_REACH_" + (this.episode + 3)] && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TARGET_FOR_BUYING["BASE_REACH_" + (this.episode + 3)]), 3 <= this.episode && cleverapps.eventLogger.logEvent(
                cleverapps.EVENTS.TARGET_FOR_BUYING.BASE_PLAY_WATCH)
        }, levels.User.prototype.getPhysicalLevel = function () {
            return this.getHumanReadableNumber()
        }, levels.User.prototype.getCurrentLevel = function () {
            return this.isPassedAll() ? Episode.LevelChooseAlgorithm({
                start: 5,
                seed: this.progress
            }) : {
                episodeNo: this.episode,
                levelNo: this.level
            }
        }, levels.User.prototype.getVirtualLevel = function () {
            return this.getHumanReadableNumber() + this.progress
        }, levels.User.prototype.getVirtualDisplayLevel = function () {
            return this.getVirtualLevel()
        }, levels.User.prototype.setLevel = function (e) {
            this.episode = Math.floor(e / 15), this.level = e % 15, this.progress = 0;
            var t = cleverapps.episodes.getAmountEpisodes();
            this.episode >= t && (this.episode = t, this.level = 0, this.progress = e - this.getHumanReadableNumber() + 1), this.save()
        }, levels.User.prototype.onUserIdChanged = function (e) {
            var t = e.oldId,
                e = e.newId,
                s = (delete this.idfa, this.save(!1), cleverapps.abTest.updateGroups(), cleverapps.isRumble() && cleverapps.meta.getRumble()),
                s = (s && s.changePlayerId(t, e),
                    Game.currentGame && Game.currentGame.competition);
            s && s.changePlayerId(t, e), cleverapps.userIdsHistory.add(t), this.updateIDFA()
        }, levels.User.prototype.getSaveInfo = function () {
            var e = cleverapps.User.prototype.getSaveInfo.call(this);
            return Object.assign(e, {
                episode: this.episode,
                level: this.level,
                uniqueStartEvent: this.uniqueStartEvent,
                progress: this.progress
            })
        }, levels.User.prototype.updateInfo = function (e) {
            delete e.source;
            var t, s = e.visited,
                i = (e.forcedVisited ? e.visited = e.forcedVisited : delete e.visited, e.exp);
            for (t in delete e.exp, cleverapps.expBySlots[CustomSyncers.SLOT_MAIN].load(i), e) this[t] = e[t];
            this.save(!1), s && !this.lastReportDAU && (this.lastReportDAU = this.getDaysSinceRegistration(s))
        }, levels.User.prototype.getInfo = function () {
            return {
                id: cleverapps.platform.getUserID(),
                gold: this.gold,
                soft: this.soft,
                registered: this.registered,
                visited: this.visited,
                source: cleverapps.platform.source,
                channel: this.channel,
                progressCompare: this.progressCompare,
                progress: this.progress,
                level: this.level,
                episode: this.episode,
                exp: cleverapps.expBySlots[CustomSyncers.SLOT_MAIN].getExp()
            }
        }, levels.User.prototype.initializeNewPlayer = function () {
            cleverapps.User.prototype.initializeNewPlayer.call(this), this.episode = 0, this.level = 0, this.progress = 0
        }, levels.User.GOLD_FB_CONNECT_REWARD = 100, function () {
            this.serverVersion = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SERVER_VERSION, {
                raw: !0
            }), this.clientVersion = void 0
        }),
        NewVersionWindow = (VersionChecker.prototype.check = function () {
            cleverapps.RestClient.get("/", {}, function (e) {
                this.serverVersion = e, cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SERVER_VERSION, e, {
                    raw: !0
                })
            }.bind(this), function () {
                console.log("Error getting server version in VersionChecker!")
            })
        }, VersionChecker.prototype.needUpdate = function () {
            return !!this.serverVersion && parseInt(cleverapps.config.version) < parseInt(this.serverVersion)
        }, VersionChecker.prototype.isNewClientVersionAvailable = function () {
            return this.clientVersion && this.clientVersion !== cleverapps.config.version
        },
            VersionChecker.prototype.isClientVersionActual = function () {
                return this.clientVersion && this.clientVersion === cleverapps.config.version
            }, VersionChecker.prototype.loadClientVersion = function (t) {
                if (t = t || function () { }, cc.sys.isNative || cleverapps.isLocalhost() || cleverapps.platform.oneOf(Instant, GDCom, Huzcom)) return this.clientVersion = cleverapps.config.version, void t();
                var e = cleverapps.config.staticUrl + "version.json";
                cleverapps.RestClient.get(e, {}, function (e) {
                    console.log("loaded current client version - " + e.version), this.clientVersion = e.version, t()
                }.bind(this), function () {
                    console.log("error loading client version from path - " + e), t()
                })
            }, levels.FPS = {
                run: function (e, t) {
                    levels.FPS.fpsInterval || (levels.FPS.episode = e, levels.FPS.level = t, levels.FPS.fpsStatistics = [], levels.FPS.fpsTotalFrames = cc.director.getTotalFrames(), levels.FPS.fpsInterval = setInterval(function () {
                        var e, t;
                        levels.FPS.fpsStatistics.length < levels.FPS.FPS_STATISTICS_MAX_LENGTH ? (e = cc.director.getTotalFrames(), t = Math.round(1e3 * (
                            e - levels.FPS.fpsTotalFrames) / levels.FPS.FPS_STATISTICS_INTERVAL), levels.FPS.fpsStatistics.push(t = 60 < t ? 60 : t), levels.FPS.fpsTotalFrames = e) : levels.FPS.stop()
                    }, levels.FPS.FPS_STATISTICS_INTERVAL))
                },
                stop: function () {
                    var e;
                    levels.FPS.fpsInterval && (clearInterval(levels.FPS.fpsInterval), levels.FPS.fpsInterval = !1), levels.FPS.fpsStatistics && levels.FPS.fpsStatistics.length && (levels.FPS.fpsStatistics.sort(), e = levels.FPS.fpsStatistics[Math.floor(levels.FPS.fpsStatistics.length * levels.FPS.FPS_STATISTICS_PERCENT_VALUE)], console.log("SAVE FPS: " + e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.LEVEL_FPS, {
                        episode: levels.FPS.episode,
                        level: levels.FPS.level,
                        fps: e
                    }), levels.FPS.fpsStatistics = !1)
                }
            }, levels.FPS.FPS_STATISTICS_MAX_LENGTH = 15, levels.FPS.FPS_STATISTICS_PERCENT_VALUE = .1, levels.FPS.FPS_STATISTICS_INTERVAL = 500, levels.FPS.FPS_SWITCH_TO_LOW = 40, Window.extend({
                onWindowLoaded: function () {
                    var e = cleverapps.styles.NewVersionWindow,
                        t = cleverapps.UI.generateOnlyText("NewVersionWindow.text1",
                            cleverapps.styles.FONTS.WINDOW_TEXT, {
                            version: cleverapps.versionChecker.serverVersion,
                            title: Messages.get(cleverapps.config.title)
                        }),
                        s = (t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(e.text.width, 0), t.setAnchorPoint2(), cleverapps.UI.generateOnlyText("NewVersionWindow.text2", cleverapps.styles.FONTS.WINDOW_TEXT)),
                        t = (s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.setDimensions(e.text.width, 0), s.setAnchorPoint2(), new cleverapps.Layout([t, s], {
                            direction: cleverapps.UI.VERTICAL,
                            padding: e.padding,
                            margin: e.margin
                        }));
                    t.setAnchorPoint2(), this._super({
                        title: "NewVersionWindow.Title",
                        name: "newversionwindow",
                        content: t,
                        button: {
                            text: "OK",
                            width: e.button.width,
                            height: e.button.height,
                            onPressed: function () {
                                cc.sys.openURL(cleverapps.platform.getGameUrl())
                            }
                        },
                        closeButton: !1
                    })
                },
                close: function () { }
            })),
        WaitWindow = (cleverapps.styles.NewVersionWindow = {
            text: {
                width: 550
            },
            button: {
                width: 220,
                height: 90
            },
            margin: 40
        }, "horizontal" === cleverapps.config.orientation && cleverapps.increaseStylesByKoef(
            cleverapps.styles.NewVersionWindow, 1.4), Window.extend({
                onWindowLoaded: function () {
                    var e = this.showLoading(),
                        t = (e.setCascadeOpacityEnabled(!0), e.setOpacity(0), e.setVisible(!1), cleverapps.styles.WaitWindow);
                    this._super({
                        name: "waitwindow",
                        noBackground: !0,
                        content: e,
                        closeButton: !1,
                        styles: t
                    }), e.runAction(new cc.Sequence(new cc.DelayTime(t.delay), new cc.CallFunc(function () {
                        e.setVisible(!0)
                    }), new cc.FadeTo(.3, 255))), this.oldEventNodes = cleverapps.meta.eventNodes, cleverapps.meta.setEventNodes([])
                },
                showLoading: function () {
                    var e, t = cleverapps.styles.WaitWindow,
                        s = new cleverapps.Spine(bundles.main.jsons.wait_json);
                    return s.setAnimation(0, "idle", !0), t.text && ((e = Messages.get("Loading") ? cleverapps.UI.generateOnlyText("Loading", cleverapps.styles.FONTS.WAIT_WINDOW_TEXT) : cleverapps.UI.__generateNotLocalizedText("Loading", cleverapps.styles.FONTS.WAIT_WINDOW_TEXT)).setPositionRound(t.text), s.addChild(e, 1)), s
                },
                closeByBackButton: function () { },
                popUpAnimation: function () { },
                closeAnimation: function (e) {
                    e()
                },
                onClose: function () {
                    this.isRunning() && cleverapps.meta.setEventNodes(this.oldEventNodes)
                }
            })),
        TacticalExtendWindow = (WaitWindow.show = function () {
            this.instance ? this.counter += 1 : (this.instance = new WaitWindow, this.counter = 1)
        }, WaitWindow.hide = function () {
            --this.counter, 0 === this.counter && (this.instance.close(), this.instance = void 0)
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            WAIT_WINDOW_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.WINDOW_WHITE_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.WHITE_TEXT_SHADOW
            }
        }), cleverapps.styles.WaitWindow = {
            delay: .2,
            text: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            }
        }, Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.TacticalExtendWindow,
                    t = this.createAnimation(),
                    s = this.createText(),
                    s = new cleverapps.Layout([s, t], {
                        margin: e.margin,
                        direction: cleverapps.UI.VERTICAL
                    });
                this._super({
                    title: "TacticalExtendWindow.title",
                    name: "tacticalextendwindow",
                    content: s,
                    button: {
                        width: e.button.width,
                        height: e.button.height,
                        text: "$$" + TacticalExtendWindow.PRICE,
                        onPressed: this.onPressed.bind(this)
                    }
                })
            },
            getPerson: function () {
                return "hero"
            },
            createText: function () {
                var e = cleverapps.styles.TacticalExtendWindow,
                    t = cleverapps.UI.generateOnlyText("TacticalExtendWindow.text", cleverapps.styles.FONTS.WINDOW_TEXT, {
                        amount: TacticalExtendWindow.AMOUNT
                    });
                return t.setDimensions(e.text.width, 0), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), t
            },
            createAnimation: function () {
                var e = cleverapps.styles.TacticalExtendWindow,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2(e.animation), new cleverapps.Spine(bundles.tactical_extend_window.jsons.tactical_extend));
                return s.setSkin(cleverapps.config.name), s.setAnimation(0, "addmoves", !0), t.addChild(s), s.setPositionRound(e.animation), t
            },
            onPressed: function () {
                Game.currentGame ? cleverapps.user.spendHard(cleverapps.EVENTS.SPENT.TACTICAL_EXTEND, TacticalExtendWindow.PRICE) && (this.giveMoves(), this.close()) : this.close()
            },
            giveMoves: function () {
                var e = cleverapps.UI.generateImageText(TacticalExtendWindow.AMOUNT, cleverapps.styles.FONTS.MOVES_TEXT);
                e.setPositionRound(this.buttons), this.buttons.parent.addChild(e), e.runAction(new cc.Sequence(new cc.PlaySound(bundles.main.urls.shop_buy_effect), cleverapps.UI.animateCollect(e, "moves", {
                    duration: .7,
                    scale: 1.5,
                    collectEffect: !0
                }), new cc.RemoveSelf)), Game.currentGame.counter.setTimeout(function () {
                    Game.currentGame.setMoves(Game.currentGame.moves + TacticalExtendWindow.AMOUNT)
                }, 700)
            },
            listBundles: function () {
                var e = ["tactical_extend_window"];
                return cleverapps.config.rpg && e.push("dialogues"), e
            }
        })),
        FinisherWindow = (TacticalExtendWindow.canShow = function () {
            if (!cleverapps.user.checkAvailable(TacticalExtendWindow.AVAILABLE)) return !1;
            if (!levels.user.canTakeHard(TacticalExtendWindow.PRICE)) return !1;
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.BUY_MOVES_WINDOW) || 0;
            return Date.now() - e > cleverapps.parseInterval(TacticalExtendWindow.INTERVAL) && Math.random() < TacticalExtendWindow.PROBABILITY
        }, TacticalExtendWindow.show = function () {
            return cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.BUY_MOVES_WINDOW, Date.now()), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TACTICAL_EXTEND_SHOW), new TacticalExtendWindow
        }, TacticalExtendWindow.PROBABILITY = .12, TacticalExtendWindow.PRICE = 50, TacticalExtendWindow.AMOUNT = 3, TacticalExtendWindow.INTERVAL = "1 hour", cleverapps.config.debugMode && (TacticalExtendWindow.INTERVAL = "1 minute"), TacticalExtendWindow.AVAILABLE = {
            level: 1.2
        }, "merge" === cleverapps.config.type && (TacticalExtendWindow.AVAILABLE = {
            disabled: !0
        }), cleverapps.styles.TacticalExtendWindow = {
            margin: 30,
            text: {
                width: 500
            },
            animation: {
                width: 300,
                height: 300,
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            button: {
                width: 320,
                height: 120
            }
        }, Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.FinisherWindow;
                this._super({
                    title: "FinisherWindow.title",
                    name: "finisherwindow",
                    content: this.generateContent(),
                    fireworks: !0,
                    button: {
                        width: e.button.width,
                        height: e.button.height,
                        text: "FinisherWindow.Button.text",
                        onPressed: function () {
                            cleverapps.platform.showOfficialPage()
                        }
                    },
                    openSound: bundles.finisher_window.urls.finisher_effect
                })
            },
            generateStoreButton: function (e) {
                var t = {
                    android: bundles.finisher_window.urls.android_png,
                    ios: bundles.finisher_window.urls.ios_png,
                    amazon: bundles.finisher_window.urls.amazon_png
                }[e],
                    s = cleverapps.platform.getGameUrl(e);
                if (s && t) return e = new cc.Sprite(t), cleverapps.UI.applyHover(e), cleverapps.UI.onClick(e, function () {
                    cc.sys.openURL(s)
                }), e
            },
            generateContent: function () {
                var e, t = cleverapps.styles.FinisherWindow,
                    s = [];
                return s.push(this.createText("FinisherWindow.GroupText")), cc.sys.isNative || cleverapps.platform.oneOf(Instant) || cleverapps.platform.oneOf(MobileOK, OKPlatform, MobileVk, VKPlatform, MyMailRu, MobileMyMailRu) ? ((e = this.generateStoreButton(cleverapps.platform.source)) && s.push(e), s.push(this.createText("FinisherWindow.AllAndStoreText"))) : (0 < (e = ["android", "ios", "amazon"].map(this.generateStoreButton).filter(function (e) {
                    return void 0 !== e
                })).length && (s.push(this.createButtonsLayout(e.slice(0, 2))), s.push(this.createText("FinisherWindow.StoreText"))), s.push(this.createText("FinisherWindow.AllPassedText"))), new cleverapps.Layout(s, {
                    direction: cleverapps.UI.VERTICAL,
                    margin: t.margin
                })
            },
            createText: function (e) {
                var t = cleverapps.styles.FinisherWindow,
                    e = cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);
                return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e.setDimensions(t.text.width, 0), e
            },
            createButtonsLayout: function (e) {
                var t = cleverapps.styles.FinisherWindow;
                return new cleverapps.Layout(e, {
                    padding: t.button.padding,
                    margin: t.button.margin,
                    direction: cleverapps.UI.HORIZONTAL
                })
            },
            listBundles: function () {
                return ["finisher_window"]
            }
        })),
        Lantern = (cleverapps.styles.FinisherWindow = {
            margin: 10,
            text: {
                width: 550
            },
            button: {
                padding: {
                    x: 0,
                    y: 10
                },
                margin: 30,
                width: 460,
                height: 100
            }
        }, levels.GameHints = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LEVEL_HINTS);
            this.usedHints = "number" == typeof e ? e : 0
        }, levels.GameHints.prototype.reset = function () {
            this.isCurrentLevel() && (this.usedHints = 0, this.save())
        }, levels.GameHints.prototype.isCurrentLevel = function () {
            return Game.currentGame && Game.currentGame.level.isCurrentLevel()
        }, levels.GameHints.prototype.addHint = function () {
            this.isCurrentLevel() && (this.usedHints++, this.save())
        }, levels.GameHints.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LEVEL_HINTS, this.usedHints)
        }, function (e) {
            this.mission = e, this.load()
        }),
        LanternView = (Lantern.prototype.isActive = function (e) {
            return e ? e.isCurrentLevel() : levels.user.isCurrentLevel(cleverapps.environment.levelNo, cleverapps.environment.episodeNo)
        }, Lantern.getMaxStreak = function () {
            return 3
        }, Lantern.prototype.save = function () {
            this.mission.result = 0, this.mission.update(this.streak)
        }, Lantern.prototype.load = function () {
            this.streak = this.mission.result, this.savedStreak = this.streak
        }, Lantern.prototype.getCurrentStreak = function () {
            return this.savedStreak
        },
            Lantern.prototype.restoreSavedStreak = function () {
                this.streak = this.savedStreak, this.save()
            }, Lantern.prototype.onStart = function () {
                this.savedStreak = this.streak, this.streak = 0, this.save()
            }, Lantern.prototype.onWin = function () {
                this.streak = Math.min(this.savedStreak + 1, Lantern.getMaxStreak()), this.savedStreak = this.streak, this.save()
            }, Lantern.prototype.onLose = function () {
                this.streak = 0, this.savedStreak = 0, this.save()
            }, Lantern.Get = function () {
                var e = cleverapps.missionManager.findRunningMission(Mission.TYPE_LANTERN);
                return e && e.logic.lantern
            }, Lantern.IsActive = function (e) {
                var t = Lantern.Get();
                return t && t.isActive(e)
            }, Lantern.GetStreak = function (e) {
                var t = Lantern.Get();
                return t && t.isActive(e) && 0 < t.streak ? t.streak : 0
            }, Lantern.GetBoosterBonus = function (e, t) {
                var s = Lantern.Get(),
                    t = cleverapps.boosters.listBoostersBefore().indexOf(t);
                return s && s.isActive(e) && s.getCurrentStreak() > t ? 1 : 0
            }, cc.Node.extend({
                ctor: function (e, t) {
                    this._super(), this.lantern = e, this.setAnchorPoint2(), this.setLocalZOrder(2),
                        this.styles = cleverapps.styles.LanternView, this.animation = new cleverapps.Spine(bundles.lantern.jsons.lantern_json), this.addChild(this.animation), this.setContentSize2(this.animation.getContentSize()), this.animation.setPositionRound(this.width / 2, this.height / 2), (t = t || cleverapps.scenes.getRunningScene().fieldView).addChild(this)
                },
                show: function () {
                    this.animation.setAnimation(0, "idle_" + this.lantern.getCurrentStreak(), !0);
                    var e = this.getParent().convertToNodeSpace(cc.p(-this.width, 0)),
                        t = (e.x || (e.x = 0), e.y = this.styles.show.y, 1 / this.parent.scale),
                        s = this.styles.offset.x * (t < 1 ? t : 1),
                        t = this.styles.offset.y * (t < 1 ? t : 1),
                        s = cc.p(this.parent.width / 2 + s, this.parent.height / 2 + t);
                    this.setPositionRound(e), "heroes" === cleverapps.config.name ? this.runAction(new cc.MoveTo(.5, s)) : (this.setRotation(45), this.runAction(new cc.Spawn(new cc.MoveTo(.5, s), new cc.RotateTo(.5, 0)))), cleverapps.audio.playSound(bundles.lantern.urls.lanternshow_effect)
                },
                hide: function () {
                    var t = this.getParent().convertToNodeSpace(cc.p(-this.width, 0));
                    t.y = this.styles.hide.y, this.animation.setAnimation(0, "out_" + this.lantern.getCurrentStreak(), !1), this.animation.setCompleteListener(function () {
                        this.animation.setAnimation(0, "idle_" + this.lantern.getCurrentStreak(), !0);
                        var e = new cc.Spawn(new cc.MoveTo(.5, t), new cc.RotateTo(.4, -45));
                        "heroes" === cleverapps.config.name && (e = new cc.MoveTo(.5, t)), this.runAction(new cc.Sequence(e, new cc.RemoveSelf))
                    }.bind(this)), cleverapps.audio.playSound(bundles.lantern.urls.lanternhide_effect)
                }
            })),
        FriendSorter = (cleverapps.styles.LanternView = {
            offset: {
                x: 0,
                y: 150
            },
            show: {
                y: 100
            },
            hide: {
                y: 1e3
            }
        }, function () {
            this.data = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SORTER), this.data || (this.data = {}), cleverapps.config.debugMode && (FriendSorter.PRIVACY_INTERVAL = "1 minute"), this.update()
        }),
        SelectFriendWindow = (FriendSorter.PRIVACY_INTERVAL = "1 day", FriendSorter.prototype.update = function () {
            var e, t = {},
                s = Date.now(),
                i = !1;
            for (e in this.data) this.data[e] + cleverapps.parseInterval(FriendSorter.PRIVACY_INTERVAL) > s ? t[e] = this.data[e] : i = !0;
            i && (this.data = t, this.save())
        }, FriendSorter.prototype.save = function () {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SORTER, this.data)
        }, FriendSorter.prototype.canUse = function (e) {
            return void 0 === this.data[e]
        }, FriendSorter.prototype.markUsed = function (e) {
            e.forEach(function (e) {
                this.data[e] = Date.now()
            }, this), this.save()
        }, FriendSorter.prototype.listActiveFriends = function () {
            return cleverapps.friends.listFriends()
        }, FriendSorter.prototype.listInactiveFriends = function () {
            var e = cleverapps.invitalbleFriends.listFriends();
            return this.update(), e = e.filter(function (e) {
                return e && void 0 === this.data[e.id]
            }, this)
        }, Window.extend({
            onWindowLoaded: function (e, t) {
                var s = new cc.Node,
                    i = (s.setAnchorPoint(.5, .5), this.content = s, this.type = e, cleverapps.config.debugMode && (SelectFriendWindow.PROCESS_PERIOD = "300 second"), cleverapps.friends.listFriends().concat(cleverapps.invitalbleFriends.listFriends()));
                i.length ? this.generateFriendsContent(i, t) : this.generateNoFriendsContent(), this._super({
                    title: SelectFriendWindow.ByType[this.type].title,
                    name: "selectfriendwindow" + e,
                    content: s,
                    styles: cleverapps.styles.SelectFriendWindow.window
                })
            },
            addCheck: function (e, t) {
                var s = new cc.Sprite(bundles.checkbox.frames.check_mark_png);
                t && cleverapps.UI.convertToGrayScale(s), s.setPosition(e.width / 2, e.height / 2), e.check = s, e.addChild(s)
            },
            checkElementByFriendId: function (e, t) {
                var s = this.selectedElements.friends.indexOf(e); - 1 !== s ? (this.selectedElements.data[e].checked = !1, this.selectedElements.data[e].check.removeFromParent(), this.selectedElements.data[e] = void 0, this.selectedElements.friends.splice(s, 1)) : (this.addCheck(t), t.checked = !0, this.selectedElements.data[e] = t, this.selectedElements.friends.push(e), this.selectedElements.friends.length > SelectFriendWindow.MAX_SELECTED && this.checkElementByFriendId(this.selectedElements.friends[0])), this.updateSelectedContent()
            },
            generateCheckbox: function (e, t) {
                var s = cleverapps.styles.SelectFriendWindow.withFriends.friendContainer.checkBox;
                if (!this.processTimeData)
                    for (
                        var i in this.processTimeData = cleverapps.DataLoader.load(SelectFriendWindow.ByType[this.type].dataLoaderType()), this.processTimeData || (this.processTimeData = {}), this.processTimeData) this.processTimeData[i] < Date.now() - cleverapps.parseInterval(SelectFriendWindow.PROCESS_PERIOD) && (this.processTimeData[i] = void 0);
                var n, o, a, r, c = function () {
                    cleverapps.UI.onClick(t, function () {
                        this.checkElementByFriendId(e.id, l)
                    }.bind(this), {
                        ignoreScale: !0
                    }), cleverapps.UI.applyHover(t, {
                        onMouseOver: function () {
                            t.bg && t.bg.setColor(cleverapps.styles.COLORS.HOVER), l.setScale(1.1)
                        },
                        onMouseOut: function () {
                            t.bg && t.bg.setColor(cleverapps.styles.COLORS.WHITE), l.setScale(1)
                        }
                    })
                }.bind(this),
                    l = this.generateCheckBoxBg();
                if ((l.setPositionRound(s.x, t.height / 2 + cleverapps.styles.SelectFriendWindow.Avatar.y), t.fullData = {
                    checkBox: l,
                    id: e.id
                }, t.addChild(l), this.processTimeData) && (this.processTimeData[e.id] && this.processTimeData[e.id] > Date.now() - cleverapps.parseInterval(SelectFriendWindow.PROCESS_PERIOD))) return n = {
                    showHours: !0,
                    font: cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,
                    imageFont: !1
                }, console.log("disabled", t), o = this.processTimeData[e.id] + cleverapps.parseInterval(SelectFriendWindow.PROCESS_PERIOD) - Date.now(), a = new cleverapps.CountDownView(new cleverapps.CountDown(o), n), r = function () {
                    a.refresh(), a.removeFromParent(), t.name.setVisible(!0), t.avatar.setOpacity(255), l.setOpacity(255), t.coinsIcon && t.coinsIcon.setOpacity(255), l.check.removeFromParent(), t.notActive = !1, c()
                }, a.onEnter = function () {
                    cleverapps.CountDownView.prototype.onEnter.call(this), a.countDown.onFinish = a.createListener(r)
                }, a.setPosition(t.width / 2, s.timer.y), t.addChild(a), t.name.setVisible(!1), this.addCheck(l, !0), l.setOpacity(150), t.avatar.setOpacity(120), t.notActive = !0, void (t.coinsIcon && t.coinsIcon.setOpacity(150));
                t.notActive = !1, c()
            },
            generateCheckBoxBg: function () {
                var e = new cc.Sprite(bundles.checkbox.frames.background_png);
                return e.setAnchorPoint(.5, .5), e.setCascadeOpacityEnabled(!0), e
            },
            generateFriendContent: function (e) {
                var t = cleverapps.styles.SelectFriendWindow.withFriends.friendContainer,
                    s = new cc.Node,
                    i = (s.setAnchorPoint(.5, .5), s.setContentSize(t.width, t.height), bundles.select_friend_window.frames.friend_bg_png && ((i = cleverapps.UI.createScale9Sprite(bundles.select_friend_window.frames.friend_bg_png)).setAnchorPoint(.5, .5), i.setContentSize(t.width, t.height), i.setPosition(s.width / 2, s.height / 2), s.addChild(i), s.bg = i), new cleverapps.UI.Avatar(e)),
                    i = (i.setPositionRound(cleverapps.styles.SelectFriendWindow.Avatar.x, s.height / 2 + cleverapps.styles.SelectFriendWindow.Avatar.y), i.setAnchorPoint2(), (s.avatar = i).setCascadeOpacityEnabled(!0), s.addChild(i), cleverapps.UI.generateTTFText(e.name, cleverapps.styles.FONTS.WINDOW_SMALL_TEXT));
                return i.setDimensions(t.Name.width, t.Name.height), i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), i.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP), s.addChild(i), i.setPositionRound(s.width / 2, t.Name.y), s.name = i, this.generateCheckbox(e, s), s
            },
            generateFriendsContent: function (e, t) {
                this.selectedElements = {
                    friends: [],
                    data: {}
                };
                var s = cleverapps.styles.SelectFriendWindow.withFriends,
                    i = (this.content.setContentSize(s.width, s.height), new cleverapps.UI.Button({
                        text: SelectFriendWindow.ByType[this.type].button,
                        width: s.Button.width,
                        height: s.Button.height,
                        onClicked: function () {
                            this.selectedElements.friends.length && (this.close(), t(this.selectedElements.friends, function () {
                                if (this.processTimeData) {
                                    for (var e = 0; e < this.selectedElements.friends.length; e++) this.processTimeData[this.selectedElements.friends[e]] = Date.now();
                                    cleverapps.DataLoader.save(SelectFriendWindow.ByType[this.type].dataLoaderType(), this.processTimeData)
                                }
                            }.bind(this)))
                        }.bind(this)
                    })),
                    i = (i.setPositionRound(this.content.width / 2 + s.Button.x, s.Button.y), this.button = i, this.content.addChild(i), new cc.Node),
                    n = (i.setAnchorPoint(0, .5), i.setPositionRound(s.SelectedBlock.x, s.SelectedBlock.y), this.generateCheckBoxBg()),
                    o = (n.setAnchorPoint(0, .5), n.setPositionRound(0, n.height / 2), i.addChild(n), cleverapps.UI.generateTTFText(
                        "Selected", cleverapps.styles.FONTS.WINDOW_TEXT)),
                    a = (o.fitTo(s.selectedText.width), o.setPositionRound(n.width + s.SelectedBlock.margin.x, n.y + o.height / 2), o.setAnchorPoint(0, .5), i.addChild(o), cleverapps.UI.generateTTFText("", cleverapps.styles.FONTS.WINDOW_TEXT)),
                    r = (a.setAnchorPoint(.5, .5), this.selectedAmountText = a, i.addChild(a), this.updateSelectedContent(), a.setPositionRound(o.x + o.width / 2, n.y - a.height / 2), i.setContentSize(n.width + o.width + s.SelectedBlock.margin.x, n.height), this.content.addChild(i), cleverapps.UI.applyHover(i, {
                        onMouseOver: function () {
                            n.setScale(1.1)
                        },
                        onMouseOut: function () {
                            n.setScale(1)
                        }
                    }), cleverapps.UI.onClick(i, function () {
                        this.switchSelectAll(n)
                    }.bind(this)), new cc.Node);
                this.friendContainers = e.map(function (e, t) {
                    return {
                        container: this.generateFriendContent(e),
                        order: t
                    }
                }, this), levels.friendSorter.update(), this.friendContainers.sort(function (e, t) {
                    return e.container.notActive !== t.container.notActive ? e.container.notActive ? 1 : -1 : levels.friendSorter.canUse(e.container.fullData.id) !== levels.friendSorter.canUse(t.container.fullData.id) ? levels.friendSorter.canUse(e.container.fullData.id) ? -1 : 1 : e.order - t.order
                }), this.friendContainers.length > SelectFriendWindow.MAX_ROWS_AMOUNT * SelectFriendWindow.IN_ROW && (this.friendContainers = this.friendContainers.slice(0, SelectFriendWindow.MAX_ROWS_AMOUNT * SelectFriendWindow.IN_ROW));
                for (var c = 0; c < this.friendContainers.length; c++) r.addChild(this.friendContainers[c].container), this.friendContainers[c].container.setPositionRound(c % SelectFriendWindow.IN_ROW * (s.friendContainer.margin + s.friendContainer.width) + s.friendContainer.width / 2, r.height - Math.floor(c / SelectFriendWindow.IN_ROW) * (s.friendContainer.margin + s.friendContainer.height) - s.friendContainer.height / 2);
                r = cleverapps.UI.wrap(r), this.friendsContainer = new cleverapps.UI.ScrollView(r), this.friendsContainer.setContentSize(r.width + cleverapps.styles.SelectFriendWindow.scroll.margin.mx[0], s.friendsContainer.height), this.friendsContainer.setAnchorPoint(.5, 0),
                    this.friendsContainer.setPositionRound(this.content.width / 2, s.friendsContainer.y), cc.sys.isNative || this.switchSelectAll(n), this.content.addChild(this.friendsContainer)
            },
            switchSelectAll: function (e) {
                if (e.selected) {
                    e.selected = !1, e.check.removeFromParent();
                    for (var t = this.selectedElements.friends.length - 1; 0 <= t; t--) this.checkElementByFriendId(this.selectedElements.friends[t])
                } else {
                    for (var s = !1, i = 0; i < this.friendContainers.length; i++) {
                        var n = this.friendContainers[i].container,
                            o = n.fullData;
                        this.selectedElements.friends.length < SelectFriendWindow.MAX_SELECTED && !n.notActive && !o.checkBox.checked && (this.checkElementByFriendId(o.id, o.checkBox), s = !0)
                    }
                    s && (e.selected = !0, this.addCheck(e))
                }
            },
            updateSelectedContent: function () {
                this.selectedAmountText.setString(this.selectedElements.friends.length + "/" + SelectFriendWindow.MAX_SELECTED), this.selectedElements.friends.length ? this.button.enable() : this.button.disable()
            },
            generateNoFriendsContent: function () {
                var e = cleverapps.styles.SelectFriendWindow.noFriends,
                    t = (
                        this.content.setContentSize(e.width, e.height), cleverapps.UI.generateTTFText(SelectFriendWindow.ByType[this.type].noFriends, cleverapps.styles.FONTS.WINDOW_TEXT)),
                    t = (t.setPositionRound(this.content.width / 2, e.Text.y), t.setDimensions(e.Text.width, 0), t.fitTo(void 0, e.Text.height), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.content.addChild(t), new cleverapps.UI.Button({
                        text: "SettingsWindow.InviteFriends",
                        width: e.Button.width,
                        height: e.Button.height,
                        onClicked: function () {
                            cleverapps.platform.inviteFriends(this.createListener(this.close.bind(this)))
                        }.bind(this)
                    }));
                t.setPositionRound(this.content.width / 2, e.Button.y), this.content.addChild(t)
            }
        })),
        FakeRequestSender = (SelectFriendWindow.ByType = {
            askLives: {
                title: "SelectFriendWindow.askLives.title",
                button: "Ask",
                noFriends: "SelectFriendWindow.askLives.noFriendsText",
                dataLoaderType: function () {
                    return cleverapps.DataLoaderTypes.ASKED_LIVES
                }
            },
            askStars: {
                title: "SelectFriendWindow.askStars.title",
                button: "Ask",
                noFriends: "SelectFriendWindow.askStars.noFriendsText",
                dataLoaderType: function () {
                    return cleverapps.DataLoaderTypes.ASKED_STARS
                }
            }
        }, SelectFriendWindow.PROCESS_PERIOD = "1 day", SelectFriendWindow.MAX_SELECTED = 10, SelectFriendWindow.MAX_ROWS_AMOUNT = 10, SelectFriendWindow.IN_ROW = 3, cleverapps.styles.SelectFriendWindow = {
            Avatar: {
                x: 140,
                y: 20
            },
            scroll: {
                margin: {
                    mx: [30]
                }
            },
            withFriends: {
                width: 670,
                height: 750,
                selectedText: {
                    width: 250
                },
                friendsContainer: {
                    height: 580,
                    y: 175
                },
                friendContainer: {
                    height: 180,
                    width: 210,
                    margin: 20,
                    Name: {
                        width: 200,
                        height: 40,
                        y: 24
                    },
                    checkBox: {
                        x: 42,
                        timer: {
                            y: 24,
                            height: 20
                        }
                    }
                },
                Button: {
                    width: 300,
                    height: 120,
                    y: 75,
                    x: 190,
                    margin: 10
                },
                SelectedBlock: {
                    y: 75,
                    x: 0,
                    margin: {
                        x: 20
                    }
                }
            },
            noFriends: {
                width: 550,
                height: 500,
                Text: {
                    y: 300,
                    width: 550,
                    height: 250
                },
                Button: {
                    width: 450,
                    height: 120,
                    y: 60
                }
            }
        }, levels.FriendRequests = function () {
            this.load(), this.lastServerReload = 0, this.onNewListener = function () { }, this.onChangeListener = function () { }, cleverapps.flags.norequest && this.deleteFakeRequests(), this.serverReload(),
                FakeRequestSender.sendIfNeed(this), setInterval(function () {
                    this.serverReload(), FakeRequestSender.sendIfNeed(this)
                }.bind(this), cleverapps.parseInterval("1 minute"))
        }, levels.FriendRequests.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.FRIEND_REQUESTS);
            if (e) {
                this.notProcessed = [];
                var t = this.listAvailableTypes();
                e.notProcessed = e.notProcessed.filter(function (e) {
                    return -1 !== t.indexOf(e.type)
                });
                for (var s = 0; s < e.notProcessed.length; s++) this.notProcessed.push(levels.FriendRequest.createFriendRequest(e.notProcessed[s]));
                this.processedIds = e.processedIds
            } else this.notProcessed = [], this.processedIds = []
        }, levels.FriendRequests.prototype.save = function () {
            for (var e = [], t = 0; t < this.notProcessed.length; t++) e.push(this.notProcessed[t].getData());
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.FRIEND_REQUESTS, {
                notProcessed: e,
                processedIds: this.processedIds
            })
        }, levels.FriendRequests.prototype.idInNotProcessed = function (e) {
            for (var t = 0; t < this.notProcessed.length; t++)
                if (
                    this.notProcessed[t].getId() === e) return !0;
            return !1
        }, levels.FriendRequests.prototype.lastNotProcessedId = function () {
            for (var e = this.notProcessed.length - 1; 0 <= e; e--)
                if (this.notProcessed[e].canView()) return this.notProcessed[e].id;
            return !1
        }, levels.FriendRequests.prototype.existNotProcessed = function () {
            for (var e = 0; e < this.notProcessed.length; e++)
                if (this.notProcessed[e].canView()) return !0;
            return !1
        }, levels.FriendRequests.prototype.existRequestFrom = function (e) {
            for (var t = 0; t < this.notProcessed.length; t++)
                if (this.notProcessed[t].canView() && this.notProcessed[t].from === e) return !0;
            return !1
        }, levels.FriendRequests.prototype.existRequestTypes = function (e) {
            for (var t = 0; t < this.notProcessed.length; t++)
                if (0 <= e.indexOf(this.notProcessed[t].type)) return !0;
            return !1
        }, levels.FriendRequests.prototype.processById = function (e) {
            for (var t = !1, s = !1, i = 0; i < this.notProcessed.length; i++)
                if (this.notProcessed[i].getId() === e) {
                    this.notProcessed[i].onServer() && (s = !0), this.notProcessed.splice(i, 1), t = !0;
                    break
                } s && (
                    this.processedIds.push(e), this.deleteOnServerById(e)), t && this.onChangeListener(), this.save()
        }, levels.FriendRequests.prototype.onServerLoad = function (e) {
            var t = [],
                s = !1,
                i = this.listAvailableTypes();
            Array.isArray(e) || (cleverapps.throwAsync("FriendRequests.onServerLoad data type is - " + typeof e), e = []), e = e.filter(function (e) {
                return -1 !== i.indexOf(e.type)
            });
            for (var n = 0; n < e.length; n++) 0 <= this.processedIds.indexOf(e[n].id) ? (this.deleteOnServerById(e[n].id), t.push(e[n].id)) : this.idInNotProcessed(e[n].id) || (this.notProcessed.push(levels.FriendRequest.createFriendRequest({
                id: e[n].id,
                from: e[n].fromUserId,
                type: e[n].type
            })), s = !0);
            this.processedIds = t, this.save(), s && (this.onNewListener(), this.onChangeListener())
        }, levels.FriendRequests.prototype.sendServerRequest = function (e, t) {
            cleverapps.RestClient.post("/friendrequests/create/" + encodeURIComponent(cleverapps.platform.getUserID()) + "/a", {
                toUserId: e,
                type: t
            })
        }, levels.FriendRequests.prototype.deleteOnServerById = function (e) {
            cleverapps.RestClient.post(
                "/friendrequests/delete/" + encodeURIComponent(cleverapps.platform.getUserID()) + "/a", {
                id: e
            })
        }, levels.FriendRequests.prototype.serverReload = function () {
            this.lastServerReload < Date.now() - cleverapps.parseInterval(levels.FriendRequests.RELOAD_INTERVAL) && cleverapps.synchronizer.synced && (this.lastServerReload = Date.now(), cleverapps.RestClient.get("/friendrequests/getmy/" + encodeURIComponent(cleverapps.platform.getUserID()) + "/a", {}, this.onServerLoad.bind(this)))
        }, levels.FriendRequests.prototype.deleteFakeRequests = function () {
            var e = this.notProcessed.filter(function (e) {
                return !e.fake
            });
            e.length !== this.notProcessed.length && (this.notProcessed = e, this.onChangeListener(), this.save())
        }, levels.FriendRequests.prototype.listAvailableTypes = function () {
            var e = [levels.FriendRequest.TYPE_STUCK_HELP_COINS];
            return "undefined" == typeof match3 && (e = e.concat([levels.FriendRequest.TYPE_SENT_COINS, levels.FriendRequest.TYPE_ASK_COINS, levels.FriendRequest.TYPE_SENT_HELP_COINS, levels.FriendRequest.TYPE_ASK_HELP_COINS])),
                cleverapps.lives && (e = e.concat([levels.FriendRequest.TYPE_SENT_HELP_LIVE, levels.FriendRequest.TYPE_ASK_HELP_LIVE, levels.FriendRequest.TYPE_SENT_LIVE, levels.FriendRequest.TYPE_ASK_LIVE])), e = cleverapps.starChest ? e.concat([levels.FriendRequest.TYPE_SENT_HELP_STAR, levels.FriendRequest.TYPE_ASK_HELP_STAR, levels.FriendRequest.TYPE_SENT_STAR, levels.FriendRequest.TYPE_ASK_STAR]) : e
        }, levels.FriendRequests.RELOAD_INTERVAL = "10 minutes", levels.FriendRequest = function (e) {
            this.id = e.id, this.from = e.from, this.type = e.type, this.fake = e.fake, this.onRemoveListener = function () { }
        }, levels.FriendRequest.prototype.getId = function () {
            return this.id
        }, levels.FriendRequest.prototype.getView = function () {
            if (this.canView()) return levels.FriendRequestView
        }, levels.FriendRequest.prototype.canView = function () {
            return levels.FriendRequest.REQUEST_TYPES[this.type]
        }, levels.FriendRequest.prototype.isFake = function () {
            return !0 === this.fake
        }, levels.FriendRequest.prototype.onServer = function () {
            return !this.isFake()
        },
            levels.FriendRequest.prototype.getData = function () {
                return {
                    id: this.id,
                    from: this.from,
                    type: this.type,
                    fake: this.fake
                }
            }, levels.FriendRequest.prototype.process = function () {
                var e, t = levels.FriendRequest.REQUEST_TYPES[this.type];
                t.checkProcess && !t.checkProcess() || (e = function () {
                    t.createNewRequestId && levels.friendRequests.sendServerRequest(this.from, t.createNewRequestId), t.onProcess && t.onProcess(this), this.remove()
                }.bind(this), t.fbRequest ? cleverapps.social.sendRequest(this.from, t.fbRequest, e) : e())
            }, levels.FriendRequest.prototype.remove = function () {
                levels.friendRequests.processById(this.getId()), this.onRemoveListener()
            }, levels.FriendRequest.prototype.cancel = function () {
                levels.friendRequests.processById(this.getId()), this.onRemoveListener()
            }, levels.FriendRequest.createFriendRequest = function (e) {
                return new levels.FriendRequest(e)
            }, levels.FriendRequest.addLiveProcess = function (e) {
                e.animateCollect("lives", function () {
                    cleverapps.lives.give(1, "help")
                })
            }, levels.FriendRequest.checkAddLiveProcess = function () {
                return !0
            }, levels.FriendRequest.addStarProcess = function (e) {
                e.animateCollect("stars", function () {
                    cleverapps.starChest.addStars(1)
                })
            }, levels.FriendRequest.addCoinsProcess = function (e, t) {
                t = t || levels.FriendRequest.HELP_COINS_AMOUNT, e.animateCollect("hard", function () {
                    cleverapps.user.earnHard(cleverapps.EVENTS.EARN.FRIEND_REQUEST, t)
                })
            }, levels.FriendRequest.addCoinsStuckProcess = function (e) {
                levels.FriendRequest.addCoinsProcess(e, levels.FriendRequest.STUCK_COINS_AMOUNT)
            }, levels.FriendRequest.TYPE_ASK_LIVE = 0, levels.FriendRequest.TYPE_SENT_LIVE = 1, levels.FriendRequest.TYPE_ASK_STAR = 2, levels.FriendRequest.TYPE_SENT_STAR = 3, levels.FriendRequest.TYPE_ASK_HELP_LIVE = 4, levels.FriendRequest.TYPE_SENT_HELP_LIVE = 5, levels.FriendRequest.TYPE_ASK_HELP_STAR = 6, levels.FriendRequest.TYPE_SENT_HELP_STAR = 7, levels.FriendRequest.TYPE_ASK_HELP_COINS = 9, levels.FriendRequest.TYPE_SENT_HELP_COINS = 10, levels.FriendRequest.TYPE_ASK_COINS = 12, levels.FriendRequest.TYPE_SENT_COINS = 13, levels.FriendRequest.TYPE_STUCK_HELP_COINS = 14,
            levels.FriendRequest.HELP_COINS_AMOUNT = 10, levels.FriendRequest.STUCK_COINS_AMOUNT = 50, levels.FriendRequest.REQUEST_TYPES = {}, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_LIVE] = {
                image: bundles.request_center.frames.send_life_icon,
                button_type: cleverapps.styles.UI.Button.Images.small_button_blue,
                button_text: "Send",
                text: "AskLiveRequest",
                fbRequest: "sendLiveRequest",
                createNewRequestId: levels.FriendRequest.TYPE_SENT_LIVE
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_LIVE] = {
                image: bundles.request_center.frames.send_life_icon,
                imageText: "+1",
                button_type: cleverapps.styles.UI.Button.Images.small_button_green,
                button_text: "Accept",
                text: "SendLiveRequest",
                fbRequest: "thanksForLiveRequest",
                onProcess: levels.FriendRequest.addLiveProcess,
                checkProcess: levels.FriendRequest.checkAddLiveProcess
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_STAR] = {
                image: bundles.request_center.frames.send_star_icon,
                button_type: cleverapps.styles.UI.Button.Images.small_button_blue,
                button_text: "Send",
                text: "AskStarRequest",
                fbRequest: "sendStarRequest",
                createNewRequestId: levels.FriendRequest.TYPE_SENT_STAR
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_STAR] = {
                image: bundles.request_center.frames.send_star_icon,
                imageText: "+1",
                button_type: cleverapps.styles.UI.Button.Images.small_button_green,
                button_text: "Accept",
                text: "SendStarRequest",
                fbRequest: "thanksForStarRequest",
                onProcess: levels.FriendRequest.addStarProcess
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_HELP_LIVE] = {
                image: bundles.request_center.frames.send_life_icon,
                button_type: cleverapps.styles.UI.Button.Images.small_button_blue,
                button_text: "Send",
                text: "AskHelpRequest",
                fbRequest: "sentHelpRequest",
                createNewRequestId: levels.FriendRequest.TYPE_SENT_HELP_LIVE
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_HELP_LIVE] = {
                image: bundles.request_center.frames.send_life_icon,
                imageText: "+1",
                button_type: cleverapps.styles.UI.Button.Images.small_button_green,
                button_text: "Accept",
                text: "SentHelpRequest",
                fbRequest: "thanksForHelpRequest",
                onProcess: levels.FriendRequest.addLiveProcess,
                checkProcess: levels.FriendRequest.checkAddLiveProcess
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_HELP_STAR] = {
                image: bundles.request_center.frames.send_star_icon,
                button_type: cleverapps.styles.UI.Button.Images.small_button_blue,
                button_text: "Send",
                text: "AskHelpRequest",
                fbRequest: "sentHelpRequest",
                createNewRequestId: levels.FriendRequest.TYPE_SENT_HELP_STAR
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_HELP_STAR] = {
                image: bundles.request_center.frames.send_star_icon,
                imageText: "+1",
                button_type: cleverapps.styles.UI.Button.Images.small_button_green,
                button_text: "Accept",
                text: "SentHelpRequest",
                fbRequest: "thanksForHelpRequest",
                onProcess: levels.FriendRequest.addStarProcess
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_HELP_COINS] = {
                image: bundles.request_center.frames.send_coins_icon,
                button_type: cleverapps.styles.UI.Button.Images.small_button_blue,
                button_text: "Send",
                text: "AskHelpRequest",
                fbRequest: "sentHelpRequest",
                createNewRequestId: levels.FriendRequest.TYPE_SENT_HELP_COINS
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_HELP_COINS] = {
                image: bundles.request_center.frames.send_coins_icon,
                imageText: "+10",
                button_type: cleverapps.styles.UI.Button.Images.small_button_green,
                button_text: "Accept",
                text: "SentHelpRequest",
                fbRequest: "thanksForHelpRequest",
                onProcess: levels.FriendRequest.addCoinsProcess
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_COINS] = {
                image: bundles.request_center.frames.send_coins_icon,
                button_type: cleverapps.styles.UI.Button.Images.small_button_blue,
                button_text: "Send",
                text: "AskCoinsRequest",
                fbRequest: "sendCoinsRequest",
                createNewRequestId: levels.FriendRequest.TYPE_SENT_COINS
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_COINS] = {
                image: bundles.request_center.frames.send_coins_icon,
                imageText: "+10",
                button_type: cleverapps.styles.UI.Button.Images.small_button_green,
                button_text: "Accept",
                text: "SendCoinsRequest",
                fbRequest: "thanksForCoinsRequest",
                onProcess: levels.FriendRequest.addCoinsProcess
            }, levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_STUCK_HELP_COINS] = {
                image: bundles.request_center.frames.accept_stuck_coins_icon,
                imageText: "+50",
                button_type: cleverapps.styles.UI.Button.Images.small_button_green,
                button_text: "Accept",
                text: "SendStuckHelpRequest",
                onProcess: levels.FriendRequest.addCoinsStuckProcess
            }, levels.FriendRequest.SYSTEM_ID = -1, levels.FriendRequestView = cc.Node.extend({
                ctor: function (e, t, s) {
                    this._super(), this.setContentSize(cleverapps.styles.FriendRequestView.width, cleverapps.styles.FriendRequestView.height), this.setAnchorPoint2(), this.model = e, this.onRemove = s, this.createBackground(), this.createFromContent(), this.createRequestContent(), this.createRequestImage(), this.createCancelContent(),
                        this.createProcessContent(), cleverapps.UI.onClick(this, function () {
                            this.process()
                        }.bind(this))
                },
                onEnter: function () {
                    this._super(), this.model.onRemoveListener = this.createListener(this.removeAnimation.bind(this)), this.model.animateCollect = this.createListener(this.animateCollect.bind(this))
                },
                animateCollect: function (e, t) {
                    t = t || function () { }, this.image ? this.image.runAction(new cc.Sequence(cleverapps.UI.animateCollect(this.image, e, {
                        scale: .8,
                        collectEffect: !0
                    }), new cc.CallFunc(t), new cc.RemoveSelf)) : t()
                },
                createFromContent: function () {
                    var e = levels.FriendRequest.REQUEST_TYPES[this.model.type],
                        t = void 0,
                        t = (cleverapps.social instanceof cleverapps.BaseFB && (t = this.model.from), e = e.avatar ? new cleverapps.UI.Avatar(cc.spriteFrameCache.getSpriteFrame(e.avatar), t) : (e = cleverapps.friends.getById(this.model.from)) ? new cleverapps.UI.Avatar(e) : new cleverapps.UI.Avatar("https://scontent.xx.fbcdn.net/v/", t), cleverapps.styles.FriendRequestView.Avatar);
                    e.setPositionRound(e.width / 2 + t.Margin.x, this.height / 2 + t.Margin.y),
                        e.setAnchorPoint2(), this.addChild(e)
                },
                createBackground: function () {
                    var e = cleverapps.UI.createScale9Sprite(bundles.request_center.frames.friend_message_bg_png, cleverapps.UI.Scale9Rect.TwoPixelXY);
                    e.setContentSize2(this.width, this.height), e.setPosition(this.width / 2, this.height / 2), this.addChild(e)
                },
                getRequestText: function () {
                    var e = levels.FriendRequest.REQUEST_TYPES[this.model.type];
                    return Messages.get(e.text)
                },
                createRequestContent: function () {
                    var e, t = this.getRequestText();
                    t && (e = cleverapps.styles.FriendRequestView.Request, (t = cleverapps.UI.generateTTFText(t, cleverapps.styles.FONTS.FRIEND_REQUEST_TEXT || cleverapps.styles.FONTS.WINDOW_SMALL_TEXT)).setPositionRound(this.width / 2 + e.x, this.height / 2 + e.y), t.setDimensions(e.width, 0), t.fitTo(void 0, e.height), t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER), this.addChild(t))
                },
                getRequestImage: function () {
                    var e, t = levels.FriendRequest.REQUEST_TYPES[this.model.type];
                    return !!t.image && (e = new cc.Sprite(t.image),
                        t.imageText && ((t = cleverapps.UI.generateImageText(t.imageText, cleverapps.styles.FONTS.FRIEND_REQUEST_ITEM_TEXT)).setPositionRound(e.width / 2, e.height / 2), e.addChild(t)), e)
                },
                createRequestImage: function () {
                    var e = this.getRequestImage();
                    e && (e.setPosition(cleverapps.styles.FriendRequestView.Icon.x, this.height / 2 + cleverapps.styles.FriendRequestView.Icon.y), this.addChild(e), this.image = e)
                },
                createProcessContent: function () {
                    var e = levels.FriendRequest.REQUEST_TYPES[this.model.type],
                        t = cleverapps.styles.FriendRequestView.processButton,
                        t = new cleverapps.UI.Button({
                            type: e.button_type,
                            text: e.button_text,
                            onClicked: this.process.bind(this),
                            width: t.width,
                            height: t.height
                        });
                    e.image ? t.setPositionRound(this.width - t.width / 2 - cleverapps.styles.FriendRequestView.processButton.x, this.height / 2 + cleverapps.styles.FriendRequestView.processButton.y) : t.setPositionRound(this.width - t.width / 2 - cleverapps.styles.FriendRequestView.processButton.noImage.x, this.height / 2 + cleverapps.styles.FriendRequestView.processButton.noImage.y),
                        this.addChild(t)
                },
                createCancelContent: function () {
                    var e = cleverapps.styles.FriendRequestView.close,
                        t = new cleverapps.UI.Button({
                            type: {
                                button_png: bundles.buttons_main.frames.close_small,
                                button_on_png: bundles.buttons_main.frames.close_small_on
                            },
                            onClicked: this.cancel.bind(this)
                        });
                    t.setPositionRound(this.width - t.width / 2 + e.x, this.height - t.height / 2 + e.y), this.addChild(t)
                },
                cancel: function () {
                    this.model.cancel()
                },
                process: function () {
                    this.model.process()
                },
                removeAnimation: function () {
                    this.runAction(new cc.Sequence(new cc.ScaleTo(.3, 0), new cc.CallFunc(this.onRemove), new cc.RemoveSelf))
                },
                showAnimation: function (e) {
                    this.setScale(0), this.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.ScaleTo(.3, 1)))
                }
            }), cleverapps.overrideFonts(cleverapps.styles.FONTS, {
                FRIEND_REQUEST_ITEM_TEXT: {
                    size: 35,
                    color: cleverapps.styles.COLORS.WHITE,
                    stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
                }
            }), cleverapps.styles.FriendRequestView = {
                width: 490,
                height: 190,
                close: {
                    x: 10,
                    y: 10
                },
                processButton: {
                    width: 170,
                    x: 25,
                    y: -30,
                    noImage: {
                        x: 90,
                        y: -35
                    }
                },
                Request: {
                    x: 66,
                    y: 45,
                    width: 270,
                    height: 80
                },
                Icon: {
                    x: 216,
                    y: -30
                },
                Avatar: {
                    Margin: {
                        x: 30,
                        y: 0
                    }
                }
            }, {
            load: function () {
                return cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.FAKE_REQUESTS) || {
                    lastLoadTime: 0
                }
            },
            save: function (e) {
                e.lastLoadTime = Date.now(), cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.FAKE_REQUESTS, e)
            },
            sendIfNeed: function (e) {
                if (0 !== cleverapps.friends.listIds().length && "merge" !== cleverapps.config.type && !cleverapps.flags.norequest) {
                    var t = FakeRequestSender.load(),
                        s = Math.floor((Date.now() - t.lastLoadTime) / cleverapps.parseInterval(FakeRequestSender.REQUEST_PERIOD));
                    if (!(s <= 0)) {
                        var i = e.notProcessed.filter(function (e) {
                            return e.isFake()
                        }),
                            n = (s > FakeRequestSender.MAX_REQUESTS - i.length && (s = FakeRequestSender.MAX_REQUESTS - i.length), !1),
                            o = levels.friendSorter.listActiveFriends();
                        cleverapps.Random.shuffle(o), 10 < o.length && (o = o.slice(0, 10));
                        for (var a = 0; a < o.length && 0 < s; a++) {
                            var r, c = o[a];
                            e.existRequestFrom(c.id) || (r = cleverapps.Random.mathChoose(this.listFakeRequestsTypes(e)), s--, n = !0,
                                e.notProcessed.push(levels.FriendRequest.createFriendRequest({
                                    id: "__" + Math.floor(1e15 * Math.random()),
                                    from: c.id,
                                    type: r,
                                    fake: !0
                                })))
                        }
                        n && (e.onNewListener(), FakeRequestSender.save(t), e.save())
                    }
                }
            },
            listFakeRequestsTypes: function (e) {
                var t = [levels.FriendRequest.TYPE_ASK_HELP_LIVE, levels.FriendRequest.TYPE_ASK_HELP_STAR, levels.FriendRequest.TYPE_ASK_HELP_COINS],
                    s = e.listAvailableTypes();
                return t.filter(function (e) {
                    return -1 !== s.indexOf(e)
                })
            }
        }),
        Episode = (FakeRequestSender.MAX_REQUESTS = 2, FakeRequestSender.REQUEST_PERIOD = "12 hours", -1 !== ["crocword", "scramble", "magicwords"].indexOf(cleverapps.config.name) && (FakeRequestSender.REQUEST_PERIOD = "3 hours"), cleverapps.config.debugMode && (FakeRequestSender.REQUEST_PERIOD = "1 minute"), "undefined" == typeof cc && (cleverapps = require("../../utils/utils")), function (e, t, s) {
            s = s || {}, this.episodeNo = e, this.levelNo = t, cleverapps.config.features.includes("highscore") && (this.episodeNo = 0, this.levelNo = 0), this.type = s.type || Episode.CalcType(e), this.copyData = s.copyData,
                this.whenRemovedListeners = [], this.loadTasks = {}, this.init()
        }),
        Episodes = (Episode.CalcType = function (e) {
            return "undefined" != typeof BonusWorld && BonusWorld.getConfigByEpisode(e) ? Episode.Types.BONUS_WORLD : Episode.TypeValues[e] ? e : Episode.Types.REGULAR
        }, Episode.prototype.isComingSoon = function () {
            return this.episodeNo === cleverapps.episodes.getAmountEpisodes() && cleverapps.isLevels()
        }, Episode.prototype.init = function () {
            this.loaded = !1;
            var e = bundles[this.bundleId()];
            if (!e) throw new Error("no bundle for episode " + this.episodeNo + " " + this.levelNo + " " + cleverapps.settings.language);
            this.levelsPerEpisode = e.episode.levelsAmount, !this.isComingSoon() && void 0 === this.levelNo || (this.levelsPerEpisode = 1);
            e = void 0 !== this.levelNo ? [this.levelNo] : cleverapps.rangeArray(0, this.levelsPerEpisode - 1);
            this.levels = e.map(function (e) {
                return new Level(this, e)
            }.bind(this))
        }, Episode.prototype.getLevel = function (e) {
            return void 0 !== this.levelNo && (e = 0), this.levels[e]
        }, Episode.prototype.isRegular = function () {
            return this.type === Episode.Types.REGULAR
        }, Episode.prototype.getCurrentLevel = function () {
            for (var e in this.levels) {
                e = this.levels[e];
                if (e.type === Level.TYPE_CURRENT) return e
            }
        }, Episode.prototype.whenRemoved = function (e) {
            this.whenRemovedListeners.push(e)
        }, Episode.prototype.isPassed = function () {
            return levels.user.episode > this.episodeNo
        }, Episode.prototype.isCurrent = function () {
            return levels.user.episode === this.episodeNo
        }, Episode.prototype.destructor = function () {
            if (!this.deleted) {
                for (var e in this.loadTasks) this.loadTasks[e].destructor();
                this.loadTasks = {}, this.whenRemovedListeners.forEach(cleverapps.callFunc), this.whenRemovedListeners = [], this.deleted = !0
            }
        }, Episode.prototype.onLevelUnload = function () {
            this.levels.reduce(function (e, t) {
                return e + t.counter
            }, 0) <= 0 && this.destructor()
        }, Episode.BundleId = function (e, t) {
            t = t || cleverapps.settings.language;
            e = "episode_" + e;
            return "board" === cleverapps.config.type && "en" !== t && (e += "_" + t), e
        }, Episode.prototype.bundleId = function () {
            return !cleverapps.config.adminMode && this.isComingSoon() ? "episode_coming_soon" : Episode.BundleId(this.episodeNo)
        }, Episode.prototype.isLoading = function () {
            for (var e in this.loadTasks)
                if (this.loadTasks[e].isActive()) return !0
        }, Episode.prototype.loadData = function (e) {
            this.loadBundles("levels", [this.bundleId()], e)
        }, Episode.prototype.loadBundles = function (e, t, s) {
            this.deleted ? s && s() : (this.loadTasks[e] || (this.loadTasks[e] = new SuccessWait(t)), this.loadTasks[e].whenLoaded(s))
        }, Episode.prototype.getBundle = function () {
            return bundles[this.bundleId()]
        }, Episode.prototype.getContent = function () {
            return this.content || (this.content = cc.loader.getRes(this.getBundle().jsons.levels), this.copyData && (this.content = JSON.parse(JSON.stringify(this.content))), this.content)
        }, Episode.prototype.getLevels = function () {
            var e = this.getContent();
            if (!e) throw new Error("No content for episode " + this.episodeNo + " scene " + cleverapps.environment.scene + " loaded " + (
                this.loadTasks.levels && this.loadTasks.levels.loaded + " " + this.loadTasks.levels.active) + " bundle " + this.bundleId() + " " + cleverapps.bundleLoader.isLoaded(this.bundleId()));
            return Array.isArray(e) ? e : e.levels
        }, Episode.prototype.isDebug = function () {
            return this.getContent().debug
        }, Episode.prototype.getHashes = function () {
            var s = {};
            return this.getLevels().forEach(function (e, t) {
                Object.assign(s, this.getLevelHashes(t))
            }.bind(this)), s
        }, Episode.prototype.getLevelHashes = function (s) {
            var i = {},
                n = this.getLevelVersions(s);
            return Object.keys(n).map(cleverapps.castType).sort().forEach(function (e) {
                var t = n[e],
                    t = Level.CalcHash(t);
                i[t] = {
                    levelNo: s,
                    version: e,
                    hash: t
                }
            }), i
        }, Episode.prototype.getLastVersionHashes = function () {
            return this.levels.map(function (e) {
                e = this.getLevelContent(e.levelNo);
                return Level.CalcHash(e)
            }, this)
        }, Episode.prototype.getLevelVersions = function (e) {
            var t = this.getLevels(),
                t = (t && t[e] || cleverapps.throwAsync("No levels for episode " + this.episodeNo + " level " + e), t[e]),
                s = (Array.isArray(t) || (t = [t]), {});
            return t.forEach(function (e, t) {
                t = e.version || t;
                s[t] = e
            }), s
        }, Episode.prototype.getMaxVersion = function (e) {
            var t, s = 0;
            for (t in e) s = Math.max(s, parseInt(t));
            return s
        }, Episode.prototype.getLevelContent = function (e) {
            var t = this.getLevelVersions(e),
                s = this.getMaxVersion(t),
                t = t[s = cleverapps.config.editorMode && void 0 !== LevelManager.getInstance().version && (!cleverapps.environment.isMainScene() || cleverapps.travelBook.isExpedition()) ? LevelManager.getInstance().version : s];
            return t.episodeNo = this.episodeNo, t.levelNo = e, t.version = s, t
        }, Episode.prototype.isDailyCup = function () {
            return this.type === Episode.Types.DAILYCUP
        }, Episode.prototype.isBonusRound = function () {
            return this.type === Episode.Types.BONUSROUNDS
        }, Episode.prototype.isDailyLevel = function () {
            return this.type === Episode.Types.DAILY_LEVELS
        }, Episode.prototype.isBonusWorldLevel = function () {
            return this.type === Episode.Types.BONUS_WORLD
        }, Episode.prototype.isAdsLevel = function () {
            return this.type === Episode.Types.ADS || this.type === Episode.Types.PROMO
        },
            Episode.LevelChooseAlgorithm = function (e) {
                var t = e.start,
                    s = e.finish || cleverapps.episodes.getAmountEpisodes(),
                    e = e.seed,
                    t = t * Episode.LEVELS_PER_EPISODE,
                    s = s * Episode.LEVELS_PER_EPISODE - 1,
                    t = cleverapps.Random.random(t, s, e);
                return {
                    levelNo: t % Episode.LEVELS_PER_EPISODE,
                    episodeNo: Math.floor(t / Episode.LEVELS_PER_EPISODE)
                }
            }, Episode.IsDebug = function (e) {
                return -1 === ["none"].indexOf(cleverapps.config.meta) && -1 === cleverapps.config.features.indexOf("highscore") && e.levels.length < Episode.LEVELS_PER_EPISODE || (!!e.debug || void 0)
            }, Episode.prototype.isAvailableToPlay = function () {
                return !!cleverapps.config.editorMode || (cleverapps.meta.getType() !== Metha.HOSE || levels.user.episode >= this.episodeNo)
            }, Episode.LEVELS_PER_EPISODE = 15, Episode.Types = {
                REGULAR: "regular",
                BONUSROUNDS: "bonusrounds",
                EDITOR: "editor",
                DAILY_LEVELS: "daily_levels",
                DAILYCUP: "dailycup",
                BONUS_WORLD: "bonus_world",
                ADS: "ads",
                PROMO: "promo",
                PLAYABLE_ADS: "playable_ads",
                ADS_HALLOWEEN: "ads_halloween",
                ADS_XMAS: "ads_xmas",
                ADS_DRAGONIA: "ads_dragonia",
                ADS_UNDERSEA: "ads_undersea",
                ADS_UNDERSEA2: "ads_undersea2",
                ADS_RAPUNZEL: "ads_rapunzel",
                ADS_RAPUNZEL2: "ads_rapunzel2"
            }, Episode.TypeValues = cleverapps.createSet(cleverapps.values(Episode.Types)), "undefined" == typeof cc && (module.exports = Episode),
            function () {
                this.onResetListener = function () { }
            }),
        Level = (Episodes.prototype.reset = function () {
            delete this.amountEpisodes, this.onResetListener()
        }, Episodes.prototype.getAmountEpisodes = function () {
            return void 0 === this.amountEpisodes && (this.amountEpisodes = this._calcAmountEpisodes()), this.amountEpisodes
        }, Episodes.prototype._calcAmountEpisodes = function (e) {
            for (var t = 0, s = 0; void 0 !== bundles[Episode.BundleId(s)]; s++) {
                var i = bundles[Episode.BundleId(s)];
                if (!i.jsons || !i.jsons.levels) break;
                i.debug && !e || t++
            }
            return t
        }, Episodes.prototype.listAllLevels = function () {
            var i = [];
            return Object.keys(bundles).forEach(function (e) {
                var s = bundles[e];
                s && s.episode && s.episode.levels && bundles[Episode.BundleId(s.episode.episodeNo)] && s.episode.levels.forEach(function (e, t) {
                    i.push({
                        episodeNo: s.episode.episodeNo,
                        levelNo: t
                    })
                })
            }), i
        }, function (e, t) {
            this.episode = e, this.levelNo = t, this.episodeNo = e.episodeNo, this.counter = 0;
            e = e.getBundle();
            this.properties = e.episode.levels && e.episode.levels[t] || {}, this.expedition = this.properties.expedition || "main", "merge" === cleverapps.config.type && (this.families = Families.listExpeditionCodes(this.expedition), this.mapSize = this.properties.mapSize, this.units = this.properties.units, this.tiles = this.properties.tiles), this.update()
        }),
        LevelView = (Level.prototype.isInteractive = function () {
            return !0
        }, Level.prototype.isClickable = function () {
            return !!cleverapps.config.editorMode || !(this.type === Level.TYPE_NOTPASSED || !this.episode.isAvailableToPlay()) && (this.type === Level.TYPE_CURRENT || this.isCurrentLevel())
        }, Level.prototype.getHumanReadableNumber = function () {
            return cleverapps.humanReadableNumber(this.episodeNo, this.levelNo)
        }, Level.prototype.isRegular = function () {
            return this.episode.isRegular()
        }, Level.prototype.isCurrentLevel = function () {
            return this.isRegular() && levels.user.isCurrentLevel(this.levelNo, this.episodeNo)
        }, Level.prototype.isPassedLevel = function () {
            return levels.user.isPassedLevel(this.levelNo, this.episodeNo)
        }, Level.prototype.getTag = function () {
            return this.properties.tag
        }, Level.prototype.isHard = function () {
            return this.getTag() === Level.TAGS.HARD
        }, Level.prototype.isTricky = function () {
            return this.getTag() === Level.TAGS.TRICKY
        }, Level.prototype.isBonus = function () {
            return this.getTag() === Level.TAGS.BONUS
        }, Level.prototype.getImageBundle = function () {
            return this.properties.bundleName
        }, Level.prototype.getLevelCellSkins = function () {
            return this.properties.cellSkins
        }, Level.prototype.getLevelEnemies = function () {
            var t = {};
            return this.properties.enemies && this.properties.enemies.forEach(function (e) {
                t[e] = Game.GOAL_ENEMY_TYPES[e]
            }), t
        }, Level.prototype.isNew = function () {
            return this.type !== Level.TYPE_PASSED || this.isCurrentLevel()
        }, Level.prototype.isLastLevelOnEpisode = function () {
            return this.episode.levels.map(function (e) {
                return e.levelNo
            }).indexOf(this.levelNo) === this.episode.levelsPerEpisode - 1
        }, Level.prototype.getVersion = function () {
            return void 0 === this.version && (this.version = this.episode.getLevelContent(this.levelNo).version), this.version
        }, Level.prototype.load = function (e) {
            this.counter++, this.content && !cleverapps.config.editorMode ? e && e() : this.episode.loadData(function () {
                this.content = this.episode.getLevelContent(this.levelNo), this.hash = Level.CalcHash(this.content), e && e(this)
            }.bind(this))
        }, Level.prototype.unload = function () {
            this.counter--, this.counter < 0 && (this.counter = 0), this.episode.onLevelUnload()
        }, Level.CalcHash = function (e) {
            return RecursiveHasher(e, ["episodeNo", "levelNo", "version", "hard", "paint", "extra", "gold", "hash", "hashes", "comments", "translate", "definitions", "bundles", "horizontalCards"])
        }, Level.prototype.play = function (e, t) {
            cleverapps.config.editorMode && (this.content = void 0, cleverapps.environment.setScene(cleverapps.Environment.SCENE_GAME));
            t = new GameScene({
                level: this,
                gameOptions: t
            });
            cleverapps.scenes.replaceScene(t, e)
        },
            Level.prototype.onPressed = function () {
                cleverapps.lives && cleverapps.lives.isEmpty() ? cleverapps.meta.display({
                    focus: ["LevelPressedNoLives", "MenuBarGoldItem", "MenuBarLivesItem"],
                    action: function (e) {
                        new LivesShopWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                }) : cleverapps.config.features.includes("boosters_before") && !WindowBoostersBefore.isAvailable() && this.isCurrentLevel() && !this.isHard() || !LevelStartWindow.isAvailable(this.episodeNo, this.levelNo) ? cleverapps.meta.display({
                    focus: "LevelPressedPlay",
                    action: function (e) {
                        this.play(e)
                    }.bind(this)
                }) : this.episode.isComingSoon() || cleverapps.meta.display({
                    focus: "LevelStartWindow",
                    control: "MenuBarGoldItem",
                    actions: [function (e) {
                        new LevelStartWindow({
                            level: this
                        }), cleverapps.meta.onceNoWindowsListener = e
                    }.bind(this)]
                })
            }, Level.prototype.update = function () {
                var e, t;
                cleverapps.meta.getType() === Metha.HOSE || cleverapps.meta.getType() === Metha.SHORTMETA ? (e = levels.user.episode, t = levels.user.level, cleverapps.meta.getType() === Metha.SHORTMETA && (e = Math.floor(
                    cleverapps.meta.getMainObject().level / Episode.LEVELS_PER_EPISODE), t = cleverapps.meta.getMainObject().level % Episode.LEVELS_PER_EPISODE), e > this.episodeNo ? this.type = Level.TYPE_PASSED : e < this.episodeNo ? this.type = Level.TYPE_NOTPASSED : t > this.levelNo ? this.type = Level.TYPE_PASSED : t === this.levelNo ? this.type = Level.TYPE_CURRENT : this.type = Level.TYPE_NOTPASSED, this.stars = this.type === Level.TYPE_PASSED ? 3 : 0) : this.type = Level.TYPE_CURRENT
            }, Level.prototype.nextLevel = function () {
                if (this.building) return this;
                var e = this.episodeNo,
                    t = this.levelNo + 1;
                return t >= Episode.LEVELS_PER_EPISODE && (t = 0, e += 1), MethaHelper.getLevel(e, t)
            }, Level.AvailableTags = function () {
                return "stacks" === cleverapps.config.subtype ? [Level.TAGS.HARD, Level.TAGS.TRICKY] : "board" === cleverapps.config.type ? [Level.TAGS.HARD, Level.TAGS.BONUS] : "match3" === cleverapps.config.type ? [Level.TAGS.HARD, Level.TAGS.TRICKY, Level.TAGS.BONUS] : [Level.TAGS.HARD]
            }, Level.TYPE_PASSED = 0, Level.TYPE_CURRENT = 1, Level.TYPE_NOTPASSED = 2, Level.TAGS = {}, Level.TAGS.HARD = "hard",
            Level.TAGS.TRICKY = "tricky", Level.TAGS.BONUS = "bonus", "undefined" == typeof cc && (module.exports = Level), cc.Node.extend({
                ctor: function (e, t) {
                    this._super(), this.level = e, void 0 !== t && this.calculatePosition(t), void 0 !== t && t.episode.isComingSoon() ? this.setPosition(cleverapps.styles.LevelView.coming_soon[0]) : (this.levelBg = this.addLevelBg(), this.addLevelId()), this.level.isInteractive() && (this.level.isClickable() ? (this.addTouchListener(), cleverapps.UI.applyHover(this.levelBg || this)) : (this.level.type === Level.TYPE_NOTPASSED || !this.level.episode.isAvailableToPlay() && this.level.episode.episodeNo >= levels.user.episode) && cleverapps.tooltipManager.create(this, {
                        text: Messages.get("LevelNotPassedTooltip"),
                        position: cleverapps.styles.UI.Tooltip.LOCATION.below
                    })), this.level.getReward && this.level.getReward() && this.level.type !== Level.TYPE_PASSED && this.createReward(this.level.getReward()), void 0 !== t && t.episode.isComingSoon() || this.customize()
                },
                createReward: function (e) {
                    var t = cleverapps.styles.LevelView,
                        s = new cc.Scale9Sprite(bundles.level.frames.prize_bg_png),
                        i = (s.setContentSize2(t.prize), new cc.Sprite(bundles.level.frames.prize_arrow_png)),
                        i = (s.addChild(i), i.setPositionRound(t.prize.arrow), Object.keys(e)[0]),
                        e = new TextWithIcon(TextWithIcon.ICONS_BY_NAME[i] + " x" + e[i].factor, {
                            font: cleverapps.styles.FONTS.LEVEL_REWARD_TEXT
                        });
                    s.addChild(e), e.setPositionRound(s.width / 2 + t.prize.offset.x, s.height / 2 + t.prize.offset.y), this.addChild(s), s.setPositionRound(t.prize), s.runAction(new cc.RepeatForever(new cc.Sequence(new cc.MoveBy(1, 0, t.prize.animation.dy).easing(cc.easeInOut(1.7)), new cc.MoveBy(1, 0, -t.prize.animation.dy).easing(cc.easeInOut(1.7)))))
                },
                calculatePosition: function () {
                    var e = cleverapps.styles.LevelView[this.level.episode.getBundle().episode.levelPositions || "levels_1"][this.level.levelNo];
                    (this.level.levelNo < Episode.LEVELS_PER_EPISODE || e) && this.setPosition(e)
                },
                customize: function () { },
                getAnimationName: function () {
                    return (this.level.isHard() ? ["hard_past", "hard_current", "hard_future"] : ["past",
                        "current", "future"
                    ])[this.level.type]
                },
                getImage: function () {
                    var e, t = ["level_past_png", "level_current_png", "level_future_png"][this.level.type],
                        t = (this.level.isHard() ? t = "level_hard_png" : this.level.isBonus() && (t = "level_bonus_png"), new cc.Sprite(bundles.level.frames[t]));
                    return t.setAnchorPoint(.5, .5), void 0 !== this.getStars() && this.level.type === Level.TYPE_PASSED && (e = "star_" + this.getStars() + "_png", (e = new cc.Sprite(bundles.level.frames[e])).setAnchorPoint(.5, .5), e.setPositionRound(cleverapps.styles.LevelView.stars), t.addChild(e)), t
                },
                getStars: function () {
                    if ("match3" === cleverapps.config.type && !cleverapps.config.rpg && (this.level.episode.isAvailableToPlay() && this.level.type !== Level.TYPE_CURRENT && this.level.type === Level.TYPE_PASSED)) return void 0 !== this.level.stars ? this.level.stars : 0
                },
                addLevelBg: function () {
                    var e, t, s = cleverapps.styles.LevelView,
                        i = new cc.Node;
                    return i.setAnchorPoint(.5, .5), i.setContentSize(s.clickSize), this.setContentSize(i.getContentSize()), bundles.level.jsons.level_json ? (
                        e = this.getAnimationName(), (t = new cleverapps.Spine(bundles.level.jsons.level_json)).setAnimation(0, e, !0)) : (t = this.getImage(), this.level.type === Level.TYPE_CURRENT && this.level.isInteractive() && i.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.83, 1.19), new cc.ScaleTo(.5, 1))))), t.setPosition(i.width / 2, i.height / 2 + s.dy), i.addChild(t), i.setPositionRound(this.width / 2, this.height / 2), this.setAnchorPoint2(), this.addChild(i), i
                },
                addLevelId: function () {
                    (this.level.isHard() || this.level.isBonus()) && cleverapps.styles.LevelView.hidableLevelNo || LevelView.generateLevelId(this.levelBg, this.level.type, this.level.getHumanReadableNumber())
                },
                addTouchListener: function () {
                    cleverapps.UI.onClick(this, this.onPressed.bind(this))
                },
                onPressed: function () {
                    cleverapps.audio.playSound(bundles.main.urls.click_effect), this.level.onPressed()
                }
            })),
        FbConnectWindow = (LevelView.generateLevelId = function (e, t, s) {
            var i, n, o = cleverapps.styles.LevelView.LevelId;
            !cleverapps.config.editorMode && -1 === o.showTypes.indexOf(t) || (
                n = cleverapps.styles.FONTS.LEVEL_TITLE_TEXT, t === Level.TYPE_NOTPASSED && (n = cleverapps.styles.FONTS.LEVEL_NOT_PASSED_TITLE_TEXT), t === Level.TYPE_CURRENT && cleverapps.styles.FONTS.LEVEL_CURRENT_TITLE_TEXT && (n = cleverapps.styles.FONTS.LEVEL_CURRENT_TITLE_TEXT), t === Level.TYPE_PASSED && cleverapps.styles.FONTS.LEVEL_PASSED_TITLE_TEXT && (n = cleverapps.styles.FONTS.LEVEL_CURRENT_TITLE_TEXT), t = cleverapps.UI.generateImageText(s, n), 1e3 <= s ? i = cleverapps.styles.FONTS.LEVEL_TITLE_TEXT.alternativeSizes[1] : 100 <= s && (i = cleverapps.styles.FONTS.LEVEL_TITLE_TEXT.alternativeSizes[0]), i && t.setScale(t.scale * i), o.scale && s % 2 && t.setScale(t.scale * o.scale), e.addChild(t), n = o, (e.levelId = t).setPositionRound(n.x, n.y))
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            LEVEL_TITLE_TEXT: {
                name: "default",
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                alternativeSizes: [.9, .8]
            },
            LEVEL_NOT_PASSED_TITLE_TEXT: {
                name: "default",
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                alternativeSizes: [.9, .8]
            },
            LEVEL_REWARD_TEXT: {
                size: 40,
                name: "nostroke",
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            }
        }), cleverapps.styles.LevelView = {
            dy: -10,
            coming_soon: [{
                x: -60,
                y: -200
            }],
            LevelId: {
                x: {
                    dx: 0
                },
                y: {
                    dy: 0
                },
                showTypes: [Level.TYPE_PASSED, Level.TYPE_CURRENT, Level.TYPE_NOTPASSED]
            },
            clickSize: {
                width: 90,
                height: 75
            },
            stars: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 50
                }
            },
            prize: {
                width: 170,
                height: 130,
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: 140
                },
                arrow: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom",
                        dy: -27
                    }
                },
                animation: {
                    dy: 20
                },
                offset: {
                    x: -7,
                    y: 7
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                var t = cleverapps.styles.FbConnectWindow,
                    s = (this.restoreProgress = (e = e || {}).restoreProgress, []),
                    i = cleverapps.styles.FONTS.FBCONNECT_WINDOW_TEXT || cleverapps.styles.FONTS.WINDOW_TEXT,
                    n = "FbConnectWindow.text",
                    n = (cleverapps.platform.oneOf(CleverApps, Kongregate) && (n = "XsollaLogin.text"), this.restoreProgress && (n = "RestoreProgress.text"), s.push(this.createText(n, i)), e.errorMessage && s.push(this.createText(e.errorMessage, cleverapps.styles.FONTS.SMALL_TEXT_ERROR)), s.push(this.createButtons()),
                        new cleverapps.Layout(s, {
                            margin: t.margin,
                            padding: t.padding,
                            direction: cleverapps.UI.VERTICAL
                        }));
                this._super({
                    title: this.restoreProgress ? "RestoreProgress" : "SignIn",
                    closeButton: !0,
                    name: "fbconnectwindow",
                    content: n
                }), this.closeCallback = cleverapps.once(e.onClose), this.success = cleverapps.once(e.onSuccess), this.failureLogin = e.onFailure, this.waitingSync = !1
            },
            createText: function (e, t) {
                var s = cleverapps.styles.FbConnectWindow,
                    e = cleverapps.UI.generateOnlyText(e, t);
                return e.setDimensions(s.text.width, 0), e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), e
            },
            onClose: function () {
                this.failureLogin && this.failureLogin(), this.closeCallback && this.closeCallback()
            },
            waitSync: function () {
                this.waitingSync = !0;
                var t = new WaitWindow;
                new ActionPlayer([function (e) {
                    e = cleverapps.wait(2, e), cleverapps.synchronizer._onceNextSyncCompletedListener = cleverapps.waitNoMore(15e3, e), setTimeout(e, 3e3)
                }, function (e) {
                    !cleverapps.synchronizer._syncIn.needShowReloadWindow() && cleverapps.platform.oldUserId && cleverapps.synchronizer.isReady() ? (
                        e = cleverapps.waitNoMore(15e3, e), cleverapps.synchronizer.getProgress(cleverapps.platform.oldUserId, {
                            acceptOnlyIfBetter: !0,
                            progressLoadOnly: !0,
                            callback: function () {
                                cleverapps.platform.oldUserId = void 0, e()
                            }
                        })) : e()
                }, function (e) {
                    t.close(), this.waitingSync = !1, this.closed || this.close(), this.success(), cleverapps.synchronizer._syncIn.needShowReloadWindow() ? cleverapps.meta.isFocused() && !cleverapps.synchronizer._syncIn.isReloadInProcess() && cleverapps.synchronizer._syncIn.distractToReloadWindow() : this.restoreProgress && cleverapps.notification.create("RestoreProgress.progressNotFound"), e()
                }.bind(this)]).play()
            },
            close: function () {
                this.waitingSync || this._super()
            },
            onButtonClick: function () {
                this.closed || (this.failureLogin = !1, this.waitSync())
            },
            createButtons: function () {
                var t = cleverapps.social.getCodes(),
                    s = cleverapps.styles.FbConnectWindow,
                    e = t.map(function (e) {
                        return new LoginButton({
                            multiSocials: 1 < t.length,
                            height: s.button.height,
                            width: s.button.width,
                            source: e,
                            onSuccess: this.onButtonClick.bind(this)
                        })
                    }, this);
                return new cleverapps.Layout(e, {
                    direction: cleverapps.UI.VERTICAL,
                    margin: s.button.margin
                })
            },
            listBundles: function () {
                return ["social_buttons"]
            }
        })),
        EmailWindow = (cleverapps.styles.FbConnectWindow = {
            margin: 30,
            padding: {
                bottom: 25
            },
            button: {
                height: 110,
                width: 500,
                margin: 20
            },
            text: {
                width: 800,
                height: 400
            }
        }, Window.extend({
            onWindowLoaded: function (e, t) {
                this.onSuccess = e, this.onCancel = t, this._super({
                    title: "EmailWindow.title",
                    content: this.createContent(),
                    button: {
                        text: "OK",
                        onPressed: this.onPressed.bind(this)
                    },
                    notCloseByTouchInShadow: !0
                })
            },
            onPressed: function () {
                var e = this.editBox.getString().toLowerCase().trim();
                cleverapps.validateEmail(e) ? (this.success = !0, cleverapps.info.setKeyValue("email", e), this.close()) : cleverapps.notification.create("EmailWindow.error")
            },
            onClose: function () {
                this.success ? this.onSuccess && this.onSuccess() : this.onCancel && this.onCancel()
            },
            createContent: function () {
                var e = cleverapps.styles.EmailWindow,
                    t = cleverapps.UI.generateOnlyText("EmailWindow.text", cleverapps.styles.FONTS.WINDOW_SMALL_TEXT),
                    s = (t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(e.text.width, 0), cleverapps.paymentsCountry.isRussia() || cleverapps.payments instanceof YooKassaPayments ? "your_email@yandex.ru" : "your_email@gmail.com"),
                    i = new cc.Scale9Sprite(bundles.windows.frames.editbox_bg_png),
                    i = this.editBox = new cc.EditBox(e.editBox, i, !0),
                    s = (i.setPlaceholderFontColor(cleverapps.styles.FONTS.EMAIL_WINDOW_PLACEHOLDER_TEXT.color), i.setPlaceholderFont(cleverapps.UI.getFontName(), cleverapps.styles.FONTS.EMAIL_WINDOW_PLACEHOLDER_TEXT.size), i.setPlaceHolder(s), i.setInputMode(cc.EDITBOX_INPUT_MODE_EMAILADDR), i.setMaxLength(100), i.stayOnTop(!0), i.setTouchEnabled(), i.setFontColor(cleverapps.styles.FONTS.EMAIL_WINDOW_EDITBOX_TEXT.color), i.setFont(cleverapps.UI.getFontName(), cleverapps.styles.FONTS.EMAIL_WINDOW_EDITBOX_TEXT.size), cleverapps.info.getValue("email"));
                return s && i.setString(s), new cleverapps.Layout([t, i], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: e.margin,
                    padding: e.padding
                })
            }
        })),
        Boatswain = (
            cleverapps.overrideFonts(cleverapps.styles.FONTS, {
                EMAIL_WINDOW_EDITBOX_TEXT: {
                    size: 30,
                    color: cleverapps.styles.COLORS.WHITE
                },
                EMAIL_WINDOW_PLACEHOLDER_TEXT: {
                    size: 30,
                    color: cc.color.GRAY
                }
            }), cleverapps.styles.EmailWindow = {
                margin: 60,
                padding: {
                    top: 70,
                    bottom: 40
                },
                text: {
                    width: 650
                },
                editBox: {
                    width: 550,
                    height: 50
                }
            },
            function (e) {
                this.level = e, this.setIntent(Boatswain.RETURN_INTENT)
            }),
        BoatswainAction = (Boatswain.prototype.setIntent = function (e) {
            this.intent = e
        }, Boatswain.prototype.playIntent = function (e) {
            switch (this.intent !== Boatswain.NEXT_INTENT || this.canNext() || (this.intent = Boatswain.RETURN_INTENT), this.intent) {
                case Boatswain.NEXT_INTENT:
                    cleverapps.meta.compound(e, [function (e) {
                        var t;
                        this.level.episode.isDailyCup() ? cleverapps.dailyCup.wantsToPlay(e) : this.level.isCurrentLevel() ? cleverapps.meta.wantsToPlay(e) : (t = this.level.nextLevel(), cleverapps.meta.wantsToPlay(e, t))
                    }.bind(this), function (e) {
                        cleverapps.environment.isGameScene() && !Game.currentGame ? cleverapps.Plot.ReturnToMainScene(e, this.level) : e()
                    }.bind(this)]);
                    break;
                case Boatswain.REPLAY_INTENT:
                    cleverapps.meta.compound(e, [function (e) {
                        cleverapps.meta.wantsToReplay(e, this.level)
                    }.bind(this), function (e) {
                        cleverapps.environment.isGameScene() && !Game.currentGame ? cleverapps.Plot.ReturnToMainScene(e, this.level) : e()
                    }.bind(this)]);
                    break;
                case Boatswain.RETURN_INTENT:
                    this.level.episode.isDailyCup() ? cleverapps.scenes.replaceScene(new DailyCupScene, e) : cleverapps.Plot.ReturnToMainScene(e, this.level)
            }
        }, Boatswain.prototype.prepareNext = function () {
            cleverapps.isKnockoutGame() || cleverapps.missionManager.run()
        }, Boatswain.prototype.canNext = function () {
            if ("undefined" != typeof match3 && match3.heroes && match3.heroes.readyToOpen()) return !1;
            if (this.level.episode.isDailyCup()) return cleverapps.dailyCup.isRunning() && (!cleverapps.dailyCup.withLives() || !cleverapps.lives.isEmpty());
            if (!(this.level.isRegular() && !cleverapps.isKnockoutGame())) return !1;
            if (cleverapps.forces.checkMainForces() || cleverapps.missionManager.skipNext() || cleverapps.missionManager.wantsToShowCompleted() || cleverapps.missionManager.pendingStartWindow()) return !1;
            switch (cleverapps.meta.getType()) {
                case Metha.FARM:
                    if (!cleverapps.farm.isCompleted() && (cleverapps.farm.getBuilding().getQuest().isCompleted() || cleverapps.farm.justCollectedDialogue)) return !1;
                    break;
                case Metha.HOMEFIX:
                    if (!cleverapps.home.isCompleted()) {
                        var e = cleverapps.home.getFurnitureToUpgrade();
                        if (e) {
                            e = e.getInfo().cost;
                            if (cleverapps.home.stars >= e && cleverapps.home.stars - cleverapps.home.amountLevelStars(this.level) < e) return !1
                        }
                    }
                    break;
                case Metha.SIMPLE:
                    if (cleverapps.simple.canMoveNext()) return !1;
                    break;
                case Metha.HOSE:
                    if (cleverapps.starChest && cleverapps.starChest.stars >= cleverapps.StarChest.GOAL_AMOUNT) return !1;
                    if (this.level.isCurrentLevel() && (this.level.isLastLevelOnEpisode() || cleverapps.Plot.getDialogueAfterLevel(this.level))) return !1
            }
            return !0
        }, function () {
            cleverapps.meta.distract({
                focus: "boatswain",
                control: this.introControls(),
                action: function (e) {
                    this.boatswain.playIntent(e)
                }.bind(this)
            })
        }),
        UndoHistory = (Boatswain.RETURN_INTENT = 0,
            Boatswain.NEXT_INTENT = 1, Boatswain.REPLAY_INTENT = 2,
            function (e) {
                this.commands = [], this.pointer = 0, e && e.moves && (this.commands = e.moves.map(function (e) {
                    return Game.currentGame.getCommand(e)
                }), this.pointer = e.pointer), this.onChangeListener = function () { }
            }),
        LivesMenuBarItem = (UndoHistory.prototype.add = function (e) {
            this.commands.splice(this.pointer), this.commands.push(e), this.redo()
        }, UndoHistory.prototype.hasUndo = function () {
            return 0 !== this.pointer
        }, UndoHistory.prototype.hasRedo = function () {
            return void 0 !== this.commands[this.pointer]
        }, UndoHistory.prototype.undo = function () {
            this.hasUndo() && (this.pointer--, this.commands[this.pointer].undo(), this.onChangeListener(this.hasUndo(), this.hasRedo()))
        }, UndoHistory.prototype.redo = function () {
            var e;
            this.hasRedo() && (e = this.commands[this.pointer], this.pointer++, e.redo(), this.onChangeListener(this.hasUndo(), this.hasRedo()))
        }, UndoHistory.prototype.reset = function () {
            this.commands = [], this.pointer = 0, this.onChangeListener(this.hasUndo(), this.hasRedo())
        },
            UndoHistory.prototype.getInfo = function () {
                return {
                    moves: this.commands.map(function (e) {
                        return e.move
                    }),
                    pointer: this.pointer
                }
            }, cleverapps.Lives = function (e, t) {
                this.slot = t, e ? this.init() : this.load(), this.onChangeAmountListeners = {}, this.onStartRegenerateListener = function () { }, this.onBuyUnlimitedLivesListener = function () { }, this.onFullListener = function () { }, this.processRegenerateState()
            }, cleverapps.Lives.TIMEOUT = cleverapps.parseInterval(cleverapps.config.debugMode ? "1 minute" : "30 minutes"), cleverapps.Lives.prototype.init = function () {
                this.amount = this.getMaxLives(), this.whenStart = void 0, this.save()
            }, cleverapps.Lives.prototype.getMaxLives = function () {
                return "olympics" === cleverapps.config.name || "zenmatch" === cleverapps.config.name ? 3 : 5
            }, cleverapps.Lives.prototype.processRegenerateState = function (e) {
                var t, s;
                for (this.stopRegenerateTimeout(); this.amount < this.getMaxLives() && this.whenStart && this.whenStart + cleverapps.Lives.TIMEOUT <= Date.now();) this.amount++, this.whenStart += cleverapps.Lives.TIMEOUT, s = t = !0;
                var i = cleverapps.unlimitedLives && cleverapps.unlimitedLives.checkBuyed();
                !t || e || i || this.runListeners(), t && this.amount >= this.getMaxLives() && this.onFullListener(), this.amount >= this.getMaxLives() ? delete this.whenStart : (this.whenStart || (this.whenStart = Date.now(), s = !0), this.startRegenerateTimeout(void 0 !== e ? e : i)), s && this.save(), this.processLocalPushes()
            }, cleverapps.Lives.prototype.startRegenerateTimeout = function (e) {
                void 0 === this.finishRegenerateTimeout && (console.log("startRegenerateTimeout", this.calcTimeLeft()), this.finishRegenerateTimeout = new cleverapps.LongTimeout(this.processRegenerateState.bind(this), this.calcTimeLeft()), e || this.onStartRegenerateListener())
            }, cleverapps.Lives.prototype.stopRegenerateTimeout = function () {
                clearTimeout(this.finishRegenerateTimeout), this.finishRegenerateTimeout = void 0
            }, cleverapps.Lives.prototype.isRegenerateRunning = function () {
                return void 0 !== this.finishRegenerateTimeout
            }, cleverapps.Lives.prototype.calcTimeLeft = function () {
                var e = (this.whenStart || Date.now()) + cleverapps.Lives.TIMEOUT - Date.now();
                return e = (e = e < 0 ? 0 : e) > cleverapps.Lives.TIMEOUT ? cleverapps.Lives.TIMEOUT : e
            }, cleverapps.Lives.prototype.isEmpty = function () {
                return 0 === this.amount && !cleverapps.unlimitedLives.checkBuyed()
            }, cleverapps.Lives.prototype.isFull = function () {
                return this.amount >= this.getMaxLives() || cleverapps.unlimitedLives && cleverapps.unlimitedLives.checkBuyed()
            }, cleverapps.Lives.prototype.give = function (e, t, s) {
                e = void 0 === e ? 1 : e, t && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.EARN.LIVES + this.slot + "_" + t, {
                    value: e
                }), this.setAmount(this.amount + e, s)
            }, cleverapps.Lives.prototype.setAmount = function (e, t) {
                var s;
                0 < this.amount - (e = e < 0 ? 0 : e) && ((s = cleverapps.missionManager.findByType(Mission.TYPE_LIVESFEAST)) && s.update(this.amount - e)), this.amount !== e && (this.amount = e, this.save(), t || this.runListeners()), this.processRegenerateState(!0), this.amount < .2 * this.getMaxLives() && this.showForce()
            }, cleverapps.Lives.prototype.processLocalPushes = cleverapps.timeredThrottle(cleverapps.parseInterval(
                "1 minute"), function () {
                    var e;
                    this.isFull() ? cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.LIVES) : (e = this.getMaxLives() - this.amount, e = (this.whenStart || Date.now()) + cleverapps.Lives.TIMEOUT * e - Date.now(), cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.LIVES, e))
                }), cleverapps.Lives.prototype.reset = function () {
                    this.amount = this.getMaxLives(), this.whenStart = void 0, this.processRegenerateState(), this.save()
                }, cleverapps.Lives.prototype.canTake = function (e) {
                    return this.amount >= e
                }, cleverapps.Lives.prototype.take = function (e) {
                    cleverapps.config.editorMode || (this.amount >= this.getMaxLives() && delete this.whenStart, 0 < this.amount && this.setAmount(this.amount - 1, e))
                }, cleverapps.Lives.prototype.getInfo = function () {
                    return {
                        a: this.amount,
                        wc: this.whenStart && cleverapps.compactTime(this.whenStart, {
                            seconds: !0
                        })
                    }
                }, cleverapps.Lives.prototype.updateInfo = function (e, t) {
                    this.load(e), this.processRegenerateState(), this.save(t)
                }, cleverapps.Lives.prototype.runListeners = function () {
                    cleverapps.values(
                        this.onChangeAmountListeners).forEach(function (e) {
                            e()
                        })
                }, cleverapps.Lives.prototype.save = function (e) {
                    cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LIVES + this.slot, this.getInfo()), e || cleverapps.synchronizer.addUpdateTask("lives" + this.slot)
                }, cleverapps.Lives.prototype.load = function (e) {
                    (e = e || cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LIVES + this.slot)) ? (this.amount = e.a || e.amount || 0, this.whenStart = e.wc && cleverapps.expandTime(e.wc, {
                        seconds: !0
                    }) || e.ws || e.whenStart) : (this.amount = this.getMaxLives(), this.whenStart = void 0)
                }, cleverapps.Lives.prototype.showForce = function () { }, cleverapps.Lives.Switch = function (e, t) {
                    cleverapps.lives = cleverapps.livesBySlots[e], t && cleverapps.lives.init()
                }, CustomSyncers.registerBySlots("lives", function (e) {
                    return cleverapps.livesBySlots[e] ? cleverapps.livesBySlots[e].getInfo() : {}
                }, function (e, t) {
                    cleverapps.livesBySlots[e] && cleverapps.livesBySlots[e].updateInfo(t, !0)
                }),
            function (e) {
                MenuBarItem.call(this, e), this.onUpdateLotteryIcon = function () { }
            }),
        LivesProductTile = (LivesMenuBarItem.prototype = Object.create(MenuBarItem.prototype), (LivesMenuBarItem.prototype.constructor = LivesMenuBarItem).prototype.clearListeners = function () {
            this.lives.onChangeAmountListeners.livesview = function () { }, this.lives.onStartRegenerateListener = function () { }, this.lives.onBuyUnlimitedLivesListener = function () { }
        }, LivesMenuBarItem.prototype.customInit = function () {
            this.lives && this.clearListeners(), this.lives = cleverapps.lives, this.attention = !1, this.lives.onChangeAmountListeners.livesview = this.updateAll.bind(this), this.lives.onStartRegenerateListener = this.updateAll.bind(this), this.lives.onBuyUnlimitedLivesListener = this.updateAll.bind(this), Game.currentGame && Game.currentGame.energyLottery && (Game.currentGame.energyLottery.onShowHint = this.setFinger.bind(this, !0), Game.currentGame.energyLottery.onHideHint = this.setFinger.bind(this)), this.updateAll()
        }, LivesMenuBarItem.prototype.onAction = function () {
            this.setFinger(!1)
        }, LivesMenuBarItem.prototype.withPlusButton = function () {
            return (!cleverapps.unlimitedLives || !cleverapps.unlimitedLives.checkBuyed()) && MenuBarItem.prototype.withPlusButton.call(this)
        }, LivesMenuBarItem.prototype.updateAll = function () {
            cleverapps.unlimitedLives && cleverapps.unlimitedLives.checkBuyed() ? this.totalIcon = bundles.menubar.frames.unlim_png : this.totalIcon = !1, this.changeText(), this.updatePlusButton(), this.updateTimer(), this.updateAttention()
        }, LivesMenuBarItem.prototype.updateTimer = function () {
            var e = this.timer;
            this.stopTimer(), this.lottery = !["merge"].includes(cleverapps.config.type), cleverapps.unlimitedLives && cleverapps.unlimitedLives.checkBuyed() ? (this.lottery = !1, this.setTimer(new cleverapps.CountDown(cleverapps.unlimitedLives.getLeftTime(), {
                onFinish: function () {
                    !cleverapps.meta.isFocused() && cleverapps.environment.hasScene([cleverapps.Environment.SCENE_MAIN, cleverapps.Environment.SCENE_DAILY_CUP]) && cleverapps.unlimitedLives.displayPromotionOnFinish(), this.updateAll()
                }.bind(this)
            }), !1)) : this.lives.amount < this.lives.getMaxLives() && 0 < this.lives.calcTimeLeft() && (this.lottery = !1, this.setTimer(new cleverapps.CountDown(this.lives.calcTimeLeft(), {
                onFinish: this.updateAll.bind(this)
            }), !1)), this.onUpdateLotteryIcon(), this.onChangeTimer && this.onChangeTimer(!!this.timer == !!e), this.onRefreshTimer && this.timer && this.onRefreshTimer()
        }, LivesMenuBarItem.prototype.getCurrentValue = function () {
            var e;
            return cleverapps.unlimitedLives && cleverapps.unlimitedLives.checkBuyed() && (e = Date.now() + cleverapps.unlimitedLives.getLeftTime()), {
                amount: cleverapps.lives.amount,
                total: cleverapps.lives.getMaxLives(),
                time: e
            }
        }, BaseProductTile.extend({
            ctor: function (e, t) {
                var s = LivesProductTile.styles = LivesProductTile.styles || cleverapps.overrideStyles(cleverapps.styles.BaseProductTile, cleverapps.styles.LivesProductTile, !0);
                (t = t || {}).noTileClick = !0, t.iconSkipScale = !0, t.iconAnimationOverride = e.product.animation ? {
                    json: bundles.tile_shop.jsons.shop_lives_animations_json,
                    delay: 0
                } : {}, this._super(e, s, t)
            },
            onReady: function () {
                this.tileModel instanceof EnergyLotteryTileModel && Game.currentGame.energyLottery.isHintActive() && Game.currentGame.energyLottery.isReady() && this.addFinger()
            },
            createDescription: function () {
                var e, t, s, i, n, o = this.tileModel.getProductDescription();
                if (o) return e = this.styles.description, (o = "string" == typeof o ? {
                    title: o
                } : o).reward ? this.createRewards(cleverapps.styles.FONTS.SHOP_WINDOW_LIVES_TEXT) : o.countdown ? (i = cleverapps.styles.FONTS.SHOP_LIVES_PRODUCT_TILE_DESCRIPTION_TEXT || cleverapps.styles.FONTS.SMALL_WHITE_TEXT, t = cleverapps.UI.generateOnlyText("TileShop.tile.leftTime", i), s = new cleverapps.CountDownView(new cleverapps.CountDown(o.countdown, {
                    onFinish: this.tileModel.updateModelState.bind(this.tileModel)
                }), {
                    font: i
                }), n = new cc.Sprite(bundles.timer.frames.timer_png), s = new cleverapps.Layout([n, s], {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.timer.margin
                }), new cleverapps.Layout([t, s], {
                    direction: cleverapps.UI.VERTICAL,
                    dimensions: e
                })) : o.text ? (
                    i = cleverapps.styles.FONTS.SHOP_LIVES_PRODUCT_TILE_DESCRIPTION_TEXT || cleverapps.styles.FONTS.SMALL_WHITE_TEXT, (n = cleverapps.UI.generateOnlyText(o.text, i)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), n.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), n.setDimensions(e.width, 0), n.fitTo(void 0, e.height), n.setDimensions(e.width, e.height), n) : void 0
            },
            createLimit: function () {
                if ("merge" !== cleverapps.config.type) return this._super();
                var e, t = this.tileModel.getProductLimit();
                if (t) return e = this.styles.limit, t.left ? ((t = cleverapps.UI.generateOnlyText(t.left, cleverapps.styles.FONTS.SHOP_LIVES_PRODUCT_TILE_DESCRIPTION_TEXT)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER), t.setDimensions(e.width, e.height), t) : void 0
            }
        })),
        AskLivesTileModel = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            SHOP_LIVES_PRODUCT_TILE_DESCRIPTION_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            }
        }), cleverapps.styles.LivesProductTile = {
            button: {
                width: 225,
                height: 75
            },
            description: {
                width: 300,
                height: 70,
                timer: {
                    margin: 6
                }
            },
            badge: {
                x: {
                    align: "right",
                    dx: -5
                },
                y: {
                    align: "top",
                    dy: -58
                },
                rotation: 0
            }
        }, function (e) {
            TileModel.call(this, e)
        }),
        RefillLivesTileModel = (AskLivesTileModel.prototype = Object.create(TileModel.prototype), (AskLivesTileModel.prototype.constructor = AskLivesTileModel).prototype.getCurrentPrice = function () {
            return "FREE"
        }, AskLivesTileModel.prototype.getProductDescription = function () {
            return {
                text: "AskLivesProduct.description"
            }
        }, AskLivesTileModel.prototype.isEnabled = function () {
            return !cleverapps.flags.norequest
        }, AskLivesTileModel.prototype.buy = function (s) {
            cleverapps.social.checkConnection(function () {
                new SelectFriendWindow("askLives", function (e, t) {
                    cleverapps.social.sendRequest(e, "askLiveRequest", function () {
                        e.forEach(function (e) {
                            cleverapps.friends.inApp(e) && levels.friendRequests.sendServerRequest(e, levels.FriendRequest.TYPE_ASK_LIVE)
                        }), t(), s()
                    })
                })
            })
        }, function (e) {
            TileModel.call(this, e), this.product.reward = this.getReward()
        }),
        BuyLivesTileModel = (
            RefillLivesTileModel.prototype = Object.create(TileModel.prototype), (RefillLivesTileModel.prototype.constructor = RefillLivesTileModel).prototype.getReward = function () {
                return {
                    lives: cleverapps.lives.getMaxLives()
                }
            }, RefillLivesTileModel.prototype.getProductDescription = function () {
                return {
                    reward: !0
                }
            },
            function (e) {
                TileModel.call(this, e)
            }),
        UnlimitedLives = (BuyLivesTileModel.prototype = Object.create(TileModel.prototype), (BuyLivesTileModel.prototype.constructor = BuyLivesTileModel).prototype.getProductDescription = function () {
            return {
                reward: !0
            }
        }, function () {
            this.value = void 0, this.load()
        }),
        ExtendUnlimitedLivesWindow = (UnlimitedLives.prototype.buy = function (e) {
            "string" == typeof e && (e = cleverapps.parseInterval(e)), this.checkBuyed() ? this.value.actionTime += e : this.value = {
                buyTime: Date.now(),
                actionTime: e,
                fpShowed: 0
            }, this.save()
        }, UnlimitedLives.prototype.reset = function () {
            this.value = void 0, this.save()
        }, UnlimitedLives.prototype.getLeftTime = function () {
            if (cleverapps.platform.oneOf(Pliega)) return 1 / 0;
            if (void 0 === this.value) return 0;
            var e = this.value.buyTime + this.value.actionTime - Date.now();
            return e <= 0 ? 0 : e
        }, UnlimitedLives.prototype.checkBuyed = function () {
            return 0 < this.getLeftTime()
        }, UnlimitedLives.prototype.displayPromotionOnFinish = function () {
            cleverapps.flags.videoAdsMainMonetization || this.value && !this.value.fpShowed && 0 === this.getLeftTime() && this.showPromotion()
        }, UnlimitedLives.prototype.showPromotion = function () {
            cleverapps.meta.display({
                focus: "ExtendUnlimitedLivesWindow",
                action: function (e) {
                    this.value.fpShowed = 1, this.save(), new ExtendUnlimitedLivesWindow, cleverapps.meta.onceNoWindowsListener = e
                }.bind(this)
            })
        }, UnlimitedLives.prototype.getInfo = function () {
            var e = {};
            return e[UnlimitedLives.UNLIMITED_LIVES_COMPAT] = this.value, e
        }, UnlimitedLives.prototype.updateInfo = function (e, t) {
            this.value = e[UnlimitedLives.UNLIMITED_LIVES_COMPAT], this.save(t)
        }, UnlimitedLives.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.UNLIMITED_LIVES);
            this.value = void 0 !== e ? e[UnlimitedLives.UNLIMITED_LIVES_COMPAT] : void 0
        }, UnlimitedLives.prototype.save = function (e) {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.UNLIMITED_LIVES, this.getInfo()), e || cleverapps.synchronizer.addUpdateTask("tempgoods")
        }, UnlimitedLives.UNLIMITED_LIVES_COMPAT = 1, Window.extend({
            onWindowLoaded: function () {
                var e = cleverapps.styles.ExtendUnlimitedLivesWindow,
                    t = this.createAnimation(),
                    s = this.createText(),
                    t = (this.product = Product.Create("unlimitedLives"), new cleverapps.Layout([t, s], {
                        margin: e.margin,
                        direction: cleverapps.UI.VERTICAL,
                        padding: e.padding
                    }));
                this._super({
                    content: t,
                    title: "ExtendUnlimitedLivesWindow.title",
                    name: "extendunlimitedliveswindow",
                    button: {
                        text: this.getButtonText(),
                        width: e.button.width,
                        height: e.button.height,
                        onPressed: this.onBuy.bind(this)
                    },
                    openSound: bundles.extend_unlimited_lives_window.urls.lives_effect
                }), "hard" === this.product.currency && cleverapps.meta.showControlsWhileFocused("MenuBarGoldItem"), Lottery.addIcon(this.button)
            },
            getPerson: function () {
                return {
                    role: "hero",
                    emotion: "sad"
                }
            },
            createText: function () {
                var e = cleverapps.styles.ExtendUnlimitedLivesWindow,
                    t = cleverapps.UI.generateOnlyText("ExtendUnlimitedLivesWindow.unlimitedLivesText", cleverapps.styles.FONTS.WINDOW_TEXT);
                return t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(e.text.width, 0), t.fitTo(void 0, e.text.height), t
            },
            createAnimation: function () {
                var e = cleverapps.styles.ExtendUnlimitedLivesWindow,
                    t = new cc.Node,
                    s = (t.setAnchorPoint2(), t.setContentSize2(e.animation), new cleverapps.Spine(bundles.extend_unlimited_lives_window.jsons.lives_json));
                return -1 !== ["differences", "tripeaks", "olympics", "spades", "zenmatch"].indexOf(cleverapps.config.name) ? s.setAnimationAndIdleAfter("no_life", "idle") : s.setAnimation(0, "no_life", !0), t.addChild(s), s.setPositionRound(e.animation), t
            },
            onBuy: function () {
                this.product.buy(function (e) {
                    e && this.close()
                }.bind(this))
            },
            getButtonText: function () {
                return this.product.getCurrentPrice()
            },
            listBundles: function () {
                return ["extend_unlimited_lives_window"]
            }
        })),
        ProlongationWindow = (cleverapps.styles.ExtendUnlimitedLivesWindow = {
            margin: 75,
            padding: {
                bottom: 40
            },
            animation: {
                width: 250,
                height: 250,
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            text: {
                width: 700,
                height: 300
            },
            button: {
                width: 300,
                height: 100
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                var t;
                e = e || {}, this.prolongation = Game.currentGame.prolongation, this.type = e.type || Prolongation.TYPES.MOVES, this.onSuccess = e.onSuccess || function () { }, this.onGiveUp = e.onGiveUp || function () { }, this.canGiveUp = "klondike" !== cleverapps.config.type, this.offer = e.offer || this.prolongation.getOffer(this.type), cleverapps.gameModes.skipProlongation ? this.onGiveUp() : (this.prolongation.onCompleteOffer = function () {
                    this.canGiveUp = !0, this.skipAlert = !0, this.close()
                }.bind(this), this.haveForce = "free" === this.offer.priceType, t = !this.haveForce, this._super({
                    title: e.title || "ProlongationWindow.title",
                    name: "prolongationwindow",
                    content: this.createContent(),
                    styles: cleverapps.styles.ProlongationWindow.window,
                    closeButton: t,
                    notCloseByTouchInShadow: !0,
                    openSound: bundles.prolongation_window.urls.continue_effect
                }), this.prolongation.onAddMoves = this.createListener(this.onAddMoves.bind(this)), e = cleverapps.config.soft ? "MenuBarCoinsItem" : "MenuBarGoldItem", cleverapps.meta.showControlsWhileFocused(e), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MOVES_SHOW), cleverapps.windows.list.forEach(function (e) {
                    "confirmexitwindow" === e.name && e.close()
                }))
            },
            getPerson: function () {
                return {
                    role: "hero",
                    emotion: "sad"
                }
            },
            close: function () {
                if (!this.skipAlert) {
                    this.skipAlert = !0;
                    var e = this.prolongation.getAlertMessage();
                    if (e) return void this.showGiveUpAlert(e)
                }
                this._super()
            },
            createContent: function () {
                var e = cleverapps.styles.ProlongationWindow,
                    t = [],
                    s = cleverapps.UI.generateTTFText(this.prolongation.getText(this.type), cleverapps.styles.FONTS.WINDOW_TEXT);
                return s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.setDimensions(e.question.width, 0), s.fitTo(void 0, e.question.height), t.push(s), "match3" === cleverapps.config.type && this.type !== Prolongation.TYPES.BOMB && t.push(
                    this.createGoals()), this.offerView = new ProlongationOfferView(this.prolongation, this.offer), t.push(this.offerView), new cleverapps.Layout(t, {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.margin,
                        padding: e.padding
                    })
            },
            addFinger: function () {
                FingerView.isRunning(this.finger) || this.haveForce || (this.finger = FingerView.hintClick(this.offerView.button, {
                    delay: .8
                }))
            },
            removeFinger: function () {
                FingerView.remove(this.finger), this.finger = void 0
            },
            createGoals: function () {
                var e = cleverapps.styles.ProlongationWindow.goals,
                    t = this.createGoalIcons(),
                    t = new cleverapps.Layout(t, {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: e.margin,
                        padding: e.padding
                    });
                return bundles.prolongation_window.frames.goals_bg_png && ((e = new cc.Scale9Sprite(bundles.prolongation_window.frames.goals_bg_png)).setContentSize(t.getContentSize()), e.setPositionRound({
                    align: "center"
                }, {
                    align: "center"
                }), e.setLocalZOrder(-1), t.addChild(e)), t
            },
            showGiveUpAlert: function (e) {
                var t = [],
                    e = (this.offerView.button && t.push(this.offerView.button.getGlobalBoundingBox()),
                        new MinimalDialogue({
                            items: [e, new BreakViews(!0, cleverapps.styles.FONTS.FORCE_MESSAGE_TEXT)],
                            rects: t
                        }));
                this.addChild(e), e.display(), cleverapps.audio.playSound(bundles.game.urls.giveup_alert_effect)
            },
            onShow: function () {
                this.closed || (Game.currentGame && Game.currentGame.outcome === GameBase.OUTCOME_UNKNOWN ? (this._super(), this.offerView.onShow(), this.runAction(new cc.Sequence(new cc.DelayTime(.5), new cc.CallFunc(this.addFinger.bind(this))))) : this.close())
            },
            onHide: function () {
                this.removeFinger(), this.offerView.stopAllActions(), this._super()
            },
            onClose: function () {
                this.removeFinger(), this.canGiveUp && this.onGiveUp()
            },
            onAddMoves: function (e, t) {
                this.skipAlert = !0, this.canGiveUp = !1, "match3" === cleverapps.config.type && this.animateAddMoves(e, t), this.hint && this.hint.close(), this.onSuccess(), this.close()
            },
            animateAddMoves: function (e, t) {
                this.collectAnimationFinished || (this.collectAnimationFinished = !0, (e = "runes" === cleverapps.config.name ? new cc.Sprite(bundles.moves.frames.moves_icon) : cleverapps.UI.generateOnlyText(e, cleverapps.styles.FONTS.MOVES_TEXT)).setPosition(this.window.width / 2, this.offerView.y), this.window.addChild(e), e.runAction(new cc.Sequence(new cc.PlaySound(bundles.main.urls.shop_buy_effect), cleverapps.UI.animateCollect(e, "moves", {
                    scale: 1.5,
                    duration: t.delay / 1e3
                }), new cc.RemoveSelf)))
            },
            createGoalIcons: function () {
                var e, t = cleverapps.styles.ProlongationWindow.goals,
                    s = [];
                for (e in Game.currentGame.goals.elements) {
                    var i = Game.currentGame.goals.elements[e],
                        n = i.getView(),
                        o = {},
                        n = (n.actor && (o.skin = n.actor.currSkin, o.spine = n.actor.currSpine, o.scales = t.scales), GoalViewFactory.createView(i, o));
                    s.push(new WindowGoalView(i, n))
                }
                return s
            },
            getPreferredBundles: function () {
                return ["game"]
            }
        })),
        Prolongation = (cleverapps.styles.ProlongationWindow = {
            margin: 20,
            padding: {
                bottom: 20
            },
            goals: {
                margin: 30,
                padding: {
                    x: 30,
                    y: 20
                },
                scales: void 0
            },
            question: {
                width: 600,
                height: 200,
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 125
                }
            },
            underline: {
                x: {
                    align: "left",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -2
                },
                height: 3
            }
        },
            function () {
                this.counter = 0, this.onAddMoves = function () { }, this.onCompleteOffer = function () { }
            }),
        CircleCountdown = (Prolongation.prototype.getOffer = function (e, t) {
            var s;
            if (e === Prolongation.TYPES.MOVES ? s = 5 : e === Prolongation.TYPES.BOMB && "tile3" === cleverapps.config.type && Game.currentGame.open.isFull() && (s = 3), levels.user.getFloatLevel() < 1.4 && !cleverapps.forces.isShown(Forces.FREE_PROLONGATION_FORCE.id) && !t) return {
                type: e,
                priceType: "free",
                price: 0,
                moves: s,
                text: "FREE",
                force: Forces.FREE_PROLONGATION_FORCE
            };
            if (this.isAdAvailable()) return {
                type: e,
                priceType: "ads",
                moves: s,
                text: "##"
            };
            t = this.isCustomWhaleFirstStep() ? 250 : Prolongation.PRICES[this.counter];
            return {
                type: e,
                priceType: "currency",
                price: t,
                moves: s = e === Prolongation.TYPES.MOVES && this.isCustomWhaleFirstStep() ? 10 : s,
                text: (cleverapps.config.soft ? "@@" : "$$") + t
            }
        }, Prolongation.prototype.acceptOffer = function (e) {
            switch (e.priceType) {
                case "free":
                    this.addMoves(e.moves, {
                        price: e.price,
                        delay: "solitaire" === cleverapps.config.type ? 1 : void 0
                    }), cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce();
                    break;
                case "ads":
                    cleverapps.rewardedAdsManager.loadAndPlay({
                        type: RewardedAdsManager.REWARDED,
                        adLimit: AdsLimits.TYPES.PROLONGATION,
                        callback: function () {
                            this.addMoves(e.moves), cleverapps.adsLimits.watch(AdsLimits.TYPES.PROLONGATION)
                        }.bind(this),
                        onCancelCallback: function () {
                            var e = cleverapps.windows.currentWindow();
                            e && e.close()
                        }
                    });
                    break;
                case "currency":
                    var t = levels.user.spendHard.bind(levels.user);
                    (t = cleverapps.config.soft ? levels.user.spendSoft.bind(levels.user) : t)(cleverapps.EVENTS.SPENT.CONTINUE, e.price) && (this.addMoves(e.moves, {
                        price: e.price
                    }), this.escalateToUpperLevel(), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HINT_USED, {
                        value: e.price
                    }), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MOVES_BOUGHT + "_" + e.price))
            }
        }, Prolongation.prototype.isAdAvailable = function () {
            return cleverapps.adsLimits.state(AdsLimits.TYPES.PROLONGATION) === AdsLimits.STATE_READY && cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED)
        },
            Prolongation.prototype.isCustomWhaleFirstStep = function () {
                return 0 === this.counter && (500 < levels.user.gold || cleverapps.paymentsHistory.classify() === cleverapps.PaymentsHistory.BRACKET_WHALE || cleverapps.paymentsHistory.classify() === cleverapps.PaymentsHistory.BRACKET_BIGWHALE)
            }, Prolongation.prototype.escalateToUpperLevel = function () {
                this.counter++, this.counter >= Prolongation.PRICES.length && !cleverapps.highscore && (this.counter = Prolongation.PRICES.length - 1)
            }, Prolongation.prototype.getAlertMessage = function () {
                var e = Game.currentGame,
                    t = e.secondaryMission,
                    s = Lantern.Get(),
                    i = e.getPercentOfCompletion(),
                    n = e.rewards[GameBase.REWARD_HARD],
                    o = void 0;
                if (e.rewards[GameBase.REWARD_BOOSTERS] ? o = Prolongation.GIVE_UP_TYPES.BOOSTER : s && s.isActive(e.level) && 0 < s.getCurrentStreak() ? o = Prolongation.GIVE_UP_TYPES.LANTERN : t && t.isRunning() && 0 < e.rewards.clover ? o = Prolongation.GIVE_UP_TYPES.MISSION : n && 0 < n ? o = Prolongation.GIVE_UP_TYPES.GOLD_COLLECTED : .7 <= i && (o = Prolongation.GIVE_UP_TYPES.NEARLY), void 0 !== o) return s = [Messages.get(
                    "GiveUpAlert.text1")], o === Prolongation.GIVE_UP_TYPES.NEARLY && s.push(Messages.get("AddMovesWindow.nearlyDoneGiveUp")), 0 < cleverapps.ListBreaks().length && s.push(Messages.get("GiveUpAlert.text2")), s.join("\n")
            }, Prolongation.prototype.getText = function (e) {
                return e === Prolongation.TYPES.BOMB ? Messages.get("PostponeBombWindow.addMoves", {
                    moves: BombOnCard.MOVES_TO_ADD
                }) : e === Prolongation.TYPES.FLAGS ? Messages.get("RemoveFlagsWindow.text") : Messages.get("ProlongationWindow.addMoves")
            }, Prolongation.prototype.hasOffer = function () {
                return void 0 !== Prolongation.PRICES[this.counter]
            }, Prolongation.prototype.addMoves = function (e, t) {
                this.onAddMoves(e, t = t || {}), Game.currentGame && e && Game.currentGame.setMoves(e, t)
            }, Prolongation.GIVE_UP_TYPES = {
                BOOSTER: 0,
                LANTERN: 1,
                MISSION: 2,
                GOLD_COLLECTED: 3,
                NEARLY: 4
            }, Prolongation.PRICES = [100, 300, 500, 700, 1e3], "tile3" === cleverapps.config.type && (Prolongation.PRICES = [295, 295, 295, 295, 295]), Prolongation.TYPES = {}, Prolongation.TYPES.MOVES = 1, Prolongation.TYPES.BOMB = 2, Prolongation.TYPES.FLAGS = 3, cleverapps.Spine.extend({
                ctor: function (e, t) {
                    this.onComplete = e, this.withBomb = t.type === Prolongation.TYPES.BOMB;
                    e = this.withBomb ? bundles.prolongation_window.jsons.bomb_timer_json : bundles.prolongation_window.jsons.timer_json, this._super(e), this.timeScale = 1, this.currentNum = 10, t = this.withBomb ? cleverapps.styles.FONTS.CIRCLE_BOMB_COUNTDOWN_TEXT : cleverapps.styles.FONTS.CIRCLE_COUNTDOWN_TEXT;
                    this.numberNode = cleverapps.UI.generateImageText("0", t), this.addChild(this.numberNode), this.numberNode.setPositionRound(this.width / 2, this.height / 2), this.isShown = !1
                },
                show: function () {
                    this.isShown = !0, cleverapps.settings.music && (cleverapps.settings.toggleMusic(), this.toggledMusic = !0), this.setAnimation(0, "open", !1), this.withBomb ? this.numberNode.setString(this.currentNum.toString()) : (cleverapps.audio.playSound(bundles.prolongation_window.urls.timer_start), this.numberNode.runAction(new cc.Sequence(new ImageFontCountTo(.6, 10), new cc.ScaleTo(.2, 1.3).easing(cc.easeOut(1)), new cc.ScaleTo(.2, 1).easing(cc.easeOut(1))))),
                        this.setCompleteListener(function () {
                            this.isShown = !0, this.setAnimation(0, "animation", !1), this.setStartListener(function () {
                                this.countDownAction()
                            }.bind(this)), this.setCompleteListener(this.onComplete)
                        }.bind(this))
                },
                countDownAction: function () {
                    var e;
                    this.numberNode.setString(this.currentNum.toString()), e = 0 < this.currentNum ? this.withBomb ? "bomb_timer_tick" : "timer_tick" : this.withBomb ? "bomb_timer_tick_zero" : "timer_tick_zero", cleverapps.audio.playSound(bundles.prolongation_window.urls[e]), this.withBomb || (this.currentNum < 6 && 3 < this.currentNum ? this.numberNode.setColor(cleverapps.styles.COLORS.ORANGE) : this.currentNum < 3 && this.numberNode.setColor(cleverapps.styles.COLORS.COLOR_RED)), this.numberNode.runAction(new cc.Sequence(new cc.ScaleTo(.2, 1).easing(cc.easeCubicActionOut()), new cc.DelayTime(.6).easing(cc.easeElasticIn(.5)), new cc.ScaleTo(.3, 0).easing(cc.easeCubicActionIn()), new cc.CallFunc(function () {
                        this.currentNum--, 0 <= this.currentNum ? this.countDownAction() : this.withBomb && (
                            this.numberNode.removeFromParent(), cleverapps.audio.playSound(bundles.prolongation_window.urls.bomb_timer_explosion))
                    }.bind(this))))
                },
                pauseAction: function () {
                    this.numberNode.pause(), this.setTimeScale(0)
                },
                resumeAction: function () {
                    this.setTimeScale(this.timeScale), this.numberNode.resume()
                },
                cleanup: function () {
                    this._super(), this.toggledMusic && cleverapps.settings.toggleMusic()
                }
            })),
        ProlongationOfferView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CIRCLE_COUNTDOWN_TEXT: {
                name: "nostroke",
                size: 80,
                color: cleverapps.styles.COLORS.COLOR_BROWN_2
            },
            CIRCLE_BOMB_COUNTDOWN_TEXT: {
                name: "nostroke",
                size: 80,
                color: cleverapps.styles.COLORS.WHITE
            }
        }), cleverapps.Layout.extend({
            ctor: function (e, t) {
                var s = cleverapps.styles.ProlongationOfferView,
                    e = (this.prolongation = e, this.offer = t, []),
                    t = (this.useProlongationTimer = -1 !== ["solitaire", "tile3", "blocks"].indexOf(cleverapps.config.type) && (cleverapps.forces.isShown(Forces.FREE_PROLONGATION_FORCE.id) || 1.4 <= levels.user.getFloatLevel()), this.offer.moves);
                this.useProlongationTimer && (this.timer = new CircleCountdown(this.prolongation.onCompleteOffer, this.offer), e.push(this.timer)), (t || this.offer.magic) && (this.label = this.createLabel(), e.push(this.label)), t && this.offer.bonus && this.createBonusLabel(), this.offer.lottery && Lottery.addIcon(this), this.button = this.createButton(), e.push(this.button), this._super(e, {
                    direction: cleverapps.UI.VERTICAL,
                    margin: s.margin
                })
            },
            createButton: function () {
                var e = cleverapps.styles.ProlongationOfferView.button;
                return new cleverapps.UI.Button({
                    type: this.offer.magic && cleverapps.styles.UI.Button.Images.button_blue,
                    content: new TextWithIcon("free" === this.offer.priceType ? this.offer.text : Messages.get("PlayOn") + " " + this.offer.text),
                    width: e.width,
                    height: e.height,
                    onClicked: this.onClick.bind(this)
                })
            },
            createLabel: function () {
                var e, t, s = cleverapps.styles.ProlongationOfferView;
                return bundles.prolongation_window.jsons.label_moves_json ? (t = this.label = new cleverapps.Spine(bundles.prolongation_window.jsons.label_moves_json)).setAnimationAndIdleAfter("open", "idle") : (t = this.label = new cc.Sprite(bundles.prolongation_window.frames.label_moves_png), this.offer.magic || (e = cleverapps.UI.generateImageText("+" + this.offer.moves, cleverapps.styles.FONTS.PROLONG_BUTTON_AMOUNT_TEXT), t.addChild(e), e.setPositionRound(s.label.amount))), t
            },
            createBonusLabel: function () {
                var e = cleverapps.styles.ProlongationOfferView,
                    t = new cleverapps.Spine(bundles.prolongation_window.jsons.bonus_json);
                this.label.addChild(t), t.setLocalZOrder(-1), t.setPositionRound(e.bonusLabel), t.runAction(new cc.Sequence(new cc.DelayTime(1), new cc.CallFunc(function () {
                    t.setAnimationAndIdleAfter("showUp", "idle")
                })))
            },
            onShow: function () {
                this.setVisible(!1), this.runAction(new cc.Sequence(new cc.DelayTime(.4), new cc.ScaleTo(0, .5), new cc.Show, new cc.CallFunc(function () {
                    this.useProlongationTimer && (this.timer.isShown ? this.timer.resumeAction() : this.timer.show(), this.button.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.5, 1.1).easing(cc.easeOut(2)),
                        new cc.ScaleTo(.5, 1).easing(cc.easeIn(2))))))
                }.bind(this)), new cc.ScaleTo(.3, 1).easing(cc.easeBackOut()), new cc.CallFunc(this.showForce.bind(this))))
            },
            showForce: function () {
                this.offer.force && cleverapps.forces.create(this.button, this.offer.force, {
                    importantNodes: [this.button],
                    actives: [this]
                })
            },
            onClick: function () {
                this.useProlongationTimer && this.timer && this.timer.pauseAction(), this.prolongation.acceptOffer(this.offer)
            }
        })),
        BreakView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PROLONG_BUTTON_AMOUNT_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE
            }
        }), cleverapps.styles.ProlongationOfferView = {
            margin: 20,
            button: {
                width: 350,
                height: 90
            },
            label: {
                amount: {
                    x: {
                        align: "center",
                        dx: -3
                    },
                    y: {
                        align: "center",
                        dy: -3
                    }
                }
            },
            bonusLabel: {
                x: {
                    align: "center",
                    dx: 125
                },
                y: {
                    align: "center",
                    dy: 73
                }
            }
        }, cleverapps.ListBreaks = function () {
            var e = Lantern.Get(),
                t = [bundles.game.frames.cellbooster_small_png, bundles.game.frames.linebooster_small_png, bundles.game.frames.colorbooster_small_png],
                s = Game.currentGame.secondaryMission;
            return [{
                text: "AddMovesWindow.booster",
                amount: 1,
                isActive: Game.currentGame.rewards.boosters,
                icon: Game.currentGame.rewards.boosters && t[Object.keys(Game.currentGame.rewards.boosters)[0]]
            }, {
                text: "AddMovesWindow.mission." + (s && s.getName()),
                amount: Game.currentGame.rewards.clover,
                isActive: s && s.isRunning() && 0 < Game.currentGame.rewards.clover,
                icon: s && s.getIcon()
            }, {
                text: "AddMovesWindow.lantern",
                amount: e && e.isActive(Game.currentGame.level) && e.getCurrentStreak(),
                isActive: e && e.isActive(Game.currentGame.level) && 0 < e.getCurrentStreak(),
                icon: bundles.game.frames.lantern_streak_icon
            }, {
                text: "AddMovesWindow.collectedGold",
                amount: Game.currentGame.rewards[GameBase.REWARD_HARD],
                isActive: !["board"].includes(cleverapps.config.type) && Game.currentGame.rewards[GameBase.REWARD_HARD] && 0 < Game.currentGame.rewards[GameBase.REWARD_HARD],
                icon: bundles.game.frames.collected_gold_png
            }].filter(function (e) {
                return e.isActive
            })
        }, cleverapps.Layout.extend({
            ctor: function (e, t, s) {
                this.data = e;
                var i, n = cleverapps.styles.BreakView,
                    e = (t || (
                        i = cleverapps.UI.generateOnlyText(e.text, s || cleverapps.styles.FONTS.WINDOW_SMALL_TEXT)), this.createAmount(s));
                this._super(t ? [e] : [i, e], {
                    margin: n.margin,
                    direction: cleverapps.UI.HORIZONTAL
                })
            },
            getPreferredBundles: function () {
                return ["game"]
            },
            createAmount: function (e) {
                return new TextWithIcon("!!x" + this.data.amount, {
                    font: e || cleverapps.styles.FONTS.BREAK_AMOUNT_TEXT,
                    icons: {
                        "!!": this.data.icon
                    }
                })
            }
        })),
        BreakViews = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            BREAK_AMOUNT_TEXT: {
                name: "nostroke",
                size: 40,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            }
        }), cleverapps.styles.BreakView = {
            margin: 10
        }, cleverapps.Layout.extend({
            ctor: function (t, s) {
                var e = cleverapps.styles.BreakViews,
                    i = cleverapps.ListBreaks().map(function (e) {
                        return new BreakView(e, t, s)
                    });
                this._super(i, {
                    margin: (t ? e.small : e).margin,
                    direction: t ? cleverapps.UI.HORIZONTAL : cleverapps.UI.VERTICAL
                })
            }
        })),
        Card = (cleverapps.styles.BreakViews = {
            margin: 10,
            small: {
                margin: 20
            }
        }, function (e) {
            e = e || {}, cleverapps.EventEmitter.call(this),
                this.opened = void 0 !== e.opened ? e.opened : "tile3" === cleverapps.config.type, this.animationEndTime = 0, this.feature = e.feature, this.featureTrigger = 0, this.canFeatureProcess = !1, this.nearToDestroy = !1, e && this.setPosition(e), e.magic && (this.magic = !0), this.marks = (e.marks || []).map(function (e) {
                    return e instanceof Mark ? e : new Mark(e)
                }), this.owner = void 0, cleverapps.environment.isEditorScene() && (this.decorators = e.decorators, this.disableEditorControls = e.disableEditorControls, void 0 === e.value && (this.random = !0)), this.setupValue(e.value), this.onReturnToScreen = function () { }, this.onGetView = function () { }, this.components = (e.components || []).map(function (e) {
                    switch (e.name) {
                        case "ice":
                            return new IceOnCard(this, e);
                        case "bomb":
                            return new BombOnCard(this, e);
                        case "chain":
                            return new ChainOnCard(this, e);
                        case "flags":
                            return new FlagsOnCard(this, e);
                        case "plate":
                            return new PlateOnCard(this, e)
                    }
                }.bind(this))
        }),
        CurtainCard = (Card.prototype = Object.create(cleverapps.EventEmitter.prototype), (Card.prototype.constructor = Card).prototype.samePlace = function (e) {
            return this.x === e.x && this.y === e.y
        }, Card.prototype.canPlay = function () {
            return this.isOpen() && !this.isBlocked()
        }, Card.prototype.isBlocked = function () {
            return this.components.some(function (e) {
                return e.isBlocked()
            })
        }, Card.prototype.animateShowUp = function (e, t) {
            this.trigger("animateShowUp", function () {
                this.afterAnimateShowUp();
                var t = 0;
                this.components.forEach(function (e) {
                    e.onShowUp && (t += e.onShowUp())
                }), t ? setTimeout(e, t) : e()
            }.bind(this), t)
        }, Card.prototype.afterAnimateShowUp = function () {
            if (this.listMarks().forEach(function (e) {
                e.alwaysVisible() && e.show()
            }), void 0 !== bundles.game.urls.card_1_effect) {
                for (var e = [], t = 1; void 0 !== bundles.game.urls["card_" + t + "_effect"];) e.push(bundles.game.urls["card_" + t + "_effect"]), t++;
                cleverapps.audio.playSound(cleverapps.Random.choose(e))
            }
        }, Card.prototype.setupValue = function (e) {
            void 0 !== e ? this.value = e : (this.canRepaint = !0, this.setRandomValue())
        }, Card.prototype.getZ = function () {
            return Game.currentGame.table.getCardOrder(this)
        },
            Card.prototype.listMarks = function () {
                return this.marks
            }, Card.prototype.getRank = function () {
                return this.value
            }, Card.prototype.setRandomValue = function () {
                this.value = Game.currentGame.generator.next()
            }, Card.prototype.getSkin = function () {
                return cleverapps.config.editorMode && void 0 === this.value ? this.isOpen() ? "skin_unknown" : "backside_unknown" : "skin_" + this.value
            }, Card.STICK_TO_GRID = function (e, t) {
                return Math.round(e / t) * t
            }, Card.prototype.canClick = function () {
                return !Game.currentGame.counter.isActive() && Game.currentGame.outcome === GameBase.OUTCOME_UNKNOWN && (void 0 !== this.owner && !this.inAnimation() && this.owner.canClick ? this.owner.canClick(this) : void 0)
            }, Card.prototype.handleClick = function () {
                for (var e = 0; e < this.components.length; e++)
                    if (this.components[e].handleClick()) return !0;
                return this.owner && this.owner.cardClicked(this)
            }, Card.prototype.onClickListener = function () {
                return Game.currentGame.counter.isActive() || Game.currentGame.outcome !== GameBase.OUTCOME_UNKNOWN || this.inAnimation() || this.handleClick() && (
                    Game.currentGame.cardsTutorial && (Game.currentGame.cardsTutorial.finishTutorialStep(), Game.currentGame.counter.trigger()), Game.currentGame.removeHint && Game.currentGame.removeHint()), !0
            }, Card.prototype.beforePlayCard = function (e) {
                e()
            }, Card.prototype.magnetHit = function () {
                Game.currentGame.table.startPlayCard(this)
            }, Card.prototype.setPosition = function (e) {
                this.x = Card.STICK_TO_GRID(e.x, Card.GRID_XY), this.y = Card.STICK_TO_GRID(e.y, Card.GRID_XY), this.r = Card.STICK_TO_GRID(e.r || e.rotation || 0, Card.GRID_ANGLE)
            }, Card.prototype.isOpen = function () {
                return this.opened
            }, Card.prototype.open = function () {
                this.opened = !0, this.wasShown = !0
            }, Card.prototype.close = function () {
                this.opened = !1
            }, Card.prototype.getRotation = function () {
                return this.r
            }, Card.prototype.getViewPosition = function () {
                return this.owner.getCardPosition(this)
            }, Card.prototype.getViewClass = function () {
                return CardView
            }, Card.prototype.setOwner = function (e) {
                this.owner = e, this.trigger("changeOwner", this.owner)
            }, Card.prototype.getScale = function () {
                return 1
            },
            Card.prototype.getSize = function () {
                return {
                    width: Card.WIDTH * this.getScale(),
                    height: Card.HEIGHT * this.getScale()
                }
            }, Card.prototype.danceMove = function () {
                if (this.canFeatureProcess) {
                    this.canFeatureProcess = !1;
                    for (var e = 0; e < this.components.length; e++) this.components[e].danceMove && this.components[e].danceMove()
                }
            }, Card.prototype.isNearToDestroy = function () {
                return this.nearToDestroy
            }, Card.prototype.setNearToDestroy = function () {
                for (var e = 0; e < this.components.length; e++)
                    if (void 0 !== this.components[e].lives && 1 < this.components[e].lives) return;
                this.nearToDestroy = !0
            }, Card.prototype.inAnimation = function () {
                return this.animationEndTime >= cleverapps.timeouts.getTime()
            }, Card.prototype.registerAnimationTime = function (e) {
                e = cleverapps.timeouts.getTime() + 1e3 * e;
                e > this.animationEndTime && (this.animationEndTime = e)
            }, Card.prototype.flip = function (e) {
                for (var t = 0; t < this.components.length; t++)
                    if (this.components[t].handleFlip(this.isOpen())) return;
                this.isOpen() ? this.close() : (this.open(), this.trigger("changeValue")),
                    this.marks.forEach(function (e) {
                        e.alwaysVisible() || (this.isOpen() ? e.show() : e.hide())
                    }.bind(this)), this.trigger("flip", e)
            }, Card.prototype.autoPlay = function () { }, Card.prototype.canBeAttacked = function () {
                for (var e = 0; e < this.components.length; e++)
                    if (this.components[e].canBeAttacked && !this.components[e].canBeAttacked()) return !1;
                return !0
            }, Card.prototype.canBeReplacedWithBoosters = function () {
                return 0 === this.components.length
            }, Card.prototype.collectMarksAndComponents = function () {
                this.marks.forEach(function (e) {
                    e.collect()
                }), this.marks = [], this.components.forEach(function (e) {
                    e.collect && e.collect()
                })
            }, Card.prototype.updateFeature = function (e) {
                this.canFeatureProcess = 0 != (this.featureTrigger & e)
            }, Card.prototype.toJSON = function () {
                var e = {
                    x: this.x,
                    y: this.y,
                    r: this.r
                };
                return cleverapps.config.editorMode || (e.marks = this.marks.map(function (e) {
                    return e.type
                }), e.components = this.components.map(function (e) {
                    return e.name
                })), void 0 === this.value || this.random || (e.value = this.value), this.feature && (e.feature = this.feature),
                    void 0 !== this.visibleIndex && (e.visibleIndex = this.visibleIndex), 0 < this.components.length && (e.components = this.components.map(function (e) {
                        return e.toJSON()
                    })), e
            }, Card.prototype.findComponent = function (e) {
                for (var t = 0; t < this.components.length; t++)
                    if (this.components[t] instanceof e) return this.components[t]
            }, Card.prototype.removeComponent = function (e) {
                for (var t = void 0, s = 0; s < this.components.length; s++)
                    if (this.components[s] instanceof e) {
                        t = s;
                        break
                    } void 0 !== t && this.components.splice(t, 1)
            }, Card.prototype.containsAnyPoint = function (t, e) {
                function s(e, t) {
                    return t = t / 180 * Math.PI, {
                        x: e.x * Math.cos(t) + e.y * Math.sin(t),
                        y: -e.x * Math.sin(t) + e.y * Math.cos(t)
                    }
                }
                var i = function (e) {
                    return Math.abs(e.x) <= this.getSize().width / 2 + 1 && Math.abs(e.y) <= this.getSize().height / 2 + 1
                }.bind(this),
                    n = t.x - this.x,
                    o = t.y - this.y,
                    e = e.map(function (e) {
                        return {
                            x: e.x * t.getScale() * .95,
                            y: e.y * t.getScale() * .95
                        }
                    });
                return 0 < (e = (e = (e = e.map(function (e) {
                    return s(e, t.getRotation())
                })).map(function (e) {
                    return {
                        x: e.x + n,
                        y: e.y + o
                    }
                })).map(function (e) {
                    return s(e,
                        -this.getRotation())
                }.bind(this))).filter(function (e) {
                    return i(e)
                }).length
            }, Card.prototype.overlaps = function (e) {
                var s = [{
                    x: 0,
                    y: 0
                }, {
                    x: Card.WIDTH / 2,
                    y: Card.HEIGHT / 2
                }, {
                    x: -Card.WIDTH / 2,
                    y: Card.HEIGHT / 2
                }, {
                    x: Card.WIDTH / 2,
                    y: -Card.HEIGHT / 2
                }, {
                    x: -Card.WIDTH / 2,
                    y: -Card.HEIGHT / 2
                }],
                    i = [e];
                return [this].some(function (t) {
                    return i.some(function (e) {
                        return t.containsAnyPoint(e, s) || e.containsAnyPoint(t, s)
                    })
                })
            }, Card.prototype.clear = function () {
                var e = this.onGetView();
                e && e.removeFromParent(), this.components = []
            }, Card.prototype.hide = function () {
                this.trigger("hide")
            }, Card.WIDTH = 120, Card.HEIGHT = 120, Card.GRID_XY = 10, Card.GRID_ANGLE = 90, Card.SHUFFLE_TIMEOUT = 1.5, Card.EXPLODE_TIMEOUT = .28, Card.RETURN_TIMEOUT = .3, Card.MOVES = {
                PLAY: 1,
                SHIFT: 2,
                UNDO: 4,
                UNSHIFT: 8
            },
            function (e) {
                Card.call(this, e), this.magicCurtain = e.magicCurtain, this.active = e.active, this.sleep = e.sleep, this.sleeping = e.sleeping, this.counter = 0, this.featureTrigger = Card.MOVES.PLAY | Card.MOVES.SHIFT, this.feature = "curtain"
            }),
        Mark = (CurtainCard.prototype = Object.create(
            Card.prototype), (CurtainCard.constructor = CurtainCard).prototype.getViewClass = function () {
                return CurtainCardView
            }, CurtainCard.prototype.toJSON = function () {
                return Object.assign(Card.prototype.toJSON.call(this), {
                    active: this.active,
                    sleep: this.sleep,
                    sleeping: this.sleeping,
                    magicCurtain: this.magicCurtain
                })
            }, CurtainCard.prototype.danceMove = function () {
                this.canFeatureProcess && (this.canFeatureProcess = !1, this.counter++, this.sleeping && this.counter === this.sleep ? (this.sleeping = !1, this.counter = 0, this.magicCurtain && (this.setRandomValue(), this.trigger("changeValue"))) : this.sleeping || this.counter !== this.active || (this.sleeping = !0, this.counter = 0), this.trigger("changeStage"))
            }, CurtainCard.prototype.canBeReplacedWithBoosters = function () {
                return !1
            }, CurtainCard.prototype.canBeAttacked = function () {
                return !this.sleeping
            }, CurtainCard.prototype.canPlay = function (e) {
                return !this.sleeping && Card.prototype.canPlay.call(this, e)
            }, CurtainCard.prototype._afterAnimateShowUp = Card.prototype.afterAnimateShowUp,
            CurtainCard.prototype.afterAnimateShowUp = function () {
                this._afterAnimateShowUp.apply(this, arguments), this.trigger("onshowup")
            }, CurtainCard.prototype._collectMarksAndComponents = Card.prototype.collectMarksAndComponents, CurtainCard.prototype.collectMarksAndComponents = function () {
                this._collectMarksAndComponents.apply(this, arguments), this.trigger("hide")
            },
            function (e) {
                cleverapps.EventEmitter.call(this), this.type = e
            }),
        BombOnCard = (Mark.prototype = Object.create(cleverapps.EventEmitter.prototype), (Mark.prototype.constructor = Mark).prototype.show = function (e) {
            this.trigger("show", e)
        }, Mark.prototype.hide = function () {
            this.trigger("hide")
        }, Mark.prototype.alwaysVisible = function () {
            return "magnet" === this.type
        }, Mark.prototype.collect = function () {
            var e, t;
            "mission" === this.type && (e = "mission_billet" + Mission.TYPE_LETTER, t = function () {
                Game.currentGame.addClover(Mission.TYPE_LETTER, 1)
            }), t && Game.currentGame.setTimeout(t, Mark.COLLECT_DURATION), this.trigger("collect", e)
        }, Mark.COIN_REWARD = 5, Mark.COLLECT_DURATION = 700, function (
            e, t) {
                this.card = e, this.counter = t.counter || 5, this.card.featureTrigger = Card.MOVES.PLAY | Card.MOVES.SHIFT, this.onChangeCounter = function () { }, this.onRemove = function () { }, this.onFlip = function () { }, this.onHide = function () { }, Game.currentGame.counter.registerStage(32, BombOnCard.process)
            }),
        PlateOnCard = (BombOnCard.prototype.getViewClass = function () {
            return BombOnCardView
        }, BombOnCard.prototype.isActive = function () {
            return this.card.isOpen()
        }, BombOnCard.prototype.collect = function () {
            return this.remove()
        }, BombOnCard.prototype.isBlocked = function () {
            return !1
        }, BombOnCard.prototype.remove = function () {
            this.card.removeComponent(BombOnCard), this.onRemove()
        }, BombOnCard.prototype.toJSON = function () {
            return {
                name: "bomb",
                counter: this.counter
            }
        }, BombOnCard.prototype.handleFlip = function () {
            this.onFlip()
        }, BombOnCard.prototype.handleClick = function () { }, BombOnCard.prototype.danceMove = function () {
            this.counter--, this.updateDanger(), this.onChangeCounter(), this.counter <= 0 && (this.counter = 0, this.readyToExplode = !0)
        },
            BombOnCard.prototype.addUntilExplode = function (e) {
                this.counter += e, this.updateDanger(), this.onChangeCounter()
            }, BombOnCard.prototype.updateDanger = function () {
                var e = this.counter <= BombOnCard.DANGER_THRESHOLD;
                this.danger !== e && (this.danger = e)
            }, BombOnCard.process = function () {
                var t, s, e = Game.currentGame,
                    i = e.table.cards.map(function (e) {
                        return e.findComponent(BombOnCard)
                    }).filter(function (e) {
                        return e && e.isActive() && !e.card.isNearToDestroy()
                    }),
                    n = i.filter(function (e) {
                        return e.readyToExplode
                    });
                0 !== n.length && (n.forEach(function (e) {
                    e.readyToExplode = !1
                }), t = function () {
                    e.counter.setTimeout(function () {
                        i.forEach(function (e) {
                            e.addUntilExplode(BombOnCard.MOVES_TO_ADD)
                        })
                    }, 100)
                }, s = function () {
                    n.forEach(function (e) {
                        e.remove()
                    }), e.counter.setTimeout(BombOnCardView.explosion, 500), e.counter.setTimeout(function () {
                        e.lose()
                    }, 1200)
                }, e.hideHint(), cleverapps.meta.display({
                    focus: "PostponeBombWindow",
                    control: ["panel_info", "opencards"],
                    filter: function () {
                        return Game.currentGame === e
                    },
                    actions: [function (e) {
                        cleverapps.timeouts.setTimeout(e, 1e3)
                    }, function (e) {
                        new ProlongationWindow({
                            type: Prolongation.TYPES.BOMB,
                            title: "PostponeBombWindow.title",
                            onSuccess: t,
                            onGiveUp: s
                        }), cleverapps.meta.onceNoWindowsListener = e
                    }]
                }))
            }, BombOnCard.MOVES_TO_ADD = 5, BombOnCard.DANGER_THRESHOLD = 3,
            function (e, t) {
                this.card = e, this.stage = (t = t || {}).stage || 0, this.card.featureTrigger = Card.MOVES.PLAY | Card.MOVES.UNDO, this.onBreakOff = function () { }, this.onCollect = function () { }, this.onDestroy = function () { }
            }),
        IceOnCard = (PlateOnCard.prototype.getViewClass = function () {
            return PlateOnCardView
        }, PlateOnCard.prototype.toJSON = function () {
            return {
                name: "plate",
                stage: this.stage
            }
        }, PlateOnCard.prototype.handleFlip = function () { }, PlateOnCard.prototype.isBlocked = function () {
            return !1
        }, PlateOnCard.prototype.handleClick = function () { }, PlateOnCard.prototype.danceMove = function () {
            if (Game.currentGame.move === Card.MOVES.UNDO) {
                if (this.stage--, this.stage < 0) return void (this.stage = 0)
            } else this.stage++;
            this.stage > PlateOnCard.PARTS || this.onBreakOff()
        },
            PlateOnCard.prototype.collect = function () {
                this.stage >= PlateOnCard.PARTS || (Game.currentGame.addClover(Mission.TYPE_LETTER, 1, !0), this.card.removeComponent(PlateOnCard), Game.currentGame.setTimeout(function () {
                    Game.currentGame.trigger("rewardClover"), this.onDestroy()
                }.bind(this), PlateOnCard.COLLECT_DURATION), this.onCollect("mission_billet" + Mission.TYPE_LETTER))
            }, PlateOnCard.PARTS = 4, PlateOnCard.COLLECT_DURATION = 1100,
            function (e, t) {
                t = t || {}, this.card = e, this.stage = t.stage || 0, this.card.featureTrigger = Card.MOVES.PLAY | Card.MOVES.UNDO | Card.MOVES.SHIFT | Card.MOVES.UNSHIFT, this.onBreakOff = function () { }, this.onDestroy = function () { }, this.onShow = function () { }, this.onHide = function () { }
            }),
        TileFactory = (IceOnCard.prototype.getViewClass = function () {
            return IceOnCardView
        }, IceOnCard.prototype.toJSON = function () {
            return {
                name: "ice",
                stage: this.stage
            }
        }, IceOnCard.prototype.isBlocked = function () {
            return this.stage < IceOnCard.PARTS
        }, IceOnCard.prototype.handleFlip = function (e) {
            e ? this.onHide() : this.onShow()
        },
            IceOnCard.prototype.handleClick = function () { }, IceOnCard.prototype.destroy = function () {
                this.isBlocked() && (this.stage = IceOnCard.PARTS, this.onBreakOff())
            }, IceOnCard.prototype.danceMove = function () {
                var e = Game.currentGame.move;
                if (e === Card.MOVES.UNDO || e === Card.MOVES.UNSHIFT) {
                    if (this.stage--, this.stage < 0) return void (this.stage = 0)
                } else this.stage++;
                this.stage > IceOnCard.PARTS || ("tile3" !== cleverapps.config.type || Game.currentGame.table.listMissed().length ? this.onBreakOff() : this.destroy())
            }, IceOnCard.prototype.magnetHit = function () {
                return this.destroy(), !1
            }, IceOnCard.PARTS = 3, {
            Create: function (e, t) {
                t = t || {}, "components" in e || !["tile3"].includes(cleverapps.config.type) || e.feature || TileFactory.addRegularComponents(e);
                var s = TileFactory.Construct(e);
                return t.noMarks || "marks" in e || s.feature || ["tile3"].includes(cleverapps.config.type) || TileFactory.addRegularMarks(s), s
            },
            Construct: function (e) {
                return new ("curtain" === e.feature ? CurtainCard : Card)(e)
            },
            addRegularMarks: function (e) {
                cleverapps.config.editorMode || cleverapps.config.wysiwygMode || e.marks.length || (Game.currentGame.getMissionType() === Mission.TYPE_LETTER && Math.random() < .1 ? e.marks.push(new Mark("mission")) : Game.currentGame.levelWithCoins && Math.random() < .1 && e.marks.push(new Mark("coin")))
            },
            addRegularComponents: function (e) {
                cleverapps.config.editorMode || cleverapps.config.wysiwygMode || (e.components = e.components || [], Game.currentGame.getMissionType() === Mission.TYPE_LETTER && Game.currentGame.pagination.isLast() && Math.random() < .15 && e.components.push({
                    name: "plate"
                }))
            }
        }),
        OpenCards = function (e, t) {
            cleverapps.EventEmitter.call(this), this.cards = [], this.limit = cleverapps.gameModes.threeOpenCards ? 3 : 7, this.stableTime = 0, t && this.loadSave(t), this.getView = function () { }
        },
        TileTable = (OpenCards.prototype = Object.create(cleverapps.EventEmitter.prototype), (OpenCards.prototype.constructor = OpenCards).prototype.getCardPosition = function (e) {
            var t = {},
                s = this.getView();
            return s && (t.parent = s, t.point = s.findPosForCard(e)), t
        },
            OpenCards.prototype.loadSave = function (e) {
                e.forEach(function (e) {
                    var t = TileFactory.Create(e, {
                        noMark: !0
                    });
                    t.visibleIndex = e.visibleIndex, this.addCard(t), t.flip()
                }.bind(this))
            }, OpenCards.prototype.getInfo = function () {
                return this.cards.map(function (e) {
                    return e.toJSON()
                })
            }, OpenCards.prototype.canExplodeCard = function (e, t) {
                return this.cards[e].value === t && !this.cards[e].inAnimation() && this.cards[e].visibleIndex === e
            }, OpenCards.prototype.explodeThreeInRow = function (e, t) {
                for (cleverapps.audio.playSound(t ? bundles.game.urls.tile_flip_effect : bundles.game.urls.collection_effect), this.trigger("explode", [this.cards[e], this.cards[e + 1], this.cards[e + 2]], t), this.cards.splice(e, 3); e < this.cards.length;) this.cards[e].registerAnimationTime(Card.EXPLODE_TIMEOUT), e++;
                this.counterDelay(Card.EXPLODE_TIMEOUT)
            }, OpenCards.prototype.explode = function (e) {
                for (var t = this.cards.length - 3; 0 <= t; t--) {
                    var s = this.cards[t].value;
                    if (this.canExplodeCard(t, s) && this.canExplodeCard(t + 1, s) && this.canExplodeCard(t + 2, s)) return s = e && 3 === this.cards.length, this.explodeThreeInRow(t, s), Game.currentGame.log.clear(), void this.counterDelay(s ? .8 : 0)
                }
            }, OpenCards.prototype.counterDelay = function (e) {
                e *= 1e3, this.stableTime = Math.max(this.stableTime, cleverapps.timeouts.getTime() + e), cleverapps.timeouts.setTimeout(Game.currentGame.counter.trigger.bind(Game.currentGame.counter), e)
            }, OpenCards.prototype.checkLose = function () {
                if (this.isStable() && (this.checkWarning(), this.isFull())) return this.trigger("overflow"), !0
            }, OpenCards.prototype.checkWarning = function () {
                var e = this.cards.length >= this.limit - 2;
                this.trigger("warning", e)
            }, OpenCards.prototype.reindexTimeout = function (e) {
                return (e + 3) / 3 * .1
            }, OpenCards.prototype.reindex = function () {
                for (var e, t = 0; t < this.cards.length; t++) this.cards[t].inAnimation() || this.cards[t].visibleIndex === t || (e = this.reindexTimeout(Math.abs(this.cards[t].visibleIndex - t)), this.cards[t].visibleIndex = t, this.cards[t].registerAnimationTime(e + .05), this.moveToOpen(this.cards[t], e), this.counterDelay(e + .05))
            },
            OpenCards.prototype.moveToOpen = function (e, t, s) {
                e.trigger("moveToOpen", t, s)
            }, OpenCards.prototype.isEmpty = function () {
                return 0 === this.cards.length
            }, OpenCards.prototype.isFull = function () {
                return this.cards.length === this.limit
            }, OpenCards.prototype.isStable = function () {
                return this.stableTime <= cleverapps.timeouts.getTime()
            }, OpenCards.prototype.canPlay = function (e) {
                return !this.isFull() && e.canPlay()
            }, OpenCards.prototype.acceptCard = function (e) {
                this.addCard(e), e.collectMarksAndComponents(), e.isOpen() || e.flip();
                for (var t = Math.max((e.y + 600) / 3e3, .1) + .1, s = this.cards.length - 1, i = s - 1; 0 <= i; i--)
                    if (this.cards[i].value === e.value) {
                        (i < 2 || this.cards[i - 2].value !== e.value) && (s = i + 1);
                        break
                    } if (s !== this.cards.length - 1) {
                        for (var n = Math.max(t - .2, 0), i = this.cards.length - 1; s < i; i--) this.cards[i] = this.cards[i - 1], this.cards[i].registerAnimationTime(n);
                        this.cards[s] = e, this.counterDelay(n)
                    }
                0 < (e.visibleIndex = s) && e.visibleIndex <= this.cards[s - 1].visibleIndex && this.cards[s - 1].inAnimation() && this.cards[s - 1].animationEndTime + 200 > cleverapps.timeouts.getTime() + 1e3 * t && (e.visibleIndex = Math.min(this.cards[s - 1].visibleIndex + 1, this.limit - 1)), this.moveToOpen(e, t, !0), e.registerAnimationTime(t), this.counterDelay(t)
            }, OpenCards.prototype.addCard = function (e) {
                this.cards.push(e), e.setOwner(this)
            }, OpenCards.prototype.cardClicked = function () {
                if (cleverapps.config.debugMode && !this.isFull())
                    for (var e = Game.currentGame.table, t = e.cards, s = t.length - 1; 0 <= s; s--) {
                        var i = t[s];
                        if (i.isOpen() && "safe" !== i.feature) {
                            var n = i.findComponent(PlateOnCard);
                            n && n.collect(), "undefined" == typeof FlagsOnCard || (n = i.findComponent(FlagsOnCard)) && n.destroy(), void 0 === IceOnCard || (n = i.findComponent(IceOnCard)) && n.destroy(), e.startPlayCard(i);
                            break
                        }
                    }
                return !1
            }, OpenCards.prototype.shift = function () {
                var e = this.cards.shift();
                if (e) return e.setOwner(Game.currentGame.table), this.trigger("pop", e), e
            }, OpenCards.prototype.pop = function (e) {
                for (var t = e.options.value, s = void 0, i = this.cards.length - 1; 0 <= i; i--)
                    if (this.cards[i].value === t) {
                        s = i;
                        break
                    } if (void 0 !== s) return e = this.cards[s], this.cards.splice(s, 1), this.counterDelay(0), e.setOwner(Game.currentGame.table), this.trigger("pop", e), e
            }, OpenCards.prototype.clear = function () {
                this.cards.forEach(function (e) {
                    e.clear()
                }), this.cards = []
            }, OpenCards.prototype.getCurrentCard = function () {
                if (0 !== this.cards.length) return this.cards[this.cards.length - 1]
            }, OpenCards.OVERFLOW_ANIMATION_DURATION = 500,
            function () {
                cleverapps.EventEmitter.call(this), this.orientation = "horizontal" === cleverapps.config.orientation ? TileTable.ORIENTATION_HORIZONTAL : TileTable.ORIENTATION_VERTICAL, this.canvas = this.getCanvas(), this.getView = function () { }, this.cards = []
            }),
        TileGenerator = (TileTable.prototype = Object.create(cleverapps.EventEmitter.prototype), (TileTable.prototype.constructor = TileTable).prototype.getCanvas = function () {
            return this.orientation === TileTable.ORIENTATION_HORIZONTAL ? {
                width: 1600,
                height: 800
            } : {
                width: 800,
                height: 1e3
            }
        }, TileTable.REPAINT = function (i) {
            for (var e = 0; e < i.length; e++)
                if (i[e].canRepaint) {
                    var t = {};
                    for (
                        s = e - 1; 0 <= s; s--) ! function (e, t) {
                            if (!i[e].overlaps(i[t])) return !1;
                            for (var s = e + 1; s < t; s++)
                                if (i[s].overlaps(i[t]) && i[e].overlaps(i[s])) return !1;
                            return !0
                        }(s, e) || (t[i[s].value] = !0);
                    if (t[i[e].value]) {
                        var s, n, o = [];
                        for (s = e + 1; s < i.length; s++) i[s].canRepaint && !t[i[s].value] && o.push(s);
                        0 < o.length && (s = cleverapps.Random.choose(o), n = i[e].value, i[e].value = i[s].value, i[s].value = n)
                    }
                }
        }, TileTable.RESORT = function (e) {
            for (var t, s = e.length - 2; 0 <= s;) s + 1 <= e.length - 1 && !e[s + 1].overlaps(e[s]) && (e[s + 1].y > e[s].y || e[s + 1].y === e[s].y && e[s + 1].x < e[s].x) ? (t = e[s + 1], e[s + 1] = e[s], e[s] = t, s++) : s--
        }, TileTable.prototype.setCards = function (e, t, s) {
            e = (e = e.concat((t = t || []).map(function (e) {
                return Object.assign(e, {
                    magic: !0
                })
            }))).map(function (e) {
                return e
            }).flat(), Game.currentGame.generator.reset(e, s), e = e.map(function (e) {
                return TileFactory.Create(e)
            }), TileTable.RESORT(e), TileTable.REPAINT(e), (this.cards = e).forEach(function (e) {
                e.setOwner(this)
            }, this), this.stacksPosition = void 0, this.trigger("resetCards")
        },
            TileTable.prototype.listMissed = function () {
                return this.cards.filter(function (e) {
                    return e.canPlay()
                })
            }, TileTable.prototype.getStacksPosition = function () {
                return void 0 === this.stacksPosition && (this.stacksPosition = cc.p(cc.rectGetCenter(this.rect).x, this.rect.y - Card.HEIGHT)), this.stacksPosition
            }, TileTable.prototype.push3CardsToStack = function (e) {
                var i = [-1, 0, 1].map(function (e) {
                    var t = this.getStacksPosition();
                    return cc.p(t.x + e * Card.WIDTH, t.y)
                }, this),
                    t = (e.forEach(function (t, e) {
                        e = i[e];
                        t.setPosition(e);
                        for (var s = 0; s < 5; s++) {
                            if (!this.cards.find(function (e) {
                                return e.samePlace(t)
                            })) break;
                            t.y -= Card.GRID_XY
                        }
                        this.addCard(t)
                    }, this), this.rect);
                e.forEach(function (e) {
                    t = cc.rectUnion(t, cc.rect(e.x - Card.WIDTH / 2, e.y - Card.HEIGHT / 2, Card.WIDTH, Card.HEIGHT))
                }), this.setRect(t)
            }, TileTable.prototype.animateUpdateSize = function () {
                this.trigger("animatedChangeSize")
            }, TileTable.prototype.updateSize = function () {
                this.trigger("changeSize")
            }, TileTable.prototype.calcRect = function (e) {
                if (0 === (e = e || this.cards).length) return cc.rect(0,
                    0, 0, 0);
                var o = cc.rect(e[0].x - Card.WIDTH / 2, e[0].y - Card.HEIGHT / 2, Card.WIDTH, Card.HEIGHT);
                return e.forEach(function (e) {
                    var t = Card.WIDTH * e.getScale(),
                        s = Card.HEIGHT * e.getScale(),
                        i = e.r * Math.PI / 180,
                        n = Math.abs(t * Math.cos(i) + Math.abs(s * Math.sin(i))),
                        s = Math.abs(s * Math.cos(i)) + Math.abs(t * Math.sin(i));
                    o = cc.rectUnion(o, cc.rect(e.x - n / 2, e.y - s / 2, n, s))
                }), o
            }, TileTable.prototype.setRect = function (e) {
                this.rect = e || this.calcRect()
            }, TileTable.prototype.getCardPosition = function (e) {
                return {
                    parent: this.getView(),
                    point: CardView.convertToViewPosition(e)
                }
            }, TileTable.prototype.getInfo = function () {
                var e = this.cards.filter(function (e) {
                    return !e.magic
                }).map(function (e) {
                    return e.toJSON()
                }),
                    t = (Game.currentGame.streakCard && e.push(Game.currentGame.streakCard.toJSON()), this.cards.filter(function (e) {
                        return e.magic
                    }).map(function (e) {
                        return e.toJSON()
                    }));
                return {
                    rect: this.rect,
                    cards: e,
                    magic: t
                }
            }, TileTable.prototype.isEmpty = function () {
                return 0 === this.cards.length
            }, TileTable.prototype.canClick = function (e) {
                return e.isOpen()
            },
            TileTable.prototype.cardClicked = function (e) {
                return !!e.isOpen() && (Game.currentGame.open.canPlay(e) ? (this.startPlayCard(e), !0) : (e.trigger("wrongMove"), !1))
            }, TileTable.prototype.startPlayCard = function (e) {
                cleverapps.audio.playSound(bundles.game.urls.play_tile_effect, {
                    throttle: 0
                }), e.index = e.getZ(), this.removeCard(e), e.trigger("removeFromTable"), e.trigger("hideTutorial"), Game.currentGame.playCard(e)
            }, TileTable.prototype.removeCard = function (e) {
                e = this.cards.indexOf(e);
                this.cards.splice(e, 1)
            }, TileTable.prototype.getCardOrder = function (e) {
                return this.cards.indexOf(e)
            }, TileTable.prototype.shuffle = function () {
                var e = cleverapps.Random.shuffle(this.cards.map(function (e, t) {
                    return {
                        index: t,
                        position: cc.p(e.x, e.y)
                    }
                })),
                    s = new Array(e.length);
                e.forEach(function (e, t) {
                    s[e.index] = this.cards[t], s[e.index].setPosition(e.position)
                }, this), this.cards = s, this.cards.forEach(function (e) {
                    e.open();
                    for (var t = 0; t < e.components.length; t++) e.components[t].handleFlip(e.isOpen(), {
                        shuffle: !0
                    });
                    e.trigger("flip")
                }, this), this.trigger(
                    "shuffle"), Game.currentGame.counter.setTimeout(function () { }, 1e3 * Card.SHUFFLE_TIMEOUT)
            }, TileTable.prototype.findCardsToBlow = function () {
                var e, s = {},
                    i = {},
                    t = (this.cards.forEach(function (e, t) {
                        s[e.value] || (s[e.value] = [], i[e.value] = 0), e.opened || !this.cardOverlapping(t) ? (i[e.value]++, s[e.value].unshift(e)) : s[e.value].push(e)
                    }.bind(this)), []);
                for (e in i) t.push({
                    amount: i[e],
                    value: e
                });
                t.sort(function (e, t) {
                    return t.amount - e.amount
                });
                for (var n = 0; n < t.length; n++)
                    if (3 <= s[t[n].value].length) return s[t[n].value].slice(0, 3)
            }, TileTable.prototype.blowCards = function (n) {
                cleverapps.meta.distract({
                    focus: "blowCards",
                    keepControls: !0,
                    action: function (e) {
                        for (var t = [], s = 0; s < n; s++) {
                            var i = this.findCardsToBlow();
                            i && (i.forEach(function (e) {
                                Game.currentGame.table.removeCard(e), e.trigger("removeFromTable"), e.trigger("hideTutorial")
                            }), t.push(i))
                        }
                        this.trigger("blowCards", t.flat(), function () {
                            e(), Game.currentGame.counter.trigger()
                        })
                    }.bind(this)
                })
            }, TileTable.ListMagicCards = function (e) {
                var t = "horizontal" === cleverapps.config.orientation ? TileTable.ORIENTATION_HORIZONTAL : TileTable.ORIENTATION_VERTICAL;
                return (t = cleverapps.environment.isEditorScene() ? Game.currentGame.table.getOrientation() : t) === TileTable.ORIENTATION_HORIZONTAL ? e.magicH : e.magicV
            }, TileTable.prototype.getAmountOfCards = function () {
                return this.cards.length
            }, TileTable.prototype.addCard = function (e, t) {
                t = t || this.cards.length, this.cards.splice(t, 0, e), e.setOwner(this);
                for (var s = 0; s < this.cards.length; s++) this.cards[s].trigger("updateZ")
            }, TileTable.prototype.hasCard = function (e) {
                return -1 !== this.cards.indexOf(e)
            }, TileTable.prototype.insertBeforeCard = function (e, t) {
                e = this.cards.indexOf(e);
                this.cards.splice(e, 0, t);
                for (var s = 0; s < this.cards.length; s++) this.cards[s].trigger("updateZ")
            }, TileTable.prototype.replaceCard = function (e, t) {
                e = this.cards.indexOf(e);
                this.cards[e] = t
            }, TileTable.prototype.cardOverlapping = function (e, t) {
                for (var s = e + 1; s < this.cards.length; s++)
                    if ((t || this.cards[e]).overlaps(this.cards[s])) return !0;
                return !1
            },
            TileTable.prototype.showCards = function (t, s) {
                var i = cleverapps.wait(this.cards.length, function () {
                    if ("tile3" === cleverapps.config.type && !s)
                        for (var e = 0; e < this.cards.length; e++) this.shouldFlipCard(e) || this.cards[e].listMarks().forEach(function (e) {
                            e.show()
                        });
                    t()
                }.bind(this)),
                    n = this.calcShowUpDelays(s);
                this.cards.forEach(function (e, t) {
                    s ? e.animateShowUp(i, s) : ("tile3" === cleverapps.config.type && e.listMarks().forEach(function (e) {
                        e.hide()
                    }), Game.currentGame.counter.setTimeout(function () {
                        e.animateShowUp(i)
                    }, n[t]))
                })
            }, TileTable.prototype.flipNormalize = function (e, t) {
                for (var s = [], i = this.cards.length - 1; 0 <= i; i--) this.shouldFlipCard(i) && s.push(this.cards[i]);
                if ("solitaire" !== cleverapps.config.type || cleverapps.environment.isAdministratorScene() || cleverapps.environment.isEditorScene() || this.avoidOpenCardsWithSamesRanks(s), e)
                    if (s.sort(function (e, t) {
                        var s = Math.round(e.y / 200),
                            i = Math.round(t.y / 200);
                        return s !== i ? i - s : e.x - t.x
                    }), t) s.forEach(function (e) {
                        e.flip(t)
                    }), e();
                    else {
                        this.sound = cleverapps.audio.playSound(
                            bundles.game.urls.blackout_effect);
                        for (var n = "tile3" === cleverapps.config.type ? 1e3 / s.length : 50, o = [], a = 0; a < s.length; a++) o.push(a * n);
                        "solitaire" === cleverapps.config.type && (o = cleverapps.Random.shuffle(o));
                        var r = cleverapps.wait(s.length, function () {
                            cleverapps.audio.stopSound(this.sound), cleverapps.audio.playSound(bundles.game.urls.card_1_effect), e()
                        }.bind(this));
                        s.forEach(function (e, t) {
                            setTimeout(function () {
                                e.flip(), r()
                            }, o[t])
                        })
                    }
                else s.forEach(function (e) {
                    e.flip(cleverapps.environment.isEditorScene() || cleverapps.environment.isAdministratorScene())
                })
            }, TileTable.prototype.avoidOpenCardsWithSamesRanks = function (e) {
                var t = this.cards.filter(function (e) {
                    return e.isOpen()
                }),
                    i = {},
                    s = (t.forEach(function (e) {
                        i[e.getRank()] = !0
                    }), e.filter(function (e) {
                        return !e.isOpen() && !e.wasShown && !e.feature
                    })),
                    n = this.cards.filter(function (e) {
                        return !(e.isOpen() || e.wasShown || i[e.getRank()] || e.feature || s.includes(e))
                    });
                s.forEach(function (e) {
                    if (i[e.getRank()]) {
                        if (n.length) {
                            var t = n[0].value;
                            n[0].value = e.value, e.value = t
                        } else
                            for (var s = 0; s < 30 && (e.setRandomValue(), i[e.getRank()]); s++);
                        i[e.getRank()] = !0, n = n.filter(function (e) {
                            return !i[e.getRank()]
                        })
                    }
                })
            }, TileTable.prototype.shouldFlipCard = function (e) {
                var t = this.cards[e],
                    e = this.cardOverlapping(e);
                return !t.isOpen() && !e || t.isOpen() && e
            }, TileTable.prototype.returnCard = function (e, t) {
                e.onReturnToScreen(t), e.registerAnimationTime(Card.RETURN_TIMEOUT), Game.currentGame.counter.trigger()
            }, TileTable.prototype.listOpen = function () {
                return this.cards.filter(function (e) {
                    return e.isOpen()
                })
            }, TileTable.prototype.calcShowUpDelays = function () {
                for (var s, e = 0, t = !0; t;) {
                    for (var t = !1, i = 0; i < this.cards.length; i++)
                        if (void 0 === this.cards[i].deep) {
                            for (var n = !1, o = i + 1; o < this.cards.length; o++)
                                if (this.cards[i].overlaps(this.cards[o]) && void 0 === this.cards[o].deep) {
                                    n = !0;
                                    break
                                } n || (this.cards[i].deep = e, t = !0)
                        } e--
                }
                this.cards.sort(function (e, t) {
                    return e.deep !== t.deep ? e.deep - t.deep : 10 * e.x + e.y - 10 * t.x - t.y
                });
                var a = 0,
                    r = [],
                    c = [];
                return this.cards.forEach(function (e, t) {
                    s !== e.deep && (void 0 !== s && (a += 50),
                        s = e.deep, c.push([])), c[c.length - 1].push(50 * t + a)
                }, this), c.forEach(function (e) {
                    var t = e.splice(0, e.length / 2);
                    r = r.concat(t.concat(cleverapps.Random.shuffle(e)))
                }), r
            }, TileTable.prototype.updateFeatures = function (t) {
                this.cards.forEach(function (e) {
                    e.updateFeature(t)
                })
            }, TileTable.prototype.clear = function () {
                this.cards.forEach(function (e) {
                    e.clear()
                }), this.cards = []
            }, TileTable.DIRECTIONS = [{
                x: 0,
                y: -1
            }, {
                x: -1,
                y: 0
            }, {
                x: 0,
                y: 1
            }, {
                x: 1,
                y: 0
            }], TileTable.MAX_SCALE = 1.7, TileTable.ORIENTATION_HORIZONTAL = 0, TileTable.ORIENTATION_VERTICAL = 1,
            function () {
                this._index = -1, this._cache = []
            }),
        TilesTutorial = (TileGenerator.prototype.reset = function (e, t) {
            this._cache = cleverapps.Random.shuffle(this.listTiles(e, t)), this._index = -1
        }, TileGenerator.prototype.getAvailableSkins = function () {
            var e = 8 + 2 * (cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.UNLOCKED_TILES_STAGES) || 0),
                t = this.getExistingSkins(),
                s = t.default;
            if (cleverapps.gameModes.replaceTiles) return {
                skins: s = (s = cleverapps.Random.shuffle(t.event).concat(t.default)).slice(0, e),
                new: []
            };
            t = Math.min(e, s.length), e = s.length >= e ? 2 : Math.max(s.length - e + 2, 0), e = (t = s.splice(0, t)).splice(-e, e), t = cleverapps.Random.shuffle(t);
            return {
                new: e,
                skins: e.concat(t).concat(s)
            }
        }, TileGenerator.prototype.getExistingSkins = function () {
            for (var e = {
                default: []
            }, t = 0; bundles.card.frames["skin_" + t];) e.default.push(t), t++;
            if (cleverapps.gameModes.replaceTiles)
                for (e.event = [], t = 0; bundles.card.frames["skin_event_" + t];) e.event.push("event_" + t), t++;
            return e
        }, TileGenerator.prototype.listTiles = function (e, t) {
            for (var s = [], i = this.getAvailableSkins().skins, n = [], o = 0; o < 100; o++) n.push(0);
            e.forEach(function (e) {
                void 0 !== e.value && n[e.value]++
            });
            for (var a = e.filter(function (e) {
                return void 0 === e.value
            }).length, o = 0; o < n.length; o++)
                if (n[o] % 3 != 0)
                    for (var r = 3 - n[o] % 3, c = 0; c < r && 0 < a; c++) a--, s.push(o);
            for (var l = 0; l < a; l++) {
                var p = Math.floor(l / 3);
                s.push(i[p % t])
            }
            return s
        }, TileGenerator.prototype.next = function () {
            return this._index++, this._index === this._cache.length && (this._index = 0), this._cache[this._index]
        },
            TileGenerator.prototype.clear = function () {
                delete this._cache
            },
            function (e) {
                this.level = e, this.config = TilesTutorial.TutorialConfig(e), this.handValues = cleverapps.clone(this.config.handValues, !0) || [], this.step = 0, cleverapps.eventLogger.logEvent(cleverapps.EVENTS.STATS.TUTORIAL_BEGIN)
            }),
        MovesLog = (TilesTutorial.prototype.runForce = function (e, t) {
            return !cleverapps.meta.isFocused() && (this.running = !0, this.showForce(e, t), !0)
        }, TilesTutorial.prototype.showTutorialStep = function () {
            if (this.config.tutorial && !this.running) {
                var e = this.config.tutorial[this.step];
                if (e) {
                    if (e.type === TilesTutorial.TYPE_WILDCARD) return Game.currentGame.wildcardBooster.activateTutorial(), this.runForce(cleverapps.scenes.getRunningScene().wildCardButton, e);
                    var t = Game.currentGame.getCardForHint(e);
                    if (t) return void 0 !== e.force ? this.runForce(t.onGetView(), e) : t && !t.inAnimation() ? (this.running = !0, (this.hintCard = t).trigger("showTutorial"), !0) : void 0;
                    e.amountExtraCards && (Game.currentGame.hand.addExtra(e.amountExtraCards, {}),
                        Game.currentGame.hand.extra.setEnable(!0))
                }
            }
        }, TilesTutorial.prototype.finishTutorialStep = function () {
            this.running && (this.step += 1, this.running = !1, this.step === this.config.tutorial.length && cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GENERAL.TUTORIAL_COMPLETE), cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce())
        }, TilesTutorial.prototype.getCurrentStep = function () {
            return this.config.tutorial[this.step]
        }, TilesTutorial.TYPE_JACKPOT = 0, TilesTutorial.TYPE_WILDCARD = 1, TilesTutorial.prototype.isApplicable = function (e, t) {
            if (!t) return !1;
            for (var s = 0; s < t.length; s++)
                if ("function" == typeof t[s]) {
                    if (e instanceof t[s] || e.findComponent(t[s])) return !0
                } else if (e.getRank() === t[s]) return !0;
            return !1
        }, TilesTutorial.prototype.showForce = function (s, i) {
            var e = cleverapps.scenes.getRunningScene(),
                n = Game.currentGame.table.listOpen().filter(function (e) {
                    return this.isApplicable(e, i.filter)
                }, this).map(function (e) {
                    return e.onGetView()
                }),
                t = n.filter(function (t) {
                    return t !== s && (
                        this.config.importantCards || []).some(function (e) {
                            return t.card instanceof e || t.card.findComponent(e)
                        })
                }.bind(this)),
                o = (o = Game.currentGame.table.cards.map(function (e) {
                    return e.onGetView()
                })).filter(function (e) {
                    return e !== s
                }),
                a = (e.openCardsControl && (o.push(e.openCardsControl), t.push(e.openCardsControl)), {
                    highlights: o,
                    importantNodes: t
                }),
                e = ["opencards"];
            i.type === TilesTutorial.TYPE_WILDCARD && e.push("hint_" + cleverapps.Boosters.TYPE_WILDCARD), cleverapps.meta.display({
                focus: "cardtutorial",
                control: e,
                actions: [function (e) {
                    var t;
                    i.type === TilesTutorial.TYPE_JACKPOT ? (t = n.filter(function (e) {
                        return Card.VALUES.indexOf(i.filter[0].toLowerCase()) === e.card.getCardValue()
                    })[0], Game.currentGame.addJackpot(e, t.card)) : e()
                }, function (e) {
                    Game.currentGame.counter.setTimeout(e, 1e3 * Card.PLAY_TIMEOUT)
                }, function (e) {
                    cleverapps.forces.create(s, {
                        text: i.force,
                        pointer: !0,
                        position: this.config.position,
                        finger: {
                            delay: 10
                        }
                    }, a), cleverapps.forces.onceForceClosed = e
                }.bind(this)]
            })
        }, TilesTutorial.IsAvailable = function (t) {
            return !cleverapps.config.editorMode && 0 < TilesTutorial.TUTORIAL_LEVELS.filter(function (e) {
                return t.episodeNo === e.episode && t.levelNo === e.level
            }).length
        }, TilesTutorial.TutorialConfig = function (t) {
            return TilesTutorial.TUTORIAL_LEVELS.filter(function (e) {
                return t.episodeNo === e.episode && t.levelNo === e.level
            })[0]
        }, TilesTutorial.prototype.getHandValue = function () {
            return this.handValues.shift()
        }, TilesTutorial.TUTORIAL_LEVELS = [{
            episode: 0,
            level: 0,
            tutorial: [{
                force: "InitialTutorialMessage1",
                value: 1,
                filter: [1]
            }].concat(cleverapps.arrayFill(2, {
                action: "highlight",
                value: 1
            }))
        }, {
            episode: 3,
            level: 3,
            tutorial: [{
                force: "BombTutorialMessage",
                component: BombOnCard,
                filter: [BombOnCard]
            }]
        }, {
            episode: 4,
            level: 11,
            importantCards: [IceOnCard],
            tutorial: [{
                force: "IceTutorialMessage",
                filter: [IceOnCard]
            }]
        }, {
            episode: 5,
            level: 0,
            importantCards: [CurtainCard],
            tutorial: [{
                force: "CurtainTutorialMessage",
                filter: [CurtainCard]
            }]
        }], function (e, t) {
            cleverapps.EventEmitter.call(this), this.tilegame = e,
                this.undoBooster = cleverapps.boosters.getBoosterById(cleverapps.Boosters.TYPE_UNDO), this.onShowForceListener = function () { }, this.log = [], t && (this.log = t.log), this.tilegame.pagination && this.tilegame.pagination.on("changePage", this.clear.bind(this))
        }),
        TileGame = (MovesLog.prototype = Object.create(cleverapps.EventEmitter.prototype), (MovesLog.prototype.constructor = MovesLog).MOVE_PLAY_CARD = 0, MovesLog.prototype.getInfo = function () {
            return {
                log: this.log.slice()
            }
        }, MovesLog.prototype.isEmpty = function () {
            return 0 === this.log.length
        }, MovesLog.prototype.clear = function () {
            this.log = [], this.trigger("change")
        }, MovesLog.prototype.showAlert = function () {
            this.isEmpty() || this.trigger("showAlert")
        }, MovesLog.prototype.push = function (e, t) {
            this.log.push({
                type: e,
                options: t
            }), this.trigger("change")
        }, MovesLog.prototype.showUndoForce = function () {
            this.undoBooster.showForce()
        }, MovesLog.prototype.isUndoNeedOnPreviousMove = function () {
            return this.getLastMove()
        }, MovesLog.prototype.isUndoForceAvailable = function () {
            return !(
                !Game.currentGame || Game.currentGame.cardsTutorial || Game.currentGame.outcome !== GameBase.OUTCOME_UNKNOWN || !this.undoBooster.isForceAvailable()) && this.isUndoNeedOnPreviousMove()
        }, MovesLog.prototype.getLastMove = function () {
            return this.log[this.log.length - 1]
        }, MovesLog.prototype.showTutorialStep = function () {
            if (this.isUndoForceAvailable()) return this.showUndoForce(), !0;
            this.tutorialCard && (this.tutorialCard.trigger("hideTutorial"), delete this.tutorialCard)
        }, MovesLog.prototype.undoPlayCard = function (e) {
            e = this.tilegame.open.pop(e);
            this.tilegame.undoCard(e)
        }, MovesLog.prototype.executeUndo = function () {
            var e = this.log.pop();
            this.undoPlayCard(e), this.trigger("change")
        }, function (e, t) {
            GameBase.call(this, e, t), this.levelWithCoins = cleverapps.user.checkAvailable(GameBase.LEVEL_WITH_COINS_AVAILABLE) && !["tile3"].includes(cleverapps.config.type), cleverapps.config.debugMode && cleverapps.flags.goldOnCardsDisabled && (this.levelWithCoins = !1), this.generator = new TileGenerator, this.pagination = new cleverapps.Pagination(
                this.level.content.screens.length, this.savedGame.page);
            e = cleverapps.environment.isEditorScene() ? EditorCardTable : TileTable, this.table = new e, this.log = new MovesLog(this, this.savedGame.log), this.open = new OpenCards(this.level, this.savedGame.open), this.levelWithTutorial() && (this.cardsTutorial = new TilesTutorial(this.level)), t = this.savedGame.page || 0;
            this.setPage(t, this.savedGame), this.pagination.on("changePage", this.setPage.bind(this)), this.counter.registerStage(4, this.danceMove.bind(this)), this.counter.registerStage(5, this.flip.bind(this)), this.counter.registerStage(10, this.autoPlayOneCard.bind(this)), this.counter.registerStage(20, this.changeScreen.bind(this)), this.counter.registerStage(40, this.checkWin.bind(this)), this.counter.registerStage(50, this.showTutorialStep.bind(this)), this.counter.registerStage(55, this.afterPlayer.bind(this)), this.counter.registerStage(60, this.activateBoosters.bind(this)), this.userStatus.on("active", this.removeHint.bind(this), this), this.userStatus.on(
                "inactive_very_short", this.showHint.bind(this), this)
        }),
        TileGameScene = (TileGame.prototype = Object.create(GameBase.prototype), (TileGame.constructor = TileGame).prototype.setPage = function (e, t) {
            var s = this.level.content.screens[e],
                i = s.cards,
                i = (s.cards && (!s.horizontalCards || cleverapps.resolution.mode !== cleverapps.WideMode.HORIZONTAL || cleverapps.environment.isEditorScene()) || (i = s.horizontalCards), t && t.table && t.table.cards || i),
                n = t && t.table && t.table.magic || TileTable.ListMagicCards(s),
                o = t && t.table && t.table.rect;
            this.table.setCards(i, n, s.maxValue), this.table.setRect(o), this.table.updateSize(), this.updateClovers(), 0 === e || (!t || t.page) && t || this.table.flipNormalize()
        }, TileGame.prototype.getInfo = function () {
            var e = GameBase.prototype.getInfo.call(this);
            return this.stopped || (e.table = this.table.getInfo(), e.log = this.log.getInfo()), e
        }, TileGame.prototype.storeSave = function () { }, TileGame.prototype.afterPlayer = function () {
            void 0 !== this.move && (this.stopped || this.userStatus.reportUserAction(), this.move = !1)
        },
            TileGame.prototype.flip = function (e, t) {
                this.table.flipNormalize(e, t)
            }, TileGame.prototype.autoPlayOneCard = function () {
                if (!cleverapps.environment.isSceneWithPreview() && !this.introPlaying)
                    for (var e = this.table.cards.filter(function (e) {
                        return e.isOpen()
                    }), t = 0; t < e.length; t++)
                        if (e[t].autoPlay(), this.counter.isActive()) break
            }, TileGame.prototype.danceMove = function () {
                this.move && this.table.cards.filter(function (e) {
                    return e.isOpen() && !e.inAnimation()
                }).forEach(function (e) {
                    e.danceMove()
                })
            }, TileGame.prototype.changeScreen = function () {
                this.table.isEmpty() && this.outcome === GameBase.OUTCOME_UNKNOWN && this.open.isStable() && !cleverapps.environment.isEditorScene() && this.pagination.nextPage()
            }, TileGame.prototype.isWin = function () {
                return this.table.isEmpty() && this.open.isStable() && this.pagination.isLast()
            }, TileGame.prototype.checkWin = function () {
                this.isWin() && this.win()
            }, TileGame.prototype.getDailyCupStars = function () {
                return this.beginCards
            }, TileGame.prototype.showScreen = function (e, s) {
                cleverapps.meta.compound(e, [
                    function (e) {
                        var t = ["opencards"];
                        cleverapps.Boosters.listBoostersIds().forEach(function (e) {
                            t.push("hint_" + e)
                        }), cleverapps.meta.showControlsWhileFocused(t), this.table.updateSize(), this.table.showCards(e, s)
                    }.bind(this),
                    function (e) {
                        this.flip(e, s)
                    }.bind(this)
                ])
            }, TileGame.prototype.beforeGameStart = function (e) {
                this.beginCards = this.countOfCardsToPlay(), this.competition && this.competition.start(), e()
            }, TileGame.prototype.playCard = function (e) {
                this.move = Card.MOVES.PLAY, this.table.updateFeatures(this.move), cleverapps.dailyTasks && cleverapps.dailyTasks.processOpenCard(e), this.open.acceptCard(e), e.feature ? this.log.clear() : this.log.push(MovesLog.MOVE_PLAY_CARD, {
                    value: e.value
                }), this.score.addPoints(10), this.counter.trigger()
            }, TileGame.prototype.undoCard = function (e) {
                this.table.addCard(e, e.index), this.move = Card.MOVES.UNDO, this.table.updateFeatures(this.move), this.table.returnCard(e)
            }, TileGame.prototype.removeHint = function () {
                this.hideHint()
            }, TileGame.prototype.hideHint = function () {
                this.hintCard && (
                    this.hintCard.trigger("hideTutorial"), this.hintCard = void 0)
            }, TileGame.prototype.showHint = function () {
                var e;
                this.canShowHint() ? (e = this.getCardForHint(), this.hintCard !== e && this.hideHint(), e && !e.inAnimation() && (this.hintCard = e, this.hintCard.trigger("showTutorial"))) : this.hideHint()
            }, TileGame.prototype.canShowHint = function () {
                return !(this.outcome !== GameBase.OUTCOME_UNKNOWN || cleverapps.meta.isFocused() || this.counter.isActive() || this.tutorialRunning || cleverapps.config.editorMode || cleverapps.environment.isSceneWithPreview() || cleverapps.forces.isRunningForce())
            }, TileGame.prototype.activateBoosters = function () {
                this.outcome !== GameBase.OUTCOME_UNKNOWN || cleverapps.environment.isSceneWithPreview() || this.log.isUndoNeedOnPreviousMove() && this.log.showAlert()
            }, TileGame.prototype.getCardForHint = function (t) {
                var e = this.table.listMissed();
                return !t || void 0 === t.value && void 0 === t.component ? e[0] : e.find(function (e) {
                    return e.value === t.value || e.findComponent(t.component)
                })
            }, TileGame.prototype.stop = function () {
                GameBase.prototype.stop.apply(this, arguments), this.generator.clear(), this.log.clear(), this.open.clear(), this.table.clear(), this.removeHint()
            }, TileGame.prototype.showTutorialStep = function () {
                this.tutorialRunning = !0, this.log.showTutorialStep() || this.cardsTutorial && this.cardsTutorial.showTutorialStep() || (this.tutorialRunning = !1)
            }, TileGame.prototype.countOfCardsToPlay = function () {
                for (var e = this.table.cards.length, t = this.pagination.getCurrent() + 1; t < this.pagination.getTotal(); t++) {
                    var s = this.level.content.screens[t];
                    e += s.cards.length + TileTable.ListMagicCards(s).length
                }
                return e
            }, TileGame.prototype.getPercentOfCompletion = function () {
                return 1 - this.countOfCardsToPlay() / this.beginCards
            }, TileGame.prototype.updateClovers = function () { }, GameSceneBase.extend({
                onSceneLoaded: function () {
                    var e;
                    this._super(), 1 < this.game.pagination.getTotal() && (e = new PaginationView(this.game.pagination), this.addChild(e), this.paginationControl = new HidingNode(e, cleverapps.UI.VERTICAL), cleverapps.meta.registerControl("pagination",
                        e)), this.cardTableView = new CardTableView(this.game.table), this.addChild(this.cardTableView), this.game.pagination.on("changePage", this.animateNextPage.bind(this))
                },
                animateNextPage: function () {
                    var e = this.cardTableView.getPosition();
                    this.cardTableView.x -= cleverapps.UI.getSceneSize().width, this.cardTableView.runAction(new cc.Sequence(new cc.PlaySound(bundles.game.urls.next_screen_effect), new cc.MoveTo(.7, e).easing(cc.easeBackOut())))
                },
                scaleGameField: function () {
                    var e = cleverapps.scenes.getRunningScene();
                    e.paginationControl && (e.paginationControl.target.updateRelativePosition(), e.paginationControl.updatePosition()), this.cardTableView && this.cardTableView.setTableScale()
                }
            })),
        CardView = cc.Node.extend({
            ctor: function (e, t) {
                this._super(), this.card = e, this.options = t || {}, this.setContentSize2(cleverapps.styles.CardView), this.setAnchorPoint2(), this.addControls(), this.createAnimation(), this.addChild(this.animation, -1), this.setCascadeColorEnabled(!0), void 0 !== e.x && this.setRotation(e.getRotation()),
                    this.markViews = this.card.marks.map(function (e) {
                        var t = new MarkView(e);
                        return t.visible = !1, "magnet" !== e.type && t.setRotation(-2 * this.getRotation()), t.setLocalZOrder(10), this.addChild(t), (this.card.isOpen() || cleverapps.environment.isSceneWithPreview()) && t.show(!0), t
                    }.bind(this)), e.on("animateShowUp", this.screenShowUp.bind(this)), e.on("hide", this.hide.bind(this)), e.on("showTutorial", this.showTutorial.bind(this)), e.on("hideTutorial", this.hideTutorial.bind(this)), e.on("changeValue", this.onChangeValue.bind(this)), e.on("flip", this.createListener(this.onFlip.bind(this))), e.on("wrongMove", this.wrongMove.bind(this)), e.on("changeOwner", this.createListener(this.changeOwner.bind(this))), e.on("updateZ", function () {
                        this.setLocalZOrder(e.getZ())
                    }.bind(this)), this.scale = this.card.getScale(), e.onReturnToScreen = this.createListener(this.animateReturnToScreen.bind(this)), e.on("moveToOpen", this.moveToOpen.bind(this)), e.onGetView = this.createListener(function () {
                        return this
                    }.bind(this)), cleverapps.eventBus.on(
                        "changeFocus",
                        function () {
                            this.hideTutorial()
                        }.bind(this))
            }
        }),
        CurtainCardView = (CardView.convertToViewPosition = function (e) {
            return {
                x: e.x * resolutionScale,
                y: e.y * resolutionScale
            }
        }, CardView.createCardView = function (e, t) {
            var s = new (e.getViewClass())(e);
            return e.components.forEach(function (e) {
                var t = e.getViewClass();
                s.addChild(new t(e))
            }), t || (e.components.forEach(function (e) {
                e.onShowUp && e.onShowUp()
            }), e.listMarks().forEach(function (e) {
                e.alwaysVisible() && e.show()
            })), s
        }, CardView.prototype.changeOwner = function (e) {
            var t = e.getView();
            this.replaceParentSamePlace(t, {
                keepScale: !0
            }), e instanceof TileTable ? this.setLocalZOrder(this.card.getZ()) : e instanceof OpenCards ? this.setLocalZOrder(e.cards.length) : this.setLocalZOrder(0)
        }, CardView.prototype.addControls = function () {
            cleverapps.environment.isAdministratorScene() || cleverapps.environment.isEditorScene() || "streak" === this.card.feature || (this.onTouchHandler && (this.onTouchHandler.remove(), this.onTouchHandler = void 0), this.onTouchHandler = cleverapps.UI.onPressed(this,
                this.card.onClickListener.bind(this.card)))
        }, CardView.prototype.wrongMove = function () {
            cleverapps.audio.playSound(bundles.game.urls.wrong_effect), this.runAction(new cc.Sequence(new cc.DelayTime(.2 * Math.random()), new cc.RotateBy(.08, -20), new cc.RotateBy(.08, 40).easing(cc.easeInOut(.5)), new cc.RotateBy(.08, -40).easing(cc.easeInOut(.5)), new cc.RotateBy(.08, 20), new cc.RotateTo(0, this.card.getRotation())))
        }, CardView.prototype.getShuffleFinishPosition = function () {
            return this.card.getViewPosition().point
        }, CardView.prototype.onFlip = function (e) {
            e ? this.setIdleAnimation() : (this.animation.setAnimation(0, this.card.isOpen() ? "open" : "close", !1), this.animation.setCompleteListener(function () {
                this.animation.setCompleteListener(), this.setIdleAnimation()
            }.bind(this)))
        }, CardView.prototype.moveToOpen = function (e, t) {
            var s = cleverapps.styles.OpenCardsView.slotSize / cleverapps.styles.CardView.width;
            this.runAction(cleverapps.UI.animateCard({
                cardView: this,
                position: this.card.getViewPosition(),
                duration: e,
                overScaling: t ? 1.25 : .85,
                debugLabel: "move to open",
                scale: s,
                midpoint: !!t && cleverapps.styles.CardView.moveMidpoint
            }))
        }, CardView.prototype.animateReturnToScreen = function (e) {
            var t, s, i, n = cleverapps.scenes.getRunningScene().cardTableView,
                o = n.newScale || n.scale,
                a = function () {
                    var e = this.card.getViewPosition(),
                        t = n.animateOffset || cc.p(0, 0),
                        s = n.scale;
                    return e.point.y += t.y, o !== n.scale && (e.point.y *= o / s, e.point.x *= o / s), e
                }.bind(this);
            "tile3" === cleverapps.config.type && (t = new cleverapps.Spine(bundles.card.jsons.starparticles_json), this.addChild(t), t.setLocalZOrder(-1), s = "center", t.setPositionRound(this.width / 2, 0), (i = a()).point.x > this.x && Math.abs(i.point.x - this.x) > cleverapps.styles.CardView.directMoveDx && (s = "left"), i.point.x < this.x && Math.abs(this.x - i.point.x) > cleverapps.styles.CardView.directMoveDx && (s = "right"), t.setAnimation(0, s, !1), t.setCompleteListenerRemove()), this.stopAllActions(), this.runAction(new cc.Spawn(new cc.RotateTo(Card.RETURN_TIMEOUT, this.card.r), cleverapps.UI.animateCard({
                cardView: this,
                dynamicRatioOfParentScale: o / n.scale,
                position: a,
                duration: Card.RETURN_TIMEOUT,
                midpoint: cleverapps.styles.CardView.moveMidpoint,
                delay: !!e && .03 * e,
                debugLabel: "animate return to screen"
            })))
        }, CardView.prototype.hide = function () {
            this.visible = !1
        }, CardView.prototype.createAnimation = function () {
            this.animation = new cleverapps.Spine(this.options.animation_json || bundles.card.jsons.card_json), this.onChangeValue(), this.setIdleAnimation(), this.animation.setPosition(this.width / 2, this.height / 2), this.fitAnimationScale()
        }, CardView.prototype.fitAnimationScale = function () {
            var e = Card.WIDTH * resolutionScale / this.animation.width;
            this.animation.setScale(e)
        }, CardView.prototype.setIdleAnimation = function () {
            this.animation.setAnimation(0, this.card.isOpen() ? "idle_open" : "idle_close", !0)
        }, CardView.prototype.onChangeValue = function () {
            this.animation.setSkin(this.card.getSkin())
        }, CardView.prototype.showTutorial = function () {
            var e;
            this.finger = FingerView.hintClick(this, {
                repeatDelay: 10
            }), this.pointer || ((e = PointerView.create({
                target: this
            })).setVisible(!1), e.runAction(new cc.Sequence(new cc.DelayTime(5), new cc.Show)), this.pointer = e)
        }, CardView.prototype.hideTutorial = function () {
            FingerView.remove(this.finger), PointerView.remove(this.pointer), this.pointer = void 0, this.finger = void 0
        }, CardView.prototype.screenShowUp = function (e, t) {
            if (t) return this.visible = !0, void e();
            var t = this.getPosition(),
                s = this.getRotation(),
                i = this.getScale(),
                n = this.getLocalZOrder(),
                o = cleverapps.scenes.getRunningScene();
            cleverapps.resolution.mode === cleverapps.WideMode.HORIZONTAL ? this.setPositionRound(0, o.height / 2 + 2 * this.height) : this.setPositionRound(-o.width / 2 - 2 * this.width, 0), this.setRotation(0 < t.x ? cleverapps.styles.CardView.screenShowUp.rotation : -cleverapps.styles.CardView.screenShowUp.rotation), this.setLocalZOrder(100), this.visible = !0, this.runAction(new cc.Sequence(new cc.Spawn(new cc.Sequence(new cc.DelayTime(.3), new cc.ScaleTo(.3, 1.2 * i).easing(cc.easeIn(1))), new cc.MoveTo(.8, t).easing(cc.easeInOut(2)), new cc.RotateTo(.8, s), new cc.Sequence(
                new cc.DelayTime(.6), new cc.ScaleTo(.4, i).easing(cc.easeOut(1)))), new cc.CallFunc(function () {
                    this.setLocalZOrder(n), e()
                }.bind(this))))
        }, CardView.prototype.animateLose = function (e) {
            var t = void 0,
                t = this.card.isOpen() ? e % 2 == 0 ? "lose_left_nominal" : "lose_right_nominal" : e % 2 == 0 ? "lose_left_backside" : "lose_right_backside",
                s = .8 + .9 * Math.random(),
                i = (this.animation.setTimeScale(s), this.animation.getAnimationDuration(t) / s),
                n = .01 * e * s,
                s = 2 / s,
                o = this.getGlobalBoundingBox(),
                o = s * ((o.y + o.height) / cleverapps.UI.getBgSize().height);
            return this.setCascadeOpacityEnabled(!0), this.runAction(new cc.Sequence(new cc.DelayTime(n), new cc.CallFunc(function () {
                this.animation.setAnimation(0, t, !1)
            }.bind(this)), new cc.Spawn(new cc.RotateTo(.1, 0), new cc.MoveBy(s, 0, -cleverapps.UI.getBgSize().height).easing(cc.easeIn(4))), new cc.RemoveSelf)), this.runAction(new cc.Sequence(new cc.DelayTime(.05 * e), new cc.PlaySound(bundles.game.urls.card_effect))), Math.max(n + o, i)
        }, CardView.prototype.unlockIdleAnimate = function (e) {
            var t = e ? -15 : 15,
                s = e ? -7 : 7;
            return new cc.Sequence(new cc.DelayTime(e ? 2.5 : 0), new cc.CallFunc(function () {
                this.runAction(new cc.RepeatForever(new cc.Spawn(new cc.Sequence(new cc.RotateBy(3, t).easing(cc.easeInOut(2)), new cc.RotateBy(4, -(t + s)).easing(cc.easeInOut(2)), new cc.RotateBy(3, s)), new cc.Sequence(new cc.MoveBy(5, 0, -40).easing(cc.easeInOut(2)), new cc.MoveBy(5, 0, 40).easing(cc.easeInOut(2))))))
            }.bind(this)))
        }, CardView.prototype.unlockSpawnAnimate = function (e) {
            var t = cleverapps.styles.TilesUnlockWindow,
                s = (this.animation.setOpacity(0), this.icon.setOpacity(0), this.setScale(.2), this.setPositionRound(t.animation), e ? -t.tiles.offset : t.tiles.offset);
            return new cc.Sequence(new cc.DelayTime(e ? .2 : .4), new cc.Spawn(new cc.ScaleTo(1.5, t.tiles.scale), new cc.CallFunc(function () {
                this.animation.runAction(new cc.FadeIn(.5)), this.icon.runAction(new cc.FadeIn(.5))
            }.bind(this)), new cc.RotateBy(1.5, e ? -360 : 360), new cc.MoveBy(1.5, s, 3 * t.height / 5)).easing(cc.easeElasticOut(1.2)))
        }, CardView.prototype.unlockEndAnimate = function (e, t) {
            var s = t ? -200 : 200;
            this.runAction(new cc.Sequence(new cc.DelayTime(t ? .2 : 0), new cc.Spawn(new cc.MoveBy(1.5, 0, cleverapps.UI.getSceneSize().height).easing(cc.easeElasticIn(.6)), new cc.RotateBy(1.5, s).easing(cc.easeIn(5))), new cc.DelayTime(1), new cc.CallFunc(e), new cc.RemoveSelf))
        }, cleverapps.styles.CardView = {
            width: 0,
            height: 0,
            moveMidpoint: {
                x: 50,
                y: 250
            },
            screenShowUp: {
                rotation: 30
            },
            showUpOffset: 0,
            shuffleRadius: 250,
            directMoveDx: 150
        }, cleverapps.styles.CardView.width = Card.WIDTH, cleverapps.styles.CardView.height = Card.HEIGHT, CardView.extend({
            ctor: function (e) {
                this._super(e), this.setAnchorPoint2(), this.curtains = new cleverapps.Spine(bundles.card.jsons.curtain_json), this.curtains.setPosition(this.width / 2, this.height / 2), this.curtains.setVisible(!1), this.addChild(this.curtains), this.counterText = cleverapps.UI.generateImageText(this.getCounterText(), cleverapps.styles.FONTS.CURTAIN_COUNTER_TEXT), this.counterText.setPositionRound(cleverapps.styles.CurtainCardView.counter), this.curtains.addChild(
                    this.counterText), this.updateCurtainsVisibility(), e.on("hide", this.hide.bind(this)), e.on("changeStage", this.changeStage.bind(this)), e.on("onshowup", this.updateCurtainsVisibility.bind(this)), cleverapps.environment.isEditorScene() && this.addEditorControls()
            },
            onEnter: function () {
                this._super(), this.parent instanceof OpenCardsView && this.hide()
            },
            hide: function () {
                this.curtains && this.curtains.removeFromParent()
            },
            getCounterText: function () {
                return this.card.sleeping ? this.card.sleep - this.card.counter : this.card.active - this.card.counter
            },
            getAnimationName: function () {
                var e = this.card.sleeping ? "sleep" : "active";
                return this.card.magicCurtain ? "magic_" + e : e
            },
            getIdleAnimationName: function () {
                return this.getAnimationName() + "_idle"
            },
            getWrongMoveAnimationName: function () {
                return this.getAnimationName() + "_wrong_move"
            },
            changeStage: function () {
                this.curtains.visible && (0 === this.card.counter ? (this.counterText.setString(0), this.curtains.setAnimation(0, this.getAnimationName(), !1), this.curtains.setCompleteListener(function () {
                    this.curtains.setCompleteListener(), this.curtains.visible && (this.curtains.setAnimation(0, this.getIdleAnimationName(), !0), this.counterText.setString(this.getCounterText()))
                }.bind(this)), cleverapps.audio.playSound(bundles.game.urls[this.card.sleeping ? "curtain_close_effect" : "curtain_open_effect"])) : this.counterText.setString(this.getCounterText()))
            },
            animateReturnToScreen: function () {
                this._super(), this.updateCurtainsVisibility()
            },
            updateCurtainsVisibility: function () {
                this.card.sleeping ? (cleverapps.audio.playSound(bundles.game.urls.curtain_close_effect), this.curtains.setAnimationAndIdleAfter(this.getAnimationName(), this.getIdleAnimationName())) : this.curtains.setAnimationAndIdleAfter("emerging", this.getIdleAnimationName())
            },
            animateLose: function () {
                this.curtains && this.curtains.removeFromParent(), CardView.prototype.animateLose.call(this)
            },
            wrongMove: function () {
                var e = this.getWrongMoveAnimationName();
                this.curtains.hasAnimation(e) ? (cleverapps.audio.playSound(bundles.game.urls.wrong_effect),
                    this.curtains.setAnimationAndIdleAfter(e, this.getIdleAnimationName())) : this._super()
            },
            addEditorControls: function () {
                var e = new IncDecBlock({
                    value: this.card.active,
                    onChange: function (e) {
                        this.card.active = e, this.changeStage(), Editor.currentEditor.save()
                    }.bind(this)
                }),
                    t = new IncDecBlock({
                        value: this.card.sleep,
                        onChange: function (e) {
                            this.card.sleep = e, this.changeStage(), Editor.currentEditor.save()
                        }.bind(this)
                    }),
                    s = new cleverapps.UI.CheckBox({
                        isSelected: this.card.sleeping || !1,
                        label: {
                            text: "sleeping"
                        },
                        onChange: function (e) {
                            this.card.sleeping = e, this.changeStage(), Editor.currentEditor.save()
                        }.bind(this)
                    }),
                    i = new cleverapps.UI.CheckBox({
                        isSelected: this.card.magicCurtain || !1,
                        label: {
                            text: "magic"
                        },
                        onChange: function (e) {
                            this.card.magicCurtain = e, this.changeStage(), Editor.currentEditor.save()
                        }.bind(this)
                    }),
                    e = new cleverapps.Layout([e, t, s, i], {
                        direction: cleverapps.UI.VERTICAL
                    });
                e.setScale(.4), e.setPosition(this.width / 2, this.height / 2), this.addChild(e)
            }
        })),
        MarkView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            CURTAIN_COUNTER_TEXT: {
                size: 0,
                name: "default"
            }
        }), cleverapps.styles.CurtainCardView = {
            counter: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -6
                }
            }
        }, cleverapps.Spine.extend({
            ctor: function (e) {
                this.mark = e, this.styles = cleverapps.styles.MarkView[this.mark.type], cleverapps.environment.isSceneWithPreview() && (this.styles = cleverapps.overrideStyles(this.styles, this.styles.editor || {}, !0));
                var t, e = cleverapps.skins.getSlot("cardMarkSpine", {
                    json: bundles.card.jsons.marks_json,
                    type: e.type
                });
                switch (this._super(e), this.setAnchorPoint2(), this.mark.type) {
                    case "mission":
                        t = "gem_idle";
                        break;
                    case "key":
                        t = "key_idle";
                        break;
                    case "coin":
                        t = "coin_idle";
                        break;
                    case "magnet":
                        t = "magnet_idle_0";
                        break;
                    case "bone":
                        t = "bone_idle"
                }
                this.setAnimation(0, t, !0), this.setTimeScale(.7 + .6 * Math.random()), this.setScale(0), this.mark.on("show", this.show.bind(this)), this.mark.on("collect", this.collect.bind(this)), this.mark.on("collectMagnet", this.collectMagnet.bind(this)), this.mark.on("executeMagnet", this.executeMagnet.bind(this)),
                    cleverapps.environment.isSceneWithPreview() || this.mark.on("hide", this.hide.bind(this))
            },
            show: function (e, t) {
                this.setVisible(!0), this.setPositionRound(this.styles);
                var s, i = this.styles.scale || 1;
                e ? this.setScale(i) : ((s = new cleverapps.Spine(bundles.card.jsons.effects_json)).setAnimation(0, "appearance_corner", !1), s.setPositionRound(this.x, this.y), this.parent.addChild(s), this.setScale(0), this.runAction(new cc.Sequence(new cc.DelayTime(.33), new cc.ScaleTo(.33, i), new cc.CallFunc(function () {
                    s.removeFromParent(), t && t()
                }))))
            },
            hide: function () {
                this.setVisible(!1)
            },
            collect: function (e) {
                if (e) {
                    var t;
                    switch (this.setTimeScale(1), this.mark.type) {
                        case "mission":
                            t = bundles.game.urls.cell_collect_effect;
                            break;
                        case "key":
                            t = bundles.game.urls.key_effect
                    }
                    this.runAction(new cc.Sequence(new cc.Spawn(cleverapps.UI.animateCollect(this, e, {
                        duration: Mark.COLLECT_DURATION / 1e3,
                        sound: t,
                        collectEffect: !0
                    }), new cc.RotateTo(Mark.COLLECT_DURATION / 1e3, 0)), new cc.RemoveSelf))
                } else this.removeFromParent()
            },
            collectMagnet: function () {
                this.setTimeScale(1), this.setAnimation(0, "magnet_jump", !1);
                var e = cleverapps.scenes.getMovingNode(),
                    t = this.convertToWorldSpace(cc.p(this.x + this.styles.offset.x, this.y + this.styles.offset.y)),
                    t = e.convertToNodeSpace(t);
                this.runAction(new cc.Sequence(new cc.ReplaceParent(e), new cc.PlaySound(bundles.game.urls.magnet_collect), new cc.Spawn(new cc.MoveTo(Mark.COLLECT_DURATION / 1e3 - .1, t), new cc.RotateTo(Mark.COLLECT_DURATION / 1e3 - .1, 0)), new cc.DelayTime(.1), new cc.CallFunc(function () {
                    this.setAnimation(0, "magnet_idle_1", !0)
                }.bind(this))))
            },
            executeMagnet: function (e) {
                this.stopAllActions(), this.setAnimation(0, "magnet_open", !1), this.setCompleteListener(this.removeFromParent.bind(this)), cleverapps.audio.playSound(bundles.game.urls.magnet_explode), e.forEach(function (e) {
                    var t, s, e = e.onGetView();
                    e && e.getParent() && (e = this.getParent().convertToNodeSpace(e.getParent().convertToWorldSpace(e.getPosition())), (t = new cleverapps.Spine(bundles.card.jsons.lightning_json)).setPositionRound(this.getPosition()),
                        t.setAnimation(0, "animation", !1), s = e.x - t.x, e = e.y - t.y, t.setRotation(180 * Math.atan2(-e, s) / Math.PI), t.setScaleX(Math.sqrt(s * s + e * e) / this.styles.lightningLength), this.getParent().addChild(t), t.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.RemoveSelf)))
                }.bind(this))
            }
        })),
        BombOnCardView = (cleverapps.styles.MarkView = {
            mission: {
                x: 15,
                y: 15
            },
            key: {
                x: 95,
                y: 50,
                editor: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 60
                    },
                    scale: 2
                }
            },
            coin: {
                x: 15,
                y: 15
            },
            magnet: {
                x: 95,
                y: 20,
                offset: {
                    x: 0,
                    y: 150
                },
                lightningLength: 530,
                editor: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: -20
                    },
                    scale: 1.5
                }
            },
            bone: {
                x: 90,
                y: 80
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.setAnchorPoint2(), this.bombOnCard = e;
                var t = cleverapps.styles.BombOnCardView;
                this.shown = !1, this.animation = new cleverapps.Spine(bundles.card.jsons.bomb_json), this.animation.setAnimation(0, "bomb_idle", !0), this.animation.setTimeScale(0), this.animation.setPositionRound(t.animation), this.addChild(this.animation), this.counterText = cleverapps.UI.generateImageText(e.counter,
                    cleverapps.styles.FONTS.BOMB_COUNTER_TEXT), this.counterText.fitTo(t.counter.width), this.counterText.setPositionRound(t.counter), this.animation.addChild(this.counterText), this.animation.setScale(0), this.setCascadeColorEnabled(!0), this.updateBombVisibility(), e.onChangeCounter = this.createListener(this.onChangeCounterValue.bind(this)), e.onRemove = this.createListener(this.removeFromParent.bind(this)), e.onFlip = this.createListener(this.onFlip.bind(this)), e.onHide = this.createListener(this.hide.bind(this)), cleverapps.environment.isEditorScene() && this.addIncDecBlock()
            },
            show: function () {
                this.shown = !0, this.animation.setScale(1), this.animation.setTimeScale(1)
            },
            hide: function () {
                this.animation.setTimeScale(0), this.shown = !1
            },
            updateBombVisibility: function () {
                var e = this.bombOnCard.isActive() || cleverapps.environment.isSceneWithPreview();
                e && !this.shown ? this.show() : !e && this.shown && this.hide()
            },
            onFlip: function () {
                this.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.CallFunc(this.updateBombVisibility.bind(
                    this))))
            },
            onChangeCounterValue: function () {
                this.runAction(new cc.Sequence(new cc.DelayTime(.3), new cc.CallFunc(function () {
                    this.counterText.setString(this.bombOnCard.counter), this.counterText.fitTo(cleverapps.styles.BombOnCardView.counter.width), this.bombOnCard.danger ? (this.counterText.runAction(new cc.TintTo(.4, 255, 235, 110)), this.animation.setAnimationAndIdleAfter("bombcounter_danger", "danger")) : (this.counterText.runAction(new cc.TintTo(.4, 255, 255, 255)), this.animation.setAnimationAndIdleAfter("bombcounter_idle", "bomb_idle")), cleverapps.audio.playSound(bundles.game.urls.bomb_indication_effect)
                }.bind(this))))
            },
            addIncDecBlock: function () {
                var e = new IncDecBlock({
                    value: this.bombOnCard.counter,
                    onChange: function (e) {
                        this.bombOnCard.counter = e, this.onChangeCounterValue(0, !0), Editor.currentEditor.save()
                    }.bind(this)
                }),
                    t = this.bombOnCard.card.onGetView();
                e.setPosition(t.width / 2, t.height / 2), e.setScale(.6), t.addChild(e, 5)
            }
        })),
        PlateOnCardView = (BombOnCardView.explosion = function () {
            var e = cleverapps.scenes.getRunningScene(),
                t = new cleverapps.Spine(bundles.card.jsons.bomb_explosion_json),
                t = (t.setAnimation(0, "explosion", !1), e.addChild(t), t.setPosition(e.width / 2, e.height / 2), t.runAction(new cc.PlaySound(bundles.game.urls.explosion_effect)), t.setCompleteListenerRemove(), {
                    x: e.width / 2,
                    y: e.height / 2,
                    r: 0
                });
            cleverapps.UI.shake(e, t)
        }, cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            BOMB_COUNTER_TEXT: {
                name: "default",
                size: 35
            }
        }), cleverapps.styles.BombOnCardView = {
            animation: {
                x: 85,
                y: 42
            },
            counter: {
                x: {
                    align: "center",
                    dx: 1
                },
                y: {
                    align: "center",
                    dy: -12
                },
                width: 34
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.setAnchorPoint2(), this.plateOnCard = e;
                var t = cleverapps.styles.PlateOnCardView,
                    s = this.lastStage = Math.min(PlateOnCard.PARTS, this.plateOnCard.stage);
                this.animation = new cleverapps.Spine(bundles.card.jsons.plate_json), this.animation.setPosition(cleverapps.styles.CardView.width / 2 + t.dx, cleverapps.styles.CardView.height / 2 + t.dy), this.animation.setSkin("tile_" + this.plateOnCard.card.value),
                    this.animation.setAnimation(0, "animation" + s, !1), this.animation.setLocalZOrder(1e3), this.addChild(this.animation), this.setCascadeColorEnabled(!0), e.onBreakOff = this.createListener(this.breakOffAnimation.bind(this)), e.onCollect = this.createListener(this.collect.bind(this)), e.onDestroy = this.createListener(this.removeFromParent.bind(this))
            },
            breakOffAnimation: function () {
                var e, t = Math.min(PlateOnCard.PARTS, this.plateOnCard.stage);
                t !== this.lastStage && (e = this.lastStage > t ? "reverse" + this.lastStage : "animation" + t, this.animation.setAnimation(0, e, !1), cleverapps.audio.playSound(bundles.card.urls.plate_breaks_off_effect), this.lastStage = t)
            },
            collect: function (e) {
                var t = new cleverapps.Spine(bundles.card.jsons.plate_json);
                t.setPosition(this.animation.x, this.animation.y), t.setSkin("tile_" + this.plateOnCard.card.value), t.setAnimation(0, "goal", !1), t.setCompleteListenerRemove(), this.addChild(t), t.replaceParentSamePlace(cleverapps.scenes.getMovingNode()), cleverapps.audio.playSound(
                    bundles.card.urls.plate_click_effect), this.animation.setAnimation(0, "goal_fly", !1), this.animation.replaceParentSamePlace(cleverapps.scenes.getMovingNode());
                this.animation.runAction(new cc.Sequence(new cc.DelayTime(.4), new cc.Spawn(cleverapps.UI.animateCollect(this.animation, e, {
                    duration: (PlateOnCard.COLLECT_DURATION - 400) / 1e3,
                    collectEffect: !0,
                    sound: bundles.card.urls.plate_collect_effect,
                    adjustToTarget: !0
                }), new cc.RotateTo((PlateOnCard.COLLECT_DURATION - 400) / 1e3, 0)), new cc.RemoveSelf))
            }
        })),
        IceOnCardView = (cleverapps.styles.PlateOnCardView = {
            dx: 2,
            dy: -7
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.setAnchorPoint2(), this.iceOnCard = e;
                var t = cleverapps.styles.IceOnCardView,
                    s = this.lastStage = Math.min(this.iceOnCard.stage, IceOnCard.PARTS);
                this.animation = new cleverapps.Spine(bundles.card.jsons.ice_json), this.animation.setPosition(cleverapps.styles.CardView.width / 2 + t.dx, cleverapps.styles.CardView.height / 2 + t.dy), this.animation.setAnimation(0, "animation" + s, !1), this.addChild(this.animation),
                    this.setCascadeColorEnabled(!0), e.onBreakOff = this.createListener(this.breakOffAnimation.bind(this)), e.onDestroy = this.createListener(this.removeFromParent.bind(this)), cleverapps.environment.isSceneWithPreview() || (e.onShow = this.createListener(this.show), e.onHide = this.createListener(this.hide))
            },
            show: function () { },
            hide: function () { },
            breakOffAnimation: function () {
                var e = Math.min(IceOnCard.PARTS, this.iceOnCard.stage);
                e !== this.lastStage && (this.lastStage < this.iceOnCard.stage ? (this.animation.setAnimation(0, "animation" + e, !1), cleverapps.audio.playSound(bundles.game.urls.ice_break_effect)) : (this.animation.setAnimation(0, "reverse" + this.lastStage, !1), cleverapps.audio.playSound(bundles.game.urls.ice_revert_effect)), this.lastStage = e)
            }
        })),
        OpenCardsView = (cleverapps.styles.IceOnCardView = {
            dx: 2,
            dy: -7
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.openCards = e;
                var t = cleverapps.styles.OpenCardsView;
                this.slots = [];
                for (var s = 0; s < this.openCards.limit; s++) {
                    var i = new cc.Node;
                    i.setContentSize2(t.slotSize,
                        t.slotSize), i.setAnchorPoint2(), i.setPosition((s - (this.openCards.limit - 1) / 2) * t.slotSize, 0), this.slots.push(i), this.addChild(i)
                }
                cleverapps.UI.wrap(this), this.bg = cleverapps.UI.createSprite(bundles.card.frames.opencards_bg), this.bg.setPositionRound(t.bg), this.addChild(this.bg, -1);
                var n = cleverapps.UI.createSprite(bundles.card.frames.opencards_fg);
                n.setPositionRound(t.fg), this.addChild(n, 1e3), this.updateSize(), this.updatePosition(), e.on("explode", this.explode.bind(this)), e.on("overflow", this.overflowAnimation.bind(this)), e.on("warning", this.setWarning.bind(this)), this.openCards.getView = function () {
                    return this
                }.bind(this), this.createWarningAnimation(), this.createCards()
            },
            updatePosition: function () {
                this.setPositionRound(cleverapps.styles.OpenCardsView.position)
            },
            updateSize: function () {
                var e = cleverapps.UI.getSceneSize().width / (this.width + 2 * cleverapps.styles.OpenCardsView.scenePaddingX);
                this.setScale(Math.min(e, 1))
            },
            findPosForCard: function (e) {
                return this.slots[e.visibleIndex].getPosition()
            },
            overflowAnimation: function () {
                cleverapps.UI.shake(this, {
                    power: 2,
                    moveTime: .05,
                    delayTimeAfterMove: .01,
                    points: [{
                        x: 0,
                        y: 3,
                        r: 0
                    }, {
                        x: 0,
                        y: 0,
                        r: 0
                    }, {
                        x: 3,
                        y: 3,
                        r: 0
                    }, {
                        x: 0,
                        y: 1,
                        r: 0
                    }, {
                        x: -3,
                        y: 3,
                        r: 0
                    }, {
                        x: 0,
                        y: 0,
                        r: 0
                    }, {
                        x: 0,
                        y: 2,
                        r: 0
                    }, {
                        x: 0,
                        y: 0,
                        r: 0
                    }]
                })
            },
            createWarningAnimation: function () {
                var e = cleverapps.styles.OpenCardsView.warning,
                    t = this.warningAnimation = new cleverapps.Spine(bundles.card.jsons.open_warning_json);
                t.setAnimation(0, "animation", !0), t.setPositionRound(e), this.addChild(t), t.setVisible(!1)
            },
            setWarning: function (e) {
                this.warningAnimation.setVisible(e)
            },
            explode: function (e, t) {
                var s;
                t ? ((s = e[0].onGetView()).runAction(new cc.Spawn(new cc.Sequence(new cc.DelayTime(.1), new cc.RotateBy(.4, 360)), new cc.CallFunc(s.highlight.bind(s)), new cc.Sequence(new cc.MoveBy(.25, 0, cleverapps.styles.OpenCardsView.explodeJump.dy).easing(cc.easeOut(3)), new cc.MoveBy(.25, 0, -cleverapps.styles.OpenCardsView.explodeJump.dy).easing(cc.easeIn(3)), new cc.CallFunc(s.explode.bind(s))))), [e[1], e[2]].forEach(function (e, t) {
                    e = e.onGetView();
                    e.runAction(new cc.Sequence(new cc.DelayTime(.05 * t), new cc.CallFunc(e.highlight.bind(e)), new cc.MoveTo(.5, s).easing(cc.easeBackIn(5)), new cc.RemoveSelf))
                })) : e.forEach(function (e) {
                    e.onGetView().explode()
                })
            },
            createCards: function () {
                this.openCards.cards.forEach(function (e) {
                    var t = CardView.createCardView(e);
                    this.addChild(t), t.setPositionRound(this.findPosForCard(e)), t.setScale(cleverapps.styles.OpenCardsView.slotSize / cleverapps.styles.CardView.width)
                }, this)
            }
        })),
        CardTableView = (cleverapps.styles.OpenCardsView = {
            position: [{
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 200
                }
            }, {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 48
                }
            }, {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 48
                }
            }],
            bg: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -35
                }
            },
            fg: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -27
                }
            },
            warning: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: -16
                }
            },
            slotSize: 120,
            scenePaddingX: 30,
            explodeJump: {
                dy: 300
            }
        }, cc.Node.extend({
            ctor: function (e) {
                this._super(), this.table = e, this.centerNode = new cc.Node, this.addChild(this.centerNode),
                    this.setAnchorPoint2(), this.debugId = "CardTable", this.table.on("replaceCardWithAnother", this.replaceCardWithAnother.bind(this)), this.table.on("insertCard", this.insertCard.bind(this)), this.table.on("demonstrateBoosterBefore", this.demonstrateBoosterBefore.bind(this)), this.table.on("resetCards", this.createCards.bind(this)), this.table.on("animatedChangeSize", this.onTableAnimatedChangeSize.bind(this)), this.table.on("changeSize", this.onTableChangeSize.bind(this)), this.table.on("blowCards", this.blowCards.bind(this)), this.table.on("shuffle", this.shuffle.bind(this)), this.table.getView = function () {
                        return this.centerNode
                    }.bind(this), this.createCards(!0), this.centerNode.children.forEach(function (e) {
                        e.setVisible(!1)
                    })
            },
            shuffle: function () {
                var e = this.table.cards.map(function (e) {
                    return e.onGetView()
                });
                cleverapps.UI.animateShuffle(e, function () {
                    this.setLocalZOrder(this.card.getZ())
                })
            },
            onTableChangeSize: function () {
                this.calcRect(), this.setContentSize2(this.rect.width, this.rect.height),
                    this.centerNode.setPosition(this.getCenterNodePosition()), this.setTableScale()
            },
            onTableAnimatedChangeSize: function () {
                this.calcRect();
                var e = this.getCenterNodePosition(),
                    e = cc.pSub(e, this.centerNode.getPosition()),
                    t = cc.size(this.rect.width - this.width, this.rect.height - this.height);
                this.animateOffset = cc.p(e.x / 2, e.y / 2), this.animateOffset.x -= t.width / 2 - e.x / 2, this.animateOffset.y -= t.height / 2 - e.y / 2, this.centerNode.runAction(new cc.Sequence(new cc.MoveBy(.3, this.animateOffset.x, this.animateOffset.y), new cc.CallFunc(function () {
                    this.animateOffset = cc.p(0, 0), this.setContentSize2(this.rect.width, this.rect.height), this.centerNode.setPosition(this.getCenterNodePosition())
                }.bind(this)))), this.animateTableScale()
            },
            getCenterNodePosition: function () {
                var e = cc.rectGetCenter(this.rect);
                return cc.p(this.rect.width / 2 - e.x, this.rect.height / 2 - e.y)
            },
            setTableScale: function () {
                Game.currentGame instanceof FakeGame || cleverapps.UI.inflateToBoundaries(this, this.getOverlappingNodes(), {
                    maxScale: TileTable.MAX_SCALE,
                    padding: cleverapps.styles.CardTableView.padding
                })
            },
            animateTableScale: function () {
                cleverapps.UI.inflateToBoundaries(this, this.getOverlappingNodes(), {
                    animate: !0,
                    maxScale: TileTable.MAX_SCALE,
                    padding: cleverapps.styles.CardTableView.padding
                })
            },
            getOverlappingNodes: function () {
                var e = cleverapps.scenes.getRunningScene(),
                    t = [e.upMenuContainer, e.downToolBarControl, e.cloversControl, e.collectionContainer, e.openCardsControl, e.shuffleButton, e.undoButton, e.vacuumButton, e.paginationControl, e.handView, e.handBlockView, e.undoButton];
                return (t = e.sideBar && e.sideBar.slots ? t.concat(e.sideBar.slots) : t).filter(Boolean)
            },
            calcRect: function () {
                var e = this.table.rect;
                return this.rect = cc.rect(e.x * resolutionScale, e.y * resolutionScale, e.width * resolutionScale, e.height * resolutionScale), this.rect
            },
            createCards: function (i) {
                this.centerNode.removeAllChildren(), this.table.cards.forEach(function (e, t) {
                    var s = CardView.createCardView(e, i);
                    this.centerNode.addChild(s), s.setLocalZOrder(t), s.setPositionRound(e.getViewPosition().point)
                }, this)
            },
            replaceCardWithAnother: function (e, t) {
                e = e.onGetView(), t = new (t.getViewClass())(t);
                t.setLocalZOrder(e.getLocalZOrder()), t.setPositionRound(e.getPosition()), e.removeFromParent(), this.centerNode.addChild(t)
            },
            convertToViewPosition: function (e) {
                return {
                    x: e.x * resolutionScale,
                    y: e.y * resolutionScale
                }
            },
            insertCard: function (t, e) {
                cleverapps.audio.playSound(bundles.game.urls.appearance_joker_effect);
                var s = CardView.createCardView(t);
                s.setPositionRound({
                    x: e || 0,
                    y: 0
                }), s.setRotation(0), this.centerNode.addChild(s), s.replaceParentSamePlace(cleverapps.scenes.getMovingNode()), s.animation.setAnimation(0, "under_card_start", !1), s.animation.setCompleteListener(function () {
                    s.animation.setCompleteListener();
                    var e = this.convertToViewPosition(t),
                        e = cleverapps.scenes.getMovingNode().convertToNodeSpace(this.centerNode.convertToWorldSpace(e));
                    s.animation.setAnimation(0, "under_card_move", !1), s.runAction(new cc.Sequence(new cc.Spawn(new cc.MoveTo(.2, e), new cc.RotateTo(.2, t.getRotation())), new cc.DelayTime(.09),
                        new cc.CallFunc(function () {
                            s.replaceParentSamePlace(this.centerNode), s.setLocalZOrder(t.getZ())
                        }.bind(this))))
                }.bind(this))
            },
            demonstrateBoosterBefore: function (e, t) {
                var s = new cleverapps.Spine(bundles.boosters_before_game.jsons.boost_magnit_json),
                    i = (s.setAnimation(0, "boost_magnit", !1), s.setPosition({
                        x: this.width / 2,
                        y: 0
                    }), s.setLocalZOrder(100), s.setCompleteListenerRemove(function () {
                        cleverapps.audio.playSound(bundles.game.urls.decorator_appear_effect), t()
                    }), this.addChild(s), this.convertToNodeSpace(e.onGetView().convertToWorldSpace(cleverapps.styles.MarkView.magnet)));
                s.runAction(new cc.Spawn(new cc.MoveTo(.9, i).easing(cc.easeExponentialInOut()), new cc.RotateTo(.9, e.r))), cleverapps.audio.playSound(bundles.game.urls.appearance_magnet_effect)
            },
            blowCards: function (e, t) {
                var s = cleverapps.styles.CardTableView.blowCard,
                    i = cleverapps.scenes.getRunningScene(),
                    n = new cleverapps.Spine(bundles.booster_effects.jsons.vacuum_json),
                    o = (n.setAnimation(0, "animation", !1), n.setPositionRound(i.width / 2, i.height / 2),
                        new cleverapps.Spine(bundles.booster_effects.jsons.vacuum_stick_json)),
                    a = (o.setAnimation(0, "animation", !1), o.setPositionRound(s.stick), o.setCompleteListenerRemove(t), i.addChild(n), i.addChild(o), cleverapps.audio.playSound(bundles.booster_effects.urls.vacuum_effect), e.sort(function (e, t) {
                        return t.onGetView().getLocalZOrder() - e.onGetView().getLocalZOrder()
                    }), cleverapps.scenes.getMovingNode().convertToNodeSpace(i.convertToWorldSpace(o.getPosition()))),
                    r = (a.x += s.target.dx, a.y += s.target.dy, e.map(function (e) {
                        return cc.pDistance(this.convertToWorldSpace(e.onGetView().getPosition()), a)
                    }.bind(this))),
                    c = Math.max.apply(null, r),
                    l = c / 1.5;
                n.setCompleteListenerRemove(function () {
                    e.forEach(function (e, t) {
                        var s = e.findComponent(PlateOnCard),
                            s = (s && s.collect(), 1.5 * r[t] / c),
                            t = r[t] / l,
                            s = Math.max(s - .3, 0),
                            i = e.onGetView();
                        i.runAction(new cc.Sequence(new cc.DelayTime(s), new cc.RotateTo(.3 / 3, -5).easing(cc.easeIn(2)), new cc.RotateTo(.3 / 6, 5), new cc.RotateTo(.3 / 6, -5), new cc.RotateTo(.3 / 3, 0), new cc.Spawn(new cc.Sequence(
                            new cc.CallFunc(function () {
                                e.isOpen() || e.flip(), i.replaceParentSamePlace(cleverapps.scenes.getMovingNode(), {
                                    keepScale: !0
                                })
                            }), new cc.MoveTo(t, a).easing(cc.easeIn(4)), new cc.RemoveSelf), new cc.RotateTo(.5, 10))))
                    })
                })
            }
        })),
        MultiScreenArrows = (cleverapps.styles.CardTableView = {
            blowCard: {
                stick: {
                    x: {
                        align: "right"
                    },
                    y: {
                        align: "center"
                    }
                },
                target: {
                    dx: -10,
                    dy: 30
                }
            },
            padding: {
                top: 50,
                bottom: 50,
                left: 10,
                right: 10
            }
        }, cleverapps.Spine.extend({
            ctor: function (e) {
                this._super(bundles.game.jsons.multiscreen_json), this.table = e, this.setPositionRound(cleverapps.styles.MultiScreenArrows.position), Game.currentGame.pagination.on("lastPage", this.hideArrows.bind(this)), Game.currentGame.pagination.on("changePage", this.nextScreen.bind(this)), this.runAction(new cc.Sequence(new cc.DelayTime(3), new cc.CallFunc(this.showArrows.bind(this))))
            },
            updateSize: function () {
                this.setPositionRound(cleverapps.styles.MultiScreenArrows.position)
            },
            nextScreen: function () {
                this.setAnimation(0, this.getArrowsAnimation(), !0);
                var e = this.getPosition(),
                    t = cleverapps.UI.getSceneSize().width / 2 - this.table.rect.x * resolutionScale;
                this.setPositionRound(e.x + t, e.y), this.runAction(new cc.MoveTo(1, e))
            },
            showArrows: function () {
                var e = cleverapps.styles.MultiScreenArrows,
                    t = this.getArrowsAnimation();
                t && (this.setAnimation(0, t, !0), this.runAction(new cc.MoveBy(.6, e.transitionIn)))
            },
            hideArrows: function () {
                this.runAction(new cc.Sequence(new cc.MoveBy(.6, cleverapps.styles.MultiScreenArrows.transitionOut), new cc.Hide))
            },
            getArrowsAnimation: function () {
                return 1 < Game.currentGame.pagination.getTotal() && Game.currentGame.pagination.isLast() ? "finish_idle" : Game.currentGame.pagination.isLast() ? void 0 : "animation"
            }
        })),
        TileShuffleButtonBooster = (cleverapps.styles.MultiScreenArrows = {
            position: {
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            transitionIn: {
                x: -170,
                y: 0
            },
            transitionOut: {
                x: 170,
                y: 0
            }
        }, BaseButtonBooster.extend({
            ctor: function (e) {
                this._super({
                    booster: e,
                    styles: cleverapps.styles.TileShuffleButtonBooster
                }), this.test = !0, this.setLocalZOrder(
                    cleverapps.styles.TileShuffleButtonBooster.zOrder)
            },
            createIcon: function () {
                var e = new cleverapps.Spine(bundles.buttons.jsons.shuffle_json);
                return e.setAnimation(0, "idle", !1), e
            },
            onExecute: function () {
                this.icon.setAnimation(0, "animation", !1), cleverapps.audio.playSound(this.booster.executeEffect)
            }
        })),
        CardBlockHandler = (cleverapps.styles.TileShuffleButtonBooster = {
            width: 200,
            height: 150,
            zOrder: 0,
            position: {
                x: [{
                    align: "left",
                    dx: 50
                }, {
                    align: "right",
                    dx: -10
                }, {
                    align: "right",
                    dx: -10
                }],
                y: [{
                    align: "bottom",
                    dy: 10
                }, {
                    align: "bottom",
                    dy: 590
                }, {
                    align: "bottom",
                    dy: 590
                }]
            },
            phone: {
                scale: .8
            },
            content: {
                layout: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 20
                    }
                },
                margin: -8,
                direction: cleverapps.UI.VERTICAL,
                freeBlock: {
                    textWidth: 120,
                    dx: 0
                }
            }
        }, function () { }),
        Tile3 = ((CardBlockHandler.prototype.constructor = CardBlockHandler).prototype.adaptCardBlocks = function (e, t) {
            t = t || Game.currentGame.table.cards, this.tableRect = this.calcRect(t);
            var s = this.findCardsClusters(t);
            if (!(s.length < 2)) {
                s.forEach(function (e) {
                    e.testRect = cleverapps.clone(e.rect)
                }),
                    this.mergeCentreClusters(s), this.applyTableRotation(s), this.addPaddingToClusters(s);
                var i = cc.rect(s[0].testRect.x, s[0].testRect.y, 0, 0);
                if (s.forEach(function (e) {
                    i = cc.rectUnion(i, e.testRect)
                }), !(e === TileTable.ORIENTATION_HORIZONTAL && i.height > this.tableRect.height || e === TileTable.ORIENTATION_VERTICAL && i.width > this.tableRect.width)) return s.forEach(function (e) {
                    var t = cc.pSub(cc.p(e.testRect.x, e.testRect.y), cc.p(e.rect.x, e.rect.y));
                    e.cards.forEach(function (e) {
                        e.x += Math.round(t.x), e.y += Math.round(t.y)
                    })
                }), t
            }
        }, CardBlockHandler.prototype.mergeCentreClusters = function (e) {
            for (var t, s = [], i = cc.rectGetCenter(this.tableRect), n = 0; n < e.length; n++) {
                var o = e[n],
                    a = cc.pSub(i, cc.rectGetCenter(o.rect));
                !cc.rectContainsPoint(o.rect, i) && Math.abs(a.y) < Card.HEIGHT / 2 && Math.abs(a.x) < Card.WIDTH / 2 + o.rect.width / 2 && (s.push(o), e.splice(n, 1), n--)
            }
            s.length && (t = s.reduce(function (e, t) {
                return e.cards = t.cards.concat(e.cards), e.rect = cc.rectUnion(e.rect, t.rect), e.testRect = cc.rectUnion(e.testRect, t.testRect), e
            }, {
                cards: [],
                rect: s[0].rect,
                testRect: s[0].testRect
            }), e.push(t))
        }, CardBlockHandler.prototype.findCardsIntersections = function (e) {
            (e = e.slice()).sort(function (e, t) {
                return e.y - t.y
            });
            for (var t = 1, s = 0; s < e.length; s++) {
                var i = e[s];
                i.intersections = [];
                for (var n = s; 0 <= n && e[n].y > i.y - Card.HEIGHT; --n) i.overlaps(e[n]) && i.intersections.push(...e[n].intersections);
                i.i = s, i.intersections = cleverapps.unique(i.intersections), i.intersections.length || (i.intersections.push(t), t++)
            }
        }, CardBlockHandler.prototype.findCardsClusters = function (e) {
            e = e || Game.currentGame.table.cards, this.findCardsIntersections(e);
            for (var s = {}, t = 0, i = {}, n = e.length - 1; 0 <= n; n--) {
                var o = e[n],
                    a = o.intersections.find(function (e) {
                        return s[e]
                    }),
                    r = s[a];
                r || (i[++t] = [], r = t), i[r].push(o), o.intersections.forEach(function (e) {
                    var t = s[e];
                    t && t !== r && (i[r] = i[r].concat(i[t]), delete i[t], Object.keys(s).forEach(function (e) {
                        s[e] === t && (s[e] = r)
                    })), s[e] = r
                })
            }
            return Object.keys(i).map(function (e) {
                var t = this.calcRect(i[e]);
                return {
                    cards: i[e],
                    rect: t
                }
            }.bind(this))
        },
            CardBlockHandler.prototype.applyTableRotation = function (e) {
                var o = cc.rectGetCenter(this.tableRect),
                    a = Math.PI / 180 * -90;
                e.forEach(function (e) {
                    var t = e.rect,
                        s = t.x + t.width / 2 - o.x,
                        i = t.y + t.height / 2 - o.y,
                        n = o.x + Math.sin(a) * s - Math.cos(a) * i,
                        s = o.y + Math.sin(a) * s + Math.cos(a) * i;
                    e.testRect.x = n - t.width / 2, e.testRect.y = s - t.height / 2
                })
            }, CardBlockHandler.prototype.addPaddingToClusters = function (e) {
                e = e.sort(function (e, t) {
                    return e.testRect.x - t.testRect.x
                });
                for (var t = 0; t < e.length; t++)
                    for (var s = t + 1; s < e.length; s++) {
                        var i, n = e[t].testRect,
                            o = e[s].testRect;
                        cc.rectIntersectsRect(n, o) && (i = n.x + n.width + 20 - o.x, o.x += i), cc.rectIntersectsRect(n, o) && (i = n.y + n.height + 20 - o.y, o.y += i)
                    }
            }, CardBlockHandler.prototype.calcRect = TileTable.prototype.calcRect, CardBlockHandler.prototype.migrate = function (t, s) {
                var i = new Episode(t = t || 0),
                    n = this;
                i.loadData(function () {
                    var e = i.getContent();
                    (e = e && e.levels ? e.levels : e).forEach(function (e) {
                        (Array.isArray(e) ? e : [e]).forEach(function (e) {
                            e.screens.forEach(function (s) {
                                var i = s.cards.map(function (e) {
                                    return new Card(e)
                                });
                                delete s.horizontalCards, n.adaptCardBlocks(TileTable.ORIENTATION_HORIZONTAL, i) && (s.horizontalCards = [], s.cards.forEach(function (e, t) {
                                    e = cleverapps.clone(e);
                                    e.x = i[t].x, e.y = i[t].y, s.horizontalCards.push(e)
                                }))
                            })
                        })
                    }), cleverapps.git.edit("episode", {
                        episodeNo: t,
                        content: e
                    }), s && bundles["episode_" + (t + 1)] ? n.migrate(t + 1, s) : cleverapps.git.push("migrate cards", cleverapps.git.listAllChanges())
                })
            },
            function (e, t) {
                TileGame.call(this, e, t), this.updateClovers(), cleverapps.Random.seed(Date.now()), this.counter.registerStage(18, this.explode.bind(this)), this.counter.registerStage(19, this.reindex.bind(this)), this.counter.registerStage(33, this.checkLose.bind(this))
            }),
        Game = Tile3,
        Tile3Scene = (Tile3.prototype = Object.create(TileGame.prototype), (Tile3.constructor = Tile3).prototype.getInfo = function () {
            var e = TileGame.prototype.getInfo.call(this);
            return e.open = this.open.getInfo(), e.page = this.pagination.getCurrent(), e
        }, Tile3.prototype.explode = function () {
            this.open.explode(this.table.isEmpty())
        },
            Tile3.prototype.checkLose = function () {
                var e;
                if (this.outcome === GameBase.OUTCOME_UNKNOWN) return this.open.checkLose() ? (e = [function (e) {
                    this.counter.inc(), cleverapps.timeouts.setTimeout(e, OpenCards.OVERFLOW_ANIMATION_DURATION)
                }.bind(this), function (e) {
                    if (cleverapps.gameModes.skipProlongation) return this.lose(), void e();
                    new ProlongationWindow({
                        onGiveUp: this.lose.bind(this)
                    }), cleverapps.meta.onceNoWindowsListener = e
                }.bind(this), function (e) {
                    this.counter.dec(), e()
                }.bind(this)], void cleverapps.meta.display({
                    focus: "ProlongationWindow",
                    actions: e
                })) : void (this.table.isEmpty() || this.isMoveExist() || (this.counter.inc(), cleverapps.gameMessage.showMessage("message.noMoves", {
                    callback: function () {
                        this.lose(), this.counter.dec()
                    }.bind(this)
                })))
            }, Tile3.prototype.isMoveExist = function () {
                return this.table.cards.filter(function (e) {
                    return e.canPlay()
                }).length
            }, Tile3.prototype.reindex = function () {
                this.open.reindex()
            }, Tile3.prototype.setMoves = function () {
                cleverapps.audio.playSound(bundles.game.urls.return_booster_effect), Game.currentGame.log.clear(), new ActionPlayer([function (e) {
                    Game.currentGame.counter.setTimeout(e, 600)
                }, function (e) {
                    Game.currentGame.counter.setTimeout(e, 400);
                    for (var s = [], t = 0; t < 3; t++) {
                        var i = this.open.shift();
                        i && s.push(i)
                    }
                    this.table.push3CardsToStack(s), this.table.animateUpdateSize(), s.forEach(function (e, t) {
                        this.table.returnCard(e, s.length - t)
                    }.bind(this))
                }.bind(this)]).play()
            }, Tile3.prototype.updateClovers = function () {
                this.clovers = 0, this.table.cards.forEach(function (e) {
                    e.findComponent(PlateOnCard) && this.clovers++
                }.bind(this)), this.trigger("updateCloversTarget")
            }, TileGameScene.extend({
                onSceneLoaded: function () {
                    this._super();
                    var e = new OpenCardsView(this.game.open),
                        e = (this.addChild(e), cleverapps.gameModes.threeOpenCards && cleverapps.gameModes.noControls || (this.openCardsControl = new HidingNode(e, cleverapps.UI.VERTICAL), cleverapps.meta.registerControl("opencards", e)), cleverapps.boosters.getBoosterById(cleverapps.Boosters.TYPE_TILE_SHUFFLE)),
                        e = (e && e.isAvailable() && (
                            e = new TileShuffleButtonBooster(e), this.addChild(e), this.shuffleButton = new HidingNode(e, cleverapps.UI.HORIZONTAL), cleverapps.meta.registerControl(e.getControlId(), e)), cleverapps.boosters.getBoosterById(cleverapps.Boosters.TYPE_UNDO)),
                        e = (e && e.isAvailable() && (e = new UndoButtonBooster(e), this.addChild(e), this.undoButton = new HidingNode(e, cleverapps.UI.HORIZONTAL), cleverapps.meta.registerControl(e.getControlId(), e)), cleverapps.boosters.getBoosterById(cleverapps.Boosters.TYPE_VACUUM));
                    e && e.isAvailable() && (e = new VacuumButtonBooster(e), this.addChild(e), this.vacuumButton = new HidingNode(e, cleverapps.UI.HORIZONTAL), cleverapps.meta.registerControl(e.getControlId(), e))
                }
            })),
        UndoButtonBooster = (GameScene = Tile3Scene, TileTable.prototype.calcShowUpDelays = function (s) {
            var i = this.cards.map(function (e) {
                return 60 * e.x + 10 * e.y
            }),
                n = Math.min.apply(Math, i),
                o = (i.forEach(function (e, t) {
                    i[t] = e - n
                }), Math.max.apply(Math, i));
            return this.cards.map(function (e, t) {
                return s ? 0 : i[t] / o * 1e3
            })
        },
            UndoBooster.prototype.isForceAvailable = cleverapps.extendFunc(UndoBooster.prototype.isForceAvailable, function () {
                var e = Game.currentGame.open.cards,
                    t = {},
                    s = (e.forEach(function (e) {
                        void 0 === t[e.value] ? t[e.value] = 1 : t[e.value]++
                    }), !cleverapps.values(t).some(function (e) {
                        return 2 < e
                    }));
                return this._super() && s && 5 <= e.length
            }), CardView.prototype.screenShowUp = function (e, t) {
                if (t) return this.visible = !0, void e();
                var t = this.getPosition(),
                    s = cleverapps.UI.getSceneSize().height + cleverapps.styles.CardView.showUpOffset,
                    i = s / 1800;
                this.y += s, this.visible = !0, this.runAction(new cc.Sequence(new cc.MoveTo(i, t).easing(cc.easeIn(5)), new cc.CallFunc(e)))
            }, CardView.prototype.createAnimation = function () {
                this.animation = new cc.Sprite(bundles.card.frames.tile), this.fitAnimationScale(), this.icon = new cc.Sprite(bundles.card.frames.skin_0), this.icon.setScale(this.animation.getScale()), this.icon.setPosition(this.width / 2, this.height / 2), this.addChild(this.icon), this.onChangeValue(), this.animation.setAnchorPoint(0, 1),
                    this.animation.setPosition(0, this.height), this.animation.setCascadeColorEnabled(!0), cleverapps.environment.isAdministratorScene() || cleverapps.environment.isEditorScene() || (this.onTouchHandler && (this.onTouchHandler.remove(), this.onTouchHandler = void 0), this.onTouchHandler = cleverapps.UI.onPressed(this.animation, this.card.onClickListener.bind(this.card)))
            }, CardView.prototype.onChangeValue = function () {
                var e = this.card.getSkin();
                bundles.card.frames[e] || (e = "skin_0", this.card.value = 0), this.icon.setSpriteFrame(bundles.card.frames[e])
            }, CardView.prototype.highlight = function () {
                var e = new cleverapps.Spine(bundles.card.jsons.explode_json);
                e.setLocalZOrder(-1), e.setPosition(this.width / 2, this.height / 2), e.setAnimation(0, "highlight", !1), e.setCompleteListenerRemove(), this.addChild(e)
            }, CardView.prototype.explode = function () {
                var e = new cleverapps.Spine(bundles.card.jsons.explode_json),
                    e = (this.addChild(e), e.setLocalZOrder(100), e.setPosition(this.width / 2, this.height / 2), e.replaceParentSamePlace(this.getParent().getParent()), e.setAnimation(0, "explode", !1), e.setCompleteListenerRemove(), e.runAction(new cc.ScaleTo(.3, 1.25).easing(cc.easeIn(.7))), 1.15 * this.getScale());
                this.runAction(new cc.Sequence(new cc.Spawn(new cc.MoveBy(.28, 0, 25), new cc.ScaleTo(.28, e).easing(cc.easeIn(.7))), new cc.RemoveSelf))
            }, CardView.prototype.onFlip = function (e) {
                var t = this.card.isOpen() ? cleverapps.styles.COLORS.WHITE : cleverapps.styles.COLORS.DARK_TILE_COLOR,
                    s = t.r,
                    i = t.g,
                    n = t.b;
                e ? this.setColor(t) : this.runAction(new cc.TintTo(.2, s, i, n))
            }, cleverapps.overrideColors(cleverapps.styles.COLORS, {
                DARK_TILE_COLOR: new cc.Color(150, 150, 150, 255)
            }), BaseButtonBooster.extend({
                ctor: function (e) {
                    this._super({
                        booster: e,
                        styles: cleverapps.styles.UndoButtonBooster
                    }), this.setLocalZOrder(cleverapps.styles.UndoButtonBooster.zOrder), this.booster.updateState()
                },
                createIcon: function () {
                    var e = new cleverapps.Spine(bundles.buttons.jsons.undo_json);
                    return e.setAnimation(0, "idle", !1), e
                },
                onExecute: function () {
                    this.icon.setAnimation(0, "animation", !1),
                        cleverapps.audio.playSound(this.booster.executeEffect)
                }
            })),
        VacuumButtonBooster = (cleverapps.styles.UndoButtonBooster = {
            width: 200,
            height: 150,
            zOrder: 0,
            position: {
                x: [{
                    align: "center",
                    dx: 0
                }, {
                    align: "right",
                    dx: -10
                }, {
                    align: "right",
                    dx: -10
                }],
                y: [{
                    align: "bottom",
                    dy: 10
                }, {
                    align: "bottom",
                    dy: 400
                }, {
                    align: "bottom",
                    dy: 400
                }]
            },
            phone: {
                scale: .8
            },
            content: {
                layout: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 24
                    }
                },
                margin: -15,
                direction: cleverapps.UI.VERTICAL,
                freeBlock: {
                    textWidth: 120,
                    dx: 0
                }
            }
        }, BaseButtonBooster.extend({
            ctor: function (e) {
                this._super({
                    booster: e,
                    styles: cleverapps.styles.VacuumButtonBooster
                }), this.setLocalZOrder(cleverapps.styles.VacuumButtonBooster.zOrder)
            },
            createIcon: function () {
                return new cc.Sprite(bundles.buttons.frames.vacuum_png)
            }
        })),
        SimpleMainScene = (cleverapps.styles.VacuumButtonBooster = {
            width: 200,
            height: 150,
            zOrder: 0,
            position: {
                x: [{
                    align: "right",
                    dx: -50
                }, {
                    align: "right",
                    dx: -10
                }, {
                    align: "right",
                    dx: -10
                }],
                y: [{
                    align: "bottom",
                    dy: 10
                }, {
                    align: "bottom",
                    dy: 210
                }, {
                    align: "bottom",
                    dy: 210
                }]
            },
            phone: {
                scale: .8
            },
            content: {
                layout: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 24
                    }
                },
                margin: -8,
                direction: cleverapps.UI.VERTICAL,
                freeBlock: {
                    textWidth: 120,
                    dx: 0
                }
            }
        }, MainScene.extend({
            onSceneLoaded: function () {
                this._super(), this.progress = new ProgressView, this.addChild(this.progress);
                var e = this.playButton = new PlayButtonView;
                this.addChild(e, 1), e.addFinger(), cleverapps.knockoutTutorial && (cleverapps.knockoutTutorial.onPlayButtonForceListener = this.createListener(this.showPlayButtonForce.bind(this)))
            },
            showPlayButtonForce: function (e) {
                cleverapps.forces.isAvailable(this.playButton, Forces.METHA_PLAY_BUTTON) ? (cleverapps.forces.create(this.playButton, Forces.METHA_PLAY_BUTTON), cleverapps.forces.onceForceClosed = e) : e()
            },
            getBackgroundStyles: function () {
                return {
                    bundle: cleverapps.simple.getBackgroundBundle(cleverapps.simple.getCurrent()),
                    backgroundId: "background"
                }
            },
            listBundles: function () {
                return cleverapps.simple.getBundles(cleverapps.simple.current)
            }
        })),
        Simple = function () {
            for (cleverapps.EventEmitter.call(this), this.stars = 0, this.current = 0,
                this.pendingsStars = 0, this.bgsAmount = 0; bundles["simple_background_" + this.bgsAmount] || bundles["simple_background_horizontal_" + this.bgsAmount] || bundles["simple_background_vertical_" + this.bgsAmount];) this.bgsAmount++;
            cleverapps.isKnockoutGame() && (this.knockoutGame = new KnockoutGame), this.load()
        },
        StarsProgressBar = (Simple.prototype = Object.create(cleverapps.EventEmitter.prototype), (Simple.prototype.constructor = Simple).prototype.earnStars = function (e, t) {
            this.stars += e, t || (this.pendingsStars += e, this.trigger("changeStars")), this.save()
        }, Simple.prototype.getCurrent = function () {
            return this.isPassedAll() ? this.bgsAmount - 1 : this.current
        }, Simple.prototype.isPassedAll = function () {
            return this.current >= this.bgsAmount - 1
        }, Simple.prototype.canMoveNext = function () {
            return this.stars >= this.getRequiredStars() && this.current < this.bgsAmount - 1
        }, Simple.prototype.getIconBundle = function (e) {
            return e >= this.bgsAmount ? "simple_background_icon_coming_soon" : "simple_background_icon_" + e
        }, Simple.prototype.getBackgroundBundle = function (
            e) {
            return ["simple_background_" + e, (cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL ? "simple_background_vertical_" : "simple_background_horizontal_") + e, "simple_background_" + cleverapps.config.orientation + "_" + e].find(function (e) {
                return bundles[e]
            })
        }, Simple.prototype.getBundles = function (e) {
            return [this.getBackgroundBundle(e), this.getIconBundle(e), this.getIconBundle(e + 1)]
        }, Simple.prototype.moveNext = function (e) {
            var t = this.getBundles(this.current + 1);
            cleverapps.bundleLoader.loadBundles(t), cleverapps.meta.compound(e, [function (e) {
                this.isForceAvailable() ? this.showForce(e) : (cleverapps.meta.hideControlsWhileFocused("play_button"), cleverapps.timeouts.setTimeout(e, 500))
            }.bind(this), function (e) {
                this.canMoveNext() && (this.current++, this.stars = 0, this.save()), cleverapps.social.markAchievement({}), cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SIMPLE_METHA_BACKGROUND), new BackgroundsWindow({
                    moveNext: !0
                }), cleverapps.meta.onceNoWindowsListener = e
            }.bind(this), function (e) {
                new RewardWindow(
                    Simple.CalcReward()), cleverapps.meta.onceNoWindowsListener = e
            }, function (e) {
                cleverapps.meta.hideAllControls(), cleverapps.aims.whenAllHidden(e)
            }, function (e) {
                cleverapps.scenes.replaceScene(new SimpleMainScene, e), cleverapps.bundleLoader.deleteBundles(t)
            }])
        }, Simple.prototype.updateProgress = function (e) {
            this.trigger("updateProgress", this.pendingsStars), e && setTimeout(e, 1e3 * this.pendingsStars + 1300), this.pendingsStars = 0
        }, Simple.prototype.amountLevelStars = function (e) {
            return cleverapps.highscore ? Game.currentGame.isSuccessfull() ? 3 : 1 : e.isHard() ? 3 : e.isTricky() ? 2 : 1
        }, Simple.prototype.getCurrentPercent = function () {
            var e = this.getRequiredStars(),
                e = this.stars / e * 100;
            return e < 100 ? e : 100
        }, Simple.prototype.getRequiredStars = function (e) {
            e = void 0 !== e ? e : this.current;
            var t = [5, 10, 20, 30, 30, 40, 40, 40, 40, 40].concat([50, 50, 50, 50, 50, 70, 70, 70, 70, 70]).concat([100, 100, 100, 100, 100, 125, 125, 125, 125, 125]).concat([150, 150, 150, 150, 150, 175, 175, 175, 175, 175]).concat([200, 200, 200, 200, 200, 225, 225, 225, 225, 225]);
            return e < t.length ? t[e] : t[t.length - 1]
        }, Simple.prototype.isForceAvailable = function () {
            return 0 === cleverapps.user.episode && !cleverapps.forces.isShown(Forces.SIMPLE.id)
        }, Simple.prototype.showForce = function (e) {
            this.trigger("showForce"), cleverapps.forces.onceForceClosed = e
        }, Simple.prototype.gamePlayed = function (e, t) {
            e === GameBase.OUTCOME_VICTORY && (cleverapps.eventLogger.logEvent(cleverapps.EVENTS.METHA_LEVEL), cleverapps.playSession.set(cleverapps.EVENTS.METHA_LEVEL, !0)), cleverapps.highscore && cleverapps.highscore.gamePlayed(e, t)
        }, Simple.prototype.updateInfo = function (e) {
            this.updateData(e), this.save(!0), cleverapps.highscore && (cleverapps.highscore.updateInfo(e), cleverapps.highscore.save(!0))
        }, Simple.prototype.getData = function () {
            var e = {
                stars: this.stars,
                current: this.current
            };
            return this.knockoutGame && (e.knockoutLevel = this.knockoutGame.getLevel()), e
        }, Simple.prototype.getInfo = function () {
            var e = this.getData();
            return cleverapps.highscore && Object.assign(e, cleverapps.highscore.getInfo()), e
        },
            cleverapps.config.debugMode && (Simple.prototype.reset = function () {
                this.stars = 0, this.current = 0, this.knockoutGame && this.knockoutGame.reset(), this.save()
            }), Simple.prototype.save = function (e) {
                cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SIMPLE, this.getData()), e || cleverapps.synchronizer.addUpdateTask("metha"), this.knockoutGame && this.knockoutGame.load()
            }, Simple.prototype.load = function () {
                this.knockoutGame && this.knockoutGame.load();
                var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SIMPLE);
                this.updateData(e)
            }, Simple.prototype.updateData = function (e) {
                this.stars = (e = e || {}).stars || 0, this.current = e.current || 0, this.knockoutGame && (e = void 0 !== e.knockoutLevel ? e.knockoutLevel : void 0 !== e.cups ? e.cups : cleverapps.user.getVirtualProgress(), this.knockoutGame.setLevel(e))
            }, Simple.CalcReward = function () {
                var t = cleverapps.config.soft ? {
                    soft: 50
                } : {
                    hard: 50
                },
                    s = (t.boosters = {}, 0),
                    e = cleverapps.boosters.listBoostersBefore();
                return (e = "differences" === cleverapps.config.name ? cleverapps.boosters.listBoosters() : e).forEach(function (e) {
                    s < 3 && e.isAvailable() && (t.boosters[e.id] = 1, s++)
                }), t
            }, cc.Node.extend({
                ctor: function (e) {
                    this._super(), this.options = e, this.stars = (void 0 !== this.options.stars ? this.options : cleverapps.simple).stars, this.current = (void 0 !== this.options.current ? this.options : cleverapps.simple).current;
                    e = cleverapps.styles.StarsProgressBar;
                    this.setAnchorPoint2(), this.setContentSize2(this.options.width, e.bar.height), this.addProgressBar(), this.options.withPresent && this.addPresent(), cleverapps.simple.on("changeStars", function () {
                        this.setStars(0 < cleverapps.simple.pendingsStars ? cleverapps.simple.stars - cleverapps.simple.pendingsStars : cleverapps.simple.stars)
                    }.bind(this)), this.setStars(this.stars)
                },
                addProgressBar: function () {
                    var e = cleverapps.styles.StarsProgressBar.bar,
                        t = this.bar = new ScaledProgressBar({
                            background: bundles.progress_bar.frames.bg_simple,
                            progress: bundles.progress_bar.frames.bar_simple,
                            barText: {
                                font: cleverapps.styles.FONTS.STARS_PROGRESS_BAR_TEXT,
                                text: this.stars + "/" + cleverapps.simple.getRequiredStars(this.current),
                                icon: bundles.simple.frames.star_png,
                                iconBeforeText: !0,
                                iconMargin: e.iconMargin,
                                dy: e.dy
                            }
                        });
                    t.setLength(this.options.width + 2 * e.offsetX), t.setPercentage(0), t.setPositionRound(this.width / 2, this.height / 2), this.addChild(this.bar), t.background.setLocalZOrder(-10)
                },
                addPresent: function () {
                    var e = cleverapps.styles.StarsProgressBar;
                    this.present = new cleverapps.Spine(bundles.windows.jsons.present_json), this.addChild(this.present), this.present.setScale(e.present.scale), this.present.setSkin(e.present.skin), this.present.setAnimation(0, e.present.animation, !0), this.present.setPositionRound(e.present), this.present.setLocalZOrder(10), cleverapps.tooltipManager.create(this.present, {
                        text: "OpenBackgroundTooltip",
                        rewards: Simple.CalcReward(),
                        position: cleverapps.styles.UI.Tooltip.LOCATION.below,
                        size: cleverapps.styles.UI.Tooltip.SIZE.medium
                    })
                },
                setStars: function (e) {
                    this.stars = e, this.bar.updateBarText(e + "/" + cleverapps.simple.getRequiredStars(
                        this.current)), this.bar.setPercentage(100 * e / cleverapps.simple.getRequiredStars(this.current))
                },
                updateProgress: function (e) {
                    var t = cleverapps.styles.StarsProgressBar,
                        e = (this.barAnimation || (this.barAnimation = new cleverapps.Spine(bundles.simple.jsons.progress_bar_json), this.bar.addChild(this.barAnimation)), this.stars += e, this.bar.updateBarText(this.stars + "/" + cleverapps.simple.getRequiredStars(this.current)), this.stars / cleverapps.simple.getRequiredStars() * 100);
                    this.barAnimation.setPositionRound(this.bar.getPercentage() / 100 * this.bar.totalWidth + t.barAnimation.offsetX, this.bar.totalHeight / 2), this.barAnimation.setAnimation(0, "animation", !1), this.barAnimation.runAction(new cc.MoveTo(.8, e / 100 * this.bar.totalWidth + t.barAnimation.offsetX, this.barAnimation.y).easing(cc.easeOut(2))), this.bar.animatedChange(e)
                }
            })),
        ProgressView = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            STARS_PROGRESS_BAR_TEXT: {
                name: "default",
                size: 36
            }
        }), cleverapps.styles.StarsProgressBar = {
            bar: {
                offsetX: 15,
                iconMargin: 6,
                height: 80,
                dy: 5
            },
            barAnimation: {
                offsetX: -15
            },
            present: {
                scale: .7,
                x: {
                    align: "right",
                    dx: 90
                },
                y: {
                    align: "center",
                    dy: 5
                },
                skin: "green",
                animation: "animation"
            }
        }, cc.Node.extend({
            ctor: function () {
                this._super(), this.setAnchorPoint2(), this.hoverContainer = new cc.Node, this.hoverContainer.setAnchorPoint2(), this.addChild(this.hoverContainer), this.addProgressBar(), this.addArrows(), this.addIcons(), cleverapps.UI.wrap(this.hoverContainer), this.setContentSize2(this.hoverContainer.getContentSize()), this.hoverContainer.setPositionRound(this.width / 2, this.height / 2), this.addPerson(), cleverapps.UI.wrap(this), cleverapps.UI.applyHover(this.hoverContainer), cleverapps.UI.onClick(this.hoverContainer, this.onClick.bind(this)), this.updatePosition(), cleverapps.aims.registerTarget("simpleStar", this, {
                    controls: ["progress_view", "play_button"],
                    withoutDelta: !0,
                    noTargetDelta: !0,
                    flyingUnderShadow: !0,
                    flyingAnimation: Reward.NO_ANIMATION
                }), cleverapps.simple.on("updateProgress", this.updateProgress.bind(this), this), cleverapps.simple.on("showForce",
                    this.showForce.bind(this), this), SceneDecors.add(this.hoverContainer, cleverapps.skins.getSlot("progressViewDecor"))
            },
            updatePosition: function () {
                this.setPositionRound(cleverapps.styles.ProgressView)
            },
            onClick: function () {
                cleverapps.forces.isRunningForce() && cleverapps.forces.closeRunningForce(), cleverapps.audio.playSound(bundles.main.urls.click_effect), cleverapps.meta.display({
                    focus: "BackgroundsWindow",
                    action: function (e) {
                        new BackgroundsWindow, cleverapps.meta.onceNoWindowsListener = e
                    }
                })
            },
            showForce: function () {
                cleverapps.forces.create(this.hoverContainer, Forces.SIMPLE)
            },
            addPerson: function () {
                var e, t = cleverapps.styles.ProgressView.person;
                t && (this.person = new cc.Node, this.person.setAnchorPoint(.5, 0), this.person.setPositionRound(t), this.person.setContentSize2(t), this.person.setLocalZOrder(t.zOrder || 0), this.person.baseScale = this.person.scale, this.addChild(this.person), (e = new Person("hero")).setPositionRound(t.animation), this.person.addChild(e), cleverapps.UI.onClick(this.person, this.onClick.bind(this)))
            },
            runProgressAnimation: function () {
                var e = cleverapps.styles.ProgressView,
                    t = new cleverapps.Spine(bundles.simple.jsons.progress_bar_spark_json);
                this.hoverContainer.addChild(t), t.setPositionRound(e.bar.spark), t.runAction(new cc.Sequence(new cc.DelayTime(.4), new cc.CallFunc(function () {
                    t.setAnimation(0, "animation", !1), t.setCompleteListenerRemove()
                })))
            },
            runAvatarAnimation: function () {
                var e = new cleverapps.Spine(bundles.simple.jsons.avatar_spark_json);
                this.hoverContainer.addChild(e), e.setPositionRound(this.nextIcon.getPosition()), e.setCompleteListenerRemove(), e.runAction(new cc.Sequence(new cc.DelayTime(.7), new cc.CallFunc(function () {
                    e.setAnimation(0, "animation", !1), cleverapps.audio.playSound(bundles.simple.urls.simple_win_effect)
                })))
            },
            runStarAnimation: function (e, t, s, i) {
                var n = cleverapps.styles.ProgressView,
                    o = cleverapps.scenes.getRunningScene(),
                    a = this.progressBar.bar.icon,
                    a = o.convertToNodeSpace(a.getParent().convertToWorldSpace(a.getPosition())),
                    r = (a.x += n.star.x, a.y += n.star.y,
                        new cleverapps.Spine(bundles.simple.jsons.star_json));
                o.addChild(r), r.setPositionRound(a.x, o.height / 2), r.setLocalZOrder(10), r.setTimeScale(t), r.runAction(new cc.Sequence(new cc.DelayTime(e), new cc.CallFunc(function () {
                    r.setAnimation(0, "collect", !1), r.setCompleteListenerRemove()
                }), new cc.MoveTo(s, a).easing(cc.easeIn(2)), new cc.PlaySound(bundles.simple.urls.star_collect_effect), new cc.CallFunc(function () {
                    this.progressBar.updateProgress(1), i()
                }.bind(this))))
            },
            updateProgress: function (e) {
                for (var t = cleverapps.styles.ProgressView, s = (cleverapps.meta.showControlsWhileFocused(["play_button"], !0), cleverapps.wait(e, function () {
                    !cleverapps.simple.isPassedAll() && cleverapps.simple.canMoveNext() && (this.runProgressAnimation(), this.runAvatarAnimation()), cleverapps.UI.animateDelta(e, {
                        x: t.delta.x,
                        y: t.delta.y,
                        font: cleverapps.styles.FONTS.SCENE_ANIMATE_DELTA_TEXT,
                        parent: this.progressBar
                    }).replaceParentSamePlace(this)
                }.bind(this))), i = .4, n = .4 / (i = 5 < .4 * e ? 5 / e : i), o = i / .4, a = 0; a < e; a++) this.runStarAnimation(a * i, n, o, s)
            },
            addProgressBar: function () {
                var e = cleverapps.styles.ProgressView;
                this.progressBar = new StarsProgressBar({
                    width: e.bar.width,
                    stars: 0 < cleverapps.simple.pendingsStars ? cleverapps.simple.stars - cleverapps.simple.pendingsStars : void 0
                }), this.hoverContainer.addChild(this.progressBar)
            },
            addArrows: function () {
                for (var e = cleverapps.styles.ProgressView.arrows, t = new cc.Sprite(bundles.simple.frames.arrow_png).width, s = (this.progressBar.width - e.widthOffset) / (t + e.margin), i = [], n = 0; n < s; n++) i.push(new cc.Sprite(bundles.simple.frames.arrow_png));
                t = new cleverapps.Layout(i, {
                    direction: cleverapps.UI.HORIZONTAL,
                    margin: e.margin
                });
                t.setLocalZOrder(-1), this.progressBar.bar.addChild(t), t.setPositionRound(e)
            },
            addIcons: function () {
                var e = cleverapps.styles.ProgressView,
                    t = this.currentIcon = this.createIcon(),
                    t = (this.hoverContainer.addChild(t), t.setPositionRound(-e.bar.width / 2 - e.icon.offset.x, this.height / 2 + e.icon.offset.y), t.setRotation(-e.icon.rotation || 0), this.nextIcon = this.createIcon(!0));
                t.setRotation(e.icon.rotation || 0),
                    this.hoverContainer.addChild(t), t.setPositionRound(e.bar.width / 2 + e.icon.offset.x, this.height / 2 + e.icon.offset.y), cleverapps.simple.current === cleverapps.simple.bgsAmount - 1 && t.addChild(this.createLock())
            },
            createIcon: function (e) {
                var t = e ? new cc.Sprite(bundles[cleverapps.simple.getIconBundle(cleverapps.simple.current + 1)].urls.icon) : new cc.Sprite(bundles[cleverapps.simple.getIconBundle(cleverapps.simple.current)].urls.icon),
                    e = this.createIconBg(t, e),
                    s = new cc.Node;
                return s.setAnchorPoint2(), s.setContentSize2(e.getContentSize()), s.addChild(t), s.addChild(e), s.setLocalZOrder(10), t.setPositionRound(s.width / 2, s.height / 2), s
            },
            createLock: function () {
                var e = cleverapps.styles.ProgressView,
                    t = new cc.Sprite(bundles.simple.frames.lock_png);
                return t.setLocalZOrder(10), t.setScale(e.comingSoon.lock.scale), t.setPositionRound(e.comingSoon.lock), t
            },
            createIconBg: function (e, t) {
                var s = cleverapps.styles.ProgressView.icon.bg,
                    i = new cc.Scale9Sprite(
                        t ? bundles.simple.frames.frame_next_png || bundles.simple.frames.frame_silver_png : bundles.simple.frames.frame_current_png || bundles.simple.frames.frame_gold_png);
                return s.flipped ? (s = s.flipped, t && i.setScaleX(-1), i.setPositionRound(t ? s.right : s.left)) : (i.setContentSize2(e.width * e.scaleX + 2 * s.padding.x, e.height * e.scaleY + 2 * s.padding.y), i.setPositionRound(s)), i
            }
        })),
        BackgroundsWindow = (cleverapps.styles.ProgressView = {
            x: {
                align: "center"
            },
            y: {
                align: "bottom",
                dy: 250
            },
            person: !1,
            bar: {
                width: 350,
                spark: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                }
            },
            star: {
                x: 0,
                y: -12
            },
            arrows: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 4
                },
                widthOffset: 40,
                margin: 15
            },
            icon: {
                offset: {
                    y: 6,
                    x: 52
                },
                bg: {
                    padding: {
                        x: 11,
                        y: 12
                    },
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: -2
                    }
                }
            },
            comingSoon: {
                lock: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    },
                    scale: .3
                },
                icon: {
                    width: 96,
                    height: 92
                }
            },
            delta: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: 50
                }
            }
        }, Window.extend({
            onWindowLoaded: function (e) {
                this.options = e || {}, this.current = this.options.moveNext ? cleverapps.simple.getCurrent() - 1 : cleverapps.simple.getCurrent(), this.stars = this.options.moveNext ? cleverapps.simple.getRequiredStars(this.current) : cleverapps.simple.stars;
                e = this.createContent();
                this._super({
                    content: e,
                    title: "BackgroundsWindow.title",
                    name: "backgroundswindow",
                    foreground: bundles.windows.frames.window_foreground_png
                }), this.options.moveNext && this.changeCurrent()
            },
            updateSize: function () {
                this._super(), (this.scroll.dir === cleverapps.UI.ScrollView.DIR_HORIZONTAL && this.isVertical() || this.scroll.dir === cleverapps.UI.ScrollView.DIR_VERTICAL && !this.isVertical()) && (this.window.removeFromParent(), this.onWindowLoaded(this.options))
            },
            isVertical: function () {
                return cleverapps.resolution.mode === cleverapps.WideMode.VERTICAL
            },
            changeCurrent: function () {
                var e = this.bgs[cleverapps.simple.current - 1],
                    t = this.bgs[cleverapps.simple.current],
                    s = this.bgs[cleverapps.simple.current + 1];
                cleverapps.simple.current === this.bgs.length - 2 && (s = !1), e.progressBar.runAction(new cc.Sequence(new cc.DelayTime(.5), new cc.ScaleTo(.3,
                    1.2 * e.progressBar.baseScale).easing(cc.easeOut(2)), new cc.ScaleTo(.3, 0).easing(cc.easeIn(2)), new cc.DelayTime(1.3))), this.addTape(e), e.tape.setScale(0), e.tape.runAction(new cc.Sequence(new cc.DelayTime(.7), new cc.ScaleTo(.5, 1).easing(cc.easeBackInOut(.6)), new cc.CallFunc(function () {
                        cleverapps.audio.playSound(bundles.simple.urls.simple_complete_bg_effect)
                    }))), t.lock.runAction(new cc.Sequence(new cc.DelayTime(1.2), new cc.ScaleTo(.4, 1.3 * t.lock.scale).easing(cc.easeInOut(3)), new cc.ScaleTo(.4, 0).easing(cc.easeIn(3)), new cc.RemoveSelf)), t.layerColor.runAction(new cc.Sequence(new cc.DelayTime(1.4), new cc.FadeOut(.5))), this.runAction(new cc.Sequence(new cc.DelayTime(1.3), new cc.CallFunc(function () {
                        this.scroll.scrollTo(t, 1.4), cleverapps.audio.playSound(bundles.simple.urls.simple_transition_effect)
                    }.bind(this)))), s && (s.closedImage.runAction(new cc.Sequence(new cc.DelayTime(1.4), new cc.FadeOut)), this.addLayerColor(s), s.layerColor.setOpacity(150)), this.addPresent(t), t.name && this.runAction(
                        new cc.Sequence(new cc.DelayTime(1.6), new cc.CallFunc(function () {
                            t.name.setFont(cleverapps.styles.FONTS.BACKGROUNDS_WINDOW_NAME_TEXT)
                        })))
            },
            createContent: function () {
                for (var e = cleverapps.styles.BackgroundsWindow, t = Messages.get("BackgroundsWindow.text"), t = (this.options.moveNext && -1 !== ["scramble", "differences"].indexOf(cleverapps.config.name) && (t = Messages.get("BackgroundsWindow.moveNextText", {
                    place: Messages.get("background_name_" + cleverapps.simple.getCurrent())
                })), cleverapps.UI.generateOnlyText(t, cleverapps.styles.FONTS.WINDOW_TEXT)), s = (t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions((this.isVertical() ? e.text.vertical : e.text).width, 0), t.fitTo(void 0, (this.isVertical() ? e.text.vertical : e.text).height), this.bgs = [], 0), i = void 0; bundles["backgrounds_window_" + s];) {
                    var n = this.createItem(s);
                    s === this.current && (i = n), this.bgs.push(n), s++
                }
                this.bgs.push(this.createItem(s));
                var o = new cleverapps.Layout(this.bgs, {
                    childrenVisibility: cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,
                    direction: this.isVertical() ? cleverapps.UI.VERTICAL : cleverapps.UI.HORIZONTAL,
                    margin: e.scroll.margin,
                    padding: e.scroll.padding
                }),
                    a = this.scroll = new cleverapps.UI.ScrollView(o);
                return this.isVertical() ? a.setContentSize2(o.width, e.scroll.height) : a.setContentSize2(e.scroll.width, o.height), a.scrollTo(i), new cleverapps.Layout([t, a.bg || a], {
                    direction: cleverapps.UI.VERTICAL,
                    margin: this.isVertical() ? e.verticalMargin : e.margin,
                    padding: e.padding
                })
            },
            getItemSize: function () {
                var e = cleverapps.styles.BackgroundsWindow.item.size;
                return this.isVertical() ? e.horizontal : e.vertical
            },
            createItem: function (e) {
                var t = cleverapps.styles.BackgroundsWindow,
                    s = new cc.Node,
                    i = (s.setAnchorPoint2(), this.getItemSize()),
                    n = (s.setContentSize2(i.width + 2 * t.item.bg.padding.x, i.height + 2 * t.item.bg.padding.y), e <= this.current ? bundles.simple.frames.frame_gold_png : bundles.simple.frames.frame_silver_png),
                    n = cleverapps.UI.createScale9Sprite(n, cleverapps.UI.Scale9Rect.TwoPixelXY);
                return n.setContentSize2(s.getContentSize()), s.addChild(n),
                    n.setPositionRound(s.width / 2, s.height / 2), n.setLocalZOrder(10), e < this.current ? (this.addTape(s), this.addBg(s, e)) : e === this.current ? (this.addProgressBar(s, this.current, this.stars), this.addBg(s, e)) : e < cleverapps.simple.bgsAmount ? (n = s.lock = new cc.Sprite(bundles.simple.frames.lock_png), s.addChild(n), n.setPositionRound(t.lock), e === this.current + 1 ? (this.addBg(s, e), this.addLayerColor(s), s.layerColor.setOpacity(150)) : this.addClosedImage(s), this.options.moveNext && e === this.current + 2 && this.addBg(s, e)) : (this.addClosedImage(s), (n = cleverapps.UI.generateTTFText("BackgroundsWindow.ComingSoonTitle", cleverapps.styles.FONTS.BACKGROUNDS_WINDOW_NAME_COMING_SOON)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), n.setDimensions(.8 * i.width, 0), s.addChild(n), n.setPositionRound(t.comingSoon)), s
            },
            addPresent: function (e) {
                var t = cleverapps.styles.BackgroundsWindow,
                    s = new cc.Node,
                    e = (s.setAnchorPoint2(), s.setContentSize2(t.present), e.addChild(s), s.setPositionRound(t.present), cleverapps.UI.applyHover(s), s.setScale(0),
                        new cleverapps.Spine(bundles.main.jsons.reward_spine_json)),
                    e = (s.addChild(e), e.setScale(t.present.animation.scale), e.setPositionRound(t.present.animation), e.setAnimation(0, "animation", !0), new cleverapps.Spine(bundles.windows.jsons.present_json)),
                    i = (s.addChild(e), e.setScale(t.present.scale), e.setSkin("green"), e.setPositionRound(s.width / 2, s.height / 2), e.setLocalZOrder(10), e.setAnimation(0, "animation", !0), new cleverapps.UI.Button({
                        width: t.present.button.width,
                        height: t.present.button.height,
                        type: cleverapps.styles.UI.Button.Images.small_button_green,
                        text: "BackgroundsWindow.Get",
                        onClicked: function () { }
                    }));
                e.addChild(i), i.setPositionRound(t.present.button), s.runAction(new cc.Sequence(new cc.DelayTime(2.1), new cc.ScaleTo(.2, 1.2).easing(cc.easeOut(2)), new cc.CallFunc(function () {
                    cleverapps.audio.playSound(bundles.simple.urls.metha_present_effect)
                }), new cc.ScaleTo(.2, 1).easing(cc.easeIn(2)), new cc.CallFunc(function () {
                    FingerView.hintClick(i);
                    var e = new cc.Node;
                    e.setAnchorPoint2(), this.addChild(e),
                        e.setLocalZOrder(1e3), e.setContentSize2(this.width, this.height), e.setPositionRound(this.width / 2, this.height / 2), cleverapps.UI.onClick(e, function () {
                            this.close()
                        }.bind(this), {
                            ignoreScale: !0
                        })
                }.bind(this))))
            },
            addProgressBar: function (e, t, s) {
                var i = cleverapps.styles.BackgroundsWindow,
                    s = e.progressBar = new StarsProgressBar({
                        width: i.bar.width,
                        stars: s,
                        current: t,
                        withPresent: !this.options.moveNext && !cleverapps.simple.isPassedAll()
                    });
                e.addChild(s), s.setScale(i.bar.scale), s.baseScale = i.bar.scale, s.setPositionRound(i.bar)
            },
            addTape: function (e) {
                var t = cleverapps.styles.BackgroundsWindow,
                    s = e.tape = new cc.Sprite(bundles.simple.frames.tape_png),
                    e = (s.setLocalZOrder(11), e.addChild(s), t.name ? t.tape.withName : t.tape);
                s.setPositionRound(e), t.tape.text && ((e = cleverapps.UI.generateTTFText(Messages.get("BackgroundsWindow.tapeText").toUpperCase(), cleverapps.styles.FONTS.BACKGROUNDS_WINDOW_TAPE_TEXT)).setLocalZOrder(12), s.addChild(e), e.fitTo(t.tape.text.width), e.setPositionRound(t.tape.text))
            },
            addLayerColor: function (e) {
                var t = cleverapps.styles.BackgroundsWindow;
                e.layerColor = new cc.Scale9Sprite(bundles.pixel.frames.pixel_png), e.layerColor.setColor(cleverapps.styles.COLORS.CLOSED_BACKGROUND_COLOR), e.layerColor.setContentSize2(this.getItemSize()), e.layerColor.setAnchorPoint2(0, 0), e.layerColor.setLocalZOrder(-9), e.addChild(e.layerColor), e.layerColor.setPositionRound(e.width / 2 - e.layerColor.width / 2 + t.layerColor.offsetX, e.height / 2 - e.layerColor.height / 2 + t.layerColor.offsetY)
            },
            addClosedImage: function (e) {
                var t = cleverapps.styles.BackgroundsWindow,
                    s = this.isVertical() ? bundles.simple.frames.closed_bg_png : bundles.simple.frames.closed_bg_vertical_png;
                e.closedImage = new cc.Sprite(s), e.closedImage.setLocalZOrder(-9), e.addChild(e.closedImage), e.closedImage.setPositionRound(t.item.bg)
            },
            addBg: function (e, t) {
                var s = cleverapps.styles.BackgroundsWindow,
                    i = "backgrounds_window_",
                    i = (this.isVertical() || (i += "vertical_"), e.bg = new cc.Sprite(bundles[i + t].urls.background));
                i.setLocalZOrder(-10), e.addChild(i), i.setPositionRound(s.item.bg), this.addNameText(e, t)
            },
            addNameText: function (e, t) {
                var s, i, n = cleverapps.styles.BackgroundsWindow;
                n.name && (s = cleverapps.styles.FONTS.BACKGROUNDS_WINDOW_NAME_TEXT, (s = e.name = cleverapps.UI.generateTTFText("background_name_" + t, s)).setPositionRound(n.name), (i = bundles.simple.frames.blue_background) ? ((i = cleverapps.UI.createScale9Sprite(i, cleverapps.UI.Scale9Rect.TwoPixelXY)).addChild(s), i.setPositionRound(n.name.bg), i.setContentSize2(e.width, i.height), e.addChild(i), s.setPositionRound(n.name)) : e.addChild(s, 11), t === this.current + 1 && e.lock.setPositionRound(n.lockWithName))
            },
            listBundles: function (e) {
                var t = [],
                    s = cleverapps.simple.current + 1;
                (e = e || {}).moveNext && s++;
                for (var i = 0; i <= s; i++) t.push("backgrounds_window_" + i);
                return t
            }
        })),
        PiggyBank = (cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            BACKGROUNDS_WINDOW_TAPE_TEXT: {
                size: 60,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: {
                    color: new cc.Color(168, 28, 54, 255),
                    size: 2
                }
            },
            BACKGROUNDS_WINDOW_NAME_COMING_SOON: {
                size: 60,
                color: new cc.Color(255, 232, 72, 255),
                stroke: {
                    size: 1,
                    color: new cc.Color(198, 90, 22, 255)
                },
                shadow: {
                    direction: cc.size(0, -4),
                    color: new cc.Color(198, 90, 22, 255),
                    blur: 1
                }
            },
            BACKGROUNDS_WINDOW_NAME_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            }
        }), cleverapps.overrideColors(cleverapps.styles.COLORS, {
            CLOSED_BACKGROUND_COLOR: new cc.Color(0, 8, 38, 255)
        }), cleverapps.styles.BackgroundsWindow = {
            margin: -10,
            verticalMargin: 5,
            padding: {
                bottom: -26,
                right: -46,
                left: -48
            },
            text: {
                width: 1700,
                height: 100,
                vertical: {
                    width: 600,
                    height: 200
                }
            },
            lock: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 8
                }
            },
            tape: {
                x: {
                    align: "right",
                    dx: 16
                },
                y: {
                    align: "top",
                    dy: -25
                },
                withName: {
                    x: {
                        align: "right",
                        dx: 16
                    },
                    y: {
                        align: "top",
                        dy: -120
                    }
                },
                text: {
                    x: 147,
                    y: 58,
                    width: 220
                }
            },
            layerColor: {
                offsetX: 0,
                offsetY: 0
            },
            comingSoon: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center"
                }
            },
            bar: {
                width: 300,
                scale: .8,
                x: {
                    align: "center",
                    dx: -25
                },
                y: {
                    align: "bottom",
                    dy: 80
                }
            },
            item: {
                size: {
                    vertical: {
                        width: 443,
                        height: 633
                    },
                    horizontal: {
                        width: 600,
                        height: 350
                    }
                },
                bg: {
                    padding: {
                        x: 13,
                        y: 15
                    },
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center"
                    }
                }
            },
            scroll: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -1
                },
                height: 800,
                width: 1800,
                margin: 15,
                padding: {
                    x: 35,
                    y: 40
                },
                rightHorizontalFrame: {
                    x: {
                        align: "right",
                        dx: 2
                    },
                    y: {
                        align: "center"
                    },
                    padding: 30
                },
                leftHorizontalFrame: {
                    x: {
                        align: "left"
                    },
                    y: {
                        align: "center"
                    },
                    padding: 30
                }
            },
            present: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: -30
                },
                width: 200,
                height: 200,
                scale: 1,
                animation: {
                    scale: .5,
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                },
                button: {
                    width: 150,
                    height: 80,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "bottom"
                    }
                }
            }
        }, function () {
            this.active = void 0, this.when = void 0, this.level = void 0, this.amount = 0, this.load()
        }),
        PiggyBankWindow = (PiggyBank.prototype.load = function () {
            var e = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PIGGY_BANK) || {};
            this.active = e.active || !1, this.when = e.when || void 0, this.level = e.level || 0, this.amount = e.amount || 0, this.updateState()
        }, PiggyBank.prototype.getInfo = function () {
            return {
                active: this.active,
                when: this.when,
                level: this.level,
                amount: this.amount
            }
        }, PiggyBank.prototype.updateInfo = function (e, t) {
            this.active = e.active, this.when = e.when, this.level = e.level, this.amount = e.amount, this.save(t)
        }, PiggyBank.prototype.getLeftTime = function () {
            return cleverapps.parseInterval(PiggyBank.LIFETIME) - (Date.now() - this.when)
        }, PiggyBank.prototype.getProduct = function () {
            return Product.Create(PiggyBank.PRODUCTS[this.level]) || Product.Create(PiggyBank.VIRTUAL_PRODUCTS[this.level])
        }, PiggyBank.prototype.buy = function (t) {
            var e = this.getProduct();
            e.reward = this.getReward() || e.reward, e.buy(function (e) {
                e && (this.stop(), t())
            }.bind(this))
        }, PiggyBank.prototype.updateState = function () {
            var e = !1;
            this.active && this.when + cleverapps.parseInterval(PiggyBank.LIFETIME) < Date.now() && (this.active = !1, this.when += cleverapps.parseInterval(PiggyBank.LIFETIME), e = !0, this.logStop()), this.active || (void 0 === this.when || this.when + cleverapps.parseInterval(PiggyBank.INTERMISSION) < Date.now()) && (this.start(), e = !1), e && this.save(), clearTimeout(this.timer),
                this.timer = new cleverapps.LongTimeout(function () {
                    cleverapps.sideBar.resetByClassName(PiggyBankIcon)
                }, this.getLeftTime())
        }, PiggyBank.prototype.save = function (e) {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PIGGY_BANK, this.getInfo()), e || cleverapps.synchronizer.addUpdateTask("piggybank")
        }, PiggyBank.prototype.getReward = function () {
            var e;
            if (this.isActive()) return (e = {})[this.getRewardCurrency()] = this.amount, e
        }, PiggyBank.prototype.getBaseAmount = function () {
            return this.getProduct().reward[this.getRewardCurrency()]
        }, PiggyBank.prototype.getAddAmount = function () {
            return (this.getMaxAmount() - this.getBaseAmount()) / PiggyBank.WINS_TO_FULFILL
        }, PiggyBank.prototype.getMaxAmount = function () {
            return Math.round(this.getBaseAmount() * PiggyBank.MAX_COEF / PiggyBank.WINS_TO_FULFILL) * PiggyBank.WINS_TO_FULFILL
        }, PiggyBank.prototype.isFull = function () {
            return this.amount >= this.getMaxAmount()
        }, PiggyBank.prototype.add = function (e) {
            this.isFull() || (this.amount += e, this.save(), this.isFull() && cleverapps.sideBar.resetByClassName(PiggyBankIcon))
        }, PiggyBank.MAX_COEF = 1.4, PiggyBank.prototype.start = function () {
            this.active = !0, this.when = Date.now(), this.level = cleverapps.paymentsHistory.classify(), this.level === cleverapps.PaymentsHistory.BRACKET_UNDECIDED && (this.level = cleverapps.PaymentsHistory.BRACKET_NONE), this.level === cleverapps.PaymentsHistory.BRACKET_BIGWHALE && (this.level = cleverapps.PaymentsHistory.BRACKET_WHALE), this.amount = this.getBaseAmount(), this.save()
        }, PiggyBank.prototype.getCurrentAmount = function () {
            var e = cleverapps.formatAmount(this.amount);
            return "soft" === this.getRewardCurrency() ? "@@" + e : "$$" + e
        }, PiggyBank.prototype.getCurrentPrice = function () {
            return this.getProduct().getCurrentPrice()
        }, PiggyBank.prototype.getRewardCurrency = function () {
            return this.getProduct().reward.soft ? "soft" : "hard"
        }, PiggyBank.prototype.logStop = function () {
            cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PIGGY_BANK + "_stop"), this.isFull() && cleverapps.eventLogger.logEvent(
                cleverapps.EVENTS.PIGGY_BANK + "_stop_full")
        }, PiggyBank.prototype.stop = function () {
            this.logStop(), this.active = !1, this.when = Date.now(), this.save(), cleverapps.sideBar.resetByClassName(PiggyBankIcon)
        }, PiggyBank.prototype.isActive = function () {
            return !!levels.user.checkAvailable(PiggyBank.AVAILABLE) && (!cleverapps.flags.videoAdsMainMonetization && (this.updateState(), this.active))
        }, PiggyBank.OnRestoreSuccess = function () {
            cleverapps.piggyBank && cleverapps.piggyBank.stop()
        }, PiggyBank.GetRestoreReward = function () {
            if (cleverapps.piggyBank && cleverapps.piggyBank.isActive()) return cleverapps.piggyBank.getReward()
        }, PiggyBank.AVAILABLE = {
            level: 3.6
        }, PiggyBank.PRODUCTS = ["piggybank500", "piggybank1800", "piggybank6000", "piggybank25000"], PiggyBank.VIRTUAL_PRODUCTS = ["piggybankSmall", "piggybankMedium", "piggybankLarge", "piggybankHuge"], PiggyBank.WINS_TO_FULFILL = 10, PiggyBank.LIFETIME = cleverapps.config.debugMode ? "10 minutes" : "3 days", PiggyBank.INTERMISSION = cleverapps.config.debugMode ? "1 minute" : "3 days",
            "board" === cleverapps.config.type && (PiggyBank.WINS_TO_FULFILL = 5), Window.extend({
                onWindowLoaded: function () {
                    var e, t, s, i, n, o = cleverapps.piggyBank.getLeftTime();
                    o <= 0 || (e = cleverapps.styles.PiggyBankWindow, t = this.createAnimation(), s = this.createBalance(), o = this.createTimer(o), n = this.createTopText(), (i = new cc.Node).setContentSize2(0, e.amount.margin), n = new cleverapps.Layout([n, i, s, t, o], {
                        direction: cleverapps.UI.VERTICAL,
                        margin: e.margin,
                        padding: e.padding
                    }), this._super({
                        name: "piggybankwindow",
                        title: cleverapps.piggyBank.isFull() ? "PiggyBankWindow.Title.Full" : "PiggyBankWindow.Title",
                        content: n,
                        button: {
                            width: e.button.width,
                            height: e.button.height,
                            text: cleverapps.piggyBank.getCurrentPrice(),
                            onPressed: function () {
                                cleverapps.piggyBank.buy(this.close.bind(this))
                            }.bind(this)
                        },
                        help: function () {
                            new GuideWindow({
                                name: "PiggyBankRulesWindow"
                            })
                        },
                        styles: cleverapps.styles.PiggyBankWindow,
                        openSound: bundles.main.urls.shop_buy_effect
                    }), Lottery.addIcon(this.button), Lottery.addText(this))
                },
                createAnimation: function () {
                    var e = new cleverapps.Spine(bundles.piggy_bank.jsons.piggy_bank_json);
                    return e.setAnimation(0, cleverapps.piggyBank.isFull() ? "piggy_full" : "piggy_bank", !0), e
                },
                createBalance: function () {
                    var e = cleverapps.styles.PiggyBankWindow,
                        t = cleverapps.UI.generateOnlyText("Balance", cleverapps.styles.FONTS.WINDOW_TEXT),
                        s = (t.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(0, e.text.height), cleverapps.UI.createScale9Sprite(bundles.timer.frames.timer_bg_png)),
                        i = (s.setContentSize2(e.amount.width, e.amount.height), new TextWithIcon(cleverapps.piggyBank.getCurrentAmount(), {
                            font: cleverapps.styles.FONTS.WHITE_TEXT
                        }));
                    return i.setPositionRound(s.width / 2, s.height / 2), s.addChild(i), new cleverapps.Layout([t, s], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: e.timer.margin.x
                    })
                },
                createTimer: function (e) {
                    var t = cleverapps.styles.PiggyBankWindow,
                        s = cleverapps.UI.generateOnlyText("PiggyBankWindow.text2", cleverapps.styles.FONTS.WINDOW_TEXT),
                        i = (s.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER), s.fitTo(t.timer.text.width),
                            cleverapps.UI.createScale9Sprite(bundles.timer.frames.timer_bg_png)),
                        i = (i.setContentSize2(t.timer.width, t.timer.height), {
                            background_content: i,
                            font: cleverapps.styles.FONTS.SMALL_WHITE_TEXT,
                            timerPosition: t.timer
                        }),
                        e = new cleverapps.CountDownView(new cleverapps.CountDown(e, {
                            onFinish: function () {
                                this.close()
                            }.bind(this)
                        }), i);
                    return e.y = t.timer.offsetY, new cleverapps.Layout([s, e], {
                        direction: cleverapps.UI.HORIZONTAL,
                        margin: t.timer.margin.x
                    })
                },
                createTopText: function () {
                    var e = cleverapps.styles.PiggyBankWindow,
                        t = cleverapps.piggyBank.isFull() ? "PiggyBankWindow.text1.Full" : "PiggyBankWindow.text1",
                        s = cleverapps.piggyBank.getProduct(),
                        t = cleverapps.UI.generateOnlyText(t, cleverapps.styles.FONTS.WINDOW_TEXT, {
                            price: Product.ReplaceIconCodes(s.getCurrentPrice())
                        });
                    return t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER), t.setDimensions(e.text.width, 0), t.fitTo(void 0, e.text.height), t
                }
            })),
        PiggyBankIcon = (PiggyBankWindow.prototype.listBundles = function () {
            return ["piggy_bank_window"]
        },
            cleverapps.styles.PiggyBankWindow = {
                margin: 20,
                amount: {
                    width: 260,
                    height: 64,
                    margin: 10
                },
                text: {
                    width: 640,
                    height: 150
                },
                button: {
                    width: 300,
                    height: 100
                },
                timer: {
                    text: {
                        width: 400
                    },
                    width: 220,
                    height: 50,
                    margin: {
                        x: 30
                    },
                    offsetY: -5,
                    x: 0,
                    y: 0
                }
            },
            function () {
                SideBarIcon.call(this, {
                    animation: bundles.sidebar.jsons.piggybank_icon_json
                }), cleverapps.flags.on("change:videoAdsMainMonetization", function () {
                    cleverapps.sideBar.resetByClassName(PiggyBankIcon)
                })
            }),
        Achievements = (PiggyBankIcon.prototype = Object.create(SideBarIcon.prototype), (PiggyBankIcon.prototype.constructor = PiggyBankIcon).prototype.resetState = function () {
            this.available = cleverapps.piggyBank.isActive(), this.setAttention(cleverapps.piggyBank.isFull()), this.setLeftTime(cleverapps.piggyBank.getLeftTime())
        }, PiggyBankIcon.prototype.onPressed = function () {
            cleverapps.meta.display({
                focus: "PiggyBankWindow",
                control: "MenuBarGoldItem",
                action: function (e) {
                    new PiggyBankWindow, cleverapps.meta.onceNoWindowsListener = e
                }
            })
        }, function () {
            this.tasks = [], this.load(),
                cleverapps.eventBus.on("taskEvent", this.onTaskEvent.bind(this)), cleverapps.eventBus.on("gameEvent", this.onGameEvent.bind(this)), cleverapps.eventBus.on("unitAvailable", function (e) {
                    this.onGameEvent(Merge.OPEN_UNIT, {
                        unit: e
                    })
                }.bind(this), this)
        }),
        Achievement = (Achievements.prototype.load = function (e) {
            var t = cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ACHIEVEMENTS) || 0,
                s = cleverapps.fromBit(t = void 0 !== e ? e : t);
            this.wantsPastCheck = !0, this.tasks = AchievementsConfig.map(function (e, t) {
                return new Achievement(e, s.includes(t))
            })
        }, Achievements.prototype.getInfo = function () {
            var s = [];
            return this.tasks.forEach(function (e, t) {
                e.isComplete() && s.push(t)
            }), cleverapps.toBit(s)
        }, Achievements.prototype.save = function (e) {
            cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ACHIEVEMENTS, this.getInfo()), !1 !== e && cleverapps.synchronizer.addUpdateTask("achievements")
        }, Achievements.prototype.listCompleted = function () {
            return this.tasks.filter(function (e) {
                return e.isComplete()
            })
        },
            Achievements.prototype.listTasks = function () {
                return this.tasks
            }, Achievements.prototype.checkPastFeats = function () {
                this.wantsPastCheck = !1, "match3" === cleverapps.config.type ? (this.onTaskEvent(DailyTasks.PASS_LEVEL), this.onTaskEvent(DailyTasks.UPGRADE_HERO)) : "merge" === cleverapps.config.type && (this.onTaskEvent(DailyTasks.LEVEL_UP), this.onGameEvent(Merge.OPEN_UNIT))
            }, Achievements.prototype.onGameEvent = function (t, s) {
                this.tasks.forEach(function (e) {
                    if (e.type === t) switch (t) {
                        case Merge.MERGE:
                            e.config.amount <= s.affected.length && e.complete();
                            break;
                        case Merge.OPEN_UNIT:
                            cleverapps.unitsLibrary.isOpened(e.config.unit) && e.complete();
                            break;
                        case Merge.BUILD:
                            e.config.castle && s.affected.isCastle() && e.complete();
                            break;
                        default:
                            e.complete()
                    }
                })
            }, Achievements.prototype.onTaskEvent = function (t) {
                this.tasks.forEach(function (e) {
                    if (e.type === t) switch (t) {
                        case DailyTasks.PASS_LEVEL:
                            cleverapps.user.getHumanReadableNumber() >= e.config.level && e.complete();
                            break;
                        case DailyTasks.LEVEL_UP:
                            e.config.level <= cleverapps.user.level && e.complete();
                            break;
                        case DailyTasks.UPGRADE_HERO:
                            e.config.allOpen ? Heroes.AVAILABLE_HEROES.every(function (e) {
                                return 1 <= match3.heroes.getLevel(e)
                            }) && e.complete() : match3.heroes.getLevel(e.config.hero.color) >= e.config.hero.level && e.complete();
                            break;
                        default:
                            e.complete()
                    }
                })
            },
            function (e, t) {
                this.type = e.type, this.config = e, this.completed = Boolean(t)
            }),
        AchievementsConfig = (Achievement.prototype.complete = function () {
            this.completed || (this.completed = !0, this.save(), cleverapps.social.markAchievement(this.config))
        }, Achievement.prototype.isComplete = function () {
            return this.completed
        }, Achievement.prototype.getConfig = function () {
            return this.config
        }, Achievement.prototype.save = function () {
            cleverapps.achievements.save()
        }, Achievement.prototype.getIcon = function () {
            return new cc.Sprite(bundles.achievements.frames[this.config.title])
        }, Achievement.prototype.getTitle = function () {
            return Messages.get("Achievements." + this.config.title + ".title")
        },
            Achievement.prototype.getDescription = function () {
                return Messages.get("Achievements." + this.config.title + ".description")
            }, []),
        AchievementsTab = ("merge" === cleverapps.config.type && (AchievementsConfig = AchievementsConfig.concat(AchievementsConfig, [{
            type: Merge.MERGE,
            title: "combomaster",
            amount: 17,
            kongId: "Combo Master",
            vkId: 4
        }, {
            type: DailyTasks.LEVEL_UP,
            title: "apprentice",
            level: 7,
            kongId: "Apprentice",
            vkId: 3
        }, {
            type: DailyTasks.LEVEL_UP,
            title: "apprenticenomore",
            level: 11,
            kongId: "Apprentice No More",
            vkId: 5
        }, {
            type: Merge.OPEN_UNIT,
            title: "charactercollector",
            unit: {
                code: "king",
                stage: 3
            },
            kongId: "Character Collector",
            vkId: 6
        }, {
            type: DailyTasks.FINISH_EXPEDITION,
            title: "greatexplorer",
            kongId: "Great Explorer",
            vkId: 7
        }, {
            type: Merge.BUILD,
            title: "grandarchitect",
            castle: !0,
            kongId: "Grand Architect",
            vkId: 8
        }, {
            type: DailyTasks.LEVEL_UP,
            title: "mergechampion",
            level: 34,
            kongId: "Merge Champion",
            vkId: 9
        }])), "match3" === cleverapps.config.type && (AchievementsConfig = AchievementsConfig.concat(AchievementsConfig, [{
            type: DailyTasks.PASS_LEVEL,
            title: "thirtyleveltriumph",
            level: 29,
            vkId: 21
        }, {
            type: DailyTasks.USE_MULTI_COLOR_CELL,
            title: "rainbowrush",
            vkId: 22
        }, {
            type: DailyTasks.OPEN_STAR_CHEST,
            title: "starchestsurprise",
            vkId: 23
        }, {
            type: DailyTasks.UPGRADE_HERO,
            title: "redherounleashed",
            hero: {
                color: "d",
                level: 1
            },
            vkId: 24
        }, {
            type: DailyTasks.PASS_LEVEL,
            title: "level200achiever",
            level: 199,
            vkId: 25
        }, {
            type: DailyTasks.UPGRADE_HERO,
            title: "herocollector",
            allOpen: !0,
            vkId: 26
        }, {
            type: DailyTasks.PASS_LEVEL,
            title: "level1000legend",
            level: 999,
            vkId: 27
        }])), cc.Node.extend({
            ctor: function (e) {
                this._super(), this.setAnchorPoint2(), this.setContentSize(e.dailyTasksTab.getContentSize()), this.window = e, this.createScroll()
            },
            createScroll: function () {
                var e, t, s = cleverapps.styles.AchievementsTab.scroll,
                    i = this.scroll = new cleverapps.UI.ScrollView(this.createGrid(), {
                        direction: cleverapps.UI.ScrollView.DIR_VERTICAL,
                        scrollBarEnabled: !1
                    });
                i.setContentSize2(this.width, this.height - s.paddingY), i.setPositionRound(s), i.scrollToPercent(100), this.addChild(i),
                    s.foreground && (e = cleverapps.UI.createScale9Sprite(bundles.dailytasks.frames.foreground_png), t = "merge" === cleverapps.config.type, e.setContentSize2((t ? s.foreground.wide : s.foreground).width, i.height + s.foreground.paddingY), this.addChild(e), e.setPositionRound(i.getPosition()))
            },
            createGrid: function () {
                var e = cleverapps.styles.AchievementsTab;
                return new cleverapps.GridLayout(this.createItems(), {
                    columns: "merge" === cleverapps.config.type ? 5 : 4,
                    margin: e.margin,
                    padding: e.gridPadding
                })
            },
            createItems: function () {
                for (var e = cleverapps.styles.AchievementsTab.item, t = cleverapps.achievements.listTasks(), s = [], i = 0; i < AchievementsTab.MIN_AMOUNT; i++) {
                    var n = t[i] && t[i].isComplete() ? bundles.achievements.frames.bg : bundles.achievements.frames.bg_off,
                        n = cleverapps.UI.createScale9Sprite(n, cleverapps.UI.Scale9Rect.TwoPixelXY),
                        o = (n.setContentSize2(e), t[i] ? t[i].getIcon() : new cc.Sprite(bundles.achievements.frames.unknown));
                    n.addChild(o), o.setPositionRound(n.width / 2, n.height / 2), t[i] && !t[i].isComplete() && o.setColor(cc.color(130,
                        130, 130)), cleverapps.UI.onClick(n, this.itemClick.bind(this, t[i]), {
                            ignoreScale: !0
                        }), s.push(n)
                }
                return s
            },
            itemClick: function (e) {
                this.window.showHint(e ? e.getDescription() : "Achievements.unknown")
            }
        }));
    cleverapps.styles.AchievementsTab = {
        scroll: {
            paddingY: 10,
            x: {
                align: "center"
            },
            y: {
                align: "center"
            }
        },
        margin: {
            x: 5,
            y: 5
        },
        gridPadding: {
            x: 0,
            y: 80
        },
        item: {
            width: 200,
            height: 200
        }
    }, AchievementsTab.MIN_AMOUNT = 30, cleverapps.overrideStyles(cleverapps.styles.Decorators, {
        xmas_window_right_top: {
            type: Decors.TYPE_ANIMATION,
            json: bundles.windows.jsons.xmas_window_title,
            animation: "right",
            x: {
                align: "right",
                dx: 85
            },
            y: {
                align: "top",
                dy: 30
            },
            lovesBackground: !0
        },
        xmas_window_right_bottom: {
            type: Decors.TYPE_ANIMATION,
            json: bundles.windows.jsons.xmas_window,
            animation: "down_right",
            x: {
                align: "right",
                dx: 11
            },
            y: {
                align: "bottom",
                dy: -18
            },
            lovesBackground: !0
        },
        xmas_window_left_bottom: {
            type: Decors.TYPE_ANIMATION,
            json: bundles.windows.jsons.xmas_window,
            animation: "down_left",
            x: {
                align: "left",
                dx: -18
            },
            y: {
                align: "bottom",
                dy: -23
            },
            lovesBackground: !0
        },
        xmas_window_left_top: {
            type: Decors.TYPE_ANIMATION,
            json: bundles.windows.jsons.xmas_window_title,
            animation: "left",
            x: {
                align: "left",
                dx: -88
            },
            y: {
                align: "top",
                dy: 30
            },
            lovesBackground: !0
        },
        shadow_liana_left: {
            lovesWindow: !0,
            type: Decors.TYPE_ANIMATION,
            json: bundles.windows.jsons.shadow_liana_left,
            animation: "open",
            idle: "idle",
            position: [{
                x: {
                    align: "center",
                    anchor: "right",
                    dx: -700
                },
                y: {
                    align: "top",
                    dy: 230
                }
            }, {
                x: {
                    align: "center",
                    anchor: "right",
                    dx: -700
                },
                y: {
                    align: "top",
                    dy: 230
                }
            }, {
                x: {
                    align: "left",
                    dx: -160
                },
                y: {
                    align: "top",
                    dy: 230
                }
            }]
        },
        shadow_liana_right: {
            lovesWindow: !0,
            type: Decors.TYPE_ANIMATION,
            json: bundles.windows.jsons.shadow_liana_right,
            animation: "open",
            idle: "idle",
            position: [{
                x: {
                    align: "center",
                    anchor: "left",
                    dx: 700
                },
                y: {
                    align: "top",
                    dy: 130
                }
            }, {
                x: {
                    align: "center",
                    anchor: "left",
                    dx: 700
                },
                y: {
                    align: "top",
                    dy: 130
                }
            }, {
                x: {
                    align: "right",
                    dx: 160
                },
                y: {
                    align: "top",
                    dy: 130
                }
            }]
        },
        aquatic_flower: {
            lovesWindow: !0,
            type: Decors.TYPE_ANIMATION,
            json: bundles.windows.jsons.aquatic_flower,
            animation: "open",
            idle: "animation",
            position: [{
                x: {
                    align: "center",
                    dx: 640
                },
                y: {
                    align: "bottom",
                    dy: -5
                }
            }, {
                x: {
                    align: "center",
                    dx: 640
                },
                y: {
                    align: "bottom",
                    dy: -5
                }
            }, {
                x: {
                    align: "right",
                    dx: 30
                },
                y: {
                    align: "bottom",
                    dy: -5
                }
            }]
        },
        shop_bonusSale_decor: {
            type: Decors.TYPE_SCALE9,
            width: 450,
            image: bundles.tile_shop.frames.bonussale_decor,
            x: {
                align: "left",
                dx: -32
            },
            y: {
                align: "top",
                dy: 26
            },
            filter: function (e) {
                return PeriodicSaleLogic.NeedTileDecor(e)
            },
            content: {
                generator: PeriodicSaleLogic.TileDecorGenerator,
                x: {
                    align: "center",
                    dx: 5
                },
                y: {
                    align: "center",
                    dy: 3
                },
                margin: {
                    x: 15,
                    y: 0
                },
                textMargin: 0,
                iconWrap: {
                    height: 30
                }
            }
        },
        halloween_window_candle_right: {
            image: bundles.windows.frames.candle_decor,
            type: Decors.TYPE_IMAGE,
            x: {
                align: "right",
                dx: -125
            },
            y: {
                align: "top",
                dy: 120
            },
            lovesBackground: !0,
            scale: {
                x: 1,
                y: 1
            }
        },
        halloween_window_lian_left: {
            image: bundles.windows.frames.lian_down_decor,
            type: Decors.TYPE_IMAGE,
            x: {
                align: "left",
                dx: 60
            },
            y: {
                align: "bottom",
                dy: -98
            },
            lovesBackground: !0,
            scale: {
                x: 1,
                y: 1
            }
        },
        halloween_window_lian_top: {
            image: bundles.windows.frames.lian_left_decor,
            type: Decors.TYPE_IMAGE,
            x: {
                align: "left",
                dx: 86
            },
            y: {
                align: "top",
                dy: 69
            },
            lovesBackground: !0,
            scale: {
                x: 1,
                y: 1
            }
        },
        halloween_window_lian_bottom: {
            image: bundles.windows.frames.lian_right_decor,
            type: Decors.TYPE_IMAGE,
            x: {
                align: "right",
                dx: 94
            },
            y: {
                align: "bottom",
                dy: -40
            },
            lovesBackground: !0,
            scale: {
                x: 1,
                y: 1
            }
        }
    }), cleverapps.overrideStyles(cleverapps.styles.SceneDecors, {
        xmas_menubar: {
            image: bundles.menubar.frames.xmas_menubar,
            x: {
                align: "left",
                dx: 25
            },
            y: {
                align: "top",
                dy: 17
            }
        },
        xmas_menubar_level: {
            image: bundles.menubar.frames.xmas_menubar_level,
            x: {
                align: "left",
                dx: 49
            },
            y: {
                align: "top",
                dy: 20
            }
        },
        xmas_control_buttons: {
            image: bundles.controlbuttons.frames.xmas_control_buttons,
            x: {
                align: "center",
                dx: 0
            },
            y: {
                align: "top",
                dy: 9
            }
        },
        xmas_sidebar: {
            image: bundles.sidebar.frames.xmas_sidebar,
            x: {
                align: "center",
                dx: -2
            },
            y: {
                align: "bottom",
                dy: -3
            }
        },
        xmas_toolbar: [{
            image: bundles.toolbar.frames.xmas_toolbar,
            x: {
                align: "left",
                dx: -29
            },
            y: {
                align: "top",
                dy: 34
            }
        }, {
            image: bundles.toolbar.frames.xmas_toolbar,
            x: {
                align: "right",
                dx: 29
            },
            y: {
                align: "top",
                dy: 33
            },
            scale: {
                x: -1,
                y: 1
            }
        }]
    }),
        cleverapps.styles.COLORS = cleverapps.overrideColors(cleverapps.styles.COLORS, {
            COLOR_WINDOW_TEXT: new cc.Color(169, 61, 32, 255),
            DARK_TEXT_COLOR: new cc.Color(169, 61, 32, 255),
            MOVES_DANGER: new cc.Color(255, 0, 0, 255),
            PATH_COLOR: new cc.Color(255, 230, 180, 255),
            LETTER: new cc.Color(94, 24, 89, 255),
            COLOR_LIGHTBROWN: new cc.Color(200, 171, 124, 255),
            COLOR_LIGHT_WINDOW_TEXT: new cc.Color(160, 100, 70, 255),
            COLOR_VICTORY: new cc.Color(253, 217, 61, 255),
            GOAL_NOT_DONE_COLOR: new cc.Color(255, 100, 100, 255),
            BOMB_TIMER_DANGER_COLOR: new cc.Color(255, 50, 50, 255),
            HARD: new cc.Color(255, 241, 226, 255),
            GROWTH_FUND_LEVEL_TITLE_COLOR: new cc.Color(171, 121, 89, 255),
            GROWTH_FUND_LEVEL_REWARD_COLOR: new cc.Color(234, 219, 206, 255),
            CELL_COLORS: {
                a: new cc.Color(20, 160, 237, 255),
                b: new cc.Color(20, 200, 0, 255),
                c: new cc.Color(195, 61, 225, 255),
                d: new cc.Color(255, 11, 28, 255),
                e: new cc.Color(234, 199, 48, 255),
                w: new cc.Color(50, 200, 255, 255)
            },
            GREEN: new cc.Color(90, 166, 58, 255),
            DARK_BLUE: new cc.Color(15, 100, 172, 255),
            COLOR_BROWN: new cc.Color(187, 91, 45, 255),
            COLOR_BROWN_2: new cc.Color(173, 61, 0, 255),
            COLOR_DARK_YELLOW: new cc.Color(255, 194, 9, 255),
            COLOR_VIOLET: new cc.Color(255, 30, 252, 255),
            COLOR_DARK_VIOLET: new cc.Color(139, 0, 156, 255),
            LIGHT_PURPLE: new cc.Color(208, 0, 255, 255),
            ORANGE: new cc.Color(255, 115, 0, 255),
            COLOR_BONUS: new cc.Color(215, 169, 255, 255),
            LIGHT_TEXT_COLOR: new cc.Color(255, 255, 255, 255)
        }), cleverapps.overrideStyles(cleverapps.styles.UI.Button, {
            keepRadius: !0
        }), cleverapps.overrideStyles(cleverapps.styles.DECORATORS, {
            WINDOW_TITLE_STROKE: {
                color: new cc.Color(168, 28, 54, 255),
                size: 4
            },
            TITLE_TEXT_SHADOW: {
                color: cleverapps.styles.COLORS.BLACK,
                direction: cc.size(0, -4),
                blur: 5
            },
            IMAGE_FONT_STROKE: {
                color: cleverapps.styles.COLORS.BLACK_STROKE,
                size: 2
            },
            IMAGE_FONT_STROKE_THIN: {
                color: cleverapps.styles.COLORS.BLACK_STROKE,
                size: 1
            },
            BROWN_STROKE: {
                color: cleverapps.styles.COLORS.COLOR_BROWN_2,
                size: 3
            },
            BUTTON_TEXT_STROKE: {
                color: new cc.Color(217, 0, 68, 255),
                size: 3
            },
            TILE_SHOP_BADGE_STROKE: {
                color: new cc.Color(84, 174, 33, 255),
                size: 3
            }
        }),
        cleverapps.styles.FONTS = cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            LOADING_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE
            },
            WHITE_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.WHITE
            },
            MENUBAR_TEXT_DELTA: {
                size: 40,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            SMALL_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            WINDOW_BIG_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            TOOLBAR_ITEM_TIMER_TEXT: {
                size: 30
            },
            WAIT_WINDOW_TEXT: {
                size: 50,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            TILE_SHOP_OFFER_TEXT: {
                name: "nostroke",
                size: 50,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            SHOP_WINDOW_LIVES_TEXT: {
                name: "nostroke",
                size: 50,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            LANTERN_TIMER_FONT: {
                name: "nostroke",
                size: 35,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            TILE_REWARDS: {
                name: "nostroke",
                size: 50,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            TILE_REWARDS_HEADER: {
                size: 35,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            PRODUCT_TILE_LIMIT_TEXT: {
                name: "nostroke",
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            MENUBAR_TEXT: {
                name: "nostroke",
                size: 52,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            MENUBAR_LEVEL_TEXT: {
                name: "nostroke",
                size: 66,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            MENUBAR_WORLD_TITLE_TEXT: {
                name: "nostroke",
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            TILE_SHOP_BADGE_TEXT: {
                size: 30,
                color: cleverapps.styles.COLORS.WHITE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            TILE_SHOP_BADGE_BIG: {
                size: 50,
                color: cleverapps.styles.COLORS.WHITE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            SHOP_WINDOW_TILE_TITLE: {
                size: 55,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            SHOP_WINDOW_SMALL_TILE_TITLE: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            SIDEBAR_ICON_TEXT: {
                name: "nostroke",
                size: 38,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            EPISODE_CLOUD_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.DARK_BLUE
            },
            INC_MOVES_TEXT: {
                name: "default",
                size: 50,
                color: cleverapps.styles.COLORS.COLOR_BROWN
            },
            SWITCH_BUTTON_ON: {
                size: 28,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE
            },
            SWITCH_BUTTON_OFF: {
                size: 28,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            BUSTER_NOTIFICATION_TEXT: {
                size: 34,
                color: cleverapps.styles.COLORS.WHITE
            },
            CONGRATE_TEXT: {
                size: 100,
                color: cleverapps.styles.COLORS.COLOR_DARK_YELLOW,
                stroke: cleverapps.styles.DECORATORS.BROWN_STROKE
            },
            REWARDS_LIST_TEXT: {
                name: "nostroke",
                size: 36,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            MENUBAR_TIMER_TEXT: {
                name: "nostroke",
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            SHOP_LIVES_PRODUCT_TILE_DESCRIPTION_TEXT: {
                name: "nostroke",
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            TILE_SHOP_COINS_OFFER: {
                size: 60,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            DAILY_TASK_PROGRESS_FONT: {
                name: "default",
                size: 28,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            VICTORY_CHEST_TEXT: {
                name: "nostroke",
                size: 48,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            VERY_BIG_TEXT: {
                name: "nostroke",
                size: 80,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            EPISODE_TITLE_TEXT: {
                size: 80,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            DESCRIPTION_TEXT: {
                size: 23,
                color: cleverapps.styles.COLORS.COLOR_LIGHTBROWN
            },
            ADDMOVES_GOAL_RED_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.GOAL_NOT_DONE_COLOR
            },
            TIMER_TEXT: {
                name: "default",
                size: 40,
                color: cleverapps.styles.COLORS.WHITE
            },
            DEC_MOVES_TEXT: {
                name: "default",
                size: 50,
                color: cleverapps.styles.COLORS.COLOR_RED
            },
            SUBSCRIPTION_BUTTON_TITLE: {
                size: 22,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            SUBSCRIPTION_MAIN_TEXT: {
                size: 32,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            TERMS_LINK_TEXT: {
                size: 26,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            TERMS_TEXT: {
                size: 22,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
            },
            GAME_MESSAGE_TEXT: {
                size: 86,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            TRANSITION_LOADING_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            REWARDS_TEXT: {
                name: "nostroke",
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            PACKWINDOW_TITLE_TEXT: {
                size: 90,
                lineHeight: 10,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.PACKWINDOW_LABEL_STROKE
            },
            PACKWINDOW_LABEL_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            BOMB_TIMER_TEXT: {
                name: "nostroke",
                color: cleverapps.styles.COLORS.RIDDLES_BROWN,
                size: 30
            },
            BOMB_TIMER_DANGER_TEXT: {
                name: "nostroke",
                size: 30,
                color: cleverapps.styles.COLORS.BOMB_TIMER_DANGER_COLOR
            },
            CELL_LIVES: {
                size: 35,
                name: "nostroke",
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            DAILY_TASK_CTA: {
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            DAILY_TASKS_BAR: {
                name: "default",
                size: 30
            },
            LOSE_WINDOW_TEXT: {
                color: cleverapps.styles.COLORS.WHITE,
                size: 50
            },
            WINDOW_SMALL_TEXT: {
                name: "nostroke",
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            TOURNAMENT_PLAYER_TEXT: {
                name: "nostroke",
                size: 30,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            TEXT: {
                name: "nostroke",
                size: 45,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            WINDOW_TITLE_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.WINDOW_TITLE_STROKE
            },
            BUTTON_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.WHITE,
                shadow: cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,
                stroke: void 0
            },
            BUTTON_SMALL_TEXT: {
                size: 34,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.TRANSPARENT_BLACK_2PX
            },
            WINDOW_TEXT: {
                name: "nostroke",
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            FBCONNECT_WINDOW_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            HERO_UPGRADE: {
                size: 36,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE_THIN
            },
            FORCE_MESSAGE_TEXT: {
                size: 39,
                color: cleverapps.styles.COLORS.COLOR_BROWN
            },
            MENUBAR_PROGRESS_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR
            },
            QUEST_PROGRESS_TEXT: {
                name: "nostroke",
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            DIALOGUE_PERSON_TITLE_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.WHITE,
                shadow: void 0,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE
            },
            LIGHT_TITLE_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.WINDOW_TITLE_STROKE,
                shadow: void 0
            },
            QUEST_DETAILS_TEXT: {
                name: "nostroke",
                size: 54,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            STARTQUESTWINDOW_TILE_TASK_TEXT: {
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            UNITICON_LEVEL: {
                size: 30,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            HERODETAILS_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            DARK_TEXT: {
                name: "nostroke",
                size: 45,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            LIGHT_TEXT: {
                size: 35,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            UNIT_PROB: {
                size: 35,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            UNIT_AMOUNT: {
                size: 50,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            BUYINGREDIENTSWINDOW_TITLE: {
                name: "default",
                size: 45,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            ORDERS_PLACEHOLDER_TEXT: {
                name: "nostroke",
                size: 40,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            UNITSSHOP_CART_AMOUNT: {
                name: "nostroke",
                size: 40,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            TRAVEL_BOOK_MESSAGE_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            TRAVEL_BOOK_BOTTOM_TEXT: {
                name: "default",
                size: 35,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            TRAVEL_BOOK_TITLE_TEXT: {
                name: "default",
                size: 40,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            },
            PASS_PROGRESS_TEXT: {
                size: 42,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            PASS_PROGRESS_IMAGE_TEXT: {
                size: 45,
                color: cleverapps.styles.COLORS.WHITE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            PASS_TITLE_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.WHITE,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            ROW_DATA_TEXT: {
                size: 40,
                color: cleverapps.styles.COLORS.WHITE
            },
            CLANS_ROW_NAME_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            CLANS_ROW_LEADER_TEXT: {
                size: 60
            },
            CLAN_CHAT_PHRASE: {
                size: 40,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            CLAN_CHANGE_EMBLEM_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            CLAN_PROPERTY_TEXT: {
                size: 52,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            CLAN_SETTING_TEXT: {
                size: 50,
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            TABS_TEXT_FONT: {
                size: 40,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                shadow: void 0,
                stroke: void 0
            },
            TABS_TEXT_FONT_DISABLED: {
                size: 40,
                color: new cc.Color(254, 241, 226, 255),
                shadow: void 0,
                stroke: {
                    color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                    size: 1
                }
            },
            DELETE_ACCOUNT_TEXT: {
                size: 35,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            GOAL_TEXT: {
                size: 30
            },
            CLOVERS_TEXT: {
                size: 30
            },
            MOVES_CELL_TEXT: {
                size: 35
            },
            GROWTH_FUND_LEVEL_TITLE: {
                size: 35,
                color: cleverapps.styles.COLORS.GROWTH_FUND_LEVEL_TITLE_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            GROWTH_FUND_LEVEL_TITLE_REACHED: {
                size: 35,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            GROWTH_FUND_LEVEL_REWARD: {
                size: 35,
                color: cleverapps.styles.COLORS.GROWTH_FUND_LEVEL_REWARD_COLOR
            },
            GROWTH_FUND_LEVEL_REWARD_REACHED: {
                name: "nostroke",
                size: 35,
                color: cleverapps.styles.COLORS.GREEN,
                stroke: void 0,
                shadow: void 0
            },
            GROWTH_FUND_LEVEL_VALUE_REACHED: {
                name: "nostroke",
                size: 35,
                color: cleverapps.styles.COLORS.GREEN,
                stroke: void 0,
                shadow: void 0
            },
            GROWTH_FUND_CTA2: {
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR,
                stroke: void 0,
                shadow: void 0
            },
            GROWTH_FUND_CTA1: {
                color: new cc.Color(255, 198, 0, 255),
                stroke: {
                    color: new cc.Color(191, 117, 0, 255),
                    size: 2
                },
                shadow: cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW
            },
            GROWTH_FUND_LEVEL_VALUE: {
                name: "nostroke",
                size: 35,
                color: cleverapps.styles.COLORS.GROWTH_FUND_LEVEL_REWARD_COLOR
            },
            SHOP_USER_GOLD_TEXT: {
                name: "nostroke",
                size: 40,
                color: cleverapps.styles.COLORS.COLOR_WINDOW_TEXT
            },
            BONUSBG_TITLE: {
                color: cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
                stroke: cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
                shadow: {
                    color: new cc.Color(74, 255, 255, 255),
                    direction: cc.size(0, 0),
                    blur: 10
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.UI, {
            Avatar: {
                x: 4,
                top: 4,
                bottom: 8
            },
            Tooltip: {
                rewards: {
                    extraWidth: 40
                }
            },
            ImageFont: {
                fixedNumberWidth: {
                    stretch: .9
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.MenuBar, {
            smallMargin: 16,
            margin: 24
        }), cleverapps.styles.BackgroundsWindow && cleverapps.overrideStyles(cleverapps.styles.BackgroundsWindow, {
            padding: {
                bottom: -26,
                right: -20,
                left: -10
            },
            item: {
                size: {
                    vertical: {
                        width: 443,
                        height: 633
                    },
                    horizontal: {
                        width: 600,
                        height: 350
                    }
                },
                bg: {
                    padding: {
                        x: 13,
                        y: 14
                    },
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 4
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.MenuBarItem, {
            noColoredText: !0,
            bg: {
                width: 299,
                height: 90,
                minWidth: 247,
                padding: {
                    right: 16
                }
            },
            icon: {
                x: 15
            },
            plusButton: {
                offset: {
                    x: -16,
                    y: 6
                }
            },
            iconText: {
                position: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 6
                    }
                }
            },
            timer: {
                height: 55,
                padding: {
                    x: 30
                },
                position: {
                    x: {
                        align: "right",
                        dx: -26
                    },
                    y: {
                        align: "bottom",
                        dy: -44
                    }
                },
                text: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    },
                    width: 200
                }
            },
            attention: {
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -24
                }
            },
            premiumSticker: {
                x: {
                    align: "center",
                    dx: 95
                },
                y: {
                    align: "center",
                    dy: 58
                },
                text: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 1
                    },
                    width: 125,
                    rotation: 10
                }
            }
        }), cleverapps.override(cleverapps.styles.SettingsWindow, {
            button: {
                width: 480,
                width2: 230,
                width3: 150,
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.CloseButton, {
            x: {
                align: "right",
                dx: -45
            },
            y: {
                align: "top",
                dy: -40
            }
        }),
        cleverapps.overrideStyles(cleverapps.styles.Window, {
            minHeight: 400,
            minWidth: 300,
            padding: {
                top: 164,
                left: 56,
                right: 56,
                bottom: 58
            },
            HelpButton: {
                x: {
                    align: "left",
                    dx: 35
                },
                y: {
                    align: "top",
                    dy: -35
                },
                zOrder: 3
            },
            BottomButton: {
                height: 110
            },
            Foreground: {
                padding: {
                    top: 124,
                    left: 29,
                    right: 30,
                    bottom: 32
                }
            },
            BoundingBoxPadding: {
                x: 25,
                y: 25
            }
        }), cleverapps.overrideStyles(cleverapps.styles.Tabs, {
            margin: 10,
            buttons: {
                width: 127,
                height: 96,
                padding: {
                    bottom: 15
                },
                disabled: {
                    opacity: 255
                }
            },
            attention: {
                x: {
                    align: "left",
                    dx: -20
                },
                y: {
                    align: "top",
                    dy: -5
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.SideBarIconView, {
            text: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -5
                },
                width: 148,
                height: 56,
                offsetY: 1,
                titleIcon: {
                    x: {
                        align: "left",
                        dx: -55
                    }
                }
            },
            lock: {
                x: {
                    align: "right",
                    dx: -5
                },
                y: {
                    align: "center",
                    dy: -5
                }
            },
            mark: {
                x: {
                    align: "right",
                    dx: -10
                },
                y: {
                    align: "top",
                    dy: -10
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.SideBarSlot, {
            margin: 25,
            padding: {
                top: 240
            }
        }), cleverapps.overrideStyles(cleverapps.styles.TileRewardsBlock, {
            colMargin: 7,
            amountMargin: 3
        }),
        cleverapps.overrideStyles(cleverapps.styles.TileIcon, {
            wrap: {
                dy: 20
            },
            sweetPack: {
                wrap: {
                    dy: 40
                }
            },
            jamPack: {
                wrap: {
                    dy: 30
                }
            },
            gold25000: {
                wrap: {
                    dy: -50
                }
            },
            gold6000: {
                wrap: {
                    dy: -20
                }
            },
            tastyPack: {
                wrap: {
                    dy: 20
                }
            },
            honeyPack: {
                wrap: {
                    dy: 15
                }
            },
            hardForVideo: {
                wrap: {
                    dy: -15
                }
            },
            refillLives: {
                wrap: {
                    dy: 20
                }
            },
            livesForVideo: {
                wrap: {
                    dy: -15
                }
            },
            unlimitedLives: {
                wrap: {
                    dy: -10
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.BaseProductTile, {
            width: 460,
            height: 820,
            background: {
                adjustBackgroundCapInsets: !0
            },
            badge: {
                x: {
                    align: "right",
                    dx: 40
                },
                y: {
                    align: "top",
                    dy: 35
                }
            },
            limit: {
                y: -10
            },
            title: {
                width: 494,
                height: 120,
                text: {
                    y: {
                        align: "center",
                        dy: 8
                    }
                }
            },
            description: {
                y: 11,
                bg: {
                    y: {
                        align: "center",
                        dy: -15
                    }
                }
            },
            content: {
                y: {
                    align: "bottom",
                    dy: 70
                },
                margin: 15
            }
        }), cleverapps.overrideStyles(cleverapps.styles.TileBadge, {
            x: {
                align: "center",
                dx: 0
            },
            y: {
                align: "center",
                dy: 5
            },
            width: 115,
            rotation: 20
        }), cleverapps.overrideStyles(cleverapps.styles.PackProductTile, {
            title: {
                text: {
                    y: {
                        align: "center",
                        dy: 13
                    }
                }
            },
            limit: {
                y: -60
            }
        }), cleverapps.overrideStyles(cleverapps.styles.CoinsProductTile, {
            title: {
                y: 15,
                text: {
                    y: {
                        align: "center",
                        dy: 15
                    }
                }
            },
            icon: {
                y: 60
            },
            description: void 0,
            limit: {
                y: -20
            },
            content: {
                margin: 30
            },
            decorators: [cleverapps.styles.Decorators.shop_bonusSale_decor]
        }), cleverapps.styles.UnitsShopTile && cleverapps.overrideStyles(cleverapps.styles.UnitsShopTile, {
            width: 408,
            height: 720,
            button: {
                height: 110
            },
            title: {
                height: 120,
                width: 446,
                amount: {
                    y: {
                        align: "center",
                        dy: 10
                    }
                },
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: -30
                }
            },
            description: {
                y: {
                    align: "center",
                    dy: -130
                }
            },
            leftText: {
                y: {
                    align: "center",
                    dy: 280
                }
            },
            guideButton: {
                x: {
                    align: "center",
                    dx: -130
                },
                y: {
                    align: "center",
                    dy: 290
                }
            },
            adBubble: {
                x: {
                    align: "right",
                    dx: 10
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.TableView, {
            barPadding: {
                cornerPadding: 5
            }
        }), cleverapps.styles.LivesProductTile && cleverapps.overrideStyles(cleverapps.styles.LivesProductTile, {
            content: {
                margin: 30
            },
            icon: {
                height: 165
            },
            button: {
                height: 110
            },
            title: {
                text: {
                    y: {
                        align: "center",
                        dy: 10
                    }
                }
            },
            limit: {
                y: -88
            },
            description: {
                width: 300,
                height: 100,
                y: 10
            },
            badge: {
                x: {
                    align: "right",
                    dx: 30
                },
                y: {
                    align: "top",
                    dy: 37
                }
            }
        }),
        cleverapps.overrideStyles(cleverapps.styles.ShopWindow, {
            wrap: {
                paddingY: 220
            },
            mobile: {
                offsetY: -40
            },
            margin: {
                x: 60,
                y: 30
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DailyTasksCompleteAllView, {
            bar: {
                dy: 2,
                height: 35,
                padding: {
                    bottom: 0,
                    top: 0,
                    left: 0,
                    right: 0
                }
            },
            prize: {
                y: {
                    align: "bottom",
                    dy: -14
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.PrizeBarComponent, {
            prize: {
                width: 80,
                height: 80,
                present: {
                    dy: 5
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.FingerView, {
            anchorX: .3,
            anchorY: .9
        }), cleverapps.overrideStyles(cleverapps.styles.PackWindow, {
            button: {
                height: 110
            },
            discountLabel: void 0,
            Title: {
                dx: -14,
                dy: 300,
                fitTo: {
                    width: 700,
                    height: 100
                },
                delay: .7,
                duration: .675
            },
            animation: {
                default: {
                    idleDelay: 0,
                    dx: 0,
                    dy: -50
                },
                starterPack0: {
                    idleAnimation: "0_idle",
                    introAnimation: "0_start"
                },
                starterPack: {
                    idleAnimation: "1_idle",
                    introAnimation: "1_start"
                },
                starterPack2: {
                    idleAnimation: "2_idle",
                    introAnimation: "2_start"
                }
            },
            rewards: {
                delay: 1.5,
                duration: .675,
                fitTo: {
                    width: 166
                },
                positions: {
                    default: {
                        hard: {
                            x: 190,
                            y: -288
                        },
                        energy: {
                            x: -190,
                            y: -288
                        },
                        wands: {
                            x: -256,
                            y: -88
                        },
                        soft: {
                            x: 4,
                            y: -254
                        },
                        worker: {
                            x: -190,
                            y: 173
                        }
                    },
                    starterPack: {
                        energy: {
                            x: -180,
                            y: -6
                        },
                        hard: {
                            x: 180,
                            y: -6
                        },
                        wands: {
                            x: -180,
                            y: -352
                        },
                        worker: {
                            x: 180,
                            y: -350
                        }
                    },
                    starterPack2: {
                        energy: {
                            x: -250,
                            y: -22
                        },
                        hard: {
                            x: 250,
                            y: -22
                        },
                        wands: {
                            x: -290,
                            y: -377
                        },
                        worker: {
                            x: 290,
                            y: -375
                        }
                    }
                }
            },
            windowShowUpAnimation: {
                name: "default",
                force: !0
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DailyTaskTimer, {
            text: {
                width: 360
            }
        }), cleverapps.overrideStyles(cleverapps.styles.Timer, {
            width: 280
        }), cleverapps.overrideStyles(cleverapps.styles.DailyTasksWindow, {
            tabs: {
                x: {
                    align: "left",
                    dx: -84
                },
                y: {
                    align: "top",
                    dy: -210
                },
                height: 150
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DailyTasksTab, {
            foreground: {
                width: 780,
                height: 684,
                y: {
                    align: "center",
                    dy: 2
                }
            },
            timer: {
                padding: {
                    y: 40
                }
            },
            padding: {
                x: 30
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DailyTaskView, {
            padding: {
                left: 20,
                right: 40,
                top: 20,
                bottom: 30
            },
            titleAndRewards: {
                width: 350
            },
            progressBar: {
                height: 35
            },
            button: {
                height: 70
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DailyTasksCompleteAllView, {
            textLayout: {
                width: "merge" === cleverapps.config.type ? 700 : 450
            }
        }), cleverapps.styles.AchievementsTab && cleverapps.overrideStyles(cleverapps.styles.AchievementsTab, {
            scroll: {
                paddingY: 170,
                y: {
                    align: "center",
                    dy: -40
                }
            },
            margin: {
                x: 0,
                y: 0
            },
            gridPadding: {
                x: 0,
                y: 30
            }
        }), cleverapps.overrideStyles(cleverapps.styles.CloversView, {
            width: 125,
            height: 125,
            text: {
                x: {
                    align: "center",
                    dx: 30
                },
                y: {
                    align: "center",
                    dy: -30
                }
            },
            positions: [{
                x: {
                    align: "center",
                    dx: 255
                },
                y: {
                    align: "center",
                    dy: 14
                }
            }, {
                x: {
                    align: "center",
                    dx: 255
                },
                y: {
                    align: "center",
                    dy: 14
                }
            }, {
                x: {
                    align: "left",
                    dx: 25
                },
                y: {
                    align: "bottom",
                    dy: 7
                }
            }]
        }), cleverapps.overrideStyles(cleverapps.styles.TileButton, {
            height: 110,
            width: 220,
            y: {
                align: "center",
                dy: 15
            }
        }), cleverapps.overrideStyles(cleverapps.styles.SubscriptionButtons, {
            buttonHeight: 110
        }), cleverapps.overrideStyles(cleverapps.styles.LevelStartWindow, {
            Button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.LoseWindow, {
            noBackground: !0,
            button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.PassHeader, {
            amount: {
                star: {
                    y: 5
                },
                progressAmount: {
                    y: 3
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.LevelPassWindow, {
            window: {
                padding: {
                    left: 25,
                    right: 25
                }
            },
            progress: {
                x: {
                    align: "right",
                    dx: -6
                }
            },
            description: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 1
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.PassLastChanceWindow, {
            rewards: {
                text: {
                    rotation: 0,
                    width: 270,
                    height: 70,
                    y: {
                        align: "center",
                        dy: 0
                    },
                    x: {
                        align: "center",
                        dx: 0
                    }
                },
                ribbon: {
                    x: {
                        align: "left",
                        dx: -13
                    },
                    y: {
                        align: "top",
                        dy: -20
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.LotteryIcon, {
            positions: {
                bottom: {
                    x: {
                        align: "center",
                        dx: 20
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.MinimalDialogue, {
            person: {
                margin: 20
            },
            text: {
                arrow: {
                    left: {
                        x: {
                            align: "left",
                            dx: -24
                        },
                        y: {
                            align: "center",
                            dy: 0
                        }
                    },
                    right: {
                        x: {
                            align: "right",
                            dx: 24
                        },
                        y: {
                            align: "center",
                            dy: 0
                        }
                    }
                }
            }
        }), cleverapps.styles.BoosterBeforeAmountView && cleverapps.overrideStyles(cleverapps.styles.BoosterBeforeAmountView, {
            amount: {
                x: {
                    align: "center",
                    dx: 2
                },
                y: {
                    align: "center",
                    dy: 4
                }
            }
        }), cleverapps.styles.BoosterBeforeView && cleverapps.overrideStyles(
            cleverapps.styles.BoosterBeforeView, {
            bonus: {
                x: {
                    align: "left",
                    dx: -10
                }
            },
            amount: {
                x: {
                    align: "right",
                    dx: 10
                }
            },
            icon: {
                5: {
                    dy: 3
                },
                6: {
                    dy: 4
                },
                7: {
                    dy: 5
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.SubscriptionTile, {
            icon: {
                y: -28
            },
            description: {
                rewardsMargin: {
                    y: 5
                },
                margin: 5
            },
            title: {
                text: {
                    y: {
                        align: "center",
                        dy: 14
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.RateWindow, {
            width: 700,
            height: 240,
            button: {
                width: 300,
                height: 110
            },
            stars: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "top",
                    dy: 280
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.ShopUserGoldView, {
            textNode: {
                margin: 0,
                boostersItemsMargin: {
                    y: 0
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DailyCupView, {
            title: {
                width: 610,
                bg: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: -45
                    }
                },
                text: {
                    width: 500,
                    y: {
                        align: "center",
                        dy: -18
                    }
                }
            }
        }), cleverapps.styles.ExtendUnlimitedLivesWindow && cleverapps.overrideStyles(cleverapps.styles.ExtendUnlimitedLivesWindow, {
            animation: {
                height: 250,
                y: {
                    align: "center",
                    dy: -20
                }
            },
            button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.AllDoneWindow, {
            button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.ChatHeader, {
            text: {
                offsetY: 10
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DailytaskSwapButton, {
            height: 70
        }), cleverapps.styles.TreasureSearchWindow && cleverapps.overrideStyles(cleverapps.styles.TreasureSearchWindow, {
            padding: {
                x: -29
            },
            window: {
                padding: {
                    top: 206,
                    left: 100,
                    right: 100
                }
            }
        }), cleverapps.styles.TreasureSearchView && cleverapps.overrideStyles(cleverapps.styles.TreasureSearchView, {
            bg: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: 116
                }
            }
        }), cleverapps.styles.ProlongationOfferView && cleverapps.overrideStyles(cleverapps.styles.ProlongationOfferView, {
            button: {
                height: 110
            },
            label: {
                amount: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 0
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.WindowTitle.Types, {
            default: {
                background: void 0,
                position: {
                    y: {
                        align: "top",
                        anchor: "center",
                        dy: -80
                    }
                },
                padding: {
                    x: 16
                }
            },
            alternative: {
                padding: {
                    x: 90
                },
                textPosition: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 5
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.CrossPromoWindow, {
            button: {
                width: 250,
                height: 110
            },
            badge: {
                dy: -32
            }
        }), cleverapps.overrideStyles(cleverapps.styles.MenuBarGameLevelView, {
            value: {
                offset: {
                    y: -1
                }
            },
            level: {
                offset: {
                    x: 5
                }
            }
        }), cleverapps.styles.UnitsLibraryWindow && cleverapps.overrideStyles(cleverapps.styles.UnitsLibraryWindow, {
            width: 1900,
            height: 1100,
            padding: {
                x: 50,
                y: 35
            },
            tabs: {
                x: {
                    align: "left",
                    dx: -79
                },
                y: {
                    align: "top",
                    dy: -70
                },
                direction: cleverapps.UI.VERTICAL,
                width: 120,
                height: 130
            },
            window: {
                Foreground: {
                    padding: {
                        left: 30,
                        right: 30,
                        top: 25,
                        bottom: 31
                    }
                }
            }
        }), cleverapps.styles.OrdersWindow && cleverapps.overrideStyles(cleverapps.styles.OrdersWindow, {
            width: 1580,
            height: 800,
            noPadding: !1,
            tabs: {
                x: {
                    align: "left",
                    dx: -135
                },
                y: {
                    align: "top",
                    dy: -70
                },
                direction: cleverapps.UI.VERTICAL,
                width: 120,
                height: 150
            }
        }), cleverapps.styles.FamilyLayout && cleverapps.overrideStyles(cleverapps.styles.FamilyLayout, {
            title: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: 10
                },
                padding: {
                    x: 70,
                    y: 4
                }
            },
            grid: {
                padding: {
                    x: 70,
                    top: 85,
                    bottom: 100
                }
            },
            rings: [{
                x: {
                    align: "left",
                    dx: 90
                },
                y: {
                    align: "top",
                    dy: -10
                }
            }, {
                x: {
                    align: "right",
                    dx: -90
                },
                y: {
                    align: "top",
                    dy: -10
                }
            }]
        }), cleverapps.styles.HeroDetailsLayout && cleverapps.overrideStyles(cleverapps.styles.HeroDetailsLayout, {
            height: 600,
            buttonInfo: {
                x: {
                    align: "right",
                    dx: -10
                },
                y: {
                    align: "top",
                    dy: -10
                }
            },
            infoHeroText: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: -20
                }
            },
            grid: {
                width: 1760,
                x: {
                    align: "left",
                    dx: 20
                },
                y: {
                    align: "center",
                    dy: -25
                }
            }
        }), cleverapps.styles.UnitLibraryIcon && (cleverapps.overrideStyles(cleverapps.styles.UnitLibraryIconBg, {
            width: 240,
            height: 320,
            title: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 105
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.UnitLibraryIconFooter, {
            width: 200,
            height: 80,
            collectButton: {
                height: 70,
                type: cleverapps.styles.UI.Button.Images.small_button_green
            }
        })), cleverapps.styles.HeroesTab && cleverapps.overrideStyles(cleverapps.styles.HeroesTab, {
            details: {
                x: {
                    align: "center"
                },
                y: {
                    align: "top",
                    dy: -30
                }
            },
            scroll: {
                width: 1812,
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom"
                },
                padding: {
                    x: 60,
                    top: 105,
                    bottom: 65
                },
                margin: 40
            }
        }), cleverapps.styles.UnitsTab && cleverapps.overrideStyles(cleverapps.styles.UnitsTab, {
            padding: {
                x: 0,
                y: 40
            }
        }), cleverapps.styles.HeroIcon && cleverapps.overrideStyles(cleverapps.styles.HeroIcon, {
            icon: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: 19
                },
                closed: {
                    color: new cc.Color(159, 93, 75, 255),
                    opacity: 255,
                    notForUnknown: !0
                }
            }
        }), cleverapps.styles.PrizeView && cleverapps.overrideStyles(cleverapps.styles.PrizeView, {
            width: 106,
            height: 97,
            padding: {
                x: 18,
                y: 14
            },
            pointer: {
                dy: 2
            },
            animation: {
                x: {
                    align: "center"
                },
                y: {
                    align: "center",
                    dy: 0
                }
            }
        }), cleverapps.styles.QuestsWindow && cleverapps.overrideStyles(cleverapps.styles.QuestsWindow, {
            width: 1580,
            height: 750,
            details: {
                width: 1580,
                height: 460,
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "top",
                    dy: 0
                },
                rings: [{
                    x: {
                        align: "left",
                        dx: 90
                    },
                    y: {
                        align: "top",
                        dy: -10
                    }
                }, {
                    x: {
                        align: "right",
                        dx: -90
                    },
                    y: {
                        align: "top",
                        dy: -10
                    }
                }],
                icon: {
                    x: {
                        align: "left",
                        dx: 75
                    },
                    y: {
                        align: "center",
                        dy: 10
                    },
                    scale: 1
                },
                items: {
                    x: {
                        align: "center",
                        dx: 133
                    },
                    y: {
                        align: "center",
                        dy: -100
                    },
                    background: {
                        width: 130,
                        height: 130
                    },
                    icon: {
                        width: 90,
                        height: 90,
                        maxScale: 1.3
                    },
                    margin: {
                        x: 40
                    }
                },
                title: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 140
                    },
                    fitTo: {
                        width: 820,
                        height: 110
                    }
                },
                button: {
                    x: {
                        align: "right",
                        dx: -80
                    },
                    y: {
                        align: "center",
                        dy: 50
                    },
                    noItemsDelta: 50
                },
                rewards: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 40
                    }
                }
            },
            select: {
                width: 1610,
                x: {
                    align: "left",
                    dx: -13
                },
                y: {
                    align: "top",
                    dy: -440
                },
                margin: 70,
                padding: {
                    x: 30,
                    y: 40
                }
            }
        }), cleverapps.styles.QuestIcon && cleverapps.overrideStyles(cleverapps.styles.QuestIcon, {
            background: {
                width: 280,
                height: 280
            }
        }), cleverapps.styles.BonusWorkerWindow && cleverapps.overrideStyles(cleverapps.styles.BonusWorkerWindow, {
            button: {
                height: 110
            },
            person: {
                x: {
                    align: "center",
                    dx: -650
                },
                y: {
                    align: "bottom",
                    dy: -190
                }
            }
        }), cleverapps.styles.ExpInfoWindow && cleverapps.overrideStyles(cleverapps.styles.ExpInfoWindow, {
            button: {
                height: 110
            }
        }), cleverapps.styles.HeroWindow && cleverapps.overrideStyles(cleverapps.styles.HeroWindow, {
            button: {
                height: 110
            }
        }), cleverapps.styles.CanUpgradeHeroWindow && cleverapps.overrideStyles(cleverapps.styles.CanUpgradeHeroWindow, {
            button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.LanguageButton, {
            height: 110
        }),
        cleverapps.styles.StarChestWindow && cleverapps.overrideStyles(cleverapps.styles.StarChestWindow, {
            content: {
                y: {
                    align: "top",
                    dy: -96
                }
            },
            button: {
                height: 110
            },
            bar: {
                padding: {
                    left: 2,
                    right: 2,
                    top: 2,
                    bottom: 2
                }
            },
            text: {
                width: 600
            },
            chest: {
                y: {
                    align: "center",
                    dy: -30
                }
            }
        }), cleverapps.styles.ConfirmSpeedUpWindow && cleverapps.overrideStyles(cleverapps.styles.ConfirmSpeedUpWindow, {
            buttons: {
                button: {
                    height: 110
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.BandButton, {
            icon: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 45
                }
            },
            position: {
                y: {
                    align: "top",
                    dy: 30
                }
            }
        }), cleverapps.styles.ChestPrizeProbWindow && cleverapps.overrideStyles(cleverapps.styles.ChestPrizeProbWindow, {
            padding: {
                left: -12,
                right: -16,
                top: 0,
                bottom: 0
            }
        }), cleverapps.styles.BuyIngredientsWindow && cleverapps.overrideStyles(cleverapps.styles.BuyIngredientsWindow, {
            tile: {
                amountBackground: {
                    width: 260,
                    height: 104,
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: -120
                    }
                },
                amountText: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: -115
                    },
                    width: 170
                },
                icon: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 45
                    }
                },
                title: {
                    width: 260,
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 170
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.VIPRewardedWindow, {
            button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.ConfirmExitWindow, {
            button: {
                height: 110
            }
        }), cleverapps.styles.PiggyBankWindow && cleverapps.overrideStyles(cleverapps.styles.PiggyBankWindow, {
            button: {
                height: 110
            }
        }), cleverapps.styles.IngredientOrderIcon && (cleverapps.styles.IngredientOrderIcon = {
            width: 160,
            height: 160,
            padding: {
                x: 8,
                y: 2
            },
            icon: {
                x: {
                    align: "center",
                    dx: -10
                },
                y: {
                    align: "bottom",
                    dy: 0
                },
                scale: 2
            },
            text: {
                width: 130,
                x: {
                    align: "right",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: -10
                }
            }
        }), cleverapps.styles.IngredientsTab && cleverapps.overrideStyles(cleverapps.styles.IngredientsTab, {
            grid: {
                columns: 8,
                x: {
                    align: "left",
                    dx: 10
                },
                y: {
                    align: "top",
                    dy: -10
                },
                margin: {
                    x: 50,
                    y: 50
                }
            },
            shelves: void 0
        }), cleverapps.styles.OrdersTab && cleverapps.overrideStyles(cleverapps.styles.OrdersTab, {
            table: void 0,
            placeholder: {
                x: {
                    align: "center",
                    dx: -340
                },
                y: {
                    align: "center",
                    dy: 0
                },
                width: 800
            },
            grid: {
                x: {
                    align: "left",
                    dx: -30
                },
                y: {
                    align: "top",
                    dy: 35
                },
                height: 860,
                columns: 3,
                margin: {
                    x: 30,
                    y: 70
                },
                padding: {
                    x: 60,
                    y: 60
                },
                border: void 0
            },
            details: {
                x: {
                    align: "right",
                    dx: 5
                },
                y: {
                    align: "center",
                    dy: 5
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.SoftCurrencyTile, {
            title: {
                text: {
                    y: {
                        align: "center",
                        dy: 12
                    }
                }
            },
            content: {
                y: {
                    align: "bottom",
                    dy: 100
                },
                margin: 50
            },
            limit: {
                y: -60
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DialogueView, {
            text: {
                arrow: {
                    y: {
                        align: "top",
                        dy: 46
                    }
                },
                padding: {
                    fromWallX: 60,
                    x: 90,
                    y: 60
                }
            },
            persons: {
                dy: -14
            },
            widthPadding: 10
        }), cleverapps.overrideStyles(cleverapps.styles.PassRewardIcon, {
            claimButton: {
                height: 70,
                y: {
                    align: "bottom",
                    dy: -80
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.Row, {
            button: {
                type: cleverapps.styles.UI.Button.Images.small_button_green
            }
        }), "merge" === cleverapps.config.type && cleverapps.overrideStyles(cleverapps.styles.Row, {
            width: 790
        }), cleverapps.overrideStyles(cleverapps.styles.NewVersionWindow, {
            button: {
                width: 220,
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.PassBuyTicketWindow, {
            rewards: {
                icon: {
                    dy: 8
                }
            }
        }),
        cleverapps.overrideStyles(cleverapps.styles.PassTicket, {
            button: {
                height: 70
            }
        }), cleverapps.overrideStyles(cleverapps.styles.PlayButtonView, {
            height: 110
        }), cleverapps.overrideStyles(cleverapps.styles.LeadersWindow, {
            margin: 10,
            padding: {
                x: 0
            }
        }), cleverapps.overrideStyles(cleverapps.styles.MissionWindow, {
            button: {
                height: 110
            }
        }), cleverapps.styles.ExpeditionPageView && cleverapps.overrideStyles(cleverapps.styles.ExpeditionPageView, {
            height: 650,
            message: {
                height: 100,
                width: 280,
                x: {
                    align: "center",
                    dx: 24
                },
                y: {
                    align: "top",
                    dy: -110
                },
                text: {
                    x: {
                        align: "center",
                        dx: 20
                    },
                    height: 85
                },
                icon: {
                    width: 70,
                    height: 70
                },
                iconBg: {
                    x: {
                        align: "left",
                        dx: -40
                    }
                }
            },
            button: {
                height: 110
            },
            image: {
                y: {
                    align: "center",
                    dy: 25
                }
            },
            current: {
                y: {
                    align: "bottom",
                    dy: 45
                }
            },
            timer: {
                y: {
                    align: "bottom",
                    dy: 155
                }
            }
        }), cleverapps.styles.TravelBookWindow && cleverapps.overrideStyles(cleverapps.styles.TravelBookWindow, {
            window: {
                padding: {
                    top: 130
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.NoConnectionWindow, {
            button: {
                height: 110
            }
        }),
        cleverapps.styles.SnapshotBarView && cleverapps.overrideStyles(cleverapps.styles.SnapshotBarView, {
            buttons: {
                width: 110,
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DeleteAccountWindow, {
            info: {
                padding: {
                    x: 60,
                    y: 60
                }
            }
        }), cleverapps.styles.StartEpisodeWindow && cleverapps.overrideStyles(cleverapps.styles.StartEpisodeWindow, {
            button: {
                height: 110
            }
        }), cleverapps.styles.FinisherWindow && cleverapps.overrideStyles(cleverapps.styles.FinisherWindow, {
            button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.GrowthFundTile, {
            content: {
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "bottom",
                    dy: 70
                },
                margin: 0
            },
            icon: {
                y: 50
            },
            description: {
                height: 146,
                y: 38
            },
            title: {
                width: 495,
                x: 0,
                y: 63,
                text: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "center",
                        dy: 6
                    }
                }
            }
        }), cleverapps.styles.LandMarkWindow && cleverapps.overrideStyles(cleverapps.styles.LandMarkWindow, {
            sideOffset: 500,
            grid: {
                width: 900,
                height: 800,
                margin: {
                    x: 40,
                    y: 40
                },
                padding: {
                    x: 15,
                    y: 25
                }
            },
            window: {
                padding: {
                    top: 130,
                    bottom: 40
                }
            }
        }), cleverapps.styles.LandMarkUnit && cleverapps.overrideStyles(
            cleverapps.styles.LandMarkUnit, {
            title: {
                y: {
                    align: "center",
                    dy: 90
                }
            },
            checkmark: {
                x: {
                    align: "right",
                    dx: -15
                },
                y: {
                    align: "bottom",
                    dy: -10
                }
            },
            minimal_dialogue: {
                scale: .6
            }
        }), cleverapps.overrideStyles(cleverapps.styles.GrowthFundWindow, {
            margin: 10,
            padding: {
                top: 5
            },
            window: {
                padding: {
                    left: 40,
                    right: 40,
                    top: 140,
                    bottom: 40
                }
            },
            top: {
                width: 970,
                height: 350,
                align: cleverapps.UI.ALIGN_CENTER,
                text: {
                    x: {
                        align: "center",
                        dx: 155
                    },
                    y: {
                        align: "center",
                        dy: 80
                    }
                },
                icon: {
                    x: {
                        align: "center",
                        dx: -150
                    },
                    y: {
                        align: "center",
                        dy: -20
                    }
                },
                button: {
                    height: 110,
                    x: {
                        align: "right",
                        dx: -53
                    },
                    y: {
                        align: "bottom",
                        dy: 70
                    }
                },
                mark: {
                    x: {
                        align: "right",
                        dx: -140
                    },
                    y: {
                        align: "bottom",
                        dy: 70
                    }
                }
            },
            scroll: {
                margin: 10,
                width: 1e3,
                height: 710,
                top: {
                    width: 1078,
                    height: 52,
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "top",
                        dy: 35
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.GrowthFundLevelView, {
            width: 970,
            height: 170,
            iconBg: {
                x: {
                    align: "left",
                    dx: 0
                },
                y: {
                    align: "center",
                    dy: 0
                },
                width: 260,
                height: 200
            },
            title: {
                x: {
                    align: "left",
                    dx: 295
                },
                y: {
                    align: "center",
                    dy: 25
                }
            },
            icon: {
                x: {
                    align: "left",
                    dx: 55
                },
                y: {
                    align: "center",
                    dy: 0
                }
            },
            rewards: {
                x: {
                    align: "left",
                    dx: 295
                },
                y: {
                    align: "center",
                    dy: -25
                }
            },
            button: {
                width: 230,
                height: 110,
                x: {
                    align: "right",
                    dx: -52
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.GrowthFundBuyWindow, {
            button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.PeriodicSaleWindow, {
            lotsPadding: {
                top: 210
            },
            content: {
                y: {
                    align: "center",
                    dy: -30
                },
                title: {
                    y: {
                        align: "top",
                        dy: -80
                    },
                    text: {
                        width: 630,
                        height: 130
                    }
                },
                timer: {
                    x: {
                        align: "center",
                        dx: 0
                    },
                    y: {
                        align: "bottom",
                        dy: 86
                    }
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.BonusSaleLot, {
            height: 840
        }), cleverapps.overrideStyles(cleverapps.styles.VkLotteryIcon, {
            positions: {
                bottom: {
                    x: {
                        align: "left",
                        dx: -12
                    },
                    y: {
                        align: "top",
                        dy: 39
                    }
                },
                icon: {
                    x: {
                        align: "center",
                        dx: -42
                    }
                },
                iconTimer: {
                    x: {
                        align: "left",
                        dx: -30
                    },
                    y: {
                        align: "bottom",
                        dy: 12
                    }
                }
            }
        }), cleverapps.styles.ProgressView && cleverapps.overrideStyles(cleverapps.styles.ProgressView, {
            person: {
                animation: {
                    x: {
                        align: "center",
                        dx: 15
                    },
                    y: {
                        align: "center",
                        dy: 35
                    }
                },
                width: 400,
                height: 570,
                zOrder: -1,
                x: {
                    align: "center",
                    dx: 0
                },
                y: {
                    align: "top",
                    dy: 541
                }
            },
            icon: {
                bg: {
                    padding: {
                        x: 12,
                        y: 15
                    }
                }
            }
        }), cleverapps.styles.CustomersWindow && cleverapps.overrideStyles(cleverapps.styles.CustomersWindow, {
            height: 820,
            tabs: {
                x: {
                    align: "left",
                    dx: -140
                },
                y: {
                    align: "top",
                    dy: -100
                },
                height: 130
            }
        }), cleverapps.styles.CaravanTileView && cleverapps.overrideStyles(cleverapps.styles.CaravanTileView, {
            width: 600,
            height: 1e3,
            amount: {
                x: {
                    align: "center"
                },
                y: {
                    align: "bottom",
                    dy: 185
                }
            },
            title: {
                x: {
                    align: "center",
                    dx: -2
                },
                y: {
                    align: "center",
                    dy: 15
                },
                help: {
                    x: {
                        align: "center",
                        dx: 7
                    },
                    y: {
                        align: "center",
                        dy: -225
                    }
                },
                bg: {
                    width: 620
                }
            },
            button: {
                height: 110,
                y: {
                    align: "bottom",
                    dy: 70
                }
            },
            rewardsBlock: {
                y: {
                    align: "bottom",
                    dy: 192
                },
                bg: {
                    width: 487
                },
                icon: {
                    x: {
                        align: "center",
                        dx: -100
                    }
                },
                rewards: {
                    x: {
                        align: "right",
                        dx: -20
                    }
                }
            },
            person: {
                y: {
                    align: "bottom",
                    dy: 555
                }
            }
        }), cleverapps.styles.BarrelAdsWindow && cleverapps.overrideStyles(cleverapps.styles.BarrelAdsWindow, {
            item: {
                iconNode: {
                    x: {
                        align: "center"
                    },
                    y: {
                        align: "center",
                        dy: 100
                    },
                    shining: !1
                },
                strip: {
                    width: 330,
                    x: {
                        align: "center",
                        dx: 0
                    },
                    amount: {
                        x: {
                            align: "center"
                        },
                        y: {
                            align: "center",
                            dy: 4
                        }
                    }
                }
            }
        }), cleverapps.overrideStyles(
            cleverapps.styles.FakeLoginWindow, {
            padding: {
                x: 85,
                top: 200,
                bottom: 100
            }
        }), cleverapps.overrideStyles(cleverapps.styles.DialoguePersonTitleView, {
            mobileY: {
                align: "top",
                anchor: "center",
                dy: -10
            },
            text: {
                padding: {
                    x: 40,
                    y: 10
                },
                offset: {
                    y: 7
                }
            }
        }), cleverapps.styles.AddBombMovesWindow && cleverapps.overrideStyles(cleverapps.styles.AddBombMovesWindow, {
            button: {
                height: 110
            }
        }), cleverapps.overrideStyles(cleverapps.styles.FONTS, {
            TOOLBAR_ITEM_REWARD_TEXT: {
                size: 23
            }
        }), cleverapps.overrideStyles(cleverapps.styles.SceneControlButtonsView, {
            controlButtons: {
                y: {
                    align: "center",
                    dy: -9
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.MenuBarItem, {
            timer: {
                icon: !1
            }
        }), cleverapps.overrideFonts(cleverapps.styles.FONTS, {
            PACKWINDOW_LABEL_TEXT: {
                size: 45
            },
            CLOVERS_TEXT: {
                name: "nostroke",
                size: 44,
                color: cleverapps.styles.COLORS.DARK_TEXT_COLOR
            }
        }), cleverapps.overrideStyles(cleverapps.styles.GameScene, {
            sound: {
                delay: 3.5
            }
        }), cleverapps.overrideStyles(cleverapps.styles.PackWindow, {
            rewards: {
                delay: 1.5,
                duration: .675,
                fitTo: {
                    width: 200
                },
                positions: {
                    default: {
                        hard: {
                            x: -190,
                            y: -352
                        },
                        soft: {
                            x: 190,
                            y: -352
                        }
                    },
                    starterPack0: void 0,
                    starterPack: void 0,
                    starterPack2: void 0
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.CloversView, {
            width: 235,
            height: 82,
            icon: {
                x: {
                    align: "left",
                    dx: -20
                }
            },
            positions: [{
                x: {
                    align: "left",
                    dx: 40
                },
                y: {
                    align: "top",
                    dy: -140
                }
            }, {
                x: {
                    align: "left",
                    dx: 40
                },
                y: {
                    align: "top",
                    dy: -140
                }
            }, {
                x: {
                    align: "left",
                    dx: 40
                },
                y: {
                    align: "top",
                    dy: -140
                }
            }],
            text: {
                x: {
                    align: "center",
                    dx: 30
                },
                y: {
                    align: "center",
                    dy: 0
                }
            }
        }), cleverapps.overrideStyles(cleverapps.styles.RestoreProgressButton, {
            width: 260,
            height: 100
        }), cc.game.run(function () {
            cleverapps.onStart()
        });
}.call(this));
//# sourceMappingURL=main-4caae8672b.js.map